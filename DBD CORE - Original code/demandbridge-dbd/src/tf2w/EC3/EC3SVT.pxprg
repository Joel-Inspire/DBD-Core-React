0010 REM "Verify template <EC3SVT>
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 09/07/18 - 17.4975 - dmm - SSP# 301389
0037 REM "301389-Deluxe security, PEN test results, need program changes.    
0040 REM "Copyright 2018 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,EC_PARM$,EC${ALL},TEMPLATE$
0100 SETERR 9000
0110 X0$="EC3SVT",X1$="verify web template"
0120 EOL$=$0D0A$; EOL$=ATH(STP(EC_PARM$(57,8),1))
0500 REM "Open files
0900 TEMPLATE$=STP(TEMPLATE$,2)
0910 TEMPLATE$=STP(TEMPLATE$,3,$0D$)
0920 TEMPLATE$=STP(TEMPLATE$,3,$0A$)
1000 REM "check template
1010 WEB_CODE$=STP(EC$[17],3," ")
1020 CLOSE (101); OPEN (101,ERR=*NEXT)WEB_CODE$+TEMPLATE$; IF MID(FIB(101),10,1)=$0D$ OR POS(%SERVER_TEMPLATE_DIR$=PTH(101))=0 THEN GOTO 1040; END_IF ; TEMPLATE$=WEB_CODE$+TEMPLATE$; GOTO 5000; REM "Ray Alen SSP301389
1030 CLOSE (101); OPEN (101,ERR=*NEXT)TEMPLATE$; IF MID(FIB(101),10,1)=$0D$ OR POS(%SERVER_TEMPLATE_DIR$=PTH(101))=0 THEN GOTO 1040; END_IF ; GOTO 5000; REM "Ray Alen SSP301389
1040 TEMPLATE$=STP(EC_PARM$(128,40),3," "); GOTO 5000
5000 REM "exit
5010 CLOSE (101)
5020 GOTO 9900
9000 REM "ERROR PROCESSING
9002 J=ERR,K=TCB(5); SETERR 0000; ENDTRACE 
9010 LAST_WEBEC_ERR$="ERR: "+STR(J)+" AT: "+STR(K); LAST_WEBEC_ERR$=GBL("LAST_WEBEC_ERR",LAST_WEBEC_ERR$); REM "131928
9090 GOTO 9900
9900 REM "End
9950 EXIT 
9999 END 
56002 REM "201473-EC3SRV allows any aribitrary file on the TopForm server
56004 REM "301389-Deluxe security, PEN test results, need program changes.    
