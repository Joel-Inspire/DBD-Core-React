0010 REM "date manipulation (add/subtract dates) <EC3DT1>
0020 SETESC 9300; SETERR 9000
0035 REM "5.1 - 05/20/02 - 10.975277 - wab - SSP# 145455
0040 REM "Copyright 2002 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 REM "OPTION$ = null or 1 = that base date is in YYMMDD format
0051 REM "OPTION$(1,1) = 2 = that base date is in TF format
0060 REM "BASEDATE$ = this is the date that is added/subtracted from
0062 REM "RESULT = TFMMDD result
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,BASEDATE$,OPTION$,DAYS,RESULT$
0562 DEF FNO$(Z9$)=STR(MOD((ASC(Z9$(1,1))-65)*10,100)+NUM(Z9$(2,1)):"00")+Z9$(3,4)
0563 REM "converts yymmdd to tfmmdd
0564 DEF FNP$(X$)=CHR(ASC("K")+INT(NUM(X$(1,2))/10))+STR(MOD(NUM(X$(1,2)),10))+X$(3,4)
0600 REM "
0601 OPTION$=PAD(OPTION$,20); IF OPTION$(1,1)=" " THEN OPTION$(1,1)="1"
0610 ON POS(OPTION$(1,1)="12")-1 GOTO 0621,0622
0621 BDATE$=BASEDATE$; GOTO 0650
0622 BDATE$=FNO$(BASEDATE$); GOTO 0650
1000 REM "add/subtract from a date (TFMMDD input)
1010 TODAYYYMMDD$=BDATE$
1020 OEJULIAN=JUL(NUM(TODAYYYMMDD$(1,2)),NUM(TODAYYYMMDD$(3,2)),NUM(TODAYYYMMDD$(5,2))); CUTOFFJULIAN=OEJULIAN+DAYS
1022 CUTOFFYYMMDD$=DTE(CUTOFFJULIAN:"%Yz%Mz%Dz")
1024 STDDATE$=CUTOFFYYMMDD$
1026 IF OPTION$(1,1)="2" THEN GOSUB 7650; RESULT$=TFDATE$ ELSE RESULT$=STDDATE$
1034 GOTO 9900
7650 REM "convert STDDATE$ TO TFDATE$
7651 REM "STDDATE$ in YYMMDD format
7655 TFDATE$=""
7660 IF STP(STDDATE$,3," ")="" THEN GOTO 7690
7662 IF LEN(STDDATE$)<6 THEN GOTO 7690 ELSE TMPDATE$=STDDATE$(1,2)
7664 IF TMPDATE$="  " THEN TMPDATE$=""
7666 IF TMPDATE$<"50" THEN TMPDATE$="20"+TMPDATE$ ELSE TMPDATE$="19"+TMPDATE$
7668 TFDATE$=CHR(NUM(TMPDATE$(1,3),ERR=7669)-125)+TMPDATE$(4,1)+STDDATE$(3,2)+STDDATE$(5,2)
7690 RETURN 
9950 SETERR 9960; EXIT 
9960 RUN "ZMENU"
9999 END 
