0010 REM "EC Buyer Setup  <EC3MAF>
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 02/24/12 - 12.775277 - tma - SSP# 253132
0037 REM "253132-Wording changes on EC Buyer setup CHUI EC3MAA               
0040 REM "Copyright 2012 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="EC3MAF",X1$="EC Buyer Setup III",K9$="",K9=0
0120 PRECISION 7
0130 K0=3,K1=1
0135 C9=-1,V9=-2
0140 M0$="##.0000",M1$="####,###.00-",M2$="#,###,###,###"
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1,LEN(A$)),ECA2$
0320 IOLIST B$(1)
0330 IOLIST FM0$
0380 IOLIST ECS$
0400 IOLIST ASP$
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X ECA...  02O AR1... 03O FM0... 04O FMP... 05O ECG... 06O ZZPARM  07O ECH... 08O ECS...  09O EDA...  10O ASP... 11O EDA... 12O EDF... 13O ECU... 14O EDG... 15O AR2...  16O EE8...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0570 DIM F0$(100)
0580 IF FN%HAS_MODULE("OS") THEN HAS_TOPS$="Y" ELSE HAS_TOPS$="N"
0600 REM "
0610 DIM EC_PARM$(1024); FIND (Z[6],KEY=X3$(9,3)+"E/C")EC_PARM$
0611 DIM ARPARMS$(300); FIND (Z(6),KEY=X3$(9,3)+"A/R")ARPARMS$
0620 GOSUB 6000
0650 REM "get operator security - for credit card access
0660 DIM OSEC$(200); FIND (Z[6],KEY="osec"+X3$(40,3),DOM=0661)OSEC$
0900 REM "Setup prompts
0910 EMAIL_ACTION_PROMPT$="O=Order purchased",EMAIL_ACTIONS$=" O"
1000 REM "
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1030 DIM B$(600),C$(200),FMPD$(500)
1035 DIM A$(1540),A[1],FMPD$(500),FM0$(500)
1037 ORDERTYPES$="S RW",ORDERX$="S-Sales orders (O/P-O1)  R-Requisitions  W-Billable warehouse releases"; REM 'SALES ORDERS , R/W RELEASES
1040 REM IF V9<>-1 THEN GOSUB 06900
1045 A$(1,0)=K9$+A1$
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 SETERR 9000; C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1200,1500
1200 REM "Buyer's ID
1205 IF Q0$<>"" THEN A$(1,15)=Q0$; GOTO 1211
1210 CALL "ZZENTR","SX",A{ALL},A$,X4$,X3$,18,3,1,15,C0,"","{1"+X$,"","EC3MAF00","ECA","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1210,1211
1212 IF INT(ABS(C0))=3 THEN C0=-ABS(C0); READ (Z[1],KEY=A$(1,15),DOM=1213)
1215 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1210,6800,9800,6970
1240 GOTO 1120
1500 REM "
1505 Z9=-1
1510 A1$=K9$+A$(LEN(K9$)+1,15),A$(1,LEN(K9$))=K9$
1520 READ (Z[1],KEY=A1$,DOM=1600)IOL=0310
1525 Z9=0
1530 GOSUB 5800
1590 GOTO 1700
1600 REM "
1610 REM IF A$(1,3)=F0$(17,3) THEN GOTO 02000
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630,6975
1630 IF Q0$="" THEN GOTO 1000 ELSE GOTO 9900; REM IF F0$(16,1)="N" THEN GOTO 9800 ELSE GOTO 1000
1690 GOTO 2000
1700 REM "
1790 GOSUB 6200
1800 REM "
1820 CALL "ZZPROM",STR(6+C9),X3$,Z,"","","V",X0; ON Z GOTO 1850,6500,1630,6700,1821
1821 REM "CALL "ZZPROM","X0EC3MAF",X3$,Z,"","","V",X0
1822 REM "ON Z GOTO 01850,06500,01630,06700,06700,01823
1825 GOTO 6700
1830 GOTO 2000
1850 REM "MODIFY
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE IF Z9=0 THEN Z9=1
1860 EXTRACT (Z[1],KEY=A1$,DOM=1870)IOL=0310
1865 C9=1
1870 GOSUB 6200
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF C0>3 OR X0<0 THEN GOTO 1800
2035 IF X0*6+11<LEN(V9$) THEN IF V9$(X0*6+11,1)="2" THEN GOTO 2020
2039 SETERR 9000
2040 ON X0 GOTO 2100,2150,2200,2950,2250,2300,2900,2400,2750,2350,2450,2500,2550,2600,2650,2700,2850,2800,3000,3050,3100,3150,1800 ! **dmm moved as root**
2100 REM "bill to name override
2101 IF X3$(21,6)>="K30301" THEN GOTO 2103; REM "activate after march 1,2003
2102 IF POS(X3$(9,3)="500110",3)=0 THEN GOTO 2140
2110 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,14,5,745,35,C0,"","{3"+X$,"","EC3MAF02","ASP","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2110,2111
2112 IF A$(493,4)=DIM(4) THEN GOTO 2140
2120 FIND (Z[10],KEY=A$(493,4),DOM=2100)IOL=0400
2122 GOSUB 6200
2140 GOTO 2020
2145 ! 
2150 REM "bill to address override
2151 IF X3$(21,6)>="K30301" THEN GOTO 2153; REM "activate after march 1, 2003
2152 IF POS(X3$(9,3)="500110",3)=0 THEN GOTO 2190
2153 DIM ADDRESS$(87); ADDRESS$(1,87)=A$(780,87)
2154 OPTION$="!D"
2155 C0=2,C1=1,C2=0,C3=0
2160 CALL "ZY2AAA",X3$,X4$,5,6,OPTION$,"",C0,ADDRESS$,"X",C1,C2,C3
2170 A$(780,87)=ADDRESS$
2190 GOTO 2020
2195 ! 
2200 REM "Can Approve Orders? SSP# 148750
2202 IF EC_PARM$(946,1)<>"Y" THEN GOTO 2020
2205 X$="Y=Buyer can authorize orders on line, N=Buyer cannot authorize orders on line"
2210 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,24,11,867,1,C0,M0$,"{3"+X$,"","EC3MAF04","","",""
2240 GOTO 2020
2245 ! 
2250 REM "Ignore approval criteria SSP# 148750
2252 IF EC_PARM$(946,1)<>"Y" THEN GOTO 2020
2255 X$="Y=Buyer's orders don't need approval , N=Buyer's orders need approval"
2260 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,75,11,868,1,C0,M0$,"{3"+X$,"","EC3MAF06","","",""
2290 GOTO 2020
2295 ! 
2300 REM "BUYER - Purchasing agent for purchase approval
2302 IF EC_PARM$(946,1)<>"Y" THEN GOTO 2020
2303 IF MID(A$,868,1)="Y" THEN A$(869,15)=DIM(15); PRINT @(32,12),A$(869,15),@(5,13),DIM(30); GOTO 2340
2305 X$="Enter Valid Buyer ID"
2310 CALL "ZZENTR","SX",A{ALL},A$,X4$,X3$,32,12,869,15,C0,"","{1"+X$,"","EC3MAF08","ECA","",""; IF A$(869,15)=DIM(15) AND ABS(C0)=4 THEN A$(868,1)="Y"; PRINT @(75,11),A$(868,1) END_IF ; IF ABS(C0)>4 THEN GOSUB 6400 END_IF ! ; ON C0 GOTO 2340,2311
2311 IF NOT(NUL(A$(869,15))) THEN DIM BUYER$(1200); READ (Z[1],KEY=A$(869,15),DOM=2300)BUYER$ ELSE GOTO 2335
2312 IF A$(1,15)=A$(869,15) THEN CALL "ZZPROM",".4",X3$,Z,"Buyer "+STP(A$(869,15),1," ")+" not allowed in this field","","",0; GOTO 2310
2313 IF POS("@"=BUYER$(109,60))=0 THEN CALL "ZZPROM",".4",X3$,Z,"Buyer "+STP(A$(869,15),3," ")+" does not have a valid email address","","",0; GOTO 2310
2322 IF BUYER$(51,10)=A$(51,10) THEN GOTO 2330
2323 CALL "ZZDISP","AX",A$(51,10),"A/R",X3$,TT$,"",0,0,X4$
2324 CALL "ZZPROM",".4",X3$,Z,"Buyer "+STP(A$(869,15),1," ")+" Not Associated with Customer "+TT$,"","",0
2330 PRINT @(5,13),BUYER$(109,30), ! SSP166022
2335 IF NOT(NUL(A$(869,15))) THEN A$(1049,14)=DIM(14)
2340 GOTO 2020
2345 ! 
2350 ! Email order confirmation template, WO166006
2355 X$="Leave blank to send what the browser has displayed"
2360 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,35,16,944,40,C0,"","{3"+X$,"","EC3MAF10","","",""
2390 GOTO 2020
2395 ! 
2400 ! Buyer - Display all for status? - SSP172982
2402 IF EC_PARM$(946,1)<>"Y" THEN GOTO 2020
2403 IF MID(A$,868,1)="Y" THEN A$(984,1)=DIM(1); PRINT @(72,12),A$(984,1); GOTO 2440
2405 X$="BUYER - Show all Order Approval worksheets, even if approved or rejected?"
2410 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,72,12,984,1,C0,M0$,"{3"+X$,"","EC3MAF12","","",""
2440 GOTO 2020
2445 ! 
2450 ! Don't show EC Promo link? WO174468
2453 IF ECS$(600,1)<>"Y" THEN A$(995,1)=" "; GOTO 2490
2455 X$="Only for this buyer, don't show EC Promo link"
2460 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,35,17,995,1,C0,M0$,"{3"+X$,"","EC3MAF14","","",""
2490 GOTO 2020
2495 ! 
2500 ! Show on-line account admistration link? SSP177696
2510 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,35,18,996,1,C0,M0$,"{3"+X$,"","EC3MAF16","","",""
2540 GOTO 2020
2545 ! 
2550 ! Don't show TOPS link?
2553 IF HAS_TOPS$<>"Y" THEN GOTO 2020
2555 X$="Y=This buyer will not see the link to Office Products" ! ssp#253132
2560 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,35,19,997,1,C0,M0$,"{3"+X$,"","EC3MAF18","","",""
2590 GOTO 2020
2595 ! 
2600 ! Color scheme, SSP184884
2605 X$="Blank=default, must be valid style sheet on webserver."
2610 CALL "ZZENTR","SUZ",A{ALL},A$,X4$,X3$,35,20,1029,6,C0,"","{3"+X$,"","EC3MAF20","EE2","EC3MAH",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2610,2611
2640 GOTO 2020
2645 ! 
2650 ! # Rows for product catalog, WO189439
2655 X$="Leave blank to use system setting, (maximum 999 rows)"
2660 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,35,21,1035,3,C0,"","{3"+X$,"","EC3MAF22","","",""
2670 TEST=NUM(A$(1035,3),ERR=2660); IF TEST>999 THEN GOTO 2660
2690 GOTO 2020
2695 ! 
2700 ! Use image view product catalog? WO189764
2710 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,77,17,1038,1,C0,M0$,"{3"+X$,"","EC3MAF24","","",""
2740 GOTO 2020
2745 ! 
2750 REM "Maximum order amount
2752 IF EC_PARM$(946,1)<>"Y" THEN GOTO 2020
2753 IF MID(A$,868,1)="Y" THEN A$(1039,10)=DIM(10); PRINT @(60,13),STR(NUM(A$(1039,10)):M2$); GOTO 2799
2755 DIM KA[1]; KA[0]=NUM(A$(1039,10))
2760 CALL "ZZENTR","NX",KA{ALL},A$,X4$,X3$,60,13,0,600,C0,M2$,"{3"+X$,"","OF2MAF26","","",""
2770 A$(1039,10)=STR(KA[0]:"#########0")
2799 GOTO 2020
2800 REM Is Buyer used in WMS? (was:wms pgm to run) SSP 227714 ** as root **
2802 X$="Is this a WMS Buyer" ! ssp 227714 ** as root **
2803 IF A$(255,1)=" " THEN A$(255,1)="N" ! SSP 227714 ** as root **
2810 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,59,21,255,1,C0,M0$,"{3"+X$,"","EC3MAF30","","","" ! SSP 2810 ** as root **
2815 REM ** as root **
2840 GOTO 2020
2850 ! Additional Secure Codes
2860 X$="codes required for access to any coded items or catalog categories"
2870 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,39,19,898,40,C0,M0$,"{3"+X$,"","EC3MAF32","","","" ! SSP226479 dmm as root ***
2880 TEST$=STP(A$(898,40),2); IF MOD(LEN(TEST$),2)<>0 THEN X$="Secure Codes must be TWO characters in length EACH"; GOTO 2870
2890 GOTO 2020
2895 ! 
2900 REM "Approver Group - Purchasing agent group for purchase approval
2902 IF EC_PARM$(946,1)<>"Y" THEN GOTO 2020
2903 IF MID(A$,868,1)="Y" THEN A$(1049,14)=DIM(14); PRINT @(32,14),A$(1049,14),; GOTO 2940
2905 X$="Enter Valid Approver Group ID"
2910 CALL "ZZENTR","SX",A{ALL},A$,X4$,X3$,32,14,1049,14,C0,"","{1"+X$,"","EC3MAF26","EE8","",""; IF A$(869,15)=DIM(15) AND A$(1049,14)=DIM(14) THEN A$(868,1)="Y"; PRINT @(75,11),A$(868,1) END_IF ; IF ABS(C0)>4 THEN GOSUB 6400 END_IF ! SSP226479 dmm as root ***
2911 IF NOT(NUL(A$(1049,14))) THEN DIM APP_GROUP$(160); READ (Z[16],KEY=A$(1049,14),DOM=2900)APP_GROUP$
2920 IF NOT(NUL(A$(1049,14))) THEN A$(869,15)=DIM(15); GOSUB 6400
2940 GOTO 2020
2945 ! 
2950 REM "Can Approve ALL Orders - Super approver? - 207913
2952 IF EC_PARM$(946,1)<>"Y" OR A$(867,1)<>"Y" THEN A$(1063,1)=DIM(1); PRINT @(44,11),A$(1063,1); GOTO 2020
2965 X$="Y=Can authorize ALL orders on line, N=Can only authorize assigned orders"
2970 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,44,11,1063,1,C0,M0$,"{3"+X$,"","EC3MAF28","","","" ! SSP226479 dmm as root ***
2990 GOTO 2020
2995 ! 
3000 ! SSP226479 - Restrict reports dmm as root ***
3010 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,77,5,1065,1,C0,"","{3"+X$,"","EC3MAF34","","","" ! SSP226479 dmm as root *** 
3040 GOTO 2020 ! SSP226479 dmm as root *** 
3045 ! 
3050 ! SSP226479 - Show my account dmm as root ***
3060 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,77,6,1066,1,C0,"","{3"+X$,"","EC3MAF36","","","" ! SSP226479 dmm as root *** 
3090 GOTO 2020 ! SSP226479 dmm as root *** 
3095 ! 
3100 ! SSP226479 - Allow budget maintenance dmm as root ***
3105 IF NOT(FN%HAS_MODULE("EB")) THEN GOTO 3140 ! SSP226479 dmm as root *** 
3110 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,77,7,1064,1,C0,"","{3"+X$,"","EC3MAF38","","","" ! SSP226479 dmm as root *** 
3140 GOTO 2020 ! SSP226479 dmm as root *** 
3145 ! 
3150 ! WO231698 - Report type **dmm moved as root**
3160 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,77,8,1068,1,C0,"","{3"+X$,"","EC3MAF40","","","" ! **dmm moved as root**
3190 GOTO 2020 ! **dmm moved as root**
3195 ! **dmm moved as root**
5800 REM "Alt data reads
5805 DIM ASP$(256); FIND (Z[10],KEY=A$(493,4),DOM=5806)IOL=0400
5807 DIM AR1$(1000); FIND (Z[2],KEY=A$(51,10),DOM=5808)AR1$
5808 DIM ECS$(1000); FIND (Z[8],KEY=A$(51,10),DOM=5809)IOL=0380
5809 IF ECS$(600,1)="Y" THEN PRINT @(9,17),"Don't show EC Promo link?", ! WO174468
5810 DIM CAT1$(200),CAT2$(200),CAT3$(200),CAT4$(200),CAT5$(200),CAT6$(200),CAT7$(200),CAT8$(200),CAT9$(200),CAT10$(200)
5820 FIND (Z[11],KEY=A$(626,10),DOM=5821)CAT1$
5821 FIND (Z[11],KEY=A$(636,10),DOM=5822)CAT2$
5822 FIND (Z[11],KEY=A$(646,10),DOM=5823)CAT3$
5823 FIND (Z[11],KEY=A$(656,10),DOM=5824)CAT4$
5824 FIND (Z[11],KEY=A$(666,10),DOM=5825)CAT5$
5825 FIND (Z[11],KEY=A$(676,10),DOM=5826)CAT6$
5826 FIND (Z[11],KEY=A$(686,10),DOM=5827)CAT7$
5827 FIND (Z[11],KEY=A$(696,10),DOM=5828)CAT8$
5828 FIND (Z[11],KEY=A$(706,10),DOM=5829)CAT9$
5829 FIND (Z[11],KEY=A$(716,10),DOM=5830)CAT10$
5840 DIM EDF$(100); FIND (Z[12],KEY=A$(83,3),DOM=5841)EDF$
5841 DIM AR2$(100); FIND (Z(15),KEY=AR1$(359,2),DOM=5842)AR2$
5842 DIM BUYER$(1200); READ (Z[1],KEY=A$(869,15),DOM=*NEXT)BUYER$ ! SSP166022
5845 RETURN 
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6060 PRINT @(1,3),"Buyer's id code:",@(35,3),"name:",@(0,4),Z0$,@(20,4),"Bill-To Address Override",@(5,5),"BT Name:",@(5,6),"Address:",@(8,8),"City:",@(32,8),"State:",@(9,9),"Zip:",
6065 PRINT @(57,5),"Don't show reports?",@(60,6),"Show my account?", ! SSP226479 dmm as root ***
6066 IF FN%HAS_MODULE("EB") THEN PRINT @(51,7),"Allow budget maintenance?", ! SSP226479 dmm as root ***
6067 PRINT @(64,8),"Report type:", ! WO231698 **dmm moved as root**
6070 PRINT @(3,11),"Can Approve Orders?:",; REM "SSP# 148750
6071 PRINT @(0,10),Z0$,@(23,10),"Order Approvals",; REM " SSP# 147850
6072 PRINT @(48,11),"Ignore Approval Criteria?:",; REM "SSP# 148750
6073 PRINT @(27,11),"Super approver?:",; REM "SSP# 207913
6074 PRINT @(3,12),"Purchasing Agent Buyer Code:",; REM " SSP# 148750
6075 PRINT @(3,14),"Purchasing Agent Group Code:",; REM " SSP# 205923
6076 PRINT @(40,13),"Max. Order Amount:",; REM "SSP192510
6078 PRINT @(0,15),Z0$,
6080 PRINT @(0,16),"Email order confirmation template:", ! WO166006
6082 PRINT @(48,12),"Display all for status?", ! SSP172982
6085 PRINT @(2,18),"Show on-line account admin link?", ! SSP177696
6087 IF HAS_TOPS$="Y" THEN PRINT @(13,19),"Don't show OPT link?", ! WO181248!ssp#253132
6089 PRINT @(21,20),"Color scheme:",
6090 PRINT @(45,18),"Additional Secure Codes:",
6091 PRINT @(7,21),"# Rows for product catalog:",@(47,21),"WMS Buyer?:" ! ssp 227714 ** as root **
6093 PRINT @(45,17),"Use image view product catalog?",
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6205 GOSUB 6450
6210 PRINT @(42,3),A$(16,35),@(14,5),A$(745,35),@(14,6),A$(780,30),@(14,7),A$(810,30),@(14,8),A$(840,16),@(39,8),A$(856,2),
6220 CALL "ZZDISP","A",A$(858,9),"ZIP",X3$,"","",14,9,X4$
6225 PRINT @(77,5),A$(1065,1),@(77,6),A$(1066,1), ! SSP226479 dmm as root ***
6226 IF FN%HAS_MODULE("EB") THEN PRINT @(77,7),A$(1064,1), ! SSP226479 dmm as root ***
6227 PRINT @(77,8),A$(1068,1), ! WO231698 **dmm moved as root**
6230 PRINT @(24,11),A$(867,1),@(44,11),A$(1063,1),@(75,11),A$(868,1),@(32,12),A$(869,15),@(5,13),BUYER$(109,30),@(60,13),STR(NUM(A$(1039,10)):M2$),@(32,14),A$(1049,14), ! SSP166022,SPP192510
6240 PRINT @(35,16),A$(944,40), ! WO166006
6245 PRINT @(72,12),A$(984,1), ! SSP172982
6250 IF ECS$(600,1)="Y" THEN PRINT @(35,17),A$(995,1), ! WO174468
6255 PRINT @(35,18),A$(996,1), ! SSP177696
6260 IF HAS_TOPS$="Y" THEN PRINT @(35,19),A$(997,1), ! WO181248
6265 PRINT @(35,20),A$(1029,6),
6270 PRINT @(35,21),A$(1035,3),@(59,21),A$(255,1),
6275 PRINT @(77,17),A$(1038,1),
6280 PRINT @(39,19),A$(898,40),
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6460 PRINT @(18,3),A$(1,15),
6490 RETURN 
6500 REM "DELETE
6510 REMOVE (Z[1],KEY=A1$,DOM=6511)
6590 GOTO 1630
6600 REM "ALT KEY DATA READS
6690 RETURN 
6700 REM "ADD ENTRY
6705 IF Z9=0 THEN GOTO 6790
6710 WRITE (Z[1],KEY=A1$)IOL=0310
6720 IF Q0$<>"" THEN GOTO 9900
6790 C9=0; IF Z=6 OR K1=0 THEN GOTO 9900 ELSE IF Z<4 THEN GOTO 1000 ELSE C0=-(3.1+(Z-4)/10); GOTO 6800
6800 REM "NEXT ENTRY IN FILE
6805 ON 10*FPT(C0)+2 GOTO 6850,6806
6810 A1$=KEY(Z[1],END=6895)
6820 IF A1$="" THEN GOTO 6800 ELSE IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 6895
6825 A$(1,LEN(A1$))=A1$
6830 GOSUB 6600
6835 GOSUB 6450
6840 GOTO 1515
6850 REM "PRIOR ENTRY
6855 CALL "ZZKEYP",ERR=6856,Z[1],A1$; GOTO 6820
6856 CALL "ZZPROM","K0",X3$,S3,"","","",0; ON S3 GOTO 6857,9900
6860 PRINT 'RB',; CALL "ZZKEYL",ERR=6861,Z[1],A1$; GOTO 6820
6865 GOTO 1100
6870 GOTO 6895
6890 GOTO 1515
6895 CALL "ZZPROM","K1",X3$,S3,"","","",0; IF S3=1 THEN GOTO 9900 ELSE IF A1$="" THEN GOTO 6860 ELSE PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=6896)
6898 ON S9 GOTO 6810,1100
6900 REM "GET DEFAULTS
6930 RETURN 
6950 REM "WRITE DEFAULT
6970 REM "ENTRY DEFAULTS
6975 PRINT 'CF'; V9=-2,Q$=""
6980 FOR X=1 TO LEN(V9$) STEP 6
6982 REM PRINT @(NUM(V9$(X,2)),NUM(V9$(X+2,2))),; IF V9=-2 THEN PRINT V9$(X+4,1), ELSE READ RECORD (0,SIZ=1) Q$; IF POS(Q$="1234Z")=0 THEN PRINT 'RB'; GOTO 06982
6990 IF Q$="Z" THEN EXITTO 6950 ELSE V9$(X+4,LEN(Q$))=Q$; NEXT X
6995 V9=0; GOTO 6980
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,1
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 GOSUB 6400
9520 ON C9 GOTO 1140,2040
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
56000 ! Program changes starting 11/29/05
56010 REM "184884-Need file for users to create style sheet codes, then they
56015 REM "189439-Buyer setting for number of rows for product catalog page.
56020 REM "189764-Buyer parameter to show product catalog in new style with
56030 REM "192510-Order Approval based on dollar amount, per order, set by buyer
56032 REM "180032-Wireless Warehousing                                        
56034 REM "197953-WMS. Quick bin change                                       
56036 REM "192407-Buyer needs 20 additional secure codes.                     
56038 REM "205923-Tiered purchase approval - by dollar amount ranges.
56040 REM "207913-Purchase approvals: Super-approver must be able to approve all worksheets
56044 ! 226479-Restrict reports, show my account, allow budget maintenance
56046 ! 231698-Buyer parameter and global tag for report type
