0010 REM "EC Buyer Setup  <EW3MAA>
0020 SETESC 9300; SETERR 9000
0035 REM "5.1 - 04/14/03 - 12.892222 - tma - SSP# 159565
0040 REM "Copyright 2003 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="EW3MAA",X1$="Electronic Commerce Buyer Setup",K9$="",K9=0
0120 PRECISION 7
0130 K0=3,K1=1
0135 C9=-1,V9=-2
0140 M0$="##.0000",M1$="####,###.00-"
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1,LEN(A$)),ECA2$
0320 IOLIST B$(1)
0330 IOLIST FM0$
0380 IOLIST ECS$
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X ECA...  02O AR1... 03O FM0... 04O FMP... 05O ECG... 06O ZZPARM  07O ECH... 08O ECS...  09O EDA...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0570 DIM F0$(100)
0600 REM "
0610 DIM EC_PARM$(1024); FIND (Z[6],KEY=X3$(9,3)+"E/C")EC_PARM$
0620 GOSUB 6000
0900 REM "Setup prompts
0910 EMAIL_ACTION_PROMPT$="O=Order purchased",EMAIL_ACTIONS$=" O"
1000 REM "
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1030 DIM B$(600),C$(200),FMPD$(500)
1035 DIM A$(1540),A[1],FMPD$(500),FM0$(500)
1037 ORDERTYPES$="S RW",ORDERX$="S-Sales orders (O/P-O1)  R-Requisitions  W-Billable warehouse releases"; REM 'SALES ORDERS , R/W RELEASES
1040 REM IF V9<>-1 THEN GOSUB 06900
1045 A$(1,0)=K9$+A1$
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 SETERR 9000; C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1200,1500
1200 REM "Buyer's ID
1210 CALL "ZZENTR","SX",A{ALL},A$,X4$,X3$,18,3,1,15,C0,"","{1"+X$,"","EW3MAA00","ECA","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1210,1211
1212 IF INT(ABS(C0))=3 THEN C0=-ABS(C0); READ (Z[1],KEY=A$(1,15),DOM=1213)
1215 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1210,6800,9800,6970
1240 GOTO 1120
1500 REM "
1505 Z9=-1
1510 A1$=K9$+A$(LEN(K9$)+1,15),A$(1,LEN(K9$))=K9$
1520 READ (Z[1],KEY=A1$,DOM=1600)IOL=0310
1525 Z9=0
1530 GOSUB 5800
1590 GOTO 1700
1600 REM "
1610 REM IF A$(1,3)=F0$(17,3) THEN GOTO 02000
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630,6975
1630 GOTO 1000; REM IF F0$(16,1)="N" THEN GOTO 9800 ELSE GOTO 1000
1650 GOSUB 7800; REM "buyer copy option
1659 A$(480,3)=X3$(9,3); REM "Preset company code
1660 A$(80,3)="060",A$(253,1)="Y"; GOSUB 6200
1690 GOTO 2000
1700 REM "
1790 GOSUB 6200
1800 REM "
1820 REM ' CALL "ZZPROM",STR(6+C9),X3$,Z,"","","V",X0; ESCAPE ; ON Z GOTO 01850,06500,01630,06700,01821
1821 CALL "ZZPROM","X0EC3MAA",X3$,Z,"","","V",X0
1822 ON Z GOTO 1850,6500,1630,6700,6700,1823
1823 IF Z=6 THEN GOSUB 7500; GOTO 1820 ELSE GOTO 1820
1825 GOTO 6700
1830 GOTO 2000
1850 REM "MODIFY
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE IF Z9=0 THEN Z9=1
1860 EXTRACT (Z[1],KEY=A1$,DOM=1870)IOL=0310
1865 C9=1
1870 GOSUB 6200
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF C0>3 OR X0<0 THEN GOTO 1800
2035 IF X0*6+11<LEN(V9$) THEN IF V9$(X0*6+11,1)="2" THEN GOTO 2020
2039 SETERR 9000
2040 ON X0 GOTO 2100,2150,3950,2450,3450,3850,2200,2250,2300,2350,4100,3100,2900,3250,2950,3300,3000,3350,3050,3400,2700,2750,2650,3750,3900,4000,2500,2800,2550,2850,2600,3150,4050,3600,3650,4200,4250,1800
2100 REM "Buyer's name
2110 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,42,3,16,35,C0,"","{3"+X$,"","EW3MAA02","","",""
2140 GOTO 2020
2150 REM "Buyer's Password
2160 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,18,4,65,15,C0,"","{3"+X$,"","EW3MAA04","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2160,2161
2165 PRINT @(18,4),DIM(15),; REM "clear password display
2190 GOTO 2020
2200 REM "Session expires after minutes
2205 IF ABS(C0)<>2 THEN GOTO 2020
2210 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,63,6,80,3,C0,"","{3"+X$,"","EW3MAA06","","",""
2240 GOTO 2020
2250 REM "Customer code
2260 CALL "ZZENTR","AU",A{ALL},A$,X4$,X3$,24,7,51,10,C0,"A/R","{3"+X$,"","EW3MAA08","AR1","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2260,2261
2264 IF STP(A$(51,10),3," ")="" AND ABS(C0)=2 THEN GOTO 2020
2265 FIND (Z[2],KEY=A$(51,10),DOM=2260)IOL=0320; A$(325,10)=A$(51,10)
2267 DIM ECS$(1000); FIND (Z[8],KEY=A$(51,10),DOM=2268)ECS$
2269 PRINT @(38,7),B$(11,35),
2290 GOTO 2020
2300 REM "** Not USED **
2302 GOTO 2020
2305 X$="Used to process Bank Data"
2310 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,28,9,120,1,C0,"","{3"+X$,"","EW3MAA10","","",""
2340 GOTO 2020
2350 REM "Buyer's location code
2352 X$="Leave blank to allow buyer access to all ship-to locations"
2355 TMP$="C"+A$(51,10)
2360 CALL "ZZENTR","SZU",A{ALL},A$,X4$,X3$,24,8,61,4,C0,"","{3"+X$,TMP$,"EW3MAA12","FM0C","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2360,2361
2365 IF STP(A$(61,4),3," ")="" THEN DIM FM0$(500); PRINT @(38,8),'CL',; IF A$(339,1)="Y" AND A$(483,10)=DIM(10) THEN A$(339,1)="N" END_IF ; A$(92,1)="N"; GOSUB 6200 ELSE FIND (Z[3],KEY="C"+A$(51,14),DOM=2360)IOL=0330; A$(726,9)=DIM(9); PRINT @(38,8),'CL',FM0$(16,35),
2366 GOSUB 5800; GOSUB 6200
2380 GOSUB 7600
2390 GOTO 2020
2450 REM "Can enter orders
2452 X$="enables ability to enter orders on the web"
2454 IF A$(88,1)=" " THEN A$(88,1)="Y"
2460 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,18,5,88,1,C0,"","{3"+X$,"","EW3MAA16","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2460,2461
2490 GOTO 2020
2500 REM "Can Purchase Orders
2501 GOTO 2540
2502 X$="enables ability to BUY orders ENTERED on the web"
2510 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,24,17,89,1,C0,"","{3"+X$,"","EW3MAA18","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2510,2511
2540 GOTO 2020
2550 REM "Can Approve orders
2551 GOTO 2590
2552 X$="enables the ability to approve the BUY of another operators orders"
2560 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,24,18,90,1,C0,"","{3"+X$,"","EW3MAA20","","",""
2590 GOTO 2020
2600 REM "Can Administer Buyers
2601 GOTO 2640
2610 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,24,19,91,1,C0,"","{3"+X$,"","EW3MAA22","","",""
2640 GOTO 2020
2650 REM "Restrict order status to single customer location?
2652 IF STP(A$(61,4),3," ")="" THEN A$(92,1)="N"; GOSUB 6200; GOTO 2690
2654 X$="Restrict status information to ship-to "+A$(61,4)
2660 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,23,18,92,1,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
2690 GOTO 2020
2700 REM "Order entry - order types
2701 GOTO 2740
2702 IF A$(88,1)<>"Y" THEN A$(93,4)="    "; GOSUB 6200; GOTO 2740
2703 X$=ORDERX$
2710 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,26,16,93,4,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
2720 FOR VV=0 TO 3; IF POS(A$(93+VV,1)=ORDERTYPES$)=0 THEN EXITTO 2700 ELSE NEXT VV
2740 GOTO 2020
2750 REM "Order status review types
2752 X$=ORDERX$
2760 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,23,16,97,4,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
2762 FOR VV=0 TO 3; IF POS(A$(97+VV,1)=ORDERTYPES$)=0 THEN EXITTO 2750 ELSE NEXT VV
2770 IF STP(A$(97,4),3," ")="" THEN GOTO 2750
2790 GOTO 2020
2800 REM "purchase status order types
2801 GOTO 2840
2802 IF A$(89,1)<>"Y" THEN A$(101,4)="    "; GOSUB 6200; GOTO 2840
2803 X$=ORDERX$
2810 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,26,17,101,4,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
2820 FOR VV=0 TO 3; IF POS(A$(101+VV,1)=ORDERTYPES$)=0 THEN EXITTO 2800 ELSE NEXT VV
2840 GOTO 2020
2850 REM "Approve status order types
2851 GOTO 2890
2852 IF A$(90,1)<>"Y" THEN A$(105,4)="    "; GOSUB 6200; GOTO 2890
2853 X$=ORDERX$
2860 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,26,18,105,4,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
2870 FOR VV=0 TO 3; IF POS(A$(105+VV,1)=ORDERTYPES$)=0 THEN EXITTO 2850 ELSE NEXT VV
2890 GOTO 2020
2900 REM "buyer email
2910 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,7,11,109,60,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
2940 GOTO 2020
2950 REM "purchasing agent email
2960 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,7,12,169,60,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
2990 GOTO 2020
3000 REM "csr email
3002 X$="Default is pulled from the customer parameters"
3004 IF A$(340,60)=DIM(60) THEN A$(340,60)=ECS$(42,60),A$(460,10)=ECS$(102,10); GOSUB 6200
3010 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,7,13,340,60,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
3040 GOTO 2020
3050 REM 'SALESPERSON EMAIL
3052 X$="Default is pulled from the customer parameters"
3054 IF A$(400,60)=DIM(60) THEN A$(400,60)=ECS$(384,60),A$(470,10)=ECS$(444,10); GOSUB 6200
3060 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,7,14,400,60,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
3090 GOTO 2020
3100 REM "% of monthly average usage as ordering limit
3101 IF ECS$(586,1)<>"Y" THEN A$(229,4)=DIM(4); PRINT @(71,5),'CL',; GOTO 3140
3102 X$="% of Avg Monthly usage (used if location levels in eaches not set)"
3110 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,71,5,229,4,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
3112 TEST=NUM(A$(229,4),ERR=3100)
3140 GOTO 2020
3150 REM "secure codes
3155 X$="codes required for access to any coded forms or catalog categories"
3160 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,58,17,233,20,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
3162 TEST$=STP(A$(233,20),2); IF MOD(LEN(TEST$),2)<>0 THEN X$="Secure codes must be two characters in length EACH"; GOTO 3160
3190 GOTO 2020
3200 REM "unused
3210 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,58,10,253,3,C0,M0$,"{3"+X$,"g","ZXY2BAA24","FM2GAA","FM2GAA",""; IF C0=6 THEN GOSUB 6400; C0=1
3215 FIND (Z[4],KEY="g"+A$(253,3),DOM=3240)FMSGROUP$; PRINT @(52,10),'CL',FMSGROUP$(5,27),
3240 GOTO 2020
3250 REM "buyer email actions
3252 IF STP(A$(109,60),3," ")="" THEN A$(256,10)=DIM(10); GOSUB 6200; GOTO 3290
3259 X$=EMAIL_ACTION_PROMPT$
3260 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,69,11,256,10,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
3270 ESTART=255; GOSUB 7750; IF ERESULT<0 THEN GOTO 3250
3290 GOTO 2020
3300 REM "purchasing agent email actions
3302 IF STP(A$(169,60),3," ")="" THEN A$(266,10)=DIM(10); GOSUB 6200; GOTO 3340
3309 X$=EMAIL_ACTION_PROMPT$
3310 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,69,12,266,10,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
3320 ESTART=265; GOSUB 7750; IF ERESULT<0 THEN GOTO 3300
3340 GOTO 2020
3350 REM "csr email actions
3351 IF STP(A$(460,10),3," ")="" THEN A$(460,10)=ECS$(102,5)
3352 IF STP(A$(340,60),3," ")="" THEN A$(460,10)=DIM(10); GOSUB 6200; GOTO 3390
3359 X$=EMAIL_ACTION_PROMPT$
3360 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,69,13,460,10,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
3370 ESTART=459; GOSUB 7750; IF ERESULT<0 THEN GOTO 3350
3390 GOTO 2020
3400 REM "salesperson email actions
3401 IF STP(A$(470,10),3," ")="" THEN A$(470,10)=ECS$(107,5)
3402 IF STP(A$(400,60),3," ")="" THEN A$(470,10)=DIM(10); GOSUB 6200; GOTO 3440
3409 X$=EMAIL_ACTION_PROMPT$
3410 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,69,14,470,10,C0,M0$,"{3"+X$,"","ZXY2BAA24","","",""
3420 ESTART=469; GOSUB 7750; IF ERESULT<0 THEN GOTO 3400
3440 GOTO 2020
3450 REM "Employee?
3451 GOTO 3490
3460 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,18,5,323,1,C0,"","{3"+X$,"","EW3MAA40","","",""
3490 GOTO 2020
3600 REM "Default Cust P/O
3605 X$="Assigned to order if Customer PO left blank when order Buy placed"
3610 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,58,18,307,15,C0,"","{3"+X$,"","EW3MAA44","","",""
3640 GOTO 2020
3650 REM "Show price in catalogs
3651 IF A$(322,1)=" " THEN A$(322,1)=ECS$(41,1)
3660 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,58,19,322,1,C0,"","{3"+X$,"","EW3MAA46","","",""
3690 GOTO 2020
3750 REM "Shipto DDL Group (FM0 cost center)
3751 IF A$(61,4)<>DIM(4) THEN A$(726,9)=DIM(9); GOSUB 6200; GOTO 3790
3755 X$="Shipto DDL will be restricted to shipto's having a matching cost center"
3760 CALL "ZZENTR","AU",A{ALL},A$,X4$,X3$,23,19,726,9,C0,"FMA","{3"+X$,"c"+A$(51,10),"EW3MAA46","AR2MAP","AR2MAP",""; IF ABS(C0)>4 THEN GOSUB 6400
3765 IF A$(726,9)=DIM(9) THEN GOTO 3790
3770 FIND (Z[4],KEY="c"+A$(51,10)+A$(726,9),DOM=3750)FMPC$; PRINT @(20,20),'CL',FMPC$(21,30),
3790 GOTO 2020
3850 REM "testing?"
3860 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,32,5,338,1,C0,"","{3"+X$,"","EW3MAA46","","",""; IF ABS(C0)>4 THEN GOSUB 6400
3890 GOTO 2020
3900 REM "only show active forms in PC based on FM4
3902 IF FMPD$(24,1)<>"Y" THEN GOTO 3940; REM "only available for fms customers
3903 IF STP(A$(61,4),3," ")="" THEN X$="Setting for non-location based buyer will base on active shipto while on-line"; GOTO 3905; REM "ssp 154600
3904 X$="Only display catalog items active for customer ship-to "+A$(61,4)
3910 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,58,16,339,1,C0,"","{3"+X$,"","EW3MAA46","","",""; IF ABS(C0)>4 THEN GOSUB 6400
3940 GOTO 2020
3950 REM "TopForm company code
3955 IF ABS(C0)<>2 THEN GOTO 2020
3960 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,71,4,480,3,C0,"","{3"+X$,"","EW3MAA43","","",""
3990 GOTO 2020
4000 REM "active forms to show in selected category
4001 IF A$(339,1)<>"Y" THEN A$(483,10)=DIM(10); GOSUB 6200; GOTO 4040
4002 IF STP(A$(61,4),3," ")<>"" THEN X$="Set category for display of 'active' items (blank=items will be categorized)" ELSE X$="Active item category must be set for non-location based buyers"
4010 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,69,16,483,10,C0,"","{3"+X$,"","EW3MAA46","ECG","EW3MCA",""; IF ABS(C0)=6 THEN GOSUB 6400
4020 IF A$(483,10)=DIM(10) THEN IF A$(61,4)<>DIM(4) THEN GOTO 4040 ELSE GOTO 4000
4022 FIND (Z[5],KEY=A$(483,10),DOM=4000)ECG$; PRINT @(5,20),'CL',"Category: ",ECG$(11,30),
4040 GOTO 2020
4050 REM "secure code super user
4051 IF A$(233,20)<>DIM(20) THEN A$(86,1)="N"; GOSUB 6200; GOTO 4090
4052 X$="Y will allow access to all category security codes"
4060 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,38,17,86,1,C0,"","{3"+X$,"","EW3MAA16","","",""
4090 GOTO 2020
4100 REM "ignore max limits
4102 IF ECS$(586,1)<>"Y" THEN A$(87,1)="N"; GOSUB 6200; GOTO 4140; REM "if not activated on customer then bypass
4104 X$="Y=will bypass all checking of order maximum limits"
4110 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,63,5,87,1,C0,"","{3"+X$,"","EW3MAA16","","",""
4140 GOTO 2020
4200 REM "default attention                                                    
4205 X$="Will default if the attention line on ship-to is blank"
4210 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,11,20,561,30,C0,"","{3"+X$,"","EW3MAA48"","","",""                                                                "
4240 GOTO 2020
4250 REM "default mark for                                                     
4252 X$="Will default as the mark for instructions on web orders"
4260 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,11,21,591,35,C0,"","{3"+X$,"","EW3MAA50","","",""
4290 GOTO 2020
5800 REM "Alt data reads
5805 FIND (Z[2],KEY=A$(51,10),DOM=5806)IOL=0320
5810 FIND (Z[3],KEY="C"+A$(51,14),DOM=5811)IOL=0330
5812 DIM FMPD$(500); FIND (Z[4],KEY="D"+A$(51,10),DOM=5813)FMPD$
5845 RETURN 
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6060 PRINT @(1,3),"Buyer's id code:",@(35,3),"name:",@(0,4),"Buyer's password:",@(0,6),Z0$,@(41,6),"Session expires after     minutes",@(1,7),"Buyer's customer code:",@(1,8),"Buyer's location code:",
6064 PRINT @(7,5),"Allow O/E?",@(23,5),"Testing?",@(44,5),"Ignore max limits?",@(65,5),"%AMU:",@(0,10),Z0$,@(15,10),"EMAILS",@(69,10),"E-ACTIONS",
6065 PRINT @(0,18),"Restrict order status?",
6070 PRINT @(0,15),Z0$,@(5,15),"ORDER STATUS CONTROLS",@(45,15),"CATALOG CONTROLS",
6071 PRINT @(0,11),"Buyer:",@(1,12),"P.A.:",@(2,13),"CSR:",@(0,14),"Sales:",
6072 PRINT @(34,16),"Only show active forms?",@(34,17),"SU?",@(43,17),"Secured forms:",@(40,18),"Default Cust P/O:",@(32,19),"      Hide catalog price?",
6073 PRINT @(3,16),"Order status types:",@(60,16),"Category:",@(4,19),"Ship-to DDL Group:",
6078 PRINT @(0,20),"Attention:",@(0,21),"Mark for:",
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6205 GOSUB 6450
6206 DIM ECS$(1000); FIND (Z[8],KEY=A$(51,10),DOM=6207)ECS$
6210 PRINT @(42,3),A$(16,35),@(63,6),A$(80,3),; REM "Don't display password until they enter the field
6212 CALL "ZZDISP","A",A$(51,10),"A/R",X3$,"","",24,7,X4$; PRINT @(38,7),B$(11,35),
6213 CALL "ZZDISP","A",A$(726,9),"FMA",X3$,"","",23,19,X4$
6215 PRINT @(24,8),A$(61,4),@(38,8),FM0$(16,35),
6217 PRINT @(9,9),A$(276,15),@(23,18),A$(92,1),@(23,16),A$(97,4),@(7,11),A$(109,60),@(7,12),A$(169,60),@(7,13),A$(340,60),@(7,14),A$(400,60),@(69,11),A$(256,10),@(69,12),A$(266,10),@(69,13),A$(460,10),@(69,14),A$(470,10),@(58,17),A$(233,20),@(58,18),A$(307,15),@(58,19),A$(322,1),@(32,5),A$(338,1),@(58,16),A$(339,1),@(18,5),A$(88,1),@(63,4),A$(324,1),@(69,16),A$(483,10),@(38,17),A$(86,1),@(63,5),A$(87,1),@(71,5),A$(229,4),@(11,20),A$(561,30),@(11,21),A$(591,35),
6304 IF A$(61,4)<>DIM(4) THEN DIM FM0$(500); FIND (Z[3],KEY="C"+A$(51,14),DOM=6305)FM0$
6306 GOSUB 7600
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6460 PRINT @(18,3),A$(1,15),
6490 RETURN 
6500 REM "DELETE
6510 REMOVE (Z[1],KEY=A1$,DOM=6511)
6590 GOTO 1630
6600 REM "ALT KEY DATA READS
6690 RETURN 
6700 REM "ADD ENTRY
6705 IF Z9=0 THEN GOTO 6780
6710 WRITE (Z[1],KEY=A1$)IOL=0310
6712 GOSUB 7500
6780 GOSUB 6400
6790 C9=0; IF Z=6 OR K1=0 THEN GOTO 9900 ELSE IF Z<4 THEN GOTO 1000 ELSE C0=-(3.1+(Z-4)/10); GOTO 6800
6800 REM "NEXT ENTRY IN FILE
6805 ON 10*FPT(C0)+2 GOTO 6850,6806
6810 A1$=KEY(Z[1],END=6895)
6820 IF A1$="" THEN GOTO 6800 ELSE IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 6895
6825 A$(1,LEN(A1$))=A1$
6830 GOSUB 6600
6835 GOSUB 6450
6840 GOTO 1515
6850 REM "PRIOR ENTRY
6855 CALL "ZZKEYP",ERR=6856,Z[1],A1$; GOTO 6820
6856 CALL "ZZPROM","K0",X3$,S3,"","","",0; ON S3 GOTO 6857,9900
6860 PRINT 'RB',; CALL "ZZKEYL",ERR=6861,Z[1],A1$; GOTO 6820
6865 GOTO 1100
6870 GOTO 6895
6890 GOTO 1515
6895 CALL "ZZPROM","K1",X3$,S3,"","","",0; IF S3=1 THEN GOTO 9900 ELSE IF A1$="" THEN GOTO 6860 ELSE PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=6896)
6898 ON S9 GOTO 6810,1100
6900 REM "GET DEFAULTS
6930 RETURN 
6950 REM "WRITE DEFAULT
6970 REM "ENTRY DEFAULTS
6975 PRINT 'CF'; V9=-2,Q$=""
6980 FOR X=1 TO LEN(V9$) STEP 6
6982 REM PRINT @(NUM(V9$(X,2)),NUM(V9$(X+2,2))),; IF V9=-2 THEN PRINT V9$(X+4,1), ELSE READ RECORD (0,SIZ=1) Q$; IF POS(Q$="1234Z")=0 THEN PRINT 'RB'; GOTO 06982
6990 IF Q$="Z" THEN EXITTO 6950 ELSE V9$(X+4,LEN(Q$))=Q$; NEXT X
6995 V9=0; GOTO 6980
7500 REM "Regenerate active web categories
7501 REM "web categories will only be included if:
7502 REM "a) the buyer has the necessary secure code (only if the category has a code)
7503 REM "the category currently has active items"
7505 WRITE (Z[1],KEY=A1$)IOL=0310
7506 IF A$(480,3)<>DIM(3) AND A$(480,3)<>X3$(9,3) THEN GOTO 0754
7510 DIM OPTIONS$(50)
7511 IF A$(61,4)=DIM(4) THEN OPTIONS$(16,1)="Y"; REM "set to ignore the active items for purchasing agents that would prevent publishing (154600)
7520 CALL "EW3UT4",X3$,X4$,A$(1,15),CATEGORIES$,OPTIONS$
7522 ECA2$=CATEGORIES$
7530 WRITE (Z[1],KEY=A1$)IOL=0310
7540 RETURN 
7600 REM "get default warehouse
7602 DIM DFLT_WHSE$(12)
7603 REM "ck for warehouse group
7604 IF STP(ECS$(515,21),3," ")="" THEN GOTO 7612
7606 DFLT_WHSE$="Whse Grp: "+ECS$(515,21); GOTO 7630
7612 IF STP(A$(61,4),3," ")="" THEN GOTO 7620; REM "no location
7614 IF STP(FM0$(284,4),3," ")="" THEN GOTO 7620 ELSE DFLT_WHSE$(1)="Shipto:"+FM0$(284,4); GOTO 7630
7620 REM "get from customer defaults
7622 IF STP(FMPD$(238,4),3," ")="" THEN DFLT_WHSE$(1)="*NeedtoSet*" ELSE DFLT_WHSE$(1)="Cust:"+FMPD$(238,4)
7640 RETURN 
7700 REM "build list of valid order status sorts
7702 PROMPT$=""
7710 IF ECS$(172,10)<>DIM(10) THEN PROMPT$=PROMPT$+"H1="+ECS$(172,10)+"  "
7711 IF ECS$(182,10)<>DIM(10) THEN PROMPT$=PROMPT$+"H2="+ECS$(182,10)+"  "
7712 IF ECS$(192,10)<>DIM(10) THEN PROMPT$=PROMPT$+"H3="+ECS$(192,10)+"  "
7713 IF ECS$(202,10)<>DIM(10) THEN PROMPT$=PROMPT$+"L1="+ECS$(202,10)+"  "
7714 IF ECS$(212,10)<>DIM(10) THEN PROMPT$=PROMPT$+"L2="+ECS$(212,10)+"  "
7715 IF ECS$(222,10)<>DIM(10) THEN PROMPT$=PROMPT$+"L3="+ECS$(222,10)+"  "
7740 RETURN 
7750 REM "test if email actions valid
7755 ERESULT=0
7760 FOR EI=1 TO 10
7762 IF POS(A$(EI+ESTART,1)=EMAIL_ACTIONS$)=0 THEN ERESULT=-1; EXITTO 7770
7764 NEXT EI
7780 RETURN 
7800 REM "copy buyer paramters
7805 DIM COPYBUYER[1],COPYBUYER$(15)
7810 PRINT @(3,21),'CE',"Enter buyer to copy from (blank for manual setup manually):",
7820 CALL "ZZENTR","S",COPYBUYER{ALL},COPYBUYER$,X4$,X3$,63,21,1,15,C0,"","{3"+X$,"","EW3AR110","ECA","",""; IF ABS(C0)>4 THEN GOSUB 6400
7830 IF STP(COPYBUYER$,3," ")="" THEN GOTO 7890
7832 READ RECORD (Z[1],KEY=COPYBUYER$,DOM=7834)COPYREC$; GOTO 7840
7834 CALL "ZZPROM",".4",X3$,Z,"Buyer not on file","","",0; GOTO 7800
7840 COPYREC$(1,15)=A$(1,15); WRITE RECORD (Z[1],KEY=COPYREC$(1,15))COPYREC$; FIND (Z[1],KEY=A$(1,15))IOL=0310; GOSUB 6450; GOSUB 6200
7850 GOSUB 7500
7890 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,1
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
