0010 ! EFGMPA - File Maintenance Program for E/F Parameters
0020 ! Generated by ProvideX® NOMADS II File Maintenance on May. 15, 2003 10:00
0030 ! ************************************************************************
0035 REM "5.7 - 09/12/19 - 13.616944 - jvv - SSP# 307211
0037 REM "307211-Sync common fields in E/F and Proxy Printing parameters     
0040 REM "Copyright 2019 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0070 IF TCB(88)=0 THEN MSGBOX "You must be using Windx to access this program"; GOTO EXIT_PGM
0080 PROCESS "EFGMPA","../PMG/PM.EN"
0082 EXIT_PGM:
0085 IF TCB(13)=1 THEN RUN "ZMENU" ELSE EXIT 
0090 EXIT 
0099 ! 
0100 INIT:
0110 DIM PARAM$(256)
0120 EFKEY$=%C$+"E/F",KEY_SIZE=LEN(EFKEY$)
0130 _ZZPARM=HFN; OPEN (_ZZPARM)"ZZPARM"
0190 RETURN 
0199 ! 
0300 MAIN_POST_DISPLAY:
0310 GOSUB READ_REC
0320 GOSUB LOAD_SCREEN
0330 REFRESH_FLG=1
0390 RETURN 
0399 ! 
0500 WRITE_REC:
0510 GOSUB LOAD_INFO
0520 WRITE (_ZZPARM,KEY=EFKEY$)PARAM$
0525 GOSUB CHECK_PP_PARMS ! SSP 307211
0530 CMD_STR$="E"
0550 RETURN 
0599 ! 
0700 READ_REC:
0710 READ (_ZZPARM,KEY=EFKEY$,DOM=*NEXT)PARAM$
0720 RETURN 
0790 ! 
2000 ! Load Screen with Parameter Information
2010 LOAD_SCREEN:
2020 EF.A001$=PARAM$(1,30); EF.A002$=PARAM$(31,30)
2030 EF.A003$=PARAM$(61,30); EF.A004$=PARAM$(91,30)
2040 EF.A005$=PARAM$(121,30); EF.A006$=PARAM$(151,30)
2050 EF.A007$=PARAM$(181,30)
2060 HOLD_PRINT_DIR$=PARAM$(121,30),HOLD_ARCHIVE_DIR$=PARAM$(181,30) ! SSP 307211
2090 RETURN 
2500 ! load Information into Parameter String
2510 LOAD_INFO:
2520 PARAM$(1,30)=EF.A001$; PARAM$(31,30)=EF.A002$
2530 PARAM$(61,30)=EF.A003$; PARAM$(91,30)=EF.A004$
2540 PARAM$(121,30)=EF.A005$; PARAM$(151,30)=EF.A006$
2550 PARAM$(181,30)=EF.A007$
2560 BASE_PRINT_DIR$=PARAM$(121,30),BASE_ARCHIVE_DIR$=PARAM$(181,30) ! SSP 307211
2590 RETURN 
2593 WRAP_UP:
2596 CLOSE (_ZZPARM)
2610 RETURN 
9999 END 
10010 SET_DEFAULTS:
10050 REM "Modify EFGMPA parameters - ssp 298391
10055 IOLIST EFP$(1)
10058 DIM EFP$(256)
10061 ! READ (Z[13],KEY=%C$+"E/F",DOM=*NEXT)IOL=10055
10064 EFP$(1,30)=STP(X3$(86,40),2)
10070 EFP$(31,30)="/usr/lib/pvx"
10072 EFP$(61,30)="/usr/unform/ufdbd.log"
10074 EFP$(91,30)="/usr/lib/pvx/print"
10076 EFP$(121,30)="/usr/lib/pvx/print"
10078 EFP$(151,30)="/usr/lib/pvx/ufemail"
10080 EFP$(181,30)="/usr/lib/pvx/archive"
10085 WRITE (Z[13],KEY=X3$(9,3)+"E/F",ERR=*NEXT)IOL=10055
10095 RETURN 
10099 ! 
20200 CHECK_PP_PARMS:
20210 CHG=0
20220 PDF_KEY$=%C$+"PDF"
20230 DIM PPARAM$(500); FIND (_ZZPARM,KEY=PDF_KEY$,DOM=*RETURN)PPARAM$
20240 DD$=STP(HOLD_PRINT_DIR$,2),BD$=STP(BASE_PRINT_DIR$,2)
20250 IF BD$<>"" THEN IF DD$<>BD$ THEN PPARAM$(7,60)=BD$+"/"; CHG=1
20260 DD$=STP(HOLD_ARCHIVE_DIR$,2),BD$=STP(BASE_ARCHIVE_DIR$,2)
20270 IF BD$<>"" THEN IF DD$<>BD$ THEN PPARAM$(67,60)=BD$+"/"; CHG=1
20280 IF CHG THEN WRITE (_ZZPARM,KEY=PDF_KEY$)PPARAM$
20290 RETURN 
20299 ! 
56000 REM "194575-Add support for M/1000 pricing on DocuCenter; setup item on the fly
56001 REM "298391-Ability to send E/F emails of Invoices after SJ Update      
56002 REM "307211-Sync common fields in E/F and Proxy Printing parameters     
