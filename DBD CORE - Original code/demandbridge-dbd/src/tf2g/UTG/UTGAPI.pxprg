0010 ! UTGAPI - File Maintenance Program for API
0020 ! Generated by ProvideX® NOMADS II File Maintenance on Jun. 19, 2002 15:17
0030 ! ************************************************************************
0060 ! 
0070 PROCESS "UTGAPI","../UTG/UT.EN"
0080 ! 
0090 EXIT 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0$="UTGAPI"
0140 X0=-1; X2=-1
0150 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
0160 ! 
0170 ! Dim Variables
0180 DIM Z[NUM(X3$(60,3))],API[28],AP5[6]
0190 ! 
0195 DIM VEND_CAT$[100,2],VEND_CODE$[100,2],T_CODE$[100,2],SLS_CODE$[100,2]
0200 ! open files
0210 Z$="01O API...  02O AP2...  03O AP3...  04O AP4...  05O AR3...  06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0300 ! iolist
0310 IOLIST API$,API{ALL}
0320 IOLIST AP2$,AP2{ALL}
0330 IOLIST AP3$,AP3{ALL}
0340 IOLIST GL1$
0350 IOLIST ZYB$
0400 ! 
0450 PROS_FLG=0
0485 REFRESH_FLG=1
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0520 ! 
0530 CALL "$CTL-10;PB_CREATE",0,0,17,1.4,20,1,0
0550 CALL "*wingrp;Show",PROC_1.GRP$
0560 REFESH_FLG=1
0570 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
1000 ! Get the vendors info
1010 PROCESS_FILE:
1015 IF PROS_FLG=1 THEN PROS_FLG=0; GOTO 1040
1020 KEY_1$=""; COUNT=0
1030 READ (Z[1],KEY=KEY_1$,DOM=*NEXT)
1040 KEY_1$=KEY(Z[1],END=END_ROUTINE); READ (Z[1],KEY=KEY_1$)IOL=0310
1050 FIND (Z[3],KEY=API$(69,9),DOM=CAT_ERR)
1060 IF NOT(NUL(API$(114,4))) THEN FIND (Z[5],KEY=API$(114,4),DOM=SLS_ERR)
1070 FIND (Z[2],KEY=API$(27,2),DOM=TERM_ERR)
1080 FIND (Z[4],KEY=API$(1,10),DOM=VEND_ERR)
1090 ++COUNT; CALL "$CTL-10;PB_VALUE",COUNT
1100 GOTO 1030
1300 RETURN 
1500 ! Process Vendor Category
1510 CAT_ERR:
1520 ERR_FLG=1; NOT_FOUND=0
1530 GOSUB FIND_CHANGE
1540 IF NOT_FOUND THEN {
1550 CALL "*wingrp;Show",CAT_1.GRP$; CALL "*wingrp;Show",HEAD_1.GRP$
1560 OLD_VEND_CAT$=API$(69,9); NEXT_ID=NEW_VEND_CAT.CTL
1565 REFRESH_FLG=1; RETURN 
1570  }
1580 GOTO 1060
1590 REFRESH_FLG=1
1595 RETURN 
1600 ! Process Bank Code 
1605 VEND_ERR:
1610 ERR_FLG=2; NOT_FOUND=0
1615 GOSUB FIND_CHANGE
1620 IF NOT_FOUND THEN {
1625 CALL "*wingrp;Show",BANK_1.GRP$; CALL "*wingrp;Show",HEAD_1.GRP$
1630 OLD_VEND_CODE$=API$(1,10); NEXT_ID=NEW_VEND_CODE.CTL
1635 REFRESH_FLG=1; RETURN 
1640  }
1645 GOTO 1070
1650 REFRESH_FLG=1
1655 RETURN 
1700 ! Get the Vendor Information
1705 TERM_ERR:
1710 ERR_FLG=3; NOT_FOUND=0
1715 GOSUB FIND_CHANGE
1720 IF NOT_FOUND THEN {
1725 CALL "*wingrp;Show",TERM_1.GRP$; CALL "*wingrp;Show",HEAD_1.GRP$
1730 OLD_TERMS_CODE$=API$(27,2); NEXT_ID=NEW_TERMS_CODE.CTL
1735 REFRESH_FLG=1; RETURN 
1740  }
1745 GOTO 1080
1750 REFRESH_FLG=1
1755 RETURN 
1800 ! Get the Vendor Information
1805 SLS_ERR:
1810 ERR_FLG=4; NOT_FOUND=0
1815 GOSUB FIND_CHANGE
1820 IF NOT_FOUND THEN {
1825 CALL "*wingrp;Show",GL_1.GRP$; CALL "*wingrp;Show",HEAD_1.GRP$
1830 OLD_SLS_NUM$=API$(114,4); NEXT_ID=NEW_SLS_NUM.CTL
1835 REFRESH_FLG=1; RETURN 
1840  }
1845 GOTO 1090
1850 REFRESH_FLG=1
1855 RETURN 
2000 ! Find The changes requested
2010 FIND_CHANGE:
2015 ARRAY_LINE=0
2020 SWITCH ERR_FLG
2030 CASE 1
2040 FOR XX=1 TO 100
2050 IF NUL(VEND_CAT$[XX,1]) THEN NOT_FOUND=1; ARRAY_LINE=XX; XX=100; GOTO 2090
2060 MATCH$=VEND_CAT$[XX,1]
2070 IF MATCH$(1,9)<>API$(69,9) THEN GOTO 2090
2080 API$(69,9)=VEND_CAT$[XX,2]
2085 GOSUB WRITE_REC
2087 XX=100
2090 NEXT XX
2095 BREAK
2100 CASE 2
2110 FOR XX=1 TO 100
2120 IF NUL(VEND_CODE$[XX,1]) THEN NOT_FOUND=1; ARRAY_LINE=XX; XX=100; GOTO 2170
2130 MATCH$=VEND_CODE$[XX,1]
2140 IF MATCH$(1,10)<>API$(1,10) THEN GOTO 2170
2150 API$(1,10)=VEND_CODE$[XX,2]
2160 GOSUB WRITE_REC
2165 XX=100
2170 NEXT XX
2180 BREAK
2200 CASE 3
2210 FOR XX=1 TO 100
2220 IF NUL(T_CODE$[XX,1]) THEN NOT_FOUND=1; ARRAY_LINE=XX; XX=100; GOTO 2270
2230 MATCH$=T_CODE$[XX,1]
2240 IF MATCH$(1,2)<>API$(27,2) THEN GOTO 2270
2250 API$(27,2)=T_CODE$[XX,2]
2260 GOSUB WRITE_REC
2265 XX=100
2270 NEXT XX
2280 BREAK
2300 CASE 4
2310 FOR XX=1 TO 100
2320 IF NUL(SLS_CODE$[XX,1]) THEN NOT_FOUND=1; ARRAY_LINE=XX; XX=100; GOTO 2370
2330 MATCH$=SLS_CODE$[XX,1]
2340 IF MATCH$(1,4)<>API$(114,4) THEN GOTO 2370
2350 API$(114,4)=SLS_CODE$[XX,2]
2360 GOSUB WRITE_REC
2365 XX=100
2370 NEXT XX
2380 BREAK
2400 END SWITCH 
2900 RETURN 
3000 ! Enter the new Vendor Category
3010 VEND_CAT_ENTRY:
3020 API$(69,9)=NEW_VEND_CAT$
3030 VEND_CAT$[ARRAY_LINE,2]=API$(69,9); VEND_CAT$[ARRAY_LINE,1]=OLD_VEND_CAT$
3040 GOSUB WRITE_REC
3060 CALL "*wingrp;Hide",CAT_1.GRP$; CALL "*wingrp;Hide",HEAD_1.GRP$
3070 PROS_FLG=1; CALL "*wingrp;show",PROC_1.GRP$
3080 REFRESH_FLG=1
3090 RETURN 
3100 ! Enter the new Bank Code
3110 VEND_CODE_ENTRY:
3120 API$(1,10)=NEW_VEND_CODE$
3130 VEND_CODE$[ARRAY_LINE,2]=API$(1,10); VEND_CODE$[ARRAY_LINE,1]=OLD_VEND_CODE$
3140 GOSUB WRITE_REC
3160 CALL "*wingrp;Hide",BANK_1.GRP$; CALL "*wingrp;Hide",HEAD_1.GRP$
3170 PROS_FLG=1; CALL "*wingrp;show",PROC_1.GRP$
3180 REFRESH_FLG=1
3190 RETURN 
3200 ! Enter the new Terms Code
3210 TERM_CODE_ENTRY:
3220 API$(27,2)=NEW_TERMS_CODE$
3230 T_CODE$[ARRAY_LINE,2]=API$(27,2); T_CODE$[ARRAY_LINE,1]=OLD_TERMS_CODE$
3240 GOSUB WRITE_REC
3260 CALL "*wingrp;Hide",TERM_1.GRP$; CALL "*wingrp;Hide",HEAD_1.GRP$
3270 PROS_FLG=1; CALL "*wingrp;show",PROC_1.GRP$
3280 REFRESH_FLG=1
3290 RETURN 
3300 ! Enter the new GL Code
3310 SLS_CODE_ENTRY:
3320 API$(114,4)=NEW_SLS_NUM$
3330 SLS_CODE$[ARRAY_LINE,2]=API$(114,4); SLS_CODE$[ARRAY_LINE,1]=OLD_SLS_NUM$
3340 GOSUB WRITE_REC
3360 CALL "*wingrp;Hide",GL_1.GRP$; CALL "*wingrp;Hide",HEAD_1.GRP$
3370 PROS_FLG=1; CALL "*wingrp;show",PROC_1.GRP$
3380 REFRESH_FLG=1
3390 RETURN 
4000 ! Write record out....
4010 WRITE_REC:
4015 ! 
4020 WRITE (Z[1],KEY=KEY_1$)IOL=0310
4030 ! MSGBOX "The information has been updated...","FYI"
4080 B_AP5$=AP5$
4090 RETURN 
9000 ! End Routine
9010 END_ROUTINE:
9020 ! 
9030 CALL "$CTL-10;PB_DEL"
9050 CMD_STR$="END"
9090 RETURN 
