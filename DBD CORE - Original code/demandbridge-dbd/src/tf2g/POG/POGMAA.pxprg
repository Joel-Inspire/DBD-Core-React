0010 ! POGMAA - Purchase Order Setup
0020 ! Generated by ProvideX® NOMADS II File Maintenance on Nov. 27, 2002 10:15
0030 ! ************************************************************************
0035 REM "5.7 - 03/17/22 - 16.449325 - crg - SSP# 307397
0037 REM "307397-DBD-255 - Impending Whse Receipt notification - 943 XML     
0040 REM "Copyright 2022 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 PROCESS "POGMAA","../POG/PO.EN",PO_NUM$
0060 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 X0$="POGMAA",X1$="Purchase Order Setup"
0125 X2=-1; X0=-1; DEL_FLG=0
0130 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2
0140 DIM Z[NUM(X3$(60,3))],AP4[1],PO2[27],PO3[3],AR1[15],AP2[1],FS2[12]
0150 Z$="01O PO1...  02O AP4...  03O FM0...  04O AR1...  05O AP2...  06O ZZPARM  07O PO4...  08O PO5...  09O PO2...  10O FS2...  11O FS1...  12O PO6...  15O PO3...  16O FTO...  17O AR3...  " ! SSP217284 jdf
0153 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0155 ! 
0160 IOLIST PO1$
0165 IOLIST PO2$,PO2{ALL} ! SSP229416 jdf
0170 IOLIST AP4$,AP4{ALL}
0180 IOLIST FM0$
0190 IOLIST AR1$,AR1{ALL}
0200 IOLIST AP2$,AP2{ALL}
0210 IOLIST FS2$,FS2{ALL}
0220 IOLIST FS1$
0230 IOLIST AR3$ ! SSP217284 jdf
0300 ! setup messages
0400 ! 
0410 GOSUB GET_PARAM
0420 ! 
0430 %GRID=0
0460 ! 
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0520 IF STP(ARG_1$)<>"" THEN PO_NUMBER$=ARG_1$
0530 GOSUB FIND_REC
0560 REFRESH_FLG=1
0570 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 %CUST_DIV$=""; %CUST_CODE$=""; %CUSTOMER$=""
0930 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
1000 ! Get Purchase Order Information
1010 FIND_REC:
1015 IF NUL(PO_NUMBER$) THEN RETURN 
1020 KEY_1$=PO_NUMBER$
1030 READ (Z[1],KEY=PO_NUMBER$,DOM=NEW_PO)IOL=0160
1040 ! 
1050 GOSUB LOAD_INFO
1060 ! 
1070 CALL "*wingrp;Enable",BUTTONS.GRP$
1075 NEXT_ID=BUTTON_3.CTL
1080 REFRESH_FLG=1
1090 RETURN 
2000 ! Load the Initial screen
2010 LOAD_INFO:
2015 ORDER_DIV$=PO1$(306,2); ORDER_NUM$=PO1$(308,6) ! [193783,189102]
2020 VENDOR$=PO1$(7,10); GOSUB GET_VENDOR_INFO
2030 PO_DATE$=PO1$(192,6); DATE_REQ$=PO1$(204,6)
2040 PLANT_CODE$=PO1$(17,4); PLANT_NAME$=PO1$(21,35); PLANT_ATTN$=PO1$(56,30)
2050 PLANT_ADDR_1$=PO1$(86,30); PLANT_ADDR_2$=PO1$(116,30)
2060 PLANT_CITY$=PO1$(146,16); PLANT_ST$=PO1$(162,2); PLANT_ZIP_CODE$=PO1$(164,9)
2065 PLANT_COUNTRY$=PO1$(368,2) ! SSP 307210
2070 PO_TYPE$=PO1$(173,1); PRINT_THIS_PO$=PO1$(189,1); NEW_REPEAT$=PO1$(190,1)
2080 CONFIRMING$=PO1$(191,1); GROUPING_CUTOFF_DATE$=PO1$(198,6)
2090 SEND_UNITED_DATA$=PO1$(352,1); TERMS_CODE$=PO1$(210,2)
2095 VEND_XML_DATA$=PO1$(2,1),IWR_XML_SENT$=PO1$(3,1) ! ssp 200962, DBD-255
2100 PLANT_QUOTE_NUM$=PO1$(212,12); PLANT_QUOTE_NUM_DATE$=PO1$(224,6)
2110 RUSH_PER$=PO1$(314,12); RUSH_DAYS$=PO1$(326,2)
2120 PREV_JOB_NUM$=PO1$(230,12); PREV_JOB_DATE$=PO1$(242,6)
2130 THIS_JOB_NO$=PO1$(248,12); THIS_JOB_DATE$=PO1$(260,6)
2140 JOB_STATUS$=PO1$(266,12); JOB_STATUS_DATE$=PO1$(278,6)
2150 PROOF_STATUS$=PO1$(284,1); PROOF_ST_DATE$=PO1$(285,6)
2156 CUST_REP$=PO1$(347,4),CUST_NO$=PO1$(179,10),CUST_PO$=PO1$(328,15),SPER_CODE$=PO1$(343,4) ! SSP217284  jdf
2160 SCHED_SHIP_DATE$=PO1$(291,6)
2165 CUST_PO_TP$=PO1$(361,1); REM SSP 203803
2170 OPER_CODE_LAST_MOD$=PO1$(358,3); IF STP(OPER_CODE_LAST_MOD$)="" THEN OPER_CODE_LAST_MOD$=%X3$(40,3) ! SSP 191685
2172 IF PRINT_PO_FLAG$="N" THEN PRINT_THIS_PO$=PRINT_PO_FLAG$ ! [193783,189102]
2175 GOSUB GET_OPER_NAME ! ssp 191685
2180 REFRESH_FLG=1
2190 RETURN 
2300 ! Load the Record
2310 LOAD_RECORD:
2320 PO1$(7,10)=VENDOR$
2330 PO1$(192,6)=PO_DATE$; PO1$(204,6)=DATE_REQ$
2340 PO1$(17,4)=PLANT_CODE$; PO1$(21,35)=PLANT_NAME$; PO1$(56,30)=PLANT_ATTN$
2350 PO1$(86,30)=PLANT_ADDR_1$; PO1$(116,30)=PLANT_ADDR_2$
2360 PO1$(146,16)=PLANT_CITY$; PO1$(162,2)=PLANT_ST$; PO1$(164,9)=PLANT_ZIP_CODE$
2365 PO1$(368,2)=PLANT_COUNTRY$ ! SSP 307210
2370 PO1$(173,1)=PO_TYPE$; PO1$(189,1)=PRINT_THIS_PO$; PO1$(190,1)=NEW_REPEAT$
2380 PO1$(191,1)=CONFIRMING$; PO1$(198,6)=GROUPING_CUTOFF_DATE$
2390 PO1$(352,1)=SEND_UNITED_DATA$; PO1$(210,2)=TERMS_CODE$
2391 PO1$(361,1)=CUST_PO_TP$; REM SSP 198988
2395 PO1$(2,1)=VEND_XML_DATA$,PO1$(3,1)=IWR_XML_SENT$ ! ssp 200962, DBD-255
2400 PO1$(212,12)=PLANT_QUOTE_NUM$; PO1$(224,6)=PLANT_QUOTE_NUM_DATE$
2410 PO1$(314,12)=RUSH_PER$; PO1$(326,2)=RUSH_DAYS$
2420 PO1$(230,12)=PREV_JOB_NUM$; PO1$(242,6)=PREV_JOB_DATE$
2430 PO1$(248,12)=THIS_JOB_NO$; PO1$(260,6)=THIS_JOB_DATE$
2440 PO1$(266,12)=JOB_STATUS$; PO1$(278,6)=JOB_STATUS_DATE$
2450 PO1$(284,1)=PROOF_STATUS$; PO1$(285,6)=PROOF_ST_DATE$
2455 PO1$(179,10)=CUST_NO$; PO1$(328,15)=CUST_PO$; PO1$(343,4)=SPER_CODE$; PO1$(347,4)=CUST_REP$ ! SP217284 jdf
2460 PO1$(291,6)=SCHED_SHIP_DATE$
2470 PO1$(297,9)=PO_NUMBER$
2475 PO1$(361,1)=CUST_PO_TP$; REM SSP 201803
2480 PO1$(358,3)=OPER_CODE_LAST_MOD$ ! SSP 191685
2490 RETURN 
3000 ! Get the Vendor's Information.
3010 GET_VENDOR_INFO:
3020 IF NUL(VENDOR$) THEN RETURN 
3030 READ (Z[2],KEY=VENDOR$,DOM=*RETURN)IOL=0170
3040 VEND_CONT_PERSON$=AP4$(155,20)
3050 VEND_ADDR_1$=AP4$(46,30); VEND_ADDR_2$=AP4$(76,30)
3060 VEND_CITY$=AP4$(106,16); VEND_ST$=AP4$(122,2); VEND_ZIP$=AP4$(124,9)
3070 PLANT_NAME$=AP4$(11,35); PLANT_ATTN$=AP4$(155,20)
3080 PLANT_ADDR_1$=AP4$(46,30); PLANT_ADDR_2$=AP4$(76,30)
3090 PLANT_CITY$=AP4$(106,16); PLANT_ST$=AP4$(122,2); PLANT_ZIP_CODE$=AP4$(124,9)
3100 TERMS_CODE$=AP4$(286,2)
3110 CUST_PO_TP$=AP4$(402,1); %CUST_PO_TP$=CUST_PO_TP$; REM SSP 198988
3120 SPC$=AP4$(223,8) ! [193783,189102]
3130 OPTIONS$=AP4$(382,20) ! [193783,189102]
3160 %VENDOR$=VENDOR$,%PLANT_VEND$=VENDOR$ ! SSP#208084
3165 IF STP(SPC$)="PO2XML" AND POS("E"=OPTIONS$)>0 THEN PRINT_PO_FLAG$="N"; PRINT_THIS_PO$="N" ! [193783,189102] set the print this po flag
3170 NEXT_ID=PLANT_CODE.CTL
3180 REFRESH_FLG=1
3190 RETURN 
3200 ! Get Vendor's Shipping Location
3210 GET_PLANT_CODE:
3215 IF STP(PLANT_CODE$)<>"" THEN PLANT_CODE$=PAD(PLANT_CODE$,4,0,"0") ELSE RETURN 
3220 KEY_3$="P"+VENDOR$+PLANT_CODE$
3230 READ (Z[3],KEY=KEY_3$,DOM=*RETURN)IOL=0180
3240 PLANT_NAME$=FM0$(16,35); PLANT_ATTN$=FM0$(160,20)
3250 PLANT_ADDR_1$=FM0$(51,30); PLANT_ADDR_2$=FM0$(81,30)
3260 PLANT_CITY$=FM0$(111,16); PLANT_ST$=FM0$(127,2); PLANT_ZIP_CODE$=FM0$(129,9)
3270 PLANT_COUNTRY$=FM0$(380,2) ! SSP 307210
3280 REFRESH_FLG=1
3290 RETURN 
4000 ! Update Record
4010 WRITE_REC:
4015 IF STP(PO1$(7,10),2)="" THEN MSGBOX MSG("CD3ERR_04"),MSG("MB_ATTN"),"!"; NEXT_ID=VENDOR.CTL; RETURN ! SSP 273752
4020 ANS$="YES" ! MSGBOX MSG("ADD_RECORD"),MSG("VERIFY"),"?,YESNO",ANS$
4030 IF ANS$="NO" THEN RETURN 
4035 IF %NEW_PO THEN READ (Z[1],KEY="  ",DOM=*NEXT)
4040 WRITE (Z[1],KEY=KEY_1$)IOL=0160
4080 IF %NEW_PO THEN PROCESS "POGMAB","../POG/PO.EN",PO_NUMBER$; CMD_STR$="END"
4090 RETURN 
4100 ! Write record on exit  ! SSP217284  jdf
4110 WRITE_ON_EXIT:! SSP217284 jdf
4120 DIM PO1$(383) ! SSP217284 jdf
4130 GOSUB LOAD_RECORD ! SSP217284 jdf
4135 IF STP(VENDOR$)="" THEN ARG_1$=""; RETURN ! SSP226717 jdf
4140 WRITE (Z[1],KEY=PO_NUMBER$)IOL=0160 ! SSP217284 jdf
4150 RETURN ! SSP217284  jdf
4200 ! Delete Purchase Order
4210 DELETE_REC:
4220 DIM FTO$(60); READ (Z[16],KEY=PO_NUMBER$,DOM=*NEXT)FTO$; MSGBOX MSG("POGMAG_05",FTO$(10,4),FTO$(14,3)),MSG("MB_ATTN"),"!"; RETURN 
4250 MSGBOX MSG("DELETE_REC"),MSG("VERIFY"),"?,YesNo",ANS$
4260 IF ANS$="NO" THEN RETURN 
4265 IF DELETE_HIDE THEN MSGBOX "Access Denied, this Purchase Order has been received, you may not delete it",MSG("WARNING"),"!"; RETURN ! SSP229416 jdf 
4270 %DEL_FLG=1
4280 FIND (Z[1],KEY=PO_NUMBER$,DOM=*RETURN)PO1_DEL$ ! WO252273, need PO1_DEL$ for FV3
4290 REMOVE (Z[1],KEY=PO_NUMBER$); CALL "FM2DEL;WRITE_FV3",X3$,X4$,PO1_DEL$,FM2DEL_OTHER$ ! WO252273
4300 KEY_9$=PO_NUMBER$
4310 READ (Z[9],KEY=KEY_9$,DOM=*NEXT)
4320 KEY_9$=KEY(Z[9],END=4360); READ (Z[9],KEY=KEY_9$)
4330 IF KEY_9$(1,9)<>PO_NUMBER$ THEN GOTO 4360
4340 REMOVE (Z[9],KEY=KEY_9$)
4350 GOTO 4320
4360 KEY_15$=PO_NUMBER$
4370 READ (Z[15],KEY=KEY_15$,DOM=*NEXT)
4380 KEY_15$=KEY(Z[15],END=*RETURN); READ (Z[15],KEY=KEY_15$)
4390 IF KEY_15$(1,9)<>PO_NUMBER$ THEN RETURN 
4400 REMOVE (Z[15],KEY=KEY_15$)
4410 GOTO 4380
4420 RETURN 
4500 ! Get Sales information
4510 GET_SALES:! SSP217284 jdf
4520 READ (Z[4],KEY=CUST_NO$,DOM=*RETURN)IOL=0190 ! SSP217284 jdf
4530 SPER_CODE$=AR1$(278,4) ! SSP217284 jdf
4535 GET_SALES_NAME:! SSP217284 jdf
4540 READ (Z[17],KEY=SPER_CODE$,DOM=*RETURN)IOL=0230 ! SSP217284 jdf
4550 SPER_NAME$=STP(AR3$(5,35)) ! SSP217284 jdf
4560 REFRESH_FLG=1 ! SSP217284 jdf
4570 RETURN ! SSP217284 jdf
4600 GET_CSR_NAME:! SSP217284 jdf
4610 READ (Z[17],KEY=CUST_REP$,DOM=*RETURN)IOL=0230 ! SSP217284 jdf
4620 CSR_NAME$=STP(AR3$(5,35)) ! SSP217284 jdf
4630 REFRESH_FLG=1 ! SSP217284 jdf
4640 RETURN ! SSP217284 jdf
7400 ! Check Audit Report
7410 CHECK_AUDIT:
7420 FIND (Z[1],KEY="",DOM=*RETURN)V0$,K0$
7430 IF K4$>"" THEN MSGBOX MSG("UPDATE_ST"),MSG("WARNING"),"STOP"; CMD_STR$="END"; RETURN 
7440 EXTRACT (Z[1],KEY="",ERR=WRAPUP)
7450 MSGBOX MSG("AUDIT_RPT")+" "+V0$(22,4)+"."+V0$(26,2)+MSG("HAS_PRT")+"."+SEP+MSG("CONTINUE?"),MSG("VERIFY"),"?,YesNo",ANS$
7460 IF ANS$="NO" THEN GOTO WRAPUP
7470 REMOVE (Z[1],KEY="")
7490 RETURN 
8000 ! New Order
8010 NEW_PO:
8020 DIM PO1$(383)
8030 %NEW_PO=1
8040 PO_TYPE$="S"; PRINT_THIS_PO$="Y"
8050 PO_DATE$=%X3_TODAY$; DATE_REQ$=%X3_TODAY$
8060 NEXT_ID=VENDOR.CTL
8070 CALL "*WINGRP;ENABLE",BUTTONS.GRP$
8075 OPER_CODE_LAST_MOD$=%X3$(40,3); GOSUB GET_OPER_NAME ! SSP 191685
8077 IF STP(CUST_REP$)="" THEN CUST_REP$=%CUST_SERV_REP$ ! SSP217284  jdf
8078 IF STP(CSR_NAME$)="" THEN CSR_NAME$=%CSR_NAME$ ! SSP217284 jdf
8080 REFRESH_FLG=1
8090 RETURN 
9000 ! SYSTEM PARAMETERS
9010 GET_PARAM:
9020 READ (Z[6],KEY=X3$(9,3)+"I/C")P0$
9030 READ (Z[6],KEY=X3$(9,3)+"F/M")P2$
9040 READ (Z[6],KEY=X3$(9,3)+"OSP",DOM=*NEXT)OSP_PARMS$
9050 READ (Z[6],KEY=X3$(9,3)+"A/R")AR_PARMS$
9090 RETURN 
9999 END 
10000 GET_OPER_NAME: REFRESH_FLG=1 ! SSP 191685
10010 OPER_CODE_LAST_MOD$=PAD(OPER_CODE_LAST_MOD$,3," ")
10020 READ (Z(6),KEY="o"+OPER_CODE_LAST_MOD$,DOM=NO_OPER)OP_NAME$
10030 OP_NAME$=OP_NAME$(5,30)
10040 RETURN 
10050 NO_OPER: OPER_CODE_LAST_MOD$="",NEXT_ID=OPER_CODE_LAST_MOD.CTL; EXIT 
11000 PERMIT_DELETE:! SSP229416 jdf
11001 DELETE_HIDE=0 ! SSP229416 jdf
11003 PER_KEY$=ARG_1$ ! SSP229416 jdf
11004 IF PER_KEY$(9,1)<>" " THEN GOTO 11090 ! SSP229416 jdf
11030 READ (Z[9],KEY=PER_KEY$,DOM=*NEXT) ! SSP229416 jdf
11040 PER_Q1$=KEY(Z[9],END=11090) ! SSP229416 jdf
11050 IF PER_KEY$<>PER_Q1$(1,9) THEN GOTO 11090 ! SSP229416 jdf
11060 READ (Z[9],KEY=PER_Q1$)IOL=0165 ! SSP229416 jdf
11065 IF PO2[6]<>0 THEN DELETE_HIDE=1 ! SSP229416 jdf
11070 IF PO2[7]<>0 THEN DELETE_HIDE=1 ! SSP229416 jdf
11080 GOTO 11040 ! SSP229416 jdf
11150 RETURN ! SSP229416 jdf
56000 REM "191685-Stock P/O 334 will not print, see notes. PO 344 will not    
56001 REM "       print either."
56002 REM "198988-Manage Customer Supplied Inventory. Item Setup, Purch ord 
56003 REM "203803-PO/P1 orders closing if received in full - panel POGMAA.2, msg CSPO
56006 REM "193783-189102;Added new field, options, to Vendor Setup, AP4 file
56008 REM "217284-Issue with Stock PO's missing fields on PO Header           
56010 REM "226717-POGMAM - PO1 record is being left when you select option to 
56012 REM "229416-Is there a way to restrict users from deleting POs after    
56014 REM "252273-New Deleted Order and Deleted PO file. Modify delete routine
56015 REM "273752-GUI stock order entry does not require operator to enter a  
56016 REM "307210-International shipping address - add country code           
56017 REM "307397-DBD-255 - Impending Whse Receipt notification - 943 XML     
