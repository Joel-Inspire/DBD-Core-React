0010 REM "Update FS6 for Stock POs <POGMAK>
0035 REM "5.7 - 06/17/21 - 12.452912 - jvv - SSP# 307357
0037 REM "307357-Update FS6 to allow for more line numbers                   
0040 REM "Copyright 2021 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 ! SETERR 9000
0330 IOLIST C$,C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8]
0340 IOLIST D$
0350 IOLIST E$,E[0],E[1],E[2],E[3],E[4]
1010 REM "A$=PO1 DATA, B$=PO2 DATA, F0=FS6 FILE DEVICE
1020 ENTER X3$,A$,A{ALL},B$,B{ALL},F0,C0$
1030 RT_PARM$=""; CALL "RTGPRM",ERR=*NEXT,RT_PARM$
1100 REM 
1105 X0$="POGMAK"
1110 DIM Z[NUM(X3$(60,3))]
1120 Z$="01O FS6...  020 FS7... 03O FS8...  04O FM0... 05O PO3...  13O ZZPARM  "; GOSUB 9700
1125 _FS6=Z[1],_FS7=Z[2],_FS8=Z[3],_FM0=Z[4],_PO3=Z[5],_ZZPARM=Z[13]
1140 READ (_ZZPARM,KEY=%C$+"F/M")F9$
1200 REM 
1220 DIM C$(163),C[8],E[4],S$(40) ! SSP 307357
1240 C$(1,10)=B$(91,10),T0$="B",C[0]=B[11]
1244 IF F9$(195,1)="Y" THEN GOSUB 2000; GOSUB 2300
1245 C$(12,10)=B$(101,10)
1247 C$(22,8)=B$(82,9),C$(30,1)=CHR(NUM(B$(7,3))+48)
1248 C$(114,3)=B$(7,3),C$(117,3)="001" ! SSP 307357
1250 IF C0$<>"-1" THEN GOTO 1300
1252 FOR I=1 TO LEN(T0$)
1253 C$(11,1)=T0$(I,1); IF I=2 THEN C[0]=T0
1255 REMOVE (_FS6,KEY=C$(1,30),DOM=1256)
1256 IF RT_PARM$<>"" THEN CUST$=C$(1,10); CALL "RTGWOC",ERR=*NEXT,CUST$,"FS6...","D",C$(1,30)
1260 Q$=C$(31,3)+C$(11,1)+C$(12,10)+C$(1,10)+C$(22,9)
1265 REMOVE (_FS7,KEY=Q$,DOM=1266)
1270 Q$=C$(1,10)+C$(22,8)+C$(11,1)+C$(12,10)+C$(30,1)
1275 REMOVE (_FS8,KEY=Q$,DOM=1276)
1285 NEXT I
1290 GOTO 9900
1300 REM 
1330 C$(31,3)=B$(25,3),C$(34,6)=A$(192,6)
1335 C$(69,12)=B$(119,12),C$(87,10)=A$(7,10),C$(97,4)=A$(17,4)
1340 C$(101,4)=B$(77,4)
1345 C$(54,15)=A$(328,15)
1400 REM 
1410 C[1]=0,C[2]=B[2],C[3]=B[19],C[4]=B[0]
1415 IF B[20]<>0 THEN C[1]=B[21]*B[2]/B[20]; REM "Selling Price
1420 REM LET C(5)=B(9),C(6)=B(15),C(7)=B(13) THIS SHOULD ONLY BE SET FROM A/R BILLING 3/16/95
1450 REM 
1460 FOR I=1 TO LEN(T0$)
1470 C$(11,1)=T0$(I,1); IF I=2 THEN C[0]=T0
1520 WRITE (_FS6,KEY=C$(1,30))IOL=0330; IF RT_PARM$<>"" THEN CUST$=C$(1,10); CALL "RTGWOC",ERR=*NEXT,CUST$,"FS6...","U",C$(1,30)
1525 Q$=C$(31,3)+C$(11,1)+C$(12,10)+C$(1,10)+C$(22,9)
1530 WRITE (_FS7,KEY=Q$)
1535 Q$=C$(1,10)+C$(22,8)+C$(11,1)+C$(12,10)+C$(30,1)
1540 WRITE (_FS8,KEY=Q$)
1580 NEXT I
1590 GOTO 9900
2000 REM "Get quantitiy going to hidden warehouse
2010 T0=0
2020 READ (_PO3,KEY=B$(82,9)+S$(1,4),DOM=2090)IOL=0350
2030 IF B$(14,1)<>"Y" THEN GOSUB 2200; GOTO 2080
2040 READ (_PO3,END=2080)IOL=0350
2050 IF B$(82,9)+B$(7,3)<>E$(166,9)+E$(7,3) THEN GOTO 2080
2060 GOSUB 2200
2070 GOTO 2040
2080 REM 
2090 RETURN 
2200 REM "Get Hidden Whse Quantity
2220 READ (_FM0,KEY="D"+S$(1,10)+E$(12,4),DOM=2290)IOL=0340
2230 IF D$(234,1)<>"Y" THEN GOTO 2290
2240 IF B$(14,1)<>"Y" THEN T0=C[0] ELSE T0=T0+E[0]
2290 RETURN 
2300 REM "Set up to 2 order types per line
2310 C[0]=B[11]
2320 IF T0<>0 THEN C[0]=C[0]-T0; IF C[0]=0 THEN C[0]=T0,T0$="Z" ELSE T0$="BZ"
2340 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9700 REM 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9910 Z$="END"; GOSUB 9700
9930 SETERR 9940; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
56001 REM "307357-Update FS6 to allow for more line numbers                   
