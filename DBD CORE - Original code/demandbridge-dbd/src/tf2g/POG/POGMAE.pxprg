0010 ! POGMAE - File Maintenance Program for AT5_CashReceiptEnt (="AT5"+%C$)
0020 ! Generated by ProvideX® NOMADS II File Maintenance on Nov. 27, 2002 10:15
0030 ! ************************************************************************
0035 REM "5.7 - 11/27/19 - 9.824444 - jvv - SSP# 307210
0037 REM "307210-International shipping address - add country code           
0040 REM "Copyright 2019 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 PROCESS "POGMAE","../POG/PO.EN",PO_NUM$
0060 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 X0$="POGMAE",X1$="Cash Receipts Entry"
0125 X2=-1; X0=-1; DEL_FLG=0
0130 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2
0140 DIM Z[NUM(X3$(60,3))],AP4[1],PO2[27],PO3[3],AR1[15],AP2[1],FS2[12]
0145 DIM PO3$(428) ! SSP 307210
0150 Z$="01O PO3...  02O PO1...  03O FMP...  04O AR4...  05O AR1...  06O ZZPARM  07O FM0...  "
0153 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0155 ! 
0160 IOLIST PO3$(1,LEN(PO3$)),PO3{ALL} ! SSP 307210
0170 IOLIST AP4$,AP4{ALL}
0180 IOLIST FM0$
0190 IOLIST AR1$,AR1{ALL}
0200 IOLIST AP2$,AP2{ALL}
0210 IOLIST FS2$,FS2{ALL}
0220 IOLIST FS1$
0300 ! setup messages
0400 ! 
0410 GOSUB GET_PARAM
0460 ! 
0480 %GRID=0
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0520 IF STP(ARG_1$)<>"" THEN PO_NUMBER$=ARG_1$
0530 GOSUB FIND_REC
0540 GOSUB LOAD_FOB; GOSUB LOAD_SHIP_VIA; GOSUB LOAD_SHIP_VIA_CODE ! SSP235581 jdf
0560 REFRESH_FLG=1
0570 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 %CUST_DIV$=""; %CUST_CODE$=""; %CUSTOMER$=""
0930 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
1000 ! Get Purchase Order Information
1010 FIND_REC:
1015 IF NUL(PO_NUMBER$) THEN RETURN 
1020 KEY_1$=PO_NUMBER$+DIM(4)
1030 READ (Z[1],KEY=KEY_1$,DOM=NEW_PO)IOL=0160
1040 ! 
1050 GOSUB LOAD_INFO
1060 ! 
1070 CALL "*wingrp;Enable",BUTTONS.GRP$
1075 NEXT_ID=BT_EXIT.CTL
1080 REFRESH_FLG=1
1090 RETURN 
2000 ! Load the Initial screen
2010 LOAD_INFO:
2020 LOC_TYPE$=PO3$(11,1)
2030 LOC_CODE$=PO3$(12,4); GOSUB GET_LOC_CODE
2040 ATTN_NAME$=PO3$(16,30); LOC_ADDR_1$=PO3$(46,30); LOC_ADDR_2$=PO3$(76,30),LOC_NAME$=PO3$(225,35) ! SSP#233024
2050 LOC_CITY$=PO3$(106,16); LOC_ST$=PO3$(122,2); LOC_ZIP_CODE$=PO3$(124,9)
2055 LOC_COUNTRY$=MID(PO3$,383,2) ! SSP 307210
2060 FOB_3$=PO3$(133,1); HOW_TO_SHIP_CODE_3$=PO3$(134,1)
2070 SHIP_VIA_CODE_3$=PO3$(150,1) ! +"-"+PO3$(210,15); SHIP_WITH_3$=PO3$(151,15) ! SSP217284 jdf ! SSP235581 jdf
2075 SHIP_WITH_3$=PO3$(151,15),SHIP_VIA_DESC$=PO3$(210,15) ! SSP235581 jdf
2080 MARK_FOR_3$=PO3$(175,35)
2085 INSIDE_DELIVERY_3$=PO3$(135,15) ! SSP#202696
2090 ! SHIP_QTY=PO3[0]
2180 REFRESH_FLG=1
2190 RETURN 
2300 ! Load the Record
2310 LOAD_RECORD:
2315 PO3$(7,3)=LINE_NUM$; PO3$(10,1)=SEQ_NUM$; PO3$(166,9)=PO_NUMBER$
2320 PO3$(11,1)=LOC_TYPE$
2330 PO3$(12,4)=LOC_CODE$
2340 PO3$(16,30)=ATTN_NAME$; PO3$(46,30)=LOC_ADDR_1$; PO3$(76,30)=LOC_ADDR_2$,PO3$(225,35)=LOC_NAME$ ! SSP#233024
2350 PO3$(106,16)=LOC_CITY$; PO3$(122,2)=LOC_ST$; PO3$(124,9)=LOC_ZIP_CODE$
2355 PO3$(383,2)=LOC_COUNTRY$ ! SSP 307210
2360 PO3$(133,1)=FOB_3$; PO3$(134,1)=HOW_TO_SHIP_CODE_3$
2370 PO3$(150,1)=SHIP_VIA_CODE_3$(1,1); IF LEN(SHIP_VIA_CODE_3$)=1 THEN PO3$(210,15)=SHIP_VIA_DESC$ ELSE PO3$(210,15)=STP(SHIP_VIA_CODE_3$(5),1) ! SSP217284 jdf  SSP235581 jdf
2375 IF SHIP_VIA_CODE_3$=" " THEN PO3$(210,15)="               " ! SSP235581 jdf
2380 PO3$(175,35)=MARK_FOR_3$,PO3$(151,15)=SHIP_WITH_3$ ! SSP235581 jdf
2385 PO3$(135,15)=INSIDE_DELIVERY_3$ ! SSP#202696
2390 ! PO3[0]=SHIP_QTY
2490 RETURN 
3200 ! Get Vendor's Shipping Location
3210 GET_LOC_CODE:
3213 IF NUL(LOC_CODE$) THEN NEXT_ID=LOC_CODE.CTL; RETURN 
3214 IF STP(LOC_CODE$)<>"" THEN LOC_CODE$=PAD(LOC_CODE$,4,0,"0") ELSE RETURN 
3215 IF %CUST_PO_TP$="Y" THEN IF LOC_CODE$<"9000" THEN GOSUB CUST_VEND_MSG; NEXT_ID=LOC_CODE.CTL; RETURN ; REM SSP 198988"
3216 IF %CUST_PO_TP$="Y" THEN KEY_7$="D"+DIM(10)+LOC_CODE$; GOTO 3230; REM SSP 198988
3217 IF LOC_CODE$>="9000" THEN GOSUB LOC_MSG; NEXT_ID=LOC_CODE.CTL; RETURN 
3220 KEY_7$="D"+DIM(10)+LOC_CODE$
3230 READ (Z[7],KEY=KEY_7$,DOM=*RETURN)IOL=0180
3240 LOC_NAME$=FM0$(16,35)
3245 ATTN_NAME$=FM0$(160,20) ! SSP#233024
3250 LOC_ADDR_1$=FM0$(51,30); LOC_ADDR_2$=FM0$(81,30)
3255 LOC_CITY$=FM0$(111,16); LOC_ST$=FM0$(127,2); LOC_ZIP_CODE$=FM0$(129,9)
3260 LOC_COUNTRY$=MID(FM0$,380,2) ! SSP 307210
3270 NEXT_ID=ATTN_NAME.CTL
3280 REFRESH_FLG=1
3290 RETURN 
4000 ! Update Record
4010 WRITE_REC:
4020 ! MSGBOX MSG("ADD_RECORD"),MSG("VERIFY"),"?,YESNO",ANS$
4030 ! IF ANS$="NO" THEN RETURN 
4035 IF %NEW_PO THEN READ (Z[1],KEY="  ",DOM=*NEXT)
4040 WRITE (Z[1],KEY=KEY_1$)IOL=0160
4080 ! IF %NEW_PO THEN PROCESS "POGMAB","../POG/PO.EN",PO_NUMBER$
4090 RETURN 
4200 ! DELETE RECORD
4210 DELETE_REC:
4220 MSGBOX MSG("DEL_RECORD"),MSG("VERIFY"),"?,YESNO",ANS$
4230 IF ANS$="NO" THEN RETURN 
4240 REMOVE (Z[1],KEY=KEY_1$)
4250 CMD_STR$="END"
4290 RETURN 
7400 ! Check Audit Report
7410 CHECK_AUDIT:
7420 FIND (Z[1],KEY="",DOM=*RETURN)V0$,K0$
7430 IF K4$>"" THEN MSGBOX MSG("UPDATE_ST"),MSG("WARNING"),"STOP"; CMD_STR$="END"; RETURN 
7440 EXTRACT (Z[1],KEY="",ERR=WRAPUP)
7450 MSGBOX MSG("AUDIT_RPT")+" "+V0$(22,4)+"."+V0$(26,2)+MSG("HAS_PRT")+"."+SEP+MSG("CONTINUE?"),MSG("VERIFY"),"?,YesNo",ANS$
7460 IF ANS$="NO" THEN GOTO WRAPUP
7470 REMOVE (Z[1],KEY="")
7490 RETURN 
8000 ! New Order
8010 NEW_PO:
8020 DIM PO3$(428) ! SSP 307210
8030 %NEW_PO=1
8040 LOC_TYPE$="D"
8047 SVC$="/"+SHIP_DFLT$(21,1); CNT=POS(SVC$=%SHIP_VIA_CT$); CNT=CNT+3; SHIP_DESC$=%SHIP_VIA_CT$(CNT,POS("/"=%SHIP_VIA_CT$(CNT))-1) ! SSP217284 jdf
8050 FOB_3$=SHIP_DFLT$(19,1); HOW_TO_SHIP_CODE_3$=SHIP_DFLT$(20,1); SHIP_VIA_CODE_3$=SHIP_DFLT$(21,1)+"-"+SHIP_DESC$ ! SSP217284 jdf
8060 NEXT_ID=LOC_CODE.CTL
8070 CALL "*WINGRP;ENABLE",BUTTONS.GRP$
8080 REFRESH_FLG=1
8090 RETURN 
8200 ! Location Message
8210 LOC_MSG:
8220 MSGBOX MSG("POGMAD_02"),MSG("FYI"),"STOP"
8290 RETURN 
8300 REM "Customer Supplied Vendor message SSP 198988
8310 CUST_VEND_MSG:
8320 MSGBOX MSG("POGMAD_04"),MSG("FYI"),"STOP"
8350 RETURN 
9000 ! SYSTEM PARAMETERS
9010 GET_PARAM:
9020 READ (Z[6],KEY=X3$(9,3)+"I/C")P0$
9030 READ (Z[6],KEY=X3$(9,3)+"F/M")P2$
9040 READ (Z[6],KEY=X3$(9,3)+"OSP",DOM=*NEXT)OSP_PARMS$
9050 READ (Z[6],KEY=X3$(9,3)+"A/R")AR_PARMS$
9060 OP_CODE$=%X3_OP_ID$; OP_CODE$=PAD(OP_CODE$,8)
9070 READ (Z[6],KEY=OP_CODE$+"FD",DOM=*NEXT)SHIP_DFLT$
9090 RETURN 
9999 END 
17000 LOAD_FOB: DB_CTL=FOB_3.CTL,DB_KEY$="F",DB_CODE$=FOB_3$; PERFORM "FMGODX;LOAD_FMP_DROP_BOX"; RETURN ! SSP235581 jdf
17010 SEL_FOB:
17030 RETURN 
17040 LOAD_SHIP_VIA: DB_CTL=HOW_TO_SHIP_CODE_3.CTL,DB_KEY$="H",DB_CODE$=HOW_TO_SHIP_CODE_3$; PERFORM "FMGODX;LOAD_FMP_DROP_BOX"; RETURN ! SSP235581 jdf
17050 LOAD_SHIP_VIA_CODE: DB_CTL=SHIP_VIA_CODE_3.CTL,DB_KEY$="S",DB_CODE$=SHIP_VIA_CODE_3$; PERFORM "FMGODX;LOAD_FMP_DROP_BOX"; RETURN ! SSP235581 jdf
17060 SEL_SHIP_VIA_CODE:
17070 TEMP_SHIP$=%SHIP_VIA_CT$,XXX=POS("/"+SHIP_VIA_CODE$=%SHIP_VIA_CT$),TEMP_SHIP$=TEMP_SHIP$(XXX+3),XXX=POS("/"=TEMP_SHIP$),SHIP_VIA_DESC$=TEMP_SHIP$(1,XXX-1),REFRESH_FLG=1
17080 RETURN 
56000 REM "198988-Manage Customer Supplied Inventory. Item Setup, Purch ord     
56001 REM "202696-POGMAE screen - Inside Delivery field does not save in      
56003 REM "217284-Issue with Stock PO's missing fields on PO Header           
56004 REM "233024-Stock PO does not print the Distributor name on the         
56005 REM "235581-POGMAE-General Shipping.  Ship Via is actually 2 fields.    
56006 REM "307210-International shipping address - add country code           
