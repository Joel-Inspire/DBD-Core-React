0010 ! FOGMPA - GOR Parameter Setup                                      
0035 REM "5.7 - 12/10/10 - 10.890277 - jdf - SSP# 242740
0037 REM "242740-Setup Order Req Gateway module in GUI                       
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 PROCESS "FOGMPA","../FOG/FO.EN"
0060 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0$="FO2MPA",X1$="GOR Parameter Setup"
0140 ! 
0150 X0=-1,X2=-1
0160 CALL "ZZCOMP",X0$,X11$,X2$,X3$,X4$,X5$,X0,X1,X2; IF X1>0 THEN GOSUB WRAPUP
0170 ! 
0190 DIM Z[NUM(X3$(60,3))]
0200 ! Files
0210 Z$="06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0
0400 ! System Parameters
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0520 GOSUB GET_SYS_PARAM
0540 GOSUB LOAD_SCREEN
0780 REFRESH_FLG=1
0790 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
2000 ! Load Screen with Parameter Information
2010 LOAD_SCREEN:
2020 IMPORT_FILE_SEC$=PARAM$(10,5)
2030 TF_OPTION$=PARAM$(15,1)
2040 ITEM_CODE_YN$=PARAM$(16,1)
2280 REFRESH_FLG=1
2290 RETURN 
2500 ! load Information into Parameter String
2510 LOAD_INFO:
2515 PARAM$(7,1)="N"
2520 PARAM$(10,5)=IMPORT_FILE_SEC$
2525 IF STP(TF_OPTION$)="" THEN TF_OPTION$="N"
2530 PARAM$(15,1)=TF_OPTION$
2535 IF STP(ITEM_CODE_YN$)="" THEN ITEM_CODE_YN$="N"
2540 PARAM$(16,1)=ITEM_CODE_YN$
2790 RETURN 
3000 ! Write the record
3010 WRITE_REC:
3030 IF PARAM$=B_PARAM$ THEN RETURN 
3040 WRITE (Z[6],KEY=X3$(9,3)+"GOR")PARAM$
3080 B_PARAM$=PARAM$
3090 RETURN 
5000 ! Check Changes
5010 CHECK_CHANGES:
5020 GOSUB LOAD_INFO
5030 IF B_PARAM$=PARAM$ THEN RETURN 
5040 MSGBOX MSG("REC_ALTERD"),MSG("UPDATED"),"?,YESNO",ANS$
5050 IF ANS$="NO" THEN RETURN 
5060 GOSUB WRITE_REC
5090 RETURN 
8000 ! Add Messages
8010 ADD_MSG:
8020 MSGBOX MSG("ADD_RECORD"),MSG("VERIFY"),"?,YESNO",ANS$
8030 IF ANS$="NO" THEN CMD_STR$="END"; RETURN 
8040 DIM PARAM$(20); B_PARAM$=PARAM$
8050 NEXT_ID=IMPORT_FILE_SEC.CTL
8090 RETURN 
9000 ! Parameters
9010 GET_SYS_PARAM:
9020 EXTRACT (Z[6],KEY=X3$(9,3)+"GOR",DOM=*NEXT)
9030 READ (Z[6],KEY=X3$(9,3)+"GOR",DOM=ADD_MSG)PARAM$
9080 B_PARAM$=PARAM$
9090 RETURN 
9999 END 
10000 SEL_ACCT:
10010 ! Set Account Patameters
10020 REM Q$="0Z2A"+APG.A004$+"    "; IF APG.A003$="N" THEN Q$(2,1)="z"
10030 REM CALL "ZZACCT",X3$,X4$,"A","A/P",Q$
10040 REM Q$="0A"+APG.A009$+"      ",%X4$=X4$
10050 REM CALL "ZZACCT",X3$,X4$,"A","AP2",Q$
10055 REM %X4$=X4$
10060 RETURN 
