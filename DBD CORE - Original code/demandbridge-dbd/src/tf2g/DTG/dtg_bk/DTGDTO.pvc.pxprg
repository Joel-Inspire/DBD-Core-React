0010 ! DTGDTO object
0030 ! 
0035 REM "5.5 - 09/24/07 - 10.7125 - jme - SSP# 203099
0037 REM "203099-Enhancements to Output Director.  Provide ability for
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 DEF CLASS "DTGDTO" CREATE REQUIRED DELETE REQUIRED 
0110 LIKE "FILE"
0115 LIKE "DTGYES"
0120 LIKE "DTGDT0"
0200 ! start variable list
0210 LOCAL DTO
0215 LOCAL TYPE$=PAD("PURCHASE_ORDER",20)
0220 PROPERTY DTO$,IL_DT1$,IL_DT2$,CURRENT_QUEUE$
0222 LOCAL DTF
0224 LOCAL DTG
0226 LOCAL DTS
0228 LOCAL DTY
0229 LOCAL DTC
1000 FUNCTION GETFIRSTREC()
1020 FILENO=DTO
1030 X=_OBJ'READBYKEY(0,TYPE$)
1040 X=_OBJ'READNEXT(); IF X THEN IF OUTPUT_TYPE$<>TYPE$ THEN X=0
1050 IF X THEN {
1052 DIM DTO[4]
1053 IOLIST DTO$
1060 READ DATA FROM REC(IOL(FILENO)) TO IOL=1053
1070 CURRENT_QUEUE$=DTO$(1,30)
1075 ! IL_DT1$=DTO$(894,10),IL_DT2$=DTO$(608,15)
1076 IL_DT1$=DTO$(623,9),IL_DT2$=DTO$(686,10)
1080  }
1090 RETURN X
1100 FUNCTION FINDDT0MATCH()
1120 SEG1$=DTO$(623,2) ! division
1125 SEG2$=DTO$(682,10)+DTO$(2889,10) ! vendor, customer code
1130 SEG3$=DTO$(2881,4)+DIM(1)+DTO$(2885,4)+DIM(1) ! plant + shipto
1135 SEG4$=DIM(5)
1140 SEG5$="",SEG6$="",SEG7$="",SEG8$=""
1150 OK=_OBJ'GETDT0KEY(TYPE$,SEG1$,SEG2$,SEG3$,SEG4$,SEG5$,SEG6$,SEG7$,SEG8$)
1190 RETURN OK
1198 ! 
1199 ! 
1200 FUNCTION SETYES()
1210 FILENO=DTO; X=_OBJ'SETOKTOPRINT()
1220 FILENO=DTS; X=_OBJ'SETOKTOPRINT()
1250 FILENO=DTY; X=_OBJ'SETOKTOPRINT()
1290 RETURN 1
1300 FUNCTION DELYES()
1310 FILENO=DTO; X=_OBJ'DELOKTOPRINT()
1320 FILENO=DTF; X=_OBJ'DELOKTOPRINT()
1340 FILENO=DTS; X=_OBJ'DELOKTOPRINT()
1350 FILENO=DTY; X=_OBJ'DELOKTOPRINT()
1390 RETURN 1
1400 FUNCTION CHECK(X$)
1410 ENTER X$
1415 X$=PAD(X$,37) ! x$=division+vendor+customer+plant+shipto
1420 SEG1$=X$(1,2)
1425 SEG2$=X$(3,20)
1430 SEG3$=X$(23,10)
1435 SEG4$=X$(33,5)
1440 SEG5$="",SEG6$="",SEG7$="",SEG8$=""
1450 OK=_OBJ'GETDT0KEY(TYPE$,SEG1$,SEG2$,SEG3$,SEG4$,SEG5$,SEG6$,SEG7$,SEG8$)
1490 RETURN OK
1498 ! 
1499 ! 
1500 FUNCTION PRT_RPT(X)
1510 ENTER PRINTER_CHAN
1515 REPORT_GROUP$=STP(DT0$(407,20),2)
1520 FILENO=DTG; FOUNDDTG=_OBJ'READBYKEY(0,REPORT_GROUP$)
1550 IF FOUNDDTG THEN {
1560 IF STP(RPT_SUMMARY$,2)<>"" THEN REPORT$=STP(RPT_SUMMARY$,2)+".pvr"; X=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$) ! summary
1562 IF STP(RPT_STD_PLY$)<>"" THEN FILENO=DTY; Y=_OBJ'SETOKTOPRINT(); REPORT$=STP(RPT_STD_PLY$)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1563 IF STP(RPT_COMMENTS$)<>"" THEN FILENO=DTC; Y=_OBJ'SETOKTOPRINT(); REPORT$=STP(RPT_COMMENTS$)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1565 IF STP(RPT_SPEC_TYPE_1$)<>"" AND STP(RPT_SPEC_1$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_1$); REPORT$=STP(RPT_SPEC_1$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1570 IF STP(RPT_SPEC_TYPE_2$)<>"" AND STP(RPT_SPEC_2$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_2$); REPORT$=STP(RPT_SPEC_2$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1575 IF STP(RPT_SPEC_TYPE_3$)<>"" AND STP(RPT_SPEC_3$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_3$); REPORT$=STP(RPT_SPEC_3$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1580 IF STP(RPT_SPEC_TYPE_4$)<>"" AND STP(RPT_SPEC_4$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_4$); REPORT$=STP(RPT_SPEC_4$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1585 IF STP(RPT_SPEC_TYPE_5$)<>"" AND STP(RPT_SPEC_5$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_5$); REPORT$=STP(RPT_SPEC_5$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1590 IF STP(RPT_SPEC_TYPE_6$)<>"" AND STP(RPT_SPEC_6$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_6$); REPORT$=STP(RPT_SPEC_6$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1595 IF STP(RPT_SPEC_TYPE_7$)<>"" AND STP(RPT_SPEC_7$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_7$); REPORT$=STP(RPT_SPEC_7$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1600 IF STP(RPT_SPEC_TYPE_8$)<>"" AND STP(RPT_SPEC_8$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_8$); REPORT$=STP(RPT_SPEC_8$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1605 IF STP(RPT_SPEC_TYPE_9$)<>"" AND STP(RPT_SPEC_9$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_9$); REPORT$=STP(RPT_SPEC_9$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1610 IF STP(RPT_SPEC_TYPE_10$)<>"" AND STP(RPT_SPEC_10$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_10$); REPORT$=STP(RPT_SPEC_10$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1615 IF STP(RPT_SPEC_TYPE_11$)<>"" AND STP(RPT_SPEC_11$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_11$); REPORT$=STP(RPT_SPEC_11$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1620 IF STP(RPT_SPEC_TYPE_12$)<>"" AND STP(RPT_SPEC_12$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_12$); REPORT$=STP(RPT_SPEC_12$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1625 IF STP(RPT_SPEC_TYPE_13$)<>"" AND STP(RPT_SPEC_13$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_13$); REPORT$=STP(RPT_SPEC_13$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1630 IF STP(RPT_SPEC_TYPE_14$)<>"" AND STP(RPT_SPEC_14$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_14$); REPORT$=STP(RPT_SPEC_14$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1635 IF STP(RPT_SPEC_TYPE_15$)<>"" AND STP(RPT_SPEC_15$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_15$); REPORT$=STP(RPT_SPEC_15$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1640 IF STP(RPT_SPEC_TYPE_15$)<>"" AND STP(RPT_SPEC_15$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_15$); REPORT$=STP(RPT_SPEC_15$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1645 IF STP(RPT_SPEC_TYPE_16$)<>"" AND STP(RPT_SPEC_16$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_16$); REPORT$=STP(RPT_SPEC_16$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1650 IF STP(RPT_SPEC_TYPE_17$)<>"" AND STP(RPT_SPEC_17$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_17$); REPORT$=STP(RPT_SPEC_17$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1655 IF STP(RPT_SPEC_TYPE_18$)<>"" AND STP(RPT_SPEC_18$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_18$); REPORT$=STP(RPT_SPEC_18$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1660 IF STP(RPT_SPEC_TYPE_19$)<>"" AND STP(RPT_SPEC_19$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_19$); REPORT$=STP(RPT_SPEC_19$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1665 IF STP(RPT_SPEC_TYPE_20$)<>"" AND STP(RPT_SPEC_20$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_20$); REPORT$=STP(RPT_SPEC_20$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1670 IF STP(RPT_SPEC_TYPE_21$)<>"" AND STP(RPT_SPEC_21$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_21$); REPORT$=STP(RPT_SPEC_21$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1675 IF STP(RPT_SPEC_TYPE_22$)<>"" AND STP(RPT_SPEC_22$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_22$); REPORT$=STP(RPT_SPEC_22$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1680 IF STP(RPT_SPEC_TYPE_23$)<>"" AND STP(RPT_SPEC_23$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_23$); REPORT$=STP(RPT_SPEC_23$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1685 IF STP(RPT_SPEC_TYPE_24$)<>"" AND STP(RPT_SPEC_24$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_24$); REPORT$=STP(RPT_SPEC_24$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1690 IF STP(RPT_SPEC_TYPE_25$)<>"" AND STP(RPT_SPEC_25$)<>"" THEN Y=_OBJ'SET_SPECS_OK(DTF,RPT_SPEC_TYPE_25$); REPORT$=STP(RPT_SPEC_25$,2)+".pvr"; IF Y>0 THEN Z=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$)
1950 IF STP(RPT_SPEC_SHIPPING$,2)<>"" THEN REPORT$=STP(RPT_SPEC_SHIPPING$,2)+".pvr"; Y=_OBJ'SET_SPEC_SHIP_OK(DTS); IF Y>0 THEN X=_OBJ'PRINT_REPORT(PRINTER_CHAN,REPORT$) ! spec shipping
1980  }
1990 RETURN 
1998 ! 
1999 ! 
2000 FUNCTION SET_SPECS_OK(*)
2010 ENTER DTF_FILE,DTF_SPEC_TYPE$
2015 COUNT=0
2020 FILENO=DTF_FILE
2030 X=_OBJ'READBYKEY(0,CURRENT_QUEUE$)
2040 X=_OBJ'READNEXT(); IF X=1 THEN IF OUTPUT_TYPE$+OUTPUT_QUEUE$<>CURRENT_QUEUE$ THEN X=0
2050 WHILE X
2060 IF SPEC_TYPE$=DTF_SPEC_TYPE$ THEN {
2070 Y=_OBJ'EXTRACT(); IF Y THEN OK_TO_PRINT$="Y"; Y=_OBJ'UPDATE(); COUNT=COUNT+1 ! Extract and update
2075  }
2080 X=_OBJ'READNEXT(); IF X=1 THEN IF OUTPUT_TYPE$+OUTPUT_QUEUE$<>CURRENT_QUEUE$ THEN X=0
2085 WEND 
2090 RETURN COUNT
2098 ! 
2099 ! 
2100 FUNCTION SET_SPEC_SHIP_OK(*)
2110 ENTER DTS_FILE
2115 COUNT=0
2120 FILENO=DTS_FILE
2130 X=_OBJ'READBYKEY(0,CURRENT_QUEUE$)
2140 X=_OBJ'READNEXT(); IF X=1 THEN IF OUTPUT_TYPE$+OUTPUT_QUEUE$<>CURRENT_QUEUE$ THEN X=0
2150 WHILE X
2170 Y=_OBJ'EXTRACT(); IF Y THEN OK_TO_PRINT$="Y"; Y=_OBJ'UPDATE(); COUNT=COUNT+1 ! Extract and update
2180 X=_OBJ'READNEXT(); IF X=1 THEN IF OUTPUT_TYPE$+OUTPUT_QUEUE$<>CURRENT_QUEUE$ THEN X=0
2185 WEND 
2190 RETURN COUNT
2198 ! 
2199 ! 
8999 END DEF
9999 END 
10000 ON_CREATE:
10005 OPEN_STATUS=0
10007 FILENAME$="DTO"
10010 COMPANY$=%C$ ! OOP_SYS=NEW("SYSTEM"); COMPANY$=OOP_SYS'GET_COMPANY$; DROP OBJECT OOP_SYSS
10020 DTO=HFN; OPEN (DTO,IOL=*,ERR=*RETURN)FILENAME$+COMPANY$; STATIC IOL=IOL(DTO)
10025 DTF=HFN; OPEN (DTF,IOL=*,ERR=*RETURN)"DTF"+COMPANY$; STATIC IOL=IOL(DTF)
10030 DTG=HFN; OPEN (DTG,IOL=*,ERR=*RETURN)"DTG"+COMPANY$; STATIC IOL=IOL(DTG)
10035 DTS=HFN; OPEN (DTS,IOL=*,ERR=*RETURN)"DTS"+COMPANY$; STATIC IOL=IOL(DTS)
10040 DTY=HFN; OPEN (DTY,IOL=*,ERR=*RETURN)"DTY"+COMPANY$; STATIC IOL=IOL(DTY)
10045 DTC=HFN; OPEN (DTC,IOL=*,ERR=*RETURN)"DTC"+COMPANY$; STATIC IOL=IOL(DTC)
10080 OPEN_STATUS=1
10090 RETURN 
10098 ! 
10099 ! 
10100 ON_DELETE:
10110 IF OPEN_STATUS THEN CLOSE (DTO); CLOSE (DTF); CLOSE (DTG); CLOSE (DTS); CLOSE (DTY); CLOSE (DTC)
10190 RETURN 
10198 ! 
10199 ! 
56000 REM "203099-Enhancements to Output Director.  Provide ability for
