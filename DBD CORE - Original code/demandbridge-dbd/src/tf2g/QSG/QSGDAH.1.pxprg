0010 ! RFQ Detail Entry <QSGDAH.1> GUI Version
0035 ! "5.0 - 04/03/02 - 16.547777 - rms
0040 ! "Copyright 2002 Computer Software Inc.; Norcross, Georgia
0041 ! "        Licensed Software - All Rights Reserved.
0100 IOLISTS:! ^100,10
0110 IOLIST FMP_SPECIAL$,R[0],R[1],R[2]
0120 IOLIST S$,S[0],S[1]
0130 IOLIST U$,U[0],U[1]
0140 ! 
2100 SPECIALS:! ^2100,5
2110 DIM FMP_SPECIAL$(61),R[3]; FIND (_FMP,KEY="X"+A$(10,10),DOM=*NEXT)IOL=0110
2115 GOSUB DEFAULT_SPECIAL
2120 RETURN 
2125 ! 
5000 DEFAULT_SPECIAL:! ^5000,5
5005 A$(23,18)="",A$(20,3)=FMP_SPECIAL$(52,3),A$(41,40)=FMP_SPECIAL$(12,40),A$(95,4)=FMP_SPECIAL$(55,4),A[0]=R[0]
5010 E$(9,4)=FMP_SPECIAL$(55,4)
5015 GOSUB SELL_UOM
5020 GOSUB COST_UOM
5025 RETURN 
5030 ! 
7500 SELL_UOM:! ^7500,5
7505 REM "Set S0,S1 based on Selling U/M, check for recalc of breaks and price
7510 REM "S0 is qty / and S1 is ext. /
7515 DIM S$(22),S[1]; FIND (_ZZPARM,KEY="U/M"+A$(95,4),DOM=*NEXT)IOL=0120
7520 S1=S[0]; IF S$(20,1)<>"Y" THEN S0=A[0] ELSE S0=S[1]; IF S[0]<>0 THEN A[0]=S[0] ELSE A[0]=S[1]
7525 IF S0=0 THEN S0=1
7530 IF S1=0 THEN S1=1
7535 IF A[0]=0 THEN A[0]=1
7540 IF S0<>J0 THEN GOSUB CALC_PRICE
7545 SELL_UOM_END:RETURN 
7550 ! 
7600 CALC_PRICE:! ^7600,5
7605 REM "Recalc Selling price based on new U/M
7610 IF A[1]<>0 THEN A[17]=A[18]*S1/(A[1]/S0)
7615 CALC_PRICE_END:RETURN 
7620 ! 
7700 COST_UOM:! ^7700,5
7705 REM "Set U0,U1 based on Cost U/M, check for recalc of breaks and price
7710 REM "U0 is qty / and U1 is ext. /
7715 DIM U$(22),U[1]; FIND (_ZZPARM,KEY="U/M"+E$(9,4),DOM=*NEXT)IOL=0130
7720 U1=U[0]; IF U$(20,1)<>"Y" THEN U0=E[0] ELSE U0=U[1]; IF U[0]<>0 THEN E[0]=U[0] ELSE E[0]=U[1]
7725 IF U0=0 THEN U0=1
7730 IF U1=0 THEN U1=1
7735 IF E[0]=0 THEN E[0]=1
7740 IF U0<>J0 THEN GOSUB CALC_COST
7745 COST_UOM_END:RETURN 
7750 ! 
7800 CALC_COST:! ^7800,5
7805 REM "Recalc Cost  based on new U/M
7810 IF A[1]<>0 THEN E[25]=E[26]*U1/(A[1]/U0)
7815 CALC_COST_END:RETURN 
7820 ! 
