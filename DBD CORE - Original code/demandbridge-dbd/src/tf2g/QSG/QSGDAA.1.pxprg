0010 ! RFQ Entry <QSGDAA.1> GUI Version
0035 REM "5.5 - 01/19/07 - 9.500277 - jir - SSP# 203935
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0300 IOLISTS:! ^300,5
0320 IOLIST C$,C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15]
0325 IOLIST D$,D[0],D[1],D[2],D[3]
0330 IOLIST F0$
0335 IOLIST F1$
0370 RETURN 
0375 ! 
0400 DIM_VAR:! ^400,5
0405 DIM C$(397),C[15],D$(54),D[3],F0$(20),F1$(20)
0410 DIM A$(480)
0420 X0$="QSGDAA.1"
0430 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,-1,X1,X2
0440 CALL "ZZWMX3"
0450 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=*NEXT)
0460 RETURN 
0470 ! 
0500 OPEN_FILES:! ^500,5
0520 _AR1=HFN; OPEN (_AR1)"AR1"+%C$
0525 _AR2=HFN; OPEN (_AR2)"AR2"+%C$
0530 _FEA=HFN; OPEN (_FEA)"FEA"+%C$
0535 _FMP=HFN; OPEN (_FMP)"FMP"+%C$
0540 _ZP4=HFN; OPEN (_ZP4)"ZP4"+%C$
0545 _AS5=HFN; OPEN (_AS5,IOL=*)"AS5"+%C$
0555 READ (_ZZPARM,KEY=%C$+"F/M")P0$
0560 RETURN 
0565 ! 
1200 SET_RFQ:! ^1200,5
1210 GOSUB DIM_VAR
1215 READ DATA FROM REC(IOL(_FIL_NO)) TO A$
1220 A$(178,6)=%X3_MACH_DATE$,A$(184,1)="Y",A$(391,1)="C",A$(373,6)=%X3_MACH_DATE$
1225 IF POS(" "<>A$(373,6))<>0 THEN CALL "ZZDATE",X3$,"",A$(373,6),J0$,30,0,0,0,0,0,0,"","",""; A$(379,6)=J0$
1230 GOSUB LOAD_DATA
1235 RETURN 
1240 ! 
2000 CUSTOMER_CODE:! ^2000,5
2005 GOSUB OPEN_FILES
2015 GOSUB DIM_VAR
2020 READ DATA FROM REC(IOL(_FIL_NO)) TO A$
2025 J$=A$(391,1)+A$(10,10)
2030 IF A$(391,1)="T" THEN GOSUB TM_CODE; GOTO LOAD_DATA
2040 IF A$(391,1)="P" THEN FIND (_FEA,KEY=A$(10,10),DOM=CUST_ERR)IOL=0320 ELSE FIND (_AR1,KEY=A$(10,10),DOM=CUST_ERR)IOL=0320
2045 A$(20,35)=C$(11,35),A$(75,87)=C$(56,87),A$(55,20)=C$(165,20),A$(162,14)=C$(205,14),A$(176,2)=C$(359,2),A$(392,20)=C$(185,20),A$(420,14)=C$(143,12)
2050 FIND (_AR2,KEY=A$(176,2),DOM=*NEXT)IOL=0325
2055 GOSUB SET_DEFAULTS
2060 IF A$(391,1)="C" THEN GOSUB CUST_MSG
2061 ! 
2065 LOAD_DATA:
2070 READ DATA FROM A$ TO IOL=IOL(_FIL_NO)
2075 GOSUB CLOSE_FILES
2080 RETURN 
2085 ! 
2100 CUST_ERR:! ^2100,5
2105 MSGBOX "Customer Not Found",MSG("WARNING"),"STOP"
2106 NEXT_ID=CUSTOMER.CTL; EXIT 
2110 RETURN 
2115 ! 
2200 ADDRESS:! ^2200,5
2205 A9$=A$(75,87)+A$(420,14)
2210 CALL "ZY2AAA",X3$,X4$,0,7,"C","",2,A9$,"",0,C0,A9
2215 A$(75,87)=A9$(1,87),A$(420,14)=A9$(88,14)
2220 RETURN 
2225 ! 
2300 CUST_MSG:! ^2300,5 - Check for customer entry in _AS5
2305 LOCAL X$
2310 READ (_AS5,KEY=A$(10,10),DOM=*RETURN)
2315 IF STP(RFQ_ENTRY_1$+RFQ_ENTRY_2$+RFQ_ENTRY_3$,2)="" THEN RETURN 
2320 X$=STP(RFQ_ENTRY_1$,2)+SEP+STP(RFQ_ENTRY_2$,2)+SEP+STP(RFQ_ENTRY_3$)
2325 MSGBOX X$,"Important Message",""
2330 RETURN 
2335 ! 
3300 TM_CODE:! ^3300,5
3305 DIM C$(599); FIND (_ZP4,KEY=A$(10,10),DOM=*NEXT)C$
3307 PRINT 'CI'; IF STP(MID(C$,363,10))="" THEN MSGBOX "Customer Code for contact : "+A$(10,10)+" it's missing"+SEP+SEP+"Do you want to setup",MSG("WARNING"),"?,YESNO",OPT$; IF OPT$="NO" THEN GOTO 3308 ELSE %LIST$=A$(10,4),%CONTACT$=A$(14,6); PROCESS "ZPGMEA","../ZPG/ZP.EN"; GOTO 3305 ! SSP 199979 203935
3308 CUSTOMER$=MID(C$,363,10); CALL "ZZWLKU;PARSE_CUST",CUSTOMER$,%CUST_DIV$,%CUST_CODE$ ! SSP 199979
3310 GOSUB LOAD_TM
3315 RETURN 
3320 ! 
3400 ! ^3400,5
3405 REM "***gui If using repeat order feature, enter repeat order number, find RFQ's that go with that order, show summary screen, decide which ones to repeat
3410 IF P0$(273,1)<>"Y" OR Z9>0 OR A$(391,1)<>"C" THEN GOTO 1233
3415 PRINT @(0,11),"Repeat order no:",'CL',
3420 X$="Enter Repeat Order No, lookup available, or blank for none"
3425 DIM TMP[1],RPT_ORD$(8)
3430 CALL "ZZENTR","AUX",TMP{ALL},RPT_ORD$,X4$,X3$,17,11,1,8,C0,"O/P","{1"+X$,A$(10,10),"QS2DAA52","FT7","",""; IF ABS(C0)>4 THEN GOSUB 3740; ON C0 GOTO 3430,3433
3435 IF STP(RPT_ORD$,3," ")="" THEN PRINT @(0,11),Z0$,; GOTO 1233
3440 DIM FT3$(100); READ (Z[15],KEY=RPT_ORD$,DOM=3425)FT3$; IF FT3$(6,10)<>A$(10,10) THEN CALL "ZZPROM",".4",X3$,0,"Repeat order customer code does not match RFQ customer code","","",0; GOTO 3425
3445 Q0$="R"; CALL "FM2ODT",X3$,X4$,Q0$,RPT_ORD$; REM "Display repeat order summary screen to make sure this is the correct order number
3450 IF Q0$="N" THEN GOSUB 3740; GOTO 3415; REM "Not the correct repeat order
3455 Q0$=A1$; CALL "QS2ODT",X3$,X4$,Q0$,RPT_ORD$; REM "Display RFQ summary which will allow selection of RFQ's to repeat
3460 IF Q0$="None" THEN GOSUB 3740; GOTO 3415; REM "None of the repeat order lines have an RFQ number attached
3465 Q$=STR(LEN(Q0$):"00")+Q0$,U1$="QS2DAZ"+Q$,U0$=X3$(1,6)+"PF"; GOTO 4620
3470 GOTO 1233
3480 ! 
3900 ! ^3900,5
3905 REM "*** gui write to Print files Add Entry
3910 IF Z9=0 THEN GOTO 3945
3920 REMOVE (Z[9],KEY="f"+A1$,DOM=3925)
3925 REMOVE (Z[9],KEY="p"+A1$,DOM=3928)
3930 IF A$(184,1)<>"Y" OR POS(A$(372,1)="FP")=0 THEN GOTO 3945
3935 X$="f"; IF A$(372,1)="P" THEN X$="p"
3940 WRITE (Z[9],KEY=X$+A1$)
3945 GOTO 1218
3950 ! 
4000 SET_DEFAULTS:! ^4000,10
4010 FIND (_FMP,KEY="D"+A$(10,10),DOM=*RETURN)D0$
4020 A$(185,1)=D0$(28,1),A$(186,1)=D0$(45,1)
4030 FIND (_FMP,KEY="F"+A$(185,1),DOM=*NEXT)IOL=0330
4040 FIND (_FMP,KEY="S"+A$(186,1),DOM=*NEXT)IOL=0335
4050 RETURN 
4060 ! 
4200 LOAD_TM:! ^4200,10
4210 A$(20,35)=C$(11,40),A$(75,87)=C$(51,87),A$(55,20)=C$(160,20),A$(176,2)=C$(359,2),A$(392,20)=C$(180,20),A$(162,14)=C$(200,14),A$(420,14)=C$(138,10)
4220 FIND (_AR2,KEY=A$(176,2),DOM=*NEXT)IOL=0325
4230 GOSUB SET_DEFAULTS
4240 RETURN 
4250 ! 
9900 CLOSE_FILES:! ^9900,5
9915 CLOSE (_AR1,ERR=*NEXT)
9920 CLOSE (_AR2,ERR=*NEXT)
9925 CLOSE (_FEA,ERR=*NEXT)
9930 CLOSE (_FMP,ERR=*NEXT)
9935 CLOSE (_ZP4,ERR=*NEXT)
9940 CLOSE (_AS5,ERR=*NEXT)
9950 RETURN 
9955 ! 
56000 ! "199979-RFQ Module. Using C for Contact and the query comes up
56010 ! "203935-Trying to enter an RFQ for Contacts and its asking for      
