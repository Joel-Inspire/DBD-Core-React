0010 REM "RFQ Vendor Group Routine <QSGDAL>
0035 REM "5.7 - 02/09/10 - 11.9175 - jdf - SSP# 229436
0037 REM "229436-If a vendor is listed more than once on an RFQ, it sends the
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 REM "Load Vendors from Group for RFQ
0200 REM "Functions
0210 DEF FNS$(Z9$)=Z9$(1,POS("     "=Z9$+"     ")-1)
0300 REM "Iolists
0310 IOLIST A$
0320 IOLIST B$
0330 IOLIST C$
0340 IOLIST D$,D[0],D[1],D[2],D[3],D[4],D[5],D[6],D[7],D[8],D[9],D[10],D[11],D[12],D[13],D[14],D[15],D[16],D[17],D[18],D[19],D[20],D[21],D[22],D[23],D[24],D[25],D[26],D[27],D[28],D[29],D[30],D[31],D[32],D[33],D[34],D[35] ! WO229740
0500 REM "Files
0504 _QSE=HFN; OPEN (_QSE)"QSE"+%C$ ! SSP#228485
0505 _QS3=HFN; OPEN (_QS3)"FMP"+%C$
0506 _AP4=HFN; OPEN (_AP4)"AP4"+%C$
0507 _FM0=HFN; OPEN (_FM0)"FM0"+%C$
0508 _QSDA=HFN; OPEN (_QSDA)"QSD"+%C$
0509 _ZZP=HFN; OPEN (_ZZP)"ZZPARM" ! SSP 200437
0510 ! Z$="01O FMP...  02O AP4...  03O FM0...  13O ZZPARM  "
0520 FIND (_QS3,KEY="h"+VEND_GROUP_FROM$,DOM=9900)IOL=0310
0550 READ (_ZZP,KEY=%X3$(9,3)+"RFQ",DOM=*NEXT)RFQ_PARM$ ! SSP 400437
1000 REM "IF VEND_DIV_x + VEND_CODE_x blank or Invalid VEND_PLANT_x then skip it
1001 AA$=A$(42)
1005 IF %DB_INDEX>0 THEN %DB_INDEX=0 ELSE GOTO 1020 ! SSP229436 jdf
1010 MSGBOX MSG("VEND_GP_RM"),MSG("CONFIRM"),"?,YESNO",ANS$; IF ANS$="NO" THEN GOTO 1990 ! SSP229436 jdf
1015 GOSUB VENDOR_REMOVE ! SSP229436 jdf
1020 FOR I=1 TO 8
1040 IF FNS$(AA$(1,14))="" THEN GOTO 1900 ELSE J0$=AA$(1,10),J1$=AA$(11,4),AA$=AA$(15)
1060 FIND (_AP4,KEY=J0$,DOM=1900)IOL=0320
1080 F0$="P" ! IF FNS$(B$(133,12))>"" THEN F0$="F" ELSE F0$="P"
1090 IF RFQ_PARM$(9,1)="Y" THEN F0$="P" ! SSP 400437
1100 IF FNS$(J1$)>"" THEN FIND (_FM0,KEY="P"+J0$+J1$,DOM=1900)IOL=0330 ELSE GOTO 1200
1120 F0$="P" ! IF FNS$(C$(138,12))>"" THEN F0$="F" ELSE F0$="P"
1121 IF RFQ_PARM$(9,1)="Y" THEN F0$="P" ! SSP 400437
1200 REM "Build RFQ Detail Vendor Records
1240 DIM D$(288),D[35] ! WO229740
1260 D$(1,11)=%QUOTE_DIV$+%QUOTE_NUM$+"001"
1265 GOSUB VENDOR_CHECK ! SSP229436 jdf
1270 D$(12,10)=J0$
1280 D$(85,4)=J1$
1290 D$(67,1)="Y"
1291 D$(66,1)=F0$
1300 D$(68,2)=STR(I:"00")
1310 IF VENDOR_FLG<>1 THEN WRITE (_QSDA,KEY=D$(1,11)+D$(68,2))IOL=0340 ! SSP229436 jdf
1400 IF D$(67,1)="Y" AND POS(D$(66,1)="FP")<>0 THEN WRITE (_QSE,KEY=D$(66,1)+D$(1,21)+D$(68,2)) ! SSP#228485
1900 NEXT I
1990 GOTO 9900
9000 REM "Error Processing
9900 REM "End Program
9909 CLOSE (_QSE) ! SSP#228485
9910 CLOSE (_QS3)
9920 CLOSE (_AP4)
9921 CLOSE (_FM0)
9922 CLOSE (_QSDA)
9923 CLOSE (_ZZP) ! SSP 200437
9930 EXIT 
9999 END 
20300 VENDOR_CHECK:! SSP229436 jdf
20310 IOLIST QSD$,QSD{ALL} ! SSP229436 jdf
20315 VENDOR_FLG=0 ! SSP229436 jdf
20320 DIM QSD$(289),QSD[36] ! SSP229436 jdf
20330 QSD_KEY_CHECK$=D$(1,11) ! SSP229436 jdf
20340 READ (_QSDA,KEY="",DOM=*NEXT) ! SSP229436 jdf
20350 QSD_KEY$=KEY(_QSDA,END=20445) ! SSP229436 jdf
20360 READ (_QSDA,KEY=QSD_KEY$,DOM=*NEXT)IOL=20310 ! SSP229436 jdf
20370 IF QSD_KEY$(1,11)=QSD_KEY_CHECK$ THEN {! SSP229436 jdf
20380 IF QSD$(12,10)=J0$ THEN {! SSP229436 jdf
20410 VENDOR_FLG=1 ! SSP229436 jdf
20420  } ! SSP229436 jdf
20430  } ! SSP229436 jdf
20440 GOTO 20350 ! SSP229436 jdf
20450 RETURN ! SSP229436 jdf
20500 VENDOR_REMOVE:! SSP229436 jdf
20510 IOLIST QSD$,QSD{ALL} ! SSP229436 jdf
20530 DIM QSD$(289),QSD[36] ! SSP229436 jdf
20540 QSD_KEY_REMOVE$=%QUOTE_DIV$+%QUOTE_NUM$+"001" ! SSP229436 jdf
20550 READ (_QSDA,KEY="",DOM=*NEXT) ! SSP229436 jdf
20560 QSD_KEY$=KEY(_QSDA,END=20635) ! SSP229436 jdf
20570 READ (_QSDA,KEY=QSD_KEY$,DOM=*NEXT)IOL=20510 ! SSP229436 jdf
20580 IF QSD_KEY$(1,11)=QSD_KEY_REMOVE$ THEN {! SSP229436 jdf
20590 REMOVE (_QSDA,KEY=QSD_KEY$,DOM=*NEXT) ! SSP229436 jdf
20620  } ! SSP229436 jdf
20630 GOTO 20560 ! SSP229436 jdf
20640 RETURN ! SSP229436 jdf
56000 ! "200437-Program QSGMPA RFQ parameter question is missing in qatst   
56001 REM "228485-RFQ using Vendor Groups not really setting Output flag to   
56002 REM "229740-Create RFQ Working Days field, collect online from vendors
56003 REM "229436-If a vendor is listed more than once on an RFQ, it sends the
