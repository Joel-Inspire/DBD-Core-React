0010 ! APGRCS - File Maintenance Program for ZZS_Rpt_selection (="ZZS"+%C$)
0015 ! A/P Aged Invoice Report
0020 ! Generated by ProvideX® NOMADS II File Maintenance on Nov. 8, 2002 10:36
0030 ! ************************************************************************
0035 ! "6.0 - 08/06/03 - 15.351111 - dmm
0040 ! "Copyright 2003 Computer Software Inc.; Norcross, Georgia
0041 ! "        Licensed Software - All Rights Reserved.
0050 PROCESS "APGPEU","../APG/AP.EN"
0060 EXIT 
0090 ! 
0100 ! !100 - Initialization
0110 INIT:
0120 _SV_KR=PRM('KR'); SET_PARAM 'KR'=0 ! Ensure native handling of KEP()
0130 X0=-1,X2=-1
0140 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2
0150 DIM ZZS$(82),PRT$(125),ZZS[0],RNG[4],B_ZZS[0]
0160 ! iolist
0170 IOLIST ZZS$(1),ZZS[0]
0175 IOLIST PRT$(1),RNG$,RNG{ALL}
0180 ! Open Files
0190 DIM Z[NUM(X3$(60,3))]
0200 Z$="01O ZZS...  06O ZZPARM  07O ZZP     "
0210 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0400 ! 
0410 RPT_SELEC$="            "; VIEW$=""
0490 RETURN 
0500 ! !500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0890 RETURN 
0900 WRAPUP:
0910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0920 SET_PARAM 'KR'=_SV_KR
0930 EXIT 
40000 ! Load Fiscal Year
40010 LOAD_FISCAL_YEAR:
40040 READ (Z[6],KEY=%C$+"A/P",DOM=*NEXT)GL_REC$; CR_YEAR$=GL_REC$(7,4),CR_PD$=GL_REC$(11,2)
40050 IF NUL(RPT_FISYR$)=0 THEN CR_YEAR$=RPT_FISYR$
40060 KE$=%C$+"G/LYE",RPT_FISYR$=""
40070 READ (Z[6],KEY=KE$,DOM=*NEXT)
40080 K$=KEY(Z[6],END=40130); READ (Z[6])Z9$
40090 IF LEN(K$)<8 OR KE$<>K$(1,8) THEN GOTO END_LOAD_FISCAL_YEAR
40100 RPT_FISYR$=RPT_FISYR$+K$(9)+"/"
40110 IF K$(9,4)=CR_YEAR$ THEN CC$=Z9$(21)
40120 GOTO 40080
40130 END_LOAD_FISCAL_YEAR:
40140 DROP_BOX LOAD RPT_FISYR.CTL,RPT_FISYR$
40150 DROP_BOX WRITE RPT_FISYR.CTL,CR_YEAR$
40160 DROP_BOX LOAD END_FISCAL.CTL,RPT_FISYR$
40170 DROP_BOX WRITE END_FISCAL.CTL,CR_YEAR$
40180 RPT_FISYR$=CR_YEAR$
40190 IF NUL(RPT_PER$)=0 THEN CR_PD$=RPT_PER$
40200 RPT_PER$=""
40210 FOR ACCT=1 TO 12; RPT_PER$=RPT_PER$+STR(ACCT:"00")+"/"; NEXT ACCT
40220 DROP_BOX LOAD RPT_PER.CTL,RPT_PER$
40230 DROP_BOX WRITE RPT_PER.CTL,CR_PD$
40240 RPT_PER$=CR_PD$
40250 END_ACCTPD$=RPT_PER$
40260 DROP_BOX LOAD END_ACCTPD.CTL,RPT_PER$
40270 DROP_BOX WRITE END_ACCTPD.CTL,CR_PD$
40275 GOSUB LOAD_ENDING_DATE
40280 RETURN 
40290 LOAD_ENDING_DATE:
40300 IF LEN(RPT_FISYR$)>4 THEN VAL$=CR_YEAR$ ELSE VAL$=RPT_FISYR$
40310 FIND (Z[6],KEY=KE$+VAL$)Z9$; CC$=Z9$(21)
40320 IF LEN(RPT_PER$)>2 THEN VAL=NUM(CR_PD$) ELSE VAL=NUM(RPT_PER$)
40330 CC$=CC$(VAL*6-5,6),RPT_AGEDATE$=CC$,REFRESH_FLG=1
40340 RETURN 
