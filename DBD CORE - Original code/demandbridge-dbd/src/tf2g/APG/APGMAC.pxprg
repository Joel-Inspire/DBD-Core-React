0010 ! APGMAC - Current Status Inquiry
0035 REM "5.7 - 02/14/13 - 11.170555 - dmm - SSP# 242260
0037 REM "242260-Vendor Status; 1099 ID and Type, mask/blank display until   
0040 REM "Copyright 2013 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0045 _VENDOR$=%VENDOR$ ! SSP 202131
0050 PROCESS "APGMAC","../APG/AP.EN"
0060 %VENDOR$=_VENDOR$
0070 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0$="APGMAC"
0140 X0=-1; X2=-1
0150 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
0160 ! 
0170 ! Dim Variables
0180 DIM Z[NUM(X3$(60,3))],AP4[2],AP5[6]
0190 ! 
0200 ! open files
0210 Z$="01O AP5...  02O AP4...  06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0225 DIM SEC$(255); FIND (Z[6],KEY="osec"+X3$(40,3),DOM=*NEXT)SEC$ ! SSP 202131
0300 ! iolist
0310 IOLIST AP5$,AP5{ALL}
0320 IOLIST AP4$,AP4{ALL}
0480 IF NOT(NUL(%VENDOR$)) THEN VENDOR$=%VENDOR$
0485 REFRESH_FLG=1
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0520 IF %VENDOR$<>"" THEN {
0530 VENDOR$=%VENDOR$
0540 DISABLE CONTROL VENDOR.CTL
0550 GOSUB PROCESS_VENDOR }
0560 NEXT_ID=VENDOR.CTL; REFRESH_FLG=1
0570 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
1000 ! Get the vendors info
1010 PROCESS_VENDOR:
1020 KEY_1$=VENDOR$
1030 READ (Z[1],KEY=KEY_1$,DOM=ADD_REC)IOL=0310
1040 ! load info
1050 LAST_INV_DATE$=AP5$(11,6),LAST_CHECK_DATE$=AP5$(17,6)
1060 ID_1099$=MID(AP5$,23,14); TYPE_1099$=MID(AP5$,37,1)
1070 CURR_BAL=AP5[0]
1080 PYMNT_CURR_1099_YR=AP5[2]; CHK_CNT_CURR_1099_YR=AP5[3]
1090 PYMNT_NEXT_1099_YR=AP5[4]; CHK_CNT_NEXT_1099_YR=AP5[5]
1280 B_AP5$=AP5$
1290 REFRESH_FLG=1
1300 RETURN 
1500 ! Get the Vendor Information
1510 GET_VENDOR:
1520 CALL "ZZWLKU;Parse_vend",VENDOR$,VEND_DIV$,VEND_CODE$
1530 VENDOR$=VEND_DIV$+VEND_CODE$
1550 KEY_2$=VENDOR$
1560 READ (Z[2],KEY=KEY_2$,DOM=*RETURN)IOL=0320
1570 %VEND_NAME$=AP4$(11,35)
1580 REFRESH_FLG=1; GOSUB PROCESS_VENDOR
1590 RETURN 
3000 ! check record for any changes
3010 CHECK_CHANGES:
3020 IF B_AP5$=AP5$ THEN RETURN 
3030 MSG_1$="Changes have been made."+SEP+"Would you like to update?"
3040 MSGBOX MSG_1$,"Update Record","YesNo",ANS$
3050 IF ANS$="NO" THEN RETURN 
3060 GOSUB WRITE_REC
3090 RETURN 
4000 ! Write record out....
4010 WRITE_REC:
4015 IF NUL(AP5$) THEN RETURN 
4020 WRITE (Z[1],KEY=KEY_1$)IOL=0310
4030 MSGBOX "The information has been updated...","FYI"
4080 B_AP5$=AP5$
4090 RETURN 
4500 ! Load Changed Info
4510 LOAD_REC:
4515 IF NUL(AP5$) THEN RETURN 
4520 AP5$(23,14)=ID_1099$; AP5$(37,1)=TYPE_1099$
4590 RETURN 
5000 ! delete record
5010 DELETE_REC:
5090 RETURN 
6000 ! ADD RECORD
6010 ADD_REC:
6020 MSGBOX MSG("ADD_RECORD"),MSG("CONFIRM"),"?,YESNO",ANS$
6030 IF ANS$="NO" THEN CMD_STR$="END"; EXIT 
6040 DIM AP5$(55),AP5[6]
6050 AP5$(1,10)=VENDOR$
6080 REFRESH_FLG=1
6090 RETURN 
9999 END 
18000 SEL_PASSWORD:
18001 RETURN ! PRINT 'CI', SSP 299143
18010 L=0,OP$=ID'*,XX=ID'COL,YY=ID'LINE,XXX=ID'COLS,YYY=ID'LINES; DIM OP$[200],NA$[200]
18020 ! 
18030 NXT_OPT:
18040 X=POS(","=OP$); IF X=0 THEN GOTO END_OPT
18050 LST$=OP$(1,X-1),OP$=OP$(X+1),L=L+1,OP$[L]=LST$,NA$[L]=EVS("ID'"+LST$+"$")
18060 ! PRINT OP$[L],"  ",NA$[L]
18070 GOTO NXT_OPT
18080 ! 
18090 END_OPT:
18100 MULTI_LINE REMOVE ID
18110 IF REST=0 THEN MULTI_LINE ID,@(XX,YY,XXX,YYY),OPT="H"+OPT$; HIDE CONTROL ID+3000; REFRESH_FLG=1 ELSE MULTI_LINE ID,@(XX,YY,XXX,YYY),OPT="H$"+OPT$; HEIGHT$=ID'HEIGHT$; SHOW CONTROL ID+3000; REFRESH_FLG=1
18120 FOR AA=1 TO L
18130 BB$=PAD(OP$[AA],6," "); IF POS(BB$="Len   Col   Cols  Line  Lines Width Height",6)<>0 THEN CONTINUE
18140 IF NOT(NUL(NA$[AA])) THEN EXECUTE "id'"+OP$[AA]+"$="+QUO+NA$[AA]+QUO
18150 NEXT AA
18160 RETURN 
56000 ! "202131-Security by operator to not allow modifications to vendor   
56002 REM "242260-Vendor Status; 1099 ID and Type, mask/blank display until   
56003 REM "242260-Vendor Status; 1099 ID and Type, mask/blank display until   
