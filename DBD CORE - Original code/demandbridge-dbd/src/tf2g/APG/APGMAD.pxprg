0010 ! APGMAD - File Maintenance Program for API_OpenInvoice (="API"+%C$)
0020 ! Generated by ProvideX® NOMADS II File Maintenance on May. 1, 2003 10:27
0030 ! ************************************************************************
0040 _VENDOR$=%VENDOR$
0050 PROCESS "APGMAD","../APG/AP.EN"
0060 %VENDOR$=_VENDOR$
0070 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0$="APGMAD"
0140 X0=-1; X2=-1
0150 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
0160 ! 
0170 ! Dim Variables
0180 DIM Z[NUM(X3$(60,3))],AP9[14],AP4[2],APJ[2]
0190 ! 
0200 ! open Files
0210 Z$="01O AP8...  06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z1,Z2
0300 ! Iolist Area
0310 IOLIST AP8$
0320 IOLIST AP9$,AP9{ALL}
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0520 IF %VENDOR$<>"" THEN {
0530 VENDOR$=%VENDOR$
0540 DISABLE CONTROL VENDOR.CTL
0550 GOSUB GET_INFO
0560 REFRESH_FLG=1 }
0570 NEXT_ID=VENDOR.CTL
0590 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
1000 ! write the record
1010 WRITE_REC:
1020 WRITE (Z[1],KEY=VENDOR$)IOL=0310
1030 MSGBOX "Vendor Message Updated..."
1040 RETURN 
2000 ! get vendor's massage info.
2010 GET_INFO:
2020 ! 
2030 READ (Z[1],KEY=VENDOR$,DOM=3500)IOL=0310
2040 INVE_1$=AP8$(11,60); INVE_2$=AP8$(71,60)
2050 INVP_1$=AP8$(131,60); INVP_2$=AP8$(191,60)
2060 ORDE_1$=AP8$(251,60); ORDE_2$=AP8$(311,60)
2070 VENS_1$=AP8$(371,60); VENS_2$=AP8$(431,60)
2080 GOSUB LOAD_GRID
2180 REFRESH_FLG=1
2190 RETURN 
3000 ! message is not avaiable
3010 NEW_VENDOR_MESSAGE:
3020 MSG_1$="No messages for vendor: "+VENDOR$+" on file..."+SEP+"Would you like to Add?"
3030 MSGBOX MSG_1$,"Message not Found","YesNo",ANS$
3040 IF ANS$="NO" THEN CMD_STR$="END"; REFRESH_FLG=1
3050 DIM INVE_1$(60," "),INVE_2$(60," ")
3060 DIM INVP_1$(60," "),INVP_2$(60," ")
3070 DIM ORDE_1$(60," "),ORDE_2$(60," ")
3080 DIM VENS_1$(60," "),VENS_2$(60," ")
3100 GOSUB LOAD_GRID
3190 RETURN 
4000 ! load information in the grid
4010 LOAD_GRID:
4020 X=MESSAGE.CTL
4021 X'VISIBLE=0
4022 FOR XX=1 TO 7; GRID ADD X,0,1; NEXT XX
4023 X'COLUMN=-1,X'ROW=-1,X'FONT$="MS Sans Serif"
4025 X'COLUMN=-1,X'ROW=-1,X'COLUMNWIDTH=35,X'ALIGN$="L",X'VALUE$=MSG("MESS_T")
4030 X'COLUMN=-1,X'ROW=1,X'COLUMNWIDTH=35,X'FONT$="MS Sans Serif",X'ALIGN$="R",X'VALUE$=MSG("INVO_E_M")+" "+MSG("LINE_1")+":"
4035 X'COLUMN=-1,X'ROW=2,X'COLUMNWIDTH=35,X'FONT$="MS Sans Serif",X'ALIGN$="R",X'VALUE$=MSG("LINE_2")+":"
4040 X'COLUMN=-1,X'ROW=3,X'COLUMNWIDTH=35,X'FONT$="MS Sans Serif",X'ALIGN$="R",X'VALUE$=MSG("SPEC_I_S_P")+" "+MSG("LINE_1")+":"
4045 X'COLUMN=-1,X'ROW=4,X'COLUMNWIDTH=35,X'FONT$="MS Sans Serif",X'ALIGN$="R",X'VALUE$=MSG("LINE_2")+":"
4050 X'COLUMN=-1,X'ROW=5,X'COLUMNWIDTH=35,X'FONT$="MS Sans Serif",X'ALIGN$="R",X'VALUE$=MSG("ORDE_E_M")+" "+MSG("LINE_1")+":"
4055 X'COLUMN=-1,X'ROW=6,X'COLUMNWIDTH=35,X'FONT$="MS Sans Serif",X'ALIGN$="R",X'VALUE$=MSG("LINE_2")+":"
4060 X'COLUMN=-1,X'ROW=7,X'COLUMNWIDTH=35,X'FONT$="MS Sans Serif",X'ALIGN$="R",X'VALUE$=MSG("VEND_SI_M")+" "+MSG("LINE_1")+":"
4065 X'COLUMN=-1,X'ROW=8,X'COLUMNWIDTH=35,X'FONT$="MS Sans Serif",X'ALIGN$="R",X'VALUE$=MSG("LINE_2")+":"
4070 ! 
4080 X'COLUMN=1,X'ROW=1,X'LEN=60,X'CELLTYPE$="Multi_line",X'VALUE$=INVE_1$
4090 X'COLUMN=1,X'ROW=2,X'LEN=60,X'CELLTYPE$="Multi_line",X'VALUE$=INVE_2$
4100 X'COLUMN=1,X'ROW=3,X'LEN=60,X'CELLTYPE$="Multi_line",X'VALUE$=INVP_1$
4110 X'COLUMN=1,X'ROW=4,X'LEN=60,X'CELLTYPE$="Multi_line",X'VALUE$=INVP_2$
4120 X'COLUMN=1,X'ROW=5,X'LEN=60,X'CELLTYPE$="Multi_line",X'VALUE$=ORDE_1$
4130 X'COLUMN=1,X'ROW=6,X'LEN=60,X'CELLTYPE$="Multi_line",X'VALUE$=ORDE_2$
4140 X'COLUMN=1,X'ROW=7,X'LEN=60,X'CELLTYPE$="Multi_line",X'VALUE$=VENS_1$
4150 X'COLUMN=1,X'ROW=8,X'LEN=60,X'CELLTYPE$="Multi_line",X'VALUE$=VENS_2$
4155 X'VISIBLE=1
4190 RETURN 
5000 ! SELECT GRID
5010 SELECT_GRID:
5190 RETURN 
6000 ! load all the information.
6010 LOAD_INFO:
6020 DIM AP8$(492," ")
6030 AP8$(1,10)=VENDOR$
6040 GRID FIND X,1,1,INVE_1$; AP8$(11,60)=PAD(INVE_1$,60," ")
6050 GRID FIND X,1,2,INVE_2$; AP8$(71,60)=PAD(INVE_2$,60," ")
6060 GRID FIND X,1,3,INVP_1$; AP8$(131,60)=PAD(INVP_1$,60," ")
6070 GRID FIND X,1,4,INVP_2$; AP8$(191,60)=PAD(INVP_2$,60," ")
6080 GRID FIND X,1,5,ORDE_1$; AP8$(251,60)=PAD(ORDE_1$,60," ")
6090 GRID FIND X,1,6,ORDE_2$; AP8$(311,60)=PAD(ORDE_2$,60," ")
6100 GRID FIND X,1,7,VENS_1$; AP8$(371,60)=PAD(VENS_1$,60," ")
6110 GRID FIND X,1,8,VENS_2$; AP8$(431,60)=PAD(VENS_2$,60," ")
6190 RETURN 
8000 ! get system parameters
8010 GET_PARAMS:
8020 DIM SEC$(255); FIND (Z[6],KEY="osec"+X3$(40,3),DOM=*NEXT)SEC$
8030 READ (Z[6],KEY=X3$(9,3)+"G/L",DOM=*NEXT)F0$
8040 READ (Z[6],KEY="STAT"+"A/P",DOM=*NEXT)F9$,F0
8190 RETURN 
