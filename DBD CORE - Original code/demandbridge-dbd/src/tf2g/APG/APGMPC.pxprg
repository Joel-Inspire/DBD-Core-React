0010 ! APGMPC - File Maintenance Program for AP0_GLInterface (="AP0"+%C$)
0020 ! Generated by ProvideX® NOMADS II File Maintenance on May. 15, 2003 10:00
0030 ! ************************************************************************
0035 REM "5.7 - 09/15/10 - 10.242777 - tma - SSP# 241028
0037 REM "241028-In AP Division Panel get program expection on exit, if you  
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0$="AP2MPC",X1$="Division Setup"
0140 ! 
0150 X0=-1,X2=-1
0160 CALL "ZZCOMP",X0$,X11$,X2$,X3$,X4$,X5$,X0,X1,X2; IF X1>0 THEN CMD_STR$="END"; RETURN 
0170 ! 
0190 DIM Z[NUM(X3$(60,3))],AP0$(33) ! SSP#241028
0200 ! Files
0210 Z$="01X AP0...  06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0
0300 ! IOList Section
0310 IOLIST AP0$
0400 ! System Parameters
0410 GOSUB GET_SYS_PARAM
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0520 IF F0$(13,1)<>"Y" THEN GOSUB 8600; RETURN 
0780 REFRESH_FLG=1
0790 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
1000 ! find Record
1010 FIND_REC:
1020 KEY_1$=DIV_NUM$
1030 FIND (Z[1],KEY=KEY_1$,DOM=ADD_REC)IOL=0310
1040 ! 
1050 DIV_DESC$=AP0$(3,30)
1160 CALL "*wingrp;Enable",BUTTON_1.GRP$
1170 B_AP0$=AP0$
1180 REFRESH_FLG=1
1190 RETURN 
1300 ! Get the division Information
1310 GET_DIV:
1320 KEY_DIV$=DIV_OR_DIST_CODE$
1330 READ (Z[F0],KEY=KEY_DIV$,DOM=DIV_MSG)IOL=0330
1340 DIV_DESC$=VEND$(3,30)
1380 REFRESH_FLG=1
1390 RETURN 
1500 ! Write Record
1510 WRITE_REC:
1520 MSGBOX MSG("ADD_RECORD"),MSG("CONFIRM"),"?,YesNo",ANS$
1530 IF ANS$="NO" THEN RETURN 
1540 WRITE (Z[1],KEY=KEY_1$)IOL=0310
1550 MSGBOX "Record Updated!","FYI","!"
1580 B_AP0$=AP0$
1590 RETURN 
2000 ! Load Information
2010 LOAD_INFO:
2020 DIV_NUM$=AP0$(1,2)
2030 DIV_DESC$=AP0$(3,30)
2160 CALL "*wingrp;Enable",BUTTON_1.GRP$
2170 B_AP0$=AP0$
2180 REFRESH_FLG=1
2190 RETURN 
2300 ! Load Slections   
2310 LOAD_SELECTION:
2330 AP0$(1,2)=DIV_NUM$
2340 AP0$(3,30)=DIV_DESC$
2490 RETURN 
2500 ! Delete Record
2510 DELETE_REC:! SSP#210782
2520 MSGBOX MSG("DELETE_REC"),MSG("CONFIRM"),"?,YesNo",ANS$
2530 IF ANS$="NO" THEN RETURN 
2540 REMOVE (Z[1],KEY=KEY_1$)
2550 MSGBOX "Record Deleted!","FYI","!"
2560 REFRESH_FLG=1 ! SSP#210782
2590 RETURN 
3000 ! First Record
3010 FIRST_REC:
3020 KEY_1$=KEF(Z[1],END=NO_FIRST)
3030 READ (Z[1],KEY=KEY_1$)IOL=0310
3040 GOSUB LOAD_INFO
3090 RETURN 
3200 ! Last Record
3210 LAST_REC:
3220 KEY_1$=KEL(Z[1],ERR=NO_LAST)
3230 READ (Z[1],KEY=KEY_1$)IOL=0310
3240 GOSUB LOAD_INFO
3290 RETURN 
3400 ! Prior Record
3410 PRIOR_REC:
3420 KEY_1$=KEP(Z[1],END=START_FILE)
3430 READ (Z[1],KEY=KEY_1$)IOL=0310
3440 GOSUB LOAD_INFO
3490 RETURN 
3600 ! Next Record
3610 NEXT_REC:
3620 KEY_1$=KEN(Z[1],END=END_FILE)
3630 READ (Z[1],KEY=KEY_1$)IOL=0310
3640 GOSUB LOAD_INFO
3690 RETURN 
5000 ! Check Changes
5010 CHECK_CHANGES:
5020 IF AP0$=B_AP0$ OR B_AP0$="" THEN RETURN 
5030 MSGBOX MSG("REC_ALTERD"),MSG("UPDATE"),"?,YesNo",ANS$
5040 IF ANS$="NO" THEN RETURN 
5050 GOSUB WRITE_REC
5090 RETURN 
8000 ! Messages
8010 DIV_MSG:
8020 MSGBOX "Division Not Found!","NOT FOUND","INFO,OK"
8030 NEXT_ID=DIV_OR_DIST_CODE.CTL
8040 REFRESH_FLG=1
8090 RETURN 
8100 ! No First Record
8110 NO_FIRST:
8120 MSGBOX MSG("REC_NO_1ST"),"FYI","!"
8130 RETURN 
8200 ! No Last Record
8210 NO_LAST:
8220 MSGBOX MSG("REC_NO_LST$"),"FYI","!"
8230 RETURN 
8300 ! Start of File
8310 START_FILE:
8320 MSGBOX MSG("START_FILE"),"FYI","!"
8330 RETURN 
8400 ! End of File
8410 END_FILE:
8420 MSGBOX MSG("END_OF_FIL"),"FYI","!"
8430 RETURN 
8500 ! Add New Record
8510 ADD_REC:
8520 MSGBOX MSG("ADD_RECORD"),MSG("VERIFY"),"?,YESNO",ANS$
8530 IF ANS$="NO" THEN CMD_STR$="END"; RETURN 
8540 DIM AP0$(33); B_AP0$=AP0$ ! SSP#210782
8560 CALL "*wingrp;Enable",BUTTON_1.GRP$
8580 REFRESH_FLG=1
8590 RETURN 
8600 ! Not accessable Message
8610 CANNOT_ACCESS:
8620 MSGBOX MSG("MULT_DIV"),MSG("FYI"),"!"
8630 CMD_STR$="END"
8690 RETURN 
9000 ! Parameters
9010 GET_SYS_PARAM:
9020 READ (Z[6],KEY=X3$(9,3)+"A/P",DOM=WRAPUP)F0$
9090 RETURN 
9999 END 
56000 REM "241028-In AP Division Panel get program expection on exit, if you  
