0010 ! APGMPS - File Maintenance Program for APX_GLInterface (="APX"+%C$)
0020 ! Generated by ProvideX® NOMADS II File Maintenance on May. 15, 2003 10:00
0030 ! ************************************************************************
0050 PROCESS "APGMPS","../APG/AP.EN"
0060 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0$="AP2MPS",X1$="Account Payable Invoice Entry Options"
0140 ! 
0150 X0=-1,X2=-1
0160 CALL "ZZCOMP",X0$,X11$,X2$,X3$,X4$,X5$,X0,X1,X2; IF X1>0 THEN GOSUB WRAPUP
0170 ! 
0190 DIM Z[NUM(X3$(60,3))],PARAM[4]
0200 ! Files
0210 Z$="06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0
0300 ! iOLIST
0310 IOLIST PARAM$,PARAM{ALL}
0400 ! System Parameters
0410 GOSUB GET_PARMS
0450 IF F0$(68,1)<>"Y" THEN MSGBOX MSG("APGMPS_01"),MSG("FYI"),"!"; CMD_STR$="END"; EXIT 
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0520 GOSUB GET_SYS_PARAM
0540 GOSUB LOAD_SCREEN
0790 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
2000 ! Load Screen with Parameter Information
2010 LOAD_SCREEN:
2020 DESCR_1$=PARAM$(8,16); POST_1$=PARAM$(24,1); DISC_1$=PARAM$(25,1)
2030 DESCR_2$=PARAM$(28,16); POST_2$=PARAM$(44,1); DISC_2$=PARAM$(45,1)
2040 DESCR_3$=PARAM$(48,16); POST_3$=PARAM$(64,1); DISC_3$=PARAM$(65,1)
2050 DESCR_4$=PARAM$(68,16); POST_4$=PARAM$(84,1); DISC_4$=PARAM$(85,1)
2280 REFRESH_FLG=1
2290 RETURN 
2500 ! load Information into Parameter String
2510 LOAD_INFO:
2520 DIM PARAM$(88),PARAM[4]
2530 PARAM$(1,7)=X3$(9,3)+"AP2A"
2540 PARAM$(8,16)=DESCR_1$; PARAM$(24,1)=POST_1$; PARAM$(25,1)=DISC_1$
2550 PARAM$(28,16)=DESCR_2$; PARAM$(44,1)=POST_2$; PARAM$(45,1)=DISC_2$
2560 PARAM$(48,16)=DESCR_3$; PARAM$(64,1)=POST_3$; PARAM$(65,1)=DISC_3$
2570 PARAM$(68,16)=DESCR_4$; PARAM$(84,1)=POST_4$; PARAM$(85,1)=DISC_4$
2790 RETURN 
3000 ! Write the record
3010 WRITE_REC:
3030 IF PARAM$=B_PARAM$ THEN RETURN 
3040 WRITE (Z[6],KEY=X3$(9,3)+"AP2A")IOL=0310
3080 B_PARAM$=PARAM$
3090 RETURN 
5000 ! Check Changes
5010 CHECK_CHANGES:
5020 GOSUB LOAD_INFO
5030 IF B_PARAM$=PARAM$ THEN RETURN 
5040 MSGBOX MSG("REC_ALTERD"),MSG("UPDATED"),"?,YESNO",ANS$
5050 IF ANS$="NO" THEN RETURN 
5060 GOSUB WRITE_REC
5090 RETURN 
8000 ! Add Messages
8010 ADD_MSG:
8020 MSGBOX MSG("ADD_RECORD"),MSG("VERIFY"),"?,YESNO",ANS$
8030 IF ANS$="NO" THEN CMD_STR$="END"; RETURN 
8040 DIM PARAM$(100); B_PARAM$=PARAM$
8050 NEXT_ID=APG.AP001.CTL
8090 RETURN 
9000 ! Parameters
9010 GET_SYS_PARAM:
9020 EXTRACT (Z[6],KEY=X3$(9,3)+"AP2A",DOM=*NEXT)
9030 READ (Z[6],KEY=X3$(9,3)+"AP2A",DOM=*RETURN)IOL=0310
9080 B_PARAM$=PARAM$
9090 RETURN 
9100 ! Get the system Parameters
9110 GET_PARMS:
9130 READ (Z[6],KEY=X3$(9,3)+"A/P")F0$
9190 RETURN 
