0010 ! ZZGSTA - Display System Terminal Activity
0020 ! "5.1 - 07/19/03 - 11.584444 - jir
0030 ! "Copyright 2003 Computer Software Inc.; Norcross, Georgia
0035 REM "5.5 - 09/07/07 - 16.015 - jdf - SSP# 211380
0037 REM "211380-TopForm file feldnames which are SQL keywords break Oracle. 
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 PROCESS "ZZGSTA","../ZZG/ZZ.EN"
0060 EXIT 
0100 ! 100 - Initialization
0110 INIT:
0120 _FILE_NAME$="ZZPARM",_ZZPARM=HFN; OPEN (_ZZPARM,ERR=OPEN_ERR)"ZZPARM"
0130 RETURN 
0140 OPEN_ERR: MSGBOX _MSG_FILOPNERR1$+QUO+_FILE_NAME$+QUO+SEP+_MSG_DIRECTORY$+LWD+SEP+_MSG_PREFIX$+PFX,MSG(ERR),"!"
0150 CMD_STR$="END"
0160 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0520 GOSUB PROCESS_OPTION ! GET DETAILS AND LOAD LIST BOX
0530 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 IF _ZZPARM<>0 THEN CLOSE (_ZZPARM); _ZZPARM=0
0930 RETURN 
0940 PROCESS_OPTION:
0950 P0$=TSK(0,ERR=*NEXT),P$=""; DIM S$(6)
0960 P$=""
0970 READ (_ZZPARM,KEY="RUN",DOM=*NEXT)
0980 K$=KEY(_ZZPARM,END=1040); READ (_ZZPARM)TERM$,OPER$,COMP$,TF_MODULE$,PRG$,TF_TIME$; IF MID(K$,1,3)<>"RUN" THEN GOTO 1040
0990 P$=P$+K$(1,5),IDX=IDX+1
1000 CALL "ZZXPRG",Q$,10,PRG$
1010 IF MID(Q$,1,3)="** " THEN Q$=""
1020 LIST_BOX LOAD LB_LINE.CTL,IDX,TERM$+SEP+OPER$+SEP+COMP$+SEP+TF_MODULE$+SEP+PRG$+SEP+Q$+SEP+TF_TIME$
1030 GOTO 0980
1040 ! 
1050 P0=LEN(P$)/6,ML_DESC$="Number of active or improperly terminated TopForm Logins = "+STR(P0),REFRESH_FLG=1
1060 RETURN 
2000 SEL_LINE:
2010 LIST_BOX READ LB_LINE.CTL,IDX,LB$
2020 LIST_BOX FIND LB_LINE.CTL,IDX,LB$
2030 MSGBOX MSG("WISH")+" Delete ",MSG("CONFIRMATION"),"?,YESNO",OPT$; IF OPT$="NO" THEN RETURN 
2040 LIST_BOX LOAD LB_LINE.CTL,IDX,*
2050 REMOVE (_ZZPARM,KEY="RUN"+LB$(1,2))
2060 RETURN 
2099 RETURN 
9999 END 
12305 WRITE (_ZZPARM,KEY="RUN"+FID(0))FID(0),WHO,%X3_COMP$,APP$,"",DTE(0:"%dL, %Ml %D, %Yl - %Hz:%mz %P")
13000 DEL_ALL:
13010 ALL=LB_LINE.CTL'ITEMCOUNT; IF ALL=0 THEN RETURN 
13020 FOR AA=1 TO ALL
13030 LIST_BOX FIND LB_LINE.CTL,1,LB$
13040 LIST_BOX LOAD LB_LINE.CTL,1,*
13050 REMOVE (_ZZPARM,KEY="RUN"+LB$(1,2),DOM=*NEXT)
13060 NEXT 
13070 RETURN 
56000 REM "211380-TopForm file feldnames which are SQL keywords break Oracle. 
