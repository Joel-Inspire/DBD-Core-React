0010 ! Definition of Class: XLExpression - Base class
0035 REM "5.5 - 09/04/07 - 16.918055 - crg - SSP# 203699
0037 REM "203699-Ability to apply expressions to XML data
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 DEF CLASS "ZZGXPR" DELETE REQUIRED 
0110 ! Locals
0120 ! 
0130 LOCAL EXPRVAL$
0140 LOCAL OPTYPE
0150 LOCAL OPDESC$
0160 LOCAL SUBRETVAL$
0170 LOCAL SIDERETVAL$
0180 ! 
0190 PROPERTY SUBEXPR OBJECT SET SETSUBEXPR
0200 PROPERTY SIDEEXPR OBJECT SET SETSIDEEXPR
0210 ! 
0220 ! Operations:
0230 ! 
0240 FUNCTION EVAL$(INPUT_STR$)
0250 ENTER (INPUT_STR$)
0260 ! PRINT _OBJ," ",OPDESC$
0270 IF SUBEXPR<>0 THEN {
0280 SUBRETVAL$=SUBEXPR'EVAL$(INPUT_STR$)
0290  }
0300 IF SIDEEXPR<>0 THEN {
0310 SIDERETVAL$=SIDEEXPR'EVAL$(INPUT_STR$)
0320  }
0330 EXPRVAL$=SUBRETVAL$+SIDERETVAL$
0340 RETURN EXPRVAL$
0350 ! 
0360 END DEF
0370 ! 
0380 SETSUBEXPR:
0390 ENTER (_SUBEXPR)
0400 SUBEXPR=_SUBEXPR
0410 RETURN 
0420 ! 
0430 SETSIDEEXPR:
0440 ENTER (_SIDEEXPR)
0450 SIDEEXPR=_SIDEEXPR
0460 RETURN 
0470 ! 
0480 ! 
0490 ON_CREATE:
0500 OPTYPE=0
0510 OPDESC$="XLExpression"
0520 RETURN 
0530 ! 
0540 ON_DELETE:
0550 IF SUBEXPR<>0 THEN DROP OBJECT SUBEXPR; SUBEXPR=0
0560 IF SIDEEXPR<>0 THEN DROP OBJECT SIDEEXPR; SIDEEXPR=0
0570 RETURN 
9999 END 
56001 REM "203699-Ability to apply expressions to XML data
