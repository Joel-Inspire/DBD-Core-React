0010 ! ZWGZZH - Print Support Hard Copy 
0015 REM "Prog Type: I -3.3.1
0020 SETESC 9300; SETERR 9000
0035 REM "4.4 - 05/23/00 - 16.07 - dmm
0040 REM "Copyright 2000 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 ENTER X3$,X4$,A$,A{ALL},Z{ALL}
0100 SETERR 9000
0110 X0$="ZW2ZZH",X1$="Support Reference Sheet"
0120 DIM Z0$(80,"-"),Z1$(80,"=")
0330 IOLIST C$,C0$,C[0],C[1]
0340 IOLIST D$,D[0],D[1]
0350 IOLIST E$,E[0],E[1]
0360 IOLIST F$,F[0],F[1]
0390 IOLIST I$,I[0],I[1]
1030 DIM C$(228),C[1],D$(23),D[1],E$(29),E[1],F$(22),F[1],I[2]
1040 X2$=FNS$(X3$(86,40))
2000 REM 
2002 F0=80,F1=20,F2=INT(F0/2)
2005 DIM Y5$(F0*F1)
2010 GOSUB 5800
2020 GOSUB 6000
2040 GOSUB 6200
2100 REM "PRINTER OPTIONS
2105 Q$=FNS$(C$(133,10))
2120 REM "CALL "ZZRPTO",X3$,X4$,Y0$,R0$,R[ALL],3,C0,X0
2125 PRINT 'DIALOGUE'(5,5,80,28,"Printer Options"),
2130 CALL "ZZRPTO",X3$,X4$,Y0$,R0$,R{ALL},3,C0,X0
2131 PRINT 'POP',
2135 IF R0$(2,1)="F" AND LEN(Q$)<>10 THEN CALL "ZZPROM","4",X3$,0,"The fax number is not setup for this customer","","",0; GOTO 9920
2160 CALL "ZZPRIN",X0$,X3$,Y0$,R0$,Z{ALL},W8$,W9$,W0,W9,W2,W3,W4; ON W4 GOTO 2161,9920
2200 REM "PRINT
2205 X2$="TopForm(R) Software"
2210 DIM Y3$(F0)
2215 CALL "ZZHEAD",X0$,X1$,X2$,X3$,W0$,W1$,W2$,W9$,W3,W,W9,W8,W0,W5,W2,W8$,W5$; IF T0$="END" THEN GOTO 9900 ELSE ON W5 GOTO 2216,9910
2230 Y3$(1)=Z1$; GOSUB 7300
2250 REM "FAX?
2255 IF R0$(2,1)<>"F" THEN GOTO 2300
2256 REM LET Q$="1"+C$(133,10); IF Q$(1,4)="1404" THEN LET Q$=Q$(2,10); REM " TOOK OFF ACCT CODE +",,,,"+"2"+C$(6,3)
2257 REM IF Q$(1,4)="1770" THEN LET Q$=Q$(2,10)
2258 REM LET Q$="9,,"+Q$
2260 REM LET Y3$(1)="@-FNUM="+Q$; GOSUB 07300
2265 CLOSE (14); OPEN (14)"ZZPARM"; DIM P9$(727); READ (14,KEY=X3$(9,3)+"FX2")P9$(1); CALL "FX2SBA",X3$,X4$,C$(133,10),P9$,FAX_NUM$,X9; TEMP$=""
2270 Y3$(1)=FAX_NUM$; GOSUB 7300
2300 REM 
2320 FOR X=1 TO LEN(Y5$) STEP F0
2330 Y3$(1)=Y5$(X,F0)
2340 GOSUB 7300
2360 NEXT X
2800 REM 
2820 Y3$(1)=Z0$; GOSUB 7300
2830 GOSUB 7600
2835 IF A$(222,6)="      " OR A$(239,1)<>"C" THEN GOTO 2850 ELSE Y3$(1)=Z0$; GOSUB 7300
2840 Y3$(1)="*****     We hope this resolves this support request.  If you have any    *****"; GOSUB 7300
2841 Y3$(1)="*****     questions, or need further assistance, please call.  Otherwise  *****"; GOSUB 7300
2842 Y3$(1)="*****     this reference number will be closed after "+FND$(A$(222,6))+"           *****"; GOSUB 7300
2845 Y3$(1)=Z0$; GOSUB 7300
2846 Y3$(1)="We are looking for ways to improve our service.  Please let us know"; GOSUB 7300
2847 Y3$(1)="what you think about the service that you received on this call."; GOSUB 7300
2850 REM "FAX TAG
2852 IF R0$(2,1)<>"F" THEN GOTO 2900
2855 T0$="SSP",T1$="REF# "+A$(1,6)
2860 CALL "FX2SBB",X3$,W9,T0$,T1$,"",Q$,"",X9
2990 GOTO 9900
5800 REM "Alt sort keys
5810 FIND (Z[3],KEY=A$(240,10),DOM=5811)IOL=0330
5815 FIND (Z[4],KEY=A$(173,2),DOM=5816)IOL=0340
5820 FIND (Z[5],KEY=A$(191,3),DOM=5821)IOL=0350
5825 FIND (Z[6],KEY=A$(195,1),DOM=5826)IOL=0360
5890 RETURN 
6000 REM "BACKGROUND
6002 ! PRINT @(0,3),'CE',
6005 ! PRINT (0,ERR=6016)'SB',
6020 REM "IF FAX OUTPUT!
6050 Y5$(FNP(0,3))="Reference number:",Y5$(FNP(29,3))="Initial date:",Y5$(FNP(56,3))="Time:",Y5$(FNP(0,4))=Z0$
6070 Y5$(FNP(10,5))="Client:",Y5$(FNP(2,6))="Contact person:",Y5$(FNP(38,6))="TEL:",Y5$(FNP(0,7))=Z0$
6080 Y5$(FNP(5,8))="Brief descr:",Y5$(FNP(0,10))=Z0$
6090 Y5$(FNP(8,11))="Category:",Y5$(FNP(9,12))="Program:",Y5$(FNP(4,13))="Error number:",Y5$(FNP(5,14))="Line number:",Y5$(FNP(0,15))=Z0$
6100 Y5$(FNP(6,16))="SSP Person:",Y5$(FNP(53,16))="Priority:",Y5$(FNP(5,17))="Status code:",Y5$(FNP(5,18))="Status date:"; REM ,Y5$(FNP(41,18))="Total time spent:",Y5$(FNP(68,18))="hours"
6165 ! PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6220 ! CALL "ZZDISP","AX",C$(1,10),"S/S",X3$,X$,"",0,0,X4$
6230 Y5$(FNP(43,3),10)=FND$(A$(7,6)),Y5$(FNP(62,3),9)=FNT$(A$(13,4)),Y5$(FNP(18,5),12)=X$,Y5$(FNP(31,5),35)=C$(11,35)
6235 Y5$(FNP(18,6),16)=A$(23,16),Y5$(FNP(43,6),24)=FNP$(A$(39,14)),Y5$(FNP(18,8),60)=A$(53,60),Y5$(FNP(18,9),60)=A$(113,60)
6240 Y5$(FNP(18,11),2)=A$(173,2),Y5$(FNP(22,11),20)=D$(3,20),Y5$(FNP(18,12),8)=A$(175,8)
6245 Y5$(FNP(18,13),3)=A$(183,3),Y5$(FNP(18,14),5)=A$(186,5),Y5$(FNP(18,16),3)=A$(191,3),Y5$(FNP(23,16),25)=E$(4,25)
6250 Y5$(FNP(63,16),1)=A$(194,1),Y5$(FNP(18,17),1)=A$(195,1),Y5$(FNP(21,17),20)=F$(2,20)
6255 Y5$(FNP(18,18),10)=FND$(A$(196,6)); REM ",Y5$(FNP(30,18),9)=FNT$(A$(202,4))
6260 REM LET Y5$(FNP(59,18),7)=STR(A(0):"###.00-")
6390 RETURN 
6430 IF C9>0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6460 Y5$(FNP(18,3),6)=A$(1,6)
6490 RETURN 
7300 REM "Output line Y5$ to output device
7310 IF POS("V"=W8$)>0 THEN CALL "ZZVIEW",X3$,0,0,W3,W9,W,W9$,Y3$; GOTO 7390
7320 W=W+1; IF POS(" "<>Y3$)=0 THEN PRINT (W9)Y3$ ELSE PRINT (W9)Y3$; Y3$(1)=""
7390 IF W>=W0 THEN GOSUB 6000
7395 RETURN 
7500 REM "GET PROGRAM DESCR
7520 CLOSE (14); CALL "ZZXPRG",Q$,14,A$(175,8),0,0
7530 REM PRINT @(28,12),'CL',Q$
7545 RETURN 
7600 REM "GET NOTES IF APPLICABLE
7605 CALL "ZW2ZZY",X3$,X4$,A$(1,6),"R","ZW4"
7620 F0$="ssp"+FID(0)
7630 CLOSE (14); OPEN (14,ERR=7680)F0$
7640 READ RECORD (14,END=7680)X$
7641 GOTO 7700
7642 Y3$(1)=Z0$; GOSUB 7300
7645 P=POS($0A$=X$); IF P=0 THEN READ RECORD (14,END=7680)Q$; X$=X$+Q$; GOTO 7645
7650 Y3$(1)=X$(1,P-1); IF FLAG1$="Y" AND Y3$(1,1)="*" THEN GOTO 7695 ELSE GOSUB 7300; X$=X$(P+1); GOTO 7645
7695 RETURN 
7700 REM "CHECK FOR LAST *NEW* IN DIRECT FILE
7710 I0=-1,I1=0,I2=0
7715 I0=I0+1; READ RECORD (14,IND=I0,END=7730)X$
7720 P=POS("*clientout*"=X$); IF P=0 THEN GOTO 7715
7725 I1=I0,I2=P; X$(P,10)=""; GOTO 7720
7730 IF I2=0 THEN READ RECORD (14,IND=0)X$; GOTO 7642
7732 CALL "ZZPROM","Y",X3$,S3,"Only print last *clientout* note?","","",0; GOSUB 7750; IF S3=1 THEN I1=0,I2=0; GOTO 7730 ELSE FLAG1$="Y"
7735 READ RECORD (14,IND=I1)X$; X$=X$(I2)
7740 P=POS($0A$=X$); X$=X$(P+1)
7745 GOTO 7645
7750 REM 
7760 CLOSE (14); OPEN (14)F0$
7770 RETURN 
8000 REM "VIEW NOTES FOR THIS ITEM
8001 PRINT @(0,15),'CE','RB',"Tell WZ the 8000 routine is being used ZW2ZZH"; INPUT *
8002 Q$="r."+A$(1,6)
8005 H0$="z.csi/tfin"
8020 Q$="umask 0; cd ./"+H0$+"; vi "+Q$
8025 INVOKE Q$
8090 GOTO 1800
8900 DEF FNP(Z0,Z1)=Z0+Z1*F0+1
8905 DEF FNP$(Z9$)="("+Z9$(1,3)+") "+Z9$(4,3)+"-"+Z9$(7,4)+" Ext: "+Z9$(11,4)
8910 DEF FND$(Z9$)=Z9$(3,2)+"/"+Z9$(5,2)+"/"+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
8915 DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
8920 DEF FNB$(Z9$)=X3$(214-6*NUM(Z9$),1)
8925 DEF FNS$(Z9$)=Z9$(1,POS("        "=Z9$+"        ")-1)
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9120 ON Y8 GOTO 9900,0990,9920
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "End program
9905 CLOSE (W9); GOTO 9915
9910 CALL "ZZERPT",X3$,X4$,X0$,Y3$,Y4$,W9,W2,W5,W,W0,W8,T3,V3$
9940 EXIT 
9999 END 
