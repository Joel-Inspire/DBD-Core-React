0010 ! DEFINITION OF CLASS: XLSTACK
0035 REM "5.5 - 09/04/07 - 16.905 - crg - SSP# 203699
0037 REM "203699-Ability to apply expressions to XML data
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 DEF CLASS "ZZGSTK" DELETE REQUIRED 
0110 ! LOCAL:
0120 LOCAL STACK$
0130 LOCAL SEP$
0140 ! 
0150 ! OPERATIONS:
0160 ! 
0170 FUNCTION PUSH(_CHAR$)
0180 ENTER (_CHAR$)
0190 ! PRINT "STACK: PUSH|",_CHAR$
0200 STACK$+=SEP$+STP(_CHAR$,3,SEP$)
0210 RETURN 1
0220 ! 
0230 FUNCTION POP$()
0240 LOCAL X,RETVAL$
0250 X=POS(SEP$=STACK$,-1)
0260 IF X=0 THEN RETURN ""
0270 RETVAL$=STACK$(X+LEN(SEP$))
0280 IF X>1 THEN STACK$=STACK$(1,X-1) ELSE STACK$=""
0290 ! PRINT "STACK: POP |",RETVAL$
0300 RETURN RETVAL$
0310 ! 
0320 FUNCTION TOP$()
0330 LOCAL X,RETVAL$
0340 X=POS(SEP$=STACK$,-1)
0350 IF X=0 THEN RETURN ""
0360 RETVAL$=STACK$(X+LEN(SEP$))
0370 RETURN RETVAL$
0380 ! 
0390 END DEF
0400 ! 
0410 ON_CREATE:
0420 ENTER _SEP$
0430 SEP$=_SEP$(1,1)
0440 RETURN 
0450 ! 
0460 ON_DELETE:
0470 RETURN 
9999 END 
56001 REM "203699-Ability to apply expressions to XML data
