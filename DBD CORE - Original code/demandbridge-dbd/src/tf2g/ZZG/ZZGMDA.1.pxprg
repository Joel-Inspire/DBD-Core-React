0010 ! ZZGMDA - A/R Statistical Data Inquiry (="AR9"+%C$)
0020 ! Generated by ProvideX® NOMADS II File Maintenance on Aug. 2, 2001 9:53
0030 ! ************************************************************************
0035 ! "6.0 - 05/28/02 - 9.131666 - dmm
0040 ! "Copyright 2002 Computer Software Inc.; Norcross, Georgia
0041 ! "        Licensed Software - All Rights Reserved.
0090 ! 
0093 _CUSTOMER$=%CUSTOMER$
0095 PROCESS "ZZGMDA","../ARG/AR.EN"
0097 %CUSTOMER$=_CUSTOMER$
0099 EXIT 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0=-1; X2=-1
0140 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
0150 ! 
0190 DIM Z[NUM(X3$(60,3))],AR9[14]
0200 ! Files
0210 Z$="01O AR9...  06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; IF Z0=1 THEN CMD_STR$="END"; GOTO WRAPUP
0295 ! 
0300 ! Iolist
0310 IOLIST AR9$,AR9{ALL}
0400 ! 
0410 GOSUB GET_PARAM
0415 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
0490 RETURN 
0500 MAIN_POST_DISPLAY:! 500 - Main panel post_display logic
0520 FY$=F0$(34,4) ! Preset current fiscal year
0525 IF %CUSTOMER$<>"" THEN {
0530 CUSTOMER$=%CUSTOMER$
0535 DISABLE CONTROL CUSTOMER.CTL
0540 GOSUB PROCESS_CUSTOMER
0545  }
0550 NEXT_ID=CUSTOMER.CTL,REFRESH_FLG=1
0560 RETURN 
0595 ! 
0900 ! 900 - Wrapup
0910 WRAPUP:
0930 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 EXIT 
0995 ! 
1000 PROCESS_CUSTOMER:
1010 CALL "ZZWLKU;Parse_cust",CUSTOMER$,CUST_DIV$,CUST_CODE$
1020 CUSTOMER$=CUST_DIV$+CUST_CODE$
1030 NEXT_ID=FY.CTL
1040 REFRESH_FLG=1
1090 PROCESS_CUSTOMER_END:RETURN 
1095 ! 
9000 GET_PARAM:
9010 DIM SEC$(255); READ (Z[6],KEY="osec"+%X3_OP_ID$,DOM=*NEXT)SEC$
9020 READ (Z[6],KEY=%C$+"G/L",DOM=*NEXT)F0$
9030 MSG_1$=MSG("ARG1_033")+SEP+MSG("ARG1_034")+"."
9040 IF NUL(F0$) THEN MSGBOX MSG_1$,MSG("ATTN"),"!"; CMD_STR$="END"; GOTO WRAPUP
9050 READ (Z[6],KEY="STATI/C")F9$,F0
9060 FOR XX=0 TO 9; F1$=F1$+F9$(49+XX*17,5),F2$=F2$+F9$(54+XX*17,12); NEXT XX
9090 RETURN 
21000 ! 21000 - Read and load line details
21010 PROCESS_OPTION:
21015 IF SEC$(63,1)="Y" AND POS(OPTION$="PD")>0 THEN MSGBOX MSG("ARG1_035"),MSG("ACCESS_DEN"),"!"; RETURN 
21020 READ (Z[1],KEY=CUSTOMER$+CR_FY$+OPTION$,DOM=*RETURN)IOL=0310
21030 READ (Z[6],KEY=%C$+"G/LYE"+CR_FY$,DOM=*NEXT)GL_DATES$
21070 IF F1$(POS(OPTION$=F1$)+1,1)="N" THEN CALL "*wingrp;Unlock",FIELDS.GRP$; CALL "*wingrp;Show",FLDS.GRP$; CALL "*wingrp;Enable",BUTTONS.GRP$ ELSE NEXT_ID=OPTION.CTL; OPTIONS$="R"; REST=1; GOSUB BORDERLESS; EXIT 
21080 GOSUB LOAD_LINE_DETAILS
21085 NEXT_ID=BT_EXIT.CTL
21090 RETURN 
25000 ! 25000 - Load items into listbox
25010 LOAD_LINE_DETAILS:! COLUMN SEPARATOR IS SEP
25015 GOSUB YTD_BAL
25020 FOR I=1 TO NUM(GL_DATES$(13,2))
25030 EXECUTE "ML_DATE"+STR(I)+"$="+""""+STR(I:"00")+"- "+""""+"+FND$(GL_DATES$(15+I*6,6))"
25040 NEXT I
25050 FOR I=NUM(GL_DATES$(13,2))+1 TO 13
25060 EXECUTE "MULTI_LINE HIDE ML_DATE"+STR(I)+".CTL;MULTI_LINE HIDE PERIOD_AMT_"+STR(I)+".CTL;MULTI_LINE HIDE YTD_AMT"+STR(I)+".CTL"
25070 NEXT I
25090 RETURN 
25095 ! 
26000 ! Load
26010 YTD_BAL:
26015 FOR AA=1 TO 13
26020 EXECUTE "TOTAL_YTD=TOTAL_YTD+PERIOD_AMT_"+STR(AA)+",YTD_AMT"+STR(AA)+"$=STR(TOTAL_YTD)"
26030 NEXT AA
27000 ! 
27090 RETURN 
30000 LOAD_FISCAL_YEAR:
30010 READ (Z[6],KEY=%C$+"A/R",DOM=*NEXT)GL_REC$; CR_YEAR$=GL_REC$(7,4),CR_PD$=GL_REC$(11,2)
30020 KE$=%C$+"G/LYE",CR_FY$=""
30030 READ (Z[6],KEY=KE$,DOM=*NEXT)
30040 K$=KEY(Z[6],END=30100); READ (Z[6])Z9$
30050 IF LEN(K$)<8 OR KE$<>K$(1,8) THEN GOTO END_LOAD_FISCAL_YEAR
30060 ! IF POS(Z9$(99,1)="CR")>0 THEN GOTO 30040
30070 CR_FY$=CR_FY$+K$(9)+"/"
30080 IF K$(9,4)=CR_YEAR$ THEN CC$=Z9$(21)
30090 GOTO 30040
30100 END_LOAD_FISCAL_YEAR:
30110 CC$=CC$(NUM(CR_PD$)*6-5,6),END_DATE$=CC$,REFRESH_FLG=1
30120 DROP_BOX LOAD CR_FY.CTL,CR_FY$
30130 DROP_BOX WRITE FY.CTL,CR_YEAR$
30140 DROP_BOX LOAD END_FISCAL.CTL,CR_FY$
30150 DROP_BOX WRITE END_FISCAL.CTL,CR_YEAR$
30160 CR_ACCTPD$=""
30170 FOR ACCT=1 TO 12; CR_ACCTPD$=CR_ACCTPD$+STR(ACCT:"00")+"/"; NEXT ACCT
30180 DROP_BOX LOAD CR_ACCTPD.CTL,CR_ACCTPD$
30190 DROP_BOX WRITE CR_ACCTPD.CTL,CR_PD$
30200 END_ACCTPD$=CR_ACCTPD$
30210 DROP_BOX LOAD END_ACCTPD.CTL,CR_ACCTPD$
30220 DROP_BOX WRITE END_ACCTPD.CTL,CR_PD$
30230 CR_ACCTPD$=CR_PD$
30240 RETURN 
33000 BORDERLESS:
33002 IF MID(GL_DATE$,13,2)="12" THEN MULTI_LINE HIDE ML_DATE13.CTL; MULTI_LINE HIDE PERIOD_AMT_13.CTL; MULTI_LINE HIDE YTD_AMT13.CTL
33005 IF REST1=1 AND REST2=REST THEN GOTO *RETURN
33060 CALL "BORDERLESS",0,OPTIONS$,REST,FIELDS1.GRP$
33070 REST1=1,REST2=REST
33075 IF MID(GL_FATE$,13,2)="12" THEN MULTI_LINE HIDE ML_DATE13.CTL; MULTI_LINE HIDE PERIOD_AMT_13.CTL; MULTI_LINE HIDE YTD_AMT13.CTL
33080 RETURN 
