0010 ! Copied from LIBCOMP -- Library Comparison Program, for DB internal use
0020 ! (c) Copyright 1997 Sybex Ltd.
0030 ! Written by Julie Kufner
0035 REM "5.6 - 05/21/09 - 10.426944 - jdf - SSP# 227983
0037 REM "227983-Tool to compare two directories of source code.             
0040 REM "Copyright 2009 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0060 ENTER OLD_LIB$,OLD_FN$,OLD_LIST$,NEW_LIB$,NEW_FN$,NEW_LIST$,SHOW_CHKBX$,COMP_FLG$,LIB_DEF$,ERR=*NEXT
0061 REM ENTER ARG_1$,ARG_2$,ARG_3$,ARG_4$,ARG_5$,ARG_6$,ARG_7$,ARG_8$,ARG_9$,ERR=*NEXT
0062 ARG_1$=OLD_LIB$,ARG_2$=OLD_FN$
0065 GOSUB INIT
0070 GOSUB GET_PANEL_RECORDS
0080 GOSUB FINISHED_LIBCREP
0085 GOSUB WRAPUP
0100 EXIT 
0110 INIT:
0111 SV_KR=PRM('KR'); SET_PARAM 'KR'=0
0120 LIB_FN=HFN; OPEN INPUT (LIB_FN)ARG_1$
0130 NEW_FN=NUM(NEW_FN$) ! NEW_FN=LIB_FN
0131 OLD_LIB$=ARG_1$
0132 REM NEW_LIB$=OLD_LIB$
0133 O=POS(" "=ARG_2$); IF O<>0 THEN THE_PANEL$=PAD(UCS(ARG_2$(1,O-1)),12)
0140 RETURN 
0200 ! ^100 - Wrapup
0210 WRAPUP:
0211 PRINT 'CURSOR'(0),; SET_PARAM 'KR'=SV_KR
0212 CLOSE (OLD_FN,ERR=0220)
0220 CLOSE (LIB_FN,ERR=0230)
0230 CLOSE (NEW_FN,ERR=0240)
0240 RETURN 
1000 ! ^1000 - load old library
1010 LOAD_OLD_LIB:
1020 VARDROP_BOX WRITE OLD_LIB.CTL,OLD_LIB$,ERR=*NEXT
1030 RETURN 
1040 ! - input old library name
1050 INPUT_OLD_LIB:
1060 VARDROP_BOX READ OLD_LIB.CTL,OLD_PTH$,ERR=NO_OLD_LIB_MSG
1070 IF STP(OLD_PTH$,2)="" THEN GOTO NO_OLD_LIB_MSG
1071 IF POS("..."=OLD_PTH$)<>0 THEN VARDROP_BOX READ OLD_LIB.CTL,__VAR_INDX,ERR=*NEXT; IF __VAR_INDX>0 THEN OLD_PTH$=%MENU_PATHS$[__VAR_INDX] END_IF 
1080 GOTO CHK_OLD_LIB
1090 RETURN 
1100 ! ^100 - load new library
1110 LOAD_NEW_LIB:
1120 VARDROP_BOX WRITE NEW_LIB.CTL,NEW_LIB$,ERR=*NEXT
1130 RETURN 
1140 ! - input new library name
1150 INPUT_NEW_LIB:
1160 VARDROP_BOX READ NEW_LIB.CTL,NEW_PTH$,ERR=NO_NEW_LIB_MSG
1170 IF STP(NEW_PTH$,2)="" THEN GOTO NO_NEW_LIB_MSG
1171 IF POS("..."=NEW_PTH$)<>0 THEN VARDROP_BOX READ NEW_LIB.CTL,__VAR_INDX,ERR=*NEXT; IF __VAR_INDX>0 THEN NEW_PTH$=%MENU_PATHS$[__VAR_INDX] END_IF 
1180 GOTO CHK_NEW_LIB
1190 RETURN 
1200 ! ^100 - Load the library list
1210 LOAD_OLD_PANELS:
1220 LIST_BOX LOAD OLD_PANELS.CTL,"" ! Clear list
1230 READ RECORD (LIB_FN,KEY="",DOM=*NEXT) ! Rewind file
1231 X$="<Library Defaults>"
1232 LIST_BOX LOAD OLD_PANELS.CTL,0,X$
1240 K$=KEY(LIB_FN,END=1280)
1241 IF K$>$80$ THEN GOTO 1280
1242 IF LEN(K$)<>16 THEN LIST_BOX LOAD OLD_PANELS.CTL,""; GOTO 9090 ! on error clear libdef
1250 READ (LIB_FN,ERR=9090)IOL=10010
1260 IF K$(13,4)="0000" AND K$(1,12)<>DIM(12) THEN X$=STP(K$(1,12))+" ("+OBJ_TXT$+")"; LIST_BOX LOAD OLD_PANELS.CTL,0,X$; IF THE_PANEL$=K$(1,12) THEN INIT_VAL$=X$
1261 READ (LIB_FN,KEY=K$(1,12)+$FFFF$,DOM=*NEXT)
1270 GOTO 1240
1280 LIST_BOX WRITE OLD_PANELS.CTL,1,ERR=1290
1290 RETURN 
1300 ! ^ 100 - load new panels
1310 LOAD_NEW_PANELS:
1320 LIST_BOX LOAD NEW_PANELS.CTL,"" ! Clear list
1321 X$="<Library Defaults>"
1322 LIST_BOX LOAD NEW_PANELS.CTL,0,X$
1330 READ RECORD (NEW_FN,KEY="",DOM=*NEXT) ! Rewind file
1340 K$=KEY(NEW_FN,END=1380)
1341 IF K$>$80$ THEN GOTO 1380
1342 IF LEN(K$)<>16 THEN LIST_BOX LOAD NEW_PANELS.CTL,""; GOTO 9090 ! on error clear libdef
1350 READ (NEW_FN,ERR=9090)IOL=10020
1360 IF K$(13,4)="0000" AND K$(1,12)<>DIM(12) THEN X$=STP(K$(1,12))+" ("+N_OBJ_TXT$+")"; LIST_BOX LOAD NEW_PANELS.CTL,0,X$; IF THE_PANEL$=K$(1,12) THEN INIT_VAL$=X$
1361 READ (NEW_FN,KEY=K$(1,12)+$FFFF$,DOM=*NEXT)
1370 GOTO 1340
1380 LIST_BOX WRITE NEW_PANELS.CTL,1,ERR=1390
1390 RETURN 
1400 ! ^100 - Browse old library
1410 OLD_LIB_BTN:! load libraries into old lib list, on select, bring up all panels in panel list for lib
1411 X$="",D$=""; IF _FIL_NO<>0 THEN X$=PTH(_FIL_NO),P=POS(DLM=X$,-1),D$=X$(1,P-1),X$=X$(P+1)
1412 GET_FILE_BOX READ O_PTH$,LWD,"Compare Old file selection","Nomads lib (*."+%D_DEF_SFX$+")|*."+%NOMAD_DEF_SFX$+"/All Files (*.*)|*.*/" ! GET_FILE_BOX X$,D$,"Compare file selection"
1413 IF STP(O_PTH$,2)="" THEN EXIT ELSE OLD_PTH$=O_PTH$
1420 CHK_OLD_LIB:
1430 IF STP(OLD_PTH$,2)="" THEN GOTO NO_OLD_LIB_MSG
1440 X=HFN; OPEN INPUT (X,NBF=10,ERR=9020)OLD_PTH$
1450 X$=FIB(X); IF DEC(X$(11,1))<>16 OR X$(19,1)<>"K" THEN CLOSE (X); GOTO 9020
1460 OLD_ERR$="",LIB_FN=X,OLD_LIB$=PTH(X)
1470 GOSUB LOAD_OLD_LIB; GOSUB LOAD_OLD_PANELS
1480 EXIT 
1500 ! ^ 100 - Browse new library
1510 NEW_LIB_BTN:
1511 X$="",D$=""; IF _FIL_NO<>0 THEN X$=PTH(_FIL_NO),P=POS(DLM=X$,-1),D$=X$(1,P-1),X$=X$(P+1)
1512 GET_FILE_BOX READ N_PTH$,LWD,"Compare New file selection","Nomads lib (*."+%D_DEF_SFX$+")|*."+%NOMAD_DEF_SFX$+"/All Files (*.*)|*.*/"
1513 IF STP(N_PTH$,2)="" THEN EXIT ELSE NEW_PTH$=N_PTH$
1520 ! 
1530 CHK_NEW_LIB:
1540 IF NEW_PTH$="" THEN GOTO NO_NEW_LIB_MSG
1550 X=HFN; OPEN INPUT (X,NBF=10,ERR=9040)NEW_PTH$
1560 X$=FIB(X); IF DEC(X$(11,1))<>16 OR X$(19,1)<>"K" THEN CLOSE (X); GOTO 9040
1570 NEW_ERR$="",NEW_FN=X,NEW_LIB$=PTH(X)
1580 GOSUB LOAD_NEW_LIB; GOSUB LOAD_NEW_PANELS
1590 EXIT 
1591 ! chk LIB_DEF
1592 VERIFY_LIB_DEF:
1593 IF LIB_DEF$<>"1" THEN GOTO 1596 ELSE IF OLD_LIB$<>NEW_LIB$ THEN GOTO 1596
1594 LIB_DEF$="",REFRESH_FLG$="1"; PERFORM "*winproc;refresh_scrn"
1595 MSGBOX "Same Library being compared, no Library Default compare available","Error","!"; EXIT 
1596 RETURN 
1600 ! ^ 100 - Select Compare button
1610 COMPARE_BTN:
1620 IF _EOM$<>$0D$ AND _EOM$<>$02$ THEN EXIT 
1630 SELECT_COMPARE_BTN:
1640 OLD_LIST$="",NEW_LIST$="",COMP_FLG$="C1",LIB_DEF$=""
1650 LIST_BOX READ OLD_PANELS.CTL,OLD_LIST$,ERR=1670
1660 IF OLD_LIST$<>"" THEN IF STP(OLD_LIST$,2)="<Library Defaults>" THEN GOTO 1680 ELSE OLD_LIST$=OLD_LIST$(1,POS(" ("=OLD_LIST$)-1); GOTO 1680
1670 MSGBOX "No panel in Old Library selected for compare","Error","!"; EXIT 
1680 LIST_BOX READ NEW_PANELS.CTL,NEW_LIST$,ERR=1700
1690 IF NEW_LIST$<>"" THEN IF STP(NEW_LIST$,2)="<Library Defaults>" THEN GOTO 1701 ELSE NEW_LIST$=NEW_LIST$(1,POS(" ("=NEW_LIST$)-1); GOTO 1701
1700 MSGBOX "No panel in New Library selected for compare","Error","!"; EXIT 
1701 IF STP(OLD_LIB$)=STP(NEW_LIB$) AND STP(OLD_LIST$)=STP(NEW_LIST$) THEN GOTO SAME_LIBS
1702 IF OLD_LIST$="<Library Defaults>" THEN LIB_DEF$="1"; IF NEW_LIST$="<Library Defaults>" THEN GOTO 2000 ELSE MSGBOX "Cannot compare Library Defaults to another panel","Error","!"; EXIT 
1703 IF NEW_LIST$="<Library Defaults>" THEN MSGBOX "Cannot compare Library Defaults to another panel","Error","!"; EXIT 
1710 OLD_LIST$=OLD_LIST$+SEP,NEW_LIST$=NEW_LIST$+SEP
1720 GOTO 2000
1730 ! - select all button
1740 SELECT_ALL_BTN:
1750 GOSUB SELECT_ALL
1760 GOTO 2000
1800 ! ^100 - Select Compare Corresponding button
1810 CORRESP_BTN:
1820 IF _EOM$<>$0D$ AND _EOM$<>$02$ THEN EXIT 
1830 SELECT_CORRESP_BTN:
1832 IF STP(OLD_LIB$)=STP(NEW_LIB$) THEN GOTO SAME_LIBS
1840 OLD_LIST$="",NEW_LIST$="",COMP_FLG$="CC",LIB_DEF$="1"
1850 OLD_N=0
1860 OLD_N=OLD_N+1
1870 LIST_BOX FIND OLD_PANELS.CTL,OLD_N,OLD_NME$,ERR=1960
1871 IF OLD_NME$="<Library Defaults>" THEN GOTO 1860 ! don't add libdef to list
1880 OLD_N$=OLD_NME$(1,POS(" ("=OLD_NME$)-1)
1890 NEW_N=0
1900 NEW_N=NEW_N+1
1910 LIST_BOX FIND NEW_PANELS.CTL,NEW_N,NEW_NME$,ERR=1860
1911 IF NEW_NME$="<Library Defaults>" THEN GOTO 1900
1920 NEW_N$=NEW_NME$(1,POS(" ("=NEW_NME$)-1)
1930 IF OLD_N$<>NEW_N$ THEN GOTO 1900
1940 OLD_LIST$=OLD_LIST$+OLD_N$+SEP
1950 GOTO 1900
1960 NEW_LIST$=OLD_LIST$
1961 IF STP(OLD_LIST$,2)="" THEN GOTO NO_PANELS
2000 ! ^ 1000 - 2000 Start compare screen
2010 START_COMPARE:
2020 OLD_FN$=STR(LIB_FN),NEW_FN$=STR(NEW_FN)
2030 PROCESS "libcrep","",OLD_LIB$,OLD_FN$,OLD_LIST$,NEW_LIB$,NEW_FN$,NEW_LIST$,SHOW_CHKBX$,COMP_FLG$,LIB_DEF$
2040 EXIT 
2050 ! - process all  panel records
2060 GET_PANEL_RECORDS:
2061 PRINT 'CURSOR'(1),
2080 GOSUB INIT_TMP_PRINT
2081 GOSUB CHK_LIB_DEFAULT
2090 GOSUB GET_NEXT_PANEL_NME; IF P_STATUS$="END" THEN GOTO END_OF_PANELS
2100 GOSUB INIT_FOR_CURRENT_PANEL
2110 GOSUB LOAD_PANEL_NAMES
2120 GOSUB READ_NEXT_OLD_REC; IF P_STATUS$="END" THEN GOSUB PROCESS_NEW_RECS; GOSUB PROCESS_DISPLAY_RECS; GOTO 2090
2130 GOSUB READ_NEW_RECS; IF P_STATUS$="END" THEN GOSUB PROCESS_OLD_REC; GOTO 2120
2140 GOSUB PROCESS_MATCH_RECS
2141 PRINT 'CURSOR'(0),
2150 GOTO 2120
2160 ! - finished all panels
2170 END_OF_PANELS:
2180 IF MAX_DIFF_CTR<=0 THEN CMD_STR$="END"; GOTO 2190; REM ; IF MAX_DIFF_CTR>0 THEN MSGBOX "Compare completed ","FYI" ELSE MSGBOX "Compare completed, No differences found","FYI"; CMD_STR$="END"; GOTO 2190
2181 CALL "*wingrp;enable",ENDCOMP.GRP$
2190 CLOSE (TMP_FN,ERR=2200)
2200 CLOSE (TMP_PRT_FN,ERR=2210)
2210 EXIT 
2220 ! - on print button
2230 PRINT_COMPARE:
2260 PRT_FN=HFN; OPEN (PRT_FN,ERR=*NEXT)%NOMAD_ISWINDX$+"*winprt*"; GOTO 2270 ! ; on print report
2265 EXIT 
2270 PRT_MXL=MXL(PRT_FN)-4,PRT_MXC=MXC(PRT_FN),PANEL_NUM=0,PG_NO=0,CUR_LINE=0; PRINT 'CURSOR'(1), ! panel_num tracks every time panel changes, max_panel_num is total number of panels,
2280 CALL "*progbar;init","Printing Compare Report",40
2290 STATUS$="aborted"
2300 TMP_PRT_FN=HFN; OPEN (TMP_PRT_FN,ERR=9070)TMP_PRT_FILE$
2310 GOSUB PRINT_LINES_FOR_PANEL
2320 ! - finished print report
2330 FINISHED_PRINT:
2340 STATUS$="complete"; CALL "*progbar;wrap_up"; PRINT 'CURSOR'(0),
2345 IF PRT_FN>0 THEN CLOSE (PRT_FN)
2350 MSGBOX "Report print "+STATUS$,"FYI"
2370 EXIT 
2380 ! - at end of 'libcrep'
2390 FINISHED_LIBCREP:
2400 CLOSE (TMP_FN,ERR=2410) ! finished libcrep
2410 IF PRT_FN>0 THEN CLOSE (PRT_FN)
2420 CLOSE (TMP_PRT_FN)
2421 ERASE TMP_NEW$,ERR=2430
2430 ERASE TMP_PRT_FILE$,ERR=2440
2440 EXIT 
2450 ! - print detail lines
2460 PRINT_LINES_FOR_PANEL:
2470 L_CTR=PRT_MXL
2480 GOSUB READ_NEXT_PRINT; IF P_STATUS$="END" THEN RETURN 
2490 IF POS("Comparing Panels"=P_LINE$)=1 THEN PRT_HDG1$=P_LINE$,PRT_HDG2$="",PRT_HDG3$=""; GOTO 2650 ! init for new panel
2491 L_CTR=L_CTR+1
2492 P=POS("Panels: "=P_LINE$); IF P<>1 THEN GOTO 2570
2500 ! update panel progbar for next panel
2510 PANEL_NUM=PANEL_NUM+1
2520 IF MAX_PANEL_CTR>0 THEN LAST_PERCENT=CUR_LINE*100/MAX(1,TOT_PRINT_LINES); CALL "*progbar;update_percent",ERR=2330,"Printing... "+PANEL_NME$,LAST_PERCENT
2552 IF LEN(P_LINE$)<71 THEN PRT_HDG2$=P_LINE$ ELSE P=POS(" to "=P_LINE$); PRT_HDG2$=P_LINE$(1,P+4),PRT_HDG3$=PAD(" ",7," ")+P_LINE$(P+4)
2560 IF BREAK_CHKBX$="1" OR L_CTR+7>PRT_MXL THEN GOSUB PRT_NEW_PAGE; GOTO 2650 ELSE P_PAD$=" "; GOSUB SPECIAL_LINE; P_LINE$=PRT_HDG2$; GOSUB PRT_LINE; IF PRT_HDG3$<>"" THEN P_LINE$=PRT_HDG3$,L_CTR=L_CTR+1; GOSUB PRT_LINE
2561 P_PAD$=" "; GOSUB SPECIAL_LINE; GOTO 2650
2570 IF POS("* "=P_LINE$)<>1 THEN GOTO 2581
2580 IF L_CTR+3>PRT_MXL THEN L_CTR=L_CTR+3; GOTO 2590 ELSE P_PAD$=" "; GOSUB SPECIAL_LINE; GOTO 2590
2581 IF POS("*** "=P_LINE$)<>1 THEN GOTO 2582 ELSE IF L_CTR+7>PRT_MXL THEN L_CTR=L_CTR+7; GOTO 2590 ELSE P_PAD$=" "; GOSUB SPECIAL_LINE; GOTO 2590 ! init for new section common/old/new
2582 IF POS("****"=P_LINE$)<>1 THEN GOTO 2584 ELSE PRT_HDG1$="",PRT_HDG2$="",PRT_HDG3$="" ! init for end of curr panel
2583 IF L_CTR+2>PRT_MXL THEN L_CTR=L_CTR+2; GOTO 2590 ELSE P_PAD$=" "; GOSUB SPECIAL_LINE; GOTO 2590
2584 IF POS(" was "+QUO=P_LINE$)<>19 THEN GOTO 2590
2585 IF L_CTR+2>PRT_MXL THEN L_CTR=L_CTR+2; GOTO 2590 ELSE P_PAD$=" "; GOSUB SPECIAL_LINE
2590 ! PRINT REST OF LINES
2610 IF L_CTR>PRT_MXL THEN HLD_LINE$=P_LINE$; GOSUB PRT_NEW_PAGE; P_LINE$=HLD_LINE$,HLD_LINE$=""
2640 GOSUB PRT_LINE
2641 IF TOO_LONG$<>"" THEN GOTO 2610
2650 GOTO 2480
2660 ! - on new page, print headings
2670 PRT_NEW_PAGE:
2680 PG_NO=PG_NO+1,L_CTR=3
2690 IF PG_NO>1 THEN PRINT (PRT_FN)'FF'
2700 IF PRT_HDG1$<>"" THEN P_LINE$=PAD(PRT_HDG1$,60)+"Page "+STR(PG_NO); GOSUB PRT_LINE; P_PAD$=" "; GOSUB SPECIAL_LINE
2710 IF PRT_HDG2$<>"" THEN P_LINE$=PRT_HDG2$; GOSUB PRT_LINE
2711 IF PRT_HDG3$<>"" THEN P_LINE$=PRT_HDG3$; GOSUB PRT_LINE
2712 P_PAD$=" "; GOSUB SPECIAL_LINE
2720 RETURN 
2751 ! print line
2760 PRT_LINE:
2761 P_LINE$=" "+P_LINE$,TOO_LONG$=""; IF LEN(P_LINE$)>70 THEN TOO_LONG$=P_LINE$(71),P_LINE$=P_LINE$(1,70)+"-"
2770 PRINT (PRT_FN,ERR=2780)P_LINE$; GOTO 2781
2780 GOSUB PRT_LINE_ERR; IF X$="NO" THEN CMD_STR$="END"; EXIT ! print line error
2781 IF TOO_LONG$<>"" THEN L_CTR=L_CTR+1,P_LINE$=PAD(" ",22)+QUO+TOO_LONG$
2790 RETURN 
2800 ! - read next print
2810 READ_NEXT_PRINT:
2820 P_STATUS$=""
2830 READ RECORD (TMP_PRT_FN,ERR=2840,END=2860)P_LINE$
2832 CUR_LINE=CUR_LINE+1,TEST_PERCENT=CUR_LINE*100/MAX(1,TOT_PRINT_LINES); IF TEST_PERCENT-LAST_PERCENT>10 THEN LAST_PERCENT=TEST_PERCENT; CALL "*progbar;update_percent",ERR=2330,"Printing... "+PANEL_NME$,LAST_PERCENT
2834 RETURN 
2840 GOSUB PRT_LINE_ERR; IF X$="NO" THEN CMD_STR$="END"; EXIT ! print line error
2860 P_STATUS$="END"; RETURN 
2870 ! - print a  line of blanks/*
2880 SPECIAL_LINE:
2890 H_LINE$=P_LINE$,P_LINE$=PAD(P_PAD$,69,P_PAD$),L_CTR=L_CTR+1; GOSUB PRT_LINE; P_LINE$=H_LINE$
2910 RETURN 
3000 ! ^1000 -3000 -  pANEL FILES
3010 GET_NEXT_PANEL_NME:
3020 P_STATUS$="",ON_ALL$="",NEW_DONE_LIST$="",ON_QUERY$=""
3030 P=POS(SEP=OLD_LIST$); IF P=0 THEN OLD_PANEL$="",P_STATUS$="END",OLD_PANEL_NME$=""; GOTO 3066
3040 MAX_PANEL_CTR=MAX_PANEL_CTR+1
3050 OLD_PANEL$=OLD_LIST$(1,(P-1)),OLD_LIST$=OLD_LIST$(P+1),PANEL_CTR=0
3060 OLD_PANEL_NME$=OLD_PANEL$; P=POS(" "=OLD_PANEL_NME$); IF P<>0 THEN OLD_PANEL_NME$=OLD_PANEL_NME$(1,P-1)
3061 IF COMP_FLG$<>"CA" AND COMP_FLG$<>"MA" THEN GOTO 3070
3064 P=POS(SEP+OLD_PANEL_NME$+SEP=SEP+NEW_LIST$+SEP); IF P=1 THEN GOTO 3070 ! panel in both libs
3065 IF P=0 THEN GOSUB CHK_NEW_1ST; ON_ALL$="OLD",COMP_LIBS$=OLD_LIB$+":"+OLD_PANEL_NME$; GOSUB PANEL_MISSING; GOTO 3030 ! on all btn, have panel in OLD list only
3066 ON_ALL$="NEW" ! p>1 then on all btn, have panel on New list only
3070 P=POS(SEP=NEW_LIST$); IF P=0 THEN P_STATUS$="END"; GOTO 3140
3080 NEW_PANEL$=NEW_LIST$(1,(P-1)),NEW_LIST$=NEW_LIST$(P+1)
3090 NEW_PANEL_NME$=NEW_PANEL$; P=POS(" "=NEW_PANEL_NME$); IF P>0 THEN NEW_PANEL_NME$=NEW_PANEL_NME$(1,P-1)
3091 IF ON_ALL$="NEW" THEN MAX_PANEL_CTR=MAX_PANEL_CTR+1,COMP_LIBS$=NEW_LIB$+":"+NEW_PANEL_NME$; GOSUB PANEL_MISSING; IF P_STATUS$<>"END" THEN GOTO 3064 ELSE GOTO 3066 ! if end finish new only, if not end go back and finish old
3100 COMP_LIBS$=OLD_LIB$+":"+OLD_PANEL_NME$+"  to  "+NEW_LIB$+":"+NEW_PANEL_NME$
3110 IF COMP_LIBS$<>"" THEN PERFORM "*winproc;refresh_scrn" ! ; WAIT .1
3120 ! read old_panel_key record
3130 OLD_PANEL_KEY$=PAD(OLD_PANEL_NME$,12)+"0000"
3140 RETURN 
3150 ! finish new only
3160 CHK_NEW_1ST:
3170 P=POS(SEP=NEW_LIST$); IF P=0 THEN RETURN ELSE NEW_PANEL_NME$=NEW_LIST$(1,(P-1)); P=POS(" "=NEW_PANEL_NME$); IF P>0 THEN NEW_PANEL_NME$=NEW_PANEL_NME$(1,P-1)
3180 IF NEW_PANEL_NME$>=OLD_PANEL_NME$ THEN RETURN 
3191 ON_ALL$="NEW",P=POS(SEP=NEW_LIST$); NEW_PANEL$=NEW_LIST$(1,(P-1)),NEW_LIST$=NEW_LIST$(P+1)
3193 MAX_PANEL_CTR=MAX_PANEL_CTR+1,COMP_LIBS$=NEW_LIB$+":"+NEW_PANEL_NME$; GOSUB PANEL_MISSING
3194 GOTO 3170
3200 ! ^100 read old records
3210 READ_NEXT_OLD_REC:
3220 P_STATUS$=""
3230 OLD_PANEL_KEY$=KEY(LIB_FN,END=3280)
3240 READ (LIB_FN,ERR=9090)IOL=10010
3250 IF PAD(OLD_PANEL_NME$,12)<>OLD_PANEL_KEY$(1,12) THEN GOTO 3280
3260 IF OLD_PANEL_KEY$(13,4)="0000" THEN OLD_NAME$=OLD_PANEL_NME$+":"+OBJ_TXT$,ITEM_LIST$="Header"+SEP ! =STP(old_PANEL_KEY$(1,12),2)+":"+OBJ_TXT$
3261 ! IF OLD_PANEL_KEY$(13,1)="M" AND OBJ_NME$="" THEN LET OBJ_NME$=OLD_PANEL_KEY$(13,4)
3270 RETURN 
3280 P_STATUS$="END"; RETURN 
3300 ! ^100 -  read new records to search for matching element name
3310 READ_NEW_RECS:
3320 P_STATUS$="",NO_NEW$="",NEW_PANEL_KEY$=PAD(NEW_PANEL_NME$,12)+OLD_PANEL_KEY$(13,4)
3321 READ (TMP_FN,KEY=NEW_PANEL_KEY$,DOM=3328)IOL=10020
3322 IF OLD_PANEL_KEY$(13,4)="0000" THEN ON_REC$="Header "; IF UCS(OBJ_TYPE$)="Q" OR UCS(N_OBJ_TYPE$)="Q" THEN ON_QUERY$="Y"; RETURN ELSE RETURN 
3323 IF OLD_PANEL_KEY$(13,1)="M" THEN GOSUB CHK_ON_MENU; GOTO 3390 ! Menu records
3324 IF OLD_PANEL_KEY$(13,1)="U" THEN ON_REC$="Control "; GOTO 3400 ELSE IF OLD_PANEL_KEY$(13,1)="R" OR OLD_PANEL_KEY$(13,1)="D" THEN ON_REC$="Drag "; GOTO 3400 ELSE IF OLD_PANEL_KEY$(13,1)="V" THEN ON_REC$="Depend "; GOTO 3400 ELSE IF OLD_PANEL_KEY$(13,1)="X" THEN ON_REC$="Gridpres "; GOTO 3390 ELSE IF OLD_PANEL_KEY$(13,1)="Y" THEN ON_REC$="CellLogic "; GOTO 3390 ! U=Control,R=Drag and Drop,"V"=Dependancy records,"X"=Grid Presets, "Y"="CellLogic"
3325 IF LCS(OBJ_NME$)<>LCS(N_OBJ_NME$) THEN GOTO 3330 ! names don't match, read all recs!
3326 IF ON_QUERY$="Y" THEN IF STP(OBJ_NME$)="" THEN GOTO 3390 ELSE IF OBJ_TIP$=N_OBJ_TIP$ THEN GOTO 3390 ELSE GOTO 3330
3327 IF STP(OBJ_NME$)="" THEN GOTO 3330 ELSE IF POS("Rr":OBJ_TYPE$)=0 AND POS("Rr":N_OBJ_TYPE$)=0 THEN GOTO 3390 ELSE IF OBJ_IDX$<>N_OBJ_IDX$ THEN GOTO 3330 ELSE GOTO 3390 ! names match & not blank do rec, if radio button key match but index different then match on obj_idx!
3328 NO_NEW$="Y"; IF OLD_PANEL_KEY$(13,1)="M" THEN GOSUB CHK_ON_MENU; GOTO 3410 ! record not on New file
3329 IF OLD_PANEL_KEY$(13,1)="U" THEN ON_REC$="Control "; GOTO 3410 ELSE IF OLD_PANEL_KEY$(13,1)="R" OR OLD_PANEL_KEY$(13,1)="D" THEN ON_REC$="Drag "; GOTO 3410 ELSE IF OLD_PANEL_KEY$(13,1)="V" THEN ON_REC$="Depend "; GOTO 3410 ELSE IF OLD_PANEL_KEY$(13,1)="X" THEN ON_REC$="Gridpres "; GOTO 3410 ELSE IF OLD_PANEL_KEY$(13,1)="Y" THEN ON_REC$="CellLogic "; GOTO 3410
3330 READ RECORD (TMP_FN,KEY=PAD(NEW_PANEL_NME$,12),DOM=*NEXT) ! look for match on obj_nme
3340 NEW_PANEL_KEY$=KEY(TMP_FN,END=3410) ! start of new file **Old only if at end of file
3350 READ (TMP_FN,KEY=NEW_PANEL_KEY$,ERR=9090)IOL=10020
3360 IF PAD(NEW_PANEL_NME$,12)<>NEW_PANEL_KEY$(1,12) THEN GOTO 3410 ! end of new records
3370 IF OLD_PANEL_KEY$(13,4)="0000" AND NEW_PANEL_KEY$(13,4)="0000" THEN ON_REC$="Header "; IF UCS(OBJ_TYPE$)="Q" OR UCS(N_OBJ_TYPE$)="Q" THEN ON_QUERY$="Y"; GOTO 3400 ELSE GOTO 3400
3371 IF LCS(OBJ_NME$)<>LCS(N_OBJ_NME$) THEN GOTO 3340
3372 IF ON_QUERY$="" THEN GOTO 3380
3373 IF OBJ_TYPE$<>"E" AND N_OBJ_TYPE$<>"E" THEN GOTO 3380
3374 IF LCS(STP(OBJ_TIP$,2))=LCS(STP(N_OBJ_TIP$,2)) THEN GOTO 3390 ELSE GOTO 3340 ! if query and names match and prefix (in obj_tip) match then got match else go look for a matching prefix
3380 ! check on radio button, names match and obj_idx matches
3381 IF POS("Rr":OBJ_TYPE$)=0 AND POS("Rr":N_OBJ_TYPE$)=0 THEN GOTO 3390
3382 IF OBJ_IDX$=N_OBJ_IDX$ THEN OBJ_NME$=OBJ_NME$+"(idx="+OBJ_IDX$+")",NEW_DONE_LIST$=NEW_DONE_LIST$+OBJ_NME$+SEP; GOTO 3400 ELSE GOTO 3340
3390 IF POS(OBJ_NME$+" "+NEW_PANEL_KEY$(13,4)+SEP=NEW_DONE_LIST$)>0 THEN GOTO 3340 ! already done name in new panel, when multi same names. got and search for another record with same name
3391 NEW_DONE_LIST$=NEW_DONE_LIST$+OBJ_NME$+" "+NEW_PANEL_KEY$(13,4)+SEP
3400 RETURN 
3410 P_STATUS$="END"; RETURN 
3420 ! 
3430 CHK_ON_MENU:
3440 OBJ_NME$=OLD_PANEL_KEY$(13,4)
3450 IF OLD_PANEL_KEY$(13,4)="M000" THEN ON_REC$="Menuheader "; RETURN 
3460 IF OLD_PANEL_KEY$(13,2)="M " THEN ON_REC$="Menukey "; RETURN 
3461 IF OLD_PANEL_KEY$(13,1)="M" THEN ON_REC$="Menuitem "
3470 RETURN 
3480 ! 
3481 CHK_OB_MATCH_KEY: OBJ_NME$=OLD_PANEL_KEY$(13,4)
3490 ! 
3500 ! ^100 - search for remaining new elements only
3510 PROCESS_NEW_RECS:
3520 P_STATUS$="",ON_REC$=""
3530 READ RECORD (TMP_FN,KEY=PAD(NEW_PANEL_NME$,12),DOM=*NEXT)
3540 NEW_PANEL_KEY$=KEY(TMP_FN,END=3620) ! start at beginning of new file
3550 READ (TMP_FN,ERR=9090)IOL=10020
3560 IF PAD(NEW_PANEL_NME$,12)<>NEW_PANEL_KEY$(1,12) THEN GOTO 3620 ! chk next new record
3570 IF NEW_PANEL_KEY$(13,4)="0000" THEN IF UCS(N_OBJ_TYPE$)="Q" THEN ON_QUERY$="Y"; GOTO 3540 ELSE GOTO 3540
3571 IF POS("Rr":N_OBJ_TYPE$)>0 THEN N_OBJ_NME$=N_OBJ_NME$+"(idx="+N_OBJ_IDX$+")",N_CHK_NME$=N_OBJ_NME$ ELSE N_CHK_NME$=N_OBJ_NME$+" "+NEW_PANEL_KEY$(13,4)
3580 IF POS((LCS(N_CHK_NME$)+SEP)=LCS(NEW_DONE_LIST$))<>0 THEN GOTO 3540
3581 ! IF POS("UDRV":N_OBJ_TYPE$)>0   THEN IF POS(N_OBJ_NME$+" "+NEW_PANEL_KEY$(13,4)+SEP=NEW_DONE_LIST$)>0         THEN GOTO 3540
3590 COMP$="N",ELEM_NME$=N_OBJ_NME$
3591 ! IF LCS(ELEM_NME$)<>LCS(NEW_PANEL_KEY$(13,4)) THEN GOTO 3600
3592 IF NEW_PANEL_KEY$(13,4)="M000" THEN ON_REC$="Menuheader " ELSE IF NEW_PANEL_KEY$(13,2)="M " THEN ON_REC$="Menukey " ELSE IF NEW_PANEL_KEY$(13,1)="M" THEN ON_REC$="Menuitem " ELSE IF NEW_PANEL_KEY$(13,1)="U" THEN ON_REC$="Control " ELSE IF NEW_PANEL_KEY$(13,1)="R" OR NEW_PANEL_KEY$(13,1)="D" THEN ON_REC$="Drag " ELSE IF NEW_PANEL_KEY$(13,1)="V" THEN ON_REC$="Depend " ELSE IF NEW_PANEL_KEY$(13,1)="X" THEN ON_REC$="Gridpres " ELSE IF NEW_PANEL_KEY$(13,1)="Y" THEN ON_REC$="CellLogic "
3600 GOSUB INIT_OLD_ELEM; GOSUB PROCESS_ELEMENTS; GOSUB RESET_NEW_PANEL_KEY
3610 GOTO 3540
3620 RETURN 
3700 ! ^100 - set compare values
3710 PROCESS_MATCH_RECS:
3711 COMP$="C",ELEM_NME$=OBJ_NME$
3712 IF POS("Rr":OBJ_TYPE$)>0 THEN IF POS("(idx="=OBJ_NME$)=0 THEN OBJ_NME$=OBJ_NME$+"(idx="+OBJ_IDX$+")"
3713 IF POS("Rr":N_OBJ_TYPE$)>0 THEN IF POS("(idx="=N_OBJ_NME$)=0 THEN N_OBJ_NME$=N_OBJ_NME$+"(idx="+N_OBJ_IDX$+")"
3720 ELEM_NME$=OBJ_NME$
3721 IF OLD_PANEL_KEY$(13,4)="0000" THEN ELEM_NME$="Header"; IF UCS(OBJ_TYPE$)="Q" THEN ON_QUERY$="Y" ! IF ELEM_NME$="" AND OLD_PANEL_KEY$(13,4)="0000" THEN LET ELEM_NME$="Header"
3730 GOSUB PROCESS_ELEMENTS; GOSUB DROP_NEW_REC ! have match, chk elements
3740 RETURN 
3800 ! ^100 - process old record only
3810 PROCESS_OLD_REC:
3811 COMP$="O"
3812 IF POS("Rr":OBJ_TYPE$)>0 THEN IF POS("(idx="=OBJ_NME$)=0 THEN OBJ_NME$=OBJ_NME$+"(idx="+OBJ_IDX$+")"
3820 ELEM_NME$=OBJ_NME$
3821 IF OLD_PANEL_KEY$(13,4)="M000" THEN ON_REC$="Menuheader " ELSE IF OLD_PANEL_KEY$(13,2)="M " THEN ON_REC$="Menukey " ELSE IF OLD_PANEL_KEY$(13,1)="M" THEN ON_REC$="Menuitem " ELSE IF OLD_PANEL_KEY$(13,1)="U" THEN ON_REC$="Control " ELSE IF OLD_PANEL_KEY$(13,1)="R" OR OLD_PANEL_KEY$(13,1)="D" THEN ON_REC$="Drag " ELSE IF OLD_PANEL_KEY$(13,1)="V" THEN ON_REC$="Depend " ELSE IF OLD_PANEL_KEY$(13,1)="X" THEN ON_REC$="Gridpres " ELSE IF OLD_PANEL_KEY$(13,1)="Y" THEN ON_REC$="CellLogic "
3830 GOSUB INIT_NEW_ELEM; GOSUB PROCESS_ELEMENTS; GOSUB RESET_NEW_PANEL_KEY
3840 RETURN 
3850 ! display compare records for panel to screen
3860 PROCESS_DISPLAY_RECS:
3861 IF PANEL_CTR=0 AND SHOW_CHKBX$="0" THEN GOTO 4050 ! don't display if same
3862 MAX_DIFF_CTR=MAX_DIFF_CTR+1
3870 P_LINE$="Comparing Panels for "+UID+" on "+DTE(0:"%Ds %Ms %D, %Y %hz:%mz %p"),D_LINE$=P_LINE$; GOSUB DISPLAY_LINE
3871 D_LINE$="Panel:"+QUO+STP(COMP_LIBS$)+QUO
3880 P_LINE$="Panels: "+COMP_LIBS$,OFS_P=7; GOSUB DISPLAY_LINE; COMP_LIBS$="",OFS_P=22; GOSUB PRT_BLANK
3890 IF PANEL_CTR=0 THEN P_LINE$="*** No differences between Panels found ***",D_LINE$=P_LINE$; GOSUB DISPLAY_LINE; GOTO 4045
3900 IF PRT_BOTH_CTR=0 THEN P_LINE$="*** No differences between common elements ***",D_LINE$=P_LINE$; GOSUB DISPLAY_LINE; GOSUB PRT_BLANK; GOTO 3950 ELSE P_LINE$="*** Differences in elements in "+SUB_NME$+" ***",D_LINE$=P_LINE$; GOSUB DISPLAY_LINE
3910 D_CTR=0,OFS_P=23
3920 D_CTR=D_CTR+1; IF D_CTR>PRT_BOTH_CTR THEN GOSUB PRT_BLANK; OFS_P=22; GOTO 3950
3921 IF POS(" was "+QUO=PRT_BOTH$[D_CTR])=19 THEN GOSUB PRT_BLANK
3930 P_LINE$=PRT_BOTH$[D_CTR],D_LINE$=P_LINE$
3941 GOSUB DISPLAY_LINE; GOTO 3920
3950 IF PRT_OLD_CTR=0 THEN P_LINE$="*** No elements unique to Old Panel "+OLD_PANEL_NME$+" ***",D_LINE$=P_LINE$; GOSUB DISPLAY_LINE; GOSUB PRT_BLANK; GOTO 4000 ELSE P_LINE$=PAD("*** Elements unique to Old Panel "+OLD_PANEL_NME$+" ***",70),D_LINE$=P_LINE$; GOSUB DISPLAY_LINE
3960 D_CTR=0
3970 D_CTR=D_CTR+1; IF D_CTR>PRT_OLD_CTR THEN GOSUB PRT_BLANK; GOTO 4000
3980 P_LINE$=PRT_OLD$[D_CTR],D_LINE$=P_LINE$
3990 GOSUB DISPLAY_LINE; GOTO 3970
4000 IF PRT_NEW_CTR=0 THEN P_LINE$="*** No elements unique to New Panel "+NEW_PANEL_NME$+" ***",D_LINE$=P_LINE$; GOSUB DISPLAY_LINE; GOTO 4045 ELSE P_LINE$="*** Elements unique to New Panel "+NEW_PANEL_NME$+" ***",D_LINE$=P_LINE$; GOSUB DISPLAY_LINE
4010 D_CTR=0
4020 D_CTR=D_CTR+1; IF D_CTR>PRT_NEW_CTR THEN GOTO 4045
4030 P_LINE$=PRT_NEW$[D_CTR],D_LINE$=P_LINE$
4040 GOSUB DISPLAY_LINE; GOTO 4020
4045 GOSUB PRT_BLANK; GOSUB PRT_ASTR; GOSUB PRT_BLANK
4050 CLOSE (TMP_FN,ERR=4060)
4060 RETURN 
5000 ! ^1000 - 5000 set values and check each element on record
5001 PROCESS_ELEMENTS:
5005 IF ON_QUERY$="Y" THEN GOSUB GOT_QUERY_RECORDS; GOTO 5390
5011 IF ON_REC$="Menukey " OR ON_REC$="Menuheader " OR ON_REC$="Menuitem " THEN GOSUB GOT_MENU_BAR_RECORDS; GOTO 5390
5012 IF STP(ELEM_NME$)="" THEN IF STP(OBJ_TXT$)<>"" THEN ELEM_NME$=":"+OBJ_TXT$
5013 ELEM_HDR$=PAD("* "+ELEM_NME$,60); IF ON_REC$="Drag " THEN ELEM_HDR$=PAD("* Drag and Drop Control",60)
5014 IF ON_REC$="Depend " THEN ELEM_HDR$=PAD("* Dependency Definition",60)
5015 IF ON_REC$="Gridpres " THEN ELEM_HDR$=PAD("* Grid Presets Definition",60); GOSUB DO_GRID_PRESETS_RECORDS; GOTO 5390
5016 IF ON_REC$="CellLogic " THEN ELEM_HDR$=PAD("* Cell Logic Definition",60); GOSUB DO_CELL_LOGIC_RECORDS; GOTO 5390
5020 ! 
5021 IF ON_REC$<>"" THEN IF ON_REC$(1,1)="C" OR ON_REC$(1,1)="M" OR ON_REC$(1,1)="D" OR ON_REC$(1,1)="R" OR ON_REC$(1,1)="V" THEN GOTO 5024 ! bypass position  for control/menubar records
5022 ! obj_c,obj_l,obj_w,obj_h
5023 ITEM_NME$=" Position",ITEM_OLD$="("+STR(OBJ_C)+","+STR(OBJ_L)+","+STR(OBJ_W)+","+STR(OBJ_H)+")",ITEM_NEW$="("+STR(N_OBJ_C)+","+STR(N_OBJ_L)+","+STR(N_OBJ_W)+","+STR(N_OBJ_H)+")"; GOSUB COMPARE_RTN
5024 ! obj_type
5025 ITEM_NME$=" Type"; ITEM_OLD$=OBJ_TYPE$,ITEM_NEW$=N_OBJ_TYPE$,N_TYPE$=N_OBJ_TYPE$; IF ON_QUERY$="" THEN GOSUB TYPE_TBL_RTN; GOSUB COMPARE_RTN
5026 IF OBJ_TYPE$<>"L" AND N_OBJ_TYPE$<>"L" THEN GOTO 5030
5027 IF OBJ_LISTBOX_TYPE$<>"0" AND OBJ_LISTBOX_TYPE$<>"" THEN GOTO 5029
5028 IF N_OBJ_LISTBOX_TYPE$<>"0" AND N_OBJ_LISTBOX_TYPE$<>"" THEN GOTO 5029 ELSE GOTO 5030
5029 ITEM_NME$=" Listbox Type",ITEM_OLD$=OBJ_LISTBOX_TYPE$,ITEM_NEW$=N_OBJ_LISTBOX_TYPE$; GOSUB LISTBOX_TYPE_TBL_RTN; GOSUB COMPARE_RTN
5030 IF ON_REC$="Drag " THEN ITEM_NME$=" Source Control",ITEM_OLD$=OBJ_NME$,ITEM_NEW$=N_OBJ_NME$; GOSUB COMPARE_RTN; ITEM_NME$=" Destination ",ITEM_OLD$=OBJ_NULL$,ITEM_NEW$=N_OBJ_NULL$; GOSUB COMPARE_RTN ! on drag & drop, do source then destination
5031 ! obj_txt
5032 ITEM_NME$=" Text Value"
5033 IF ON_REC$="Header " THEN ITEM_NME$=" Title"; GOTO 5045 ELSE IF ON_QUERY$="Y" THEN GOTO 5047
5034 IF POS("Mm":OBJ_TYPE$) OR POS("Mm":N_OBJ_TYPE$) THEN ITEM_NME$=" Input Format"; GOTO 5045 ! do EXP
5035 IF POS("Ss":OBJ_TYPE$) OR POS("Ss":N_OBJ_TYPE$) THEN ITEM_NME$=" Folder Tab/Text"; GOTO 5047
5036 IF POS("LlDdVvXG":OBJ_TYPE$) OR POS("LlDdVvXG":N_OBJ_TYPE$) THEN ITEM_NME$=" List"; GOTO 5045 ! do EXP
5037 IF POS("Ii":OBJ_TYPE$) OR POS("Ii":N_OBJ_TYPE$) THEN ITEM_NME$=" Picture Path"; GOTO 5045 ! do EXP
5038 IF OBJ_TYPE$="o" OR N_OBJ_TYPE$="o" THEN ITEM_NME$=" OCX Name"; GOTO 5047 ! ocx
5040 IF POS("RrCc":OBJ_TYPE$)=0 AND POS("RrCc":N_OBJ_TYPE$)=0 THEN GOTO 5044
5041 ITEM_NME$=" Button Align"; IF OBJ_TXT$<>"" THEN IF OBJ_TXT$(LEN(OBJ_TXT$),1)=":" THEN ITEM_OLD$="Right Side",OBJ_TXT$=OBJ_TXT$(1,LEN(OBJ_TXT$)-1) ELSE ITEM_OLD$="Left Side" ELSE ITEM_OLD$="Left Side"
5042 IF N_OBJ_TXT$<>"" THEN IF N_OBJ_TXT$(LEN(N_OBJ_TXT$),1)=":" THEN ITEM_NEW$="Right Side",N_OBJ_TXT$=N_OBJ_TXT$(1,LEN(N_OBJ_TXT$)-1) ELSE ITEM_NEW$="Left Side" ELSE ITEM_NEW$="Left Side"
5043 GOSUB COMPARE_RTN ! Radio button do next as well
5044 IF POS("BbRrCc3":OBJ_TYPE$) OR POS("BbRrCc3":N_OBJ_TYPE$) THEN ITEM_OLD$=OBJ_TXT$,ITEM_NEW$=N_OBJ_TXT$; GOSUB CONV_BITMAP_RTN; GOTO 5050
5045 IF N_OBJ_TXT$="" THEN IF OBJ_TXT$<>"" THEN IF OBJ_TXT$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"; GOTO 5047
5046 IF N_OBJ_TXT$<>"" THEN IF N_OBJ_TXT$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
5047 ITEM_OLD$=OBJ_TXT$,ITEM_NEW$=N_OBJ_TXT$; GOSUB COMPARE_RTN
5050 ! obj_val
5051 ITEM_NME$=" Initial Value"; IF POS("Rr":OBJ_TYPE$)>0 OR POS("Rr":N_OBJ_TYPE$)>0 THEN ITEM_NME$=" Logical Value" ELSE IF OBJ_TYPE$="o" OR N_OBJ_TYPE$="o" THEN ITEM_NME$=" Property Name"
5052 IF N_OBJ_VAL$="" THEN IF OBJ_VAL$<>"" THEN IF OBJ_VAL$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"; GOTO 5060
5053 IF N_OBJ_VAL$<>"" THEN IF N_OBJ_VAL$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
5054 ITEM_OLD$=OBJ_VAL$,ITEM_NEW$=N_OBJ_VAL$; GOSUB COMPARE_RTN
5060 ! obj_tab
5061 IF OBJ_TAB=0 THEN ITEM_OLD$="" ELSE ITEM_OLD$=STR(OBJ_TAB)
5062 IF N_OBJ_TAB=0 THEN ITEM_NEW$="" ELSE ITEM_NEW$=STR(N_OBJ_TAB)
5063 IF POS(SHAPE_TBL$=OBJ_TYPE$)>0 OR POS(SHAPE_TBL$:N_OBJ_TYPE$)>0 THEN IF ITEM_OLD$="" AND ITEM_NEW$="" THEN GOTO 5071 ! bypass tabstop for shapes
5070 ITEM_NME$=" Tab Stop"; GOSUB COMPARE_RTN
5071 IF ON_REC$="Header " THEN GOTO 5090 ELSE ITEM_NME$=" Default Value" ! obj_def
5072 IF OBJ_TYPE$="o" OR N_OBJ_TYPE$="o" THEN ITEM_NME$=" Events",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB COMPARE_RTN; GOTO 5090
5073 IF ON_QUERY$="Y" THEN ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOTO 5087
5074 IF POS("Gg":OBJ_TYPE$)>0 OR POS("Gg":N_OBJ_TYPE$)>0 THEN ITEM_NME$=" Grid Attr",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB GRID_OBJ_DEF_RTN; GOSUB COMPARE_RTN; GOTO 5090
5075 IF POS(SHAPE_TBL$:OBJ_TYPE$)>0 OR POS(SHAPE_TBL$:N_OBJ_TYPE$)>0 THEN ITEM_NME$=" Pen Style,W,Clr",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOTO 5087
5076 IF POS("DLVX":OBJ_TYPE$)=0 AND POS("DLVX":N_OBJ_TYPE$)=0 THEN GOTO 5080 ELSE AUTO_TRG$=""
5077 IF LEN(OBJ_DEF$)>0 THEN IF OBJ_DEF$(1,1)="q" THEN GOSUB AUTO_TRIGGER_RTN; GOTO 5090
5078 IF LEN(N_OBJ_DEF$)>0 THEN IF N_OBJ_DEF$(1,1)="q" THEN IF AUTO_TRG$="" THEN GOSUB AUTO_TRIGGER_RTN; GOTO 5090
5080 IF POS("Ss":OBJ_TYPE$)>0 OR POS("Ss":N_OBJ_TYPE$)>0 AND NUL(OBJ_OUT$) THEN ITEM_NME$=" Folder Colour",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB FOLDER_CLR_RTN; GOTO 5087
5081 IF POS("+"=OBJ_TYPE$) THEN ITEM_NME$=" Ctl Nm/Type/Act/Tab",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB DEPEND_OBJ_DEF_RTN; GOTO 5087
5082 IF POS("Ee":OBJ_TYPE$) OR POS("Ee":N_OBJ_TYPE$) THEN ITEM_NME$=" VBX Events"; GOTO 5089
5083 IF POS("Bb":OBJ_TYPE$) OR POS("Bb":N_OBJ_TYPE$) THEN ITEM_NME$=" Default Push"; GOTO 5085
5084 IF POS("Rr":OBJ_TYPE$)=0 AND POS("Rr":N_OBJ_TYPE$)=0 THEN GOTO 5088 ELSE ITEM_NME$=" Initially ON"
5085 IF OBJ_DEF$="1" THEN ITEM_OLD$="YES" ELSE ITEM_OLD$="NO"
5086 IF N_OBJ_DEF$="1" THEN ITEM_NEW$="YES" ELSE ITEM_NEW$="NO"
5087 GOSUB COMPARE_RTN; GOTO 5090
5088 IF OBJ_TYPE$="x" OR N_OBJ_TYPE$="x" THEN ITEM_NME$=" Style",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB DEFAULT_TBL_RTN; GOSUB COMPARE_RTN; GOTO 5090
5089 ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB COMPARE_RTN
5090 ! obj_dsp
5091 ITEM_NME$=" Initial Logic"; IF ON_QUERY$="Y" THEN GOTO 5092 ELSE IF ON_REC$="Header " THEN ITEM_NME$=" Pre-Display"; GOTO 5093
5092 IF OBJ_TYPE$="B" OR N_OBJ_TYPE$="B" THEN ITEM_NME$=" Pre-Display" ELSE ITEM_NME$=" Post Create"
5093 ITEM_OLD$=OBJ_DSP$,ITEM_NEW$=N_OBJ_DSP$; GOSUB LOGIC_TBL_RTN; GOSUB COMPARE_RTN; GOTO 5100
5094 ITEM_OLD$=OBJ_DSP$,ITEM_NEW$=N_OBJ_DSP$; GOSUB COMPARE_RTN
5095 ! obj_fcs
5100 IF ON_REC$="Header " THEN ITEM_NME$=" Post Display" ELSE ITEM_NME$=" Focus Logic"
5101 IF ON_QUERY$="Y" THEN ITEM_OLD$=OBJ_FCS$,ITEM_NEW$=N_OBJ_FCS$; GOSUB COMPARE_RTN; GOTO 5103
5102 ITEM_OLD$=OBJ_FCS$,ITEM_NEW$=N_OBJ_FCS$; GOSUB LOGIC_TBL_RTN; GOSUB COMPARE_RTN
5103 ! obj_sel
5104 ITEM_NME$=" Select Logic"; IF ON_REC$="Control " THEN ITEM_NME$=" CTL Process" ELSE IF ON_REC$="Header " THEN ITEM_NME$=" On Exit Logic"
5105 IF ON_QUERY$="Y" THEN ITEM_OLD$=OBJ_SEL$,ITEM_NEW$=N_OBJ_SEL$; GOSUB COMPARE_RTN; GOTO 5112
5106 IF ON_REC$="Drag " THEN ITEM_NME$=" Process Logic" ! Drag and Drop
5107 IF ON_REC$="Depend " THEN ITEM_NME$=" Condition"
5108 ITEM_OLD$=OBJ_SEL$,ITEM_NEW$=N_OBJ_SEL$; GOSUB LOGIC_TBL_RTN; GOSUB COMPARE_RTN
5110 ! obj_msg
5111 ITEM_NME$=" Message"
5112 IF N_OBJ_MSG$="" THEN IF OBJ_MSG$<>"" THEN IF OBJ_MSG$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
5113 IF N_OBJ_MSG$<>"" THEN IF N_OBJ_MSG$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
5114 ITEM_OLD$=OBJ_MSG$,ITEM_NEW$=N_OBJ_MSG$; GOSUB COMPARE_RTN
5115 ! obj_hlp
5116 ITEM_NME$=" Help",ITEM_OLD$=OBJ_HLP$,ITEM_NEW$=N_OBJ_HLP$
5117 GOSUB HELP_ADJUST_RTN
5119 GOSUB COMPARE_RTN
5120 ! obj_attr
5121 IF OBJ_ATTR$="$" THEN OBJ_STS$=OBJ_STS$+OBJ_ATTR$ ! display PASSWORD
5122 IF N_OBJ_ATTR$="$" THEN N_OBJ_STS$=N_OBJ_STS$+N_OBJ_ATTR$; GOTO 5150
5123 IF ON_REC$="HDR" THEN GOTO 5130 ELSE IF ON_QUERY$="Y" THEN ITEM_NME$=" Attributes",ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$; GOSUB COMPARE_RTN; GOTO 5150 ! parse out font/colour if needed
5124 IF POS("Ee":OBJ_TYPE$) OR POS("Ee":N_OBJ_TYPE$) THEN ITEM_NME$=" Properties",ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$; GOSUB COMPARE_RTN; GOTO 5150
5125 IF POS("Tt":OBJ_TYPE$) OR POS("Tt":N_OBJ_TYPE$) THEN ITEM_NME$=" Mnemonics",ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$; GOSUB COMPARE_RTN; GOTO 5150
5126 IF POS("Ii":OBJ_TYPE$)>0 OR POS("Ii":N_OBJ_TYPE$)>0 THEN ITEM_NME$=" Image Format",ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$; GOSUB IMAGE_ATTR_TBL_RTN; GOSUB COMPARE_RTN; GOTO 5150
5130 ! chk for 'Font' 'Mode'
5131 ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$; GOSUB ATTR_PARSE_RTN
5132 IF OLD_A$="Y" AND NEW_A$="Y" THEN GOTO 5150 ! set obj_font, obj_color
5133 IF OLD_A$="Y" AND NEW_A$="" THEN OBJ_ATTR$="",ITEM_OLD$=""
5134 IF NEW_A$="Y" AND OLD_A$="" THEN N_OBJ_ATTR$="",ITEM_NEW$=""
5135 ! chk for mnemonic
5136 IF POS("'"=OBJ_ATTR$) THEN ITEM_NME$=" Mnemonics",ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$; GOSUB COMPARE_RTN; GOTO 5150
5137 IF POS("'"=N_OBJ_ATTR$) THEN ITEM_NME$=" Mnemonics",ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$; GOSUB COMPARE_RTN; GOTO 5150
5138 ITEM_NME$=" Attribute"; GOSUB COMPARE_RTN
5148 ! obj_idx
5149 ITEM_NME$=" Button Index"; IF ON_REC$="Header " THEN ITEM_NME$=" Precision"; GOTO 5158 ELSE IF ON_QUERY$="Y" THEN ITEM_NME$=" Index"; GOTO 5158 ELSE IF POS("Ss":OBJ_TYPE$)>0 OR POS("Ss":N_OBJ_TYPE$)>0 THEN ITEM_NME$=" Tab Size"; GOTO 5158 ELSE IF POS("Ee":OBJ_TYPE$)>0 OR POS("Ee":N_OBJ_TYPE$)>0 THEN ITEM_NME$=" VBX Tools"; GOTO 5158 ELSE IF POS(SHAPE_TBL$:OBJ_TYPE$)>0 OR POS(SHAPE_TBL$:N_OBJ_TYPE$)>0 THEN ITEM_NME$=" Fill,Clr1,Clr2"; GOSUB FILL_PATTERN_CLR_RTN; GOTO 5159
5150 IF POS("LDVX":OBJ_TYPE$)>0 OR POS("LDVX":N_OBJ_TYPE$)>0 THEN IF POS("e":OBJ_LISTBOX_TYPE$)>0 OR POS("e":N_OBJ_LISTBOX_TYPE$)>0 THEN ITEM_NME$=" State Indicators"; GOTO 5158
5151 IF ON_REC$<>"Depend " THEN GOTO 5154 ELSE ITEM_NME$=" Invert"; IF OBJ_IDX$="Y" THEN ITEM_OLD$="YES" ELSE IF OBJ_IDX$="N" OR STP(OBJ_IDX$,2)="" THEN ITEM_OLD$="NO" ELSE ITEM_OLD$="INVALID"
5152 IF N_OBJ_IDX$="Y" THEN ITEM_NEW$="YES" ELSE IF N_OBJ_IDX$="N" OR STP(N_OBJ_IDX$,2)="" THEN ITEM_NEW$="NO" ELSE ITEM_NEW$="INVALID"
5153 GOSUB COMPARE_RTN; GOTO 5159
5154 IF OBJ_TYPE$="G" OR N_OBJ_TYPE$="G" THEN GOTO 5160 ! for grid, do this after printing formatted info (obj_null)
5155 IF POS("Mm":OBJ_TYPE$)=0 AND POS("Mm":N_OBJ_TYPE$)=0 THEN GOTO 5158 ELSE ITEM_NME$=" Input Length"
5156 IF N_OBJ_IDX$="" THEN IF OBJ_IDX$<>"" THEN IF OBJ_IDX$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"; GOTO 5158
5157 IF N_OBJ_IDX$<>"" THEN IF N_OBJ_IDX$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"; GOTO 5158
5158 ITEM_OLD$=OBJ_IDX$,ITEM_NEW$=N_OBJ_IDX$; GOSUB COMPARE_RTN
5159 ! obj_hotkey
5160 IF ON_REC$="Header " THEN ITEM_NME$=" Date Stamp",ITEM_OLD$=OBJ_HOTKEY$,ITEM_NEW$=N_OBJ_HOTKEY$; GOTO 5163
5161 ITEM_NME$=" [ALT] Key"; IF OBJ_HOTKEY$<>"" THEN ITEM_OLD$="ALT-"+OBJ_HOTKEY$ ELSE ITEM_OLD$=""
5162 IF N_OBJ_HOTKEY$<>"" THEN ITEM_NEW$="ALT-"+N_OBJ_HOTKEY$ ELSE ITEM_NEW$=""
5163 GOSUB COMPARE_RTN
5164 ! obj_qry
5170 ITEM_NME$=" Query"
5171 IF OBJ_QRY$<>"" THEN IF OBJ_QRY$(1,1)="^" THEN ITEM_NME$=" Spinner"
5172 IF N_OBJ_QRY$<>"" THEN IF N_OBJ_QRY$(1,1)="^" THEN ITEM_NME$=" Spinner"
5173 ITEM_OLD$=OBJ_QRY$,ITEM_NEW$=N_OBJ_QRY$; GOSUB COMPARE_RTN
5174 ! obj_sec
5180 ITEM_NME$=" Security",ITEM_OLD$=OBJ_SEC$,ITEM_NEW$=N_OBJ_SEC$; GOSUB COMPARE_RTN
5181 ! obj_sts
5182 IF ON_QUERY$="Y" THEN ITEM_NME$=" Status"; ITEM_OLD$=OBJ_STS$,ITEM_NEW$=N_OBJ_STS$; GOSUB COMPARE_RTN; GOTO 5200
5190 ITEM_NME$=" Attributes"; ITEM_OLD$=OBJ_STS$,ITEM_NEW$=N_OBJ_STS$; GOSUB STATUS_TBL_RTN; GOSUB COMPARE_RTN
5191 ! obj_grp
5200 ITEM_NME$=" Groups"; ITEM_OLD$=OBJ_GRP$,ITEM_NEW$=N_OBJ_GRP$; GOSUB COMPARE_RTN
5201 ! obj_null
5210 ITEM_OLD$=OBJ_NULL$,ITEM_NEW$=N_OBJ_NULL$
5211 IF ON_REC$<>"Header " THEN IF POS("LG":OBJ_TYPE$) OR POS("LG":N_OBJ_TYPE$) THEN ITEM_NME$=" Formatter Info"; GOSUB COMPARE_RTN ELSE IF POS("(O)[":OBJ_TYPE$)>0 OR POS("(O)[":N_OBJ_TYPE$)>0 THEN ITEM_NME$=" Radius,Ratio"; GOSUB COMPARE_RTN ELSE IF POS("/^":OBJ_TYPE$)>0 OR POS("/^":N_OBJ_TYPE$)>0 THEN ITEM_NME$=" X/Y Values",ITEM_OLD$=STR(@X(OBJ_C))+","+STR(@Y(OBJ_L))+","+OBJ_NULL$,ITEM_NEW$=STR(@X(N_OBJ_C))+","+STR(@Y(N_OBJ_L))+","+N_OBJ_NULL$; GOSUB COMPARE_RTN ELSE IF OBJ_TYPE$="H" OR N_OBJ_TYPE$="H" THEN ITEM_NME$=" Chart Type"; GOSUB COMPARE_RTN ELSE IF ON_REC$="Depend " THEN ITEM_NME$=" Group Name/Action"; GOSUB DEPENDENCY_RTN; GOSUB COMPARE_RTN ELSE IF ON_REC$<>"Drag " THEN IF POS("BCR":OBJ_TYPE$)=0 AND POS("BCR":N_OBJ_TYPE$)=0 THEN ITEM_NME$=" Null Value"; GOSUB COMPARE_RTN ! obj_null picked up by obj_sts rtn, if on drag then do obj null after obj_nme
5215 ! if grid, do obj_idx after formatted info
5216 IF OBJ_TYPE$="G" OR N_OBJ_TYPE$="G" THEN ITEM_NME$=" Static Columns",ITEM_OLD$=OBJ_IDX$,ITEM_NEW$=N_OBJ_IDX$; GOSUB COMPARE_RTN
5220 ! obj_tag
5221 ITEM_NME$=" Tag"
5222 IF N_OBJ_TAG$="" THEN IF OBJ_TAG$<>"" THEN IF OBJ_TAG$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"; GOTO 5224
5223 IF N_OBJ_TAG$<>"" THEN IF N_OBJ_TAG$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
5224 IF OBJ_TAG$<>N_OBJ_TAG$ THEN ITEM_OLD$=OBJ_TAG$,ITEM_NEW$=N_OBJ_TAG$; GOSUB COMPARE_RTN
5225 ! obj_tbl
5226 IF OBJ_TYPE$<>"S" THEN GOTO 5230 ELSE ITEM_NME$=" Incl Scroll Btn" ! folder
5227 IF OBJ_TBL$="1" THEN ITEM_OLD$="ON" ELSE ITEM_OLD$="OFF"
5228 IF N_OBJ_TBL$="1" THEN ITEM_NEW$="ON" ELSE ITEM_NEW$="OFF"
5229 GOSUB COMPARE_RTN; GOTO 5233
5230 ITEM_NME$=" Table"
5231 IF POS("Cc3":OBJ_TYPE$) OR POS("Cc3":N_OBJ_TYPE$) THEN ITEM_NME$=" OFF/ON/3RD"
5232 ITEM_OLD$=OBJ_TBL$,ITEM_NEW$=N_OBJ_TBL$; GOSUB COMPARE_RTN
5233 ! obj_inp
5240 IF ON_REC$="Header " THEN ITEM_NME$=" Default Program",ITEM_OLD$=OBJ_INP$,ITEM_NEW$=N_OBJ_INP$; GOSUB COMPARE_RTN; GOTO 5249 ELSE IF POS(SHAPE_TBL$:OBJ_TYPE$)>0 OR POS(SHAPE_TBL$:N_OBJ_TYPE$)>0 THEN ITEM_NME$=" Angle Start,End",ITEM_OLD$=OBJ_INP$,ITEM_NEW$=N_OBJ_INP$; GOSUB COMPARE_RTN; GOTO 5249 ELSE IF OBJ_TYPE$="S" OR N_OBJ_TYPE$="S" THEN GOTO 5241 ELSE ITEM_NME$=" Input Validator"; ITEM_OLD$=OBJ_INP$,ITEM_NEW$=N_OBJ_INP$; GOSUB COMPARE_RTN; GOTO 5249
5241 OLD_1$="",OLD_2$="",NEW_1$="",NEW_2$=""; GOSUB BUILD_OLD_OBJ_INP ! IF OBJ_INP$<>"" THEN LET P=POS(","=OBJ_INP$); IF P>0 THEN LET OLD_1$=OBJ_INP$(1,P-1),OLD_2$=OBJ_INP$(P+1)
5242 IF N_OBJ_INP$<>"" THEN GOSUB BUILD_NEW_OBJ_INP ! THEN LET P=POS(","=N_OBJ_INP$); IF P>0 THEN LET NEW_1$=N_OBJ_INP$(1,P-1),NEW_2$=N_OBJ_INP$(P+1)
5243 GOSUB COMAPRE_FILL_PATTERN ! LET ITEM_NME$=" Fill Pattern",ITEM_OLD$=OLD_1$,ITEM_NEW$=NEW_1$; IF ITEM_OLD$<>"" THEN LET CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_fill_pattern"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" THEN LET ITEM_OLD$=CONV_F$
5244 ! IF ITEM_NEW$<>"" THEN LET CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_fill_pattern"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" THEN LET ITEM_NEW$=CONV_F$
5245 ! GOSUB COMPARE_RTN
5246 ITEM_NME$=" Fill Color2",ITEM_OLD$=OLD_2$,ITEM_NEW$=NEW_2$; CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_one_color"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" THEN ITEM_OLD$=CONV_F$
5247 CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_one_color"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" THEN ITEM_NEW$=CONV_F$
5248 GOSUB COMPARE_RTN
5249 ! obj_out
5250 IF OBJ_TYPE$<>"S" THEN ITEM_NME$=" Formatter",ITEM_OLD$=OBJ_OUT$,ITEM_NEW$=N_OBJ_OUT$; GOSUB COMPARE_RTN; GOTO 5256
5251 ITEM_NME$=" Fill Color1",ITEM_OLD$=OBJ_OUT$,ITEM_NEW$=N_OBJ_OUT$
5252 IF ITEM_OLD$<>"" THEN CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_one_color"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" THEN ITEM_OLD$=CONV_F$
5253 IF ITEM_NEW$<>"" THEN CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_one_color"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" THEN ITEM_NEW$=CONV_F$
5254 GOSUB COMPARE_RTN
5256 ! obj_hotkey
5257 IF ON_REC$<>"Header " THEN ITEM_NME$=" Rules"; GOTO 5260 ELSE ITEM_NME$=" User ID"
5258 IF OBJ_HOTKEY$=N_OBJ_HOTKEY$ THEN GOTO 5270 ! don't do user id unless date chged
5259 ! obj_valid
5260 ITEM_OLD$=OBJ_VALID$,ITEM_NEW$=N_OBJ_VALID$; GOSUB COMPARE_RTN
5261 ! obj_class
5270 ITEM_NME$=" Data Class",ITEM_OLD$=OBJ_CLASS$,ITEM_NEW$=N_OBJ_CLASS$; GOSUB COMPARE_RTN
5271 ! obj_tip
5280 ITEM_NME$=" Tip"
5281 IF N_OBJ_TIP$="" THEN IF OBJ_TIP$<>"" THEN IF OBJ_TIP$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"; GOTO 5283
5282 IF N_OBJ_TIP$<>"" THEN IF N_OBJ_TIP$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
5283 IF OBJ_TIP$<>N_OBJ_TIP$ THEN ITEM_OLD$=OBJ_TIP$,ITEM_NEW$=N_OBJ_TIP$; GOSUB COMPARE_RTN
5284 ! obj_orig
5285 ITEM_NME$=" Customization",ITEM_OLD$=OBJ_ORIG$,ITEM_NEW$=N_OBJ_ORIG$; GOSUB COMPARE_RTN
5286 ! obj_font
5287 ITEM_NME$=" Font",ITEM_OLD$=OBJ_FONT$,ITEM_NEW$=N_OBJ_FONT$; IF ON_QUERY$="Y" THEN GOSUB COMPARE_RTN ELSE GOSUB FONT_TBL_RTN; GOSUB COMPARE_RTN
5288 ! obj_colour
5289 ITEM_NME$=" Colour",ITEM_OLD$=OBJ_COLOUR$,ITEM_NEW$=N_OBJ_COLOUR$; IF ON_QUERY$="Y" THEN GOSUB COMPARE_RTN ELSE GOSUB COLOUR_TBL_RTN; GOSUB COMPARE_RTN
5290 ! obj_persistence
5291 IF POS("LVDXGM":OBJ_TYPE$)>0 OR POS("LVDXGM":N_OBJ_TYPE$)>0 THEN ITEM_NME$=" Persistence"; IF NUL(OBJ_PERSISTENCE$) THEN OBJ_PERSISTENCE$="0" END_IF ; ITEM_OLD$=OBJ_PERSISTENCE$; IF NUL(N_OBJ_PERSISTENCE$) THEN N_OBJ_PERSISTENCE$="0" END_IF ; ITEM_NEW$=N_OBJ_PERSISTENCE$; GOSUB PERSISTENCE_TBL_RTN; GOSUB COMPARE_RTN
5300 ! OBJ_SEP - if listbox then set values
5301 IF POS("LG":OBJ_TYPE$)>0 AND OBJ_SEP$="" AND OBJ_NULL$<>"" THEN OBJ_SEP$="Standard"
5302 IF POS("LG":N_OBJ_TYPE$)>0 AND N_OBJ_SEP$="" AND N_OBJ_NULL$<>"" THEN N_OBJ_SEP$="Standard"
5303 IF POS("LVDXGH":OBJ_TYPE$)>0 THEN ITEM_NME$=" Column Sep" ELSE ITEM_NME$=" Separator"
5304 IF OBJ_SEP$="" THEN IF POS("LVDXGH":N_OBJ_TYPE$)>0 THEN ITEM_NME$=" Column Sep" ELSE ITEM_NME$=" Separator"
5305 ITEM_OLD$=OBJ_SEP$,ITEM_NEW$=N_OBJ_SEP$; GOSUB COMPARE_RTN
5306 ! 
5310 ! listboxes only next items ! obj_scratch, obj_demand, obj_demand_logic, obj_background_logic
5311 IF POS("LVDX":OBJ_TYPE$)=0 AND POS("LVDX":N_OBJ_TYPE$)=0 THEN GOTO 5320
5312 ! obj_scratch
5313 ITEM_NME$=" Preserved Fmts",ITEM_OLD$=OBJ_SCRATCH$,ITEM_NEW$=N_OBJ_SCRATCH$; GOSUB SCRATCH_PARSE_RTN; GOSUB COMPARE_RTN
5314 ! obj_demand
5315 ITEM_NME$=" Load On Demand"; IF OBJ_DEMAND$="1" THEN ITEM_OLD$="Yes" ELSE ITEM_OLD$="No"
5316 IF N_OBJ_DEMAND$="1" THEN ITEM_NEW$="Yes" ELSE ITEM_NEW$="No"
5317 GOSUB COMPARE_RTN
5318 ! obj_demand_logic
5319 ITEM_NME$=" On Demand Logic",ITEM_OLD$=OBJ_DEMAND_LOGIC$,ITEM_NEW$=N_OBJ_DEMAND_LOGIC$; GOSUB LOGIC_TBL_RTN; GOSUB COMPARE_RTN
5320 ! obj_background_logic ! listboxes and grids
5321 IF POS("LVDXG":OBJ_TYPE$)=0 AND POS("LVDXG":N_OBJ_TYPE$)=0 THEN GOTO 5330
5322 ITEM_NME$=" Background Logic",ITEM_OLD$=OBJ_BACKGROUND_LOGIC$,ITEM_NEW$=N_OBJ_BACKGROUND_LOGIC$; GOSUB LOGIC_TBL_RTN; GOSUB COMPARE_RTN
5330 ! obj_popup
5331 ITEM_NME$=" Popup Menu"
5332 IF N_OBJ_POPUP$<>"" THEN IF N_OBJ_POPUP$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
5333 IF N_OBJ_POPUP$<>"" THEN IF N_OBJ_POPUP$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
5334 ITEM_OLD$=OBJ_POPUP$,ITEM_NEW$=N_OBJ_POPUP$; GOSUB COMPARE_RTN
5335 ! obj_sizing
5336 ITEM_OLD$=OBJ_SIZING$,ITEM_NEW$=N_OBJ_SIZING$; GOSUB SIZING_TBL_RTN; GOSUB COMPARE_RTN
5337 ! obj_logic1
5338 ITEM_NME$=" Pre-Load Logic"; IF ON_REC$="Depend " THEN ITEM_NME$=" Depend Logic"
5339 ITEM_OLD$=OBJ_LOGIC1$,ITEM_NEW$=N_OBJ_LOGIC1$; GOSUB LOGIC_TBL_RTN; GOSUB COMPARE_RTN
5340 ! obj_logic2
5341 ITEM_NME$=" Post-Load Logic",ITEM_OLD$=OBJ_LOGIC2$,ITEM_NEW$=N_OBJ_LOGIC2$; GOSUB LOGIC_TBL_RTN; GOSUB COMPARE_RTN
5342 ! obj_popup_logic
5343 ITEM_NME$=" Prior Popup Logic",ITEM_OLD$=OBJ_POPUP_LOGIC$,ITEM_NEW$=N_OBJ_POPUP_LOGIC$; GOSUB LOGIC_TBL_RTN; GOSUB COMPARE_RTN
5344 ! OBJ_qry flds - only multiline, grids
5345 IF POS("MmGg":OBJ_TYPE$)=0 AND POS("MmGg":N_OBJ_TYPE$)=0 THEN GOTO 5390
5350 ! obj_qry_bitmap
5351 ITEM_NME$=" Qry Bitmap Name",ITEM_OLD$=OBJ_QRY_BITMAP$,ITEM_NEW$=N_OBJ_QRY_BITMAP$; GOSUB COMPARE_RTN
5352 ! obj_qry_width
5353 ITEM_NME$=" Query Btn Width",ITEM_OLD$=STR(OBJ_QRY_WIDTH),ITEM_NEW$=STR(N_OBJ_QRY_WIDTH); GOSUB COMPARE_RTN
5354 ! obj_qry_tip
5355 ITEM_NME$=" Query Btn Tip"; IF N_OBJ_QRY_TIP$="" THEN IF OBJ_QRY_TIP$<>"" THEN IF OBJ_QRY_TIP$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"; GOTO 5357
5356 IF N_OBJ_QRY_TIP$<>"" THEN IF N_OBJ_QRY_TIP$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
5357 IF OBJ_QRY_TIP$<>N_OBJ_QRY_TIP$ THEN ITEM_OLD$=OBJ_QRY_TIP$,ITEM_NEW$=N_OBJ_QRY_TIP$; GOSUB COMPARE_RTN
5360 ! obj_qry_attr
5361 ITEM_NME$=" Query Btn Attr",ITEM_OLD$=OBJ_QRY_ATTR$,ITEM_NEW$=N_OBJ_QRY_ATTR$; GOSUB QRY_ATTR_RTN; GOSUB COMPARE_RTN
5370 ! 
5390 ! at end of element
5391 ON_REC$=""
5392 RETURN 
5400 ! ^100 - Reset panel keys
5410 DROP_NEW_REC:
5420 REMOVE (TMP_FN,KEY=NEW_PANEL_KEY$,DOM=5430); GOTO 5440
5430 MSGBOX "Error processing element for '"+NEW_PANEL_NME$+"'","Error"; EXIT 
5440 RETURN 
5500 ! ^100 - reset key for old search
5510 RESET_OLD_PANEL_KEY:
5520 READ RECORD (LIB_FN,KEY=OLD_PANEL_KEY$,ERR=*NEXT,END=5530); GOTO 5530 ! reset key
5521 MSGBOX "Error reading old file"+SEP+SEP+MSG(ERR)
5530 RETURN 
5600 ! ^100 - reset key for new search
5610 RESET_NEW_PANEL_KEY:
5620 READ (TMP_FN,KEY=NEW_PANEL_KEY$,DOM=*NEXT) ! reset key
5630 RETURN 
5800 ! ^100 - initialize temporary file for print
5810 INIT_TMP_PRINT:
5820 MAX_PANEL_PRT=0,MAX_PANEL_CTR=0,MAX_DIFF_CTR=0,TOT_PRINT_LINES=0
5830 CALL "*fl.nme",OT_NAME$; TMP_PRT_FILE$=OT_NAME$
5840 TMP_PRT_FN=HFN; SERIAL TMP_PRT_FILE$,,,ERR=9100
5850 OPEN PURGE (TMP_PRT_FN,ERR=9100)TMP_PRT_FILE$
5860 RETURN 
6000 ! ^1000  - 6000 -Search string for match value
6010 COMPARE_RTN:
6020 ITEM_NME$=PAD(ITEM_NME$,16),ITEM_OLD$=STP(ITEM_OLD$,2),ITEM_NEW$=STP(ITEM_NEW$,2)
6030 IF COMP$<>"C" THEN GOTO 6070 ELSE IF ITEM_OLD$=ITEM_NEW$ THEN GOTO 6160
6040 IF ELEM_HDR$="" THEN GOTO 6050 ELSE PRT_BOTH_CTR=PRT_BOTH_CTR+1,PRT_BOTH$[PRT_BOTH_CTR]=ELEM_HDR$,ELEM_HDR$=""
6050 C_LINE$="  "+ITEM_NME$+" was "+QUO+ITEM_OLD$,PRT_BOTH_CTR=PRT_BOTH_CTR+1,PRT_BOTH$[PRT_BOTH_CTR]=C_LINE$+QUO ! +" now "+QUO+ITEM_NEW$+QUO
6060 C_LINE$=PAD(" ",19,0)+"now "+QUO+ITEM_NEW$+QUO; PRT_BOTH_CTR=PRT_BOTH_CTR+1,PRT_BOTH$[PRT_BOTH_CTR]=C_LINE$; GOTO 6150
6070 IF COMP$<>"O" THEN GOTO 6110 ELSE IF ITEM_OLD$="" THEN GOTO 6160
6080 IF ELEM_HDR$="" THEN GOTO 6090 ELSE PRT_OLD_CTR=PRT_OLD_CTR+1; PRT_OLD$[PRT_OLD_CTR]=ELEM_HDR$,ELEM_HDR$=""
6090 C_LINE$="  "+ITEM_NME$+" is "+QUO+ITEM_OLD$+QUO
6100 PRT_OLD_CTR=PRT_OLD_CTR+1,PRT_OLD$[PRT_OLD_CTR]=C_LINE$; GOTO 6150
6110 IF COMP$<>"N" THEN GOTO 6160 ELSE IF ITEM_NEW$="" THEN GOTO 6160
6120 IF ELEM_HDR$="" THEN GOTO 6125 ELSE PRT_NEW_CTR=PRT_NEW_CTR+1,PRT_NEW$[PRT_NEW_CTR]=ELEM_HDR$,ELEM_HDR$=""
6130 C_LINE$="  "+ITEM_NME$+" is "+QUO+ITEM_NEW$+QUO
6140 PRT_NEW_CTR=PRT_NEW_CTR+1,PRT_NEW$[PRT_NEW_CTR]=C_LINE$
6150 PANEL_CTR=PANEL_CTR+1
6160 RETURN 
6170 ! - display line to screen and set up for print file
6180 DISPLAY_LINE:
6181 NULLS$=$00$,SEPS$=SEP
6182 P=POS(NULLS$=D_LINE$); IF P<>0 THEN D_LINE$=D_LINE$(1,P-1)+"~"+D_LINE$(P+1); GOTO 6182
6183 P=POS(SEPS$=D_LINE$); IF P<>0 THEN D_LINE$=D_LINE$(1,P-1)+"|"+D_LINE$(P+1); GOTO 6183
6190 IF D_LINE$(1,2)="* "=1 THEN HLD_LINE$=D_LINE$,D_LINE$=PAD(" ",70); GOSUB PRT_BLANK; D_LINE$=HLD_LINE$
6195 IF %_FILE_NO_3<>0 THEN PRINT (%_FILE_NO_3,ERR=*NEXT)D_LINE$ ! SSP227983 jdf
6200 TOO_LONG$=""
6210 IF LEN(D_LINE$)<71 THEN GOTO 6220 ELSE TOO_LONG$=D_LINE$(71),D_LINE$=D_LINE$(1,70)
6211 P=POS(" "=D_LINE$,-1); IF P<=OFS_P+1 THEN D_LINE$=D_LINE$+"-"; GOTO 6220 ELSE IF P=70 THEN P=P-1 ! LET TOO_LONG$=D_LINE$(P)+TOO_LONG$,D_LINE$=PAD(D_LINE$(1,P),70,1)+"-"
6212 TOO_LONG$=D_LINE$(P+1)+TOO_LONG$,D_LINE$=PAD(D_LINE$(1,P),70,1)+"-"
6220 LIST_BOX LOAD COMP_LIST.CTL,0,D_LINE$
6230 IF P_LINE$<>"" THEN WRITE RECORD (TMP_PRT_FN,ERR=9100)P_LINE$; P_LINE$="",TOT_PRINT_LINES=TOT_PRINT_LINES+1
6240 IF TOO_LONG$="" THEN GOTO 6250 ELSE D_LINE$=PAD(" ",OFS_P)+QUO+STP(TOO_LONG$,2),TOO_LONG$=""; GOTO 6210
6250 RETURN 
6260 ! - display blank line
6270 PRT_BLANK:
6280 D_LINE$=PAD(" ",70); GOSUB DISPLAY_LINE
6290 RETURN 
6300 PRT_ASTR:
6310 D_LINE$=PAD("*",60,"*"),P_LINE$=PAD("*",69,"*"); GOSUB DISPLAY_LINE
6320 RETURN 
6321 ! - convert element routines
6322 ! - parse obj_attr rtn
6330 ATTR_PARSE_RTN:
6331 OLD_A$="",NEW_A$="",P=POS("'MODE'($"=OBJ_ATTR$); IF P<>0 THEN IF OBJ_COLOUR$="" THEN OBJ_COLOUR$=OBJ_ATTR$(P+8,4),OLD_A$="Y" ELSE OLD_A$="Y" ! if obj_attr and obj_colour valued  then use obj_colour
6332 P=POS("'FONT'"=OBJ_ATTR$); IF P<>0 THEN IF OBJ_FONT$="" THEN X_FONT$=OBJ_ATTR$(P+6); GOSUB CHK_FONT_RTN; OBJ_FONT$=X_FONT$,OLD_A$="Y" ELSE OLD_A$="Y"
6333 P=POS("'MODE'($"=N_OBJ_ATTR$); IF P<>0 THEN IF N_OBJ_COLOUR$="" THEN N_OBJ_COLOUR$=N_OBJ_ATTR$(P+8,4),NEW_A$="Y" ELSE NEW_A$="Y"
6334 P=POS("'FONT'"=N_OBJ_ATTR$); IF P<>0 THEN IF N_OBJ_FONT$="" THEN X_FONT$=N_OBJ_ATTR$(P+6); GOSUB CHK_FONT_RTN; N_OBJ_FONT$=X_FONT$,NEW_A$="Y" ELSE NEW_A$="Y"
6340 RETURN 
6349 ! 
6350 CHK_FONT_RTN:
6360 P=POS(QUO+"()":X_FONT$); IF P=0 THEN GOTO 6370 ELSE IF P=1 THEN X_FONT$=X_FONT$(2); GOTO 6360 ELSE IF P=LEN(X_FONT$) THEN X_FONT$=X_FONT$(1,P-1); GOTO 6360 ELSE X_FONT$=X_FONT$(1,P-1)+X_FONT$(P+1); GOTO 6360
6370 RETURN 
6371 ! - colour tbl rtn
6380 COLOUR_TBL_RTN:
6381 IF ITEM_OLD$="" OR ITEM_OLD$="0000" THEN GOTO 6383 ELSE CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_obj_color"; GOSUB CALL_LIBUTILS
6382 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
6383 IF ITEM_NEW$="" OR ITEM_NEW$="0000" THEN GOTO 6385 ELSE CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_obj_color"; GOSUB CALL_LIBUTILS
6384 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
6385 RETURN 
6390 ! - attributes tbl rtn
6391 IMAGE_ATTR_TBL_RTN:
6392 IF ITEM_OLD$="" THEN GOTO 6395 ELSE CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_obj_attr"; GOSUB CALL_LIBUTILS
6394 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
6395 IF ITEM_NEW$="" THEN GOTO 6398 ELSE CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_obj_attr"; GOSUB CALL_LIBUTILS
6397 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
6398 RETURN 
6399 ! Dependency OBJ_DEF$ (obj_type$="+")
6400 DEPEND_OBJ_DEF_RTN:
6401 CHK_DEF$=ITEM_OLD$; GOSUB DEPEND_OBJ_DEF_LOOP; IF CONV_DEF$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_DEF$
6402 CHK_DEF$=ITEM_NEW$; GOSUB DEPEND_OBJ_DEF_LOOP; IF CONV_DEF$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_DEF$
6404 RETURN 
6405 DEPEND_OBJ_DEF_LOOP:
6406 CONV_DEF_ALL$=""
6407 IF CHK_DEF$="" THEN GOTO 6426 ELSE CONV_DEF$="",C_DEF_NME$="",C_DEF_TYPE$="",C_DEF_ACT$="",C_DEF_TABTBL$=""
6408 ! Do parse obj_def loop
6409 P_C=POS(";"=CHK_DEF$); IF P_C<>0 THEN CONV_DEF$=CHK_DEF$(1,P_C-1),CHK_DEF$=CHK_DEF$(P_C+1) ELSE CONV_DEF$=CHK_DEF$,CHK_DEF$=""
6410 ! get control name
6411 P_C=POS(":"=CONV_DEF$); IF P_C=0 THEN GOTO 6407 ELSE C_DEF_NME$=CONV_DEF$(1,P_C-1),CONV_DEF$=CONV_DEF$(P_C+1)
6412 ! get control type
6413 P_C=POS(","=CONV_DEF$); IF P_C=0 THEN GOTO 6407
6414 C_DEF_TYPE$=CONV_DEF$(1,P_C-1)
6415 CONV_F$=C_DEF_TYPE$,CONV_RTN$="conv_obj_type"; GOSUB CALL_LIBUTILS; IF CONV_F$<>C_DEF_TYPE$ THEN C_DEF_TYPE$=CONV_F$
6416 ! get control action
6417 P_C=POS(";"=CONV_DEF$); IF P_C=0 THEN C_DEF_ACT$=CONV_DEF$,CONV_DEF$="" ELSE C_DEF_ACT$=CONV_DEF$(1,P_C-1),CONV_DEF$=CONV_DEF$(P_C+1)
6418 P_TT=POS("^"=C_DEF_ACT$); IF P_TT>0 THEN C_DEF_TABTBL$=C_DEF_ACT$(P_TT+1),C_DEF_ACT$=C_DEF_ACT$(1,P_TT-1) ! get Tab Table within action
6419 CONV_F$=C_DEF_ACT$,CONV_RTN$="conv_obj_def_action"; GOSUB CALL_LIBUTILS; IF CONV_F$<>C_DEF_ACT$ THEN C_DEF_ACT$=CONV_F$
6420 ! build
6421 X$=C_DEF_NME$+"/"+C_DEF_TYPE$+"/"+C_DEF_ACT$+"/"+C_DEF_TABTBL$
6422 CONV_DEF_ALL$=CONV_DEF_ALL$+X$+", "
6423 ! go back thru loop
6424 GOTO 6408
6425 ! all done
6426 IF STP(CONV_DEF_ALL$)>"" THEN CONV_DEF_ALL$=CONV_DEF_ALL$(1,LEN(CONV_DEF_ALL$)-2)
6428 RETURN 
6430 ! do action convert
6450 ! - Dependency Rtn (OBJ_NULL$ & OBJ_DEF$) for obj_type$="+"
6460 DEPENDENCY_RTN:
6470 IF ITEM_OLD$="" THEN GOTO 6490 ELSE CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_obj_action"; GOSUB CALL_LIBUTILS
6480 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
6490 IF ITEM_NEW$="" THEN GOTO 6510 ELSE CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_obj_action"; GOSUB CALL_LIBUTILS
6500 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
6510 RETURN 
6520 ! - type tbl rtn
6530 TYPE_TBL_RTN:
6540 IF ITEM_OLD$="" THEN GOTO 6560 ELSE CONV_F$=ITEM_OLD$; IF ON_REC$="Header " THEN CONV_PGM_ENTRY$="conv_obj_type_hdr"; GOSUB CALL_LIBUTILS ELSE CONV_PGM_ENTRY$="conv_obj_type"; GOSUB CALL_LIBUTILS
6550 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
6560 IF ITEM_NEW$="" THEN GOTO 6580 ELSE CONV_F$=ITEM_NEW$; IF ON_REC$="Header " THEN CONV_PGM_ENTRY$="conv_obj_type_hdr"; GOSUB CALL_LIBUTILS ELSE CONV_PGM_ENTRY$="conv_obj_type"; GOSUB CALL_LIBUTILS
6570 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
6580 RETURN 
6590 ! - obj_qry_attr
6600 QRY_ATTR_RTN:
6610 IF ITEM_OLD$="" THEN GOTO 6630 ELSE CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_obj_qry_attr"; GOSUB CALL_LIBUTILS
6620 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
6630 IF ITEM_NEW$="" THEN GOTO 6650 ELSE CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_obj_qry_attr"; GOSUB CALL_LIBUTILS
6640 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
6650 RETURN 
6660 ! - obj scratch parse - strip separater
6670 SCRATCH_PARSE_RTN:
6680 IF ITEM_OLD$="" THEN GOTO 6700 ELSE CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_scratch"; GOSUB CALL_LIBUTILS
6690 ITEM_OLD$=CONV_F$ ! don't check if valued and not equal as rtn may init
6700 IF ITEM_NEW$="" THEN GOTO 6720 ELSE CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_scratch"; GOSUB CALL_LIBUTILS
6710 ITEM_NEW$=CONV_F$
6720 RETURN 
6721 ! - obj_def rtn for Grid Attr
6722 GRID_OBJ_DEF_RTN:
6723 CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_obj_def_grid_attr"; GOSUB CALL_LIBUTILS; ITEM_OLD$=CONV_F$
6724 CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_obj_def_grid_attr"; GOSUB CALL_LIBUTILS; ITEM_NEW$=CONV_F$
6725 RETURN 
6730 ! - obj null rtn for header
6740 NULL_TBL_RTN:
6750 IF ITEM_OLD$="" THEN GOTO 6770 ELSE CONV_F$=ITEM_OLD$; CONV_PGM_ENTRY$="conv_obj_null_hdr"; GOSUB CALL_LIBUTILS
6760 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
6770 IF ITEM_NEW$="" THEN GOTO 6790 ELSE CONV_F$=ITEM_NEW$; CONV_PGM_ENTRY$="conv_obj_null_hdr"; GOSUB CALL_LIBUTILS
6780 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
6790 RETURN 
6800 ! - obj_def for Auto Trigger
6810 AUTO_TRIGGER_RTN:
6820 AUTO_TRG$="Y",OLD_1$="OFF",OLD_2$="",OLD_3$="",NEW_1$="OFF",NEW_2$="",NEW_3$=""
6830 IF LEN(OBJ_DEF$)>0 THEN IF OBJ_DEF$(1,1)="q" THEN OLD_1$="ON" ELSE OLD_1$="OFF"
6840 IF LEN(OBJ_DEF$)>1 THEN P=POS(";"=OBJ_DEF$); IF P>0 THEN OLD_2$=OBJ_DEF$(2,P-2),OLD_3$=OBJ_DEF$(P+1) ELSE OLD_2$=OBJ_DEF$(2)
6850 IF LEN(N_OBJ_DEF$)>0 THEN IF N_OBJ_DEF$(1,1)="q" THEN NEW_1$="ON" ELSE NEW_1$="OFF"
6860 IF LEN(N_OBJ_DEF$)>1 THEN P=POS(";"=N_OBJ_DEF$); IF P>0 THEN NEW_2$=N_OBJ_DEF$(2,P-2),NEW_3$=N_OBJ_DEF$(P+1) ELSE NEW_2$=N_OBJ_DEF$(2)
6870 ITEM_NME$=" Autoload Triggr",ITEM_OLD$=OLD_1$,ITEM_NEW$=NEW_1$; GOSUB COMPARE_RTN
6880 ITEM_NME$=" Trigger Vars",ITEM_OLD$=OLD_2$,ITEM_NEW$=NEW_2$; GOSUB COMPARE_RTN
6890 ITEM_NME$=" Trigger Test",ITEM_OLD$=OLD_3$,ITEM_NEW$=NEW_3$; GOSUB COMPARE_RTN
6900 RETURN 
6901 ! - persistence tbl rtn
6902 PERSISTENCE_TBL_RTN:
6903 IF ITEM_OLD$="" THEN GOTO 6905 ELSE CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_obj_persistence"; GOSUB CALL_LIBUTILS
6904 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
6905 IF ITEM_NEW$="" THEN GOTO 6907 ELSE CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_obj_persistence"; GOSUB CALL_LIBUTILS
6906 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
6907 RETURN 
6910 ! - default tbl rtn
6920 DEFAULT_TBL_RTN:
6930 IF ITEM_OLD$="" THEN GOTO 6950 ELSE CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_obj_def"; GOSUB CALL_LIBUTILS
6940 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
6950 IF ITEM_NEW$="" THEN GOTO 6970 ELSE CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_obj_def"; GOSUB CALL_LIBUTILS
6960 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
6970 RETURN 
6971 ! - Shapes Fill Pattern/Colrs obj_idx
6972 FILL_PATTERN_CLR_RTN:
6973 ITEM_NME$=" Fill Ptrn,Clr1,Clr2"
6974 X_FLD$=OBJ_IDX$; GOSUB CHK_PATTERN_CLR; IF X_FLD_ALL$<>"" THEN ITEM_OLD$=X_FLD_ALL$ ELSE ITEM_OLD$=OBJ_IDX$
6975 X_FLD$=N_OBJ_IDX$; GOSUB CHK_PATTERN_CLR; IF X_FLD_ALL$<>"" THEN ITEM_NEW$=X_FLD_ALL$ ELSE ITEM_NEW$=N_OBJ_IDX$
6976 GOSUB COMPARE_RTN
6977 RETURN 
6980 ! parse/chk fill loop
6981 CHK_PATTERN_CLR:
6982 X_FLD_ALL$="",X_FLD1$="",X_FLD2$="",X_FLD3$=""; IF X_FLD$="" THEN RETURN 
6983 P=POS(","=X_FLD$),X_FLD1$=X_FLD$(1,P-1),X_FLD2$=X_FLD$(P+1); P=POS(","=X_FLD2$); IF P<>0 THEN X_FLD3$=X_FLD2$(P+1),X_FLD2$=X_FLD2$(1,P-1) ELSE X_FLD3$=""
6984 ! chk fill pattern
6985 CONV_F$=X_FLD1$,CONV_PGM_ENTRY$="conv_fill_pattern"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" THEN X_FLD1$=CONV_F$
6986 ! chk fill colour1
6987 CONV_F$=X_FLD2$,CONV_PGM_ENTRY$="conv_one_color"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" THEN X_FLD2$=CONV_F$
6988 ! chk fill colour2
6989 CONV_F$=X_FLD3$,CONV_PGM_ENTRY$="conv_one_color"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" THEN X_FLD3$=CONV_F$
6990 IF X_FLD1$<>"" THEN X_FLD_ALL$=X_FLD1$+","
6991 IF X_FLD2$<>"" THEN X_FLD_ALL$=X_FLD_ALL$+X_FLD2$+","
6992 IF X_FLD3$<>"" THEN X_FLD_ALL$=X_FLD_ALL$+X_FLD3$
6993 RETURN 
7000 ! 
7040 ! - folder colour rtn
7050 FOLDER_CLR_RTN:
7060 ITEM_CLR$=""
7070 ITEM_CONV$=ITEM_OLD$
7080 GOSUB CONV_MANY_ONE_COLOR
7090 IF ITEM_CLR$<>"" THEN ITEM_OLD$=ITEM_CLR$
7100 ITEM_CLR$=""
7110 ITEM_CONV$=ITEM_NEW$
7120 GOSUB CONV_MANY_ONE_COLOR
7130 IF ITEM_CLR$<>"" THEN ITEM_NEW$=ITEM_CLR$
7140 RETURN 
7150 ! - convert field with many one colours, folder colour
7160 CONV_MANY_ONE_COLOR:
7170 IF ITEM_CONV$="" THEN GOTO 7230
7180 CONV_F$=MID(ITEM_CONV$,1,2)
7190 CONV_PGM_ENTRY$="conv_one_color"; GOSUB CALL_LIBUTILS
7200 IF CONV_F$<>"" AND CONV_F$<>MID(ITEM_CONV$,1,2) THEN ITEM_CLR$=ITEM_CLR$+CONV_F$+", "
7210 IF LEN(ITEM_CONV$)>2 THEN ITEM_CONV$=ITEM_CONV$(3) ELSE ITEM_CONV$=""
7220 GOTO 7170
7230 IF ITEM_CLR$<>"" THEN ITEM_CLR$=ITEM_CLR$(1,LEN(ITEM_CLR$)-2)
7240 RETURN 
7250 ! - bitmap on push rtn
7260 CONV_BITMAP_RTN:
7270 O_BIT_TXT$="",O_BIT_ALIGN$="",O_BIT_1$="",O_BIT_2$="",O_BIT_3$="",N_BIT_TXT$="",N_BIT_ALIGN$="",N_BIT_1$="",N_BIT_2$="",N_BIT_3$=""
7280 IF ITEM_OLD$="" THEN GOTO 7320 ELSE O_BIT_TXT$=ITEM_OLD$; IF ITEM_OLD$(1,1)="=" THEN GOTO 7320 ELSE P=POS("{"=ITEM_OLD$); IF P=0 THEN GOTO 7320
7290 IF P=1 THEN P=POS("}"=ITEM_OLD$,-1); O_BIT_1$=ITEM_OLD$(2,P-2),O_BIT_TXT$=ITEM_OLD$(P+1),O_BIT_ALIGN$="Left" ELSE O_BIT_1$=ITEM_OLD$(P+1),O_BIT_1$=O_BIT_1$(1,LEN(O_BIT_1$)-1),O_BIT_TXT$=ITEM_OLD$(1,P-1),O_BIT_ALIGN$="Right"
7300 P=POS("|"=O_BIT_1$); IF P<>0 THEN O_BIT_2$=O_BIT_1$(P+1),O_BIT_1$=O_BIT_1$(1,P-1)
7310 P=POS("|"=O_BIT_2$); IF P<>0 THEN O_BIT_3$=O_BIT_2$(P+1),O_BIT_2$=O_BIT_2$(1,P-1)
7320 IF ITEM_NEW$="" THEN GOTO 7360 ELSE N_BIT_TXT$=ITEM_NEW$; IF ITEM_NEW$(1,1)="=" THEN GOTO 7360 ELSE P=POS("{"=ITEM_NEW$); IF P=0 THEN GOTO 7360
7330 IF P=1 THEN P=POS("}"=ITEM_NEW$,-1); N_BIT_1$=ITEM_NEW$(2,P-2),N_BIT_TXT$=ITEM_NEW$(P+1),N_BIT_ALIGN$="Left" ELSE N_BIT_1$=ITEM_NEW$(P+1),N_BIT_1$=N_BIT_1$(1,LEN(N_BIT_1$)-1),N_BIT_TXT$=ITEM_NEW$(1,P-1),N_BIT_ALIGN$="Right"
7340 P=POS("|"=N_BIT_1$); IF P<>0 THEN N_BIT_2$=N_BIT_1$(P+1),N_BIT_1$=N_BIT_1$(1,P-1)
7350 P=POS("|"=N_BIT_2$); IF P<>0 THEN N_BIT_3$=N_BIT_2$(P+1),N_BIT_2$=N_BIT_2$(1,P-1)
7360 ITEM_NME$=" Text Value",ITEM_OLD$=O_BIT_TXT$,ITEM_NEW$=N_BIT_TXT$
7370 IF N_BIT_TXT$="" THEN IF O_BIT_TXT$<>"" THEN IF O_BIT_TXT$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"; GOTO 7390
7380 IF N_BIT_TXT$<>"" THEN IF N_BIT_TXT$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
7390 GOSUB COMPARE_RTN
7400 ITEM_OLD$=O_BIT_1$,ITEM_NEW$=N_BIT_1$
7410 IF POS("BbRr":OBJ_TYPE$) THEN ITEM_NME$=" Bitmap Normal" ELSE IF POS("Cc3":OBJ_TYPE$) THEN ITEM_NME$=" Bitmap Off"
7420 IF POS("BbRr":N_OBJ_TYPE$) THEN ITEM_NME$=" Bitmap Normal" ELSE IF POS("Cc3":N_OBJ_TYPE$) THEN ITEM_NME$=" Bitmap Off"
7430 GOSUB COMPARE_RTN
7440 ITEM_OLD$=O_BIT_2$,ITEM_NEW$=N_BIT_2$
7450 IF POS("BbRr":OBJ_TYPE$) THEN ITEM_NME$=" Bitmap Push" ELSE IF POS("Cc3":OBJ_TYPE$) THEN ITEM_NME$=" Bitmap On"
7460 IF POS("BbRr":N_OBJ_TYPE$) THEN ITEM_NME$=" Bitmap Push" ELSE IF POS("Cc3":N_OBJ_TYPE$) THEN ITEM_NME$=" Bitmap On"
7470 GOSUB COMPARE_RTN
7480 ITEM_NME$=" Bitmap 3rd",ITEM_OLD$=O_BIT_3$,ITEM_NEW$=N_BIT_3$; GOSUB COMPARE_RTN
7490 ITEM_NME$=" Bitmap Align",ITEM_OLD$=O_BIT_ALIGN$,ITEM_NEW$=N_BIT_ALIGN$; GOSUB COMPARE_RTN
7500 RETURN 
7510 ! - status tbl rtn
7520 STATUS_TBL_RTN:
7530 IF ON_REC$="Header " THEN CONV_F$=ITEM_OLD$,F_ATTR$=OBJ_ATTR$,F_DEF$=OBJ_DEF$,F_NULL$=OBJ_NULL$; GOSUB CONV_OBJ_STS_HDR; GOTO 7550 ! chk all attributes even if some blank
7540 CONV_F$=ITEM_OLD$,F_ATTR$=OBJ_ATTR$,F_TYPE$=OBJ_TYPE$,F_TAB$=STR(OBJ_TAB),F_LISTBOX$=OBJ_LISTBOX_TYPE$,F_DEF$=OBJ_DEF$,F_NULL$=OBJ_NULL$; GOSUB CONV_OBJ_STS ! chk all even if some blank
7550 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$,CONV_F$=""
7560 IF ON_REC$="Header " THEN CONV_F$=ITEM_NEW$,F_ATTR$=N_OBJ_ATTR$,F_DEF$=N_OBJ_DEF$,F_NULL$=N_OBJ_NULL$; GOSUB CONV_OBJ_STS_HDR; GOTO 7580 ! chk all even if blank
7570 CONV_F$=ITEM_NEW$,F_ATTR$=N_OBJ_ATTR$,F_TYPE$=N_OBJ_TYPE$,F_TAB$=STR(N_OBJ_TAB),F_LISTBOX$=N_OBJ_LISTBOX_TYPE$,F_DEF$=N_OBJ_DEF$,F_NULL$=N_OBJ_NULL$; GOSUB CONV_OBJ_STS ! chk all even if blank
7580 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$,CONV_F$=""
7590 RETURN 
7600 ! - header record status tbl rtn
7610 CONV_OBJ_STS_HDR:
7620 CALL "*win/libutils;conv_obj_sts_hdr",CONV_F$,F_ATTR$,F_DEF$,F_NULL$
7630 RETURN 
7640 ! - status tbl rtn
7650 CONV_OBJ_STS:
7660 CALL "*win/libutils;conv_obj_sts",CONV_F$,F_ATTR$,F_TYPE$,F_TAB$,F_LISTBOX$,F_DEF$,F_NULL$
7670 RETURN 
7680 ! - obj listbox type tbl rtn
7690 LISTBOX_TYPE_TBL_RTN:
7700 IF ITEM_OLD$="" THEN GOTO 7720 ELSE CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_listbox_type"; GOSUB CALL_LIBUTILS
7710 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
7720 IF ITEM_NEW$="" THEN GOTO 7740 ELSE CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_listbox_type"; GOSUB CALL_LIBUTILS
7730 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
7740 RETURN 
7750 ! - font tbl rtn
7760 FONT_TBL_RTN:
7770 IF ITEM_OLD$="" THEN GOTO 7790 ELSE CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_obj_font"; GOSUB CALL_LIBUTILS
7780 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
7790 IF ITEM_NEW$="" THEN GOTO 7810 ELSE CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_obj_font"; GOSUB CALL_LIBUTILS
7800 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
7810 RETURN 
7820 ! - logic tbl rtn
7830 LOGIC_TBL_RTN:
7840 IF ITEM_OLD$="" THEN GOTO 7860 ELSE CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_logic"; GOSUB CALL_LIBUTILS; GOSUB ADJUST_CONV_LOGIC
7850 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
7860 IF ITEM_NEW$="" THEN GOTO 7880 ELSE CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_logic"; GOSUB CALL_LIBUTILS; GOSUB ADJUST_CONV_LOGIC
7870 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
7880 RETURN 
7890 ADJUST_CONV_LOGIC:
7900 IF CONV_F$<>"" THEN IF CONV_F$(LEN(CONV_F$))=QUO THEN CONV_F$=CONV_F$(1,LEN(CONV_F$)-1)
7910 RETURN 
7920 ! call LIBUTILS program
7930 CALL_LIBUTILS:
7940 CALL "*win/libutils;"+CONV_PGM_ENTRY$,CONV_F$
7950 RETURN 
7960 ! - error on table for OLD record
7970 OLD_RECORD_ERR:
7980 RETURN ; PANEL_ERR$=OLD_PANEL_NME$,ELEM_ERR$=ITEM_OLD$; GOSUB ELEM_ERR; RETURN 
7990 ! - error on table for NEW record
8000 NEW_RECORD_ERR:
8010 RETURN ; PANEL_ERR$=NEW_PANEL_NME$,ELEM_ERR$=ITEM_NEW$; GOSUB ELEM_ERR; RETURN 
8020 ! - initialize for current  panel
8030 INIT_FOR_CURRENT_PANEL:
8040 SHAPE_TBL$="(O/)^["
8050 PRT_MAX=500,PRT_OLD_CTR=0,PRT_NEW_CTR=0,PRT_BOTH_CTR=0
8060 DIM PRT_OLD$[1500],PRT_NEW$[1500],PRT_BOTH$[1500]
8070 ! set up temp new file
8080 IF TMP_FN=0 THEN CALL "*fl.nme",OT_NAME$; TMP_NEW$=OT_NAME$; TMP_FN=HFN; KEYED TMP_NEW$,16,,2048,ERR=8090
8090 ! - build temp new file for panel
8100 OPEN PURGE (TMP_FN,ERR=9110)TMP_NEW$
8110 READ RECORD (NEW_FN,KEY=PAD(NEW_PANEL_NME$,12),DOM=*NEXT)
8120 NEW_PANEL_KEY$=KEY(NEW_FN,END=8180) ! start at beginning of new file
8130 READ (NEW_FN,ERR=9090)IOL=10020
8140 IF PAD(NEW_PANEL_NME$,12)<>NEW_PANEL_KEY$(1,12) THEN GOTO 8180 ! chk next new record
8150 IF NEW_PANEL_KEY$(13,1)="M" AND N_OBJ_NME$="" THEN N_OBJ_NME$=NEW_PANEL_KEY$(13,4)
8160 WRITE (TMP_FN,KEY=NEW_PANEL_KEY$,ERR=9110)IOL=10020 ! on error may want to got to gorsub reset_old_panel_key line
8170 GOTO 8120
8180 GOSUB RESET_OLD_PANEL_KEY; OLD_PANEL_KEY$=KEP(LIB_FN,END=8190); GOSUB RESET_OLD_PANEL_KEY
8190 RETURN 
8200 ! - load next panel names
8210 LOAD_PANEL_NAMES:
8220 IF COMP_LIBS$="" THEN GOTO 8240
8230 LIST_BOX LOAD COMP_LIBS.CTL,COMP_LIBS$; PERFORM "*winproc;refresh_scrn"
8240 RETURN 
8250 ! - INIT OLD_PANEL
8260 INIT_OLD_PANEL:
8270 LIST_BOX LOAD OLD_PANELS.CTL,""
8280 REFRESH_FLG=1
8290 RETURN 
8300 ! - INIT NEW_PANEL
8310 INIT_NEW_PANEL:
8320 LIST_BOX LOAD NEW_PANELS.CTL,""
8330 REFRESH_FLG=1
8340 RETURN 
9000 ! ^1000 - 7000 - msgbox error messages
9010 NO_OLD_LIB_MSG:GOSUB INIT_OLD_PANEL; MSGBOX "No Old file selected","Error","!"; EXIT 
9020 NO_GET_OLD_MSG: OLD_ERR$="Y"; GOSUB INIT_OLD_PANEL; MSGBOX "Unable to access Old file."+SEP+"Please check that this is a Panel Library file.","Error","!"; EXIT 
9030 NO_NEW_LIB_MSG:GOSUB INIT_NEW_PANEL; MSGBOX "No New file selected","Error","!"; EXIT 
9040 NO_GET_NEW_MSG: NEW_ERR$="Y"; GOSUB INIT_NEW_PANEL; MSGBOX "Unable to access New file."+SEP+"Please check that this is a Panel Library file.","Error","!"; EXIT 
9050 NO_ITEM: MSGBOX "Select Compare or Compare Corresponding ","Error","!"; RETURN 
9060 NO_PRTER: MSGBOX "Unable to access printer"+SEP+SEP+MSG(ERR),"Error","!"; EXIT 
9070 NO_PRT: MSGBOX "Internal error - unable to access print information"+SEP+SEP+MSG(ERR),"Error","!"; EXIT 
9080 PRT_LINE_ERR: MSGBOX "Print line error "+SEP+"Do you wish to continue printing?","Print Error","YESNO,?",X$; RETURN ! print line error
9090 NO_REC: MSGBOX "Internal error - unable to access panel records"+SEP+SEP+MSG(ERR),"Error","!"; EXIT 
9100 NO_WRIT: MSGBOX "Internal error - unable to create temporary print file"+SEP+SEP+MSG(ERR),"Error","!"; EXIT 
9110 NO_TMP_REC: MSGBOX "Internal error - unable to create temporary file"+SEP+SEP+MSG(ERR),"Error","!"; EXIT 
9120 ELEM_ERR: MSGBOX "Element "+ELEM_NME$+" on Panel "+P_NME$+" has "+ITEM_NME$+" error!"+SEP+"Unable to translate value of '"+ELEM_ERR$+"'","Error","!"; WAIT 1; RETURN 
9130 SAME_LIBS: MSGBOX "Same panels in same libraries being compared","Error","!"; EXIT 
9140 COMP_DONE: MSGBOX "Compare completed ","FYI"; RETURN 
9150 NO_DIFF: MSGBOX "Compare completed, No differences found","FYI"; RETURN 
9160 NO_PANELS: MSGBOX "No panels to compare, please verify Library selection","Error","!"; EXIT 
9200 ! ^100 - init Old elements
9210 INIT_OLD_ELEM:
9220 OBJ_NME$="",OBJ_C=0,OBJ_0=0,OBJ_W=0,OBJ_H=0,OBJ_TYPE$="",OBJ_TXT$="",OBJ_VAL$="",OBJ_TAB=0,OBJ_DEF$="",OBJ_DSP$="",OBJ_FCS$="",OBJ_SEL$="",OBJ_MSG$="",OBJ_HLP$="",OBJ_ATTR$="",OBJ_IDX$="",OBJ_HOTKEY$="",OBJ_QRY$="",OBJ_SEC$="",OBJ_STS$="",OBJ_GRP$="",OBJ_NULL$="",OBJ_TAG$="",OBJ_TBL$="",OBJ_INP$="",OBJ_OUT$="",OBJ_VALID$="",OBJ_CLASS$="",OBJ_TIP$="",OBJ_ORIG$="",OBJ_FONT$="",OBJ_COLOUR$="",OBJ_LISTBOX_TYPE$="",OBJ_SEP$="",OBJ_SCRATCH$="",OBJ_POPUP$="",OBJ_SIZING$="",OBJ_LOGIC1$="",OBJ_LOGIC2$="",OBJ_POPUP_LOGIC$="",OBJ_QRY_BITMAP$="",OBJ_QRY_WIDTH=0,OBJ_QRY_TIP$="",OBJ_QRY_ATTR$="",OBJ_EXTENSION$="",OBJ_DEMAND$="",OBJ_DEMAND_LOGIC$="",OBJ_BACKGROUND_LOGIC$="",OBJ_PERSISTENCE$=""
9230 RETURN 
9240 ! init New elements
9250 INIT_NEW_ELEM:
9260 N_OBJ_NME$="",N_OBJ_C=0,N_OBJ_L=0,N_OBJ_W=0,N_OBJ_H=0,N_OBJ_TYPE$="",N_OBJ_TXT$="",N_OBJ_VAL$="",N_OBJ_TAB=0,N_OBJ_DEF$="",N_OBJ_DSP$="",N_OBJ_FCS$="",N_OBJ_SEL$="",N_OBJ_MSG$="",N_OBJ_HLP$="",N_OBJ_ATTR$="",N_OBJ_IDX$="",N_OBJ_HOTKEY$="",N_OBJ_QRY$="",N_OBJ_SEC$="",N_OBJ_STS$="",N_OBJ_GRP$="",N_OBJ_NULL$="",N_OBJ_TAG$="",N_OBJ_TBL$="",N_OBJ_INP$="",N_OBJ_OUT$="",N_OBJ_VALID$="",N_OBJ_CLASS$="",N_OBJ_TIP$="",N_OBJ_ORIG$="",N_OBJ_FONT$="",N_OBJ_COLOUR$="",N_OBJ_LISTBOX_TYPE$="",N_OBJ_SEP$="",N_OBJ_SCRATCH$="",N_OBJ_POPUP$="",N_OBJ_SIZING$="",N_OBJ_LOGIC1$="",N_OBJ_LOGIC2$="",N_OBJ_POPUP_LOGIC$="",N_OBJ_QRY_BITMAP$="",N_OBJ_QRY_WIDTH=0,N_OBJ_QRY_TIP$="",N_OBJ_QRY_ATTR$="",N_OBJ_EXTENSION$="",N_OBJ_DEMAND$="",N_OBJ_DEMAND_LOGIC$="",N_OBJ_BACKGROUND_LOGIC$="",N_OBJ_PERSISTENCE$=""
9270 RETURN 
9999 END 
10000 ! ^1000 - 8000 - IOLISTs
10010 IOLIST OBJ_NME$,OBJ_C,OBJ_L,OBJ_W,OBJ_H,OBJ_TYPE$,OBJ_TXT$,OBJ_VAL$,OBJ_TAB,OBJ_DEF$,OBJ_DSP$,OBJ_FCS$,OBJ_SEL$,OBJ_MSG$,OBJ_HLP$,OBJ_ATTR$,OBJ_IDX$,OBJ_HOTKEY$,OBJ_QRY$,OBJ_SEC$,OBJ_STS$,OBJ_GRP$,OBJ_NULL$,OBJ_TAG$,OBJ_TBL$,OBJ_INP$,OBJ_OUT$,OBJ_VALID$,OBJ_CLASS$,OBJ_TIP$,OBJ_ORIG$,OBJ_FONT$,OBJ_COLOUR$,OBJ_LISTBOX_TYPE$,OBJ_SEP$,OBJ_SCRATCH$,OBJ_POPUP$,OBJ_SIZING$,OBJ_LOGIC1$,OBJ_LOGIC2$,OBJ_POPUP_LOGIC$,OBJ_QRY_BITMAP$,OBJ_QRY_WIDTH,OBJ_QRY_TIP$,OBJ_QRY_ATTR$,OBJ_EXTENSION$,OBJ_DEMAND$,OBJ_DEMAND_LOGIC$,OBJ_BACKGROUND_LOGIC$,OBJ_PERSISTENCE$
10020 IOLIST N_OBJ_NME$,N_OBJ_C,N_OBJ_L,N_OBJ_W,N_OBJ_H,N_OBJ_TYPE$,N_OBJ_TXT$,N_OBJ_VAL$,N_OBJ_TAB,N_OBJ_DEF$,N_OBJ_DSP$,N_OBJ_FCS$,N_OBJ_SEL$,N_OBJ_MSG$,N_OBJ_HLP$,N_OBJ_ATTR$,N_OBJ_IDX$,N_OBJ_HOTKEY$,N_OBJ_QRY$,N_OBJ_SEC$,N_OBJ_STS$,N_OBJ_GRP$,N_OBJ_NULL$,N_OBJ_TAG$,N_OBJ_TBL$,N_OBJ_INP$,N_OBJ_OUT$,N_OBJ_VALID$,N_OBJ_CLASS$,N_OBJ_TIP$,N_OBJ_ORIG$,N_OBJ_FONT$,N_OBJ_COLOUR$,N_OBJ_LISTBOX_TYPE$,N_OBJ_SEP$,N_OBJ_SCRATCH$,N_OBJ_POPUP$,N_OBJ_SIZING$,N_OBJ_LOGIC1$,N_OBJ_LOGIC2$,N_OBJ_POPUP_LOGIC$,N_OBJ_QRY_BITMAP$,N_OBJ_QRY_WIDTH,N_OBJ_QRY_TIP$,N_OBJ_QRY_ATTR$,N_OBJ_EXTENSION$,N_OBJ_DEMAND$,N_OBJ_DEMAND_LOGIC$,N_OBJ_BACKGROUND_LOGIC$,N_OBJ_PERSISTENCE$
10030 ! new button
10040 COMPARE_ALL:
10050 IF _EOM$<>$0D$ AND _EOM$<>$02$ THEN EXIT 
10060 SELECT_ALL:
10070 IF STP(OLD_LIB$)=STP(NEW_LIB$) THEN GOTO SAME_LIBS
10080 OLD_LIST$="",NEW_LIST$="",COMP_FLG$="CA",LIB_DEF$="1"
10090 OLD_N=0
10100 OLD_N=OLD_N+1
10110 LIST_BOX FIND OLD_PANELS.CTL,OLD_N,OLD_NME$,ERR=10160
10120 IF OLD_NME$="<Library Defaults>" THEN GOTO 10100
10130 OLD_NME$=OLD_NME$(1,POS(" ("=OLD_NME$)-1)
10140 OLD_LIST$=OLD_LIST$+OLD_NME$+SEP
10150 GOTO 10100
10160 IF STP(OLD_LIST$,2)="" THEN GOTO NO_PANELS
10170 NEW_N=0
10180 NEW_N=NEW_N+1
10190 LIST_BOX FIND NEW_PANELS.CTL,NEW_N,NEW_NME$,ERR=10240
10200 IF NEW_NME$="<Library Defaults>" THEN GOTO 10180
10210 NEW_NME$=NEW_NME$(1,POS(" ("=NEW_NME$)-1)
10220 NEW_LIST$=NEW_LIST$+NEW_NME$+SEP
10230 GOTO 10180
10240 IF STP(NEW_LIST$,2)="" THEN GOTO NO_PANELS
10250 RETURN 
10260 ! 
10270 PANEL_MISSING:
10280 P_LINE$="Comparing Panels for "+UID+" on "+DTE(0:"%Ds %Ms %D, %Y %hz:%mz %p"),D_LINE$=P_LINE$; GOSUB DISPLAY_LINE
10290 P_LINE$="Panels: "+COMP_LIBS$,OFS_P=7,D_LINE$=P_LINE$; GOSUB DISPLAY_LINE; GOSUB PRT_BLANK
10300 IF ON_ALL$="OLD" THEN P_LINE$="*** Panel '"+OLD_PANEL_NME$+"' does not exist in "+NEW_LIB$+" ***",D_LINE$=P_LINE$; GOSUB DISPLAY_LINE
10310 IF ON_ALL$="NEW" THEN P_LINE$="*** Panel '"+NEW_PANEL_NME$+"' does not exist in "+OLD_LIB$+" ***",D_LINE$=P_LINE$; GOSUB DISPLAY_LINE
10320 GOSUB PRT_BLANK; GOSUB PRT_ASTR; GOSUB PRT_BLANK
10330 IF COMP_LIBS$<>"" THEN PERFORM "*winproc;refresh_scrn"
10340 COMP_LIB$="",ON_ALL$="",MAX_DIFF_CTR=MAX_DIFF_CTR+1
10350 RETURN 
10360 ! - verify something valued for libraries
10370 VERIFY_LIBS:
10380 IF OLD_ERR$="Y" THEN GOTO 9020
10390 VARDROP_BOX READ OLD_LIB.CTL,L$,ERR=NO_OLD_LIB_MSG
10400 IF STP(L$,2)="" THEN GOTO NO_OLD_LIB_MSG
10410 IF NEW_ERR$="Y" THEN GOTO 9040
10420 VARDROP_BOX READ NEW_LIB.CTL,L$,ERR=NO_NEW_LIB_MSG
10430 IF STP(L$,2)="" THEN GOTO NO_NEW_LIB_MSG
10440 RETURN 
10450 ! 100 - do menu bar items compare
10460 GOT_MENU_BAR_RECORDS:
10470 IF ON_REC$="Menukey " THEN GOTO GOT_MENU_KEY
10480 IF ON_REC$="Menuheader " THEN GOTO GOT_MENU_HEADER
10490 IF ON_REC$="Menuitem " THEN GOTO GOT_MENU_ITEM
10500 RETURN 
10510 GOT_MENU_KEY:
10520 M_NME$=""; IF OBJ_NME$<>"" THEN M_NME$=OBJ_NME$ ELSE IF N_OBJ_NME$<>"" THEN M_NME$=N_OBJ_NME$
10530 ELEM_NME$="Menu Def"; IF OBJ_TYPE$="P" OR N_OBJ_TYPE$="P" THEN ELEM_NME$="Popup "+ELEM_NME$
10540 ELEM_NME$=ELEM_NME$+"  ("+M_NME$+")",ELEM_HDR$=PAD("* "+ELEM_NME$,60),OLD_OPT$="",NEW_OPT$=""
10550 ITEM_NME$=" Element List",ITEM_OLD$=OBJ_TXT$,ITEM_NEW$=N_OBJ_TXT$
10560 IF ITEM_OLD$="" THEN OLD_OPT$="Include HELP"; GOTO 10580
10570 IF ITEM_OLD$(1,1)<>"-" THEN OLD_OPT$="Include HELP" ELSE OLD_OPT$="Suppress HELP"; IF LEN(ITEM_OLD$)>1 THEN ITEM_OLD$=ITEM_OLD$(2) ELSE ITEM_OLD$=""
10580 IF ITEM_NEW$="" THEN NEW_OPT$="Include HELP"; GOTO 10600
10590 IF ITEM_NEW$(1,1)<>"-" THEN NEW_OPT$="Include HELP" ELSE NEW_OPT$="Suppress HELP"; IF LEN(ITEM_NEW$)>1 THEN ITEM_NEW$=ITEM_NEW$(2) ELSE ITEM_NEW$=""
10600 GOSUB COMPARE_RTN
10610 ITEM_NME$=" Options",ITEM_OLD$=OLD_OPT$,ITEM_NEW$=NEW_OPT$; GOSUB COMPARE_RTN
10620 RETURN 
10630 GOT_MENU_HEADER:
10640 ELEM_NME$="Menu <Top Level>"; IF OBJ_TYPE$="P" OR N_OBJ_TYPE$="P" THEN ELEM_NME$="Popup "+ELEM_NME$
10650 ELEM_HDR$=PAD("* "+ELEM_NME$,60)
10660 ITEM_NME$=" Text",ITEM_OLD$=OBJ_TXT$,ITEM_NEW$=N_OBJ_TXT$; GOSUB COMPARE_RTN
10670 ITEM_NME$=" Type"; IF OBJ_SEL$="G" THEN ITEM_OLD$="Group" ELSE IF OBJ_SEL$="I" OR OBJ_SEL$="" THEN ITEM_OLD$="Item" ELSE ITEM_OLD$=OBJ_SEL$
10680 IF N_OBJ_SEL$="G" THEN ITEM_NEW$="Group" ELSE IF N_OBJ_SEL$="I" OR N_OBJ_ITEM$="" THEN ITEM_NEW$="Item" ELSE ITEM_NEW$=N_OBJ_SEL$
10690 GOSUB COMPARE_RTN
10700 ITEM_NME$=" Options"; IF OBJ_MSG$="-" THEN ITEM_OLD$="Suppress HELP" ELSE IF OBJ_MSG$="" OR OBJ_MSG$=" " THEN ITEM_OLD$="Include HELP" ELSE ITEM_OLD$=OBJ_MSG$
10710 IF N_OBJ_MSG$="-" THEN ITEM_NEW$="Suppress HELP" ELSE IF N_OBJ_MSG$="" OR N_OBJ_MSG$=" " THEN ITEM_NEW$="Include HELP" ELSE ITEM_NEW$=N_OBJ_MSG$
10720 GOSUB COMPARE_RTN
10730 RETURN 
10740 GOT_MENU_ITEM:
10750 M_NME$=""; IF OBJ_NME$<>"" THEN M_NME$=OBJ_NME$ ELSE IF N_OBJ_NME$<>"" THEN M_NME$=N_OBJ_NME$
10760 ELEM_NME$="Menu Item"; IF OBJ_TYPE$="P" OR N_OBJ_TYPE$="P" THEN ELEM_NME$="Popup "+ELEM_NME$
10770 ELEM_NME$=ELEM_NME$+" ("+M_NME$+")    "
10780 IF OBJ_TXT$<>"" THEN ELEM_NME$=ELEM_NME$+OBJ_TXT$ ELSE IF N_OBJ_TXT$<>OBJ_TXT$ THEN ELEM_NME$=ELEM_NME$+N_OBJ_TXT$
10790 ELEM_HDR$=PAD("* "+ELEM_NME$,60),OLD_OPT$="",NEW_OPT$=""
10800 ITEM_NME$=" Text",ITEM_OLD$=OBJ_TXT$,ITEM_NEW$=N_OBJ_TXT$; GOSUB COMPARE_RTN
10810 ITEM_NME$=" Type"; IF OBJ_SEL$="G" THEN ITEM_OLD$="Group"; GOTO 10840
10820 IF OBJ_SEL$="I" OR OBJ_SEL$="" THEN ITEM_OLD$="Item"; GOTO 10840
10830 IF OBJ_SEL$<>"" THEN IF POS(OBJ_SEL$(1,1):"PXECL")<>0 THEN OLD_OPT$=OBJ_SEL$,ITEM_OLD$="Item"
10840 IF N_OBJ_SEL$="G" THEN ITEM_NEW$="Group"; GOTO 10870
10850 IF N_OBJ_SEL$="I" OR N_OBJ_SEL$="" THEN ITEM_NEW$="Item"; GOTO 10870
10860 IF N_OBJ_SEL$<>"" THEN IF POS(N_OBJ_SEL$(1,1):"PXECL")<>0 THEN NEW_OPT$=N_OBJ_SEL$,ITEM_NEW$="Item"
10870 GOSUB COMPARE_RTN
10880 ITEM_NME$=" Function",ITEM_OLD$=OLD_OPT$,ITEM_NEW$=NEW_OPT$
10890 IF ITEM_OLD$<>"" THEN CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_logic"; GOSUB CALL_LIBUTILS; GOSUB ADJUST_CONV_LOGIC; IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
10900 IF ITEM_NEW$<>"" THEN CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_logic"; GOSUB CALL_LIBUTILS; GOSUB ADJUST_CONV_LOGIC; IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
10910 GOSUB COMPARE_RTN
10920 ! obj_val
10930 ITEM_NME$=" Menu Options",ITEM_OLD$=OBJ_VAL$,ITEM_NEW$=N_OBJ_VAL$; IF ITEM_OLD$<>"" THEN CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_obj_val"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
10940 IF ITEM_NEW$<>"" THEN CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_obj_val"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
10950 GOSUB COMPARE_RTN
10960 ! obj_msg$
10970 ITEM_NME$=" Options"; IF OBJ_MSG$="," THEN ITEM_OLD$="Line Separator" ELSE IF OBJ_MSG$=" " OR OBJ_MSG$="" THEN ITEM_OLD$="No Line Separator" ELSE ITEM_OLD$=OBJ_MSG$
10980 IF N_OBJ_MSG$="," THEN ITEM_NEW$="Line Separator" ELSE IF N_OBJ_MSG$=" " OR N_OBJ_MSG$="" THEN ITEM_NEW$="No Line Separator" ELSE ITEM_NEW$=N_OBJ_MSG$
10990 GOSUB COMPARE_RTN
11000 ! level
11010 ITEM_NME$=" Level",ITEM_OLD$="",ITEM_NEW$=""
11020 IF OBJ_IDX$<>"0" THEN ITEM_OLD$=OBJ_IDX$
11030 IF N_OBJ_IDX$<>"0" THEN ITEM_NEW$=N_OBJ_IDX$
11040 GOSUB COMPARE_RTN
11050 ! obj_dsp$
11060 ITEM_NME$=" External PGM",ITEM_OLD$=OBJ_DSP$,ITEM_NEW$=N_OBJ_DSP$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
11070 ! obj_def$
11080 ITEM_NME$=" MenuLink",ITEM_OLD$="No",ITEM_NEW$="No"
11090 IF OBJ_DEF$="L" THEN ITEM_OLD$="Yes"
11100 IF N_OBJ_DEF$="L" THEN ITEM_NEW$="Yes"
11110 GOSUB COMPARE_RTN
11111 ! obj_tbl$
11112 ITEM_NME$=" Menu Item Bitmap",ITEM_OLD$=OBJ_TBL$,ITEM_NEW$=N_OBJ_TBL$; GOSUB COMPARE_RTN
11120 ! obj_null$
11130 ITEM_NME$=" M-Link Pgm",ITEM_OLD$=OBJ_NULL$,ITEM_NEW$=N_OBJ_NULL$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
11140 RETURN 
11150 ! 10000 - Library Defaults
11160 ! get lib default rec
11170 CHK_LIB_DEFAULT:
11180 IF LIB_DEF$<>"1" THEN RETURN ! no Lib def selected
11190 IF OLD_LIB$=NEW_LIB$ THEN RETURN ! libraries are same
11200 LIB_KEY$=PAD(" ",12)+"0000"
11210 ON_REC$="Libdef",COMP$="C"
11220 PRT_MAX=500,PRT_BOTH_CTR=0
11230 DIM PRT_BOTH$[1500]
11240 GOSUB INIT_OLD_ELEM
11250 GOSUB INIT_NEW_ELEM
11260 READ (LIB_FN,KEY=LIB_KEY$,ERR=*NEXT)IOL=10010; GOTO 11300
11270 LIB_KEY$=""; READ (LIB_FN,KEY=LIB_KEY$,ERR=*NEXT)IOL=10010; GOTO 11290 ! no lib def record, get the one with no blanks
11280 ! gOTO 7050 ! no lib def record
11290 LIB_KEY$=PAD(" ",12)+"0000"
11300 READ (NEW_FN,KEY=LIB_KEY$,ERR=*NEXT)IOL=10020; GOTO 11330
11310 LIB_KEY$=""; READ (NEW_FN,KEY=LIB_KEY$,ERR=*NEXT)IOL=10020; GOTO 11330 ! no lib def record, get the one with no blanks
11320 ! GOTO 7050 ! no lib def record
11330 GOSUB COMPARE_LIB_DEFAULTS
11340 GOSUB PROCESS_DISPLAY_LIB
11350 RETURN 
11400 ! ^100 - Lib Default Records
11410 COMPARE_LIB_DEFAULTS:
11420 ELEM_NME$="Library Defaults",ELEM_HDR$=PAD("* "+ELEM_NME$,60)
11430 ITEM_NME$=" Prefix",ITEM_OLD$=OBJ_NME$,ITEM_NEW$=N_OBJ_NME$; GOSUB COMPARE_RTN
11440 ITEM_NME$=" Description",ITEM_OLD$=OBJ_TXT$,ITEM_NEW$=N_OBJ_TXT$; GOSUB COMPARE_RTN
11450 ITEM_NME$=" Directory",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB COMPARE_RTN
11460 ITEM_NME$=" Message"
11470 IF N_OBJ_MSG$="" THEN IF OBJ_MSG$<>"" THEN IF OBJ_MSG$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"; GOTO 11490
11480 IF N_OBJ_MSG$<>"" THEN IF N_OBJ_MSG$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
11490 ITEM_OLD$=OBJ_MSG$,ITEM_NEW$=N_OBJ_MSG$; GOSUB COMPARE_RTN
11491 ITEM_NME$=" User Def Tag"
11492 IF N_OBJ_TAG$="" THEN IF OBJ_TAG$<>"" THEN IF MID(OBJ_MSG$,1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
11493 IF N_OBJ_TAG$<>"" THEN IF N_OBJ_TAG$(1,1)="=" THEN ITEM_NME$=ITEM_NME$+" Exp"
11494 ITEM_OLD$=OBJ_TAG$,ITEM_NEW$=N_OBJ_TAG$; GOSUB COMPARE_RTN
11500 ITEM_NME$=" Help",ITEM_OLD$=OBJ_HLP$,ITEM_NEW$=N_OBJ_HLP$; GOSUB HELP_ADJUST_RTN; GOSUB COMPARE_RTN
11510 ITEM_NME$=" User DD I/F",ITEM_OLD$=OBJ_QRY$,ITEM_NEW$=N_OBJ_QRY$; GOSUB COMPARE_RTN
11511 ITEM_NME$=" Lib Custom Info",ITEM_OLD$=OBJ_EXTENSION$,ITEM_NEW$=N_OBJ_EXTENSION$; GOSUB COMPARE_RTN
11520 ITEM_NME$=" Font",ITEM_OLD$=OBJ_FONT$,ITEM_NEW$=N_OBJ_FONT$; GOSUB FONT_TBL_RTN; GOSUB COMPARE_RTN
11530 ITEM_NME$=" Colour",ITEM_OLD$=OBJ_COLOUR$,ITEM_NEW$=N_OBJ_COLOUR$; GOSUB COLOUR_TBL_RTN; GOSUB COMPARE_RTN
11540 ITEM_NME$=" Visual Effects",ITEM_OLD$=OBJ_HOTKEY$,ITEM_NEW$=N_OBJ_HOTKEY$
11550 IF ITEM_OLD$<>"" THEN CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_obj_hotkey"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
11560 IF ITEM_NEW$<>"" THEN CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_obj_hotkey"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
11570 GOSUB COMPARE_RTN
11590 RETURN 
11600 ! ^ 100 - display library default info if lib_def$=1
11610 PROCESS_DISPLAY_LIB:
11620 MAX_DIFF_CTR=MAX_DIFF_CTR+1
11630 IF SHOW_CHKBX$="0" AND PRT_BOTH_CTR=0 THEN RETURN 
11640 P_LINE$="Comparing Library Defaults for "+UID+" on "+DTE(0:"%Ds %Ms %D, %Y %hz:%mz %p"),D_LINE$=P_LINE$; GOSUB DISPLAY_LINE; GOSUB PRT_BLANK
11650 D_LINE$="Old Library:"+QUO+STP(OLD_LIB$)+QUO
11660 P_LINE$="Old Library: "+OLD_LIB$,OFS_P=7; GOSUB DISPLAY_LINE; OFS_P=22
11670 D_LINE$="New Library:"+QUO+STP(NEW_LIB$)+QUO
11680 P_LINE$="New Library: "+NEW_LIB$,OFS_P=7; GOSUB DISPLAY_LINE; OFS_P=22; GOSUB PRT_BLANK
11690 IF PRT_BOTH_CTR=0 THEN P_LINE$="*** No differences between Library Defaults ***",D_LINE$=P_LINE$; GOSUB DISPLAY_LINE; GOSUB PRT_BLANK; GOSUB PRT_ASTR; GOSUB PRT_BLANK; GOTO 11750 ELSE P_LINE$="*** Differences in Library Defaults ***",D_LINE$=P_LINE$; GOSUB DISPLAY_LINE
11700 D_CTR=0,OFS_P=23
11710 D_CTR=D_CTR+1; IF D_CTR>PRT_BOTH_CTR THEN GOSUB PRT_BLANK; GOSUB PRT_ASTR; GOSUB PRT_BLANK; OFS_P=22; GOTO 11750
11720 IF POS(" was "+QUO=PRT_BOTH$[D_CTR])=19 THEN GOSUB PRT_BLANK
11730 P_LINE$=PRT_BOTH$[D_CTR],D_LINE$=P_LINE$
11740 GOSUB DISPLAY_LINE; GOTO 11710
11750 RETURN 
11760 ! 
11770 ADD_EXP:
11780 ADD_EXP$=""
11790 IF ITEM_NEW$="" THEN IF ITEM_OLD$<>"" THEN IF ITEM_OLD$(1,1)="=" THEN ADD_EXP$=" Exp"
11800 IF ITEM_NEW$<>"" THEN IF ITEM_NEW$(1,1)="=" THEN ADD_EXP$=" Exp"
11810 IF ADD_EXP$<>"" THEN ITEM_NME$=ITEM_NME$+ADD_EXP$
11820 RETURN 
11830 ! 11000 - On Query
11840 GOT_QUERY_RECORDS:
11850 IF UCS(OBJ_TYPE$)="Q" OR UCS(N_OBJ_TYPE$)="Q" THEN GOSUB DO_QUERY_HEADER; RETURN 
11860 IF OBJ_TYPE$="E" OR N_OBJ_TYPE$="E" THEN GOSUB DO_QUERY_ELEMENT; RETURN 
11870 IF OBJ_TYPE$="+" OR N_OBJ_TYPE$="+" THEN GOSUB DO_QUERY_FORMULA; RETURN 
11880 IF OBJ_TYPE$="S" OR N_OBJ_TYPE$="S" THEN GOSUB DO_QUERY_SELECTION; RETURN 
11890 IF OBJ_TYPE$="U" OR N_OBJ_TYPE$="U" THEN GOSUB DO_QUERY_USER; RETURN 
11900 IF OBJ_TYPE$="O" OR N_OBJ_TYPE$="O" THEN GOSUB DO_QUERY_LINK; RETURN 
11910 RETURN 
11920 ! Query Header record
11930 DO_QUERY_HEADER:
11940 Q_LIST$=""; IF OBJ_TYPE$="q" OR N_OBJ_TYPE$="q" THEN ELEM_NME$="Query List Header",Q_LIST$="Y" ELSE ELEM_NME$="Query Header"
11950 ELEM_HDR$=PAD("* "+ELEM_NME$,60)
11960 ITEM_NME$=" Type",ITEM_OLD$=TBL(OBJ_TYPE$="Q","Query List","Standard Query"),ITEM_NEW$=TBL(N_OBJ_TYPE$="Q","Query List","Standard Query"); GOSUB COMPARE_RTN ! !!!!!!!!!!!!
11970 ITEM_NME$=" Title",ITEM_OLD$=OBJ_TXT$,ITEM_NEW$=N_OBJ_TXT$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
11980 ITEM_NME$=" Column",ITEM_OLD$=STR(OBJ_C),ITEM_NEW$=STR(N_OBJ_C); GOSUB COMPARE_RTN
11990 ITEM_NME$=" Line",ITEM_OLD$=STR(OBJ_L),ITEM_NEW$=STR(N_OBJ_L); GOSUB COMPARE_RTN
12000 ITEM_NME$=" Width",ITEM_OLD$=STR(OBJ_W),ITEM_NEW$=STR(N_OBJ_W); GOSUB COMPARE_RTN
12010 ITEM_NME$=" Height",ITEM_OLD$=STR(OBJ_H),ITEM_NEW$=STR(N_OBJ_H); GOSUB COMPARE_RTN
12020 ITEM_NME$=" File/Path/Tbl",ITEM_OLD$=OBJ_NME$,ITEM_NEW$=N_OBJ_NME$; GOSUB COMPARE_RTN
12030 ITEM_NME$=" Sort Key#",ITEM_OLD$=OBJ_VAL$,ITEM_NEW$=N_OBJ_VAL$; GOSUB COMPARE_RTN
12040 ITEM_NME$=" Autotab",ITEM_OLD$=STR(OBJ_TAB),ITEM_NEW$=STR(N_OBJ_TAB)
12050 IF OBJ_TAB$="0" THEN ITEM_OLD$="Off" ELSE IF OBJ_TAB$="1" THEN ITEM_OLD$="On"
12060 IF N_OBJ_TAB$="0" THEN ITEM_NEW$="Off" ELSE IF N_OBJ_TAB$="1" THEN ITEM_NEW$="On"
12070 GOSUB COMPARE_RTN
12080 ITEM_NME$=" Phys/Database",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
12090 ITEM_NME$=" Message",ITEM_OLD$=OBJ_MSG$,ITEM_NEW$=N_OBJ_MSG$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
12100 ITEM_NME$=" Help",ITEM_OLD$=OBJ_HLP$,ITEM_NEW$=N_OBJ_HLP$; GOSUB HELP_ADJUST_RTN; GOSUB COMPARE_RTN
12110 ITEM_NME$=" Attributes",ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$
12120 ! chk for 'Font' 'Mode'
12130 GOSUB ATTR_PARSE_RTN
12140 IF OLD_A$="Y" AND NEW_A$="Y" THEN GOTO 12170
12150 IF OLD_A$="Y" AND NEW_A$="" THEN OBJ_ATTR$="",ITEM_OLD$=""
12160 IF NEW_A$="Y" AND OLD_A$="" THEN N_OBJ_ATTR$="",ITEM_NEW$=""
12170 ITEM_NME$=" Attributes"; GOSUB COMPARE_RTN
12180 ITEM_NME$=" User DD",ITEM_OLD$=OBJ_IDX$,ITEM_NEW$=N_OBJ_IDX$; GOSUB COMPARE_RTN
12190 ITEM_NME$=" Date Stamp"; ITEM_OLD$=OBJ_HOTKEY$,ITEM_NEW$=N_OBJ_HOTKEY$; GOSUB COMPARE_RTN
12200 ITEM_NME$=" Update Id",ITEM_OLD$=OBJ_VALID$,ITEM_NEW$=N_OBJ_VALID$; GOSUB COMPARE_RTN
12210 ITEM_NME$=" Prog/Panel",ITEM_OLD$=OBJ_QRY$,ITEM_NEW$=N_OBJ_QRY$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
12220 ITEM_NME$=" Display Opt",ITEM_OLD$="",ITEM_NEW$="" ! ,OBJ_STS$,ITEM_NEW$=N_OBJ_STS$; GOSUB COMPARE_RTN
12230 CONV_F$=OBJ_STS$; GOSUB CHK_QUERY_STS; ITEM_OLD$=CONV_V$,CONV_F$=OBJ_NULL$; GOSUB CHK_QUERY_NULL; IF CONV_V$<>"" THEN ITEM_OLD$=ITEM_OLD$+CONV_V$
12240 IF ITEM_OLD$<>"" THEN ITEM_OLD$=ITEM_OLD$(3)
12250 IF CONV_V2$<>"" THEN OBJ_NULL$=CONV_V2$(3) ELSE OBJ_NULL$=""
12260 ! 
12270 CONV_F$=N_OBJ_STS$; GOSUB CHK_QUERY_STS; ITEM_NEW$=CONV_V$,CONV_F$=N_OBJ_NULL$; GOSUB CHK_QUERY_NULL; IF CONV_V$<>"" THEN ITEM_NEW$=ITEM_NEW$+CONV_V$
12280 IF ITEM_NEW$<>"" THEN ITEM_NEW$=ITEM_NEW$(3)
12290 IF CONV_V2$<>"" THEN N_OBJ_NULL$=CONV_V2$(3) ELSE N_OBJ_NULL$=""
12300 GOSUB COMPARE_RTN
12310 ITEM_NME$=" Table Key",ITEM_OLD$=OBJ_GRP$,ITEM_NEW$=N_OBJ_GRP$; GOSUB COMPARE_RTN
12320 ITEM_NME$=" File Options",ITEM_OLD$=OBJ_NULL$,ITEM_NEW$=N_OBJ_NULL$; GOSUB COMPARE_RTN
12330 ITEM_NME$=" Init Procedure",ITEM_OLD$=OBJ_DSP$,ITEM_NEW$=N_OBJ_DSP$; GOSUB COMPARE_RTN
12340 ITEM_NME$=" Static cols#",ITEM_OLD$=OBJ_TAG$,ITEM_NEW$=N_OBJ_TAG$; GOSUB COMPARE_RTN
12350 ITEM_NME$=" Connect Opt",ITEM_OLD$=OBJ_TBL$,ITEM_NEW$=N_OBJ_TBL$; GOSUB COMPARE_RTN
12360 ITEM_NME$=" Return val def",ITEM_OLD$=OBJ_CLASS$,ITEM_NEW$=N_OBJ_CLASS$; GOSUB COMPARE_RTN
12370 ITEM_NME$=" FileID Prefix",ITEM_OLD$=OBJ_TIP$,ITEM_NEW$=N_OBJ_TIP$; GOSUB COMPARE_RTN
12380 ITEM_NME$=" Colour",ITEM_OLD$=OBJ_COLOUR$,ITEM_NEW$=N_OBJ_COLOUR$; GOSUB COLOUR_TBL_RTN; GOSUB COMPARE_RTN
12390 ITEM_NME$=" Font",ITEM_OLD$=OBJ_FONT$,ITEM_NEW$=N_OBJ_FONT$; GOSUB FONT_TBL_RTN; GOSUB COMPARE_RTN
12400 ! not used at this time for Query Header
12410 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_FCS$,ITEM_NEW$=N_OBJ_FCS$; GOSUB COMPARE_RTN
12420 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEL$,ITEM_NEW$=N_OBJ_SEL$; GOSUB COMPARE_RTN
12430 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEC$,ITEM_NEW$=N_OBJ_SEC$; GOSUB COMPARE_RTN
12440 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_INP$,ITEM_NEW$=N_OBJ_INP$; GOSUB COMPARE_RTN
12450 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_OUT$,ITEM_NEW$=N_OBJ_OUT$; GOSUB COMPARE_RTN
12460 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_ORIG$,ITEM_NEW$=N_OBJ_ORIG$; GOSUB COMPARE_RTN
12470 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LISTBOX_TYPE$,ITEM_NEW$=N_OBJ_LISTBOX_TYPE$; GOSUB COMPARE_RTN
12480 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEP$,ITEM_NEW$=N_OBJ_SEP$; GOSUB COMPARE_RTN
12490 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SCRATCH$,ITEM_NEW$=N_OBJ_SCRATCH$; GOSUB COMPARE_RTN
12500 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_POPUP$,ITEM_NEW$=N_OBJ_POPUP$; GOSUB COMPARE_RTN
12510 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SIZING$,ITEM_NEW$=N_OBJ_OBJ_SIZING$; GOSUB COMPARE_RTN
12520 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LOGIC1$,ITEM_NEW$=N_OBJ_LOGIC1$; GOSUB COMPARE_RTN
12530 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LOGIC2$,ITEM_NEW$=N_OBJ_LOGIC2$; GOSUB COMPARE_RTN
12540 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_POPUP_LOGIC$,ITEM_NEW$=N_OBJ_POPUUP_LOGIC$; GOSUB COMPARE_RTN
12550 RETURN 
12560 ! 
12570 CHK_QUERY_STS:
12580 CONV_V$=""
12590 IF POS("="=CONV_F$)>0 THEN CONV_V$=", Grey/White Display"
12600 IF POS("+"=CONV_F$)>0 THEN CONV_V$=CONV_V$+", Centred panel"
12610 IF POS("R"=CONV_F$)>0 THEN CONV_V$=CONV_V$+", Relative panel"
12620 RETURN 
12630 CHK_QUERY_NULL:
12640 CONV_V$="",CONV_V2$=""
12650 ! build conv_v$
12660 IF POS("C"=CONV_F$)>0 THEN CONV_V$=CONV_V$+", Case sensitive 'Start At' value"
12670 IF POS("U"=CONV_F$)>0 THEN CONV_V$=CONV_V$+", Uppercase 'Start At' value"
12680 IF POS("L"=CONV_F$)>0 THEN CONV_V$=CONV_V$+", Lowercase 'Start At' value"
12690 IF POS("P"=CONV_F$)>0 THEN CONV_V$=CONV_V$+", No print button"
12700 IF POS("K"=CONV_F$)>0 THEN CONV_V$=CONV_V$+", No sort by"
12710 ! build conv_v2$
12720 IF POS("M"=CONV_F$)>0 THEN CONV_V2$=CONV_V2$+", Sort by Column"
12730 IF POS("O"=CONV_F$)>0 THEN CONV_V2$=CONV_V2$+", ODBC Access"
12740 IF POS("R"=CONV_F$)>0 THEN CONV_V2$=CONV_V2$+", Read by record"
12750 IF POS("S"=CONV_F$)>0 THEN CONV_V2$=CONV_V2$+", Switch scroll bar (large file)"
12760 IF POS("V"=CONV_F$)>0 THEN CONV_V2$=CONV_V2$+", No return value"
12770 RETURN 
12780 ! Query Element = obj_type="E"
12790 DO_QUERY_ELEMENT:
12800 E_NME$=""
12810 IF OBJ_TIP$+OBJ_NME$<>"" THEN E_NME$=OBJ_TIP$+"."+OBJ_NME$
12820 IF N_OBJ_TIP$+N_OBJ_NME$<>"" AND N_OBJ_TIP$+"."+N_OBJ_NME$<>E_NME$ THEN E_NME$=N_OBJ_TIP$+"."+N_OBJ_NME$
12830 IF POS("_MN_"=E_NME$)>0 THEN IF LEN(E_NME$)>5 THEN E_NME$=E_NME$(6)
12840 IF STP(E_NME$,2)<>"" THEN E_NME$=" ("+E_NME$+")"
12850 ELEM_NME$=TBL(Q_LIST$="Y","Query Element","Query List Element"),ELEM_HDR$=PAD("* "+ELEM_NME$+E_NME$,60)
12860 ITEM_NME$=" Column Title",ITEM_OLD$=OBJ_TXT$,ITEM_NEW$=N_OBJ_TXT$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
12870 ITEM_NME$=" Column Width",ITEM_OLD$=STR(OBJ_W),ITEM_NEW$=STR(N_OBJ_W); GOSUB COMPARE_RTN
12880 ITEM_NME$=" Element Name",ITEM_OLD$=OBJ_NME$,ITEM_NEW$=N_OBJ_NME$; GOSUB COMPARE_RTN
12890 ITEM_NME$=" Data Type",ITEM_OLD$=OBJ_VAL$,ITEM_NEW$=N_OBJ_VAL$; GOSUB COMPARE_RTN
12900 ITEM_NME$=" Col Format",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
12910 ITEM_NME$=" Sort Algorithm",ITEM_OLD$=OBJ_DSP$,ITEM_NEW$=N_OBJ_DSP$; GOSUB COMPARE_RTN
12920 ITEM_NME$=" Sort Key Len",ITEM_OLD$=OBJ_FCS$,ITEM_NEW$=N_OBJ_FCS$; GOSUB COMPARE_RTN
12930 ITEM_NME$=" Column Query",ITEM_OLD$=OBJ_QRY$,ITEM_NEW$=N_OBJ_QRY$; GOSUB COMPARE_RTN
12940 ITEM_NME$="  Tip Flags",ITEM_OLD$=OBJ_STS$,ITEM_NEW$=N_OBJ_STS$
12950 IF ITEM_OLD$<>"" THEN CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_qry_elem_sts"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
12960 IF ITEM_NEW$<>"" THEN CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_qry_elem_sts"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
12970 GOSUB COMPARE_RTN
12980 ITEM_NME$=" Format Prg",ITEM_OLD$=OBJ_OUT$,ITEM_NEW$=N_OBJ_OUT$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
12990 ITEM_NME$=" Element Prefix",ITEM_OLD$=OBJ_TIP$,ITEM_NEW$=N_OBJ_TIP$; GOSUB COMPARE_RTN
13000 ! not used at this time for Query Element
13010 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_C$,ITEM_NEW$=N_OBJ_C$; GOSUB COMPARE_RTN
13020 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_L$,ITEM_NEW$=N_OBJ_L$; GOSUB COMPARE_RTN
13030 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_H$,ITEM_NEW$=N_OBJ_H$; GOSUB COMPARE_RTN
13040 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TAB$,ITEM_NEW$=N_OBJ_TAB$; GOSUB COMPARE_RTN
13050 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEL$,ITEM_NEW$=N_OBJ_SEL$; GOSUB COMPARE_RTN
13060 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_MSG$,ITEM_NEW$=N_OBJ_MSG$; GOSUB COMPARE_RTN
13070 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_HLP$,ITEM_NEW$=N_OBJ_HLP$; GOSUB COMPARE_RTN
13080 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$; GOSUB COMPARE_RTN
13090 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_IDX$,ITEM_NEW$=N_OBJ_IDX$; GOSUB COMPARE_RTN
13100 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_HOTKEY$,ITEM_NEW$=N_OBJ_HOTKEY$; GOSUB COMPARE_RTN
13110 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEC$,ITEM_NEW$=N_OBJ_SEC$; GOSUB COMPARE_RTN
13120 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_GRP$,ITEM_NEW$=N_OBJ_GRP$; GOSUB COMPARE_RTN
13130 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_NULL$,ITEM_NEW$=N_OBJ_NULL$; GOSUB COMPARE_RTN
13140 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TAG$,ITEM_NEW$=N_OBJ_TAG$; GOSUB COMPARE_RTN
13150 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TBL$,ITEM_NEW$=N_OBJ_TBL$; GOSUB COMPARE_RTN
13160 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_INP$,ITEM_NEW$=N_OBJ_INP$; GOSUB COMPARE_RTN
13170 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_VALID$,ITEM_NEW$=N_OBJ_VALID$; GOSUB COMPARE_RTN
13180 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_CLASS$,ITEM_NEW$=N_OBJ_CLASS$; GOSUB COMPARE_RTN
13190 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_ORIG$,ITEM_NEW$=N_OBJ_ORIG$; GOSUB COMPARE_RTN
13200 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_FONT$,ITEM_NEW$=N_OBJ_FONT$; GOSUB COMPARE_RTN
13210 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_COLOUR$,ITEM_NEW$=N_OBJ_COLOUR$; GOSUB COMPARE_RTN
13220 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LISTBOX_TYPE$,ITEM_NEW$=N_OBJ_LISTBOX_TYPE$; GOSUB COMPARE_RTN
13230 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEP$,ITEM_NEW$=N_OBJ_SEP$; GOSUB COMPARE_RTN
13240 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SCRATCH$,ITEM_NEW$=N_OBJ_SCRATCH$; GOSUB COMPARE_RTN
13250 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_POPUP$,ITEM_NEW$=N_OBJ_POPUP$; GOSUB COMPARE_RTN
13260 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SIZING$,ITEM_NEW$=N_OBJ_SIZING$; GOSUB COMPARE_RTN
13270 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LOGIC1$,ITEM_NEW$=N_OBJ_LOGIC1$; GOSUB COMPARE_RTN
13280 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LOGIC2$,ITEM_NEW$=N_OBJ_LOGIC2$; GOSUB COMPARE_RTN
13290 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_POPUP_LOGIC$,ITEM_NEW$=N_OBJ_POPUP_LOGIC$; GOSUB COMPARE_RTN
13300 RETURN 
13310 ! Query Formula records - obj_type="+"
13320 DO_QUERY_FORMULA:
13330 E_NME$=""; IF OBJ_TIP$+OBJ_NME$<>"" THEN E_NME$=OBJ_NME$
13340 IF N_OBJ_TIP$+N_OBJ_NME$<>"" AND N_OBJ_TIP$+"."+N_OBJ_NME$<>E_NME$ THEN E_NME$=N_OBJ_NME$
13350 IF STP(E_NME$)<>"" THEN E_NME$=" ("+E_NME$+")"
13360 ELEM_NME$=TBL(Q_LIST$="Y","Query Formula","Query List Formula"),ELEM_HDR$=PAD("* "+ELEM_NME$+E_NME$,60)
13370 ITEM_NME$=" Col Title",ITEM_OLD$=OBJ_TXT$,ITEM_NEW$=N_OBJ_TXT$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
13380 ITEM_NME$=" Column Width",ITEM_OLD$=STR(OBJ_W),ITEM_NEW$=STR(N_OBJ_W); GOSUB COMPARE_RTN
13390 ITEM_NME$=" Formula Def",ITEM_OLD$=OBJ_NME$,ITEM_NEW$=N_OBJ_NME$; GOSUB COMPARE_RTN
13400 ITEM_NME$=" Data Type",ITEM_OLD$=OBJ_VAL$,ITEM_NEW$=N_OBJ_VAL$; GOSUB COMPARE_RTN
13410 ITEM_NME$=" Column Format",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB COMPARE_RTN
13420 ITEM_NME$=" Sort Algorithm",ITEM_OLD$=OBJ_DSP$,ITEM_NEW$=N_OBJ_DSP$; GOSUB COMPARE_RTN
13430 ITEM_NME$=" Sort Key Len",ITEM_OLD$=OBJ_FCS$,ITEM_NEW$=N_OBJ_FCS$; GOSUB COMPARE_RTN
13440 ITEM_NME$="  Tip Flags",ITEM_OLD$=OBJ_STS$,ITEM_NEW$=N_OBJ_STS$
13450 IF ITEM_OLD$<>"" THEN CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_qry_elem_sts"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
13460 IF ITEM_NEW$<>"" THEN CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_qry_elem_sts"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
13470 GOSUB COMPARE_RTN
13480 ITEM_NME$=" Format Prg",ITEM_OLD$=OBJ_OUT$,ITEM_NEW$=N_OBJ_OUT$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
13490 ! not used at this time for Query Formula
13500 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_C$,ITEM_NEW$=N_OBJ_C$; GOSUB COMPARE_RTN
13510 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_L$,ITEM_NEW$=N_OBJ_L$; GOSUB COMPARE_RTN
13520 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_H$,ITEM_NEW$=N_OBJ_H$; GOSUB COMPARE_RTN
13530 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TAB$,ITEM_NEW$=N_OBJ_TAB$; GOSUB COMPARE_RTN
13540 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEL$,ITEM_NEW$=N_OBJ_SEL$; GOSUB COMPARE_RTN
13550 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_MSG$,ITEM_NEW$=N_OBJ_MSG$; GOSUB COMPARE_RTN
13560 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_HLP$,ITEM_NEW$=N_OBJ_HLP$; GOSUB COMPARE_RTN
13570 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$; GOSUB COMPARE_RTN
13580 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_IDX$,ITEM_NEW$=N_OBJ_IDX$; GOSUB COMPARE_RTN
13590 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_HOTKEY$,ITEM_NEW$=N_OBJ_HOTKEY$; GOSUB COMPARE_RTN
13600 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_QRY$,ITEM_NEW$=N_OBJ_QRY$; GOSUB COMPARE_RTN
13610 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEC$,ITEM_NEW$=N_OBJ_SEC$; GOSUB COMPARE_RTN
13620 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_GRP$,ITEM_NEW$=N_OBJ_GRP$; GOSUB COMPARE_RTN
13630 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_NULL$,ITEM_NEW$=N_OBJ_NULL$; GOSUB COMPARE_RTN
13640 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TAG$,ITEM_NEW$=N_OBJ_TAG$; GOSUB COMPARE_RTN
13650 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TBL$,ITEM_NEW$=N_OBJ_TBL$; GOSUB COMPARE_RTN
13660 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_INP$,ITEM_NEW$=N_OBJ_INP$; GOSUB COMPARE_RTN
13670 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_VALID$,ITEM_NEW$=N_OBJ_VALID$; GOSUB COMPARE_RTN
13680 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_CLASS$,ITEM_NEW$=N_OBJ_CLASS$; GOSUB COMPARE_RTN
13690 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TIP$,ITEM_NEW$=N_OBJ_TIP$; GOSUB COMPARE_RTN
13700 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_ORIG$,ITEM_NEW$=N_OBJ_ORIG$; GOSUB COMPARE_RTN
13710 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_FONT$,ITEM_NEW$=N_OBJ_FONT$; GOSUB COMPARE_RTN
13720 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_COLOUR$,ITEM_NEW$=N_OBJ_COLOUR$; GOSUB COMPARE_RTN
13730 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LISTBOX_TYPE$,ITEM_NEW$=N_OBJ_LISTBOX_TYPE$; GOSUB COMPARE_RTN
13740 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEP$,ITEM_NEW$=N_OBJ_SEP$; GOSUB COMPARE_RTN
13750 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SCRATCH$,ITEM_NEW$=N_OBJ_SCRATCH$; GOSUB COMPARE_RTN
13760 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_POPUP$,ITEM_NEW$=N_OBJ_POPUP$; GOSUB COMPARE_RTN
13770 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SIZING$,ITEM_NEW$=N_OBJ_SIZING$; GOSUB COMPARE_RTN
13780 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LOGIC1$,ITEM_NEW$=N_OBJ_LOGIC1$; GOSUB COMPARE_RTN
13790 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LOGIC2$,ITEM_NEW$=N_OBJ_LOGIC2$; GOSUB COMPARE_RTN
13800 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_POPUP_LOGIC$,ITEM_NEW$=N_OBJ_POPUP_LOGIC$; GOSUB COMPARE_RTN
13810 RETURN 
13820 ! Query Selection obj_type="S"
13830 DO_QUERY_SELECTION:
13840 E_NME$=""; IF OBJ_TIP$+OBJ_NME$<>"" THEN E_NME$=OBJ_TIP$+"."+OBJ_NME$
13850 IF N_OBJ_TIP$+N_OBJ_NME$<>"" AND N_OBJ_TIP$+"."+N_OBJ_NME$<>E_NME$ THEN E_NME$=N_OBJ_TIP$+"."+N_OBJ_NME$
13860 IF STP(E_NME$,2)<>"" THEN E_NME$=" ("+E_NME$+")"
13870 ELEM_NME$=TBL(Q_LIST$="Y","Query Select","Query List Select"),ELEM_HDR$=PAD("* "+ELEM_NME$+E_NME$,60)
13880 ITEM_NME$=" Range:from",ITEM_OLD$=OBJ_TXT$,ITEM_NEW$=N_OBJ_TXT$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
13890 ITEM_NME$=" Range:to",ITEM_OLD$=OBJ_VAL$,ITEM_NEW$=N_OBJ_VAL$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
13900 ITEM_NME$=" Key Prefix",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB ADD_EXP; GOSUB COMPARE_RTN
13910 ITEM_NME$=" Select Logic",ITEM_OLD$=OBJ_SEL$,ITEM_NEW$=N_OBJ_SEL$; GOSUB LOGIC_TBL_RTN; GOSUB COMPARE_RTN
13920 ITEM_NME$=" Flags"
13930 IF POS("S"=OBJ_NULL$)>0 THEN ITEM_OLD$="Apply Prefix/Range to 'Sort by' key" ELSE ITEM_OLD$=OBJ_NULL$
13940 IF POS("S"=N_OBJ_NULL$)>0 THEN ITEM_NEW$="Apply Prefix/Range to 'Sort by' key" ELSE ITEM_NEW$=OBJ_NULL$
13950 GOSUB COMPARE_RTN
13960 ! not used at this time for Query Selection
13970 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_NME$,ITEM_NEW$=N_OBJ_NME$; GOSUB COMPARE_RTN
13980 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_C$,ITEM_NEW$=N_OBJ_C$; GOSUB COMPARE_RTN
13990 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_L$,ITEM_NEW$=N_OBJ_L$; GOSUB COMPARE_RTN
14000 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_H$,ITEM_NEW$=N_OBJ_H$; GOSUB COMPARE_RTN
14010 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_W$,ITEM_NEW$=N_OBJ_W$; GOSUB COMPARE_RTN
14020 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TAB$,ITEM_NEW$=N_OBJ_TAB$; GOSUB COMPARE_RTN
14030 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_DSP$,ITEM_NEW$=N_OBJ_DSP$; GOSUB COMPARE_RTN
14040 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_FCS$,ITEM_NEW$=N_OBJ_FCS$; GOSUB COMPARE_RTN
14050 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_MSG$,ITEM_NEW$=N_OBJ_MSG$; GOSUB COMPARE_RTN
14060 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_HLP$,ITEM_NEW$=N_OBJ_HLP$; GOSUB COMPARE_RTN
14070 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$; GOSUB COMPARE_RTN
14080 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_IDX$,ITEM_NEW$=N_OBJ_IDX$; GOSUB COMPARE_RTN
14090 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_HOTKEY$,ITEM_NEW$=N_OBJ_HOTKEY$; GOSUB COMPARE_RTN
14100 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_QRY$,ITEM_NEW$=N_OBJ_QRY$; GOSUB COMPARE_RTN
14110 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEC$,ITEM_NEW$=N_OBJ_SEC$; GOSUB COMPARE_RTN
14120 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_STS$,ITEM_NEW$=N_OBJ_STS$; GOSUB COMPARE_RTN
14130 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_GRP$,ITEM_NEW$=N_OBJ_GRP$; GOSUB COMPARE_RTN
14140 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TAG$,ITEM_NEW$=N_OBJ_TAG$; GOSUB COMPARE_RTN
14150 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TBL$,ITEM_NEW$=N_OBJ_TBL$; GOSUB COMPARE_RTN
14160 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_INP$,ITEM_NEW$=N_OBJ_INP$; GOSUB COMPARE_RTN
14170 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_OUT$,ITEM_NEW$=N_OBJ_OUT$; GOSUB COMPARE_RTN
14180 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_VALID$,ITEM_NEW$=N_OBJ_VALID$; GOSUB COMPARE_RTN
14190 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_CLASS$,ITEM_NEW$=N_OBJ_CLASS$; GOSUB COMPARE_RTN
14200 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TIP$,ITEM_NEW$=N_OBJ_TIP$; GOSUB COMPARE_RTN
14210 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_ORIG$,ITEM_NEW$=N_OBJ_ORIG$; GOSUB COMPARE_RTN
14220 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_FONT$,ITEM_NEW$=N_OBJ_FONT$; GOSUB COMPARE_RTN
14230 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_COLOUR$,ITEM_NEW$=N_OBJ_COLOUR$; GOSUB COMPARE_RTN
14240 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LISTBOX_TYPE$,ITEM_NEW$=N_OBJ_LISTBOX_TYPE$; GOSUB COMPARE_RTN
14250 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEP$,ITEM_NEW$=N_OBJ_SEP$; GOSUB COMPARE_RTN
14260 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SCRATCH$,ITEM_NEW$=N_OBJ_SCRATCH$; GOSUB COMPARE_RTN
14270 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_POPUP$,ITEM_NEW$=N_OBJ_POPUP$; GOSUB COMPARE_RTN
14280 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SIZING$,ITEM_NEW$=N_OBJ_SIZING$; GOSUB COMPARE_RTN
14290 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LOGIC1$,ITEM_NEW$=N_OBJ_LOGIC1$; GOSUB COMPARE_RTN
14300 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LOGIC2$,ITEM_NEW$=N_OBJ_LOGIC2$; GOSUB COMPARE_RTN
14310 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_POPUP_LOGIC$,ITEM_NEW$=N_OBJ_POPUP_LOGIC$; GOSUB COMPARE_RTN
14320 RETURN 
14330 ! Query User records obj_type="U"
14340 DO_QUERY_USER:
14350 E_NME$=""; IF OBJ_TIP$+OBJ_NME$<>"" THEN E_NME$=OBJ_TIP$+"."+OBJ_NME$
14360 IF N_OBJ_TIP$+N_OBJ_NME$<>"" AND N_OBJ_TIP$+"."+N_OBJ_NME$<>E_NME$ THEN E_NME$=N_OBJ_TIP$+"."+N_OBJ_NME$
14370 IF STP(E_NME$,2)<>"" THEN E_NME$=" ("+E_NME$+")"
14380 ELEM_NME$=TBL(Q_LIST$="Y","Query User","Query List User"),ELEM_HDR$=PAD("* "+ELEM_NME$+E_NME$,60)
14390 ITEM_NME$=" Element Name",ITEM_OLD$=OBJ_IDX$,ITEM_NEW$=N_OBJ_IDX$; GOSUB COMPARE_RTN
14400 ! not used at this time for Query User
14410 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_NME$,ITEM_NEW$=N_OBJ_NME$; GOSUB COMPARE_RTN
14420 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_C$,ITEM_NEW$=N_OBJ_C$; GOSUB COMPARE_RTN
14430 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_L$,ITEM_NEW$=N_OBJ_L$; GOSUB COMPARE_RTN
14440 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_H$,ITEM_NEW$=N_OBJ_H$; GOSUB COMPARE_RTN
14450 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_W$,ITEM_NEW$=N_OBJ_W$; GOSUB COMPARE_RTN
14460 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TXT$,ITEM_NEW$=N_OBJ_TXT$; GOSUB COMPARE_RTN
14470 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_VAL$,ITEM_NEW$=N_OBJ_VAL$; GOSUB COMPARE_RTN
14480 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TAB$,ITEM_NEW$=N_OBJ_TAB$; GOSUB COMPARE_RTN
14490 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB COMPARE_RTN
14500 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_DSP$,ITEM_NEW$=N_OBJ_DSP$; GOSUB COMPARE_RTN
14510 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_FCS$,ITEM_NEW$=N_OBJ_FCS$; GOSUB COMPARE_RTN
14520 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEL$,ITEM_NEW$=N_OBJ_SEL$; GOSUB COMPARE_RTN
14530 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_MSG$,ITEM_NEW$=N_OBJ_MSG$; GOSUB COMPARE_RTN
14540 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_HLP$,ITEM_NEW$=N_OBJ_HLP$; GOSUB COMPARE_RTN
14550 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$; GOSUB COMPARE_RTN
14560 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_HOTKEY$,ITEM_NEW$=N_OBJ_HOTKEY$; GOSUB COMPARE_RTN
14570 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_QRY$,ITEM_NEW$=N_OBJ_QRY$; GOSUB COMPARE_RTN
14580 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEC$,ITEM_NEW$=N_OBJ_SEC$; GOSUB COMPARE_RTN
14590 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_STS$,ITEM_NEW$=N_OBJ_STS$; GOSUB COMPARE_RTN
14600 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_GRP$,ITEM_NEW$=N_OBJ_GRP$; GOSUB COMPARE_RTN
14610 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_NULL$,ITEM_NEW$=N_OBJ_NULL$; GOSUB COMPARE_RTN
14620 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TAG$,ITEM_NEW$=N_OBJ_TAG$; GOSUB COMPARE_RTN
14630 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TBL$,ITEM_NEW$=N_OBJ_TBL$; GOSUB COMPARE_RTN
14640 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_INP$,ITEM_NEW$=N_OBJ_INP$; GOSUB COMPARE_RTN
14650 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_OUT$,ITEM_NEW$=N_OBJ_OUT$; GOSUB COMPARE_RTN
14660 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_VALID$,ITEM_NEW$=N_OBJ_VALID$; GOSUB COMPARE_RTN
14670 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_CLASS$,ITEM_NEW$=N_OBJ_CLASS$; GOSUB COMPARE_RTN
14680 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TIP$,ITEM_NEW$=N_OBJ_TIP$; GOSUB COMPARE_RTN
14690 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_ORIG$,ITEM_NEW$=N_OBJ_ORIG$; GOSUB COMPARE_RTN
14700 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_FONT$,ITEM_NEW$=N_OBJ_FONT$; GOSUB COMPARE_RTN
14710 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_COLOUR$,ITEM_NEW$=N_OBJ_COLOUR$; GOSUB COMPARE_RTN
14720 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LISTBOX_TYPE$,ITEM_NEW$=N_OBJ_LISTBOX_TYPE$; GOSUB COMPARE_RTN
14730 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEP$,ITEM_NEW$=N_OBJ_SEP$; GOSUB COMPARE_RTN
14740 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SCRATCH$,ITEM_NEW$=N_OBJ_SCRATCH$; GOSUB COMPARE_RTN
14750 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_POPUP$,ITEM_NEW$=N_OBJ_POPUP$; GOSUB COMPARE_RTN
14760 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SIZING$,ITEM_NEW$=N_OBJ_SIZING$; GOSUB COMPARE_RTN
14770 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LOGIC1$,ITEM_NEW$=N_OBJ_LOGIC1$; GOSUB COMPARE_RTN
14780 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LOGIC2$,ITEM_NEW$=N_OBJ_LOGIC2$; GOSUB COMPARE_RTN
14790 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_POPUP_LOGIC$,ITEM_NEW$=N_OBJ_POPUP_LOGIC$; GOSUB COMPARE_RTN
14800 RETURN 
14810 ! Query Link - obj_type$="O"
14820 DO_QUERY_LINK:
14830 E_NME$=""; IF OBJ_TIP$+OBJ_NME$<>"" THEN E_NME$=OBJ_NME$
14840 IF N_OBJ_TIP$+N_OBJ_NME$<>"" AND N_OBJ_TIP$+"."+N_OBJ_NME$<>E_NME$ THEN E_NME$=N_OBJ_NME$
14850 IF STP(E_NME$,2)<>"" THEN E_NME$=" ("+E_NME$+")"
14860 ELEM_NME$=TBL(Q_LIST$="Y","Query Link","Query List Link"),ELEM_HDR$=PAD("* "+ELEM_NME$+E_NME$,60)
14870 ITEM_NME$=" File/Path/Tbl",ITEM_OLD$=OBJ_NME$,ITEM_NEW$=N_OBJ_NME$; GOSUB COMPARE_RTN
14880 ITEM_NME$=" Phys.File/Database",ITEM_OLD$=OBJ_TXT$,ITEM_NEW$=N_OBJ_TXT$; GOSUB COMPARE_RTN
14890 ITEM_NME$=" Key Data Def",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$; GOSUB COMPARE_RTN
14900 ITEM_NME$=" Option" ! ,ITEM_OLD$=OBJ_NULL$,ITEM_NEW$=N_OBJ_NULL$
14910 IF POS("R"=OBJ_NULL$)>0 THEN ITEM_OLD$="Read by record" ELSE ITEM_OLD$=""
14920 IF POS("R"=N_OBJ_NULL$)>0 THEN ITEM_NEW$="Read by record" ELSE ITEM_NEW$=""
14930 GOSUB COMPARE_RTN
14940 ITEM_NME$=" FileID Prefix",ITEM_OLD$=OBJ_TIP$,ITEM_NEW$=N_OBJ_TIP$; GOSUB COMPARE_RTN
14950 ITEM_NME$=" Key Num",ITEM_OLD$=OBJ_VAL$,ITEM_NEW$=N_OBJ_VAL$; GOSUB COMPARE_RTN
14960 ITEM_NME$=" File Seq",ITEM_OLD$=OLD_PANEL_KEY$(14,3),ITEM_NEW$=NEW_PANEL_KEY$(14,3); GOSUB COMPARE_RTN
14970 ITEM_NME$=" Table Key Def",ITEM_OLD$=OBJ_GRP$,ITEM_NEW$=N_OBJ_GRP$; GOSUB COMPARE_RTN
14980 ITEM_NME$=" Database Opt",ITEM_OLD$=OBJ_TBL$,ITEM_NEW$=N_OBJ_TBL$; GOSUB COMPARE_RTN
14990 ! not used at this time for Query Link
15000 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_C$,ITEM_NEW$=N_OBJ_C$; GOSUB COMPARE_RTN
15010 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_L$,ITEM_NEW$=N_OBJ_L$; GOSUB COMPARE_RTN
15020 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_H$,ITEM_NEW$=N_OBJ_H$; GOSUB COMPARE_RTN
15030 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_W$,ITEM_NEW$=N_OBJ_W$; GOSUB COMPARE_RTN
15040 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TAB$,ITEM_NEW$=N_OBJ_TAB$; GOSUB COMPARE_RTN
15050 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_DSP$,ITEM_NEW$=N_OBJ_DSP$; GOSUB COMPARE_RTN
15060 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_FCS$,ITEM_NEW$=N_OBJ_FCS$; GOSUB COMPARE_RTN
15070 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEL$,ITEM_NEW$=N_OBJ_SEL$; GOSUB COMPARE_RTN
15080 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_MSG$,ITEM_NEW$=N_OBJ_MSG$; GOSUB COMPARE_RTN
15090 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_HLP$,ITEM_NEW$=N_OBJ_HLP$; GOSUB COMPARE_RTN
15100 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_ATTR$,ITEM_NEW$=N_OBJ_ATTR$; GOSUB COMPARE_RTN
15110 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_HOTKEY$,ITEM_NEW$=N_OBJ_HOTKEY$; GOSUB COMPARE_RTN
15120 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_QRY$,ITEM_NEW$=N_OBJ_QRY$; GOSUB COMPARE_RTN
15130 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEC$,ITEM_NEW$=N_OBJ_SEC$; GOSUB COMPARE_RTN
15140 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_STS$,ITEM_NEW$=N_OBJ_STS$; GOSUB COMPARE_RTN
15150 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_TAG$,ITEM_NEW$=N_OBJ_TAG$; GOSUB COMPARE_RTN
15160 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_INP$,ITEM_NEW$=N_OBJ_INP$; GOSUB COMPARE_RTN
15170 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_OUT$,ITEM_NEW$=N_OBJ_OUT$; GOSUB COMPARE_RTN
15180 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_VALID$,ITEM_NEW$=N_OBJ_VALID$; GOSUB COMPARE_RTN
15190 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_CLASS$,ITEM_NEW$=N_OBJ_CLASS$; GOSUB COMPARE_RTN
15200 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_ORIG$,ITEM_NEW$=N_OBJ_ORIG$; GOSUB COMPARE_RTN
15210 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_FONT$,ITEM_NEW$=N_OBJ_FONT$; GOSUB COMPARE_RTN
15220 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_COLOUR$,ITEM_NEW$=N_OBJ_COLOUR$; GOSUB COMPARE_RTN
15230 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LISTBOX_TYPE$,ITEM_NEW$=N_OBJ_LISTBOX_TYPE$; GOSUB COMPARE_RTN
15240 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SEP$,ITEM_NEW$=N_OBJ_SEP$; GOSUB COMPARE_RTN
15250 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SCRATCH$,ITEM_NEW$=N_OBJ_SCRATCH$; GOSUB COMPARE_RTN
15260 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_POPUP$,ITEM_NEW$=N_OBJ_POPUP$; GOSUB COMPARE_RTN
15270 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_SIZING$,ITEM_NEW$=N_OBJ_SIZING$; GOSUB COMPARE_RTN
15280 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LOGIC1$,ITEM_NEW$=N_OBJ_LOGIC1$; GOSUB COMPARE_RTN
15290 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_LOGIC2$,ITEM_NEW$=N_OBJ_LOGIC2$; GOSUB COMPARE_RTN
15300 ITEM_NME$=" UNKN",ITEM_OLD$=OBJ_POPUP_LOGIC$,ITEM_NEW$=N_OBJ_POPUP_LOGIC$; GOSUB COMPARE_RTN
15310 RETURN 
15320 ! got GRID_PRESETS records 'X###'
15330 DO_GRID_PRESETS_RECORDS:
15340 ELEM_NME$="Grid Presets"
15350 ELEM_HDR$=PAD("* "+ELEM_NME$,60)
15360 ITEM_NME$=" Row Number",ITEM_OLD$=STR(OBJ_L),ITEM_NEW$=STR(N_OBJ_L); GOSUB COMPARE_RTN
15361 ITEM_NME$=" Column #/name",ITEM_OLD$=OBJ_TBL$,ITEM_NEW$=N_OBJ_TBL$; GOSUB COMPARE_RTN
15370 ITEM_NME$=" Property",ITEM_OLD$=OBJ_VAL$,ITEM_NEW$=N_OBJ_VAL$; GOSUB COMPARE_RTN
15380 ITEM_NME$=" Cell Value Type",ITEM_OLD$=OBJ_DEF$,ITEM_NEW$=N_OBJ_DEF$
15390 IF ITEM_OLD$<>"" THEN CONV_F$=ITEM_OLD$,CONV_PGM_ENTRY$="conv_obj_def_grid"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
15400 IF ITEM_NEW$<>"" THEN CONV_F$=ITEM_NEW$,CONV_PGM_ENTRY$="conv_obj_def_grid"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
15410 GOSUB COMPARE_RTN
15420 ITEM_NME$=" Cell Value",ITEM_OLD$=OBJ_SEL$,ITEM_NEW$=N_OBJ_SEL$; GOSUB COMPARE_RTN
15460 ITEM_NME$=" Format Definitions",ITEM_OLD$=OBJ_NULL$,ITEM_NEW$=N_OBJ_NULL$; GOSUB COMPARE_RTN
15480 ITEM_NME$=" Popup Logic",ITEM_OLD$=OBJ_POPUP_LOGIC$,ITEM_NEW$=N_OBJ_POPUP_LOGIC$; GOSUB COMPARE_RTN
15490 ITEM_NME$=" Query Bitmap",ITEM_OLD$=OBJ_QRY_BITMAP$,ITEM_NEW$=N_OBJ_QRY_BITMAP$; GOSUB COMPARE_RTN
15500 ITEM_NME$=" Query Tip",ITEM_OLD$=OBJ_QRY_TIP$,ITEM_NEW$=N_OBJ_QRY_TIP$; GOSUB COMPARE_RTN
15510 RETURN 
15520 ! got Cell Logic 'Y###' records
15530 DO_CELL_LOGIC_RECORDS:
15540 ELEM_NME$="Cell Logic"
15550 ELEM_HDR$=PAD("* "+ELEM_NME$,60)
15560 ITEM_NME$=" Row Number",ITEM_OLD$=STR(OBJ_L),ITEM_NEW$=STR(N_OBJ_L); GOSUB COMPARE_RTN
15561 ITEM_NME$=" Column #/name",ITEM_OLD$=OBJ_TBL$,ITEM_NEW$=N_OBJ_TBL$; GOSUB COMPARE_RTN
15570 ITEM_NME$=" On Focus",ITEM_OLD$=OBJ_FCS$,ITEM_NEW$=N_OBJ_FCS$; GOSUB LOGIC_TBL_RTN; GOSUB COMPARE_RTN
15580 ITEM_NME$=" On Change",ITEM_OLD$=OBJ_SEL$,ITEM_NEW$=N_OBJ_SEL$; GOSUB LOGIC_TBL_RTN; GOSUB COMPARE_RTN
15590 ITEM_NME$=" Column",ITEM_OLD$=OBJ_TBL$,ITEM_NEW$=N_OBJ_TBL$; GOSUB COMPARE_RTN
15600 ITEM_NME$=" Validation Logic",ITEM_OLD$=OBJ_INP$,ITEM_NEW$=N_OBJ_INP$; GOSUB COMPARE_RTN
15610 ITEM_NME$=" Formatting Logic",ITEM_OLD$=OBJ_OUT$,ITEM_NEW$=N_OBJ_OUT$; GOSUB COMPARE_RTN
15620 RETURN 
15630 ! Table Routines
15640 ! - Sizing tbl rtn
15650 SIZING_TBL_RTN:
15660 IF ITEM_OLD$="" THEN GOTO 15680 ELSE CONV_F$=ITEM_OLD$; IF ON_REC$="Header " THEN ITEM_NME$=" Resizing Option",CONV_PGM_ENTRY$="conv_obj_sizing_hdr"; GOSUB CALL_LIBUTILS ELSE ITEM_NME$=" Custom Resize",CONV_PGM_ENTRY$="conv_obj_sizing"; GOSUB CALL_LIBUTILS
15670 IF CONV_F$<>"" AND CONV_F$<>ITEM_OLD$ THEN ITEM_OLD$=CONV_F$
15680 IF ITEM_NEW$="" THEN GOTO 15700 ELSE CONV_F$=ITEM_NEW$; IF ON_REC$="Header " THEN ITEM_NME$=" Resizing Option",CONV_PGM_ENTRY$="conv_obj_sizing_hdr"; GOSUB CALL_LIBUTILS ELSE ITEM_NME$=" Custom Resize",CONV_PGM_ENTRY$="conv_obj_sizing"; GOSUB CALL_LIBUTILS
15690 IF CONV_F$<>"" AND CONV_F$<>ITEM_NEW$ THEN ITEM_NEW$=CONV_F$
15700 RETURN 
15710 ! Obj help
15720 HELP_ADJUST_RTN:
15730 P=POS("'"=ITEM_OLD$); IF P>0 THEN ITEM_OLD$="*Internal*"+ITEM_OLD$(P+1) ELSE IF ITEM_OLD$<>"" THEN ITEM_OLD$="*External*"+ITEM_OLD$
15740 P=POS("'"=ITEM_NEW$); IF P>0 THEN ITEM_NEW$="*Internal*"+ITEM_NEW$(P+1) ELSE IF ITEM_NEW$<>"" THEN ITEM_NEW$="*External*"+ITEM_NEW$
15750 RETURN 
15760 ! 
15770 ! finish up
15780 ! 
15790 BUILD_OLD_OBJ_INP:
15791 OLD_1$=""
15792 OLD_2$=""
15800 IF OBJ_INP$="" THEN RETURN 
35171 EVENT_NUM=POS("/"=OBJ_INP$,1,0)
35172 DIM CURRENT_EVENT$[EVENT_NUM]
35173 TMP$=SUB(OBJ_INP$,"/",SEP)
35174 READ DATA FROM TMP$ TO CURRENT_EVENT${ALL}
35175 CURRENT_COUNT=0
35176 WHILE CURRENT_COUNT<=EVENT_NUM-1
35180 SPLIT_POS=POS(","=CURRENT_EVENT$[CURRENT_COUNT])
35190 PART1$=MID(CURRENT_EVENT$[CURRENT_COUNT],1,SPLIT_POS-1)
35200 PART2$=MID(CURRENT_EVENT$[CURRENT_COUNT],SPLIT_POS+1)
35210 OLD_1$+=PART1$+","
35220 OLD_2$+=PART2$+"/"
35230 CURRENT_COUNT++
35240 WEND 
35260 RETURN 
35270 ! 
35280 ! 
35290 BUILD_NEW_OBJ_INP:
35300 NEW_1$=""
35310 NEW_2$=""
35320 IF N_OBJ_INP$="" THEN RETURN 
35330 EVENT_NUM=POS("/"=N_OBJ_INP$,1,0)
35340 DIM CURRENT_EVENT$[EVENT_NUM]
35350 TMP$=SUB(N_OBJ_INP$,"/",SEP)
35360 READ DATA FROM TMP$ TO CURRENT_EVENT${ALL}
35370 CURRENT_COUNT=0
35380 WHILE CURRENT_COUNT<=EVENT_NUM-1
35390 SPLIT_POS=POS(","=CURRENT_EVENT$[CURRENT_COUNT])
35400 PART1$=MID(CURRENT_EVENT$[CURRENT_COUNT],1,SPLIT_POS-1)
35410 PART2$=MID(CURRENT_EVENT$[CURRENT_COUNT],SPLIT_POS+1)
35420 NEW_1$+=PART1$+","
35430 NEW_2$+=PART2$+"/"
35440 CURRENT_COUNT++
35450 WEND 
35470 RETURN 
35480 ! 
35490 COMAPRE_FILL_PATTERN:
35500 ITEM_NME$=" Fill Pattern"
35501 ITEM_OLD$="",ITEM_NEW$=""
35510 EVENT_NUM1=POS(","=OLD_1$,1,0)
35530 DIM CURRENT_EVENT1$[EVENT_NUM1]
35531 DIM CURRENT_EVENT2$[EVENT_NUM1]
35540 TMP1$=SUB(OLD_1$,",",SEP)
35541 TMP2$=SUB(NEW_1$,",",SEP)
35550 READ DATA FROM TMP1$ TO CURRENT_EVENT1${ALL}
35551 READ DATA FROM TMP2$ TO CURRENT_EVENT2${ALL}
35560 CURRENT_COUNT=0
35570 WHILE CURRENT_COUNT<=EVENT_NUM1-1
35580 CONV_F$=CURRENT_EVENT1$[CURRENT_COUNT],CONV_PGM_ENTRY$="conv_fill_pattern"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" THEN IF NUL(ITEM_OLD$) THEN ITEM_OLD$+=CONV_F$ ELSE ITEM_OLD$+=" ,"+CONV_F$
35590 CONV_F$=CURRENT_EVENT2$[CURRENT_COUNT],CONV_PGM_ENTRY$="conv_fill_pattern"; GOSUB CALL_LIBUTILS; IF CONV_F$<>"" THEN IF NUL(ITEM_NEW$) THEN ITEM_NEW$+=CONV_F$ ELSE ITEM_NEW$+=" ,"+CONV_F$
35620 CURRENT_COUNT++
35630 WEND 
35680 GOSUB COMPARE_RTN
35720 RETURN 
35760 ! 
