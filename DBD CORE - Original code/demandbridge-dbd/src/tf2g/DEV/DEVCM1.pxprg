0002 CLEAR ; SETERR 10000; ENTER SOURCE_DIR$,DEST_DIR$,PRINTER
0003 REM IF STP(SOURCE_DIR$)="" THEN PRINT 'DIALOGUE'(10,10,30,5,"Source Directory"); INPUT SOURCE_DIR$; EXIT 
0004 REM IF STP(DEST_DIR$)="" THEN PRINT 'DIALOGUE'(10,10,30,5,"Destination Directory"); INPUT DEST_DIR$; EXIT 
0005 REM IF PRINTER=0 THEN PRINT 'DIALOGUE'(10,10,30,5,"Output File No"); INPUT PRINTER; EXIT 
0009 SETERR 10000
0011 COUNT=0
0024 ! 
0030 INFO$="Program compare utility"
0035 REM "5.6 - 03/10/09 - 15.923611 - jdf - SSP# 227983
0037 REM "227983-Tool to compare two directories of source code.             
0040 REM "Copyright 2009 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0045 WK.LFN=HFN,PR.LFN=0
0050 WRK.1$="",WRK.2$=""
0060 X$=FIB(0),SV_MODE$=X$(21,3) ! PRINT 'CS' ! 'RM','_BLACK','WHITE','SN','DF','CS',
0070 SV_SD=PRM('SD'); SET_PARAM -'SD'
0100 ! 100 - First program definition
0105 ! IF LAST.1$<>"" THEN RESP$=LAST.1$
0110 QUEST$="Original program file/directory:"; GOSUB 5500
0120 IF RESP$="" THEN GOTO 9000 ELSE LAST.1$=RESP$
0130 OPEN INPUT (WK.LFN,ERR=0180)RESP$; A$=FIB(WK.LFN),PTH.1$=PTH(WK.LFN)
0140 CLOSE (WK.LFN); IF A$(19,1)="D" THEN GOTO 0500 ELSE IF POS(A$(19,1)="KP")=0 THEN GOTO 0190
0150 OPEN INPUT (WK.LFN,ISZ=256,ERR=0180)RESP$; READ RECORD (WK.LFN)X$; CLOSE (WK.LFN); IF LEN(X$)<>256 THEN GOTO 0190
0170 INFO$="Original program file:"+PTH.1$; GOTO 0300
0180 INFO$=MSG(RET); PRINT 'RB',; GOTO 0100
0190 INFO$="'"+RESP$+"' is not a program file"; PRINT 'RB',; GOTO 0100
0200 INFO$="'"+RESP$+"' is password protected"; PRINT 'RB',; GOTO 0100
0300 ! 300 - Second program definition
0305 RESP$=PTH.1$
0310 QUEST$="Revised program file:"; GOSUB 5500
0320 IF RESP$="" THEN GOTO 0010 ELSE LAST.2$=RESP$
0325 IF LEN(RESP$)=2 THEN IF LEN(PTH.1$)>2 AND RESP$(2,1)=":" AND UCS(RESP$(1,1))>="A" AND UCS(RESP$(1,1))<="Z" THEN RESP$=RESP$(1,1)+PTH.1$(2)
0330 OPEN INPUT (WK.LFN,ERR=0380)RESP$; A$=FIB(WK.LFN),PTH.2$=PTH(WK.LFN)
0340 CLOSE (WK.LFN); IF A$(19,1)<>"P" THEN GOTO 0390
0350 OPEN INPUT (WK.LFN,ISZ=256,ERR=0380)RESP$; READ RECORD (WK.LFN)X$; CLOSE (WK.LFN); IF LEN(X$)<>256 THEN GOTO 0390
0370 FL.TYP$="P"; GOTO 0600
0380 INFO$=MSG(RET); PRINT 'RB',; GOTO 0300
0390 INFO$="'"+RESP$+"' is not a program file"; PRINT 'RB',; GOTO 0300
0400 INFO$="'"+RESP$+"' is password protected"; PRINT 'RB',; GOTO 0300
0500 ! 500 - Second program definition
0505 IF LAST.2$<>"" THEN RESP$=LAST.2$
0510 INFO$="Directory containing original programs:"+PTH.1$
0520 QUEST$="Revised program Directory:"; GOSUB 5500
0525 IF LEN(RESP$)=2 THEN IF LEN(PTH.1$)>2 AND RESP$(2,1)=":" AND UCS(RESP$(1,1))>="A" AND UCS(RESP$(1,1))<="Z" THEN RESP$=RESP$(1,1)+PTH.1$(2)
0530 IF RESP$="" THEN GOTO 0010 ELSE LAST.2$=RESP$
0540 OPEN INPUT (WK.LFN,ERR=0570)RESP$; A$=FIB(WK.LFN),PTH.2$=PTH(WK.LFN)
0550 CLOSE (WK.LFN); IF A$(19,1)<>"D" THEN GOTO 0580
0560 FL.TYP$="D"; GOTO 0590
0570 INFO$=MSG(RET); PRINT 'RB',; GOTO 0500
0580 INFO$="'"+RESP$+"' is not a directory"; PRINT 'RB',; GOTO 0500
0590 GOSUB GET_FILES; IF PG.MSK$="" THEN GOTO 0500
0600 ! 600 - Changes only flag
0610 INFO$="Print only the lines which have been changed"
0620 OPTS$="Yes No"
0630 ! GOSUB 5000
0640 CHG.FLG$="Y"
0642 ! 
0643 INFO$="Output results to"
0644 OPTS$="Screen Printer"
0645 ! GOSUB 5000
0646 PRT_OPT$="P"; IF PRT_OPT$="Q" THEN GOTO 9000
0648 ! 
0650 PR.LFT=0,PR.PAGE=0
0660 PR.TTL$="Program comparision for "+WHO
0665 IF PRT_OPT$="S" THEN PR.LFN=HFN; OPEN (PR.LFN)FID(0); GOTO 0690
0670 PR.LFN=PRINTER ! ; __XX$=PRINTER$ ! ERASE __XX$,ERR=*NEXT ! CALL "*pr.opn",PR.LFN,20
0672 REM SERIAL __XX$,ERR=*PROCEED; OPEN LOCK (PR.LFN,ERR=*NEXT)__XX$
0680 ON CTL GOTO 0690,0600,0670,0670,0690
0690 MX_COL=MXC(PR.LFN); IF MX_COL<1 THEN MX_COL=79 ! 
0692 MX_LINE=MXL(PR.LFN)-5; IF MX_LINE<0 AND PRT_OPT$<>"S" THEN MX_LINE=55 ! Allow for hdr (-5)
0694 MX_MID=MAX(31,INT((MX_COL-6)/2)-1) ! 
0800 ! 800 - Compare
0810 TTL.1$=PTH.1$,TTL.2$=PTH.2$
0820 IF FL.TYP$="P" THEN GOSUB 1000; GOTO 0960
0830 ! 
0840 IF FL_LST=0 THEN GOTO 0848
0841 ! 
0842 F$=KEY(FL_LST,END=*NEXT); READ (FL_LST); F$=F$(1,LEN(F$)-1); GOTO 0860
0844 X$=PTH(FL_LST); CLOSE (FL_LST); IF POS("*memory*"=LCS(X$))=0 THEN ERASE X$,ERR=*NEXT
0845 GOTO 0960
0846 ! 
0848 X=POS(SEP=FL.LST$); IF X=0 THEN GOTO 0960
0850 F$=FL.LST$(1,X-2),FL.LST$=FL.LST$(X+1)
0860 X=HFN; OPEN INPUT (X,ERR=0840)TTL.1$+DLM+F$; X$=FIB(X); PTH.1$=PTH(X); CLOSE (X)
0870 IF X$(19,1)<>"P" THEN GOTO 0840
0875 OPEN INPUT (X,ISZ=256,ERR=0840)TTL.1$+DLM+F$; READ RECORD (X)X$; CLOSE (X); IF LEN(X$)<>256 THEN GOTO 0840 ELSE IF X$(1,1)+X$(5,4)<>"[prg]" THEN GOTO 0840
0876 PTH.1X$=X$
0878 COMP$="",TTL.3$=""; IF FID(0)=FID(PR.LFN) THEN PR.LFT=0,PR.PAGE=0
0880 X=HFN; OPEN INPUT (X,ERR=0930)TTL.2$+DLM+F$; X$=FIB(X); PTH.2$=PTH(X); CLOSE (X)
0890 IF X$(19,1)<>"P" THEN GOTO 0840
0895 OPEN INPUT (X,ISZ=256,ERR=0840)TTL.2$+DLM+F$; READ RECORD (X)X$; CLOSE (X); IF LEN(X$)<>256 THEN GOTO 0840 ELSE IF X$(1,1)+X$(5,4)<>"[prg]" THEN GOTO 0840
0896 IF PTH.1X$=X$ THEN GOTO 0840
0920 GOSUB 1000; GOTO 0840
0930 IF PR.LFT<1 THEN GOSUB 4500; GOTO 0940
0934 PRINT (PR.LFN)DIM(MX_COL,"-"); PR.LFT=PR.LFT-1
0940 PRINT (PR.LFN)"Cannot find:",TTL.2$+DLM+F$; PR.LFT=PR.LFT-1
0945 IF FID(0)=FID(PR.LFN) THEN INFO$="Finished comparing these two programs.  Continue?",OPTS$="Continue"; GOSUB 5000; IF OPT$="Q" THEN GOTO 9000
0950 GOTO 0840
0960 REM CALL "*pr.cls",PR.LFN; PR.LFN=0
0970 GOTO 9000
1000 ! 1000 - Convert the files
1010 PRINT @(0,2),'CE','SB','CYAN' ! ,"Comparing:",@(0,4),"Original:",@(16,4),PTH.1$,@(0,6),"Revised:",@(16,6),PTH.2$,'RM',
1012 TITLE1$=PTH.1$; IF LEN(TITLE1$)>MX_MID THEN TITLE1$=TITLE1$(1,2)+"~~"+TITLE1$(LEN(TITLE1$)-MX_MID+5)
1014 TITLE2$=PTH.2$; IF LEN(TITLE2$)>MX_MID THEN TITLE2$=TITLE2$(1,2)+"~~"+TITLE2$(LEN(TITLE2$)-MX_MID+5)
1015 ERR_MSG$=""
1016 COMP$=PAD(TITLE1$,MX_MID,2)+" Line#  "+PAD(TITLE2$,MX_MID,2),TTL.3$=COMP$
1020 CALL "*pg.cnv",ERR=1025,PTH.1$,WRK.1$; GOTO 1030
1025 ERR_MSG$=PTH.1$+" is password protected"; PRINT @(0,20),ERR_MSG$,'CL',; GOTO 2900
1030 CALL "*pg.cnv",ERR=1035,PTH.2$,WRK.2$; GOTO 1040
1035 ERR_MSG$=PTH.2$+" is password protected"; PRINT @(0,20),ERR_MSG$,'CL',; GOTO 2900
1040 LFN.1=HFN; OPEN (LFN.1)WRK.1$
1050 LFN.2=HFN; OPEN (LFN.2)WRK.2$
1060 L.1$="",L.2$=""
1070 NO.ADD=0,NO.CHG=0,NO.DEL=0
2000 ! 2000 - Compare records
2010 IF L.1$="" THEN READ RECORD (LFN.1,END=2040)L.1$
2020 L1=NUM(L.1$(1,5),ERR=2030); GOTO 2050
2030 L1=NUM(L.1$(1,4),ERR=*NEXT); GOTO 2050
2031 MSGBOX "Cannot compare programs without line numbers",PTH.1$; GOTO 2900
2040 L1=65000
2050 IF L.2$="" THEN READ RECORD (LFN.2,END=2080)L.2$
2060 L2=NUM(L.2$(1,5),ERR=2070); GOTO 2090
2070 L2=NUM(L.2$(1,4)); GOTO 2090
2080 L2=65000
2090 IF L1+L2=130000 THEN GOTO 2900
2095 IF FID(0)=FID(PR.LFN) AND NO.ADD+NO.DEL+NO.CHG+(CHG.FLG$="N")<>0 THEN GOTO 2110
2100 PRINT @(10,4),'CE' REM PRINT @(10,4),L1:"#0000",@(10,6),L2:"#0000",
2110 IF L1<L2 THEN GOTO 2140
2120 IF L1>L2 THEN GOTO 2150
2130 REC.1$=L.1$,REC.2$=L.2$,L.1$="",L.2$=""; GOSUB 4000; GOTO 2000
2140 REC.1$=L.1$,REC.2$="",L.1$=""; GOSUB 4000; GOTO 2000
2150 REC.1$="",REC.2$=L.2$,L.2$=""; GOSUB 4000; GOTO 2000
2900 ! 2900 - End of report
2910 IF LFN.1<>0 THEN CLOSE (LFN.1)
2915 IF LFN.2<>0 THEN CLOSE (LFN.2)
2920 IF WRK.1$<>"" THEN ERASE WRK.1$,ERR=2930; WRK.1$=""
2930 IF WRK.2$<>"" THEN ERASE WRK.2$,ERR=2940; WRK.2$=""
2940 ! 
2941 IF NO.ADD+NO.DEL+NO.CHG=0 AND ERR_MSG$="" AND FL.TYP$<>"P" THEN GOTO 2970
2942 IF PR.LFT<1 THEN GOSUB 4500
2944 PR.LFT=PR.LFT-1
2945 IF ERR_MSG$<>"" THEN PRINT (PR.LFN)ERR_MSG$; ERR_MSG$=""; GOTO 2965
2950 IF NO.ADD+NO.DEL+NO.CHG=0 THEN GOTO 2965 ! PRINT (PR.LFN)" No differences between:",PTH.1$," and ",PTH.2$; GOTO 2965
2960 PRINT (PR.LFN)NO.ADD," additions,",NO.DEL," deletions,",NO.CHG," changes"
2965 IF FID(0)=FID(PR.LFN) THEN INFO$="Finished comparing these two programs.  Continue?",OPTS$=""; GOSUB 5000; IF OPT$="Q" THEN EXITTO 9000
2970 RETURN 
4000 ! 4000 - Output line
4010 IF REC.1$=REC.2$ THEN CD$="" ELSE IF REC.1$="" THEN CD$="Add",NO.ADD=NO.ADD+1 ELSE IF REC.2$="" THEN CD$="Del",NO.DEL=NO.DEL+1 ELSE CD$="Chg",NO.CHG=NO.CHG+1
4020 IF CD$="" AND CHG.FLG$="Y" THEN RETURN 
4030 O1$=REC.1$,O2$=REC.2$
4032 LNUM$=""
4034 IF O1$<>"" THEN LNUM$=O1$(1,POS(" "=O1$+" ")-1)
4036 X=LEN(LNUM$); IF X<4 OR X>5 THEN IF O2$<>"" THEN LNUM$=O2$(1,POS(" "=O2$+" ")-1)
4037 IF O1$<>"" THEN O1$=O1$(LEN(LNUM$)+2)
4038 IF O2$<>"" THEN O2$=O2$(LEN(LNUM$)+2)
4039 LNUM$=PAD(LNUM$,5,0),O1$=" "+O1$,O2$=" "+O2$
4040 IF PR.LFT<1 THEN GOSUB 4500 ELSE IF COMP$<>"" THEN GOSUB SUB_HEADING
4050 PR.LFT=PR.LFT-1
4060 IF LEN(O1$)<=MX_MID THEN LINE$=LINE$+O1$+DIM(MX_MID+1)+LNUM$; PRINT (PR.LFN)O1$,@(MX_MID+1),LNUM$,; O1$=""; GOTO 4090
4070 PRINT (PR.LFN)O1$(1,MX_MID),@(MX_MID+1),LNUM$,; LINE$=LINE$+O1$(1,MX_MID)+" "+LNUM$
4080 O1$=":"+O1$(MX_MID+1)
4090 LNUM$=""
4100 IF LEN(O2$)<=MX_MID THEN LINE$=LINE$+DIM(MX_MID+8)+O2$+$0A$; PRINT (PR.LFN)@(MX_MID+8),O2$; O2$=""; GOTO 4130
4110 PRINT (PR.LFN)@(MX_MID+8),O2$(1,MX_MID); LINE$=LINE$+" "+O2$(1,MX_MID)+$0A$
4120 O2$=":"+O2$(MX_MID+1)
4130 IF O2$+O1$<>"" THEN GOTO 4040
4135 PRINT (PR.LFN)'LF',; PR.LFT=PR.LFT-1
4140 IF CD$="" THEN RETURN 
4150 IF FID(0)<>FID(PR.LFN) THEN PRINT @(0,20),'CE' ! NO.ADD," Additions, ",NO.DEL," deletions, ",NO.CHG,", changes",
4160 RETURN 
4500 ! 4500 - Print page header
4510 PR.PAGE=PR.PAGE+1
4512 IF PR.PAGE<=1 THEN GOTO 4518
4514 IF FID(0)<>FID(PR.LFN) THEN GOTO 4518
4516 INFO$="More output to follow.  Continue?",OPTS$="Continue"; GOSUB 5000; IF OPT$="Q" THEN EXITTO 9000
4518 IF FID(0)=FID(PR.LFN) THEN PRINT (PR.LFN)'CS' ! ELSE PRINT (PR.LFN)'FF',
4519 IF NOT(HEADER_DONE) THEN HEADER_DONE=1; IF NO.ADD+NO.DEL+NO.CHG<>0 THEN PRINT (PR.LFN)'LF',DAY,INT(TIM):"##0:",FPT(TIM)*60:"00",@(INT((MX_COL+1-LEN(PR.TTL$))/2)),PR.TTL$,'LF',DIM(MX_COL,"-")
4520 IF NO.ADD+NO.DEL+NO.CHG<>0 THEN PRINT (PR.LFN)'LF',TTL.3$,'LF',DIM(MX_COL,"-")
4530 PR.LFT=MX_LINE,COMP$=""
4535 HEADER$=TTL.3$
4540 RETURN 
4600 ! 4600 - Sub Heading
4605 SUB_HEADING:
4607 IF PR.LFT<3 THEN COMP$=""; GOSUB 4500; GOTO 4640
4610 IF NO.ADD+NO.DEL+NO.CHG<>0 THEN PRINT (PR.LFN)'LF',COMP$
4620 IF NO.ADD+NO.DEL+NO.CHG<>0 THEN PRINT (PR.LFN)DIM(MX_COL,"-")
4630 PR.LFT=PR.LFT-3,COMP$=""
4640 RETURN 
5000 ! 5000 - Display title/options
5010 X$=" "+PAD(OPTS$+" Quit",79)
5020 PRINT @(0,0),'RM','BR',PAD(INFO$,80),@(0,1),X$,'RM',
5030 O=0; IF DEF_OPT$<>"" THEN O=POS(" "+DEF_OPT$=X$),DEF_OPT$=""
5040 IF O=0 THEN O=1
5050 OPT$=X$(O+1,1),L=POS(" "=X$(O+1))+1
5060 MSE_DOWN=0
5100 ! 5100 - Get option
5110 PRINT 'YELLOW',@(O-1,1),X$(O,L),'RM',
5120 COUNT+=1; OBTAIN (0,SIZ=1,HLP=X$(O+1,1))@(O-1,1),'BI',O$,'EI'
5125 ANT=CTL
5127 ! IF CTL=5 THEN GOSUB CLIP
5130 IF CTL=-1080 THEN GOTO 5450
5140 PRINT 'BR',@(O-1,1),X$(O,L),'RM',
5150 IF CTL>=0 THEN ON CTL GOTO 5400,5350,5300,5230,5230,5240
5160 IF CTL=-1081 THEN IF MSE_DOWN=0 THEN GOTO 5100 ELSE GOTO 5400
5170 IF CTL>-1000 THEN CALL "*control"; GOTO 5100
5180 IF CTL=-1003 OR CTL=-1004 OR CTL=-1016 THEN GOTO 5350
5190 IF CTL=-1005 OR CTL=-1015 THEN GOTO 5300
5200 IF CTL=-1010 THEN O=1; GOTO 5330
5210 IF CTL=-1018 THEN GOTO 5370
5220 PRINT 'RB',; GOTO 5100
5230 O$="Q"
5240 IF O$=" " THEN GOTO 5300 ELSE O$=UCS(O$)
5250 P=POS(" "+O$=X$); IF P=0 THEN PRINT 'RB',; GOTO 5100
5260 OPT$=O$,O=P,L=POS(" "=X$(O+1))+1; GOTO 5400
5300 ! 5300 - Forward
5310 OPT$=X$(O+L,1),O=O+L-1
5320 IF OPT$=" " THEN O=1,OPT$=X$(2,1)
5330 L=POS(" "=X$(O+1))+1; GOTO 5100
5350 ! 5350 - Backward
5360 O=POS(" "=X$(1,O-1),-1); IF O<>0 THEN L=POS(" "=X$(O+1))+1,OPT$=X$(O+1,1); GOTO 5100
5370 O=LEN(STP(X$,2)); GOTO 5360
5400 ! 5400 - Return - selection made
5410 PRINT 'GREEN',@(O-1,1),X$(O,L),'RM'
5420 IF OPT$="Q" THEN EXITTO 9000 ELSE RETURN 
5450 ! 5450 - Mouse follow logic
5460 MSE_DOWN=1,O$=MSE; O__C=DEC(O$(2,1))+1,O1=MAX(1,POS(" "=STP(X$(1,O__C),1),-1))
5470 IF O=O1 THEN GOTO 5120 ELSE PRINT 'BR',@(O-1,1),X$(O,L),'RM',; O=O1,OPT$=X$(O+1,1)
5480 IF OPT$=" " THEN GOTO 5370 ELSE GOTO 5330
5500 ! 5500 - Get input
5510 REM PRINT @(0,0),'RM','BR',PAD(INFO$,80),@(0,1),PAD(QUEST$,80),'RM',
5520 COUNT+=1
5521 IF COUNT=1 THEN RESP$=SOURCE_DIR$ ! INPUT EDIT @(LEN(QUEST$),1),'YELLOW',RESP$,'RM'
5522 IF COUNT=2 THEN RESP$=DEST_DIR$; COUNT=0
5530 RESP$=STP(RESP$,2)
5540 RETURN 
7000 ! 7000 - Error logic
7010 PRINT IOL=8010,MSG(RET),; GOTO 0100
7020 PRINT IOL=8020,MSG(RET),; GOTO 0300
7030 PRINT IOL=8010,MSG(RET),; GOTO 0175
7040 PRINT IOL=8010,MSG(RET),; GOTO 0375
7800 ! 7800
7810 GET_FILES:
7815 DR$=PTH.1$,PG.MSK$="*",FL.LST$="",FL_LST=0,FL_TMP=0
7820 CALL "*gflst",DR$,PG.MSK$,FL.LST$,"N"
7824 IF CTL=4 AND PG.MSK$<>"" THEN GOTO 7830
7826 REM IF CTL>0 AND CTL<>2 AND CTL<>100 THEN EXITTO 9000
7830 IF PG.MSK$="" THEN GOTO 7890
7835 PRINT @(29,12),"(Scanning directory)",
7840 DR$=PTH.1$,FL.LST$=""; CALL "*file.lst;list_to_file",FL.LST$,DR$,PG.MSK$,"P"
7850 DR$=PTH.2$,FL.TMP$=""; CALL "*file.lst;list_to_file",FL.TMP$,DR$,PG.MSK$,"P"
7855 IF POS("FILNUM="=FL.TMP$) THEN GOTO 7900
7860 ! 
7870 X=POS(SEP=FL.TMP$); IF X=0 THEN GOTO 7885
7875 X$=FL.TMP$(1,X),FL.TMP$=FL.TMP$(X+1),X=POS(SEP+X$=SEP+FL.LST$); IF X=0 THEN FL.LST$=FL.LST$+X$
7880 GOTO 7870
7885 FL.LST$=SRT(FL.LST$)
7886 PRINT @(29,12),'CL',
7890 RETURN 
7900 ! ^100
7910 X=POS("FILNUM="=FL.LST$); IF X=0 THEN GOTO 7860 ELSE FL_LST=NUM(FL.LST$(8))
7920 X=POS("FILNUM="=FL.TMP$); IF X=0 THEN GOTO 7860 ELSE FL_TMP=NUM(FL.TMP$(8))
7930 READ (FL_TMP,KEY="",ERR=*NEXT)
7940 READ (FL_TMP,END=7970)X$
7950 WRITE (FL_LST,KEY=X$,DOM=*NEXT)X$
7960 GOTO 7940
7970 ! 
7980 X$=PTH(FL_TMP); CLOSE (FL_TMP); IF POS("*memory*"=LCS(X$))=0 THEN ERASE X$,ERR=*NEXT
7985 READ (FL_LST,KEY="",ERR=*NEXT)
7990 RETURN 
8000 ! 8000 - Iolists
8010 IOLIST @(0,20),'RB','CL'
8020 IOLIST @(0,20),'CL'
9000 ! 9000 - Wrapup
9010 PRINT @(0,22),'CL' ! ,"End of comparision",'LF','MODE'(SV_MODE$),'DF','CE',
9015 SET_PARAM 'SD'=SV_SD
9020 REM IF PR.LFN<>0 THEN CALL "*pr.abt",PR.LFN
9030 CLOSE (WK.LFN)
9035 REM CLOSE (PR.LFN)
9040 IF LFN.1<>0 THEN CLOSE (LFN.1)
9050 IF LFN.2<>0 THEN CLOSE (LFN.2)
9060 IF WRK.1$<>"" THEN ERASE WRK.1$
9070 IF WRK.2$<>"" THEN ERASE WRK.2$
9999 EXIT ; REM END 
10000 REM "ERROR PROCESSING
10010 IF ERR=69 THEN GOTO 10220
10020 Y5=ERR,Y6=TCB(5)
10040 SETERR 10050; Y8$=LST(PGM(Y6))
10050 SETERR 10000
10060 REM CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
10065 IF %PAN_ON THEN MSGBOX QUO+STR(ERR)+QUO+" is the error number.",MSG("RE-ENTER File Name"),"!" ELSE _FILE_NO_5=HFN; OUTPUT_FILE3$="[WDX]c:\temp\DEVCM0.ERR."+STP(DAY,3,"/")+".txt"; _FILE_NO_5=HFN; SERIAL OUTPUT_FILE3$,ERR=*PROCEED; OPEN LOCK (_FILE_NO_5,ERR=*NEXT)OUTPUT_FILE3$; PRINT (_FILE_NO_5)QUO+STR(ERR)+QUO+" is the error number."; CLOSE (_FILE_NO_5)
10070 REM 
10080 GOTO 10245; REM ON Y7 GOTO 10100,10150,10245,10110,10140
10090 REM 
10100 RETRY 
10110 SETERR 10130
10120 EXECUTE Y7$
10130 SETERR 10000; RETRY 
10140 SETERR 0000; RETRY 
10150 REM " TRANSFER CONTROL
10160 GOTO 0990
10170 GOTO 10245
10180 SETESC 10210
10190 SETERR 10210
10200 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
10210 SETERR 10000; RETURN 
10220 REM "CTRL LOGIC
10230 SETERR 10000; GOSUB 6400
10240 ON C9 GOTO 1140,2040
10250 REM "END PROGRAM
10260 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
10270 SETERR 10280; Q1$=A1$; EXIT 
10280 SETESC 10210
10290 IF %GUI THEN EXIT ELSE RUN "ZMENU"
10300 REM IF %USE_NOTEPAD THEN Q$=%WDX$+%ENV_COMSPEC$+" /c NOTEPAD.EXE "+SUB(__XX$,"[WDX]",""); INVOKE HIDE Q$ ELSE INVOKE Q$
10320 REM END 
56000 REM "227983-Tool to compare two directories of source code.             
