0010 ! ARGTDD - Order Shipping History
0035 REM "5.7 - 06/24/17 - 15.443611 - crg - SSP# 291110
0037 REM "291110-Modify SM files three character BOX_NUMBER to sequence using
0040 REM "Copyright 2017 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 PROCESS "ARGTDD","../ARG/AR.EN",ORD_NUM$,SEQ_NUM$
0060 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 _SV_KR=PRM('KR'); SET_PARAM 'KR'=0 ! Ensure native handling of KEP()
0130 X2=-1; X0=-1
0140 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2
0150 ! Dims
0160 DIM SM4[12],FS1[13],FS2[29]
0170 ! IO List for SM4
0180 IOLIST SM4$,SM4{ALL}
0190 ! IO List for PO1
0200 IOLIST PO1$
0210 ! IO List for FS1
0220 IOLIST FS1$,FS1{ALL}
0230 ! IO List for FS2
0240 IOLIST FS2$,FS2{ALL}
0250 ! IO List for SM4
0260 IOLIST SM4$,SM4{ALL}
0300 ! Open Files
0310 DIM Z[NUM(X3$(60,3))]
0320 Z$="01O SM4...  02O PO1...  03O PO2...  04O FS1...  050 FS2...  06O PO3...  07O FT5...  08O FMP...  13O ZZPARM  "
0330 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0340 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0530 GOSUB GET_PO_INFO
0570 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},O,O
0960 SET_PARAM 'KR'=_SV_KR
0970 RETURN 
1000 ! Purchase Order Info
1010 GET_PO_INFO:
1020 IF LEN(ARG_1$)=9 THEN KEY_2$=ARG_1$ ELSE KEY_2$=ARG_1$+" "
1025 ORDER_NUM$=ARG_1$; LINE_NUM$=PAD(ARG_2$,3,0,"0")
1030 DIM PO1$(100); READ (Z[2],KEY=KEY_2$,DOM=GET_SO_INFO)IOL=0200
1040 ORDER_NUM$=PO1$(297,9)
1060 GOSUB GET_SHIP_INFO
1070 REFRESH_FLG=1
1090 RETURN 
1200 ! Sales Order Info
1210 GET_SO_INFO:
1220 KEY_4$=ARG_1$
1230 FIND (Z[4],KEY=KEY_4$,DOM=1270)IOL=0220
1240 ORDER_NUM$=FS1$(118,8),LINE_NUM$=PAD(ARG_2$,3,0,"0")
1250 KEY_5$=ORDER_NUM$+LINE_NUM$
1260 FIND (Z[5],KEY=KEY_5$,DOM=*NEXT)IOL=0240
1270 GOSUB GET_SHIP_INFO
1280 REFRESH_FLG=1
1290 RETURN 
1400 ! shipping information
1405 BL$=""
1410 GET_SHIP_INFO:
1411 ! DIM BOX$[1000] ! SSP#271470
1415 ORD_NUM$=PAD(ORDER_NUM$,9,1," "),IDX=0
1420 KEY_1$=ORD_NUM$(1,8) ! SSP240180 jdf
1430 READ (Z[1],KEY=KEY_1$,DOM=*NEXT)
1440 KEY_1$=KEY(Z[1],END=*RETURN)
1450 READ (Z[1],KEY=KEY_1$)IOL=0260
1460 IF KEY_1$(1,8)<>ORD_NUM$(1,8) THEN RETURN ! SSP240180 jdf
1461 BL$=""
1462 IF MID(SM4$,443,1)="Y" THEN BL$='SF'+'_CYAN'; CALL "*WINGRP;SHOW",DUPLT.GRP$ ! WO 259463
1465 D1$=SM4$(15,6); CALL "ZZWDTE;Display",D1$,A1$,A2$
1466 IDX=IDX+1,S_T$=SM4$(21,2)+":"+SM4$(23,2)
1468 VI$=STP(SM4$(31,6),2)+" - "+STP(SM4$(37,12),2) ! 245378
1470 LIST_BOX LOAD TRACK_SHIP.CTL,0,KEY_1$+SEP+BL$+STR(IDX:"000")+SEP+BL$+D1$+SEP+BL$+S_T$+SEP+BL$+VI$+SEP+BL$+SM4$(383,35)+SEP+BL$+SM4$(109,3)+SEP+BL$+STR(SM4[3]:"###,###,###.00")+SEP+BL$ ! SSP 257952 WO 259463, 291110
1475 ! BOX$[IDX]=KEY_1$
1480 GOTO 1440
1490 RETURN 
1500 SEL_LINE:
1510 ! IDX=NUM(TRACK_SHIP$(1,3),ERR=*RETURN)
1520 ! KK$=BOX$[IDX]
1530 PROCESS "SMGMCA","../SMG/SM.EN",MID(TRACK_SHIP$,1,16)
1540 RETURN 
9999 END 
56002 REM "245378- Realty Capital orders are pulling through as UPSP INTL AIR 
56004 REM "240180-Tracking info doesn't display with order history (AR2TDD) if
56005 REM "257952-Need larger tracking number field to replace 20 character   
56006 REM "259463-Inbound Freight; Add logic to first check for dup tracking  
56007 REM "271470-Program exception checking tracking numbers - 02-116062     
56008 REM "291110-Modify SM files three character BOX_NUMBER to sequence using
