0010 ! ARGKEY - First,Prior,Next,last record
0035 ! "7.0 - 08/26/08 - 11.300 - jir - SSP# 221450
0040 ! "Copyright 2008 DemandBridge, Inc.; Norcross, Georgia
0041 ! "        Licensed Software - All Rights Reserved.
1000 FIRST_REC:
1010 GOSUB SELECT_AR
1020 READ (__AR1,KEY=STP(%X3$(333,2)),DOM=*NEXT)
1030 _KEY$=KEY(__AR1,END=NO_FIRST); READ (__AR1)
1040 IF STP(%X3$(333,2))<>"" AND %X3$(333,2)<>_KEY$(1,2) THEN GOTO NO_FIRST
1050 RETURN 
2000 PRIOR_REC:
2001 ! 
2010 GOSUB SELECT_AR
3000 NEXT_REC:
3001 ! 
3010 GOSUB SELECT_AR
3020 _KEY$=KEY(__AR1,END=END_OF_FILE); READ (__AR1)
3030 IF STP(%X3$(333,2))<>"" AND %X3$(333,2)<>_KEY$(1,2) THEN GOTO END_OF_FILE
3040 RETURN 
4000 LAST_REC:
4001 ! 
4010 IF STP(%X3$(333,2))<>"" THEN READ (__AR1,KEY=%X3$(333,2)+"~~~~~~~~",DOM=PRIOR_REC)
4020 _KEY$=KEL(__AR1,ERR=NO_LAST); READ (__AR1)
4030 RETURN 
5000 SELECT_AR:
5001 ! 
5010 __AR1=FN%FFN("AR1"+%C$)
5020 IF __AR1<0 THEN __AR1=HFN; OPEN (__AR1,IOL=*)"AR1"+%C$
5030 RETURN 
6000 MESSAGE_ROUTINE:
6001 ! 
6010 NO_FIRST:
6011 ! 
6020 MSGBOX MSG("REC_NO_1ST"),"F.Y.I.","!"; EXIT 
6030 NO_LAST:
6031 ! 
6040 MSGBOX MSG("REC_NO_LST"),"F.Y.I.","!"; EXIT 
6050 END_OF_FILE:
6051 ! 
6060 MSGBOX MSG("END_OF_FIL"),"F.Y.I.","!"; EXIT 
