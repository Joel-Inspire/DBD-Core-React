0010 REM "A/R Invoice Data Entry <AR2EAV>
0020 SETESC 9300; SETERR 9000
0040 REM "Copyright 1986 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0042 REM "KMc - 12/30/87
0100 SETERR 9000; SETESC 9300
0150 GOTO 2040
0380 IOLIST H$,H[0],H[1],H[2],H[3],H[4],H[5],H[6],H[7],H[8],H[9],H[10],H[11],H[12],H[13],H[14],H[15]
0390 IOLIST I$
2000 REM "DATA SEQ
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF INT(C0)=3 THEN GOSUB 7300 ELSE IF C0>3 THEN X0=999
2040 IF X0<12 THEN GOTO 2050 ELSE ON X0-12 GOTO 3400,3450,3400,3450,3400,3450,3400,3450,3400,3450,3350,2050
2050 REM "Finish up
2060 GOSUB 7900; GOTO 9900
3350 COMM_CODE_ENTRY:
3351 IF A[20]<>0 THEN RETURN ! GOTO 2020
3352 IF P2$(7,1)<>"Y" THEN RETURN ! GOTO 2020
3355 X$="Blank means set commission code based upon line type"
3360 A$(128,5)=COMM_CODE$ ! CALL "ZZENTR","SZUX",A{ALL},A$,X4$,X3$,16,20,128,5,C0,"","{3"+X$,"","AR2EAD56","AR4","AR2MDA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 3360,3361
3365 IF POS(" "<>A$(128,5))=0 THEN GOTO 3390
3370 FIND (Z[8],KEY=A$(128,5),DOM=3360)IOL=0380
3390 RETURN ! GOTO 2020
3400 SALE_PER_ENTRY:
3401 IF A[20]<>0 THEN RETURN ! GOTO 2020
3402 J6=INT(X0/2)-6,J8=133+4*J6
3405 IF MOD(J6,2)<>0 OR J6=4 THEN I8=32 ELSE I8=16
3406 IF J6<2 THEN I9=18 ELSE IF J6<4 THEN I9=19 ELSE I9=20
3409 IF J6>0 THEN IF POS(" "<>A$(J8-4,4))=0 OR P2$(8,1)<STR(J6+1:"0") THEN RETURN ! GOTO 2020
3410 EXECUTE "A$(J8,4)=SPER_CODE_"+STR(ZZ9)+"$" ! CALL "ZZENTR","SZUX",A{ALL},A$,X4$,X3$,I8,I9,J8,4,C0,"","{3"+X$,"","AR2EAD58","AR3","AR2MBB",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 3410,3411
3415 S0=J6+1; GOSUB 8000
3419 IF POS(" "<>A$(J8,4))=0 THEN GOSUB 7900; IF J8<>133 THEN RETURN ! GOTO 2020
3420 FIND (Z[9],KEY=A$(J8,4),DOM=3410)IOL=0390
3430 IF C0<0 THEN RETURN ! GOTO 2020
3435 IF J6=0 THEN GOSUB 4500
3440 RETURN ! GOTO 2020
3450 COMM_RATE_ENTRY:
3452 J6=INT(X0/2)-6,J8=133+4*J6,J5=12+J6
3455 IF MOD(J6,2)<>0 OR J6=4 THEN I8=38 ELSE I8=22
3456 IF J6<2 THEN I9=18 ELSE IF J6<4 THEN I9=19 ELSE I9=20
3459 IF POS(" "<>A$(J8,4))=0 THEN RETURN ELSE IF J6=0 AND P2$(8,1)="1" THEN RETURN ELSE IF P2$(8,1)<STR(J6+1:"0") THEN RETURN 
3460 EXECUTE "A[J5]=COMM_AMT_"+STR(ZZ8) ! CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,I8,I9,J5,320,C0,M3$,"{3"+X$,"","AR2EAD60","","",""
3470 IF J6+1=NUM(P2$(8,1)) THEN GOSUB 7900
3490 RETURN ! GOTO 2020
4500 REM "Get commission code from 1st salesperson"
4510 IF A$(133,4)<>I$(1,4) THEN FIND (Z[9],KEY=A$(133,4),DOM=4511)IOL=0390
4520 A$(128,5)=I$(219,5)
4530 FIND (Z[8],KEY=A$(128,5),DOM=4531)IOL=0380
4535 PRINT @(16,20),A$(128,5),
4540 RETURN 
6000 REM "BACKGROUND
6005 CALL "AR2EAK",X3$,X4$,A$,A{ALL},0,"","","",G{ALL},P1$,P2$
6090 RETURN 
6200 REM "DISPLAY DATA
6210 CALL "AR2EAK",X3$,X4$,A$,A{ALL},1,C$,E$,G$,G{ALL},P1$,P2$
6240 RETURN 
6255 CALL "AR2EAK",X3$,X4$,A$,A{ALL},4,C$,E$,G$,G{ALL},P1$,P2$
6260 RETURN 
6310 CALL "AR2EAK",X3$,X4$,A$,A{ALL},5,C$,E$,G$,G{ALL},P1$
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6470 CALL "AR2EAK",X3$,X4$,A$,A{ALL},2,C$,E$,G$,G{ALL},P1$
6490 RETURN 
7300 REM 
7310 ON FPT(C0)*10 GOTO 7390,7325,7330,7390
7325 IF V8$="" THEN X0=X0+4; GOTO 7390 ELSE X0=NUM(V8$(POS(STR(X0:"00")<=V8$,2),2)); GOTO 7390
7330 IF V8$="" THEN X0=X0-6; GOTO 7335 ELSE X0=POS(STR(X0-1:"00")<=V8$,2)-2; IF X0<0 THEN X0=0; GOTO 7390 ELSE X0=NUM(V8$(X0,2)); GOTO 7390
7335 IF X0<0 THEN X0=0; GOTO 7390
7390 C0=3; RETURN 
7900 REM "Check for 100% addition
7905 IF POS(" "<>A$(133,20))=0 THEN RETURN 
7907 T6=0,T7=-1
7910 FOR I=0 TO NUM(P2$(8,1))-1
7915 IF A$(133+I*4,4)="    " THEN A[I+12]=0; GOTO 7940
7920 T7=I,T6=T6+A[I+12]
7940 NEXT I
7944 IF D6$="*" THEN D6$=""; RETURN 
7945 IF T7=-1 THEN GOTO 7990 ELSE IF T6=100 THEN GOTO 7990
7950 A[T7+12]=A[T7+12]+100-T6
7960 CALL "AR2EAK",X3$,X4$,A$,A{ALL},7,C$,E$,G$,G{ALL},P1$,P2$
7990 RETURN 
8000 REM " move salesperson codes up
8010 IF POS(" "<>A$(129+S0*4,4))<>0 THEN RETURN 
8020 FOR I=S0-1 TO 3
8030 I0=K9+I*4,A$(133+I0,4)=A$(137+I0,4),A[I+12]=A[I+13]
8034 IF I=3 THEN A$(137+I0,4)="",A[16]=0
8035 NEXT I
8041 D6$="*"; GOSUB 7900
8042 CALL "AR2EAK",X3$,X4$,A$,A{ALL},7,C$,E$,G$,G{ALL},P1$,P2$
8045 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 Y8$=""
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9900 REM "End
9910 RUN "AR2EAB"
9999 END 
