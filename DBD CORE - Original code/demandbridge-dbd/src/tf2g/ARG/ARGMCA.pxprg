0010 ! ARGMCA - A/R Terms Code Setup
0020 ! Generated by ProvideX® NOMADS II File Maintenance on May. 15, 2003 10:00
0035 REM "5.7 - 12/26/17 - 13.093333 - tma - SSP# 297080
0037 REM "297080-ARGMCA - Days until due.  This is not zero filling in GUI   
0040 REM "Copyright 2017 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 PROCESS "ARGMCA","../ARG/AR.EN"
0060 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0$="AR2MCA",X1$="Terms Code Setup"
0140 ! 
0150 X0=-1,X2=-1
0160 CALL "ZZCOMP",X0$,X11$,X2$,X3$,X4$,X5$,X0,X1,X2; IF X1>0 THEN GOSUB WRAPUP
0170 ! 
0190 DIM Z[NUM(X3$(60,3))],AR2[2],B_AR2[2]
0200 ! Files
0210 Z$="01O AR2...  06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0
0300 ! IOList Section
0310 IOLIST AR2$,AR2{ALL}
0320 IOLIST GL1$
0400 ! System Parameters
0410 GOSUB GET_SYS_PARAM
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0520 IF X3$(330,1)="1" OR OP_SEC$(65,1)="Y" THEN {
0530 MSGBOX MSG("AR_SETNO"),MSG("WARNING"),"STOP"
0540 CMD_STR$="END"; EXIT  }
0550 ! 
0560 IF AR_PARM$(130,1)="Y" THEN CALL "*wingrp;show",CREDIT.GRP$
0780 REFRESH_FLG=1
0790 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
1000 ! find Record
1010 FIND_REC:
1012 IF STP(TERMS_CODE$)="" THEN NEXT_ID=TERMS_CODE.CTL; RETURN ! SSP#231740
1015 TERMS_CODE$=PAD(TERMS_CODE$,2,1,"0")
1020 KEY_1$=TERMS_CODE$
1030 FIND (Z[1],KEY=KEY_1$,DOM=TERM_MSG)IOL=0310
1040 ! 
1050 TERMS_DESC$=AR2$(3,30); EXCEPTION_CODE$=AR2$(55,2)
1060 TERMS_TYPE$=AR2$(33,1)
1065 IF TERMS_TYPE$="P" THEN CALL "*wingrp;Enable",DAY.GRP$; CALL "*wingrp;Disable",PER.GRP$ ELSE CALL "*wingrp;Disable",DAY.GRP$; CALL "*wingrp;Enable",PER.GRP$
1070 DAYS_TILL_DUE$=AR2$(34,3); DAYS_IN_PERIOD$=AR2$(37,2) ! SSP#297080
1080 CUTOFF_DAY$=AR2$(39,2); SECOND_DUE_DAY$=AR2$(41,2)
1090 DISC_DUE_DATE_TYPE$=AR2$(43,1); DAYS_TILL_DUE_2ND$=AR2$(44,3) ! SSP#297080 
1100 DUE_DAY$=AR2$(47,2); CUTOFF_DAY_2ND$=AR2$(49,2)
1110 DISC_DUE_DAY$=AR2$(51,3)
1120 DISC_PRCNT_ALLOWED=AR2[0]
1130 NUM_SPLIT_INV_PYMNTS=AR2[1]; NUM_DAYS_BETWEEN=AR2[2]
1140 SPLIT_PYMNT_TYPE$=AR2$(54,1)
1150 CRED_CARD$=AR2$(57,1); PRINT_INVOICE$=AR2$(58,1); GL_ACCT_CC_ORD$=AR2$(59,12); IF CRED_CARD$<>"Y" THEN PRINT_INVOICE$="N" ! SSP#231850
1155 CALL "*wingrp;Enable",HEAD.GRP$
1160 CALL "*wingrp;Enable",BUTTON_1.GRP$; CALL "*wingrp;Enable",BUTTONS.GRP$; CALL "*wingrp;Enable",FIELDS.GRP$
1165 IF DISC_DUE_DATE_TYPE$="P" THEN CALL "*wingrp;Disable",PER2.GRP$; CALL "*wingrp;Enable",DAY2.GRP$ ELSE CALL "*wingrp;Disable",DAY2.GRP$; CALL "*wingrp;Enable",PER2.GRP$ END_IF ; IF STP(DISC_DUE_DATE_TYPE$)<>"" THEN CALL "*wingrp;Enable",DISC_PRCNT.GRP$ ELSE CALL "*wingrp;Disable",DISC_PRCNT.GRP$ ! ssp#293149
1166 CREDIT_CARD_INFO$=AR2$(71,1); IF CRED_CARD$<>"Y" THEN CREDIT_CARD_INFO$="N" ! SSP 225020 SSP#231850
1170 B_AR2$=AR2$; B_AR2[0]=AR2[0]; B_AR2[1]=AR2[1]; B_AR2[2]=AR2[2]
1180 REFRESH_FLG=1
1190 RETURN 
1500 ! Write Record
1510 WRITE_REC:
1520 ! MSGBOX MSG("ADD_RECORD"),MSG("CONFIRM"),"?,YesNo",ANS$
1530 ! IF ANS$="NO" THEN RETURN 
1540 WRITE (Z[1],KEY=KEY_1$)IOL=0310
1550 ! MSGBOX "Record Updated!","FYI","!" SSP 199256
1580 B_APX$=APX$; B_AR2[0]=AR2[0]; B_AR2[1]=AR2[1]
1585 GOSUB CLEAR_REC; REFRESH_FLG=1
1590 RETURN 
2000 ! Load Information
2010 LOAD_INFO:
2015 TERMS_CODE$=AR2$(1,2)
2020 TERMS_DESC$=AR2$(3,30); EXCEPTION_CODE$=AR2$(55,2)
2023 CALL "*wingrp;Enable",FIELDS.GRP$; CALL "*WINGRP;ENABLE",BUTTONS.GRP$ ! SSP 190571
2025 TERMS_TYPE$=AR2$(33,1)
2027 IF TERMS_TYPE$="P" THEN CALL "*wingrp;Enable",DAY.GRP$; CALL "*wingrp;Disable",PER.GRP$ ELSE CALL "*wingrp;Disable",DAY.GRP$; CALL "*wingrp;Enable",PER.GRP$
2030 DAYS_TILL_DUE$=AR2$(34,3); DAYS_IN_PERIOD$=AR2$(37,2) ! SSP#297080 
2035 CUTOFF_DAY$=AR2$(39,2); SECOND_DUE_DATE$=AR2$(41,2)
2040 DISC_DUE_DATE_TYPE$=AR2$(43,1); DAYS_TILL_DUE_2ND=NUM(AR2$(44,3))
2043 IF DISC_DUE_DATE_TYPE$="P" THEN CALL "*wingrp;Disable",PER2.GRP$; CALL "*wingrp;Enable",DAY2.GRP$ ELSE CALL "*wingrp;Disable",DAY2.GRP$; CALL "*wingrp;Enable",PER2.GRP$ END_IF ; IF STP(DISC_DUE_DATE_TYPE$)<>"" THEN CALL "*wingrp;Enable",DISC_PRCNT.GRP$ ELSE CALL "*wingrp;Disable",DISC_PRCNT.GRP$ ! ssp#293149
2045 DUE_DAY$=AR2$(47,2); CUTOFF_DAY_2ND$=AR2$(49,2)
2050 DISC_DUE_DAY$=AR2$(51,3)
2055 DISC_PRCNT_ALLOWED=AR2[0]
2060 NUM_SPLIT_INV_PYMNTS=AR2[1]; NUM_DAYS_BETWEEN=AR2[2]
2070 SPLIT_PYMNT_TYPE$=AR2$(54,1)
2080 CRED_CARD$=AR2$(57,1); PRINT_INVOICE$=AR2$(58,1); GL_ACCT_CC_ORD$=AR2$(59,12); IF CRED_CARD$<>"Y" THEN PRINT_INVOICE$="N" ! SSP#231850    
2160 CALL "*wingrp;Enable",BUTTON_1.GRP$; CALL "*wingrp;Enable",TERM.GRP$; CALL "*wingrp;Enable",FIELDS.GRP$
2165 CREDIT_CARD_INFO$=AR2$(71,1); IF CRED_CARD$<>"Y" THEN CREDIT_CARD_INFO$="N ! SSP 225020  SSP#231850"
2170 B_AR2$=AR2$; B_AR2[0]=AR2[0]; B_AR2[1]=AR2[1]; B_AR2[2]=AR2[2]
2180 REFRESH_FLG=1
2190 RETURN 
2300 ! Load Slections
2310 LOAD_SELECTION:
2312 IF STP(TERMS_CODE$)="" THEN RETURN ! SSP 199256
2315 AR2$=PAD(AR2$,100)
2320 AR2$(1,2)=TERMS_CODE$
2330 AR2$(3,30)=TERMS_DESC$; AR2$(55,2)=EXCEPTION_CODE$
2340 AR2$(33,1)=TERMS_TYPE$
2350 AR2$(34,3)=STR(NUM(DAYS_TILL_DUE$):"000"); AR2$(37,2)=DAYS_IN_PERIOD$ ! SSP#297080 
2360 AR2$(39,2)=CUTOFF_DAY$; AR2$(41,2)=SECOND_DUE_DATE$
2370 AR2$(43,1)=DISC_DUE_DATE_TYPE$; AR2$(44,3)=STR(NUM(DAYS_TILL_DUE_2ND$):"000") ! SSP#297080 
2380 AR2$(47,2)=DUE_DAY$; AR2$(49,2)=CUTOFF_DAY_2ND$
2390 AR2$(51,3)=DISC_DUE_DAY$
2400 AR2[0]=DISC_PRCNT_ALLOWED
2410 AR2[1]=NUM_SPLIT_INV_PYMNTS; AR2[2]=NUM_DAYS_BETWEEN
2420 AR2$(54,1)=SPLIT_PYMNT_TYPE$
2430 AR2$(57,1)=CRED_CARD$; AR2$(58,1)=PRINT_INVOICE$; AR2$(59,12)=GL_ACCT_CC_ORD$; IF CRED_CARD$<>"Y" THEN AR2$(58,1)="N",CREDIT_CARD_INFO$="N" ! SSP#231850
2440 AR2$(71,1)=CREDIT_CARD_INFO$ ! SSP 225020
2490 RETURN 
2500 ! Delete Record
2510 DELETE_REC:
2520 MSGBOX MSG("DELETE_REC"),MSG("CONFIRM"),"?,YesNo",ANS$
2530 IF ANS$="NO" THEN RETURN 
2540 REMOVE (Z[1],KEY=KEY_1$)
2550 MSGBOX "Record Deleted!","FYI","!"
2570 GOSUB CLEAR_REC
2580 REFRESH_FLG=1
2590 RETURN 
3000 ! First Record
3010 FIRST_REC:
3020 KEY_1$=KEF(Z[1],END=NO_FIRST)
3030 READ (Z[1],KEY=KEY_1$)IOL=0310
3040 GOSUB LOAD_INFO
3090 RETURN 
3200 ! Last Record
3210 LAST_REC:
3220 KEY_1$=KEL(Z[1],ERR=NO_LAST)
3230 READ (Z[1],KEY=KEY_1$)IOL=0310
3240 GOSUB LOAD_INFO
3290 RETURN 
3400 ! Prior Record
3410 PRIOR_REC:
3420 KEY_1$=KEP(Z[1],END=START_FILE)
3430 READ (Z[1],KEY=KEY_1$)IOL=0310
3440 GOSUB LOAD_INFO
3490 RETURN 
3600 ! Next Record
3610 NEXT_REC:
3620 KEY_1$=KEY(Z[1],END=END_FILE)
3630 READ (Z[1],KEY=KEY_1$)IOL=0310
3640 GOSUB LOAD_INFO
3690 RETURN 
4000 ! Field Check Section
4100 ! Due Day Verification
4110 DUE_DAY_VAL:
4120 IF NOT(NUL(DAYS_IN_PERIOD$)) THEN {
4125 IF STP(DAYS_IN_PERIOD$)="E" THEN RETURN 
4130 DAYS=NUM(DAYS_IN_PERIOD$,ERR=DAYS_ERR)
4140 IF DAYS<1 OR DAYS>31 THEN GOTO DAYS_ERR
4145 DAYS_IN_PERIOD$=STR(NUM(DAYS_IN_PERIOD$):"00"); REFRESH_FLG=1 ! SSP#291340
4150 RETURN 
4160 DAYS_ERR:
4170 PERFORM "ARGMCA;Invalid_msg"; DAYS_IN_PERIOD$=""; NEXT_ID=DAYS_IN_PERIOD.CTL; REFRESH_FLG=1
4190 RETURN 
4200 ! Due Day Verification
4210 DUE_DAY_VAL_2:
4220 IF NOT(NUL(DUE_DAY$)) THEN {
4230 IF STP(DUE_DAY$)="E" THEN RETURN 
4240 DAYS=NUM(DUE_DAY$,ERR=DAYS_ERR_2)
4250 IF DAYS<1 OR DAYS>31 THEN GOTO DAYS_ERR_2
4255 DUE_DAY$=STR(NUM(DUE_DAY$):"00"); REFRESH_FLG=1 ! SSP#291340
4260 RETURN 
4270 DAYS_ERR_2:
4280 PERFORM "ARGMCA;Invalid_msg"; DUE_DAY$=""; NEXT_ID=DUE_DAY.CTL; REFRESH_FLG=1
4290 RETURN 
5000 ! Check Changes
5010 CHECK_CHANGES:
5020 IF AR2$=B_AR2$ AND AR2[0]=B_AR2[0] AND AR2[1]=B_AR2[1] OR B_AR2$="" THEN RETURN 
5030 MSGBOX MSG("REC_ALTERD"),MSG("UPDATE"),"?,YesNo",ANS$
5040 IF ANS$="NO" THEN RETURN 
5050 GOSUB WRITE_REC
5090 RETURN 
5500 ! CLEAR RECORD
5510 CLEAR_REC:
5520 TERMS_CODE$=""
5530 TERMS_DESC$=""; EXCEPTION_CODE$=""
5540 TERMS_TYPE$=""
5550 DAYS_TILL_DUE=0; DAYS_IN_PERIOD$=""
5560 CUTOFF_DAY$=""; SECOND_DUE_DATE$=""
5570 DISC_DUE_DATE_TYPE$=""; DAYS_TILL_DUE_2ND=0
5580 DUE_DAY$=""; CUTOFF_DAY_2ND$=""
5590 DISC_DUE_DAY$=""
5595 DAYS_TILL_DUE$=""; DAYS_TILL_DUE_2ND$="" ! SSP#293149
5600 DISC_PRCNT_ALLOWED=0
5610 NUM_SPLIT_INV_PYMNTS=0; NUM_DAYS_BETWEEN=0
5620 SPLIT_PYMNT_TYPE$=""
5630 CRED_CARD$=""; PRINT_INVOICE$=""; GL_ACCT_CC_ORD$=""
5650 CALL "*wingrp;Disable",HEAD.GRP$; CALL "*wingrp;disable",TERM.GRP$
5660 CALL "*wingrp;Disable",DAY.GRP$; CALL "*wingrp;Disable",DAY2.GRP$; CALL "*wingrp;Disable",PER.GRP$; CALL "*wingrp;Disable",PER2.GRP$
5670 CALL "*wingrp;Disable",FIELDS.GRP$
5675 NEXT_ID=TERMS_CODE.CTL
5680 REFRESH_FLG=1
5685 DIM AR2$(100),B_AR2$(100),AR2[2],B_AR2[2] ! SSP 199256
5690 RETURN 
8000 ! Messages
8010 TERM_MSG:
8020 MSGBOX MSG("ADD_RECORD"),MSG("CONFIRM"),"?,YesNo",ANS$
8030 IF ANS$="NO" THEN TERMS_CODE$=""; NEXT_ID=TERMS_CODE.CTL; REFRESH_FLG=1; RETURN 
8040 NEXT_ID=TERM_DESC.CTL
8070 CALL "*wingrp;Enable",HEAD.GRP$
8080 CALL "*wingrp;Enable",BUTTONS.GRP$; CALL "*wingrp;Enable",TERM.GRP$; REFRESH_FLG=1
8090 RETURN 
8100 ! No First Record
8110 NO_FIRST:
8120 MSGBOX MSG("REC_NO_1ST"),"FYI","!"
8130 RETURN 
8200 ! No Last Record
8210 NO_LAST:
8220 MSGBOX MSG("REC_NO_LST$"),"FYI","!"
8230 RETURN 
8300 ! Start of File
8310 START_FILE:
8320 MSGBOX MSG("START_FILE"),"FYI","!"
8330 RETURN 
8400 ! End of File
8410 END_FILE:
8420 MSGBOX MSG("END_OF_FIL"),"FYI","!"
8430 RETURN 
8500 ! Invalid Day Message
8510 INVALID_MSG:
8520 MSGBOX MSG("INVALID_D"),"FYI","!"
8590 RETURN 
9000 ! Parameters
9010 GET_SYS_PARAM:
9020 READ (Z[6],KEY=X3$(9,3)+"A/R",DOM=*NEXT)AR_PARM$
9030 DIM OP_SEC$(255); READ (Z[6],KEY="osec"+X3$(40,3),DOM=*NEXT)OP_SEC$
9090 RETURN 
9999 END 
56000 ! "190571-GUI and Central - Terms Code Setup (ARGMCA), if you flip    
56001 ! "199256-Credit Card question in Terms Code setup in gui does not    
56005 ! "225020-Populate the order credit card info from the customer credit
56006 REM "231850-Able to access "Bypass Inv. Print for CC Orders" allowed    
56007 REM "297080-ARGMCA - Days until due.  This is not zero filling in GUI   
