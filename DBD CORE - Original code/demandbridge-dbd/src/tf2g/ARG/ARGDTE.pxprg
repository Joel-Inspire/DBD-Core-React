0010 ! ARGDTE - GUI - Check if G/L period to post to is closed
0035 ! "6.0 - 04/02/03 - 12.316666 - dmm
0040 ! "Copyright 2003 Computer Software Inc.; Norcross, Georgia
0041 ! "        Licensed Software - All Rights Reserved.
0090 ENTER X3$,X4$,YR$,FLAG$; REM "YR$ ="YYYYPP (YEAR+PERIOD TO BE CHECKED) FLAG$="*"  (IF THERE IS A CLOSED PERIOD)
0100 IF FLAG$="NO" THEN DISPLAY_MSG$="N",FLAG$="" ELSE DISPLAY_MSG$="Y"
0500 REM "FILES
0503 GOSUB SETUP_MESSAGES
0530 _FILE_NAME$="ZZPARM"; ZZPARM=HFN; OPEN (ZZPARM,ERR=OPEN_ERR)_FILE_NAME$
0565 GOTO CONTINUE
0570 OPEN_ERR: MSGBOX _MSG_FILOPNERR1$+QUO+_FILE_NAME$+QUO+SEP+_MSG_DIRECTORY$+LWD+SEP+_MSG_PREFIX$+PFX,MSG(ERR),"!"
0575 GOTO 9900
0580 EXIT 
0585 ! 
0590 CONTINUE:
0595 ! 
0900 REM "SET VARIABLES
0910 DIM OPER$(255),GL$(300)
1000 REM "Check Files
1020 DIM OPER$(255); READ (ZZPARM,KEY="osec"+%X3_OP_ID$,DOM=1040)OPER$(1)
1030 IF OPER$(58,1)="Y" THEN GOTO 9900
1040 READ (ZZPARM,KEY=%C$+"G/L",DOM=9900)GL$(1)
1050 IF GL$(256,1)<>"Y" THEN GOTO 9900
1100 REM 
1120 IF NUM(YR$)<NUM(GL$(34,6)) THEN FLAG$="*"
1130 IF DISPLAY_MSG$="Y" THEN IF FLAG$="*" THEN MSGBOX MSG("CLOSED_AP",GL$(34,4),GL$(38,2)),MSG("ATTN"),"!"
1190 GOTO 9900
9200 SETUP_MESSAGES:
9210 _MSG_FILOPNERR1$=MSG("FILOPNERR1")
9220 _MSG_DIRECTORY$=MSG("DIRECTORY")
9230 _MSG_PREFIX$=MSG("PREFIX")
9290 SETUP_MESSAGES_END:RETURN 
9295 ! 
9900 REM "END PROGRAM
9910 IF ZZPARM THEN CLOSE (ZZPARM)
9920 SETERR 9940
9930 EXIT 
9950 RUN "ZMENU"
9999 END 
