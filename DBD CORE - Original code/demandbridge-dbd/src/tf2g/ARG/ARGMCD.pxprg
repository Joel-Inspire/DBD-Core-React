0010 ! ARGMCD - System Customer Default Data
0030 ! ************************************************************************
0035 REM "5.7 - 11/09/12 - 15.171111 - tma - SSP# 259269
0037 REM "259269-Input Vaidation Failure message when in customer defaults   
0040 REM "Copyright 2012 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0060 PROCESS "ARGMCD","../ARG/AR.EN"
0080 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 X0$="ARGMCD"
0130 X0=-1; X2=-1
0140 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2
0150 DIM Z[NUM(X3$(60,3))]
0160 Z$="01O AR1...  06O ZZPARM  "
0165 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0170 ! IO list
0180 DIM AR1$(600),AR1[15]
0182 DIM SHA$(244),SHA[5]
0185 DIM SHB$(244),SHB[5]
0190 ! iolist for AR1
0200 IOLIST AR1$,AR1{ALL}
0210 ! iolist for AR8
0220 IOLIST AR8$,AR8{ALL}
0230 IOLIST FS6$,FS6{ALL}
0250 IOLIST FM1$,FM1{ALL}
0260 IOLIST SHA$,SHA{ALL}
0270 IOLIST SHB$,SHB{ALL}
0400 ! 
0420 %AR4$=STR(Z[5])
0450 _FILE_NAME$="AR5"+%C$; _AR5=HFN; OPEN (_AR5,ERR=OPEN_ERR,IOL=*)_FILE_NAME$ ! Customer messages                                                      
0460 RETURN 
0470 OPEN_ERR:
0472 _MSG_FILOPNERR1$=MSG("FILOPNERR1")
0474 _MSG_DIRECTORY$=MSG("DIRECTORY")
0476 _MSG_PREFIX$=MSG("PREFIX")
0480 MSGBOX _MSG_FILOPNERR1$+QUO+_FILE_NAME$+QUO+SEP+_MSG_DIRECTORY$+LWD+SEP+_MSG_PREFIX$+PFX,MSG(ERR),"!"
0485 CMD_STR$="E"
0490 EXIT 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0540 DISABLE CONTROL CUSTOMER.CTL
0550 GOSUB GET_CUST_INFO
0560 NEXT_ID=CUST_NAME.CTL,REFRESH_FLG=1
0570 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0915 CLOSE (_AR5,ERR=*NEXT) ! SSP 206525
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0930 %DESC_FILE$=""
0940 %AR4$=""
0960 SET_PARAM 'KR'=_SV_KR
0970 RETURN 
1000 ! Retrieve Customer Information
1010 GET_CUST_INFO:
1020 KEY_1$="DFLTAR2MAB"
1030 FIND (Z[6],KEY=KEY_1$,DOM=1060)IOL=0200
1040 GOSUB LOAD_DEF_INFO
1050 GOSUB LOAD_CREDIT_INFO
1060 KEY_2$="DFLTFM2SHA"; FIND (Z[6],KEY=KEY_2$,DOM=1070)IOL=0260; IF STP(ALWAYS_LOWEST_QBG$,3)="" THEN ALWAYS_LOWEST_QBG$="N",SHA$(107,1)="N" ! SSP#259269 should always default to N if blank    "
1065 GOSUB LOAD_CUST_DFLT
1070 KEY_3$="DFLTFM2SHB"; FIND (Z[6],KEY=KEY_3$,DOM=1080)IOL=0270
1075 GOSUB LOAD_CUST_PARMS
1080 REFRESH_FLG=1
1090 RETURN 
1200 CHECK_CHANGES:! ^100,5
1205 IF CHANGE_FLG THEN {
1210 MSGBOX MSG("REC_ALTERD"),MSG("UPDATE"),"?,YESNO",ANSWER$
1215 IF ANSWER$="YES" THEN GOTO WRITE_ON_EXIT
1220 CHANGE_FLG=0
1225  }
1230 REFRESH_FLG=1,CHANGE_FLG=0
1235 RETURN 
1240 ! 
1500 ! LOAD CONSTANT INFORMATION  
1510 LOAD_DEF_INFO:
1520 CUST_NAME$=AR1$(11,35)
1530 BILL_TO_CUST$=AR1$(46,10)
1540 CUST_ADDR_1$=AR1$(56,30); CUST_ADDR_2$=AR1$(86,30)
1550 CUST_CITY$=AR1$(116,16); CUST_ST$=AR1$(132,2); CUST_ZIP_CODE$=AR1$(134,9)
1560 CUST_STAT$="A"
1570 CUST_FAX$=AR1$(143,12); PURCH_AGENT$=AR1$(165,20); CUST_GREETING$=AR1$(185,20)
1580 CUST_PHONE$=AR1$(205,14); CUST_CATEGORY$=AR1$(220,9); DATE_SETUP$=AR1$(229,6)
1590 STAX_CODE$=AR1$(235,10); IF STP(STAX_CODE$,2)<>"" THEN GOSUB PROCESS_AR5
1595 TAX_EXEMPT$=AR1$(245,1); RESALE_NUM$=AR1$(246,16)
1600 SIC_CODE$=AR1$(262,5); FINANCE_CHARGE_CODE$=AR1$(267,1); STMT_CODE$=AR1$(268,1)
1610 MAILING_LABEL_TYPE_1$=AR1$(269,3); MAILING_LABEL_TYPE_2$=AR1$(272,3); MAILING_LABEL_TYPE_3$=AR1$(275,3)
1620 SPER_CODE$=AR1$(278,4); SPER_CODE_2$=AR1$(282,4); SPER_CODE_3$=AR1$(286,4)
1630 SPER_CODE_4$=AR1$(290,4); SPER_CODE_5$=AR1$(294,4)
1640 CUST_PRICE_CATEGORY$=AR1$(398,3)
1650 SPER_COMM_SPLIT_1=AR1[0]; SPER_COMM_SPLIT_2=AR1[1]; SPER_COMM_SPLIT_3=AR1[2]; SPER_COMM_SPLIT_4=AR1[3]; SPER_COMM_SPLIT_5=AR1[4]
1655 PERFORM "ARGMAB;CHECK_TOTAL"
1660 REORDER_NUM_MONTHS$=AR1$(434,2),UNITED_ACCOUNT$=AR1$(436,6),CSR_WEB_ORDERS$=AR1$(442,4),MARKET_CHANNEL$=AR1$(446,10),AUTO_REORDER_NOTICE$=AR1$(473,1) ! SSP#231397
1680 REFRESH_FLG=1
1690 RETURN 
2000 ! Load Credit Information
2010 LOAD_CREDIT_INFO:
2020 CREDIT_CONT$=AR1$(298,20),CREDIT_CONT_GREETING$=AR1$(318,20),CREDIT_CONT_PHONE$=AR1$(338,14)
2030 TERMS_CODE$=AR1$(359,2),CREDIT_RATING$=AR1$(362,5),CREDIT_RATING_DATE$=AR1$(367,6)
2040 CREDIT_LIMIT=AR1[5],CREDIT_LIMIT_DATE$=AR1$(373,6)
2050 CREDIT_HOLD$=AR1$(361,1)
2060 PRINT_DUN_LETTER$=AR1$(397,1),DUN_LETTER_LAST_PRNT$=AR1$(352,1),DUN_LETTER_LAST_DT$=AR1$(353,6)
2080 REFRESH_FLG=1
2090 RETURN 
3000 ! SAVE CONSTANT INFORMATION
3010 SAVE_INFO:
3015 DIM AR1$(600)
3020 AR1$(11,35)=CUST_NAME$
3025 ! IF UID="jvv" THEN ESCAPE 
3030 AR1$(46,10)=BILL_TO_CUST$
3040 AR1$(56,30)=CUST_ADDR_1$; AR1$(86,30)=CUST_ADDR_2$
3050 AR1$(116,16)=CUST_CITY$; AR1$(132,2)=CUST_ST$; AR1$(134,9)=CUST_ZIP_CODE$
3060 AR1$(219,1)="A"
3070 AR1$(143,12)=CUST_FAX$; AR1$(165,20)=PURCH_AGENT$; AR1$(185,20)=CUST_GREETING$
3080 AR1$(205,14)=CUST_PHONE$; AR1$(220,9)=CUST_CATEGORY$; AR1$(229,6)=DATE_SETUP$
3090 AR1$(235,10)=STAX_CODE$; AR1$(245,1)=TAX_EXEMPT$; AR1$(246,16)=RESALE_NUM$
3100 AR1$(262,5)=SIC_CODE$; AR1$(267,1)=FINANCE_CHARGE_CODE$; AR1$(268,1)=STMT_CODE$
3110 AR1$(269,3)=MAILING_LABEL_TYPE_1$; AR1$(272,3)=MAILING_LABEL_TYPE_2$; AR1$(275,3)=MAILING_LABEL_TYPE_3$
3120 AR1$(278,4)=SPER_CODE$; AR1$(282,4)=SPER_CODE_2$; AR1$(286,4)=SPER_CODE_3$
3130 AR1$(290,4)=SPER_CODE_4$; AR1$(294,4)=SPER_CODE_5$
3140 AR1$(398,3)=CUST_PRICE_CATEGORY$
3150 AR1[0]=SPER_COMM_SPLIT_1; AR1[1]=SPER_COMM_SPLIT_2; AR1[2]=SPER_COMM_SPLIT_3; AR1[3]=SPER_COMM_SPLIT_4; AR1[4]=SPER_COMM_SPLIT_5
3160 AR1$(434,2)=REORDER_NUM_MONTHS$,AR1$(436,6)=UNITED_ACCOUNT$,AR1$(442,4)=CSR_WEB_ORDERS$,AR1$(446,10)=MARKET_CHANNEL$,AR1$(473,1)=AUTO_REORDER_NOTICE$ ! SSP#231397
3170 GOSUB SAVE_CREDIT_INFO
3180 REFRESH_FLG=1
3190 RETURN 
3500 REM "Save Credit Info in AR1$ 
3510 SAVE_CREDIT_INFO:
3520 AR1$(298,20)=CREDIT_CONT$,AR1$(318,20)=CREDIT_CONT_GREETING$,AR1$(338,14)=CREDIT_CONT_PHONE$
3530 AR1$(359,2)=TERMS_CODE$,AR1$(362,5)=CREDIT_RATING$,AR1$(367,6)=CREDIT_RATING_DATE$
3540 AR1[5]=CREDIT_LIMIT,AR1$(373,6)=CREDIT_LIMIT_DATE$
3550 AR1$(361,1)=CREDIT_HOLD$
3560 AR1$(397,1)=PRINT_DUN_LETTER$,AR1$(352,1)=DUN_LETTER_LAST_PRNT$,AR1$(353,6)=DUN_LETTER_LAST_DT$
3590 RETURN 
4000 ! load information on panel
4010 LOAD_CUST_DFLT:
4015 IF NUL(SHA$) THEN RETURN 
4020 CUST_PO_REQ$=SHA$(25,1); UNIQUE_PO_REQ$=SHA$(23,1)
4030 FOB_CODE$=SHA$(28,1) ! %FOB_DESC$=FMP1$(3,15)
4040 THANK_YOU_TYPE$=SHA$(26,1); HOW_TO_SHIP_CODE$=SHA$(29,1) ! HOW_TO_SHIP_DESC$=FMP2$(3,15)
4045 WHICH_ORDER$=SHA$(105,1)
4050 PRINT_ACKNOWLEDGE$=SHA$(27,1); INSIDE_DELIVERY$=SHA$(30,15)
4060 FRT_MARKUP_TABLE$=SHA$(50,2); SHIP_VIA_CODE$=SHA$(45,1) ! SHIP_VIA_DESC$=FMP3$(3,15)
4070 FIND_FEE_TYPE$=SHA$(12,1); FIND_FEE_RATE=SHA[0]
4080 VENDOR$=SHA$(13,10) ! %VEND_NAME$=AP4$(11,35)
4090 SUMMARY_BILL_FOR_IRW$=SHA$(113,4); DETAIL_SHPMNT_REPORT$=SHA$(49,1)
4100 SUMMARY_BILL_PRINT$=SHA$(117,4)
4110 FMS_1$=SHA$(24,1); TMP_FMS$=FMS_1$; ALWAYS_LOWEST_QBG$=SHA$(107,1) ! SSP 191739
4120 RON_FORMAT$=SHA$(108,1),FOREIGN_CURR_CODE$=SHA$(90,3) ! SSP 191739
4130 REDUCE_ONHAND_BY_COMM$=SHA$(133,1)
4140 CON_PICK_LIST$=SHA$(66,1)
4270 NO_PRINT_FLG$=SHA$(102,1); IF SHA$(102,1)="Y" THEN ENABLE CONTROL FMZ_FILE.CTL ELSE DISABLE CONTROL FMZ_FILE.CTL
4295 FMZ_FILE$=SHA$(103,1)
4300 ! Freight Parameter
4390 UPDATE_CC$=SHA$(100,1); ELIM_POSTING$=SHA$(101,1); PRINT_LOT_VALUE$=SHA$(104,1)
4392 REFRESH_FLG=1
4395 RETURN 
4400 LOAD_CUST_PARMS:
4410 CURR_FY$=SHB$(52,4); CURR_ACCTPD$=SHB$(56,2)
4420 NUM_PER_FMZ_RETAIN$=SHB$(58,2); NUM_YR_STAT_RETAIN$=SHB$(60,1)
4430 DFLT_CNT_CYCLE$=SHB$(46,2); STOCK_ITEMS_FMS$=SHB$(112,1)
4440 MULTIPLE_SHIP$=SHB$(124,1); DFLT_SHIP_CODE$=SHB$(125,4)
4450 STD_WHSE$=SHB$(238,4); COST_CODE_FORMAT$=SHB$(243,1)
4460 COST_CODE_FMT$=SHB$(235,1); STORE_COST_CODE$=SHB$(236,1)
4470 ! 
4480 REFRESH_FLG=1
4990 RETURN 
5000 ! Write Default Record to ZZPARM
5010 WRITE_REC:
5020 MSGBOX MSG("UPDATE_REC"),MSG("CONFIRM"),"?,YESNO",ANS$
5030 IF ANS$="NO" THEN RETURN 
5035 ! GOSUB SAVE_INFO; GOSUB SAVE_CREDIT_INFO!SSP#231397
5038 WRITE_ON_EXIT:
5039 GOSUB SAVE_INFO; GOSUB SAVE_CREDIT_INFO ! SSP#231397
5040 WRITE (Z[6],KEY=KEY_1$)IOL=0200
5050 GOSUB SAVE_CUST_DFLT
5060 WRITE (Z[6],KEY=KEY_2$)IOL=0260
5070 GOSUB SAVE_CUST_PARMS
5080 WRITE (Z[6],KEY=KEY_3$)IOL=0270
5085 CHANGE_FLG=0 ! SSP#231397
5090 RETURN 
9999 END 
10000 ! load all the variables
10010 SAVE_CUST_DFLT:
10015 SHA$(1,1)="D"; SHA$(2,10)=CUSTOMER$
10020 SHA$(25,1)=CUST_PO_REQ$; SHA$(23,1)=UNIQUE_PO_REQ$
10030 SHA$(28,1)=FOB_CODE$; SHA$(26,1)=THANK_YOU_TYPE$
10040 SHA$(29,1)=HOW_TO_SHIP_CODE$; SHA$(27,1)=PRINT_ACKNOWLEDGE$
10041 SHA$(62,1)=REQUIRE_RC_NUM$ ! FMP[4]=MIN_PERC_MARKUP
10042 SHA$(63,1)=REQUIRE_ORD_BY$
10043 SHA$(64,2)=CCPLUS_TERMS_CD$ ! SSP 189822
10050 SHA$(30,15)=INSIDE_DELIVERY$; SHA$(50,2)=FRT_MARKUP_TABLE$
10060 SHA$(45,1)=SHIP_VIA_CODE$
10070 SHA$(12,1)=FIND_FEE_TYPE$; SHA[0]=FIND_FEE_RATE
10080 SHA$(13,10)=VENDOR$
10090 SHA$(113,4)=SUMMARY_BILL_FOR_IRW$; SHA$(49,1)=DETAIL_SHPMNT_REPORT$
10100 SHA$(117,4)=SUMMARY_BILL_PRINT$; SHA$(24,1)=FMS_1$
10110 SHA$(107,1)=ALWAYS_LOWEST_QBG$ ! SSP 191739
10115 SHA$(105,1)=WHICH_ORDER$
10120 SHA$(108,1)=RON_FORMAT$; SHA$(133,1)=REDUCE_ONHAND_BY_COMM$ ! SSP 191739
10125 SHA$(90,3)=FOREIGN_CURR_CODE$
10130 SHA$(66,1)=CON_PICK_LIST$
10140 SHA$(102,1)=NO_PRINT_FLAG$
10145 SHA$(103,1)=FMZ_FILE$
10150 SHA$(129,1)=REQ_CONTRACT$ ! [SSP-200893]
10200 ! 
10260 SHA$(100,1)=UPDATE_CC$; SHA$(101,1)=ELIM_POSTING$
10270 SHA$(104,1)=PRINT_LOT_VALUE$
10290 RETURN 
10300 SAVE_CUST_PARMS:
10310 SHB$(52,4)=CURR_FY$; SHB$(56,2)=CURR_ACCTPD$
10320 SHB$(58,2)=NUM_PER_FMZ_RETAIN$; SHB$(60,1)=NUM_YR_STAT_RETAIN$
10330 SHB$(46,2)=DFLT_CNT_CYCLE$; SHB$(112,1)=STOCK_ITEMS_FMS$
10340 SHB$(124,1)=MULTIPLE_SHIP$; SHB$(125,4)=DFLT_SHIP_CODE$
10350 SHB$(238,4)=STD_WHSE$; SHB$(243,1)=COST_CODE_FORMAT$
10360 SHB$(235,1)=COST_CODE_FMT$; SHB$(236,1)=STORE_COST_CODE$
10390 RETURN 
10400 ! 
10890 RETURN 
22000 PROCESS_AR5:
22010 DIM AR5[7]
22020 FIND (_AR5,KEY=STAX_CODE$,DOM=*NEXT)AR5$,AR5{ALL}
22030 SHOW_TAX=AR5(0)+AR5(2)+AR5(3)
22035 ! %STAX_DESC$=AR5$(11,25)
22040 REFRESH_FLG=1
22050 RETURN 
