0010 ! ARGMAH - File Maintenance Program for AR8_InvoiceHis (="AR8"+%C$)
0020 ! Generated by ProvideX® NOMADS II File Maintenance on Apr. 2, 2003 15:52
0030 ! ************************************************************************
0040 IF TCB(13)=1 THEN BEGIN 
0050 ! CUSTOMER$=%CUSTOMER$
0060 PROCESS "ARGMAB_D","../ARG/AR.EN"
0070 ! %CUSTOMER$=CUSTOMER$
0080 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 X0$="ARGMAB"
0130 X0=-1; X2=-1
0140 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2
0150 DIM Z[NUM(X3$(60,3))]
0160 Z$="01O AR1...  06O ZZPARM  "
0165 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0170 ! IO list
0180 DIM AR1[15]
0190 ! iolist for AR1
0200 IOLIST AR1$,AR1{ALL}
0210 ! iolist for AR8
0220 IOLIST AR8$,AR8{ALL}
0230 IOLIST FS6$,FS6{ALL}
0250 IOLIST FM1$,FM1{ALL}
0400 ! 
0420 %AR4$=STR(Z[5])
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0540 DISABLE CONTROL CUSTOMER.CTL
0550 GOSUB GET_CUST_INFO
0560 NEXT_ID=CUST_NAME.CTL,REFRESH_FLG=1
0570 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0930 %DESC_FILE$=""
0940 %AR4$=""
0960 SET_PARAM 'KR'=_SV_KR
0970 RETURN 
1000 ! Retrieve Customer Information
1010 GET_CUST_INFO:
1020 KEY_1$="DFLTAR2MAB"
1030 FIND (Z[6],KEY=KEY_1$,DOM=*RETURN)IOL=0200
1040 GOSUB LOAD_DEF_INFO
1080 REFRESH_FLG=1
1090 RETURN 
1500 ! Load Defualt Informatin  
1510 LOAD_DEF_INFO:
1520 CUST_NAME$=AR1$(11,35)
1530 BILL_TO_CUST$=AR1$(46,10)
1540 CUST_ADDR_1$=AR1$(56,30); CUST_ADDR_2$=AR1$(86,30)
1550 CUST_CITY$=AR1$(116,16); CUST_ST$=AR1$(132,2); CUST_ZIP_CODE$=AR1$(134,9)
1560 CUST_STAT$="A"
1570 CUST_FAX$=AR1$(143,12); PURCH_AGENT$=AR1$(165,20); CUST_GREETING$=AR1$(185,20)
1580 CUST_PHONE$=AR1$(205,14); CUST_CATEGORY$=AR1$(220,9); DATE_SETUP$=AR1$(229,6)
1590 STAX_CODE$=AR1$(235,10); TAX_EXEMPT$=AR1$(245,1); RESALE_NUM$=AR1$(246,16)
1600 SIC_CODE$=AR1$(262,5); FINANCE_CHARGE_CODE$=AR1$(267,1); STMT_CODE$=AR1$(268,1)
1610 MAILING_LABEL_TYPE_1$=AR1$(269,3); MAILING_LABEL_TYPE_2$=AR1$(272,3); MAILING_LABEL_TYPE_3$=AR1$(275,3)
1620 SPER_CODE$=AR1$(278,4); SPER_CODE_2$=AR1$(282,4); SPER_CODE_3$=AR1$(286,4)
1630 SPER_CODE_4$=AR1$(290,4); SPER_CODE_5$=AR1$(29,4)
1640 CUST_PRICE_CATEGORY$=AR1$(398,3)
1650 SPER_COMM_SPLIT_1=AR1[0]; SPER_COMM_SPLIT_2=AR1[1]; SPER_COMM_SPLIT_3=AR1[2]; SPER_COMM_SPLIT_4=AR1[3]; SPER_COMM_SPLIT_5=AR1[4]
1680 REFRESH_FLG=1
1690 RETURN 
3000 ! INVOICE HISTORY INFORMATION
3010 LOAD_INFO:
3015 DIM AR1$(600)
3020 AR1$(11,35)=CUST_NAME$
3030 AR1$(46,10)=BILL_TO_CUST$
3040 AR1$(56,30)=CUST_ADDR_1$; AR1$(86,30)=CUST_ADDR_2$
3050 AR1$(116,16)=CUST_CITY$; AR1$(132,2)=CUST_ST$; AR1$(134,9)=CUST_ZIP_CODE$
3060 AR1$(219,1)="A"
3070 AR1$(143,12)=CUST_FAX$; AR1$(165,20)=PURCH_AGENT$; AR1$(185,20)=CUST_GREETING$
3080 AR1$(205,14)=CUST_PHONE$; AR1$(220,9)=CUST_CATEGORY$; AR1$(229,6)=DATE_SETUP$
3090 AR1$(234,10)=STAX_CODE$; AR1$(245,1)=TAX_EXEMPT$; AR1$(246,16)=RESALE_NUM$
3100 AR1$(262,5)=SIC_CODE$; AR1$(267,1)=FINANCE_CHARGE_CODE$; AR1$(268,1)=STMT_CODE$
3110 AR1$(269,3)=MAILING_LABEL_TYPE_1$; AR1$(272,3)=MAILING_LABEL_TYPE_2$; AR1$(275,3)=MAILING_LABEL_TYPE_3$
3120 AR1$(278,4)=SPER_CODE$; AR1$(282,4)=SPER_CODE_2$; AR1$(286,4)=SPER_CODE_3$
3130 AR1$(290,4)=SPER_CODE_4$; AR1$(29,4)=SPER_CODE_5$
3140 AR1$(398,3)=CUST_PRICE_CATEGORY$
3150 AR1[0]=SPER_COMM_SPLIT_1; AR1[1]=SPER_COMM_SPLIT_2; AR1[2]=SPER_COMM_SPLIT_3; AR1[3]=SPER_COMM_SPLIT_4; AR1[4]=SPER_COMM_SPLIT_5
3180 REFRESH_FLG=1
3190 RETURN 
5000 ! Write Default Record to ZZPARM
5010 WRITE_REC:
5020 MSGBOX MSG("ADD_RECORD"),MSG("CONFIRM"),"?,YESNO",ANS$
5030 IF ANS$="NO" THEN RETURN 
5040 WRITE (Z[6],KEY=KEY_1$)IOL=0200
5090 RETURN 
