0010 ! ARGMPA - File Maintenance Program for APX_GLInterface (="APX"+%C$)
0035 REM "5.7 - 03/01/18 - 12.385833 - jvv - SSP# 298391
0037 REM "298391-Ability to send E/F emails of Invoices after SJ Update      
0040 REM "Copyright 2018 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 PROCESS "ARGMPA","../PMG/PM.EN"
0060 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0$="AR2MPA",X1$="Account Receivable Parameter Setup"
0140 ! 
0150 X0=-1,X2=-1
0160 CALL "ZZCOMP",X0$,X11$,X2$,X3$,X4$,X5$,X0,X1,X2; IF X1>0 THEN GOSUB WRAPUP
0170 ! 
0190 DIM Z[NUM(X3$(60,3))],PARAM[8],PARAM_2[29],PARAM_3[8],B_PARAM[8],B_PARAM_2[29],B_PARAM_3[8] ! 232358  
0200 ! Files
0210 Z$="06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0
0300 ! IOList Section
0310 IOLIST PARAM$,PARAM{ALL}
0320 IOLIST PARAM_2$,PARAM_2{ALL}
0330 IOLIST PARAM_3$,PARAM_3{ALL} ! 232358
0400 ! System Parameters
0420 GOSUB GET_SYS_PARAM
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0790 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
2000 ! Load Screen with Parameter Information
2010 LOAD_SCREEN_1:
2015 GOSUB LOAD_FY
2020 AR.A001$=PARAM$(7,4); AR.A002$=PARAM$(11,2); AR.A003$=PARAM$(13,1)
2030 AR.A004$=PARAM$(14,1); AR.A005$=PARAM$(15,1); AR.A006$=PARAM$(16,1)
2040 AR.A013$=PARAM$(43,3); AR.A008$=PARAM$(19,1); AR.A009$=PARAM$(20,1)
2050 ARG.A010$=PARAM$(21,10); ARG.A011$=PARAM$(31,10); ARG.A012$=PARAM$(41,2)
2060 ARG.A025$=PARAM$(98,1)
2070 STAT_VAL$=PARAM$(21,10); ARG.A010$=STP(ARG.A010$)
2080 REFRESH_FLG=1
2090 RETURN 
2100 ! Parameter Screen 2
2105 LOAD_SCREEN_2:
2110 AR.A014$=PARAM$(46,1); AR.A023$=PARAM$(96,1); AR.A015$=PARAM$(47,1)
2115 IF NUL(PARAM$(48,8)) THEN PARAM$(48,40)="Current Over 30 Over 60 Over 90 Over 120",PARAM[0]=0,PARAM[1]=31,PARAM[2]=61,PARAM[3]=91,PARAM[4]=120
2120 AR.A016$=PARAM$(48,8); AR.A017$=PARAM$(56,8); AR.A018$=PARAM$(64,8)
2130 AR.A019$=PARAM$(72,8); AR.A020$=PARAM$(80,8)
2135 IF AR.A015$="Y" THEN CALL "*WINGRP;SHOW",DAYS.GRP$ ELSE CALL "*WINGRP;HIDE",DAYS.GRP$
2140 ARA001=PARAM[0]; ARA002=PARAM[1]; ARA003=PARAM[2]
2150 ARA004=PARAM[3]; ARA005=PARAM[4]
2160 AR.A026$=PARAM$(99,1); ARA006=PARAM[5]; ARA007=PARAM[6]; ARA008=PARAM[7]
2170 AR.A021$=PARAM$(88,1); AR.A036$=PARAM$(116,1); AR.A022$=PARAM$(89,7); AR.A024$=PARAM$(97,1); ARA009=PARAM[8]
2180 REFRESH_FLG=1
2190 RETURN 
2200 ! LOAD SCREEN 3
2210 LOAD_SCREEN_3:
2220 AR1.A001$=PARAM_2$(7,1)
2230 AR1.A012$=PARAM_2$(37,5); AR1.A013$=PARAM_2$(42,5); AR1.A014$=PARAM_2$(47,5)
2240 AR1.A015$=PARAM_2$(52,5); AR1.A016$=PARAM_2$(57,5); AR1.A025$=PARAM_2$(70,5)
2250 AR1.A023$=PARAM_2$(68,1); AR1.A017$=PARAM_2$(62,1); AR1.A018$=PARAM_2$(63,1)
2260 AR1.A019$=PARAM_2$(64,1); AR1.A020$=PARAM_2$(65,1); AR1.A021$=PARAM_2$(66,1)
2270 AR1.A022$=PARAM_2$(67,1); AR1.A024$=PARAM_2$(69,1)
2275 AR1.A026$=PARAM_2$(75,1) ! SSP 217566
2276 AR1.A027$=PARAM_2$(76,1) ! SSP 222237
2277 AR1.A028$=PARAM_2$(77,1) ! SSP 225300
2280 REFRESH_FLG=1
2290 RETURN 
2300 ! LOAD SCREEN 4 PARAMETERS
2310 LOAD_SCREEN_4:
2320 AR1.A002$=PARAM_2$(8,1); AR1.A003$=PARAM_2$(9,10); AR1.A004$=PARAM_2$(19,10)
2330 AR1.A008$=PARAM_2$(32,1); AR1.A009$=PARAM_2$(33,1); AR1.A011$=PARAM_2$(36,1)
2340 AR1A001=PARAM_2[0]; AR1A004=PARAM_2[3]; AR1A007=PARAM_2[6]
2350 AR1A016=PARAM_2[15]; AR1A017=PARAM_2[16]; AR1A018=PARAM_2[17]
2360 AR1A002=PARAM_2[1]; AR1A005=PARAM_2[4]; AR1A008=PARAM_2[7]
2370 AR1A019=PARAM_2[18]; AR1A020=PARAM_2[19]; AR1A021=PARAM_2[20]
2380 AR1A003=PARAM_2[2]; AR1A006=PARAM_2[5]; AR1A009=PARAM_2[8]
2390 AR1A022=PARAM_2[21]; AR1A023=PARAM_2[22]; AR1A024=PARAM_2[23]
2400 AR1A010=PARAM_2[9]; AR1A012=PARAM_2[11]; AR1A014=PARAM_2[13]
2410 AR1A025=PARAM_2[24]; AR1A026=PARAM_2[25]; AR1A027=PARAM_2[26]
2420 AR1A011=PARAM_2[10]; AR1A013=PARAM_2[12]; AR1A015=PARAM_2[14]
2430 AR1A028=PARAM_2[27]; AR1A029=PARAM_2[28]; AR1A030=PARAM_2[29]
2470 AR1.A003$=STP(AR1.A003$); STAT_VAL2$=AR1.A003$
2480 REFRESH_FLG=1
2490 RETURN 
2500 ! LOAD SCREEN 5 PARAMETERS
2510 LOAD_SCREEN_5:
2520 AR.A028$=PARAM$(107,1); AR.A029$=PARAM$(108,1); AR.A030$=PARAM$(109,1)
2530 AR.A031$=PARAM$(110,2); AR.A032$=PARAM$(112,1); AR.A033$=PARAM$(113,1)
2540 AR.A034$=PARAM$(114,1); AR.A035$=PARAM$(115,1); AR.A037$=PARAM$(117,1)
2550 AR.A038$=PARAM$(118,1); AR.A039$=PARAM$(119,1); AR.A040$=PARAM$(120,1)
2560 AR.A041$=PARAM$(121,1); AR.A042$=PARAM$(122,1); AR.A043$=PARAM$(123,1)
2570 AR.A044$=PARAM$(124,1); AR.A045$=PARAM$(125,1)
2580 REFRESH_FLG=1
2590 RETURN 
2600 ! LOAD SCREEN 6 PARAMETERS
2610 LOAD_SCREEN_6:
2620 AR.A046$=PARAM$(126,1); AR.A047$=PARAM$(127,1); AR.A048$=PARAM$(128,1)
2623 GOSUB CREDIT_CARD_MOD; IF CREDIT_CARD$="Y" OR CC_PLUS$="Y" OR CC_VAULT$="Y" THEN CALL "*WINGRP;ENABLE",CC.GRP$ ELSE AR.A048$="N"; CALL "*WINGRP;DISABLE",CC.GRP$ ! SSP 212569 SSP 229993 
2625 IF AR.A048$="Y" THEN CALL "*WINGRP;ENABLE",LOC.GRP$ ELSE CALL "*WINGRP;DISABLE",LOC.GRP$
2630 AR.A049$=PARAM$(129,1); AR.A050$=PARAM$(130,1); AR.A052$=PARAM$(135,1); AR.A051$=PARAM$(131,3)
2635 IF NOT(NUL(AR.A051$)) THEN GOSUB 7600 ! SSP#253153
2640 AR.A053$=PARAM$(136,40); AR.A054$=PARAM$(176,1); AR.A058$=PARAM$(178,1); AR.A059$=PARAM$(179,1); AR.A060$=PARAM$(180,1); AR.A055$=PARAM$(177,1); AR.A061$=PARAM$(181,60) ! SSP231644 jdf ! SSP236975 jdf
2650 GOSUB TAX_MOD; IF TAX_FILE$="Y" THEN CALL "*WINGRP;ENABLE",TAX_1.GRP$ ELSE GOTO 2680
2670 AR.A056$=PARAM$(134,1); IF AR.A056$="Y" THEN CALL "*WINGRP;ENABLE",TAX.GRP$ ELSE CALL "*WINGRP;DISABLE",TAX.GRP$
2680 REFRESH_FLG=1
2690 RETURN 
2710 LOAD_SCREEN_7:
2715 IF FN%HAS_MODULE("CV")<>0 THEN CC_DESC$=MSG("ARG_121"),CC_DESC1$=MSG("ARG_124") ELSE CC_DESC$=MSG("ARG_111"),CC_DESC1$=MSG("ARG_114") ! SSP 229993
2720 AR.A111$=PARAM$(241,1); AR.A112$=PARAM$(242,1); AR.A113$=PARAM$(243,1); REM SSP210101 jdf ; REM SSP 192616
2730 AR.A114$=PARAM$(244,10) ! WO215237
2740 AR.A254$=PARAM$(254,1) ! SSP 228852
2741 AR.A255$=PARAM$(255,1) ! SSP 231659
2742 AR3.A001$=PARAM_3$(7,1),AR3.A002$=PARAM_3$(8,1) ! SSP 232358,WO 233164
2746 IF PARAM$(134,1)<>"Y" THEN PARAM_3$(9,1)=""; CALL "*WINGRP;DISABLE",TAX_D.GRP$ ELSE CALL "*WINGRP;ENABLE",TAX_D.GRP$; END_IF ; AR3.A003$=PARAM_3$(9,1) ! SSP 235445
2750 AR3.A004$=PARAM_3$(10,1) ! WO259596
2752 AR3.A005$=PARAM_3$(11,1),AR3.A006$=PARAM_3$(12,1) ! WO263558, WO268862
2754 AR3.A007$=PARAM_3$(13,1) ! SSP298391
2780 REFRESH_FLG=1
2790 RETURN 
3000 ! Write the record
3010 WRITE_REC:
3040 WRITE (Z[6],KEY=X3$(9,3)+"A/R")IOL=0310
3050 WRITE (Z[6],KEY=X3$(9,3)+"AR1")IOL=0320
3055 WRITE (Z[6],KEY=X3$(9,3)+"AR3")IOL=0330 ! 268862
3060 B_PARAM$=PARAM$; B_PARAM_2$=PARAM_2$; B_PARAM_3$=PARAM_3$ ! 232358
3070 FOR XX=0 TO 8; B_PARAM[XX]=PARAM[XX]; NEXT XX
3080 FOR ZZ=0 TO 29; B_PARAM_2[ZZ]=PARAM_2[ZZ]; NEXT ZZ
3085 FOR XX=0 TO 8; B_PARAM_3[XX]=PARAM_3[XX]; NEXT XX ! 232358
3090 RETURN 
4000 ! load Information into Parameter String
4010 LOAD_INFO_1:
4020 PARAM$(7,4)=AR.A001$; PARAM$(11,2)=AR.A002$; PARAM$(13,1)=AR.A003$
4030 PARAM$(14,1)=AR.A004$; PARAM$(15,1)=AR.A005$; PARAM$(16,1)=AR.A006$
4040 PARAM$(43,3)=AR.A013$; PARAM$(19,1)=AR.A008$; PARAM$(20,1)=AR.A009$
4050 PARAM$(21,10)=ARG.A010$; PARAM$(31,10)=ARG.A011$; PARAM$(41,2)=ARG.A012$
4060 PARAM$(98,1)=ARG.A025$
4070 GOSUB SEL_ACCT ! SSP236975 jdf
4085 WRITE (Z[6],KEY=X3$(9,3)+"A/R")IOL=0310
4090 RETURN 
4100 ! Parameter Screen 2
4105 LOAD_INFO_2:
4110 PARAM$(46,1)=AR.A014$; PARAM$(96,1)=AR.A023$; PARAM$(47,1)=AR.A015$
4120 PARAM$(48,8)=AR.A016$; PARAM$(56,8)=AR.A017$; PARAM$(64,8)=AR.A018$
4130 PARAM$(72,8)=AR.A019$; PARAM$(80,8)=AR.A020$
4140 PARAM[0]=ARA001; PARAM[1]=ARA002; PARAM[2]=ARA003
4150 PARAM[3]=ARA004; PARAM[4]=ARA005
4160 PARAM$(99,1)=AR.A026$; PARAM[5]=ARA006; PARAM[6]=ARA007; PARAM[7]=ARA008
4170 PARAM$(88,1)=AR.A021$; PARAM$(116,1)=AR.A036$; PARAM$(89,7)=AR.A022$; PARAM$(97,1)=AR.A024$; PARAM[8]=ARA009
4185 WRITE (Z[6],KEY=X3$(9,3)+"A/R")IOL=0310
4190 RETURN 
4200 ! Parameter Screen 3
4210 LOAD_INFO_3:
4220 PARAM_2$(7,1)=AR1.A001$
4230 PARAM_2$(37,5)=AR1.A012$; PARAM_2$(42,5)=AR1.A013$; PARAM_2$(47,5)=AR1.A014$
4240 PARAM_2$(52,5)=AR1.A015$; PARAM_2$(57,5)=AR1.A016$; PARAM_2$(80,5)=AR1.A025$
4250 PARAM_2$(68,1)=AR1.A023$; PARAM_2$(62,1)=AR1.A017$; PARAM_2$(63,1)=AR1.A018$
4260 PARAM_2$(64,1)=AR1.A019$; PARAM_2$(65,1)=AR1.A020$; PARAM_2$(66,1)=AR1.A021$
4270 PARAM_2$(67,1)=AR1.A022$; PARAM_2$(69,1)=AR1.A024$
4275 PARAM_2$(75,1)=AR1.A026$ ! SSP 217566
4276 PARAM_2$(76,1)=AR1.A027$ ! SSP 222237
4277 PARAM_2$(77,1)=AR1.A028$ ! SSP 225300
4285 WRITE (Z[6],KEY=X3$(9,3)+"AR1")IOL=0320
4290 RETURN 
4300 ! LOAD SCREEN 4 PARAMETERS
4310 LOAD_INFO_4:
4320 PARAM_2$(8,1)=AR1.A002$; PARAM_2$(9,10)=AR1.A003$; PARAM_2$(19,10)=AR1.A004$
4330 PARAM_2$(32,1)=AR1.A008$; PARAM_2$(33,1)=AR1.A009$; PARAM_2$(36,1)=AR1.A011$
4340 PARAM_2[0]=AR1A001; PARAM_2[3]=AR1A004; PARAM_2[6]=AR1A007
4350 PARAM_2[15]=AR1A016; PARAM_2[16]=AR1A017; PARAM_2[17]=AR1A018
4360 PARAM_2[1]=AR1A002; PARAM_2[4]=AR1A005; PARAM_2[7]=AR1A008
4370 PARAM_2[18]=AR1A019; PARAM_2[19]=AR1A020; PARAM_2[20]=AR1A021
4380 PARAM_2[2]=AR1A003; PARAM_2[5]=AR1A006; PARAM_2[8]=AR1A009
4390 PARAM_2[21]=AR1A022; PARAM_2[22]=AR1A023; PARAM_2[23]=AR1A024
4400 PARAM_2[9]=AR1A010; PARAM_2[11]=AR1A012; PARAM_2[13]=AR1A014
4410 PARAM_2[24]=AR1A025; PARAM_2[25]=AR1A026; PARAM_2[26]=AR1A027
4420 PARAM_2[10]=AR1A011; PARAM_2[12]=AR1A013; PARAM_2[14]=AR1A015
4430 PARAM_2[27]=AR1A028; PARAM_2[28]=AR1A029; PARAM_2[29]=AR1A030
4485 WRITE (Z[6],KEY=X3$(9,3)+"AR1")IOL=0320
4490 RETURN 
4500 ! LOAD SCREEN 5 PARAMETERS
4510 LOAD_INFO_5:
4520 PARAM$(107,1)=AR.A028$; PARAM$(108,1)=AR.A029$; PARAM$(109,1)=AR.A030$
4530 PARAM$(110,2)=AR.A031$; PARAM$(112,1)=AR.A032$; PARAM$(113,1)=AR.A033$
4540 PARAM$(114,1)=AR.A034$; PARAM$(115,1)=AR.A035$; PARAM$(117,1)=AR.A037$
4550 PARAM$(118,1)=AR.A038$; PARAM$(119,1)=AR.A039$; PARAM$(120,1)=AR.A040$
4560 PARAM$(121,1)=AR.A041$; PARAM$(122,1)=AR.A042$; PARAM$(123,1)=AR.A043$
4570 PARAM$(124,1)=AR.A044$; PARAM$(125,1)=AR.A045$
4585 WRITE (Z[6],KEY=X3$(9,3)+"A/R")IOL=0310
4590 RETURN 
4600 ! LOAD SCREEN 6 PARAMETERS
4610 LOAD_INFO_6:
4620 PARAM$(126,1)=AR.A046$; PARAM$(127,1)=AR.A047$; PARAM$(128,1)=AR.A048$
4630 PARAM$(129,1)=AR.A049$; PARAM$(130,1)=AR.A050$; PARAM$(135,1)=AR.A052$
4640 PARAM$(136,40)=AR.A053$; PARAM$(176,1)=AR.A054$; PARAM$(178,1)=AR.A058$; PARAM$(179,1)=AR.A059$; PARAM$(180,1)=AR.A060$; PARAM$(177,1)=AR.A055$ ! SSP231644 jdf 
4650 PARAM$(134,1)=AR.A056$; PARAM$(131,3)=AR.A051$
4685 WRITE (Z[6],KEY=X3$(9,3)+"A/R")IOL=0310
4690 RETURN 
4700 ! LOAD SCREEN 7 PARAMETERS SSP 192616
4710 LOAD_INFO_7:
4720 PARAM$(241,1)=AR.A111$; PARAM$(242,1)=AR.A112$; PARAM$(243,1)=AR.A113$; REM SSP210101 jdf
4730 PARAM$(244,10)=AR.A114$ ! WO215237
4740 PARAM$(254,1)=AR.A254$ ! SSP 228852
4741 PARAM$(255,1)=AR.A255$ ! SSP 231659
4742 PARAM_3$(7,1)=AR3.A001$,PARAM_3$(8,1)=AR3.A002$ ! SSP 232358
4744 PARAM_3$(9,1)=AR3.A003$ ! SSP 235445
4746 PARAM_3$(10,1)=AR3.A004$ ! WO259596
4748 PARAM_3$(11,1)=AR3.A005$,PARAM_3$(12,1)=AR3.A006$ ! WO263558, WO268862
4749 PARAM_3$(13,1)=AR3.A007$ ! SSP298391
4750 PARAM$(181,60)=AR.A061$ ! SSP236975 jdf
4785 WRITE (Z[6],KEY=X3$(9,3)+"A/R")IOL=0310
4786 WRITE (Z[6],KEY=X3$(9,3)+"AR3")IOL=0330 ! 232358
4790 RETURN 
5000 ! Check Changes
5010 CHECK_CHANGES:
5020 GOSUB VERIFY_CHANGE
5030 IF CHG_FLG=0 THEN RETURN 
5040 MSGBOX MSG("REC_ALTERD"),MSG("UPDATED"),"?,YESNO",ANS$
5050 IF ANS$="NO" THEN RETURN 
5060 GOSUB WRITE_REC
5090 RETURN 
7000 ! Check if tax module is installed.
7010 TAX_MOD:
7020 CALL "ZZ2PRP","TW",TAX_FILE$,""
7090 RETURN 
7100 ! Check if Credit Card Feature is Available
7110 CREDIT_CARD_MOD:
7120 CALL "ZZ2PRP","CC",CREDIT_CARD$,""
7130 CALL "ZZ2PRP","CP",CC_PLUS$,"" ! ssp 212569
7140 CALL "ZZ2PRP","CV",CC_VAULT$,"" ! ssp 229993
7190 RETURN 
7500 ! Tax Format Setup
7510 SEL_SEG:
7520 IF NUL(AR.A051$) THEN RETURN 
7530 PARAM$(131,3)=AR.A051$
7560 GOSUB 7600 ! IF C0>0 THEN GOSUB 7600
7570 REPLACEMENT_SCRN$="ARGPML.1"
7590 REFRESH_FLG=1; RETURN 
7600 REM "DISPLAY FORMAT"
7630 Q=POS("AR5"=X4$(43))+10,Q2$=" "
7640 FOR I=0 TO 2
7645 IF POS(PARAM$(131+I,1)="0 ")<>0 THEN Q2$=Q2$+"  "; GOTO 7660
7650 Q2$=Q2$+"S"+PARAM$(131+I,1)
7660 NEXT I
7670 CALL "ZZACCT",X3$,X4$,"C","AR5",Q2$
7672 CALL "ZZDISP","AX","XXXXXXXXXX","AR5",X3$,AR.A057$,"",0,0,X4$ ! SSP#253153
7675 %SALES_TAX_MASK$=Q2$(3),REFRESH_FLG=1; PERFORM "ZZGGBL;STAX_FMT" ! AR.A057$=%SALES_TAX_MASK$!SSP#253153
7680 REM ""ZZDISP","A","XXXXXXXXXX","AR5",X3$,"","",0,0,X4$
7685 REM "PRINT @(60,8),'CL',; CALL "ZZDISP","A",A$(1,10),"AR5",X3$,"","",60,10,X4$
7690 IF POS("X/X"=X4$(7))=0 THEN X4$=X4$+"X/X0Z1Z1Z1"
7695 RETURN 
8000 ! Add Messages
8010 ADD_MSG:
8020 MSGBOX MSG("ADD_RECORD")+SEP+MSG("AR_REC"),MSG("VERIFY"),"?,YESNO",ANS$
8030 IF ANS$="NO" THEN CMD_STR$="END"; RETURN 
8040 DIM PARAM$(200),PARAM[8]
8050 NEXT_ID=APG.AP001.CTL
8090 RETURN 
8100 ! Add Messages
8110 ADD_MSG2:
8120 MSGBOX MSG("ADD_RECORD")+SEP+MSG("AR1_REC"),MSG("VERIFY"),"?,YESNO",ANS$
8130 IF ANS$="NO" THEN CMD_STR$="END"; RETURN 
8140 DIM PARAM_2$(100),PARAM_2[29]
8150 NEXT_ID=APG.AP001.CTL
8190 RETURN 
8500 ! CHECK FOR CHANGES
8510 VERIFY_CHANGE:
8520 CHG_FLG=0
8530 IF B_PARAM$<>PARAM$ THEN CHG_FLG=1
8540 IF B_PARAM_2$<>PARAM_2$ THEN CHG_FLG=1
8545 IF B_PARAM_3$<>PARAM_3$ THEN CHG_FLG=1 ! 232358
8550 FOR XX=0 TO 8; IF B_PARAM[XX]<>PARAM[XX] THEN CHG_FLG=1
8555 NEXT XX
8560 FOR ZZ=0 TO 29; IF B_PARAM_2[ZZ]<>PARAM_2[ZZ] THEN CHG_FLG=1
8565 NEXT ZZ
8570 FOR XX=0 TO 8; IF B_PARAM_3[XX]<>PARAM_3[XX] THEN CHG_FLG=1 ! 232358
8575 NEXT XX ! 232358
8590 RETURN 
9000 ! Parameters
9010 GET_SYS_PARAM:
9020 EXTRACT (Z[6],KEY=X3$(9,3)+"A/R",DOM=*NEXT)
9030 READ (Z[6],KEY=X3$(9,3)+"A/R",DOM=ADD_MSG)IOL=0310
9040 EXTRACT (Z[6],KEY=X3$(9,3)+"AR1",DOM=*NEXT)
9050 READ (Z[6],KEY=X3$(9,3)+"AR1",DOM=ADD_MSG2)IOL=0320
9051 DIM PARAM_3$(1024),PARAM_3[8]; PARAM_3$(1,6)=X3$(9,3)+"AR3"; READ (Z[6],KEY=PARAM_3$(1,6),DOM=*NEXT)IOL=0330 ! 232358
9060 B_PARAM$=PARAM$; B_PARAM_2$=PARAM_2$
9070 FOR XX=0 TO 8; B_PARAM[XX]=PARAM[XX]; NEXT XX
9080 FOR ZZ=0 TO 29; B_PARAM_2[ZZ]=PARAM_2[ZZ]; NEXT ZZ
9085 FOR XX=0 TO 8; B_PARAM_3[XX]=PARAM_3[XX]; NEXT XX ! 232358
9090 RETURN 
9999 END 
39000 LOAD_FY:
39010 ! ONLY_OPEN$="Y" means only load open FY's, TF_MODULE$ can be set to second part of key for that system parameter record, ie A/P, A/R, I/C
39020 ONLY_OPEN$="Y"
39030 AR.A001$=""; AR.AOO2$=""
39040 CUR_FY$="",CUR_ACCTPD$=""; READ (Z[6],KEY=%C$+"A/R",DOM=*NEXT)SYS_PARMS$; CUR_FY$=SYS_PARMS$(7,4),CUR_ACCTPD$=SYS_PARMS$(11,2)
39050 DIM GL$(300); READ (Z[6],KEY=%C$+"G/L")GL$(1)
39060 DIM OSEC$(255); READ (Z[6],KEY="osec"+%X3_OP_ID$,DOM=*NEXT)OSEC$
39070 READ (Z[6],KEY=%C$+"G/LYE",DOM=*NEXT)
39080 K$=KEY(Z[6],END=LOAD_FY_DROP_BOX); READ (Z[6],KEY=K$)GLYE$
39090 IF LEN(K$)<8 OR K$(1,8)<>%C$+"G/LYE" THEN GOTO LOAD_FY_DROP_BOX
39100 IF ONLY_OPEN$="Y" AND POS(GLYE$(99,1)="CR")>0 THEN GOTO 39080
39110 IF GL$(256,1)="Y" AND OSEC$(58,1)<>"Y" AND K$(9,4)<GL$(34,4) THEN GOTO 39080
39120 AR.A001$=AR.A001$+K$(9,4)+"/"
39130 GOTO 39080
39140 LOAD_FY_DROP_BOX:
39150 DROP_BOX LOAD AR.A001.CTL,AR.A001$
39160 IF CUR_FY$<>"" THEN IF GL$(256,1)="Y" AND OSEC$(58,1)<>"Y" AND CUR_FY$<GL$(34,4) THEN CUR_FY$=GL$(34,4),CUR_ACCTPD$=GL$(38,2)
39170 IF CUR_ACCTPD$<>"" THEN IF GL$(256,1)="Y" AND OSEC$(58,1)<>"Y" AND CUR_ACCTPD$<GL$(38,2) THEN CUR_ACCTPD$=GL$(38,2)
39180 IF CUR_FY$<>"" THEN DROP_BOX WRITE FY.CTL,CUR_FY$
39185 AR.A001$=CUR_FY$
39190 IF CUR_FY$<>"" THEN FROM_FY$="Y",AR.A001$=CUR_FY$; GOSUB LOAD_ACCTPD
39210 LOAD_FY_END:RETURN 
39220 ! 
39230 LOAD_ACCTPD:
39240 ! FY$ should be set to a valid fiscal year
39250 AR.A002$=""; FROM_FY$="Y"
39260 IF FROM_FY$="Y" THEN GOTO 39280
39280 READ (Z[6],KEY=%C$+"G/LYE"+AR.A001$,DOM=LOAD_ACCTPD_END)GLYE$
39290 PDS=12; PDS=NUM(GLYE$(13,2),ERR=*NEXT) ! Number of periods in this FY
39300 FOR X=1 TO PDS
39310 X$=STR(X:"00"),FLAG$="NO"; CALL "ARGDTE",%X3$,%X4$,AR.A001$+X$,FLAG$; IF FLAG$<>"*" THEN AR.A002$=AR.A002$+X$+"/" ! Checks osec, only load valid periods
39320 NEXT X
39330 DROP_BOX LOAD AR.A002.CTL,AR.A002$
39340 IF FROM_FY$="Y" AND CUR_ACCTPD$<>"" THEN DROP_BOX WRITE AR.A002.CTL,CUR_ACCTPD$
39350 AR.A002$=CUR_ACCTPD$
39360 LOAD_ACCTPD_END:RETURN 
40000 SEL_ACCT:
40010 ! Write out customer display params
40020 C$=AR.A004$; IF NUM(C$)=0 THEN C$="5"
40030 IF AR.A003$="Y" THEN C$="0Z2A"+C$ ELSE C$="0z2A"+C$
40040 IF X3$(30,1)="M" THEN IF X3$(330,1)<>"1" THEN C$(2,1)="S"
40050 IF X3$(330,1)="1" THEN C$(2,1)="d"
40060 CALL "ZZACCT",X3$,X4$,"A","A/R",C$
40065 %X4$=X4$
40070 RETURN 
56000 ! "190568-Parameter changes saving, but not taking effect.            
56001 REM "192616-On credit card orders that have been backordered, need to      
56003 REM "210101-Order Number Controls                                       
56006 REM "215237-Ability to use multiple Net1 merchant accounts in DemandBdge
56008 REM "217566-Commission substitution by vendor to allow certain house    
56009 REM "222237-Modification to charge house charges by vendor.             
56010 ! "228852-Remove the print alignment questions in all areas since they
56011 REM "231659-Fix for issue where the system runs out of sequence numbers 
56012 REM "231644-Set RFQ to users login code - setup to work in GUI          
56013 REM "232358-Ability to enter an order number range in cash receipts.    
56014 REM "233164-Add tab 6 to Customer Constant Data to display ASF data for 
56016 REM "235445-Modify sales tax programs to enabled require logic based on 
56018 REM "236975-A/R Parameters CHUI vs GUI                                  
56020 REM "259596-Option to display Order Notepad in GUI Invoice Entry for    
56022 REM "263558-AR System Parameter; Bypass creation of Job Number message  
56023 REM "268862-Requesting changes to ECGMAD CC screen.                     
56024 REM "229993-PCI/PA-DSS New Credit Card Processing - Vault Module        
56025 REM "298391-Ability to send E/F emails of Invoices after SJ Update      
