0010 REM "Display for invoice lines <AR2EAJ>
0020 SETESC 9300; SETERR 9000
0035 REM "5.5 - 09/10/07 - 15.723888 - jdf - SSP# 211380
0037 REM "211380-TopForm file feldnames which are SQL keywords break Oracle. 
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 SETERR 9000
0110 ! ENTER X3$,X4$,B$,B{ALL},D7,H$,J0,G$,C9,W$,M5$
0139 REM "This should be dup of line 140 in AR2EAL
0140 M0$="##,###,###.00-",M1$="###,###.00-",M2$="##,###.00-",M3$="##,###"
0145 ! IF LEN(M5$)<>11 THEN INPUT @(0,22),'CL',"M5$ NOT SET IN AR2EAJ!! ",'RB',*
0180 CLOSE (14); OPEN (14)"ZZPARM"
0190 DIM SEC$(255); FIND (14,KEY="osec"+X3$(40,3),DOM=0191)SEC$; REM "jel 100164 GoldBond
0200 REM 
0205 ON C9 GOTO 0210,0220,0230,0240
0210 GOSUB 6200; GOTO 9900
0220 GOSUB 6295; GOTO 9900
0230 GOSUB 8200; GOTO 9900
0240 GOSUB 1000; GOTO 9900
1000 REM "Changed type - set up new line
1020 GOSUB 6300
1040 RETURN 
6200 REM "PRINT ONE ENTRY
6205 IF B$(1,1)="M" THEN GOSUB 6300 ! PRINT @(39,8),B$(7,40),@(12,11),B$(6,1),; RETURN ELSE PRINT @(0,8),'CL',; PRINT @(50,6),'CL',
6210 ON POS(B$(1,1)="NFICS") GOTO 6220,6212,6212,6215,6214,6212
6212 GOSUB LINE_TYPE_PROC; ITEM_CODE$=B$(65,10); GOTO 6220
6214 GOSUB LINE_TYPE_PROC; CUSTOMER_2$=B$(55,10) ! PRINT @(19,6),'SB',"Cust #:",'SF',; CALL "ZZDISP","A",B$(55,10),"A/R",X3$,"","",27,6,X4$
6215 GOSUB LINE_TYPE_PROC; ITEM_CODE$=B$(65,10); GOSUB 8200 ! CALL "ZZDISP","A",B$(65,10),"ICE",X3$,"","",0,8,X4$; GOSUB 8200
6220 LINE_TYPE$=B$(1,1),TF_DESC$=B$(7,40),PROD_CODE$=B$(3,3),LEFT_RIGHT$=B$(93,8),TOP_BOTTOM$=B$(101,8),PLYS$=B$(109,2)
6225 GOSUB 6295
6226 PRINT_ON_INV$=B$(6,1)
6228 GPADJ=B[8]; IF SEC$(63,1)<>"Y" THEN GOTO 6229 ELSE GPADJ=0
6230 COMM_CODE$=B$(84,5),GP_ADJ_B4_LOAD=GPADJ,COMM_AMT=B[7]
6235 SALES_DIST_CODE$=B$(75,9) ! CALL "ZZDISP","A",B$(75,9),"ARV",X3$,"","",17,14,X4$
6237 STAX_CODE$=B$(125,10) ! CALL "ZZDISP","A",B$(125,10),"AR5",X3$,"","",59,14,X4$
6240 ORD_TYPE$=B$(111,1),TAXABLE$=B$(54,1)
6270 REFRESH_FLG=1
6280 REM 
6290 RETURN 
6295 COST=B[3]; IF SEC$(63,1)<>"Y" THEN GOTO 6296 ELSE COST=0
6296 UNIT$=B$(50,4),QTY_PER_UNIT=B[6],QTY_ORDERED=B[0]/D7,QTY_SHIPPED=B[1]/D7,UNIT_SELL_PRICE=B[2],UNIT_COST=COST; GOSUB 7635
6297 REFRESH_FLG=1; RETURN 
6300 REM "CLEAR 1 ENTRY"
6310 ! PRINT @(50,6),'CL',@(0,8),'CL',@(0,10),'CL',@(12,11),'CL',@(17,13),'CL',@(17,14),'CL','SB',@(36,11),"Cost:",@(43,13),"GP Adj:",@(62),"Comm:",@(41,14),"Ord type:",@(54),"STC:",@(72),"Tax?",'SF',
6315 CALL "*wingrp;disable",FIELDS.GRP$; CALL "*wingrp;Enable",LINE_M.GRP$; CALL "*wingrp;ENABLE",LINE_M.GRP$
6320 RETURN 
7634 REM "This routine is duplicated in AR2EAL,AR2EAM & AR2EAI for speed, so change there also
7635 SELL_PRICE_EXT=B[4],COST_EXT=B[5]
7636 B=B[4]-B[5] ! PRINT @(69,10),B:M1$,; IF B[4]<>0 THEN PRINT @(72,11),B*100/ABS(B[4]):"-###.00%",
7640 RETURN 
8200 REM "Print location info
8202 IF POS(B$(1,1)="IC")=0 THEN RETURN ! PRINT @(50,6),'CL',; RETURN 
8204 IF B$(89,4)="DS  " THEN W0$="Direct shipment"; GOTO 8230
8205 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
8210 DIM W0$(19)
8215 IF POS(" "<>W$(111,16))<>0 THEN W0$(1)=FNS$(W$(111,16))+","+W$(127,2)
8230 INV_LOC_CODE$=B$(89,4) ! PRINT @(50,6),B$(89,4)," ",W0$,
8240 RETURN 
9000 REM "ERROR PROCESSING
9005 EXIT ERR
9900 REM "END PROGRAM
9910 EXIT 
9999 END 
20010 LINE_TYPE_PROC:
20020 IF B$(1,1)="N" THEN CALL "*WINGRP;DISABLE",FIELDS.GRP$; CALL "*WINGRP;ENABLE",LT_N.GRP$; CALL "*WINGRP;ENABLE",LINE_DESC.GRP$
20030 IF B$(1,1)="C" THEN CALL "*wingrp;Hide",LINE_TYPE.GRP$; CALL "*wingrp;show",LINE_CUST.GRP$; CUSTOMER_2$=CUSTOMER$
20040 IF B$(1,1)="S" THEN CALL "*WINGRP;ENABLE",LINE_DESC.GRP$
20050 IF B$(1,1)="M" THEN CALL "*wingrp;disable",FIELDS.GRP$; CALL "*wingrp;Enable",LINE_M.GRP$; CALL "*wingrp;ENABLE",LINE_M.GRP$
20060 IF B$(1,1)="I" THEN CALL "*wingrp;Enable",LINE_TYPE2.GRP$
20190 RETURN 
56000 REM "211380-TopForm file feldnames which are SQL keywords break Oracle. 
