0010 ! ZPGMFA - Maintain Selection Codes
0015 ! 15,5
0020 IF TCB(13)=1 THEN BEGIN 
0025 PROCESS "MNT_ZP6","../ZPG/ZP.EN"
0030 ! if tcb(13)=1 then run "ZMENU"
0035 REM "5.7 - 08/16/10 - 15.817222 - tma - SSP# 240435
0037 REM "240435-Compare of programs/panels from DEV to Release              
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 INIT:! 100,5 - Initialization Routine
0200 ! ^100,5 - Iolists & Templates
0205 LIST_BOX_IOL:IOLIST LIST_TYPE_CODE$,LIST_DESC$
0300 ! ^100,5 - Constants & Functions
0305 MAX_ALLOW=10
0310 EXIT 
0315 ! 
1000 GET_LIST_CODES:! ^1000,5 - Get records from ZP0
1005 LIST_BOX LOAD F_CODE.CTL,""
1010 LIST_BOX LOAD T_CODE.CTL,""
1015 SELECT * FROM "ZP0"+%C$
1020 IF NOT(POS(LIST_TYPE_CODE$=RESTRICT_TO_LIST_TYP$,4)) THEN {
1025 LIST_BOX LOAD F_CODE.CTL,0,REC(IOL=LIST_BOX_IOL)
1030  } ELSE {
1035 LIST_BOX LOAD T_CODE.CTL,0,REC(IOL=LIST_BOX_IOL)
1040  }
1045 NEXT RECORD 
1050 REFRESH_FLG=1
1055 RETURN 
1060 ! 
2000 WRITE_REC:! ^1000,5 - Create restrict to list type
2005 RESTRICT_TO_LIST_TYP$=""
2010 NUM_REC=T_CODE.CTL'ITEMCOUNT
2015 IF NUM_REC THEN {
2020 FOR LINE=1 TO NUM_REC
2025 LIST_BOX FIND T_CODE.CTL,LINE,LINE$
2030 RESTRICT_TO_LIST_TYP$+=LINE$(1,POS(SEP=LINE$)-1)
2035 NEXT LINE
2040  }
2050 EXIT 
9999 END 
