0010 ! GUI G/L Standard Interface (no job cost) <GLGXAA>
0035 REM "5.7 - 08/04/10 - 9.958888 - crg - SSP# 240231
0037 REM "240231-Allow update out of balance GL entries in GLGJAA
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 SETERR 0100; ENTER 
0100 SETERR 9000; SETESC 9300
0105 ML_LINE=0,GL_ACCT$="",ML_DESC1$="",ML_AMOUNT=0,ML_BAL$="",ML_DEBIT=0,ML_CREDIT=0,ML_LINE=0,ML_LINE$="",LB_LINE$="",START=1,STARTT=1 ! Initialize variables used on panel
0110 V0=V9
0112 V7=1
0140 W0$="-###,###.00",W1$="###,###,###.00CR",W9$=W1$; IF V7>0 THEN W9$=W1$(1,LEN(W1$)-2)+"-",W1$=W1$(1,LEN(W1$)-2)
0165 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
0280 IF D9$="*" THEN GOSUB 7700; GOTO 6525
0290 IOLIST Y[0],Y[1],Y[2],Y[3],Y[4]
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0296 DIM Y[5]
0310 IOLIST A,V3$(1),V[0],V[1],V[2],V[3],V[4]
0320 IOLIST AM,VM3$(1),VM[0],VM[1],VM[2],VM[3],VM[4] ! SSP236777 jdf
0330 IOLIST V4$(1,LEN(V4$))
0350 REM IF T[0]=0 THEN T[0]=AT6[1]*-1; REM SSP LMS TEST
0405 IF NO_GL THEN BAL_NOGL=T[0]; IF BAL_NOGL=0 THEN IF INTERNAL_USE<>0 THEN BAL_NOGL=INTERNAL_USE
0406 IF NEG_VAL=1 THEN BAL_NOGL=-BAL_NOGL,T(0)=-T(0) ELSE IF NEG_VAL=2 THEN T(0)=ABS(T(0)),BAL_NOGL=ABS(BAL_NOGL)
0409 IF A0=0 AND T9$<>"" THEN GOSUB GL2XAB; A5=A0 ! SSP236777 jdf
0410 REM IF A0=0 AND T9$<>"" THEN CALL "GL2XAB",X3$,T9$,T{ALL},V9$,F,A0; A5=A0 ! SSP236777 jdf
0415 DIM V0$(30),S$(45); V0$(1,LEN(V0$))="* Not on file entry *"
0420 GOSUB 7700
0430 GOSUB 6800
0500 ! SET-UP
0505 A1=18+V0,A2=1; IF V1=0 THEN A1=A1-2
0510 A3=INT((22-A1)/A2),A4=1,Y9=2,K8=LEN(A1$),Y$=""; A3=9999
0515 GOSUB 7280
0520 DIM X[2],Y[6]
0525 IF A0=0 THEN U1=7,U2=U1,A9$=""; GOSUB 5200; GOTO 0800
0530 IF A0=0 THEN GOTO 0800
0540 GOSUB 5100
0550 L=1; GOTO 6425
0560 X[0]=1
0580 F=Z[2]
0590 GOTO 1125
0800 ! NEW ENTRY
0805 IF X0$="AR2EAC" AND POS(A$(337,1)="Yy")>0 THEN GOTO 7000
0810 Y$=""
0830 X[0]=1; GOTO 1125
1000 REM 
1045 V3$(1)=K9$+A1$
1100 ! SELECT LINE
1110 GOTO 7000
1120 IF Y$<>"" THEN ITEM_COUNT=LB_LINE.CTL'ITEMCOUNT; IF LEN(Y$)>ITEM_COUNT*2 THEN Y$=Y$(1,ITEM_COUNT*2) ! READ (F,IND=DEC(Y$(LEN(Y$)-1)),ERR=*RETURN)AA,VV3$; IF STP(VV3$)="" THEN RETURN 
1125 A6=0,A4=X[0]
1129 IF A4=0 THEN GOTO 7000
1130 A4=X[0],Y=(A4-1)*Y9+1; IF Y>LEN(Y$) THEN Y=-1,A4=LEN(Y$)/Y9+1,X[0]=A4
1132 ML_LINE=A4,REFRESH_FLG=1
1135 IF Y<0 THEN GOTO 1200
1140 A5=DEC(Y$(Y,Y9))
1150 READ (F,IND=A5)IOL=0310
1152 ! IF V(3)=0 AND ML_AMOUNT<>0 THEN V(3)=ML_AMOUNT
1160 GOSUB 6200
1165 ! TO AVOID DISPLAY; GOTO 1400 HERE!!!
1170 IF POS(BIN(A4,Y9)=L0$,Y9)>0 THEN GOTO 1400
1175 GOSUB 7300; GOTO 1400
1200 ! NEW LINE
1210 IF A9<=0 THEN GOSUB 5200 ELSE GOSUB 5200
1220 Y$=Y$+BIN(A9,Y9),A6=1,A5=A9,A=-1,A9=-1,C6=1
1280 GOSUB 6800; GOSUB 6200
1290 GOTO 1400
1310 C0=-C0
1400 ! MAINTAIN ENTRY
1490 GOTO 2000
1500 ! OPTIONS (DISPLAY)
1510 C0=ABS(C0)
1520 IF C0=1 THEN GOTO 1125 ELSE GOTO 7000
1580 GOTO 2000
1600 REM "
1800 ! PRIOR LINE
1810 IF X[0]>1 THEN X[0]=X[0]-1
1820 GOTO 1125
1900 ! Finished with line
1910 IF G0<0 THEN G9=2; GOTO 2040
1950 REM "
1955 IF T<>0 OR U=1 THEN GOSUB 6700
1965 IF C0=3.2 THEN X[0]=X[0]-2
1968 IF A7=1 THEN GOSUB 5700
1970 IF C6=1 THEN C0=0,C6=0
1972 REM 
1973 REM 
1975 IF C0=4 AND U<>1 THEN GOTO 7000 ELSE X[0]=X[0]+1; GOTO 1125
2000 ! DATA SEQ
2010 C0=0,D9=1,G9=-1,X1=1,T=0,U=0,Q$="?"; IF Y<0 OR A7=1 THEN T=-1,G9=0
2020 X$="",C0=ABS(C0); IF C0=2 AND G9=0 THEN G9=999; GOTO 2040 ELSE IF C0=2 THEN G9=G9-1 ELSE G9=G9+1; IF C0=2 AND G9=0 THEN X[0]=X[0]-1; GOTO 1100
2025 IF C0>3 OR G9<0 THEN G9=999
2030 IF G9>0 THEN IF T=0 THEN T=-1; GOSUB 7200
2040 ON G9 GOTO 2050,2100,2150,2450,1900
2050 ! STATUS
2055 C0=0,Q$="?",X$="MDNPLEIA"
2060 C1=1
2062 IF C1>1 THEN GOTO 5800
2070 IF T=0 THEN T=-1; GOSUB 7200
2090 GOTO 2020
2100 ! J/E Memo
2101 GOSUB CHECK_MEMO
2105 IF V8=0 THEN CALL "*WINGRP;HIDE",MEMO.GRP$; GOTO 2020
2106 CALL "*WINGRP;SHOW",MEMO.GRP$; NEXT_ID=ML_MEMO1.CTL; GOTO 2020
2107 SEL_MEMO:
2108 IF LEN(V3$)<83 THEN V3$=PAD(V3$,83," ")
2110 V3$(38,45)=ML_MEMO1$
2112 IF ABS(C0)=2 THEN GOTO 2110
2115 IF Y<0 THEN IF U=0 AND C0<0 AND (ABS(C0)=2 OR ABS(C0)=4 OR INT(ABS(C0))=3) THEN C7=1; GOTO 5400
2116 REM 
2117 NEXT_ID=GL_ACCT.CTL
2140 RETURN 
2150 ! G/L Account
2158 IF V8<>0 THEN U=1,NEXT_ID=ML_MEMO1.CTL
2159 IF INS_IDX THEN LIST_BOX LOAD LB_LINE.CTL,INS_IDX,*; LIST_BOX LOAD LB_LINE.CTL,INS_IDX,STR(INS_IDX:"##0")+SEP+" "+SEP+" "+SEP+" "+SEP+" "+" "; INS_IDX=0; CALL "*WINGRP;DISABLE",BUTTS.GRP$ END_IF ; EXIT 
2160 SEL_ACCT:! V3$(7,12)=GL_ACCT$; REM SSP 205896
2161 IF STP(GL_ACCT$,2)="" THEN GOTO *RETURN ELSE V3$(7,12)=PAD(GL_ACCT$,12,"0") ! SSP 222766
2162 IF ABS(C0)=2 THEN IF V8=0 THEN GOTO 2160 ELSE GOTO 2020
2163 IF Y<0 THEN IF U=0 AND C0<0 AND (ABS(C0)=2 OR ABS(C0)=4 OR INT(ABS(C0))=3) THEN C7=1; GOTO 5400
2165 IF C0=-4 AND Y<0 THEN GOTO 5400 ELSE IF ABS(C0)=2 THEN C0=4
2166 IF POS(X0$="GLGJAAGL2JAA",6)=0 THEN IF NUM(GL_ACCT$,ERR=*NEXT)=0 THEN GOTO *RETURN ! SSP#206330                                                     
2167 REM IF POS(X0$="GLGJAAGL2JAA",6)=0 THEN IF NUM(GL_ACCT$,ERR=*NEXT)=0 THEN GOTO *RETURN ! SSP#206330
2170 G0=-1; FIND (V3,KEY=V3$(7+K9,12),DOM=2200)IOL=0330; G0=1; GOTO 2175 ! SSP 222766
2171 NEXT_ID=GL_ACCT.CTL; GOTO *RETURN
2172 IF G0<0 THEN GOTO 2150
2177 ML_DESC1$=V4$(13,35),REFRESH_FLG=1
2190 RETURN 
2210 ML_DESC1$="*** "+MSG("NOT_FOUND")+" ***"; IF ID$="GL_ACCT" THEN NEXT_ID=GL_ACCT.CTL END_IF ; RETURN ! SSP222766
2450 ! Amount
2451 SEL_AMOUNT:IF _EOM$<>$09$ THEN EXIT 
2452 U=1
2458 IF V[3]=0 THEN V[3]=-T[0]
2459 IF ML_AMOUNT=0 THEN NEXT_ID=GL_ACCT.CTL; RETURN 
2460 V(3)=ML_AMOUNT,D9$=""
2470 IF GL_DIST_AMT>0 THEN IF ML_AMOUNT>0 THEN GL_DIST_AMT=-(BAL_NOGL); GL_DIST_AMT=GL_DIST_AMT+ABS(ML_AMOUNT); REM IF GL_DIST_AMT>0 THEN GL_DIST_AMT=GL_DIST_AMT-ABS(ML_AMOUNT); REFRESH_FLG=1  ! SSP237859 jdf
2472 IF GL_DIST_AMT>0 THEN IF ML_AMOUNT<0 THEN GL_DIST_AMT=GL_DIST_AMT-ABS(ML_AMOUNT) ! SSP237859 jdf
2475 IF GL_DIST_AMT<0 THEN GL_DIST_AMT=GL_DIST_AMT+ABS(ML_AMOUNT); REFRESH_FLG=1
2478 IF X1$="Cash Receipts Entry" AND CHECK_AMT=-(ML_AMOUNT) THEN GL_DIST_AMT=0,T[0]=CHECK_AMT,BAL_NOGL=-CHECK_AMT ! SSP238654 jdf
2480 GOSUB CHECK_BALANCE
2482 IF ML_LINE<=LB_LINE.CTL'ITEMCOUNT THEN RESS=1 ELSE RESS=-1
2485 LIST_BOX WRITE LB_LINE.CTL,ML_LINE+RESS,ERR=*NEXT
2490 GOTO 1900
4900 ! END OF LINES
4905 IF STP(V3$(1,6))="" THEN V3$(1,6)=X3$(15,6) ! SSP236349 jdf
4910 Y[4]=-1; WRITE (F,IND=0)IOL=0290
4920 CALL "ZZEXPF",X3$,X4$,"X"+STR(F),"",G9; IF G9>0 THEN GOTO 7000
4925 EXTRACT (F,IND=0)IOL=0290
4930 Z=NUM(FIN(F,"MAXREC")); Y[3]=Z-1
4935 Y[4]=-2; WRITE (F,IND=0)IOL=0290
4940 GOTO 5215
4980 GOTO 7000
5000 ! LINE LINE Z0 TO LINE Z1
5010 Q=(Z0-1)*Y9+1; IF Q>LEN(Y$) OR Q<1 THEN GOTO 5090 ELSE Z9=DEC(Y$(Q,Y9))
5012 Q=(Z1-1)*Y9+1; IF Q>LEN(Y$) OR Q<1 THEN Z8=-1 ELSE Z8=DEC(Y$(Q,Y9))
5014 IF FOLDER_ID$="GLGJAA.2" THEN DIM V3$(83),V[4] ! SSP237638 jdf
5015 READ (F,IND=Z9)IOL=0310
5020 IF Z1>LEN(Y$)/Y9 THEN Z8=-1
5030 IF A<>Z8 THEN A=Z8; WRITE (F,IND=Z9)IOL=0310
5095 RETURN 
5100 ! BUILD INDEX STRING
5105 Y$="",Y=A0
5120 IF Y<=0 THEN GOTO 5195 ELSE Q$=BIN(Y,Y9); IF POS(Q$=Y$,Y9)=0 THEN Y$=Y$+Q$ ELSE GOTO 5195
5130 READ (F,IND=Y,END=5131)Y; GOTO 5120
5140 IF Y$>"" THEN Y$=Y$(1,LEN(Y$)-Y9)
5195 RETURN 
5200 ! GET NEXT INDEX TO FILE IN A9
5210 EXTRACT (F,IND=0,ERR=5295)IOL=0290
5212 IF Y[4]=-2 THEN READ (F); GOTO 5270
5215 IF Y[0]>=Y[3] OR Y[2]>=Y[3] THEN GOTO 4900 ELSE Y[4]=-2
5220 WRITE (F,IND=0)IOL=0290
5230 IF Y[1]<1 THEN A9=Y[2],Y[2]=Y[2]+1 ELSE A9=Y[1]; READ (F,IND=A9)Y[1]
5240 Y[0]=Y[0]+1,Y[4]=-1
5250 WRITE (F,IND=0)IOL=0290
5255 U1=0
5260 RETURN 
5270 LOCK (F,ERR=5210); Y[4]=-1; GOTO 5215
5295 IF ERR<>0 THEN GOTO 9000 ELSE RETRY 
5300 ! REMOVE INDEX Z
5302 IF POS(BIN(Z,Y9)=A9$,Y9)>0 THEN ! ESCAPE
5305 IF U2>0 THEN A9$=BIN(Z,Y9)+A9$; GOTO 5360
5310 EXTRACT (F,IND=0)IOL=0290
5315 IF Y[4]=-2 THEN READ (F); WAIT 0; GOTO 5310 ELSE Y[4]=-2
5320 WRITE (F,IND=0)IOL=0290
5330 WRITE (F,IND=Z)Y[1]
5340 Y[1]=Z,Y[4]=-1,Y[0]=Y[0]-1
5350 WRITE (F,IND=0)IOL=0290
5360 Q0$=BIN(Z,Y9),Q=POS(Q0$=Y$,Y9); IF Q=0 THEN GOTO 5390
5365 Y$=Y$(1,Q-1)+Y$(Q+Y9)
5366 IF A4=1 AND Q$="D" THEN A0=DEC(MID(Y$,1,2))
5390 RETURN 
5395 ON ERR GOTO 5310,5311,9000
5400 ! DELETE CURRENT LINE
5402 DELETE_LINES: MD=0,MC=0; LIST_BOX READ LB_LINE.CTL,A4,ERR=*RETURN ! SSP238654 jdf
5403 IF FOLDER_ID$="APGDAA.3" AND GROSS_INV_AMT=0 THEN IF BAL_NOGL>0 THEN BAL_NOGL=BAL_NOGL-ML_CREDIT ELSE IF BAL_NOGL<0 THEN BAL_NOGL=BAL_NOGL+ML_DEBIT ! SSP237719 jdf ! LIST_BOX LOAD LB_LINE.CTL,A4,*; IF A4>LEN(Y$)/2 THEN A4=LEN(Y$)/2 END_IF ; GOSUB MOVE_LINE_UP; IF A4=0 THEN GOTO *RETURN
5404 LIST_BOX LOAD LB_LINE.CTL,A4,*; IF A4>LEN(Y$)/2 THEN GOTO *RETURN END_IF ; GOSUB MOVE_LINE_UP; IF A4=0 THEN GOTO *RETURN
5405 Z0=A4-1,Z1=A4+1,A5=DEC(Y$((A4-1)*Y9+1,Y9))
5415 GOSUB 5000; Z=A5
5416 IF Q$="D" THEN READ (F,IND=Z)IOL=0310
5418 IF T=0 OR (Q$="D" AND FOLDER_ID$<>"APGDAA.3") THEN T=-1 ELSE IF Q$="D" AND FOLDER_ID$="APGDAA.3" THEN T=1; END_IF ; END_IF ; GOSUB 7200 ! SSP237655 jdf
5420 GOSUB 5300
5430 GOSUB 6800
5435 IF ABS(C0)=3.2 THEN C0=2 ELSE IF ABS(C0)=3.1 THEN C0=4
5485 IF C7=1 THEN C7=0,C0=ABS(C0); IF C0=2 THEN X[0]=X[0]-1; D9=0; GOTO 1120 ELSE GOTO 7000
5490 IF Q$="D" THEN GOSUB 5700; GOSUB 6800; GOTO 5496 ELSE GOTO 1125 ! SSP195548
5495 ADD_LINES:CALL "*WINGRP;DISABLE",BUTTS.GRP$; MC=0,MD=0; IF ML_AMOUNT=0 AND FOLDER_ID$<>"GLGJAA.2" THEN RETURN ! SSP 195548 ! SSP238654 jdf ! SSP237638 jdf
5496 X[0]=999,D9=0; CALL "*WINGRP;DISABLE",BUTTS.GRP$; GOTO 1120 ! SSP 195548
5500 ! INSERT CURRENT LINE
5501 INSERT_LINES:
5502 LIST_BOX READ LB_LINE.CTL,INS_IDX,ERR=DISABLE_BUTTONS
5503 ! IF NO_GL AND LEN(Y$)>IDX THEN Y$=Y$(1,IDX*2);!SSP 195548
5510 GOSUB 5200
5515 Y$=MID(Y$,1,Y-1)+BIN(A9,Y9)+Y$(Y),A5=A9,A9=-1
5516 ! IF NO_GL THEN GOSUB CHECK_RECORD;!SSP 195548
5520 GOSUB 6800
5530 A6=1,X[0]=A4,A7=1
5535 A=DEC(Y$(Y+2,2)); IF Y=1 THEN A0=A
5540 WRITE (F,IND=A5)IOL=0310; Q$="I"; GOSUB 6000; A4=X[0]
5590 D9=0; GOTO 1125 ! GOTO 1160; !SSP 195548
5600 ! TACK ON LINE TO END
5610 Z7=A8; IF Z7=0 THEN GOTO 5635
5620 READ (F,IND=Z7)IOL=0310
5625 A=Y[A5],Z8=0
5630 WRITE (F,IND=Z7)IOL=0310
5635 Z8=0
5690 RETURN 
5700 ! DISPLAY AFTER DELETE/INSERT
5705 IF A7=1 THEN GOSUB 7300; A7=0; GOTO 5750
5710 IF L0$>"" THEN Z=DEC(L0$(1,Y9)); GOSUB 6000
5750 RETURN 
5800 ! LINE CONTROL
5810 IF T<>0 THEN T=1; GOSUB 7200; T=0
5820 IF C0=2 THEN GOTO 1100
5880 ON POS(Q$="?DNPLEIA") GOTO 2060,2020,5400,1900,1800,6400,7000,5500,5495
5900 ! Reset reserved links as avail
5910 Z=DEC(A9$(1,Y9)); GOSUB 5310
5915 A9$=A9$(Y9+1); IF A9$>"" THEN GOTO 5910 ELSE RETURN 
6000 ! DISPLAY PAGE @ LINE Z
6001 IF POR_GATEWAY$="Y" THEN RETURN 
6002 IF Z<=0 THEN Z=1
6005 Y0=(Z-1)*Y9+1,L0=0,L1=Z,L0$="",L2=0,L2$=""
6006 IF Y$="2004" THEN Y$=""; GOTO 6095
6020 IF Y0>LEN(Y$) THEN Z=Z-1,A4=Z,L0$=""; GOTO 7320 ELSE IF Y0<1 THEN GOTO 6090
6022 IF Q$="I" AND A4=L1 THEN GOTO 6040
6025 READ (F,IND=DEC(Y$(Y0,Y9)))IOL=0310
6030 GOSUB 6600; GOSUB 6300
6032 DIM V4$(60); V4$(13,30)=V0$
6035 FIND (V3,KEY=V3$(7+K9,12),DOM=6036)IOL=0330
6040 L2$=L2$+CHR(1)+CHR(L0+A1)+CHR(3)+STR(L1:"##0")
6080 L0$=L0$+BIN(L1,Y9),L0=L0+1,L1=L1+1,Y0=Y0+Y9; IF STP(V3$(7+K9,12))="" THEN L1=L1-1 ! SSP237655 jdf
6085 IF Y0>LEN(Y$) THEN L2=1 ELSE IF L0<A3 THEN GOTO 6022
6090 READ (F,IND=A5)IOL=0310
6095 RETURN 
6100 ! SELECT LINE ROUTINE
6102 LIST_BOX FIND LB_LINE.CTL,1,LB_LINE$,ERR=*NEXT; GOSUB SEL_LB_LINE; CALL "*WINGRP;DISABLE",BUTTS.GRP$
6105 IF Y$="" THEN GOTO 7000 ELSE L1=DEC(L0$(1,Y9)),L2=DEC(L0$(LEN(L0$)-Y9+1,Y9)),X8=A4-L1
6106 C1$="004018012014001"; CALL "*WINGRP;DISABLE",BUTTS.GRP$
6107 RETURN 
6110 CALL "ZZSLCT",X3$,"CX",C1$,"",L2$,"{4","",X8,X9,A4; A4=A4+L1,X[0]=A4,X0=A4,Y=(A4-1)*Y9+1; IF X9=-5 THEN Q$="D"; GOSUB 6170; ON S3 GOTO 6111,6110 ELSE IF X9=-4 THEN Q$="I" ELSE IF X9=-3 THEN X9=0 ELSE IF X9=-6 THEN X9=0
6112 IF X9<0 THEN ON -X9 GOTO 6115,6113,7000,6113,5500,5400,6120
6115 SEL_VIEW_LINE:IF X9=0 THEN IF A4>=0 AND A4<=L2 THEN G9=A4; GOTO 7100
6120 IF X9<0 THEN A4=L1 ELSE Y=(A4-1)*Y9+1; IF A4>LEN(Y$)/Y9 THEN GOTO 7000
6130 G9=A4
6150 IF X9=1 AND L1=1 THEN X8=0; GOTO 6110 ELSE IF X9=1 THEN Z=DEC(L0$(1,Y9))-1 ELSE Z=LEN(L0$)-Y9+1,Z=DEC(L0$(Z,Y9))+1
6155 Z=INT(Z/A3)*A3; IF Z=0 THEN Z=1
6160 GOSUB 6000
6165 X8=A4-L1+1; GOTO 6105
6170 X$="",X8=A4-L1; CALL "ZZPROM","L2",X3$,0,X$,"","",0; X$=X$+" ( #"+STR(A4)+" )"
6175 CALL "ZZPROM","Y",X3$,S3,X$,"","",0
6180 RETURN 
6200 ! PRINT ONE ENTRY
6203 IF POR_GATEWAY$="Y" THEN RETURN 
6205 ML_LINE=A4
6210 GOSUB 6600
6220 IF V8>0 THEN ML_MEMO1$=MID(V3$,38,45) ELSE ML_MEMO1$=""
6239 GOSUB GET_GL_MASK; REM SSP 205896
6240 GL_ACCT$=V3$(7+K9,12),ML_DESC1$=V4$(13,35),ML_AMOUNT=V[3] ! SSP 222766
6245 ! _ACCT$=STR(-NUM(V3$(7+K9,M2)):W2$),ML_DESC1$=V4$(13,35),ML_AMOUNT=V[3]
6250 REFRESH_FLG=1,NEXT_ID=GL_ACCT.CTL; IF FROM_LINE=1 THEN FROM_LINE=0,NEXT_ID=LB_LINE.CTL
6260 GL_ACCT$=STP(GL_ACCT$,3,"-")
6280 REM 
6290 RETURN 
6300 ! DISPLAY ONE LINE
6301 IF POR_GATEWAY$="Y" THEN RETURN 
6304 L0=L0
6305 ML_LINE$=STR(L1:"##0")
6310 X=6
6318 GOSUB GET_GL_MASK; REM SSP 205896
6319 ML_ACCT_DESC$=V4$(13,35)
6320 ML_ACCT$=STR(-NUM(V3$(7+K9,M2)):W2$),ML_ACCT_DESC$=V4$(13,35)
6340 Q=63; IF V7>0 AND V[3]>0 THEN Q=50
6360 IF Q=50 THEN ML_DEB=V(3),ML_CRE=0 ELSE ML_CRE=V(3),ML_DEB=0
6361 LOAD_LIST_BOX:
6362 IF ML_DEB THEN ML_DEB$=STR(ML_DEB:W1$) ELSE ML_DEB$=""
6363 IF ML_CRE THEN ML_CRE$=STR(ML_CRE:W1$) ELSE ML_CRE$=""
6364 IDX=NUM(ML_LINE$); LIST_BOX LOAD LB_LINE.CTL,IDX,*,ERR=*NEXT; IDX=NUM(ML_LINE$); IF NUM(ML_DEB$)+NUM(ML_CRE$)=0 THEN GOTO 6366
6365 IF V8=0 AND LEN(V3$)>80 THEN V3$(38,45)=PAD("",45," ")
6366 IF ML_DEB+ML_CRE=0 THEN GOTO *RETURN
6367 IF ID$="BUTTON_2" AND Q$="I" AND INS_IDX=L1 THEN ML_ACCT$="",ML_ACCT_DESC$="",ML_DEB$="",ML_CRE$="",ID$="BUTTON_3"
6368 LIST_BOX LOAD LB_LINE.CTL,IDX,ML_LINE$+SEP+ML_ACCT$+SEP+ML_ACCT_DESC$+SEP+ML_DEB$+SEP+ML_CRE$+SEP+MID(V3$,38,45); IF RESS<0 THEN LIST_BOX WRITE LB_LINE.CTL,IDX
6390 RETURN 
6400 ! LIST OPTION
6405 L=1
6410 IF POR_GATEWAY$="Y" THEN GOTO 7000 ELSE ! CALL "ZZPROM","L3",X3$,S3,"","","V",X; ON S3 GOTO 6411,7000
6415 IF S3<0 THEN IF (X-1)*Y9+1>LEN(Y$) THEN X=LEN(Y$)/Y9-1 ELSE IF X<=0 THEN X=1
6420 IF S3<0 THEN L=X+1
6425 Z=L-1; GOSUB 6000
6430 IF L2=1 THEN X[0]=L1; GOTO 1125 ELSE L=L+L0; GOTO 6410 ! IF L2=1 THEN GOTO 7000 ELSE L=L+L0; GOTO 6410  ! SSP235511 jdf      
6460 GOTO 6410
6500 ! RE-DO SCREEN
6505 D9$="*"
6510 GOSUB 6700
6520 L0=3; GOTO 7080
6525 D9$="",Z=INT(A4/A3)*A3; IF Z=0 THEN Z=1; IF C0>4 THEN C0=C0-5
6530 GOSUB 6000; GOSUB 7280; IF D9=0 THEN GOTO 1100
6540 READ (F,IND=A5)IOL=0310
6545 GOSUB 6200
6550 ON C0 GOTO 2040,2020
6600 ! ALTERNATE DATA READS FOR 1 LINE
6610 G0=-1; FIND (V3,ERR=6611,KEY=V3$(7+K9,12),DOM=6611)IOL=0330; G0=1
6612 G1=1,G2=1
6690 RETURN 
6700 ! WRITE CURRENT LINE
6701 IF Y$="" THEN RETURN 
6703 IF V(3)=0 THEN A5=A5-1; RETURN 
6705 IF Y+1=LEN(Y$) THEN A=-1 ELSE A=0; REM IF A=0 THEN A=DEC(MID(Y$,1,2))! SSP236349 jdf
6710 IF A=0 THEN A=DEC(MID(Y$,Y+Y9,Y9)) ! SSP238654 jdf
6715 IF D9$<>"*" THEN T=1; GOSUB 7200; T=0
6716 IF A5=A THEN A=-1
6717 IF STP(V3$(1,6))="" THEN V3$(1,6)=X3$(15,6) ! SSP236349 jdf
6720 GOSUB STORE_INDEX; WRITE (F,IND=A5)IOL=0310; GOSUB RETRIEVE_INDEX; Z=A,Q=Y ! SSP236349 jdf ! SSP236777 jdf 
6725 IF A6<>0 THEN Z0=A4-1,Z1=A4; GOSUB 5000; READ (F,IND=A5)IOL=0310
6760 IF Z<0 THEN A6=1 ELSE A6=0
6779 ! added to clean up lookup 05/01/87
6780 IF D9$="" THEN IF A7<>1 THEN GOSUB 7300
6790 RETURN 
6800 ! SET-UP DATA FOR 1 LINE
6810 B1$=B$
6815 G0=-1,G1=-1,G2=-1
6820 DIM V3$(37+45*V8),V[4],V4$(52),V5$(40),V6$(50),H$(34),H[1]
6830 V3$(1,6)=X3$(15,6); IF V9$>"" THEN V3$(1,6)=V9$
6880 GOSUB 6600
6895 RETURN 
6900 ! SET LAST LINE TO NO LINK
6905 IF Y$="" THEN A0=0; GOTO 6945 ELSE A5=DEC(Y$(LEN(Y$)-1,2)),A0=DEC(Y$(1,Y9))
6910 READ (F,IND=A5)IOL=0310
6940 A=-1; WRITE (F,IND=A5)IOL=0310
6945 RETURN 
6950 IF A5>0 THEN GOSUB STORE_INDEX; WRITE (F,IND=A5)IOL=0310; GOSUB RETRIEVE_INDEX ! IF Y$="" THEN Y[0]=Y[0]+1,A5=A5+1,Y[2]=Y[2]+1; WRITE (F,IND=0)IOL=0290 ! SSP236777 jdf ! SSP237655 jdf            
6953 IF POR_GATEWAY$="Y" THEN GOTO 6990
6990 RETURN 
7000 ! END OF ENTRIES
7002 END_ENTRY:
7005 GOSUB 6900
7010 Z9=2,Z8=1
7020 GOSUB 6950
7028 IF POR_GATEWAY$="Y" THEN GOTO 7060
7029 D9$="*"; EXIT 
7030 CALL "ZZPROM","8",X3$,S3,"","","V",G9
7040 ON S3+1 GOTO 7100,7050,7160,5495,6400,6100
7055 IF T[0]<>0 THEN CALL "ZZPROM","L1",X3$,S3,"","","",0; ON S3 GOTO 7000,7060,7160
7060 L0=1
7070 IF A9$>"" THEN GOSUB 5900
7075 IF Y$>"" THEN A0=DEC(Y$(1,Y9)) ELSE A0=0
7080 IF POR_GATEWAY$="Y" THEN EXIT ELSE RUN X0$
7100 ! GOTO LINE NUMBER G9
7105 IF G9<=0 THEN G9=1
7110 X[0]=G9; GOTO 1125
7150 ! Delete option
7160 L0=2; GOTO 7070
7200 ! 
7204 IF T[0]<>0 AND ID$="Cash Receipts Entry" AND ID$="LB_LINE" THEN GOTO 7280 ! SSP238654 jdf
7206 IF SCRN_ID$="GLGJRA.2" AND X1$="Cash Receipts Entry" AND T[0]<0 THEN T[0]=T[0]*-1 ! SSP238654 jdf
7207 IF SCRN_ID$="GLGJRA.2" AND X1$="Cash Receipts Entry" AND V[3]>0 THEN T=-1 ! SSP238654 jdf
7210 T[0]=T[0]+V[3]*T
7280 ! PRINT DISTRIBUTION BALANCE"
7281 IF POR_GATEWAY$="Y" THEN RETURN 
7282 Q=63; IF T[0]>0 THEN Q=Q-13
7285 IF T[0]=0 THEN ML_BAL$="  In Balance" ELSE ML_BAL$="" END_IF ; REFRESH_FLG=1
7290 RETURN 
7300 ! Display logic
7310 Q=POS(BIN(A4,Y9)=L0$,Y9),L0=INT(Q/Y9); IF Q>0 THEN GOTO 7400
7311 L0=INT((LEN(L0$)+1)/Y9)
7312 L2$=L2$+CHR(1)+CHR(L0+A1)+CHR(3)+STR(A4:"##0")
7315 IF BIN(A4,Y9)>=L0$ THEN IF LEN(L0$)/Y9<A3 THEN L0$=L0$+BIN(A4,Y9); GOTO 7310
7320 Z=INT(A4/A3)*A3; IF Z=0 THEN Z=1
7330 IF Y$>"" THEN GOSUB 6000
7390 IF X0>0 THEN X0=X0-0
7395 RETURN 
7400 ! Lines section - display line a4
7410 Q=INT(Q/Y9),L0=Q,L1=A4
7440 GOSUB 6300
7490 RETURN 
7600 ! CHECK DATE
7620 IF V3$(1,6)>P1$(NUM(A$(5,2))*6+9,6) AND V3$(1,6)<=P1$(NUM(A$(5,2))*6+15,6) THEN RETURN 
7640 X2$="Warning!!! Date is not within accounting period - RETURN to continue"; CALL "ZZPROM",".4",X3$,S3,X2$,"","",0
7699 RETURN 
7700 ! BACKGROUND
7701 IF POR_GATEWAY$="Y" THEN RETURN 
7705 V0=V9
7725 IF V8>0 THEN CALL "*WINGRP;ENABLE",MEMO.GRP$
7760 X=2-SGN(V1)*2
7790 RETURN 
7800 GET_GL_MASK:; REM SSP 205896
7801 IF POR_GATEWAY$="Y" THEN RETURN ; REM SSP 205896
7810 CALL "ZZDISP","AX","000000000000","G/L",X3$,W2$,"",0,0,X4$; REM SSP 205896
7815 M2=0; FOR X=1 TO LEN(W2$); M2=M2+POS("0"=W2$(X,1)); NEXT X; REM SSP 205896
7820 CALL "ZZDISP","AX","000000000000","J/C",X3$,W3$,"",0,0,X4$; REM SSP 205896
7825 M3=0; FOR X=1 TO LEN(W3$); M3=M3+POS("0"=W3$(X,1)); NEXT X; REM SSP 205896
7830 CALL "ZZDISP","AX","000000000000","JCC",X3$,W4$,"",0,0,X4$; REM SSP 205896
7835 M4=0; FOR X=1 TO LEN(W4$); M4=M4+POS("0"=W4$(X,1)); NEXT X; REM SSP 205896
7840 GET_GL_MASK_END:RETURN ; REM SSP 205896
8000 FIX_INDEX:! SSP236349 jdf
8022 IF Y[1]<>0 THEN GOTO 8140 ! SSP237786 jdf
8023 A5=A5+1; IF A5<(NUM(FIN(F,"NUMREC",ERR=*NEXT))-1) THEN A5=(NUM(FIN(F,"NUMREC",ERR=*NEXT))-1) ! SSP236349 jdf ! SSP237655 jdf
8024 Z=A5 ! SSP237655 jdf
8025 REM IF U2>0 THEN A9$=BIN(Z,Y9)+A9$; GOTO 8100 ! SSP236349 jdf
8030 EXTRACT (F,IND=0,ERR=*RETURN)IOL=0290 ! SSP236349 jdf
8040 IF Y[4]=-2 THEN READ (F); WAIT 0; GOTO 8030 ELSE Y[4]=-2 ! SSP236349 jdf
8050 WRITE (F,IND=0)IOL=0290 ! SSP236349 jdf
8080 Y[1]=Z,Y[4]=-1,Y[0]=Y[1]-1; Y[2]=Y[1]+1 ! SSP236349 jdf  ! SSP237655 jdf
8090 WRITE (F,IND=0)IOL=0290 ! SSP236349 jdf
8100 REM Q0$=BIN(Z,Y9),Q=POS(Q0$=Y$,Y9); IF Q=0 THEN GOTO 8140 ! SSP236349 jdf
8110 REM Y$=Y$(1,Q-1)+Y$(Q+Y9) ! SSP236349 jdf
8140 RETURN ! SSP236349 jdf
8500 FIX_INDEX_2:! SSP236777 jdf
8512 IF Y[1]<>0 THEN GOTO 8610 ! SSP237786 jdf
8520 Z=A5 ! SSP236777 jdf
8530 REM IF U2>0 THEN A9$=BIN(Z,Y9)+A9$; GOTO 8590 ! SSP236777 jdf
8540 EXTRACT (F,IND=0,ERR=*RETURN)IOL=0290 ! SSP236777 jdf
8550 IF Y[4]=-2 THEN READ (F); WAIT 0; GOTO 8540 ELSE Y[4]=-2 ! SSP236777 jdf
8560 WRITE (F,IND=0)IOL=0290 ! SSP236777 jdf
8570 Y[1]=Z,Y[4]=-1,Y[0]=Y[0]-1; IF Y[1]<=Y[0] THEN Y[1]=Y[0]+1; END_IF ; IF Y[0]=Y[2]-1 THEN Y[0]=Y[1]-1; Y[2]=Y[1]+1 ! SSP236777 jdf ! SSP237655 jdf
8580 WRITE (F,IND=0)IOL=0290 ! SSP236777 jdf
8590 REM Q0$=BIN(Z,Y9),Q=POS(Q0$=Y$,Y9); IF Q=0 THEN GOTO 8610 ! SSP236777 jdf
8600 REM Y$=Y$(1,Q-1)+Y$(Q+Y9) ! SSP236777 jdf
8610 RETURN ! SSP236777 jdf
9000 ! ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 6500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,1
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 ! TRANSFER CONTROL
9110 GOTO 7000
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 ! CTRL LOGIC
9505 GOTO 6500
9510 SETERR 9000; GOSUB 6500
9520 ON C9 GOTO 1140,2040
9900 ! END PROGRAM
9905 END_PROC:
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 BEGIN ; SETESC 9350
9950 RUN "ZMENU"
9999 END 
10000 SEL_LB_LINE:
10005 IF STP(LB_LINE$)="" THEN EXIT 
10010 B_LSBOX$=LB_LINE$+SEP+" "
10020 ML_LINE=NUM(B_LSBOX$(1,POS(SEP=B_LSBOX$)-1)),B_LSBOX$=B_LSBOX$(POS(SEP=B_LSBOX$)+1),A4=ML_LINE,L1=A4,L2=A4+1
10030 GL_ACCT$=B_LSBOX$(1,POS(SEP=B_LSBOX$)-1),B_LSBOX$=B_LSBOX$(POS(SEP=B_LSBOX$)+1),GL_ACCT$=STP(GL_ACCT$,3,"-"),GL_ACCT$=PAD(GL_ACCT$,12,"0")
10040 ML_DESC1$=B_LSBOX$(1,POS(SEP=B_LSBOX$)-1),B_LSBOX$=B_LSBOX$(POS(SEP=B_LSBOX$)+1)
10050 ML_DEBIT$=B_LSBOX$(1,POS(SEP=B_LSBOX$)-1),B_LSBOX$=B_LSBOX$(POS(SEP=B_LSBOX$)+1)
10055 ML_CREDIT$=B_LSBOX$(1,POS(SEP=B_LSBOX$)-1)
10060 IF NUM(ML_DEBIT$)=0 THEN ML_AMOUNT=-NUM(ML_CREDIT$) ELSE ML_AMOUNT=NUM(ML_DEBIT$)
10070 CALL "*WINGRP;ENABLE",BUTTS.GRP$
10080 REFRESH_FLG=1,NEXT_ID=LB_LINE.CTL ! ,NEXT_ID=GL_ACCT.CTL
10082 IF _EOM$<>$0D$ AND _EOM$<>$02$ THEN FROM_LINE=1 ELSE FROM_LINE=0
10084 IF T[0]<>0 AND FOLDER_ID$="APGDAA.3" THEN T[0]=NET_SALE ! SSP237719 jdf
10085 GOSUB SEL_VIEW_LINE
10090 RETURN 
10100 MOVE_LINE_UP:
10110 LINES=A4
10130 LIST_BOX FIND LB_LINE.CTL,LINES,LN$,ERR=*RETURN
10135 LIST_BOX LOAD LB_LINE.CTL,LINES,*
10150 LN$(1,3)=STR(A4+(LINES-A4):"##0")
10160 LIST_BOX LOAD LB_LINE.CTL,LINES,LN$
10170 LINES=LINES+1
10180 GOTO 10130
10190 RETURN 
10200 SEL_AMOUNT_FOCUS:
10210 IF V[3]=0 THEN ML_AMOUNT=T[0]
10220 REFRESH_FLG=1
10230 RETURN 
11000 CHECK_BALANCE:
11004 REM IF X1$="Cash Receipts Entry" AND BAL_NOGL=0 THEN MD=0,MC=0,ML_AMOUNT=0; GOTO 11110 ! SSP238654 jdf
11006 ML_DEBIT=0,ML_CREDIT=0,MD=0,MC=0 ! SSP238654 jdf
11007 IF NO_GL AND BAL_NOGL>0 THEN ML_CREDIT=BAL_NOGL,MC=1 ELSE IF NO_GL AND BAL_NOGL<0 THEN ML_DEBIT=-BAL_NOGL,MD=1 ! SSP238654 jdf
11010 FOR XXIDX=1 TO 9999
11020 LIST_BOX FIND LB_LINE.CTL,XXIDX,LN$,ERR=11105
11030 LN$=LN$+SEP+" "
11040 B_LINE=NUM(LN$(1,POS(SEP=LN$)-1)),LN$=LN$(POS(SEP=LN$)+1)
11050 B_GL$=LN$(1,POS(SEP=LN$)-1),LN$=LN$(POS(SEP=LN$)+1)
11060 B_DESC$=LN$(1,POS(SEP=LN$)-1),LN$=LN$(POS(SEP=LN$)+1)
11070 B_DEB$=LN$(1,POS(SEP=LN$)-1),LN$=LN$(POS(SEP=LN$)+1)
11080 B_CRE$=LN$(1,POS(SEP=LN$)-1),LN$=LN$(POS(SEP=LN$)+1)
11090 ML_DEBIT=ML_DEBIT+NUM(B_DEB$),ML_CREDIT=ML_CREDIT+NUM(B_CRE$)
11100 NEXT XXIDX
11101 GOTO 11110
11105 EXITTO 11110
11110 GOSUB CHK_AMT_CHG; REFRESH_FLG=1; IF BAL_NOGL=0 AND T[0]=0 AND FOLDER_ID$<>"APGDAA.3" AND FOLDER_ID$<>"GLGJAA.2" AND SCRN_ID$<>"ARGEAC.4" THEN BAL_NOGL=ML_DEBIT-ML_CREDIT; ML_DEBIT=-BAL_NOGL,ML_CREDIT=ML_DEBIT; END_IF ; IF ML_DEBIT<>ML_CREDIT THEN ML_BAL$="Out of Balance",ML_BAL.CTL'TEXTCOLOR$="RED",ML_BAL1$=MSG("DIST_A")+":         "+STR((ML_DEBIT-ML_CREDIT)*-1:"###,###,###,###,###.00-") ELSE ML_BAL$="In Balance",ML_BAL.CTL'TEXTCOLOR$="BLUE",ML_BAL1$=""; REM IF BAL_NOGL=0 THEN BAL_NOGL=ML_DEBIT-ML_CREDIT ! SSP237786  ! SSP237979 jdf ! SSP238654 jdf
11111 ! 
11112 ! LB_LINE.CTL'SELECTITEM=ML_LINE
11115 IF ML_AMOUNT=0 THEN ML_AMOUNT=(ML_DEBIT-ML_CREDIT)*-1; IF X1$="Cash Receipts Entry" AND SCRN_ID$="GLGJRA.2" AND DIST_AMT<>0 THEN IF (ABS(ML_AMOUNT)+ML_CREDIT)<>ML_DEBIT THEN ML_DEBIT=(DIST_AMT+CHECK_AMT),ML_CREDIT=ML_AMOUNT; ML_AMOUNT=(ML_DEBIT-ML_CREDIT)*-1; IF ML_DEBIT=ML_CREDIT THEN ML_BAL$="In Balance",ML_BAL.CTL'TEXTCOLOR$="BLUE",ML_BAL1$=""; END_IF ; REFRESH_FLG=1 ! SSP238654 jdf
11118 IF (ML_DEBIT-ML_CREDIT)*-1<0 THEN ML_BAL1.CTL'TEXTCOLOR$="RED" ELSE ML_BAL1.CTL'TEXTCOLOR$="BLUE"
11120 RETURN 
12000 ! customer dirtibution amount comming from Cash receipt...
12010 CUST_DISTRIBUTION:
12017 IF X1$="Cash Receipts Entry" THEN IF ML_AMOUNT<>0 THEN IF ML_AMOUNT=V[3] THEN GOTO 12021 ! SSP238654 jdf
12020 IF GL_DIST_AMT<>0 THEN ML_AMOUNT=(-GL_DIST_AMT)
12030 REFRESH_FLG=1
12040 RETURN 
12050 CHECK_BAL_OUT:
12052 GOSUB CHECK_BALANCE
12053 IF ML_DEBIT<>ML_CREDIT THEN IF FOLDER_ID$<>"GLGJAA.2" THEN MSGBOX ML_BAL$,MSG("WARNING"),"INFO,TIM=5"; IGNORE_EXIT=1; CALL "*WINGRP;ENABLE",BUTTS.GRP$ ! 240231
12055 IF B_LINE*2<LEN(Y$) AND B_LINE<>1 THEN Y$=Y$(1,B_LINE*2); GOTO 12055
12070 IF ML_DEBIT<>ML_CREDIT AND OPT$="NO" THEN NEXT_ID=GL_ACCT.CTL
12071 IF OPT$="" THEN GOSUB CHECK_RECORD
12075 GOSUB END_ENTRY
12080 RETURN 
12500 CHK_AMT_CHG:! SSP238654 jdf  check amount has changed
12504 IF T[0]<>0 AND T[0]<>BAL_NOGL THEN MD=0,MC=0 ! SSP238654 jdf 
12510 IF ML_CREDIT<>ML_DEBIT THEN {! SSP238654 jdf
12520 IF MC THEN {IF BAL_NOGL=ML_DEBIT THEN ML_CREDIT=ML_DEBIT ! SSP238654 jdf
12530  } ELSE {! SSP238654 jdf
12540 IF MD THEN {IF BAL_NOGL=(-(ML_CREDIT)) THEN ML_DEBIT=ML_CREDIT_ } ! SSP238654 jdf
12545  } ! SSP238654 jdf
12550  } ! SSP238654 jdf
12560 RETURN ! SSP238654 jdf
21000 CHECK_MEMO: X=LB_LINE.CTL
21010 IF ORIG_FMT$="" THEN ORIG_FMT$=X'FMT$
21020 IF CB_MEMO$="Y" THEN X'FMT$=ORIG_FMT$ ELSE X'FMT$=ORIG_FMT$(1,POS("["=ORIG_FMT$,-1)-1)
21030 RETURN 
21100 DISABLE_BUTTONS:
21110 CALL "*WINGRP;DISABLE",BUTTS.GRP$
21120 RETURN 
22000 CHECK_RECORD:IF NO_GL THEN GOTO 22002
22001 IF POS("Next"=BT_WRT.CTL'TEXT$)<>0 THEN RETURN 
22002 ITEMS=LB_LINE.CTL'ITEMCOUNT; IF LEN(Y$)>ITEMS*2 AND ITEMS<>1 THEN Y$=Y$(1,ITEMS*2)
22003 IF ITEMS=1 AND LEN(Y$)=4 THEN Y$=Y$(1,2) ! SSP 193370
22005 IF LEN(Y$)=0 THEN GOTO *RETURN
22006 A0=DEC(Y$(1,2))
22010 FOR XX=1 TO LEN(Y$) STEP 2
22020 IDX=DEC(Y$(XX,2))
22025 IF FOLDER_ID$="GLGJAA.2" THEN DIM V3$(83) ! SSP237638 jdf
22030 READ (F,IND=IDX)IOL=0310
22035 IF STP(V3$)="" THEN GOTO 22041
22037 IF STP(V3$(1,6))="" THEN V3$(1,6)=X3$(15,6); WRITE (F,IND=IDX)IOL=0310 ! SSP236349 jdf
22040 ! IF DEC(MID(Y$,XX+2,2))=A THEN CONTINUE
22045 IF STP(V3$)="" AND FOLDER_ID$="GLGJAA.2" THEN GOTO 22060 ! SSP237719 jdf
22050 IF XX+1=LEN(Y$) THEN CONTINUE
22060 A=DEC(MID(Y$,XX+2,2)); GOSUB READ_LINES; WRITE (F,IND=IDX)IOL=0310
22065 IF A<=0 THEN CONTINUE
22066 B_A=A
22068 NEXT XX; GOSUB END_ENTRY; RETURN 
22070 READ (F,IND=B_A)IOL=0310
22080 LIST_BOX FIND LB_LINE.CTL,INT(XX/2)+1,LN$,ERR=*CONTINUE
22100 LN$=LN$+SEP+" "
22110 B_LINE=NUM(LN$(1,POS(SEP=LN$)-1)),LN$=LN$(POS(SEP=LN$)+1)
22120 B_GL$=LN$(1,POS(SEP=LN$)-1),LN$=LN$(POS(SEP=LN$)+1)
22130 B_DESC$=LN$(1,POS(SEP=LN$)-1),LN$=LN$(POS(SEP=LN$)+1)
22140 B_DEB=0,B_DEB$=LN$(1,POS(SEP=LN$)-1),LN$=LN$(POS(SEP=LN$)+1),B_DEB=NUM(B_DEB$)
22150 B_CRE=0,B_CRE$=LN$(1,POS(SEP=LN$)-1),LN$=LN$(POS(SEP=LN$)+1),B_CRE=-NUM(B_CRE$)
22160 SS=POS("-"=B_GL$); IF SS<>0 THEN B_GL$=B_GL$(1,SS-1)+B_GL$(SS+1); GOTO *SAME ELSE B_GL$=PAD(B_GL$,12,"0")
22170 IF STP(V9$)<>"" THEN V3$(1,6)=V9$ ELSE V3$(1,6)=X3$(15,6); END_IF ; V3$(7,12)=B_GL$ ! SSP236349 jdf
22180 IF B_DEB<>0 THEN V(3)=B_DEB ELSE V(3)=B_CRE
22190 WRITE (F,IND=B_A,ERR=*NEXT)IOL=0310
22200 ! NEXT XX
22210 RETURN 
23000 READ_LINES:! 23000,10
23010 LIST_BOX FIND LB_LINE.CTL,INT(XX/2)+1,LN$,ERR=*CONTINUE
23020 LN$=LN$+SEP+" "
23030 B_LINE=NUM(LN$(1,POS(SEP=LN$)-1)),LN$=LN$(POS(SEP=LN$)+1)
23040 B_GL$=LN$(1,POS(SEP=LN$)-1),LN$=LN$(POS(SEP=LN$)+1)
23050 B_DESC$=LN$(1,POS(SEP=LN$)-1),LN$=LN$(POS(SEP=LN$)+1)
23060 B_DEB=0,B_DEB$=LN$(1,POS(SEP=LN$)-1),LN$=LN$(POS(SEP=LN$)+1),B_DEB=NUM(B_DEB$)
23070 B_CRE=0,B_CRE$=LN$(1,POS(SEP=LN$)-1),LN$=LN$(POS(SEP=LN$)+1),B_CRE=-NUM(B_CRE$)
23080 SS=POS("-"=B_GL$); IF SS<>0 THEN B_GL$=B_GL$(1,SS-1)+B_GL$(SS+1); GOTO *SAME ELSE B_GL$=PAD(B_GL$,12,"0")
23090 IF STP(V9$)<>"" THEN V3$(1,6)=V9$ ELSE V3$(1,6)=X3$(15,6); END_IF ; V3$(7,12)=B_GL$ ! SSP236349 jdf
23100 IF B_DEB<>0 THEN V(3)=B_DEB ELSE V(3)=B_CRE
23110 ! WRITE (F,IND=B_A,ERR=*NEXT)IOL=0310
23120 RETURN 
24500 STORE_INDEX:! SSP236777 jdf
24501 _MEM=HFN; OPEN (_MEM)"*MEMORY*" ! SSP236777 jdf
24505 READ (F,IND=0)IOL=0290 ! SSP236777 jdf
24506 WRITE (_MEM,IND=0)IOL=0290 ! SSP236777 jdf
24515 IF FOLDER_ID$="GLGJAA.2" THEN DIM VM3$(83),VM[4] ELSE DIM VM3$(LEN(V3$)),VM[4] ! SSP236777 jdf ! SSP237638 jdf
24520 IF A5>1 THEN {! SSP236777 jdf
24525 FOR MEM=1 TO (A5-1) ! SSP236777 jdf
24530 READ (F,IND=MEM)IOL=0320 ! SSP236777 jdf
24540 WRITE (_MEM,IND=MEM)IOL=0320 ! SSP236777 jdf
24545 NEXT MEM ! SSP236777 jdf
24546  }
24550 RETURN ! SSP236777 jdf
24600 RETRIEVE_INDEX:! SSP236777
24605 READ (_MEM,IND=0)IOL=0290 ! SSP236777 jdf
24606 WRITE (F,IND=0)IOL=0290 ! SSP236777 jdf
24610 IF A5>1 THEN {! SSP236777 jdf
24615 FOR MEM=1 TO (A5-1) ! SSP236777 jdf
24620 READ (_MEM,IND=MEM,END=*BREAK)IOL=0320 ! SSP236777 jdf
24630 WRITE (F,IND=MEM)IOL=0320 ! SSP236777 jdf
24640 NEXT MEM ! SSP236777 jdf
24641  }
24645 IF _MEM<>0 THEN CLOSE (_MEM); _MEM=0 ! SSP236777 jdf
24650 RETURN ! SSP236777 jdf
25000 GL2XAB:! SSP236777 jdf
25020 DIM Y[4] ! SSP236777 jdf
25030 A=0,A9=0 ! SSP236777 jdf
25040 IOLIST Y[0],Y[1],Y[2],Y[3],Y[4] ! SSP236777 jdf
25050 IOLIST A9,V3$,V[0],V[1],V[2],V[3],V[4] ! SSP236777 jdf
25080 _GL1=HFN; OPEN (_GL1)"GL1"+%C$ ! SSP236777 jdf
25100 REM "Set up lines  ! SSP236777 jdf
25110 FOR I=1 TO LEN(T9$) STEP 12 ! SSP236777 jdf    
25120 FIND (_GL1,KEY=T9$(I,12),DOM=25125) ! SSP236777 jdf
25130 IF T[INT(I/12)+1]=0 THEN GOTO 25195 ! SSP236777 jdf
25140 GOSUB 25360; IF A>0 THEN GOSUB 25250 ! SSP236777 jdf
25150 A=A9,A9=0 ! SSP236777 jdf
25160 IF FOLDER_ID$="GLGJAA.2" THEN DIM V3$(83),V[4] ELSE DIM V3$(37),V[4] ! SSP236777 jdf  ! SSP237638 jdf
25170 IF V9$<>"" THEN V3$(1,6)=V9$ ELSE V3$(1,6)=X3$(15,6) ! SSP236777 jdf
25180 V3$(7,12)=T9$(I,12),V[3]=T[INT(I/12)+1] ! SSP236777 jdf
25190 T[0]=T[0]-V[3] ! SSP236777 jdf
25200 NEXT I ! SSP236777 jdf
25210 REM "Finish up  ! SSP236777 jdf
25220 GOSUB 25250 ! SSP236777 jdf
25230 T9$="" ! SSP236777 jdf
25240 GOTO 25455 ! SSP236777 jdf
25250 REM "Write out line to index A, A9 is assumed to point to next line  ! SSP236777 jdf
25260 IF A<=0 THEN GOTO 25280 ! SSP236777 jdf
25270 GOSUB STORE_INDEX_2; WRITE (F,IND=A)IOL=25050; GOSUB RETRIEVE_INDEX_2 ! SSP236777 jdf
25280 RETURN ! SSP236777 jdf
25290 REM "END OF LINES  ! SSP236777 jdf
25300 CALL "ZZEXPF",X3$,X4$,"X"+STR(F),"",G9; IF G9>0 THEN GOTO 25455 ! SSP236777 jdf
25320 Z=NUM(FIN(F,"MAXREC")); Y[3]=Z-1 ! SSP236777 jdf
25330 GOTO 25400 ! SSP236777 jdf
25340 REM "End of lines  ! SSP236777 jdf
25350 GOTO 25455 ! SSP236777 jdf
25360 REM "GET NEXT INDEX TO FILE IN A9  ! SSP236777 jdf
25370 EXTRACT (F,IND=0,ERR=25455)IOL=25040 ! SSP236777 jdf
25380 IF Y[4]=-2 THEN READ (F); WAIT 0; GOTO 25370 ! SSP236777 jdf
25390 Y[4]=-2; WRITE (F,IND=0)IOL=25040 ! SSP236777 jdf
25400 IF Y[1]<1 THEN A9=Y[2],Y[2]=Y[2]+1; GOTO 25420 ! SSP236777 jdf
25410 A9=Y[1]; READ (F,IND=A9)Y[1] ! SSP236777 jdf
25420 IF Y[0]<Y[3]-1 THEN Y[0]=Y[0]+1,Y[4]=-1 ELSE Y[4]=-1; GOTO 25290 ! SSP236777 jdf
25430 WRITE (F,IND=0)IOL=25040 ! SSP236777 jdf
25440 IF A0=0 THEN A0=A9 ! SSP236777 jdf
25450 RETURN ! SSP236777 jdf
25460 RETURN ! SSP236777 jdf
25500 STORE_INDEX_2:! SSP236777 jdf
25510 _MEM=HFN; OPEN (_MEM)"*MEMORY*" ! SSP236777 jdf
25512 READ (F,IND=0)IOL=0290 ! SSP237655 jdf
25514 WRITE (_MEM,IND=0)IOL=0290 ! SSP237655 jdf
25520 IF FOLDER_ID$="GLGJAA.2" THEN DIM VM3$(83),VM[4] ELSE DIM VM3$(LEN(V3$)),VM[4] ! SSP236777 jdf ! SSP237638 jdf
25530 IF A>1 THEN {FOR MEM=1 TO (A-1) ! SSP236777 jdf ! SSP237655 jdf
25540 READ (F,IND=MEM)IOL=0320 ! SSP236777 jdf
25550 WRITE (_MEM,IND=MEM)IOL=0320 ! SSP236777 jdf
25560 NEXT MEM ! SSP236777 jdf
25565  } ! SSP237655 jdf
25570 RETURN ! SSP236777 jdf
25580 RETRIEVE_INDEX_2:! SSP236777
25582 READ (_MEM,IND=0)IOL=0290 ! SSP237655 jdf
25584 WRITE (F,IND=0)IOL=0290 ! SSP237655 jdf
25590 IF A>1 THEN {FOR MEM=1 TO (A-1) ! SSP236777 jdf ! SSP237655 jdf
25600 READ (_MEM,IND=MEM,END=*BREAK)IOL=0320 ! SSP236777 jdf ! SSP237655 jdf
25610 WRITE (F,IND=MEM)IOL=0320 ! SSP236777 jdf
25620 NEXT MEM ! SSP236777 jdf
25625  } ! SSP234655 jdf
25630 IF _MEM<>0 THEN CLOSE (_MEM); _MEM=0 ! SSP236777 jdf
25640 RETURN ! SSP236777 jdf
56001 ! "193370-Program Exception - AP Purchase Journal Update              
56002 REM "205896-GL display problem in cash receipts entry    
56005 REM "205896-GL display problem in cash receipts entry                   
56007 REM "195548-GL OUT OF BALANCE G/L entries.                  
56008 REM "222766-If GL account "0000" isn't set up can't just click SAVE     
56009 REM "236349-Enter 2 checks in Manaul Check (add the inv) with 1 line GL,
56010 REM "236777-Invoice is out of balance in AP invoice entry even though   
56011 REM "237786-GL entry in Cash Receipts seems to be broken                
56012 REM "237979-Entering a chargeback line in AR Invoice Entry, when you    
56013 REM "238654-Found 2 situations that will cause issues with journal      
56014 REM "240231-Allow update out of balance GL entries in GLGJAA
