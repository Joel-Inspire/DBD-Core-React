0010 ! RFGCAB - Rf Count Entry Detail                 
0020 ! Generated by ProvideX® NOMADS II File Maintenance on Feb. 27, 2005 15:59
0030 ! ************************************************************************
0035 REM "5.5 - 02/06/07 - 14.833055 - jme - SSP# 203740
0037 REM "203740-WMS if you enter an invalid login it just hangs, should     
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0060 PROCESS "RFGCAB","../RFG/RF.EN"
0090 EXIT 
0100 ! 100 - Initialization
0110 INIT:
0160 _FILE_NAME$="RFR"+%C$
0190 RETURN 
9999 END 
10010 NUM_TO_STR:
10499 RETURN 
10500 PRE_BIN_LOC:
10510 GOSUB CLEAR_FIELDS
10520 REFRESH_FLG=1
10999 RETURN 
11000 SELECT_EXIT:
11010 READ (%RFRFC,KEY=%RFLOC$,DOM=*NEXT)
11020 DIM KYRFC$(4); KYRFC$=KEY(%RFRFC,END=*NEXT)
11030 IF KYRFC$(1,4)=%RFLOC$ THEN {
12000  } ! 11030
12080 CMD_STR$="END"
12090 RETURN 
13000 ! 13000 - Clear the record fields
13010 CLEAR_FIELDS:
13050 %RFLOT$="",%RFQTY=0,%RFCUST$="",%RFITEM$="",%RFUNIT=0,%RFLOT$=""
13055 BARCODE$=""
13065 BIN_LOC$=""
13980 GOSUB NUM_TO_STR
13990 REFRESH_FLG=1
13999 RETURN 
20000 SELECT_BIN_LOC:
20030 CALL_BARCODE:
20040 IF STP(BIN_LOC$,3," ")<>"" THEN {! 24950 }
20045 %RFSCANMODE$=RFSCANMODE$
20050 PERFORM "../RFG/RFGBAR"
20060 IF %RFQTY=0 THEN NEXT_ID=BIN_LOC.CTL,REFRESH_FLG=1; GOSUB CLEAR_FIELDS; GOTO *RETURN
20150 REM check record in count file
20165 SET_PARAM 'XP'=XI
20200 REM check already entered 
20205 PREV_CNT_AMT=0
20210 READ (%RFRFC,KEY=LOC_CODE$+BIN_LOC$+CUST_DIV$+CUST_CODE$+ITEM_CODE$+LOT_NUM$,DOM=*NEXT); IF CONTROL_CODE$<>%RFREF$ THEN MSGBOX MSG("RFG_IRF")+CONTROL_CODE$,"","!"; GOSUB CLEAR_FIELDS; NEXT_ID=BIN_LOC.CTL,REFRESH_FLG=1; GOSUB PRE_BIN_LOC; GOTO *RETURN ELSE PREV_CNT_AMT=QTY_COUNTED
24000 UPDATE_REC:
24050 LOC_CODE$=%RFLOC$,CUST_DIV$=%RFCUST$(1,2),CUST_CODE$=%RFCUST$(3,8)
24060 ITEM_CODE$=%RFITEM$,LOT_NUM$=%RFLOT$
24080 PRIMARY_UM$=%RFUOM$
24085 IF %RFLOT$<>DIM(10) THEN LOTTED_INV_ITEM$="Y"
24090 CONTROL_CODE$=%RFREF$,UNITS_PER_PACKAGE$=%RFUNIT$
24100 QTY_COUNTED=%RFQTY
24400 WRITE (%RFRFC,KEY=LOC_CODE$+BIN_LOC$+CUST_DIV$+CUST_CODE$+ITEM_CODE$+LOT_NUM$)
24900 GOSUB CLEAR_FIELDS
24920 NEXT_ID=BIN_LOC.CTL,REFRESH_FLG=1; GOSUB PRE_BIN_LOC
24950  } ! 20040
24990 RETURN 
25000 SELECT_REVIEW:
25010 READ (%RFRFC,KNO=1,KEY=%RFREF$,DOM=*NEXT)
25040 SHOW_REVIEW$="Y"; GOSUB ENABLE_GROUPS; SHOW_REVIEW$=""
25050 SELECT_NEXT_REVIEW:
25052 REFRESH_FLG=1
25055 COUNT=0
25060 CUST1$="",CUST2$="",CUST3$="",CUST4$="",CUST5$=""
25070 ITEM1$="",ITEM2$="",ITEM3$="",ITEM4$="",ITEM5$=""
25080 LOT1$="",LOT2$="",LOT3$="",LOT4$="",LOT5$=""
25090 QTY1$="",QTY2$="",QTY3$="",QTY4$="",QTY5$=""
25095 UOM1$="",UOM2$="",UOM3$="",UOM4$="",UOM5$=""
25097 BIN1$="",BIN2$="",BIN3$="",BIN4$="",BIN5$=""
25100 EOF=1; KY3$=KEY(%RFRFC,END=*NEXT); IF KY3$(1,10)=%RFREF$ THEN EOF=0
25105 IF EOF THEN IF COUNT=0 THEN GOTO REVIEW_END ELSE NEXT_ID=NEXT.CTL; GOTO *RETURN
25110 IF COUNT=5 THEN NEXT_ID=NEXT.CTL; GOTO *RETURN
25120 ++COUNT
25125 READ (%RFRFC,KEY=KY3$,KNO=1)
25130 IF COUNT=1 THEN CUST1$=CUST_DIV$+CUST_CODE$,ITEM1$=ITEM_CODE$,LOT1$=LOT_NUM$,QTY1$=STR(QTY_COUNTED:"######0"),UOM1$=PRIMARY_UM$,BIN1$=BIN_LOC$
25140 IF COUNT=2 THEN CUST2$=CUST_DIV$+CUST_CODE$,ITEM2$=ITEM_CODE$,LOT2$=LOT_NUM$,QTY2$=STR(QTY_COUNTED:"######0"),UOM2$=PRIMARY_UM$,BIN2$=BIN_LOC$
25150 IF COUNT=3 THEN CUST3$=CUST_DIV$+CUST_CODE$,ITEM3$=ITEM_CODE$,LOT3$=LOT_NUM$,QTY3$=STR(QTY_COUNTED:"######0"),UOM3$=PRIMARY_UM$,BIN3$=BIN_LOC$
25160 IF COUNT=4 THEN CUST4$=CUST_DIV$+CUST_CODE$,ITEM4$=ITEM_CODE$,LOT4$=LOT_NUM$,QTY4$=STR(QTY_COUNTED:"######0"),UOM4$=PRIMARY_UM$,BIN4$=BIN_LOC$
25170 IF COUNT=5 THEN CUST5$=CUST_DIV$+CUST_CODE$,ITEM5$=ITEM_CODE$,LOT5$=LOT_NUM$,QTY5$=STR(QTY_COUNTED:"######0"),UOM5$=PRIMARY_UM$,BIN5$=BIN_LOC$
25900 GOTO 25100
27900 REVIEW_END:
27910 MSGBOX MSG("RF_E_D"),"","",X$
27930 SELECT_EXIT_R:
27940 SHOW_REVIEW$="N"; GOSUB ENABLE_GROUPS; SHOW_REVIEW$=""
27950 NEXT_ID=BIN_LOC.CTL; REFRESH_FLG=1; GOSUB PRE_BIN_LOC
27999 RETURN 
28000 SELECT_DEL_ALL:
28050 MSGBOX MSG("RFD_CNT"),MSG("JUST_CHECK"),"?YESNO",X$
28060 IF X$="NO" THEN NEXT_ID=BIN_LOC.CTL; GOSUB PRE_BIN_LOC; GOTO *RETURN
28090 READ (%RFRFC,KNO=0,KEY=%RFREF$,DOM=*NEXT)
28100 KY3$=KEY(%RFRFC,END=*NEXT); IF KY3$(1,10)=%RFREF$ THEN REMOVE (%RFRFC,KEY=KY3$); GOTO *SAME
28200 REMOVE (%RFRFR,KEY=%RFREF$)
28999 RETURN 
29000 POST_DISPLAY:
29005 DIM P6$(255)
29010 %RFSCANDEF$=P6$(90,1)
29015 SET_PARAM 'XI'=XP
29080 IF POS(%RFSCANDEF$="IM")<>0 THEN %RFSCANMODE$=%RFSCANDEF$,RFSCANMODE$=%RFSCANMODE$; SHOW_SCAN$="N"; GOSUB ENABLE_GROUPS; SHOW_SCAN$=""
29090 RETURN 
55000 ENABLE_GROUPS:
55050 IF SHOW_REVIEW$="Y" THEN CALL "*wingrp;show",REVIEW.GRP$; CALL "*wingrp;hide",ENTRY.GRP$
55060 IF SHOW_REVIEW$="N" THEN CALL "*wingrp;hide",REVIEW.GRP$; CALL "*wingrp;show",ENTRY.GRP$
55070 IF SHOW_SCAN$="N" THEN CALL "*wingrp;hide",SCAN.GRP$
55990 RETURN 
