0010 REM "WMS System Parameters <RFGMPA>
0035 REM "5.7 - 01/12/21 - 11.296111 - jvv - SSP# 307327
0037 REM "307327-WMS Receiving Fiscal Year and Accounting period - DBD-151   
0040 REM "Copyright 2021 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 IF TCB(13)=1 THEN BEGIN 
0052 IF NUL(%WDX$) THEN MSGBOX "You must be using Windx to access this feature!"; GOTO 0075
0055 IF NOT(%GUI) THEN CHUI_MODE=1; %GUI=1; PRINT 'SHOW'(0)
0060 PROCESS "RFGMPA","../RFG/RF.EN"
0065 IF CHUI_MODE THEN %GUI=0; PRINT 'SHOW'(1); RUN "ZMENU"
0075 IF TCB(13)=1 THEN RUN "ZMENU" ELSE EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0$="RFGMPA",X1$="WMS System Parameters"
0140 ! 
0150 X0=-1,X2=-1
0160 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2; IF X1>0 THEN GOSUB WRAPUP
0170 ! 
0190 DIM Z[NUM(X3$(60,3))]
0200 ! Files
0210 Z$="01X ZZPARM  06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0
0225 _ZZPARM=Z[6] ! SSP 307327
0230 GOSUB READ_INFO
0300 ! Iolist Section
0310 IOLIST RF$(1),RF[0],RF[1],RF[2]
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0780 REFRESH_FLG=1
0790 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
1000 ! Get XML Parameter Information
1010 READ_INFO:
1020 DIM RF$(1024),RF[2]
1030 READ (Z[1],KEY=X3$(9,3)+"W/M",DOM=ADD_MSG)IOL=0310
1050 B_RF$=RF$
1090 RETURN 
2000 ! Load Screen with Parameter Information
2010 LOAD_SCREEN:
2020 RFG.A001$=RF$(7,1); RFG.A002$=RF$(8,1); RFG.A003$=RF$(9,1)
2025 FY$=RF$(10,4); ACCTPD$=RF$(14,2),RFY$=FY$,RACCTPD$=ACCTPD$ ! SSP307327
2040 GOSUB LOAD_FY_DROP_BOX
2085 REFRESH_FLG=1
2090 RETURN 
2150 FISCAL_YR_ENTRY:
2175 RF$(10,4)=FY$,RFY$=FY$
2178 IF STP(FY$,2)="" THEN ACCTPD$="",RF$(14,2)=ACCTPD$; REFRESH_FLG=1; GOTO FISCAL_YR_ENTRY_END ! SSP 307327
2180 PERFORM "ZZWLDB;LOAD_ACCTPD" ! SSP 194597
2190 FISCAL_YR_ENTRY_END:! EXIT 
2192 RFY$=FY$,RACCTPD$=""; EXIT 
2199 ! 
2200 ACCT_PERIOD_ENTRY:
2216 ACCTPD$=PAD(ACCTPD$,2,0,"0")
2230 RF$(14,2)=ACCTPD$,RACCTPD$=ACCTPD$
2240 ACCT_PERIOD_ENTRY_END:EXIT 
3000 ! Write the record
3010 WRITE_REC:
3030 IF RF$=B_RF$ THEN RETURN 
3040 WRITE (Z[6],KEY=X3$(9,3)+"W/M")IOL=0310
3080 B_RF$=RF$
3090 RETURN 
4000 ! Load Parameter string with user input from screen
4010 LOAD_INFO:
4020 RF$(7,1)=RFG.A001$; RF$(8,1)=RFG.A002$; RF$(9,1)=RFG.A003$
4030 RF$(10,4)=RFY$,RF$(14,2)=RACCTPD$ ! SSP307327
4080 B_RF$=RF$
4085 WRITE (Z[6],KEY=X3$(9,3)+"W/M")IOL=0310
4090 RETURN 
5000 ! Check Changes
5010 CHECK_CHANGES:
5020 RF$(7,1)=RFG.A001$; RF$(8,1)=RFG.A002$; RF$(9,1)=RFG.A003$
5025 RF$(10,4)=RFY$,RF$(14,2)=RACCTPD$ ! SSP307327
5028 ERRM=0; IF STP(FY$,2)<>"" AND STP(RACCTPD$,2)="" THEN MSGBOX MSG("RFGMPA_04"); NEXT_ID=ACCTPD.CTL; ERRM=1; RETURN 
5030 IF B_RF$=RF$ THEN RETURN 
5040 MSGBOX MSG("REC_ALTERD"),MSG("UPDATED"),"?,YESNO",ANS$
5050 IF ANS$="NO" THEN RETURN 
5060 GOSUB WRITE_REC
5090 RETURN 
8000 ! Add Messages
8010 ADD_MSG:
8020 MSGBOX MSG("ADD_RECORD"),MSG("VERIFY"),"?,YESNO",ANS$
8030 IF ANS$="NO" THEN CMD_STR$="END"; RETURN 
8040 DIM RF$(1024); B_RF$=RF$
8045 RF$(1,6)=X3$(9,3)+"W/M"
8050 NEXT_ID=RFG.A001.CTL
8090 RETURN 
9999 END 
26100 LOAD_FY_DROP_BOX:! SSP 307327
26105 SET_CUR_FY$=FY$,SET_CUR_ACCTPD$=ACCTPD$
26110 ONLY_OPEN$="Y"; PERFORM "ZZWLDB;LOAD_FY"
26130 FY$=CUR_FY$,ACCTPD$=CUR_ACCTPD$
26140 PERFORM "ZZWLDB;LOAD_ACCTPD" ! SSP 194597
26195 RETURN 
56001 REM "273215-Ability to use the Order Notepad instead of Job Notes for   
56002 REM "273402-WMS: Alternate sort order for Recv and Put Away cart display
56003 REM "307327-WMS Receiving Fiscal Year and Accounting period - DBD-151   
