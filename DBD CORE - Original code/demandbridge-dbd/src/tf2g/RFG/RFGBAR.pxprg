0010 ! RFGBAR - Warehousing Barcode Entry
0020 ! Generated by ProvideX® NOMADS II File Maintenance on Feb. 27, 2005 15:59
0030 ! ************************************************************************
0035 REM "5.5 - 08/30/07 - 15.939722 - jdf - SSP# 211380
0037 REM "211380-TopForm file feldnames which are SQL keywords break Oracle. 
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0310 IOLIST RF0$
0390 IOLIST RFB$,RFB[0],RFB[1],RFB[2],RFB[3],RFB[4],RFB[5]
9999 END 
10000 BARCODE:
10010 ENTER ICF,IC0,FM1,RFI,NOTUSED,RF1,BARCODE$,TF_ITEM$,FOUND,LOT,LOT_NUM$
10020 FOUND=0,TF_ITEM$="",LOT_NUM$="",LOT=0
10030 BARCODE$=STP(BARCODE$,2)
10100 ! ICF
10110 IF LEN(BARCODE$)=8 THEN {
10120 CALL "UPDICF;READBYKEY",ICF,4,BARCODE$,SEG2$,SEG3$,SEG4$,SEG5$,ICF$,ICF{ALL},FOUNDICF
10130 CALL "UPDICF;READNEXT",ICF,ICF$,ICF{ALL},FOUNDICF; IF FOUNDICF THEN IF ICF$(234,8)=BARCODE$ THEN TF_ITEM$=ICF$(1,20),FOUND=1,LOT=1,LOT_NUM$=ICF$(234,8)
10145  }
10150 ! RF1
10160 IF LEN(BARCODE$)=8 AND RF1<>0 THEN {
10170 CALL "UPDRF1;READBYKEY",RF1,2,BARCODE$,SEG2$,SEG3$,SEG4$,SEG5$,RF1$,RF1{ALL},FOUNDRF1
10180 CALL "UPDRF1;READNEXT",RF1,RF1$,RF1{ALL},FOUNDRF1; IF FOUNDRF1 THEN IF RF1$(140,8)=BARCODE$ THEN TF_ITEM$=RF1$(13,20),FOUND=1,LOT=1,LOT_NUM$=RF1$(140,8)
10190  }
10200 ! FM1 - cust_code +item code
10210 IF NOT(FOUND) THEN {
10215 PBARCODE$=PAD(BARCODE$,20)
10220 CALL "UPDFM1;READBYKEY",FM1,0,PBARCODE$,SEG2$,SEG3$,SEG4$,SEG5$,FM1$,FM1{ALL},FOUNDFM1; IF FOUNDFM1 THEN TF_ITEM$=FM1$(1,20),FOUND=1
10240  }
10300 ! FM1 - cic code
10310 IF NOT(FOUND) THEN {
10315 PBARCODE$=PAD(BARCODE$,20)
10320 CALL "UPDFM1;READBYKEY",FM1,6,PBARCODE$,SEG2$,SEG3$,SEG4$,SEG5$,FM1$,FM1{ALL},FOUNDFM1
10330 CALL "UPDFM1;READNEXT",FM1,FM1$,FM1{ALL},FOUNDFM1; IF FOUNDFM1 THEN IF FM1$(350,20)=PBARCODE$ THEN TF_ITEM$=FM1$(1,20),FOUND=1
10340  }
10400 ! IC0 - item code
10410 IF NOT(FOUND) THEN {
10415 PBARCODE$=PAD(BARCODE$,20)
10420 CALL "UPDIC0;READBYKEY",IC0,0,PBARCODE$,SEG2$,SEG3$,SEG4$,SEG5$,IC0$,IC0{ALL},FOUNDIC0; IF FOUNDIC0 THEN TF_ITEM$=IC0$(1,20),FOUND=1
10440  }
10450 ! IC0 - item code
10460 IF NOT(FOUND) AND LEN(BARCODE$)<=10 THEN {
10465 PBARCODE$=DIM(10)+PAD(BARCODE$,10)
10470 CALL "UPDIC0;READBYKEY",IC0,0,PBARCODE$,SEG2$,SEG3$,SEG4$,SEG5$,IC0$,IC0{ALL},FOUNDIC0; IF FOUNDIC0 THEN TF_ITEM$=IC0$(1,20),FOUND=1
10490  }
10500 ! RFI - po + line
10510 IF LEN(BARCODE$)=12 AND NOT(FOUND) THEN {
10520 CALL "UPDRFI;READBYKEY",RFI,0,BARCODE$,SEG2$,SEG3$,SEG4$,SEG5$,RFI$,RFI{ALL},FOUNDRFI; IF FOUNDRFI THEN TF_ITEM$=RFI$(13,20),FOUND=1; IF RFI$(33,8)<>DIM(8) THEN LOT=1,LOT_NUM$=RFI$(33,8)
10540  }
10700 ! RFI - po              
10710 IF LEN(BARCODE$)=9 AND NOT(FOUND) THEN {
10720 CALL "UPDRFI;READBYKEY",RFI,0,BARCODE$,DIM(3),SEG3$,SEG4$,SEG5$,RFI$,RFI{ALL},FOUNDRFI; IF FOUNDRFI THEN TF_ITEM$=RFI$(13,20),FOUND=1; IF RFI$(33,8)<>DIM(8) THEN LOT=1,LOT_NUM$=RFI$(33,8)
10740  }
14990 EXIT 
14998 ! 
14999 ! 
56000 REM "180032-Wireless Warehousing                                        
56002 REM "211380-TopForm file feldnames which are SQL keywords break Oracle. 
