0010 ! RFGDB0 - WMS Manager Information Console
0035 REM "5.7 - 07/28/10 - 17.970555 - crg - SSP# 229150
0037 REM "229150-Ability to show contents of cart/pallet
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 IF TCB(13)=1 THEN BEGIN 
0052 IF NUL(%WDX$) THEN MSGBOX "You must be using Windx to access this program"; GOTO 0075
0055 IF NOT(%GUI) THEN CHUI_MODE=1; PRINT 'CS' ! PRINT 'SHOW'(-1)
0060 PROCESS "RFGDB0","../RFG/RF.EN"
0065 REM IF CHUI_MODE THEN BEGIN ; RUN "ZMENU" ! PRINT 'SHOW'(1); RUN "ZMENU"
0075 IF TCB(13)=1 THEN %GUI=0; RUN "ZMENU" ELSE EXIT 
0099 ! **************************************************
0110 INIT:
0120 _SV_KR=PRM('KR'); SET_PARAM 'KR'=0 ! Ensure native handling of KEP()
0125 CALL "ZZWMX3"
0130 GOSUB SETUP_LIBRARY; IF %FLMAINT_MSG$<>"" THEN MESSAGE_LIB %FLMAINT_MSG$
0140 CHANGE_FLG=0,_ENABLE_FLG=0,_KCNT=1,_FIRST_KEY=0,_FIRST_FIELD=0
0160 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,-1,X1,X2; DIM Z[NUM(X3$(60,3))]
0165 Z$="01O PO1... 02O PO2... 03O RFS...  04O FS1...  05O FS2...  06O ICF...  07O IC1...  08O IC0...  10O RFB...  11O RFZ...  12O PO3...  13O ZZPARM  14O FMP...  15O RF1...  "
0170 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0175 PO1=Z[1],PO2=Z[2],RFS=Z[3],FS1=Z[4],FS2=Z[5],ICF=Z[6],IC1=Z[7],IC0=Z[8],RFB=Z[10],RFZ=Z[11],PO3=Z[12],FMP=Z[14],RF1=Z[15]
0180 DOC_LIST=HFN; OPEN (DOC_LIST)"*MEMORY*"
0186 LENGTH_OF_TIMEOUT=200,PO_SCHED_DT$=%X3$(21,6); PO_SCHED_DT_D$=%X3$(21,6); CALL "ZZWDTE;DISPLAY",PO_SCHED_DT_D$
0188 ORD_DT$=PO_SCHED_DT$,ORD_DT_D$=PO_SCHED_DT_D$; OLD_ORD_DT$=ORD_DT$,OLD_ORD_DT_D$=ORD_DT_D$
0191 IF TCB(88)<>0 THEN %WDX$="[wdx]" ELSE %WDX$=""
0299 ! **************************************************
0300 ! 300 - Set up the message library
0310 SETUP_LIBRARY:
0320 _SV_MSGLIB$=MSG(*)
0330 _LANG$=LCS(%NOMAD_DEF_SFX$); IF _LANG$="" THEN _LANG$=LCS(ENV("PVXLANG")); IF _LANG$="" THEN _LANG$=LCS(ENV("LANG")); IF _LANG$="" THEN _LANG$="en"
0340 MESSAGE_LIB "*tfmsglib."+_LANG$,ERR=*NEXT; GOTO 0360
0350 MESSAGE_LIB "*tfmsglib.en"
0360 SET_MSG:GOSUB SETUP_MESSAGES
0370 RETURN 
0399 ! **************************************************
0400 ! ^100 - Retrieve messages from the *msglib.xxx library
0405 SETUP_MESSAGES:
0410 _FYI$=MSG("FYI"),_ERROR$=MSG("ERROR")
0415 _MSG_DIRECTORY$=MSG("DIRECTORY")
0420 _MSG_END_OF_FIL$=MSG("END_OF_FIL")
0425 _MSG_FILOPNERR1$=MSG("FILOPNERR1")
0430 _MSG_JUST_CHECK$=MSG("JUST_CHECK")
0435 _MSG_MANDATORY$=MSG("MANDATORY")
0440 _MSG_NEXT$=MSG("NEXT")
0445 _MSG_NON_NUMER$=MSG("NON_NUMER")
0450 _MSG_NOT_FOUND$=MSG("NOT_FOUND")
0455 _MSG_OVRWRT_CHG$=MSG("OVRWRT_CHG")
0460 _MSG_PRECEDING$=MSG("PRECEDING")
0465 _MSG_PREFIX$=MSG("PREFIX")
0470 _MSG_REC_ACCESS$=MSG("REC_ACCESS")
0475 _MSG_REC_ALTERD$=MSG("REC_ALTERD")
0480 _MSG_REC_CR_NEW$=MSG("REC_CR_NEW")
0485 _MSG_REC_LOCKED$=MSG("REC_LOCKED")
0490 _MSG_X$=MSG("REC_MISS","^"),P=POS("^"=_MSG_X$),_MSG_REC_MISS1$=_MSG_X$(1,P-1),_MSG_REC_MISS2$=_MSG_X$(P+1)
0495 _MSG_REC_NOTFND$=MSG("REC_NOTFND")
0500 _MSG_REC_NO_1ST$=MSG("REC_NO_1ST")
0505 _MSG_REC_NO_LST$=MSG("REC_NO_LST")
0510 _MSG_REC_REMOVE$=MSG("REC_REMOVE")
0515 _MSG_REC_UPDADD$=MSG("REC_UPDADD")
0520 _MSG_X$=MSG("REC_VFYDEL","^"),P=POS("^"=_MSG_X$),_MSG_REC_VFYDEL1$=_MSG_X$(1,P-1),_MSG_REC_VFYDEL2$=_MSG_X$(P+1)
0525 _MSG_X$=MSG("REC_VIEW","^"),P=POS("^"=_MSG_X$),_MSG_REC_VIEW1$=_MSG_X$(1,P-1),_MSG_REC_VIEW2$=_MSG_X$(P+1)
0530 _MSG_REQ_FIELDS$=MSG("REQ_FIELDS")
0535 _MSG_START_FILE$=MSG("START_FILE")
0540 _MSG_UPDATE$=MSG("UPDATE")
0545 _MSG_UPD_OTHER1$=MSG("UPD_OTHER1")
0550 _MSG_UPD_OTHER2$=MSG("UPD_OTHER2")
0555 _MSG_UPD_SAME$=MSG("UPD_SAME")
0560 _MSG_WARNING$=MSG("WARNING")
0565 RETURN 
0595 RETURN 
0599 ! **************************************************
0900 ! 900 - Wrapup
0910 WRAPUP:
0912 IF DOC_LIST>0 THEN CLOSE (DOC_LIST)
0915 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0950 MESSAGE_LIB _SV_MSGLIB$
0960 SET_PARAM 'KR'=_SV_KR
0970 RETURN 
9999 END 
10000 ! get quantities
10010 GET_001:
10012 LINES=1,LINE$="001"
10015 CALL "UPDPO1;QTY_BY_SCHED_DT",PO1,PO_SCHED_DT$,QTY
10020 TF_NAME$[1,1]="Purchase Orders Scheduled "+PO_SCHED_DT_D$,TF_NAME$[1,2]=STR(QTY)
10045 RETURN 
10050 GET_002:
10052 LINES=2,LINE$="002"
10055 CALL "UPDPO2;ZERO_CST_BY_SCHED_DT",PO1,PO2,PO_SCHED_DT$,QTY
10060 TF_NAME$[2,1]="Zero Cost Purchase Orders Scheduled "+PO_SCHED_DT_D$,TF_NAME$[2,2]=STR(QTY)
10090 RETURN 
10100 GET_003:
10105 LINES=3,LINE$="003"
10110 CALL "UPDRFS;GET_QTY",RFS,QTY
10120 TF_NAME$[3,1]="Orders in Pick Queue",TF_NAME$[3,2]=STR(QTY)
10140 RETURN 
10150 GET_005:
10152 ! orders today
10155 LINES=5,LINE$="005"
10160 CALL "UPDFS1;GET_PICK_ORD",FS1,QTY
10185 TF_NAME$[5,1]="Picked Orders",TF_NAME$[5,2]=STR(QTY)
10195 RETURN 
10200 GET_006:
10202 ! old orders not picked
10205 LINES=6,LINE$="006"
10210 CALL "UPDFS1;QTY_BY_ORD_DT_UNPICKED",FS1,OLD_ORD_DT$,QTY
10230 TF_NAME$[6,1]="Unpicked Orders Prior to "+OLD_ORD_DT_D$,TF_NAME$[6,2]=STR(QTY)
10245 RETURN 
10250 GET_004:
10255 LINES=4,LINE$="004"
10260 CALL "UPDFS1;QTY_BY_ORD_DT",FS1,ORD_DT$,QTY
10265 TF_NAME$[4,1]="Orders Entered "+ORD_DT_D$,TF_NAME$[4,2]=STR(QTY)
10290 RETURN 
10300 GET_007:
10302 ! orders on pick hold
10305 LINES=7,LINE$="007"
10310 CALL "UPDFS1;GET_HOLD_ORD",FS1,QTY
10330 TF_NAME$[7,1]="Orders on Pick Hold",TF_NAME$[7,2]=STR(QTY)
10340 RETURN 
10350 GET_008:
10352 ! po in receving
10354 LINES=8,LINE$="008"
10360 CALL "UPDRF1;GET_RECV_QTY",RF1,QTY
10370 TF_NAME$[8,1]="Purchase Orders in Receiving",TF_NAME$[8,2]=STR(QTY)
10390 RETURN 
21000 GET_VALUES:
21001 DIM TF_NAME$[100,2]
21002 PRINT 'MESSAGE'('_RED'+'WHITE'+"GATHERING INFORMATION",0)
21005 DIM CTLID[20],CTLID$[20] ! SSP 218597
21010 GOSUB GET_001
21020 GOSUB GET_002
21025 GOSUB GET_003
21030 GOSUB GET_004
21035 GOSUB GET_005
21040 GOSUB GET_006
21045 GOSUB GET_007
21050 GOSUB GET_008
21900 PRINT_VALUES:
21905 FOR J=1 TO 8
21910 LIST_BOX LOAD LB_LINE.CTL,J,STR(J:"000")+SEP+TF_NAME$[J,1]+SEP+TF_NAME$[J,2]+SEP
21920 NEXT J
21990 RETURN 
21998 ! 
21999 ! 
22000 MAIN_POST_DISPLAY:
22010 RESPCTL=0
22020 GOSUB GET_VALUES
22025 GOSUB SET_CTL ! SSP 218597
22030 PRINT 'MESSAGE'('_BLUE'+'WHITE'+"WAITING "+STR(LENGTH_OF_TIMEOUT)+" SEC",0)
22040 INPUT (0,LEN=1,TIM=LENGTH_OF_TIMEOUT,ERR=*NEXT)WAITPROMPT$
22050 RESPCTL=CTL
22060 GOSUB GET_CTL
22100 ! ESPCTL$=STR(RESPCTL)
22110 SWITCH RESPCTL$ ! 22890
22120 CASE "EXIT","4" ! exit
22125 CMD_STR$="END"; BREAK
22130 CASE "PORD" ! po sched dt
22140 PERFORM "ZZWQRY"
22142 CALL "ZZWDTE;VALIDATE",QRY_VAL$
22145 RESPCTL=0,PO_SCHED_DT$=QRY_VAL$; PO_SCHED_DT_D$=QRY_VAL$; CALL "ZZWDTE;DISPLAY",PO_SCHED_DT_D$
22147 GOSUB GET_001; GOSUB GET_002
22150 BREAK
22160 CASE "ORDD" ! ord dt
22170 PERFORM "ZZWQRY"
22175 CALL "ZZWDTE;VALIDATE",QRY_VAL$
22180 RESPCTL=0,ORD_DT$=QRY_VAL$; ORD_DT_D$=QRY_VAL$; CALL "ZZWDTE;DISPLAY",ORD_DT_D$
22182 GOSUB GET_004
22185 BREAK
22186 CASE "CART" ! cart/pallet
22187 %EXEC_CMD$="PROCESS "+QUO+"RFGMA2"+QUO+","+QUO+"../RFG/RF.EN"+QUO
22188 PROCESS "QRY_RF2","../RFG/RF.EN"
22189 %EXEC_CMD$="" ! 229150
22192 BREAK
22193 CASE "OE" ! oe
22195 %WMS_MGR_IN_OE=1; CALL "FMGODM"; %WMS_MGR_IN_OE=0
22197 IF %WMS_LAST_OE_ORD$<>"" THEN CALL "UPDRFS;WMS_MGR_UPD",RFS,FS1,FS2,IC1,IC0,RFB,RFZ,PO3,FMP,ICF,%WMS_LAST_OE_ORD$; %WMS_LAST_OE_ORD$=""
22199 BREAK
22200 CASE "OORD" ! old orders
22205 PERFORM "ZZWQRY"
22207 CALL "ZZWDTE;VALIDATE",QRY_VAL$
22210 RESPCTL=0,OLD_ORD_DT$=QRY_VAL$; OLD_ORD_DT_D$=QRY_VAL$; CALL "ZZWDTE;DISPLAY",OLD_ORD_DT_D$
22212 GOSUB GET_006
22214 BREAK
22220 CASE "CLRP" ! clear pick hold
22225 PROCESS "QRY_FS1_H","../RFG/RF.EN",ORDER$
22230 IF ORDER$<>"" THEN MSGBOX MSG("CLR_O_P")+ORDER$,MSG("CONFIRM"),"?,YESNO",YESNO$; IF YESNO$="YES" THEN CALL "UPDFS1;CLEAR_PICK_HOLD",FS1,FS2,ORDER$,OK$; IF OK$="NO" THEN MSGBOX MSG("REC_LOCKED")
22235 GOSUB GET_007
22239 BREAK
22500 CASE "LIST"
22510 LIST_BOX READ LB_LINE.CTL,RESP$,MODE$
22520 RESP$=RESP$(1,3)
22550 SWITCH RESP$ ! 22790
22560 CASE "001"
22565 %SCHED_SHIP_DATE$=PO_SCHED_DT$; PROCESS "QRY_PO1_S","../RFG/RF.EN"; %SCHED_SHIP_DATE$=""
22569 BREAK
22570 CASE "002"
22572 CALL "UPDPO2;GET_ZERO_COST_PO",PO1,PO2,PO_SCHED_DT$,ZERO_PO_LIST$
22575 %ZERO_PO_LIST$=ZERO_PO_LIST$,%SCHED_SHIP_DATE$=PO_SCHED_DT$; PROCESS "QRY_PO1_SZ","../RFG/RF.EN"; %SCHED_SHIP_DATE$="",%ZERO_PO_LIST$=""
22579 BREAK
22580 CASE "003"
22582 ! %EXEC_CMD$="PROCESS "+QUO+"FMGODM"+QUO+","+QUO+"../OPG/OP.EN"+QUO
22585 PROCESS "QRY_RFS_1","../RFG/RF.EN"
22586 %EXEC_CMD$=""
22589 BREAK
22600 CASE "004"
22602 %EXEC_CMD$="PROCESS "+QUO+"FMGODM"+QUO+","+QUO+"../OPG/OP.EN"+QUO
22605 %ORDER_DATE$=ORD_DT$; PROCESS "QRY_FS1_S","../RFG/RF.EN"; %ORDER_DATE$=""
22608 %EXEC_CMD$=""
22610 BREAK
22620 CASE "006"
22622 %EXEC_CMD$="PROCESS "+QUO+"FMGODM"+QUO+","+QUO+"../OPG/OP.EN"+QUO
22625 %ORDER_DATE$=ORD_DT$; PROCESS "QRY_FS1_O","../RFG/RF.EN"; %ORDER_DATE$=""
22626 %EXEC_CMD$=""
22627 BREAK
22630 CASE "005"
22632 ! %EXEC_CMD$="PROCESS "+QUO+"FMGODM"+QUO+","+QUO+"../OPG/OP.EN"+QUO
22635 PROCESS "QRY_FS1_P","../RFG/RF.EN"
22636 %EXEC_CMD$=""
22637 BREAK
22640 CASE "007"
22641 ! %EXEC_CMD$="PROCESS "+QUO+"FMGODM"+QUO+","+QUO+"../OPG/OP.EN"+QUO
22642 PROCESS "QRY_FS1_H","../RFG/RF.EN",ORDER$
22643 %EXEC_CMD$=""
22645 BREAK
22650 CASE "008"
22655 PROCESS "QRY_RF1_1","../RFG/RF.EN"
22790 END SWITCH ! 22550
22800 BREAK ! 22500
22890 END SWITCH ! 22110
22905 FOR J=8 TO 1 STEP -1
22910 LIST_BOX LOAD LB_LINE.CTL,J,* ! *
22915 NEXT J
22940 IF RESPCTL$="0" THEN GOSUB GET_VALUES ELSE GOSUB PRINT_VALUES
22980 IF CMD_STR$<>"END" THEN GOTO 22030
22990 RETURN 
22998 ! 
22999 ! 
25000 SET_CTL:! SSP 218597
25010 DIM CTLID[20],CTLID$[20]
25020 CTLID[1]=LB_LINE.CTL,CTLID$[1]="LIST"
25030 CTLID[2]=POR.CTL,CTLID$[2]="PORD"
25035 CTLID[3]=ORD_DT.CTL,CTLID$[3]="ORDD"
25040 CTLID[4]=OLD_ORD.CTL,CTLID$[4]="OORD"
25050 CTLID[5]=OE.CTL,CTLID$[5]="OE"
25100 CTLID[9]=CLR_PICK_HOLD.CTL,CTLID$[9]="CLRP"
25200 CTLID[10]=CARTS.CTL,CTLID$[10]="CART"
25220 CTLID[15]=EXIT.CTL,CTLID$[15]="EXIT"
25300 RETURN 
25500 GET_CTL:! SSP 218597
25510 ID=CTL
25530 FOR X=1 TO 20
25540 IF ID=CTLID[X] THEN RESPCTL$=CTLID$[X]; EXITTO 25590
25550 NEXT X
25590 RETURN 
56000 REM "197947-WMS Managers Dashboard                                      
56002 REM "197945-WMS picking.  if zero pick or qty<ord                       
56004 REM "204718-WMS Mgr console. provide ability to see purchase orders,    
56006 REM "205428-WMS Manager Console - provide option to clear Order         
56008 REM "211380-TopForm file feldnames which are SQL keywords break Oracle. 
56009 ! "218597-WMS Manager Information Console                             
56010 REM "229150-Ability to show contents of cart/pallet
