0010 REM "WMS Order Picking Update <RFGPU0"
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 04/10/14 - 15.358055 - crg - SSP# 269475
0037 REM "269475-reprinting releases - getting multiple copies of packing    
0040 REM "Copyright 2014 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,EC_PARM$,EC${ALL},DATA${ALL},NUM_ENTRIES,OUTPUT
0100 SETERR 9000
0110 X0$="RFGPU0",X1$="WMS Order Picking Update "
0120 EOL$=$0D0A$; EOL$=ATH(STP(EC_PARM$(57,8),1))
0127 HTML_TEXT$="Content-type: text/html"
0140 DIM MESS_INFO$[20] ! ,EC_PARM$(1275)(1275)
0230 DIM ESY$(512)
0240 DIM ECC$(1984),ECC[3]
0250 DIM ESZ$(128),ESZ[18]
0330 IOLIST ESY$
0340 IOLIST ECC$,ECC[0],ECC[1],ECC[2]
0350 IOLIST ESZ$,ESZ[0],ESZ[1],ESZ[2],ESZ[3],ESZ[4],ESZ[5],ESZ[6],ESZ[7],ESZ[8],ESZ[9],ESZ[10],ESZ[11],ESZ[12],ESZ[13],ESZ[14],ESZ[15],ESZ[16],ESZ[17],ESZ[18]
0370 IOLIST ZW2$,ZW2[0],ZW2[1],ZW2[2]
0380 IOLIST ZW9A$,ZW9B$
0400 IOLIST ZW7A$,ZW7B$
0410 IOLIST ZW8A$
0500 REM "Open files
0502 CLOSE (13); OPEN (13)"ZZPARM"
0505 DIM Z[NUM(X3$(60,3))],BLGRBNKS$(100)
0510 Z$="01O RF2...  02O RF0...  03O RFS...  04O AR1...  05O PO6...  09O RFB...  10O FS1...  11O FS2...  12O IC1...  13O ZZPARM  14O IC0...  15O RFK...  16O RFZ...  17O PO3...  18O FMP...  19O ICF...  20O RFS...  21O RFA...  22O FMP...  23O PO3...  24O ICF...  25O SM0...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0525 RF1=Z[2],SM7=Z[15]
0550 RF2=Z[1],RF0=Z[2],RFS=Z[3],PO6=Z[5],FS1=Z[10],FS2=Z[11],AR1=Z[4],IC1=Z[12],IC0=Z[14],RFS_2=Z[20]
0560 RFB=Z[9],RFZ=Z[16],PO3=Z[17],FMP=Z[18],ICF=Z[19]
0570 RFA=Z[21],FMP=Z[22],PO3=Z[23],ICF=Z[24],SM0=Z[25]
0900 PRINT_DOC=0
1000 REM "Process DATA array
1010 FOR I=1 TO NUM_ENTRIES
1015 TAG$=DATA$[I,0],TF_VALUE$=DATA$[I,1]
1050 SWITCH TAG$ ! 1185 end switch
1055 CASE "print_doc"
1057 PRINT_DOC=1; BREAK
1058 CASE "show_tags"
1059 SHOW_TAGS=1; BREAK
1060 CASE "task_num"
1062 TASK_NUM$=TF_VALUE$
1065 CASE "pick_cart"
1067 PICK_CART$=TF_VALUE$; BREAK
1080 CASE "template"
1082 TEMPLATE$=TF_VALUE$; BREAK
1985 END SWITCH ! 1050
1990 NEXT I
2000 ! process data
2015 MSG$=""
2020 SESSION_ID$=EC$[1](1,7)
2025 BUYER$=EC$[2](1,15),BASIC$="RFGPH0",TEMPLATE$="rfgph0.htm"
2040 WHSLIST$=""; CALL "UPDRFK;READBYKEY",Z[15],0,BUYER$,SEG2$,SEG3$,SEG4$,SEG5$,RFK$,RFK{ALL},FOUNDRFK; IF FOUNDRFK THEN WHSLIST$=RFK$(23,40) ! 248055
2045 PICK_PRIO$=RFK$(108,2)
2050 CALL "UPDRF2;GETBINLIST",Z[1],"P",BINLIST$,BUYER$,WHSLIST$
2320 IF TASK_NUM$<>"" THEN {! 3900
2450 CALL "UPDPO6;REPRINT_PACK_FROM_WMS",PO6,RFS,FM0,Z[13],Z[10],TASK_NUM$,PICK_PRIO$
2500 CALL "UPDRFS;UPDATE_TASK",RFS,FS1,FS2,FMP,PO3,ICF,RFA,SM0,IC1,X3$,TASK_NUM$,CALL_CIG,ORDER_HOLD,ORDER$
2510 IF ORDER_HOLD THEN MSG$="WARNING! DO NOT SHIP! ORDER "+ORDER$+" IS ON PICK HOLD"
2800 IF CALL_CIG THEN {! 3800 }
2840 %WMS_PICK=1,%WMS_USER$=BUYER$
2850 CALL "RFGSAS",X3$
3000 CALL "SMGUAA",X3$,X4$,"","*",TASK_NUM$
3010 %WMS_PICK=0,%WMS_USER$=""
3800  } ! 2800 call_cig
3900  } ! 2320 task_num<>""
3910 CALL "UPDRF2;READBYKEY",RF2,0,PICK_CART$,SEG2$,SEG3$,SEG4$,SEG5$,RF2$,RF2{ALL},FOUNDRF2; IF FOUNDRF2 THEN RF2$(12,15)=DIM(15),RF2$(11,1)=" "; CALL "UPDRF2;UPDATE",RF2,RF2$,RF2{ALL},BUSYRF2
3920 CALL "UPDRF0;READBYKEY",RF0,0,TASK_NUM$,SEG2$,SEG3$,SEG4$,SEG5$,RF0$,RF0{ALL},FOUNDRF0; IF FOUNDRF0 THEN CALL "UPDRF0;DELETE",RF0,RF0$,RF0{ALL},FOUNDRF0,BUSYRF0
3950 GOSUB RESET_FILES
3995 DIM BYBINFO$[5]; BYBINFO$[1]=PGN,BYBINFO$[2]="180032.20060308",BYBINFO$[3]=TEMPLATE$,BYBOPTIONS$=""
4110 PERFORM "RFGPDT;PROCESS_TEMPLATE_RFGPH0"
4900 GOTO 9900
5000 ! printdesc
5010 LINE$=TAG$+" "+TAGDESC$
5090 RETURN 
5100 ADD_MSG_TO_LOG:! Add message to log file
5110 MOUT$="SESSION ID|"+EC$[1](1,7)+"|FILE|"+%WEBEC_FILE_NAME$+"|WORKSHEET|"+ECD$(1,10)+"|LINE|"+ECE$(25,3)+"|MESSAGE NO|"+STR(MESSAGE_NO:"00000")+"|MESSAGE|"+MESSAGE$+"|"
5135 MX=FN%_LOG_MESSAGE("MESG",MOUT$)
5145 RETURN 
5149 ! 
5490 RETURN ! 5200
5500 REM create description html
5590 RETURN 
8150 BYB_PROCESSING:! Send LINE$ to EC3BYB for generic fields processing
8160 CALL "EC3BYB",ERR=8161,X3$,X4$,EC_PARM$,EC${ALL},DATA${ALL},NUM_ENTRIES,OUTPUT,LINE$,BYBINFO${ALL},BYBOPTIONS$
8195 RETURN 
8910 DEF FND$(Z9$)=Z9$(3,2)+"/"+Z9$(5,2)+"/"+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
8915 DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
9000 REM "ERROR PROCESSING
9002 J=ERR,K=TCB(5); SETERR 0000; ENDTRACE 
9010 LAST_WEBEC_ERR$="ERR: "+STR(J)+" AT: "+STR(K); LAST_WEBEC_ERR$=GBL("LAST_WEBEC_ERR",LAST_WEBEC_ERR$); REM "131928
9090 GOTO 9900
9900 REM "End
9905 CLOSE (100)
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9915 CLOSE (13)
9950 EXIT 
9999 END 
12000 RESET_FILES:
12005 FILE_NAME$="ECA",FSLOT=33004; GOSUB 12500
12010 FILE_NAME$="ECB",FSLOT=33005; GOSUB 12500
12020 FILE_NAME$="ECC",FSLOT=33006; GOSUB 12500
12030 FILE_NAME$="AR1",FSLOT=33007; GOSUB 12500
12040 FILE_NAME$="FM0",FSLOT=33008; GOSUB 12500
12050 FILE_NAME$="FMP",FSLOT=33009; GOSUB 12500
12060 FILE_NAME$="ECS",FSLOT=33010; GOSUB 12500
12070 FILE_NAME$="ECU",FSLOT=33011; GOSUB 12500
12080 FILE_NAME$="EDC",FSLOT=33012; GOSUB 12500
12090 FILE_NAME$="EDB",FSLOT=33015; GOSUB 12500
12100 FILE_NAME$="ZZPARM",FSLOT=33013; GOSUB 12520
12110 FILE_NAME$="ASP",FSLOT=33016; GOSUB 12500
12120 FILE_NAME$="AR2",FSLOT=33017; GOSUB 12500
12130 REM "do not use FSLOT 33018 - used in 6300 for process scheduling
12140 FILE_NAME$="ECE",FSLOT=33019; GOSUB 12500
12150 FOR F=1 TO 50; CLOSE (F,ERR=*NEXT)
12155 NEXT F
12190 RETURN 
12198 ! 
12199 ! 
12500 REM "Given FILE_NAME$ and FSLOT open file on fslot, try w/comp code, then without, if not able to open log message and leave
12510 CLOSE (FSLOT); OPEN (FSLOT,ERR=12515)FILE_NAME$+X3$(9,3); GOTO 12525
12520 CLOSE (FSLOT); OPEN (FSLOT,ERR=12521)FILE_NAME$; GOTO 12525
12530 RETURN 
56000 REM "180032-Wireless Warehousing                                        
56002 REM "197945-WMS picking.  if zero pick or qty<ord                       
56004 REM "211380-TopForm file feldnames which are SQL keywords break Oracle. 
56005 REM "224717-WMS User Setup Parameters - need conference call to discuss 
56006 REM "269475-reprinting releases - getting multiple copies of packing    
