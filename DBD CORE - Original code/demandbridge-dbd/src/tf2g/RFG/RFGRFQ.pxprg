0010 REM "WMS Label Print Request <RFGRFQ>                 
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 02/02/22 - 10.55596 - jvv - SSP# 307391
0037 REM "307391-Item Description not being poplulated in WMS label print    
0040 REM "Copyright 2022 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0045 ! F TCB(88)=0 THEN MSGBOX "You must be using Windx to Access this program"; IF TCB(13)=1 THEN BEGIN ; RUN "ZMENU" ELSE EXIT ! SSP#232409
0050 ! LEAR ; SETERR 0100; ENTER X3$,X4$,WM1$,WM2$
0090 INIT:
0097 X3$=ARG_1$,X4$=ARG_2$,WM1$=ARG_3$,WM2$=ARG_4$,CUST_DESC$=ARG_5$ ! ,ITEM_DESC$=WM4$
0100 SETERR 9000; SETESC 9300
0110 X0$="RFGRFQ",X1$="WMS Product Label Printing Request"
0115 NO_LOT$="",NUM_LBL$="1"
0120 DIM Z0$(80,"-")
0125 DIM G[4],D[4],Y[4],P[8],X0[4],X1[4],S$(10)
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,-1,X1,X2 ! IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0500 REM "FILES
0505 W=NUM(X3$(60,3)); DIM W[W]
0510 W$="01O RFQ...  02O RFL...  03O IC0...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,W$,W{ALL},Z0,0; ON Z0 GOTO 0521,9900
0530 RFQ=W[1],RFL=W[2],IC0=W[3]
0550 RETURN 
0600 MAIN_POST_DISPLAY:
0620 LOT_NUMBER$=MID(WM1$,234,8)
0625 ITEM_CUST_CODE$=MID(WM1$,1,10)
0640 ITEM_CODE$=MID(WM1$,11,10)
0645 ITEM_DESC$=""; FIND (IC0,KEY=MID(WM1$,1,20),DOM=*NEXT)IC$; ITEM_DESC$=IC$(21,40) ! SSP 307391
0650 ! TEM_DESC$=%DESC$
0660 RECEIPT_DATE$=MID(WM1$,25,6)
0670 LOCATION_CODE$=MID(WM1$,21,4)
0680 PO_DIV$=MID(WM1$,41,2)
0690 PO_NUM$=MID(WM1$,43,7)
0700 PO_DATE$=MID(WM1$,50,6)
0710 FACTORY_JOB_NUM$=MID(WM1$,56,12)
0720 PRIMARY_UM$=MID(WM1$,121,4)
0730 ITEM_BARCODE$=DIM(20)
0740 QTY_PER_UM$=WM2$
0750 CALL "*WINGRP;DISABLE",DISPL_GRP.GRP$
0790 REFRESH_FLG=1
0795 RETURN 
0799 ! 
3800 CHECK_CHANGES:
3820 IF CHANGE_FLG=0 THEN GOTO *RETURN
3830 MSGBOX MSG("REC_ALTERD"),_MSG_UPDATE$,"?,Yesno",_YESNO$
3840 IF _YESNO$="YES" THEN GOTO WRITE_REC
3850 CHANGE_FLG=0
3860 CMD_STR$="E"
3870 RETURN 
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9190,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9190 GOSUB 6600; GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9750 REM 
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0
9770 RETURN 
9900 REM "END PROGRAM
9902 WRAPUP:
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",W{ALL},0,0
9920 SETERR 9940
9930 EXIT 
9940 SETESC 9350
9950 EXIT 
9999 END 
10000 WRITE_REC:
10010 CALL "UPDRFL;READBYKEY",RFL,0,LBL_PTR$,SEG2$,SEG3$,SEG4$,SEG5$,RFL$,RFL{ALL},FOUNDRFL; IF NOT(FOUNDRFL) THEN MSGBOX MSG("LBL_NOF"); NEXT_ID=LBL_PTR.CTL; GOTO *RETURN
10200 NEXT_SEQ=1
10210 NUM_TO_PRINT=1; NUM_TO_PRINT=NUM(NUM_LBL$,ERR=*NEXT)
10305 CALL "UPDRFQ;CLEAR_FIELDS",RFQ$,RFQ{ALL}
10310 RFQ$(1,10)=PAD(LBL_PTR$,10),RFQ$(11,2)="PR",RFQ$(19,8)=LOT_NUMBER$
10315 RFQ$(27,10)=ITEM_CUST_CODE$,RFQ$(37,10)=ITEM_CODE$,RFQ$(47,40)=ITEM_DESC$,RFQ$(87,6)=RECEIPT_DATE$,RFQ$(93,4)=LOCATION_CODE$
10320 RFQ$(97,9)=PO_DIV$+PO_NUM$,RFQ$(106,6)=PO_DATE$,RFQ$(112,12)=FACTORY_JOB_NUM$
10325 IF NUM_TO_PRINT>9999 THEN NUM_TO_PRINT=9999
10330 RFQ$(128,4)=STR(NUM_TO_PRINT:"0000")
10335 RFQ$(124,4)=PRIMARY_UM$,RFQ$(152,15)=QTY_PER_UM$
10340 IF CTN_QTY<>0 THEN RFQ$(167,10)=STR(CTN_QTY:"0000000000")
10375 RFQ$(13,6)=STR(NEXT_SEQ:"000000")
10377 CALL "UPDRFQ;READBYKEY",RFQ,0,RFQ$(1,18),SEG2$,SEG3$,SEG4$,SEG5$,RFQ_B$,RFQ_B{ALL},FOUNDRFQB; IF FOUNDRFQB THEN NEXT_SEQ=NEXT_SEQ+1; RFQ$(13,6)=STR(NEXT_SEQ:"000000"); GOTO *SAME
10380 CALL "UPDRFQ;INSERT",RFQ,RFQ$,RFQ{ALL},OK
10400 CMD_STR$="E"; GOSUB WRAPUP
10990 RETURN 
10998 ! 
10999 ! 
11000 SELECT_LBL_PRINT:
11010 LBL_PTR$=PAD(LBL_PTR$,10)
11015 IF LBL_PTR$<>DIM(10) THEN {
11020 CALL "UPDRFL;READBYKEY",RFL,0,LBL_PTR$,SEG2$,SEG3$,SEG4$,SEG5$,RFL$,RFL{ALL},FOUNDRFL
11030 IF NOT(FOUNDRFL) THEN MSGBOX MSG("LBL_NOF"); NEXT_ID=LBL_PTR.CTL ELSE NEXT_ID=CTN_CTY.CTL
11080  }
11090 RETURN 
11100 ! 
11600 SELECT_CTN_QTY:
11610 OK=0,CTN_QTY=0; CTN_QTY=NUM(CTN_QTY$,ERR=*NEXT); OK=1
11620 IF NOT(OK) THEN MSGBOX MSG("INV_QTY"); NEXT_ID=CTN_QTY.CTL
11690 RETURN 
11699 ! 
56002 REM "251758-How to handle a negative release with WMS Labeling          
56003 REM "307391-Item Description not being poplulated in WMS label print    
