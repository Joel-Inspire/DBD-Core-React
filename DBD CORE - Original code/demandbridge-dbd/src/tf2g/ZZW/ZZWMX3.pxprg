0010 ! ZZWMX3 - Make X3 Global Variables
0035 REM "5.7 - 12/09/10 - 15.815 - crg - SSP# 242759
0037 REM "242759-Problem with query in Grid                                  
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 ! ^100,5 - Get the existing stuff
0105 IF NUL(X3$) OR NUL(X4$) THEN CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2
0106 IF STP(X3$(15,6),2)="" OR STP(X3$(21,6),2)="" THEN Q1$=DTE(JUL(0,0,0):"YYYYMMDD"); Q1$=CHR(NUM(Q1$(1,3))-125)+Q1$(4),X3$(15,6)=Q1$,X3$(21,6)=Q1$
0200 ! Set global Variables
0205 %X3_SET=1 ! To indicate that these have been set
0207 %X3$=X3$,%X4$=X4$ ! Save off the whole string to use
0210 %X3_TERM_ID$=X3$(1,2)
0220 %X3_COMP$=X3$(9,3)
0230 %X3_TODAY$=X3$(15,6)
0240 %X3_MACH_DATE$=X3$(21,6)
0250 %X3_MULT_COMP$=X3$(27,1)
0260 %X3_USE_PRMT$=X3$(28,1)
0270 %X3_30_1$=X3$(30,1) ! Used in ARWMAB
0280 %X3_PREF$=X3$(38,2)
0290 %X3_OP_ID$=X3$(40,3)
0300 %X3_OP_PRTY$=X3$(43,2)
0310 %X3_OP_ESC_ENBD$=X3$(47,1)
0320 %X3_DATE_FMT$=X3$(48,1); IF X3$(48,1)="1" THEN %WINDATE_FMT$="MMDDYYYY",DAY_FORMAT$="MM"+X3$(59,1)+"DD"+X3$(59,1)+"YY" ELSE IF X3$(48,1)="2" THEN %WINDATE_FMT$="DDMMYYYY",DAY_FORMAT$="DD"+X3$(59,1)+"MM"+X3$(59,1)+"YY" ELSE %WINDATE$="YYYYMMDD",DAY_FORMAT$="YY"+X3$(59,1)+"MM"+X3$(59,1)+"DD"
0330 %X3_DATE_DLM$=X3$(59,1)
0335 %X3_MAX_FILE$=X3$(60,3)
0340 %X3_DEV_SYS$=X3$(63,1)
0350 %X3_CURR_MASK$=X3$(64,3)
0360 %X3_PREC$=X3$(66,1)
0365 %X3_TIME_FMT$=X3$(67,1)
0366 %X3_TIME_DLM$=X3$(68,1)
0370 %X3_SEC_COD$=X3$(73,4)
0380 %X3_MACH_TYPE$=X3$(77,1)
0390 %X3_COMP_NAME$=X3$(86,40)
0400 %X3_PRIM_MENU$=X3$(140,3)
0410 %X3_USE_BATCH$=X3$(145,1)
0420 %X3_USER_OPTS$=X3$(154,6)
0430 %X3_USER_PRINTER$=X3$(172,2)
0440 %X3_BATCH_P1$=X3$(174,4)
0450 %X3_BATCH_P2$=X3$(185,1)
0460 %X3_LANG_CODE$=X3$(239,1)
0470 %X3_330_1$=X3$(330,1) ! Used in ARWMAB
0475 %X3_OP_DIV_RESTRICTED$=X3$(330,1)
0480 %X3_OP_DIVISION$=X3$(333,2)
0980 %GUI=1
1000 ! Masks
1005 IF NOT(%GLOBALS_DONE) THEN PERFORM "ZZGGBL;SET_GLOBALS"
1010 %TIME_MASK$="XX:XX"
9000 REM "End of Setup !^9000
9010 SETERR 9030
9020 EXIT 
9030 SETERR 0000
9999 END 
