0010 ! ZZWLKU - Lookup/Validate codes
0020 ! 
0025 ! Starting with 100, lookup/validate rountines
0030 ! Search on VAR$= or file name to find out which codes are in here
0031 ! 7000-9999 used for main processing, do not change
0032 ! Starting with 10000, lookup/validate/parse routines(cust,vend,order,etc)
0035 REM "5.7 - 09/11/19 - 17.920833 - crg - SSP# 307210
0037 REM "307210-International shipping address - add country code           
0040 REM "Copyright 2019 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 ! ^100,5 - Telemarketing System - List Types
0105 LIST_TYPES_FMT:ENTER FIELD$,VAR_TAG$,ERR=LIST_TYPES
0110 LIST_TYPES_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
0115 LIST_TYPES:
0120 GOSUB CHECK_VAR_TAG; VAR$="%list_type_desc"; GOSUB INIT_DESC
0125 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",4)
0130 THE_KEY$=FIELD$
0135 X$="ZP0"+%C$,STRT_POS=5,FIELD_LEN=40,FIELD_DESC$=MSG("LIST_T_C")
0140 GOSUB FIND_RECORD
0145 %LIST_TYPE_CODE$=FIELD$
0150 GOTO DONE
0155 RETURN 
0160 ! 
0200 ! ^100,5 - Telemarketing System - Contact Codes
0205 TM_CONT_COD_FMT:ENTER FIELD$,VAR_TAG$,ERR=TM_CONT_COD
0210 TM_CONT_COD_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
0215 TM_CONT_COD:
0220 GOSUB CHECK_VAR_TAG; VAR$="%cont_name"; GOSUB INIT_DESC
0225 IF NUL(FIELD$) THEN GOTO DONE
0230 OPEN (HFN)"ZP0"+%C$; READ (LFO,KEY=%LIST_TYPE_CODE$,ERR=*NEXT)*,C; CLOSE (LFO)
0235 IF C<>0 THEN {
0240 FIELD$=PAD(FIELD$,6,0,"0")
0245  } ELSE {
0250 FIELD$=PAD(FIELD$,6)
0255  }
0260 THE_KEY$=%LIST_TYPE_CODE$+FIELD$
0265 X$="ZP4"+%C$,STRT_POS=11,FIELD_LEN=40,FIELD_DESC$=MSG("CONT_CODE")
0270 GOSUB FIND_RECORD
0275 GOTO DONE
0280 RETURN 
0300 ! 
0400 ! ^100,5 - Telemarketing System - Action Codes
0405 ACTION_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=ACTION_CODE
0410 ACTION_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=ACTION_CODE
0415 ACTION_CODE:
0416 VAR_TAG$=VAR_TAG$+$FF$ ! SSP230413 jdf
0420 GOSUB CHECK_VAR_TAG; VAR$="%action_desc"; GOSUB INIT_DESC
0425 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=PAD(FIELD$,1)
0430 THE_KEY$=FIELD$
0440 X$="ZP3"+%C$,STRT_POS=2,FIELD_LEN=40,FIELD_DESC$=MSG("ACTI_C")
0445 GOSUB FIND_RECORD
0450 GOTO DONE
0455 RETURN 
0460 ! 
0500 ! ^100,5 - Telemarketing System - Salesperson
0505 TM_SALE_PERS_FMT:ENTER FIELD$,VAR_TAG$,ERR=TM_SALE_PERS; GOTO TM_SALE_PERS
0510 TM_SALE_PERS_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
0515 TM_SALE_PERS:
0520 GOSUB CHECK_VAR_TAG; VAR$="%tm_sales_name"; GOSUB INIT_DESC
0525 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",4,ERR=INVALID_CODE)
0530 THE_KEY$=FIELD$
0535 X$="ZP7"+%C$,STRT_POS=5,FIELD_LEN=40,FIELD_DESC$=MSG("SPER_CODE")
0540 GOSUB FIND_RECORD
0545 GOTO DONE
0550 RETURN 
0555 ! 
0600 ! ^100,5 - Telemarketing System - Source of Lead
0605 SOL_FMT:ENTER FIELD$,VAR_TAG$,ERR=SOURCE_OF_LEAD; GOTO SOURCE_OF_LEAD
0610 SOL_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
0615 SOURCE_OF_LEAD:
0620 GOSUB CHECK_VAR_TAG; VAR$="%source_of_lead"; GOSUB INIT_DESC
0625 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
0630 THE_KEY$=FIELD$
0635 X$="ZP2"+%C$,STRT_POS=4,FIELD_LEN=40,FIELD_DESC$=MSG("SRC_O_L")
0640 GOSUB FIND_RECORD
0645 GOTO DONE
0650 RETURN 
0655 ! 
0700 ! ^100,5 - Telemarketing System - Categories
0705 CATEGORY_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT; GOTO CONTACT_CATEGORY
0710 CATEGORY_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
0715 CONTACT_CATEGORY:
0720 GOSUB CHECK_VAR_TAG; VAR$="%cont_cat_desc"; GOSUB INIT_DESC
0725 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
0730 THE_KEY$=FIELD$
0735 X$="ZP1"+%C$,STRT_POS=4,FIELD_LEN=40,FIELD_DESC$=MSG("CONT_C")
0740 STRT_POS=4
0745 FIELD_LEN=40
0750 FIELD_DESC$=MSG("CONT_C")
0755 GOSUB FIND_RECORD
0760 GOTO DONE
0765 RETURN 
0770 ! 
0800 ! ^100,5 - Telemarketing System - Standard Industry Codes
0805 SIC_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT; GOTO SIC
0810 SIC_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
0815 SIC:
0820 GOSUB CHECK_VAR_TAG; VAR$="%sic_desc"; GOSUB INIT_DESC
0825 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",5,ERR=INVALID_CODE)
0830 THE_KEY$=FIELD$
0835 X$="ZPF"+%C$,STRT_POS=6,FIELD_LEN=40,FIELD_DESC$=MSG("STND_I_C_C")
0840 GOSUB FIND_RECORD
0845 GOTO DONE
0850 RETURN 
0855 ! 
0900 ! ^100,5 - FMP Set - Category/State/Warehouse
0905 FMP_SET_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=FMP_SET; GOTO FMP_SET
0910 FMP_SET_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT
0915 FMP_SET:
0920 ! var_tag indicates set type i.e. eS, eT
0925 GOSUB CHECK_VAR_TAG; VAR$="%set_desc_"; GOSUB INIT_DESC
0930 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",(4-LEN(VAR_TAG$)),ERR=INVALID_CODE) ! 249775
0935 THE_KEY$=VAR_TAG$+FIELD$
0940 X$="FMP"+%C$,STRT_POS=5,FIELD_LEN=30,FIELD_DESC$=MSG("SET_CODE")
0945 GOSUB FIND_RECORD
0950 GOTO DONE
0955 ! 
1000 ! ^100,5 - TM - Selection Codes
1005 TM_SEL_COD_FMT:ENTER FIELD$,VAR_TAG$,ERR=TM_SEL_COD; GOTO TM_SEL_COD
1010 TM_SEL_COD_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
1015 TM_SEL_COD:
1020 GOSUB CHECK_VAR_TAG; VAR$="%sel_cod_desc"; GOSUB INIT_DESC
1025 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
1030 THE_KEY$=FIELD$
1035 X$="ZP6"+%C$,STRT_POS=4,FIELD_LEN=40,FIELD_DESC$=MSG("SELE_C")
1040 GOSUB FIND_RECORD
1045 GOTO DONE
1050 RETURN 
1055 ! 
1100 ! ^100,5 - AR System - Salesperson
1105 SALES_PERSON_FMT:ENTER FIELD$,VAR_TAG$,ERR=SALES_PERSON; GOTO SALES_PERSON
1110 SALES_PERSON_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
1115 SALES_PERSON:
1120 GOSUB CHECK_VAR_TAG; VAR$="%sales_name"; GOSUB INIT_DESC
1125 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",4,ERR=INVALID_CODE)
1130 THE_KEY$=FIELD$
1135 X$="AR3"+%C$,STRT_POS=5,FIELD_LEN=35,FIELD_DESC$=MSG("SPER_CODE")
1140 GOSUB FIND_RECORD
1145 GOTO DONE
1150 RETURN 
1155 ! 
1200 ! ^100,5 - AR Customer Category
1205 CUST_CAT_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=CUST_CAT; GOTO CUST_CAT
1210 CUST_CAT_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT
1215 CUST_CAT:
1220 GOSUB CHECK_VAR_TAG; VAR$="%category_desc"; GOSUB INIT_DESC
1225 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"ARG",9,ERR=INVALID_CODE)
1227 THE_KEY$=FIELD$
1230 X$="ARG"+%C$,STRT_POS=10,FIELD_LEN=30,FIELD_DESC$=MSG("CATEGORY")
1240 GOSUB FIND_RECORD
1245 GOTO DONE
1250 RETURN 
1255 ! 
1300 ! ^100,5 - AR Sales Tax
1305 SALES_TAX_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT; GOTO SALES_TAX
1310 SALES_TAX_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
1315 SALES_TAX:
1320 GOSUB CHECK_VAR_TAG; VAR$="%stax_desc"; GOSUB INIT_DESC
1325 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"AR5",10,ERR=INVALID_CODE)
1330 THE_KEY$=FIELD$
1335 X$="AR5"+%C$,STRT_POS=11,FIELD_LEN=25,FIELD_DESC$=MSG("STAX_CODE")
1340 GOSUB FIND_RECORD
1345 GOTO DONE
1350 RETURN 
1355 ! 
1400 ! ^100,5 - AR Customer Price Class
1405 PRICE_CLASS:
1410 ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
1415 GOSUB CHECK_VAR_TAG; VAR$="%price_class_desc"; GOSUB INIT_DESC
1420 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
1425 THE_KEY$="C"+FIELD$
1430 X$="FMP"+%C$,STRT_POS=5,FIELD_LEN=30,FIELD_DESC$=MSG("CUST_P_C")
1435 GOSUB FIND_RECORD
1440 GOTO DONE
1445 RETURN 
1450 ! 
1500 ! ^100,5 - AR Terms Codes
1505 TERM_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=TERM_CODE
1510 TERM_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
1515 TERM_CODE:
1520 GOSUB CHECK_VAR_TAG; VAR$="%terms_desc"; GOSUB INIT_DESC
1525 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",2,ERR=INVALID_CODE)
1530 THE_KEY$=FIELD$
1535 X$="AR2"+%C$,STRT_POS=3,FIELD_LEN=30,FIELD_DESC$=MSG("TERMS_CODE")
1540 GOSUB FIND_RECORD
1545 GOTO DONE
1550 RETURN 
1555 ! 
1600 ! ^100,5 - GL Account Number
1605 GL_ACCT_FMT:ENTER FIELD$,VAR_TAG$,ERR=GL_ACCT
1610 GL_ACCT_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
1615 GL_ACCT:
1616 IF VAR_TAG$="G/L" THEN VAR_TAG$="GL",REFRESH_FLG=1
1620 GOSUB CHECK_VAR_TAG; VAR$="%gl_acct_desc"; GOSUB INIT_DESC
1625 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"G/L",12,ERR=INVALID_CODE)
1630 THE_KEY$=FIELD$
1640 IF NUM(FIELD$,ERR=*NEXT)=0 THEN GOTO DONE
1650 X$="GL1"+%C$,STRT_POS=13,FIELD_LEN=35,FIELD_DESC$=MSG("GL_ACCT")
1670 GOSUB FIND_RECORD
1675 GOTO DONE
1677 ! 
1680 QRY_DISP:ENTER _X$
1685 _X$=FN%ZZDISP$(_X$,"G/L")
1690 GOTO DONE
1700 ! ^100,5 - FOB Code
1705 FOB_FMT:ENTER FIELD$,VAR_TAG$,ERR=FOB
1710 FOB_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
1715 FOB:
1720 GOSUB CHECK_VAR_TAG; VAR$="%FOB_DESC"; GOSUB INIT_DESC
1725 IF NUL(FIELD$) THEN GOTO DONE
1730 THE_KEY$="F"+FIELD$
1735 X$="FMP"+%C$,STRT_POS=3,FIELD_LEN=15,FIELD_DESC$=MSG("FOB")
1740 GOSUB FIND_RECORD
1745 GOTO DONE
1750 RETURN 
1755 ! 
1800 ! ^100,5 - SHIP VIA Code
1805 SHIP_VIA_FMT:ENTER FIELD$,VAR_TAG$,ERR=SHIP_VIA
1810 SHIP_VIA_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
1815 SHIP_VIA:
1820 GOSUB CHECK_VAR_TAG; VAR$="%SHIP_VIA_DESC"; GOSUB INIT_DESC
1825 IF NUL(FIELD$) THEN GOTO DONE
1830 THE_KEY$="S"+FIELD$
1835 X$="FMP"+%C$,STRT_POS=3,FIELD_LEN=15,FIELD_DESC$=MSG("SHIP_V_C")
1840 GOSUB FIND_RECORD
1845 GOTO DONE
1850 RETURN 
1855 ! 
1900 ! ^100,5 - AP Terms Codes
1905 TERM_CODE_AP_FMT:ENTER FIELD$,VAR_TAG$,ERR=TERM_CODE_AP
1910 TERM_CODE_AP_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
1915 TERM_CODE_AP:
1920 GOSUB CHECK_VAR_TAG; VAR$="%terms_desc_ap"; GOSUB INIT_DESC
1925 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",2,ERR=INVALID_CODE)
1930 THE_KEY$=FIELD$
1935 X$="AP2"+%C$,STRT_POS=3,FIELD_LEN=30,FIELD_DESC$=MSG("TERMS_CODE")
1940 GOSUB FIND_RECORD
1945 GOTO DONE
1950 RETURN 
1955 ! 
2000 ! ^100,5 - Bank Code
2005 BANK_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=BANK_CODE
2010 BANK_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
2015 BANK_CODE:
2020 GOSUB CHECK_VAR_TAG; VAR$="%bank_acct_desc"; GOSUB INIT_DESC
2025 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
2030 THE_KEY$=FIELD$
2035 X$="ZYB"+%C$,STRT_POS=4,FIELD_LEN=30,FIELD_DESC$=MSG("BANK_CODE")
2040 GOSUB FIND_RECORD
2045 GOTO DONE
2050 RETURN 
2055 ! 
2100 ! ^100,5 - AP Vendor Category
2105 VEND_CAT_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=VEND_CAT; GOTO VEND_CAT
2110 VEND_CAT_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT
2115 VEND_CAT:
2120 GOSUB CHECK_VAR_TAG; VAR$="%category_desc_vend"; GOSUB INIT_DESC
2125 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"AP2",9,ERR=INVALID_CODE)
2130 THE_KEY$=FIELD$
2135 X$="AP3"+%C$,STRT_POS=10,FIELD_LEN=30,FIELD_DESC$=MSG("CATEGORY")
2140 GOSUB FIND_RECORD
2145 GOTO DONE
2150 RETURN 
2155 ! 
2200 ! ^100,5 - WebEC Catalog ID
2205 EC_CATALOG_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=EC_CATALOG
2210 EC_CATALOG_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT
2215 EC_CATALOG:
2220 GOSUB CHECK_VAR_TAG; VAR$="%ec_catalog_desc"; GOSUB INIT_DESC
2225 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",10,ERR=INVALID_CODE)
2230 THE_KEY$=FIELD$
2235 X$="EDA"+%C$,STRT_POS=11,FIELD_LEN=30,FIELD_DESC$=MSG("CATALOG_ID")
2240 GOSUB FIND_RECORD
2245 %CATALOG_ID$=FIELD$
2250 GOTO DONE
2255 RETURN 
2260 ! 
2300 ! ^100,5 - Product Code
2305 PRODUCT_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=PRODUCT_CODE
2310 PRODUCT_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=PRODUCT_CODE
2315 PRODUCT_CODE:
2320 GOSUB CHECK_VAR_TAG; VAR$="%Product_code_desc"; GOSUB INIT_DESC
2325 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
2330 THE_KEY$="T"+FIELD$
2335 X$="FMP"+%C$,STRT_POS=5,FIELD_LEN=15,FIELD_DESC$=MSG("PROD_CODE")
2340 GOSUB FIND_RECORD
2345 GOTO DONE
2350 RETURN 
2355 ! 
2400 ! ^100,5 - FORM ITEM codes
2405 FORM_ITEM_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
2410 FORM_ITEM_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT
2415 GOSUB CHECK_VAR_TAG; VAR$="%Item_desc"; GOSUB INIT_DESC
2420 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"i",10,ERR=INVALID_CODE)
2425 THE_KEY$=%CUST_DIV$+%CUST_CODE$+FIELD$; IF STP(%CUST_DIV$+%CUST_CODE$)="" THEN THE_KEY$=%CUSTOMER$+FIELD$
2430 X$="FM1"+%C$,STRT_POS=42,FIELD_LEN=40,FIELD_DESC$=MSG("ITEM_DESC"),REFRESH_FLG=1
2435 GOSUB FIND_RECORD
2440 GOTO DONE
2445 RETURN 
2450 ! 
2500 ! ^100,5 - Format/Validate Plant code & get plant name
2505 ! %plant_vend should be set to vendor code plant read
2510 PLANT_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=PLANT
2515 PLANT_FMT:ENTER FIELD$,VAR_TAG$,ERR=PLANT; GOTO PLANT
2520 PLANT:
2521 IF STP(FIELD$)="" THEN GOTO 2525 ELSE FIELD$=STP(FIELD$)
2522 PVALXX=NUM(FIELD$,ERR=*NEXT); FIELD$=PAD(FIELD$,4,0,"0"); GOTO 2525 ! Changed by DFF... XX=NUM(FIELDS,ERR=*NEXT);REM"SSP#208084,SSP#208306
2525 GOSUB CHECK_VAR_TAG; VAR$="%plant_name"; GOSUB INIT_DESC
2530 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",4,ERR=INVALID_CODE) ! SSP-184541
2535 VAR1$="%PLANT_VEND"+VAR_TAG$
2540 THE_KEY$="P"+VIS(VAR1$)+FIELD$
2545 X$="FM0"+%C$,STRT_POS=16,FIELD_LEN=35,FIELD_DESC$=MSG("PLANT_CODE")
2550 GOSUB FIND_RECORD
2555 GOTO DONE
2560 ! 
2600 ! ^100,5 - Commision codes
2605 COMMISSION_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
2610 COMMISSION_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT
2615 COMMISSION:
2620 GOSUB CHECK_VAR_TAG; VAR$="%commission_desc"; GOSUB INIT_DESC
2625 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",5,ERR=INVALID_CODE)
2630 THE_KEY$=FIELD$
2635 X$="AR4"+%C$,STRT_POS=6,FIELD_LEN=25,FIELD_DESC$=MSG("COMM_CODE")
2640 GOSUB FIND_RECORD
2645 GOTO DONE
2650 RETURN 
2655 ! 
2700 ! ^100,5 - WebEC Sort Codes
2705 EC_SORT_FMT:ENTER FIELD$,VAR_TAG$,ERR=EC_SORT
2710 EC_SORT_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
2715 EC_SORT:
2720 GOSUB CHECK_VAR_TAG; VAR$="%ec_sort_desc"; GOSUB INIT_DESC
2725 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",10,ERR=INVALID_CODE)
2730 THE_KEY$=FIELD$
2735 X$="ECU"+%C$,STRT_POS=11,FIELD_LEN=50,FIELD_DESC$=MSG("SORT_CODE")
2740 GOSUB FIND_RECORD
2745 GOTO DONE
2750 RETURN 
2755 ! 
2800 ! ^100,5 - Unit of Measure
2805 UNIT_FMT:ENTER FIELD$,VAR_TAG$,ERR=UNIT
2810 UNIT_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
2815 UNIT:
2816 IF POS("ADJ"=FIELD$)<>0 THEN FIELD$+=" "; GOTO DONE
2820 GOSUB CHECK_VAR_TAG; VAR$="%unit_desc"; GOSUB INIT_DESC
2825 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",4,ERR=INVALID_CODE)
2830 THE_KEY$="U/M"+FIELD$
2835 X$="ZZPARM",STRT_POS=8,FIELD_LEN=12,FIELD_DESC$=MSG("UNIT")
2840 GOSUB FIND_RECORD
2845 GOTO DONE
2850 RETURN 
2855 ! 
2900 ! ^100,5 - Customer Contacts
2905 CUST_CONT_FMT:ENTER FIELD$,VAR_TAG$,ERR=CUST_CONT
2910 CUST_CONT_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
2915 CUST_CONT:
2920 GOSUB CHECK_VAR_TAG; VAR$="%cust_cont_name"; GOSUB INIT_DESC
2925 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
2930 THE_KEY$="a"+%CUSTOMER$+FIELD$
2935 X$="FMP"+%C$,STRT_POS=154,FIELD_LEN=20,FIELD_DESC$=MSG("CONTACT")
2940 GOSUB FIND_RECORD
2945 GOTO DONE
2950 RETURN 
2955 ! 
3000 ! ^100,5 - Reorder Grouping Codes
3005 REORDER_GROUP_FMT:ENTER FIELD$,VAR_TAG$,ERR=REORDER_GROUP
3010 REORDER_GROUP_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
3015 REORDER_GROUP:
3020 GOSUB CHECK_VAR_TAG; VAR$="%reorder_group_desc"; GOSUB INIT_DESC
3025 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
3030 THE_KEY$="G"+FIELD$
3035 X$="FMP"+%C$,STRT_POS=5,FIELD_LEN=25,FIELD_DESC$=MSG("ITEM_G_C")
3040 GOSUB FIND_RECORD
3045 GOTO DONE
3050 RETURN 
3055 ! 
3100 ! ^100,5 - Credit Card Type
3105 CREDIT_CARD_FMT:ENTER FIELD$,VAR_TAG$,ERR=CREDIT_CARD
3110 CREDIT_CARD_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
3115 CREDIT_CARD:
3120 GOSUB CHECK_VAR_TAG; VAR$="%credit_card_desc"; GOSUB INIT_DESC
3125 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",4,ERR=INVALID_CODE)
3130 THE_KEY$=FIELD$
3135 X$="ASP"+%C$,STRT_POS=5,FIELD_LEN=30,FIELD_DESC$=MSG("CRED_C_T") ! SSP#241256
3140 GOSUB FIND_RECORD
3145 GOTO DONE
3150 RETURN 
3155 ! 
3200 ! ^100,5 - WebEC Catalog Category ID
3205 EC_CAT_FMT:ENTER FIELD$,VAR_TAG$,ERR=EC_CAT
3210 EC_CAT_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
3215 EC_CAT:
3220 GOSUB CHECK_VAR_TAG; VAR$="%ec_cat_desc"; GOSUB INIT_DESC
3225 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",10,ERR=INVALID_CODE)
3230 THE_KEY$=FIELD$
3235 X$="ECG"+%C$,STRT_POS=11,FIELD_LEN=30,FIELD_DESC$=MSG("CATE_I") ! SSP#241050
3240 GOSUB FIND_RECORD
3245 GOTO DONE
3250 RETURN 
3255 ! 
3300 ! ^100,5 - WebEC 3rd Party ID
3305 EC_3RD_PARTY_FMT:ENTER FIELD$,VAR_TAG$,ERR=EC_3RD_PARTY
3310 EC_3RD_PARTY_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
3315 EC_3RD_PARTY:
3320 GOSUB CHECK_VAR_TAG; VAR$="%ec_3rd_party_desc"; GOSUB INIT_DESC
3325 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",10,ERR=INVALID_CODE)
3330 THE_KEY$=FIELD$
3335 X$="EC6"+%C$,STRT_POS=11,FIELD_LEN=30,FIELD_DESC$=MSG("VAR_PRINT")
3340 GOSUB FIND_RECORD
3345 GOTO DONE
3350 RETURN 
3355 ! 
3400 ! ^100,5 - Customer departments (in FM1)
3405 CUST_DEPT_FMT:ENTER FIELD$,VAR_TAG$,ERR=CUST_DEPT
3410 CUST_DEPT_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
3415 CUST_DEPT:
3420 GOSUB CHECK_VAR_TAG; VAR$="%cust_dept_desc"; GOSUB INIT_DESC
3425 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",9,ERR=INVALID_CODE)
3430 THE_KEY$="f"+%CUSTOMER$+FIELD$
3435 X$="FMP"+%C$,STRT_POS=21,FIELD_LEN=30,FIELD_DESC$=MSG("DEPT")
3440 GOSUB FIND_RECORD
3445 GOTO DONE
3450 RETURN 
3455 ! 
3500 ! ^100,5 - EC Buyer ID
3505 EC_BUYER_FMT:ENTER FIELD$,VAR_TAG$,ERR=EC_BUYER
3510 EC_BUYER_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
3515 EC_BUYER:
3520 GOSUB CHECK_VAR_TAG; VAR$="%ec_buyer_name"; GOSUB INIT_DESC
3525 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",15,ERR=INVALID_CODE)
3530 THE_KEY$=FIELD$
3535 X$="ECA"+%C$,STRT_POS=16,FIELD_LEN=35,FIELD_DESC$=MSG("BUYER_ID")
3540 GOSUB FIND_RECORD
3545 GOTO DONE
3550 RETURN 
3555 ! 
3600 ! ^100,5 - EC Item Selection Codes
3605 EC_ITEM_SEL_FMT:ENTER FIELD$,VAR_TAG$,ERR=EC_ITEM_SEL
3610 EC_ITEM_SEL_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
3615 EC_ITEM_SEL:
3620 GOSUB CHECK_VAR_TAG; VAR$="%ec_item_sel_desc"; GOSUB INIT_DESC
3625 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
3630 THE_KEY$=FIELD$
3635 X$="EDH"+%C$,STRT_POS=4,FIELD_LEN=40,FIELD_DESC$=MSG("SELE_C")
3640 GOSUB FIND_RECORD
3645 GOTO DONE
3650 RETURN 
3655 ! 
3700 ! ^100,5 - EC Warehouse Groups
3705 EC_WHSE_GRP_FMT:ENTER FIELD$,VAR_TAG$,ERR=EC_WHSE_GRP
3710 EC_WHSE_GRP_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
3715 EC_WHSE_GRP:
3720 GOSUB CHECK_VAR_TAG; VAR$="%ec_whse_grp_desc"; GOSUB INIT_DESC
3725 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",21,ERR=INVALID_CODE)
3730 THE_KEY$=FIELD$
3735 X$="EDC"+%C$,STRT_POS=22,FIELD_LEN=30,FIELD_DESC$=MSG("WHSE_GRP")
3740 GOSUB FIND_RECORD
3745 GOTO DONE
3750 RETURN 
3755 ! 
3800 ! ^100,5 - Format/Validate Shipto code & get shipto name
3805 ! %CUSTOMER$ should be set
3810 SHIPTO_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=SHIPTO
3815 SHIPTO_FMT:ENTER FIELD$,VAR_TAG$,ERR=SHIPTO; GOTO SHIPTO
3820 SHIPTO:
3825 GOSUB CHECK_VAR_TAG; VAR$="%loc_desc"; GOSUB INIT_DESC
3830 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",4,ERR=INVALID_CODE) ! Put into FIELD$ instead of THE_KEY$, see below
3835 VAR1$="%CUSTOMER"+VAR_TAG$
3840 THE_KEY$="C"+VIS(VAR1$)+FIELD$
3845 X$="FM0"+%C$,STRT_POS=16,FIELD_LEN=35,FIELD_DESC$=MSG("LOC_CODE")
3850 GOSUB FIND_RECORD
3855 GOTO DONE
3860 ! 
3900 ! ^100,5 - Customer cost centers (in FM0)
3905 CUST_COST_CENTER_FMT:ENTER FIELD$,VAR_TAG$,ERR=CUST_COST_CENTER
3910 CUST_COST_CENTER_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
3915 CUST_COST_CENTER:
3920 GOSUB CHECK_VAR_TAG; VAR$="%cust_cost_center_desc"; GOSUB INIT_DESC
3925 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",9,ERR=INVALID_CODE)
3930 THE_KEY$="c"+%CUSTOMER$+FIELD$
3935 X$="FMP"+%C$,STRT_POS=21,FIELD_LEN=30,FIELD_DESC$=MSG("COST_C_C")
3940 GOSUB FIND_RECORD
3945 GOTO DONE
3950 RETURN 
3955 ! 
4000 ! ^100,5 - How to ship code
4005 HOW_TO_SHIP_FMT:ENTER FIELD$,VAR_TAG$,ERR=HOW_TO_SHIP
4010 HOW_TO_SHIP_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
4015 HOW_TO_SHIP:
4020 GOSUB CHECK_VAR_TAG; VAR$="%HOW_TO_SHIP_DESC"; GOSUB INIT_DESC
4025 IF NUL(FIELD$) THEN GOTO DONE
4030 THE_KEY$="H"+FIELD$
4035 X$="FMP"+%C$,STRT_POS=3,FIELD_LEN=15,FIELD_DESC$=MSG("HOW_T_S")
4040 GOSUB FIND_RECORD
4045 GOTO DONE
4050 ! 
4100 ! ^100,5 - Institution Code
4105 INST_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=INST_CODE
4110 INST_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
4115 INST_CODE:
4120 GOSUB CHECK_VAR_TAG; VAR$="%inst_code_desc"; GOSUB INIT_DESC
4125 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",4,ERR=INVALID_CODE)
4130 THE_KEY$=FIELD$
4135 X$="ZYA"+%C$,STRT_POS=5,FIELD_LEN=30,FIELD_DESC$=MSG("INST_C")
4140 GOSUB FIND_RECORD
4145 GOTO DONE
4150 RETURN 
4155 ! 
4200 ! ^100,5 - AR Sales Distribution Codes
4205 SALES_DIST_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=CUST_CAT; GOTO SALES_DIST
4210 SALES_DIST_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT
4215 SALES_DIST:
4220 GOSUB CHECK_VAR_TAG; VAR$="%sales_dist_desc"; GOSUB INIT_DESC
4225 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"ARV",9,ERR=INVALID_CODE)
4230 THE_KEY$=FIELD$
4235 X$="ARV"+%C$,STRT_POS=10,FIELD_LEN=30,FIELD_DESC$=MSG("SALE_D_C")
4240 GOSUB FIND_RECORD
4245 GOTO DONE
4250 ! 
4300 ! ^100,5 - PMS Numbers
4305 PMS_NUM_FMT:ENTER FIELD$,VAR_TAG$,ERR=PMS_NUM
4310 PMS_NUM_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
4315 PMS_NUM:
4320 GOSUB CHECK_VAR_TAG; VAR$="%pms_num_desc"; GOSUB INIT_DESC
4325 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",6,ERR=INVALID_CODE)
4330 THE_KEY$=FIELD$
4335 X$="FMO"+%C$,STRT_POS=7,FIELD_LEN=55,FIELD_DESC$=MSG("PMS_NUM")
4340 GOSUB FIND_RECORD
4345 GOTO DONE
4350 RETURN 
4355 ! 
4400 ! !^100,5 - OS System - Price Plan
4405 CUST_PRICE_PLAN_FMT:ENTER FIELD$,VAR_TAG$,ERR=CUST_PRICE_PLAN; GOTO CUST_PRICE_PLAN
4410 CUST_PRICE_PLAN_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
4415 CUST_PRICE_PLAN:
4420 GOSUB CHECK_VAR_TAG; VAR$="%price_plan_desc"; GOSUB INIT_DESC
4425 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",6,ERR=INVALID_CODE) ! SSP 222704
4430 THE_KEY$=FIELD$
4435 X$="OS5"+%C$,STRT_POS=7,FIELD_LEN=30,FIELD_DESC$=MSG("PRICE_PLAN")
4440 GOSUB FIND_RECORD
4445 GOTO DONE
4450 RETURN 
4455 ! 
4500 ! !^100,5 - OS System - Item Number
4505 OS_ITEM_NUM_FMT:ENTER FIELD$,VAR_TAG$,ERR=CUST_PRICE_PLAN; GOTO CUST_PRICE_PLAN
4510 OS_ITEM_NUM_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
4515 OS_ITEM_NUM:
4520 GOSUB CHECK_VAR_TAG; VAR$="%os_item_desc"; GOSUB INIT_DESC
4525 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",10,ERR=INVALID_CODE)
4530 THE_KEY$=FIELD$
4535 X$="OS0"+%C$,STRT_POS=37,FIELD_LEN=40,FIELD_DESC$=MSG("OS_ITEM")
4540 GOSUB FIND_RECORD
4545 GOTO DONE
4550 RETURN 
4555 ! 
4600 ! ^100,5 - O/P System - Customer Service Rep
4605 CUST_SERV_REP_FMT:ENTER FIELD$,VAR_TAG$,ERR=CUST_SERV_REP; GOTO CUST_SERV_REP
4610 CUST_SERV_REP_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
4615 CUST_SERV_REP:
4620 GOSUB CHECK_VAR_TAG; VAR$="%csr_name"; GOSUB INIT_DESC
4625 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",4,ERR=INVALID_CODE)
4630 THE_KEY$=FIELD$
4635 X$="AR3"+%C$,STRT_POS=5,FIELD_LEN=35,FIELD_DESC$=MSG("CUST_S_R")
4640 GOSUB FIND_RECORD
4645 GOTO DONE
4650 RETURN 
4655 ! 
4700 ! ^100,5 - Warehouse FM0 lookup
4705 ! % whse_name will be set from FM0
4710 WHSE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=WHSE
4715 WHSE_FMT:ENTER FIELD$,VAR_TAG$,ERR=WHSE; GOTO WHSE
4720 WHSE:
4725 GOSUB CHECK_VAR_TAG; VAR$="%whse_name"; GOSUB INIT_DESC
4730 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",4,ERR=INVALID_CODE)
4735 THE_KEY$="D"+DIM(10)+FIELD$
4740 X$="FM0"+%C$,STRT_POS=16,FIELD_LEN=35,FIELD_DESC$=MSG("WHSE_CODE")
4745 GOSUB FIND_RECORD
4750 GOTO DONE
4755 ! 
4800 ! !^100,5 - AR Invoice Number
4805 AR_INVOICE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=AR_INVOICE; GOTO AR_INVOICE
4810 AR_INVOICE_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT
4815 AR_INVOICE:
4820 GOSUB CHECK_VAR_TAG; VAR$="" ! GOSUB INIT_DESC
4825 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"AR6",8,ERR=INVALID_CODE)
4830 THE_KEY$=%CUST_DIV$+%CUST_CODE$+FIELD$
4835 X$="AR6"+%C$,STRT_POS=0,FIELD_LEN=0,FIELD_DESC$=MSG("AR_INV_NUM")
4840 GOSUB FIND_RECORD
4845 GOTO DONE
4850 RETURN 
4855 ! 
4900 ZIP_FMT:ENTER FIELD$,VAR_TAG$,ERR=ZIP
4905 ZIP_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
4910 ZIP:
4915 GOSUB CHECK_VAR_TAG; VAR$="%ZIP_desc"; GOSUB INIT_DESC
4920 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"ZIP",9,ERR=INVALID_CODE)
4925 THE_KEY$=FIELD$
4930 X$="ZY1"+%C$,STRT_POS=10,FIELD_LEN=16,FIELD_DESC$=MSG("CITY")
4935 GOSUB FIND_RECORD
4940 GOTO DONE
4945 RETURN 
4950 ! 
4955 ZIP_GLOBAL:IF %X3_SET THEN CALL "ZZDISP","AGX",DIM(9,"X"),"ZIP",%X3$,%ZIP_MASK$,"",0,0,%X4$; EXIT ELSE %ZIP_MASK$="XXXXX-XXXX"; EXIT ! if we don't have %X4$ yet use a default mask
4960 ZIP_QRY_DISP:ENTER _X$
4965 IF MID(_X$,4,2)="XX" THEN _X$=_X$(1,3)+"00 to "+_X$(1,3)+"99" ELSE IF MID(_X$,6,2)="TO" THEN _X$=_X$(1,3)+MID(_X$,8,2)+" to "+_X$(1,5) ELSE _TX$=_X$; CALL "ZZDISP","AGX",_TX$,"ZIP",%X3$,_X$,"",0,0,%X4$
4970 GOTO DONE
5000 ! !^100,5 - State
5005 STATE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=STATE
5010 STATE_FMT:ENTER FIELD$,VAR_TAG$,ERR=STATE; GOTO STATE
5015 STATE:
5020 GOSUB CHECK_VAR_TAG; VAR$="%state_name"; GOSUB INIT_DESC
5025 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",2,ERR=INVALID_CODE)
5030 THE_KEY$=FIELD$
5035 X$="ZY0"+%C$,STRT_POS=3,FIELD_LEN=30,FIELD_DESC$=MSG("STATE")
5040 GOSUB FIND_RECORD
5045 GOTO DONE
5050 ! 
5054 ! Country
5055 COUNTRY_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=COUNTRY
5060 COUNTRY_FMT:ENTER FIELD$,VAR_TAG$,ERR=COUNTRY; GOTO COUNTRY
5065 COUNTRY:
5070 GOSUB CHECK_VAR_TAG; VAR$="%COUNTRY_DESC"; GOSUB INIT_DESC
5075 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",2,ERR=INVALID_CODE)
5080 THE_KEY$=FIELD$
5085 X$="ZY8"+%C$,STRT_POS=3,FIELD_LEN=60,FIELD_DESC$=MSG("CTRY_DESC")
5090 GOSUB FIND_RECORD
5095 GOTO DONE
5099 ! 
5100 ! ^100,5 - Warehouse FM0 lookup
5105 ! % whse_name will be set from FM0
5110 WHSE_PKLIST_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=WHSE_PKLIST
5115 WHSE_PKLIST_FMT:ENTER FIELD$,VAR_TAG$,ERR=WHSE_PKLIST; GOTO WHSE_PKLIST
5120 WHSE_PKLIST:
5125 GOSUB CHECK_VAR_TAG; VAR$="%whse_pklist_name"; GOSUB INIT_DESC
5130 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",4,ERR=INVALID_CODE)
5135 THE_KEY$="D"+DIM(10)+FIELD$
5140 X$="FM0"+%C$,STRT_POS=16,FIELD_LEN=35,FIELD_DESC$=MSG("WHSE_CODE")
5145 GOSUB FIND_RECORD
5150 GOTO DONE
5155 ! 
5200 ! ^100,5 - Zone RFZ lookup
5210 ZONE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=ZONE
5215 ZONE_FMT:ENTER FIELD$,VAR_TAG$,ERR=ZONE
5220 ZONE:
5225 GOSUB CHECK_VAR_TAG; VAR$="%Zone_desc"; GOSUB INIT_DESC
5230 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",4,ERR=INVALID_CODE) ! SSP274240, change from "P" to "Z"
5235 THE_KEY$=FIELD$
5240 X$="RFZ"+%C$,STRT_POS=14,FIELD_LEN=40,FIELD_DESC$=MSG("ZONE_D") ! SSP274240
5245 GOSUB FIND_RECORD
5250 GOTO DONE
5300 ! ^100,5 - Zone RFZ lookup
5310 LABL_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=LABL
5315 LABL_FMT:ENTER FIELD$,VAR_TAG$,ERR=LABL; GOTO LABL
5320 LABL:
5325 GOSUB CHECK_VAR_TAG; VAR$="%Label_ptr_desc"; GOSUB INIT_DESC
5330 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",10,ERR=INVALID_CODE)
5335 THE_KEY$=FIELD$
5340 X$="RFL"+%C$,STRT_POS=11,FIELD_LEN=40,FIELD_DESC$=MSG("DESC")
5345 GOSUB FIND_RECORD
5350 GOTO DONE
5400 REM RFT LOOKUP SSP 200525
5410 BIN_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=BIN
5415 BIN_FMT:ENTER FIELD$,VAR_TAG$,ERR=BIN; GOTO BIN
5420 BIN:
5425 GOSUB CHECK_VAR_TAG; VAR$="%bin_type"; GOSUB INIT_DESC
5430 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",10,ERR=INVALID_CODE)
5435 THE_KEY$=FIELD$+%WHSE$
5440 X$="RFT"+%C$,STRT_POS=1,FIELD_LEN=14,FIELD_DESC$=MSG("BIN_TYPE")
5445 GOSUB FIND_RECORD
5450 GOTO DONE
5500 ! ^100,5 - Credit Card Merchant Account WO215237
5505 MERCH_ACCT_FMT:ENTER FIELD$,VAR_TAG$,ERR=MERCH_ACCT
5510 MERCH_ACCT_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
5515 MERCH_ACCT:
5520 GOSUB CHECK_VAR_TAG; VAR$="%merch_acct_desc"; GOSUB INIT_DESC
5525 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=PAD(FIELD$,10)
5530 THE_KEY$=FIELD$
5535 X$="CD0"+%C$,STRT_POS=11,FIELD_LEN=30,FIELD_DESC$=MSG("MERCH_ACCT")
5540 GOSUB FIND_RECORD
5545 GOTO DONE
5550 ! Data Replication Target - SSP 223557
5555 DR_TARGET_FMT:ENTER FIELD$,VAR_TAG$,ERR=DR_TARGET
5560 DR_TARGET_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
5565 DR_TARGET:
5570 GOSUB CHECK_VAR_TAG; VAR$="%DR_TARGET_DESC"; GOSUB INIT_DESC
5575 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=PAD(FIELD$,20)
5580 THE_KEY$=FIELD$
5585 X$="DR0"+%C$,STRT_POS=21,FIELD_LEN=30,FIELD_DESC$=MSG("DRT_DESC")
5590 GOSUB FIND_RECORD
5595 GOTO DONE
5600 ! ^100,5 - WMS Warehouse FM0 lookup ! SSP218234 jdf
5605 ! % whse_name will be set from FM0  ! SSP218234 jdf
5610 WMS_WHSE_PKLIST_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=WMS_WHSE_PKLIST ! SSP218234 jdf
5615 WMS_WHSE_PKLIST_FMT:ENTER FIELD$,VAR_TAG$,ERR=WMS_WHSE_PKLIST; GOTO WMS_WHSE_PKLIST ! SSP218234 jdf
5620 WMS_WHSE_PKLIST:! SSP218234 jdf
5625 GOSUB CHECK_VAR_TAG; VAR$="%wms_whse_pklist_name"; GOSUB INIT_DESC ! SSP218234 jdf
5630 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",4,ERR=INVALID_CODE) ! SSP218234 jdf
5635 THE_KEY$="D"+DIM(10)+FIELD$ ! SSP218234 jdf
5640 X$="FM0"+%C$,STRT_POS=16,FIELD_LEN=35,FIELD_DESC$=MSG("WHSE_CODE") ! SSP218234 jdf
5645 GOSUB FIND_RECORD_WMS_WHSE ! 7000,5 - Lookup ! SSP218234 jdf
5650 GOTO DONE ! SSP218234 jdf
5655 FIND_RECORD_WMS_WHSE:! 7000,5 - Lookup  ! SSP218234 jdf
5660 GOSUB FIND_CHANNEL ! SSP218234 jdf
5665 READ RECORD (X,KEY=THE_KEY$,DOM=MISSING,ERR=*NEXT)TF_DESC$ ! SSP218234 jdf
5675 IF STP(VAR$+VAR_TAG$,2)="" THEN RETURN ! SSP218234 jdf
5680 IF TF_DESC$(602,1)=" " THEN GOTO INVALID_CODE ! SSP218234 jdf
5685 IF VAR_TAG$="I/C" THEN VAR_TAG$="" ! SSP218234 jdf
5690 VIA (VAR$+VAR_TAG$)=CVS(TF_DESC$(STRT_POS,FIELD_LEN),3) ! SSP218234 jdf
5695 RETURN ! SSP218234 jdf
6000 ! ^100,5 - Group Code
6005 GROUP_FMT:ENTER FIELD$,VAR_TAG$,ERR=GROUP
6010 GROUP_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
6015 GROUP:
6020 GOSUB CHECK_VAR_TAG; VAR$="%group_desc"; GOSUB INIT_DESC
6025 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
6030 THE_KEY$="g"+FIELD$
6035 X$="FMP"+%C$,STRT_POS=5,FIELD_LEN=30,FIELD_DESC$=MSG("ZRGZ00_03")
6040 GOSUB FIND_RECORD
6045 GOTO DONE
6050 RETURN 
6055 ! 
7000 FIND_RECORD:! 7000,5 - Lookup
7005 GOSUB FIND_CHANNEL
7010 IF (FIN(X,"EXTRACT")="1") AND KEC(X)=THE_KEY$ THEN EXTRACT RECORD (X,KEY=THE_KEY$,DOM=MISSING,ERR=*NEXT)TF_DESC$; GOTO 7020 ELSE READ RECORD (X,KEY=THE_KEY$,DOM=MISSING,ERR=*NEXT)TF_DESC$; GOTO 7020 ! SSP248358 jdf
7015 ERR_MSG$=FIELD_DESC$+" is busy."; GOTO DONE
7020 IF STP(VAR$+VAR_TAG$,2)="" THEN RETURN 
7022 IF VAR_TAG$="I/C" THEN VAR_TAG$=""
7025 VIA (VAR$+VAR_TAG$)=CVS(TF_DESC$(STRT_POS,FIELD_LEN),3)
7030 RETURN 
7035 ! 
7100 MISSING:! ^100,5 - Record not found
7105 GOSUB SPAGHETTI
7110 ERR_MSG$=FIELD_DESC$+" "+MSG("NOT_FOUND")+"."
7115 IF %NO_VALIDATE THEN ERR_MSG$="" ! JIR
7120 GOTO DONE
7125 ! 
7200 INVALID_CODE:! ^100,5 - Invalid numeric entry
7205 ERR_MSG$="Invalid "+FIELD_DESC$; GOTO DONE
7210 ! 
7300 INIT_DESC:! ^100,5 - Clear description and err msg
7305 VIA (VAR$+VAR_TAG$)="",ERR=*NEXT
7310 ERR_MSG$=""
7315 RETURN 
7320 ! 
7400 ! ^100,5 - Var Tag Note
7405 ! If a field in the master file refers to another record in the same
7410 ! master file, master file maintenance routines for next_rec, prev_rec
7415 ! may get the file pointer out of sequence.  In order to force a new
7420 ! channel to be opened during the validate/format routine, set the
7425 ! add $FF$ to the user defined tag field associated with the control.
7430 ! 
7450 CHECK_VAR_TAG:! ^50,5 - Look for $FF$ in var tag
7455 IF POS($FF$=VAR_TAG$) THEN {
7460 VAR_TAG$=SUB(VAR_TAG$,$FF$,"")
7465 FORCE_FILE_OPEN=1
7470  }
7475 RETURN 
7480 ! 
7500 SPAGHETTI:! ^100,5 - Exceptions to the DOM Rule
7505 IF X$(1,3)="FMP" AND THE_KEY$(1,1)="C" THEN {
7510 IF THE_KEY$(2,3)>="000" AND THE_KEY$(2,3)<"100" THEN {
7515 VIA (VAR$+VAR_TAG$)="Unknown"
7520 EXITTO DONE
7525  }
7530  }
7531 IF X$(1,3)="PO1" AND NOT(NUL(%SALES_ORDER_PREFIX$)) THEN FIELD$=SUB(FN%ZZDISP$(%SALES_ORDER_PREFIX$,"O/P"),"-",""); ERR_MSG$=FIELD_DESC$+" "+MSG("NOT_FOUND")+"."; EXITTO DONE
7535 RETURN 
7540 ! 
7545 ! FN_INPUT_TO_FIELD$ -> take IN$ as input and get full FIELD$ to return, based on ACCT_TYPE$ (eg A/R) and TOTAL_LENGTH. If ACCT_TYPE$="P" then just pad the field to TOTAL_LENGTH, if ACCT_TYPE$="Z" then if number, left zero fill to TOTAL_LENGTH, else pad to TOTAL_LENGTH
7550 DEF FN_INPUT_TO_FIELD$(LOCAL IN$, LOCAL ACCT_TYPE$, LOCAL TOTAL_LENGTH)
7555 IF LEN(IN$)=TOTAL_LENGTH THEN FIELD$=IN$; GOTO ITF_DONE
7560 LOCAL FIELD$,ACCT_DEF$,INDEX,INDEX2,SEG_TYPE$,SEG_LEN$,SEG_LENGTH,SEG$,CHAR_LENGTH,ZFILL_LENGTH,LAST_SEG_WAS_NUMBER,I$
7565 IF NOT(%X3_SET) OR LEN(%X4$)=0 THEN CALL "ZZWMX3" ! Make sure %X3$ & %X4$ are set
7570 IN$=SUB(IN$,$AD$,"-") ! put in correct '-' character
7575 SWITCH ACCT_TYPE$
7577 CASE "i"
7578 IF TOTAL_LENGTH<10 THEN FIELD$=STR(NUM(IN$,ERR=*NEXT):DIM(TOTAL_LENGTH,"0")); GOTO ITF_DONE
7579 FIELD$=PAD(IN$,10," "); GOTO ITF_DONE
7580 CASE "P" ! Pad to TOTAL_LENGTH with spaces >>no BREAK< exiting by GOTO
7585 FIELD$=PAD(IN$,TOTAL_LENGTH); GOTO ITF_DONE
7590 CASE "Z" ! If number, then left zero fill to TOTAL_LENGTH, otherwise pad out to TOTAL_LENGTH >>no BREAK, exiting by GOTO in all cases
7595 FIELD$=STR(NUM(IN$,ERR=*NEXT):DIM(TOTAL_LENGTH,"0")); GOTO ITF_DONE
7596 FIELD$=PAD(IN$,TOTAL_LENGTH); GOTO ITF_DONE
7600 CASE "I" ! Item code entry - if number (and param < 10), then left zero fill to TOTAL_LENGTH, otherwasie pat out to 10 >>no BREAK, exiting by GOTO in all cases
7601 IF TOTAL_LENGTH<10 THEN FIELD$=STR(NUM(IN$,ERR=*NEXT):DIM(TOTAL_LENGTH,"0")); GOTO ITF_DONE
7602 FIELD$=PAD(IN$,10); GOTO ITF_DONE
7605 DEFAULT ! normal ACCT_TYPE given to lookup in %X4$, will leave via END sWITCH >> will leave via GOTO if ACCT_TYPE$ not in %X4$
7610 ACCT_DEF$=STP(TBL(SGN(POS(ACCT_TYPE$=%X4$(7),12)),"",MID(%X4$,POS(ACCT_TYPE$=%X4$(7),12)+9,9)),1); IF LEN(ACCT_DEF$)<3 THEN FIELD$=IN$; GOTO ITF_DONE ! get mask def from %X4$, if nul, then just return  the field
7615 END SWITCH 
7620 ! Process the field according to the acct type
7625 FOR INDEX=3 TO LEN(ACCT_DEF$) STEP 2
7630 ! get segment info & default segment - d=Set division segment from %X3$
7635 SEG_TYPE$=ACCT_DEF$(INDEX-1,1),SEG_LEN$=ACCT_DEF$(INDEX,1)
7640 IF SEG_TYPE$="d" THEN SEG$=%X3$(331,2); GOTO NEXT_SEG ELSE CHAR_LENGTH=1+SGN(POS(SEG_TYPE$="Ee")),SEG_LENGTH=ASC(ATH("0"+SEG_LEN$))*CHAR_LENGTH; IF POS(SEG_TYPE$="Zz123456789")>0 THEN DIM SEG$(SEG_LENGTH,"0") ELSE DIM SEG$(SEG_LENGTH)
7645 IF POS(SEG_TYPE$="zaes")>0 THEN GOTO NEXT_SEG ELSE ZFILL_LENGTH=0,ZFILL_LENGTH=NUM(SEG_TYPE$,ERR=*NEXT) ! zaes are hidden segments, if type is a number then ZFILL_LENGTH is different from SEG_LENGTH
7650 IF LEN(IN$)>=SEG_LENGTH THEN SEG$=IN$(1,SEG_LENGTH),IN$=MID(IN$,SEG_LENGTH+1) ELSE IF IN$>"" THEN SEG$=IN$,IN$=""
7655 LAST_SEG_WAS_NUMBER=0; IF POS("E"=SEG$)>0 OR POS(" "=STP(SEG$,1))>0 THEN GOTO *NEXT ELSE IF SEG_TYPE$<>"S" AND SEG$<>"" THEN IF ZFILL_LENGTH=0 THEN SEG$=STR(NUM(SEG$,ERR=*NEXT):DIM(SEG_LENGTH,"0")),LAST_SEG_WAS_NUMBER=1; GOTO CORRECT_CHAR_LENGTH ELSE SEG$=STR(NUM(SEG$,ERR=*NEXT):DIM(ZFILL_LENGTH,"0"),ERR=*NEXT),LAST_SEG_WAS_NUMBER=1; GOTO CORRECT_CHAR_LENGTH ! If E in seg it will be mistaken for scientfic notation number, so skip, if blank in middle then skip, else try to num it with either SEG_LENGTH or ZFILL_LENGTH
7660 SEG$=PAD(SEG$,SEG_LENGTH,1)
7665 CORRECT_CHAR_LENGTH:IF CHAR_LENGTH>1 THEN I$=""; FOR INDEX2=1 TO LEN(SEG$) STEP 2; I$=I$+CHR(32+NUM(MID(SEG$,INDEX2,2),ERR=*CONTINUE),ERR=*CONTINUE); NEXT INDEX2; SEG$=I$,I$=""
7670 NEXT_SEG: FIELD$=FIELD$+SEG$
7675 NEXT INDEX
7680 IF LEN(FIELD$)<TOTAL_LENGTH THEN I$=ACCT_DEF$(1,1); IF I$="?" THEN IF LAST_SEG_WAS_NUMBER=1 THEN I$="0" ELSE I$=" " END_IF END_IF ; FIELD$=PAD(FIELD$,TOTAL_LENGTH,I$) ! if field shorter than total length then set fill char, if ? set based on last seg being a number or not, and pad out
7685 IF LEN(FIELD$)<X3 THEN DIM I$(X3-LEN(FIELD$),I$); FIELD$=FIELD$+I$
7690 ITF_DONE:RETURN FIELD$
7695 END DEF
7700 ! 
8500 FIND_CHANNEL:! 8500,5 - Find Channel
8505 IF FORCE_FILE_OPEN THEN X=-1 ELSE X=FN%FFN(X$) ! [205471]-changed FFN() to FN%FFN()
8510 IF X=-1 THEN {
8515 XX=HFN; OPEN (HFN)X$
8520 X=XX
8525  }
8530 RETURN 
8535 ! 
8600 ! ^100,5 - Promotion Code
8605 PROMOTION_FMT:ENTER FIELD$,VAR_TAG$,ERR=PROMOTION
8610 PROMOTION_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
8615 PROMOTION:
8620 GOSUB CHECK_VAR_TAG; VAR$="%promotion_DESC"; GOSUB INIT_DESC
8625 IF NUL(FIELD$) THEN GOTO DONE
8630 THE_KEY$="Q"+FIELD$
8635 X$="FMP"+%C$,STRT_POS=4,FIELD_LEN=40,FIELD_DESC$=MSG("PROM_C")
8640 GOSUB FIND_RECORD
8645 GOTO DONE
8650 RETURN 
8660 ! ^100,5 - Data Type
8665 DATA_TYPE_FMT:ENTER FIELD$,VAR_TAG$,ERR=DATA_TYPE
8670 DATA_TYPE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
8675 DATA_TYPE:
8680 GOSUB CHECK_VAR_TAG; VAR$="%DATA_TYPE_DESC"; GOSUB INIT_DESC
8685 IF NUL(FIELD$) THEN GOTO DONE
8690 FIELD$=PAD(FIELD$,8," "),THE_KEY$="G/L"+FIELD$
8695 X$="FR1"+%C$,STRT_POS=12,FIELD_LEN=30,FIELD_DESC$=MSG("DATA_T_P")
8700 GOSUB FIND_RECORD
8705 GOTO DONE
8710 RETURN 
8720 ! ^100,5 - Special Charge
8725 SPECIAL_CHARGE_FMT:ENTER FIELD$,VAR_TAG$,ERR=SPECIAL_CHARGE
8730 SPECIAL_CHARGE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
8735 SPECIAL_CHARGE:
8740 GOSUB CHECK_VAR_TAG; VAR$="%special_charge_desc"; GOSUB INIT_DESC
8745 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",10,ERR=INVALID_CODE)
8750 THE_KEY$="X"+FIELD$
8755 X$="FMP"+%C$,STRT_POS=12,FIELD_LEN=40,FIELD_DESC$=MSG("SPEC_CHRG") ! SSP245230/WO243848, FIELD_LEN was set to 30, needs to be 40
8760 GOSUB FIND_RECORD
8765 GOTO DONE
8770 RETURN 
8900 ! ^100,5 - Format/Validate def Shipto code & get shipto name
8905 ! %CUSTOMER$ should be set
8910 DEF_SHIPTO_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=DEF_SHIPTO
8915 DEF_SHIPTO_FMT:ENTER FIELD$,VAR_TAG$,ERR=DEF_SHIPTO; GOTO DEF_SHIPTO
8920 DEF_SHIPTO:
8925 GOSUB CHECK_VAR_TAG; VAR$="%loc_desc"; GOSUB INIT_DESC
8930 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",4,ERR=INVALID_CODE) ! Put into FIELD$ instead of THE_KEY$, see below
8940 THE_KEY$="D"+DIM(10)+FIELD$
8945 X$="FM0"+%C$,STRT_POS=16,FIELD_LEN=35,FIELD_DESC$=MSG("LOC_CODE")
8950 GOSUB FIND_RECORD
8955 GOTO DONE
8960 ! 
9000 DONE:! 9000,5 - Done
9005 IF XX THEN CLOSE (XX)
9010 EXIT 
9999 END 
10000 ! ^10000,5 - Format/Validate Customer field
10005 AR_CUST_VAL: VAL$="Y"; ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=AR_CUST; GOTO AR_CUST
10010 AR_CUST_FMT: VAL$="N"; ENTER FIELD$,VAR_TAG$,*,*,*,ID$,BT_STOCK,ERR=AR_CUST ! SSP 221450
10015 AR_CUST:
10020 GOSUB CHECK_VAR_TAG; VAR$="%cust_name"; GOSUB INIT_DESC
10025 IF NUL(FIELD$) THEN NO_MSG=1,X$="AR1"+%C$; GOSUB CHECK_DIVISION; GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"A/R",10,ERR=INVALID_CODE) ! SSP 221450
10030 THE_KEY$=FIELD$,X$="AR1"+%C$; GOSUB CHECK_DIVISION; IF %AR_DIV_LEN<>0 AND %AR_DIV_LEN=LEN(FIELD$) THEN GOTO DONE ! SSP 221450
10035 X$="AR1"+%C$,STRT_POS=11,FIELD_LEN=35,FIELD_DESC$=MSG("CUST_CODE")
10040 GOSUB FIND_RECORD
10042 GOSUB VALIDATE_REP; IF NOT(VAL_REP) THEN ERR_MSG$=MSG("SEC_CUST"); FIELD$=""
10045 GOTO DONE
10050 RETURN 
10055 ! 
10100 ! ^100,5 - Split Customer Code into division and customer
10105 PARSE_CUST:
10110 ENTER CUSTOMER$,CUST_DIV$,CUST_CODE$
10115 IF LEN(CUSTOMER$) THEN {
10120 LOCAL TC$
10125 TC$=FN_INPUT_TO_FIELD$(CUSTOMER$,"A/R",10)
10130 CUST_DIV$=MID(TC$,1,2),CUST_CODE$=MID(TC$,3); %CUST_DIV$=CUST_DIV$,%CUST_CODE$=CUST_CODE$
10135  } ELSE {
10140 CUST_DIV$="",CUST_CODE$="",%CUST_DIV$="",%CUST_CODE$=""
10145  }
10150 EXIT 
10155 ! 
10500 ! ^10500,5 - Format/Validate Order field
10505 ORDER_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=ORDER; GOTO ORDER
10510 ORDER_FMT:ENTER FIELD$,VAR_TAG$,*,*,*,ID$,ERR=ORDER; GOTO ORDER ! SSP 221450
10515 ORDER:
10520 VAR_TAG$="",VAR$="" ! no desc to returnSTRT_POS=11,FIELD_LEN=35
10525 IF NUL(FIELD$) THEN NO_MSG=1,X$="FS1"+%C$; GOSUB CHECK_DIVISION; GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"O/P",8,ERR=INVALID_CODE) ! SSP 221450
10530 THE_KEY$=FIELD$,X$="FS1"+%C$; GOSUB CHECK_DIVISION ! SSP 221450
10535 X$="FS1"+%C$,FIELD_DESC$=MSG("ORDER_NUM") ! no desc to return, STRT_POS=11,FIELD_LEN=35
10540 GOSUB FIND_RECORD
10542 REM GOSUB VALIDATE_REP_FS1; IF NOT(VAL_REP) THEN ERR_MSG$=MSG("SEC_CUST")
10545 GOTO DONE
10550 RETURN 
10555 ! 
10600 ! ^100,5 - Split Order into division and customer
10605 PARSE_ORD:
10610 ENTER ORDER$,ORDER_DIV$,ORDER_NUM$
10615 IF LEN(ORDER$) THEN {
10620 LOCAL TO$
10625 TO$=FN_INPUT_TO_FIELD$(ORDER$,"O/P",8)
10630 ORDER_DIV$=MID(TO$,1,2),ORDER_NUM$=MID(TO$,3),%ORDER_NUM$=ORDER_NUM$,%ORDER_DIV$=ORDER_DIV$
10635  } ELSE {
10640 ORDER_DIV$="",ORDER_NUM$="",%ORDER_DIV$="",%ORDER_NUM$=""
10645  }
10650 EXIT 
10655 ! 
11000 ! ^11000,5 - Format/Validate Quote field
11005 QUOTE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=QUOTE; GOTO QUOTE
11010 QUOTE_FMT:ENTER FIELD$,VAR_TAG$,ERR=QUOTE; GOTO QUOTE
11015 QUOTE:
11020 GOSUB CHECK_VAR_TAG; VAR$=""; GOSUB INIT_DESC ! No desc field
11025 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"O/P",8,ERR=INVALID_CODE)
11030 THE_KEY$=FIELD$
11035 IF %USE_FE5 THEN X$="FE5"+%C$ ELSE X$="QSA"+%C$
11040 STRT_POS=0,FIELD_LEN=0,FIELD_DESC$=MSG("QUOTE_NUM")
11045 GOSUB FIND_RECORD
11050 GOTO DONE
11055 RETURN 
11060 ! 
11065 RETURN 
11070 ! 
11100 ! ^100,5 - Split Quote into division and customer
11105 PARSE_QUOTE:
11110 ENTER QUOTE$,QUOTE_DIV$,QUOTE_NUM$
11115 IF LEN(QUOTE$) THEN {
11120 LOCAL TQ$
11125 TQ$=FN_INPUT_TO_FIELD$(QUOTE$,"O/P",8)
11130 QUOTE_DIV$=MID(TQ$,1,2),QUOTE_NUM$=MID(TQ$,3),%QUOTE_DIV$=QUOTE_DIV$,%QUOTE_NUM$=QUOTE_NUM$
11135  } ELSE {
11140 QUOTE_DIV$="",QUOTE_NUM$="",%QUOTE_DIV$="",%QUOTE_NUM$=""
11145  }
11150 EXIT 
11155 ! 
11500 ! ^11500,5 - Format/Validate Vendor field
11505 VEND_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=VEND_CODE; GOTO VEND_CODE
11510 VEND_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=VEND_CODE; GOTO VEND_CODE
11515 VEND_CODE:
11520 GOSUB CHECK_VAR_TAG; VAR$="%vend_name"; GOSUB INIT_DESC
11525 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"A/P",10,ERR=INVALID_CODE)
11530 THE_KEY$=FIELD$
11535 X$="AP4"+%C$,STRT_POS=11,FIELD_LEN=35,FIELD_DESC$=MSG("VEND_CODE")
11540 GOSUB FIND_RECORD
11545 GOTO DONE
11550 RETURN 
11555 ! 
11600 ! ^100,5 - Split Vendor Code into division and vendor
11605 PARSE_VEND:
11610 ENTER VENDOR$,VEND_DIV$,VEND_CODE$
11615 IF LEN(VENDOR$) THEN {
11620 LOCAL TV$
11625 TV$=FN_INPUT_TO_FIELD$(VENDOR$,"A/P",10)
11630 VEND_DIV$=MID(TV$,1,2),VEND_CODE$=MID(TV$,3),%VEND_DIV$=VEND_DIV$,%VEND_CODE$=VEND_CODE$
11635  } ELSE {
11640 VEND_DIV$="",VEND_CODE$="",%VEND_DIV$="",%VEND_CODE$=""
11645  }
11650 EXIT 
11655 ! 
11700 ! Split A/R Invoice into its component fields
11705 PARSE_AR_INVOICE:
11710 ENTER AR_INVOICE$,AR_INV_1$,AR_INV_2$
11715 IF LEN(AR_INVOICE$) THEN {
11720 LOCAL TV$
11725 TV$=FN_INPUT_TO_FIELD$(AR_INVOICE$,"AR6",8)
11730 AR_INV_1$=MID(TV$,1,7),AR_INV_2$=MID(TV$,8)
11735  } ELSE {
11740 AR_INV_1$="",AR_INV_2$=""
11745  }
11750 EXIT 
11755 ! 
12000 ! ^12000,5 - Format/Validate Purchase Order field
12005 PORDER_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=PORDER; GOTO PORDER
12010 PORDER_FMT:ENTER FIELD$,VAR_TAG$,*,*,*,ID$,ERR=PORDER; GOTO PORDER ! SSP 221450
12015 PORDER:
12017 IF STP(%SALES_ORDER_PREFIX$)>"" AND %OE_GRID THEN GOTO DONE ! SSP208671 allow enter new p.o. from oe grid
12020 GOSUB CHECK_VAR_TAG; VAR$=""; GOSUB INIT_DESC ! No desc field
12022 THE_KEY$=FIELD$,X$="PO1"+%C$; GOSUB CHECK_DIVISION ! SSP 221450
12023 IF STP(FIELD$,1)=SUB(FN%ZZDISP$(%SALES_ORDER_PREFIX$,"O/P"),"-","") THEN GOTO DONE ! SPECIAL CASE TO EXIT THE PANEL
12024 ! IF NOT(NUL(FIELD$)) AND NOT(NUL(%SALES_ORDER_PREFIX$)) THEN IF MID(FIELD$,1,LEN(SOP$))<>SOP$ THEN MSGBOX MSG("ZZWLKU_01",FN%ZZDISP$(%SALES_ORDER_PREFIX$,"O/P")),MSG("MB_ATTN"),"!"; FIELD$=%SALES_ORDER_PREFIX$; GOTO DONE
12025 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P/O",9,ERR=INVALID_CODE)
12028 IF NOT(NUL(FIELD$)) AND NOT(NUL(%SALES_ORDER_PREFIX$)) THEN IF MID(FIELD$,1,LEN(%SALES_ORDER_PREFIX$))<>%SALES_ORDER_PREFIX$ THEN MSGBOX MSG("ZZWLKU_01",FN%ZZDISP$(%SALES_ORDER_PREFIX$,"O/P")),MSG("MB_ATTN"),"!"; FIELD$=SUB(FN%ZZDISP$(%SALES_ORDER_PREFIX$,"O/P"),"-",""); GOTO DONE
12030 THE_KEY$=FIELD$,X$="PO1"+%C$; GOSUB CHECK_DIVISION ! SSP 221450
12035 X$="PO1"+%C$,FIELD_DESC$=MSG("PO_NUM"),STRT_POS=0,FIELD_LEN=0
12040 GOSUB FIND_RECORD
12045 GOTO DONE
12050 RETURN 
12055 ! 
12100 ! ^100,5 - Split PO into division and number
12105 PARSE_PORDER:
12110 ENTER PORDER$,PO_DIV$,PO_NUM$
12115 IF LEN(PORDER$) THEN {
12120 LOCAL TP$
12125 TP$=FN_INPUT_TO_FIELD$(PORDER$,"P/O",9)
12130 PO_DIV$=MID(TP$,1,2),PO_NUM$=MID(TP$,3),%PO_DIV$=PO_DIV$,%PO_NUM$=PO_NUM$
12135  } ELSE {
12140 PO_DIV$="",PO_NUM$="" ! %PO_DIV$="",%PO_NUM$="" ! 233966
12145  }
12150 EXIT 
12155 ! 
12500 ! ^12500,5 - format/validate Finder's fee field
12505 FIND_FEE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=FIND_FEE; GOTO FIND_FEE
12510 FIND_FEE_FMT:ENTER FIELD$,VAR_TAG$,ERR=FIND_FEE; GOTO FIND_FEE
12515 FIND_FEE:
12520 GOSUB CHECK_VAR_TAG; VAR$="%find_fee_name"; GOSUB INIT_DESC
12525 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"A/P",10,ERR=INVALID_CODE)
12530 THE_KEY$=FIELD$
12535 X$="AP4"+%C$,STRT_POS=11,FIELD_LEN=35,FIELD_DESC$=MSG("FIND_FEEC")
12540 GOSUB FIND_RECORD
12545 GOTO DONE
12550 RETURN 
12555 ! 
12560 ! !^100,5 - FORM ITEM codes
12565 ITEM_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
12570 ITEM_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT
12572 FIELD$=PAD(FIELD$,10," ")
12573 IF %STOCK$="N" THEN GOTO 2415
12575 GOSUB CHECK_VAR_TAG; VAR$="%Item_desc"; GOSUB INIT_DESC
12580 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"I",%ITEM_CODE_LEN,ERR=INVALID_CODE)
12582 FIELD$=PAD(FIELD$,10," ")
12585 THE_KEY$=PAD(%CUST_DIV$+%CUST_CODE$,10,1)+FIELD$; IF %CUST_DIV$+%CUST_CODE$="" THEN THE_KEY$=PAD(%CUSTOMER$,10,1)+FIELD$
12590 X$="IC0"+%C$,STRT_POS=21,FIELD_LEN=40,FIELD_DESC$=MSG("ITEM_DESC"),REFRESH_FLG=1
12595 GOSUB FIND_RECORD
12600 GOTO DONE
12605 RETURN 
12610 ! 
12700 ! ^100,5 - TF Client code
12705 CLIENT_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
12710 CLIENT_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT
12715 GOSUB CHECK_VAR_TAG; VAR$="%client_name"; GOSUB INIT_DESC
12720 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
12725 THE_KEY$=DIM(5,"0")+FIELD$+"00"
12730 X$="SS1",STRT_POS=11,FIELD_LEN=35,FIELD_DESC$=MSG("CLIENTNAME"),REFRESH_FLG=1
12735 GOSUB FIND_RECORD
12740 GOTO DONE
12745 RETURN 
12750 ! 
13000 ! ^13000,5 - Format/Validate Repeat Order field
13005 REPEAT_ORDER_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=REPEAT_ORDER; GOTO REPEAT_ORDER
13010 REPEAT_ORDER_FMT:ENTER FIELD$,VAR_TAG$,ERR=REPEAT_ORDER; GOTO REPEAT_ORDER
13015 REPEAT_ORDER:
13020 VAR_TAG$="",VAR$="" ! no desc to returnSTRT_POS=11,FIELD_LEN=35
13025 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"O/P",8,ERR=INVALID_CODE)
13030 THE_KEY$=FIELD$
13035 X$="FT3"+%C$,FIELD_DESC$=MSG("REPEAT_ORD") ! no desc to return, STRT_POS=11,FIELD_LEN=35
13040 GOSUB FIND_RECORD
13045 GOTO DONE
13100 ! ^100,5 - Freight Markup Code
13105 FREIGHT_MARKUP_FMT:ENTER FIELD$,VAR_TAG$,ERR=FREIGHT_MARKUP
13110 FREIGHT_MARKUP_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
13115 FREIGHT_MARKUP:
13120 GOSUB CHECK_VAR_TAG; VAR$="%FREIGHT_MARKUP_DESC"; GOSUB INIT_DESC
13125 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",2,ERR=INVALID_CODE)
13130 THE_KEY$="M"+FIELD$
13135 X$="FMP"+%C$,STRT_POS=4,FIELD_LEN=30,FIELD_DESC$=MSG("FRT_MU_TBL")
13140 GOSUB FIND_RECORD
13145 GOTO DONE
13150 ! 
13200 ! ^100,5 - TopForm Operator Code
13205 OP_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=OP_CODE
13210 OP_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
13215 OP_CODE:
13220 GOSUB CHECK_VAR_TAG; VAR$="%OP_CODE_NAME"; GOSUB INIT_DESC
13225 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",3,ERR=INVALID_CODE)
13230 THE_KEY$="o"+FIELD$
13235 X$="ZZPARM",STRT_POS=5,FIELD_LEN=30,FIELD_DESC$=MSG("NAME")
13240 GOSUB FIND_RECORD
13245 GOSUB DONE
13250 ! 
13300 ! ^100,5 - Division Code
13305 DIVISION_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=DIVISION_CODE
13310 DIVISION_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=DIVISION_CODE
13315 DIVISION_CODE:
13320 GOSUB CHECK_VAR_TAG; VAR$="%division_desc"; GOSUB INIT_DESC
13325 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=PAD(FIELD$,2)
13330 THE_KEY$=FIELD$
13335 X$="ARH"+%C$,STRT_POS=3,FIELD_LEN=40,FIELD_DESC$=MSG("DIVISION")
13340 GOSUB FIND_RECORD
13345 GOTO DONE
13350 RETURN 
13400 ! ^100,5 - EC System - Color Scheme
13405 COLOR_SCHEME_FMT:ENTER FIELD$,VAR_TAG$,ERR=COLOR_SCHEME; GOTO COLOR_SCHEME
13410 COLOR_SCHEME_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
13415 COLOR_SCHEME:
13420 GOSUB CHECK_VAR_TAG; VAR$="%color_scheme_desc"; GOSUB INIT_DESC
13425 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",6,ERR=INVALID_CODE)
13430 THE_KEY$=FIELD$
13435 X$="EE2"+%C$,STRT_POS=7,FIELD_LEN=35,FIELD_DESC$=MSG("COLOR_SCME")
13440 GOSUB FIND_RECORD
13445 GOTO DONE
13450 RETURN 
13455 ! 
14000 CHECK_DIVISION:
14010 C$=FIELD$
14020 IF %X3$(333,2)="  " THEN GOTO END_DIVISION ! SSP 221450
14031 _ZZS=FN%FFN("ZZS"+%C$); IF _ZZS<0 THEN VVAR$="" ELSE VVAR$=D$; GOSUB GET_FIRST_REC; IF STP(FIELD$)="" THEN FIELD$=_VVAR$,C$=FIELD$,%CUST_YES=1 ! SSP 221450
14035 IF FIELD$=DIM(10) THEN RETURN 
14040 IF MID(X$,1,3)="AR1" THEN CALL "ZZWLKU;PARSE_CUST",C$,D$,N$ ELSE IF MID(X$,1,3)="PO1" THEN CALL "ZZWLKU;PARSE_PORDER",C$,D$,N$ ELSE IF MID(X$,1,3)="FS1" THEN CALL "ZZWLKU;PARSE_ORD",C$,D$,N$ ! SSP 221450
14045 IF NUL(D$+N$) THEN EXIT ! SSP 221450 ! SSP 221450
14050 ! IF D$<>%X3$(333,2) THEN _SOUND_NAME$="no06.wav",FIELD$=%X3$(333,2); PERFORM "$CTL-10;Sound_Play"; IF VAL$="N" THEN MSGBOX "Division Access denied"+SEP+SEP+"You are only authorized for division "+%X3$(333,2),MSG("WARNING"),"Stop,tim=20"; VAR_TAG$="NODIVISION" ELSE ERR_MSG$="Division Access denied"+SEP+SEP+"You are only authorize for division "+%X3$(333,2)
14055 IF D$<>%X3$(333,2) THEN _SOUND_NAME$="no06.wav",FIELD$=VVAR$; VAR_TAG$="Division Access denied"+SEP+SEP+"You are only authorized for division "+%X3$(333,2); ERR_MSG$="Division Access denied"+SEP+SEP+"You are only authorize for division "+%X3$(333,2) ! SSP 221450
14100 END_DIVISION:
14120 IF %X3$(333,2)<>"  " AND D$<>%X3$(333,2) THEN EXIT 
14125 VVAR$="",_VVAR$=""
14130 RETURN 
14140 GET_FIRST_REC:! SSSP 221450 to 14199
14150 _AR1=HFN; OPEN (_AR1)X$
14160 READ (_AR1,KEY=%X3$(333,2),DOM=*NEXT)
14170 _KAR1$=KEY(_AR1,END=NO_FIRST)
14180 IF _KAR1$(1,2)<>%X3$(333,2) THEN GOTO NO_FIRST
14190 _VVAR$=_KAR1$; IF MID(FIELD$,1,2)<>%X3$(333,2) THEN FIELD$=""
14195 GET_LAST_REC:IF MID(X$,1,3)="AR1" THEN MX$=DIM(8,"~") ELSE IF MID(X$,1,3)="PO1" THEN MX$=DIM(7,"~") ELSE IF MID(X$,1,3)="FS1" THEN MX$=DIM(6,"~")
14196 READ (_AR1,KEY=%X3$(333,2)+MX$,DOM=*NEXT)
14198 _KKAR1$=KEP(_AR1,END=NO_FIRST); IF _KKAR1$(1,2)<>%X3$(333,2) THEN GOTO NO_FIRST
14199 IF POS("START"=ID$)<>0 THEN _VVAR$=_KAR1$ ELSE _VVAR$=_KKAR1$
14202 IF %MODULE$="I/C" AND BT_STOCK=1 THEN _VVAR$=C$
14300 NO_FIRST:CLOSE (_AR1); RETURN 
14500 ! 14500,10
14510 EC_WORKSHEET_FMT:ENTER FIELD$,VAR_TAG$,ERR=EC_WORKSHEET
14520 EC_WORKSHEET_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
14530 EC_WORKSHEET:
14540 GOSUB CHECK_VAR_TAG; VAR$="%ec_worksheet_desc"; GOSUB INIT_DESC
14550 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",10,ERR=INVALID_CODE)
14560 THE_KEY$=FIELD$
14570 X$="ECD"+%C$,STRT_POS=11,FIELD_LEN=15,FIELD_DESC$=MSG("WORK_N")
14580 GOSUB FIND_RECORD
14590 GOTO DONE
14600 RETURN 
15000 ! 15000,10
15010 REPOSITORY_FMT:ENTER FIELD$,VAR_TAG$,ERR=REPOSITORY_CODE
15020 REPOSITORY_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
15030 REPOSITORY_CODE:
15040 GOSUB CHECK_VAR_TAG; VAR$="%repository_desc"; GOSUB INIT_DESC
15050 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",10,ERR=INVALID_CODE)
15060 THE_KEY$=FIELD$
15070 X$="ZR0"+%C$,STRT_POS=11,FIELD_LEN=30,FIELD_DESC$=MSG("REPOS_C")
15080 GOSUB FIND_RECORD
15090 GOTO DONE
15100 RETURN 
15200 ! 15200,10
15210 FOREIGN_FMT:ENTER FIELD$,VAR_TAG$,ERR=FOREIGN_CODE
15220 FOREIGN_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
15230 FOREIGN_CODE:
15240 GOSUB CHECK_VAR_TAG; VAR$="%FOREIGN_DESC"; GOSUB INIT_DESC
15250 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
15260 THE_KEY$=FIELD$
15270 X$="ASN"+%C$,STRT_POS=4,FIELD_LEN=35,FIELD_DESC$=MSG("FORE_INV")
15280 GOSUB FIND_RECORD
15290 GOTO DONE
15300 RETURN 
15500 ! 15500,10- SSP 192205
15510 UNITED_ACCT_FMT:ENTER FIELD$,VAR_TAG$,ERR=UNITED_ACCT_CODE
15520 UNITED_ACCT_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
15530 UNITED_ACCT_CODE:
15540 GOSUB CHECK_VAR_TAG; VAR$="%UNITED_ACCT_DESC"; GOSUB INIT_DESC
15550 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",6,ERR=INVALID_CODE)
15560 THE_KEY$=FIELD$
15570 X$="OSA"+%C$,STRT_POS=7,FIELD_LEN=30,FIELD_DESC$=MSG("UNI_ACCT")
15580 GOSUB FIND_RECORD
15590 GOTO DONE
15600 RETURN 
16000 ! 16000,10 - Item price class
16010 ! % ITEM_PRICE_CLASS_name will be set from FM0
16020 ITEM_PRICE_CLASS_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=ITEM_PRICE_CLASS
16030 ITEM_PRICE_CLASS_FMT:ENTER FIELD$,VAR_TAG$,ERR=ITEM_PRICE_CLASS; GOTO ITEM_PRICE_CLASS
16040 ITEM_PRICE_CLASS:
16050 GOSUB CHECK_VAR_TAG; VAR$="%ITEM_PRICE_CLASS_name"; GOSUB INIT_DESC
16060 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
16070 THE_KEY$="I"+FIELD$
16080 X$="FMP"+%C$,STRT_POS=5,FIELD_LEN=30,FIELD_DESC$=MSG("ITEM_P_C")
16090 GOSUB FIND_RECORD
16100 GOTO DONE
16200 ! 16200,10 - Employee CODE ! SSP 201498
16210 ! 
16220 EMP_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=EMP_CODE
16230 EMP_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=EMP_CODE; GOTO EMP_CODE
16240 EMP_CODE:
16250 GOSUB CHECK_VAR_TAG; VAR$="%EMP_name"; GOSUB INIT_DESC
16260 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",7,ERR=INVALID_CODE)
16270 THE_KEY$=FIELD$
16280 X$="ASZ"+%C$,STRT_POS=8,FIELD_LEN=35,FIELD_DESC$=MSG("EMPL_C")
16290 GOSUB FIND_RECORD
16300 GOTO DONE
16400 ! 16400,10 - REASON CODE SSP 201498
16410 ! 
16420 REASON_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=REASON_CODE
16430 REASON_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=REASON_CODE; GOTO REASON_CODE
16440 REASON_CODE:
16450 GOSUB CHECK_VAR_TAG; VAR$="%REASON_name"; GOSUB INIT_DESC
16460 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",3,ERR=INVALID_CODE)
16470 THE_KEY$=FIELD$
16480 X$="ASY"+%C$,STRT_POS=4,FIELD_LEN=35,FIELD_DESC$=MSG("REAS_C")
16490 GOSUB FIND_RECORD
16500 GOTO DONE
20000 VALIDATE_REP:
20005 VAL_REP=0 ! RETURN 
20006 IF %DR_SYO$="" THEN VAL_REP=1; RETURN 
20010 VAL_REP=0,CUST$=PAD(TF_DESC$,600)
20020 IF CUST$(278,4)<>DIM(4) THEN CALL "UPDSYO;VAL_REP",ERR=*NEXT,%X3$,CUST$(278,4),OK; IF OK THEN VAL_REP=1; GOTO *RETURN
20030 IF CUST$(282,4)<>DIM(4) THEN CALL "UPDSYO;VAL_REP",ERR=*NEXT,%X3$,CUST$(282,4),OK; IF OK THEN VAL_REP=1; GOTO *RETURN
20040 IF CUST$(286,4)<>DIM(4) THEN CALL "UPDSYO;VAL_REP",ERR=*NEXT,%X3$,CUST$(286,4),OK; IF OK THEN VAL_REP=1; GOTO *RETURN
20050 IF CUST$(290,4)<>DIM(4) THEN CALL "UPDSYO;VAL_REP",ERR=*NEXT,%X3$,CUST$(290,4),OK; IF OK THEN VAL_REP=1; GOTO *RETURN
20060 IF CUST$(294,4)<>DIM(4) THEN CALL "UPDSYO;VAL_REP",ERR=*NEXT,%X3$,CUST$(294,4),OK; IF OK THEN VAL_REP=1; GOTO *RETURN
20090 RETURN 
20098 ! 
20099 ! 
20100 VALIDATE_REP_FS1:
20110 VAL_REP=0,CUST$=PAD(TF_DESC$,350)
20120 IF CUST$(93,4)<>DIM(4) THEN CALL "UPDSYO;VAL_REP",ERR=*NEXT,%X3$,CUST$(93,4),OK; IF OK THEN VAL_REP=1; GOTO *RETURN
20130 IF CUST$(102,4)<>DIM(4) THEN CALL "UPDSYO;VAL_REP",ERR=*NEXT,%X3$,CUST$(102,4),OK; IF OK THEN VAL_REP=1; GOTO *RETURN
20140 IF CUST$(106,4)<>DIM(4) THEN CALL "UPDSYO;VAL_REP",ERR=*NEXT,%X3$,CUST$(106,4),OK; IF OK THEN VAL_REP=1; GOTO *RETURN
20150 IF CUST$(110,4)<>DIM(4) THEN CALL "UPDSYO;VAL_REP",ERR=*NEXT,%X3$,CUST$(110,4),OK; IF OK THEN VAL_REP=1; GOTO *RETURN
20160 IF CUST$(114,4)<>DIM(4) THEN CALL "UPDSYO;VAL_REP",ERR=*NEXT,%X3$,CUST$(114,4),OK; IF OK THEN VAL_REP=1; GOTO *RETURN
20190 RETURN 
20198 ! 
20199 ! 
21000 ! ^100,10 - Scale Shipvia to TopForm Shivia Map
21010 SHIPVIA_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT; GOTO SHIPVIA
21020 SHIPVIA_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
21030 SHIPVIA:
21040 GOSUB CHECK_VAR_TAG; VAR$="%SHIPVIA_DESC"; GOSUB INIT_DESC
21050 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"P",6,ERR=INVALID_CODE) ! SSP250525 jdf
21060 THE_KEY$=FIELD$
21070 X$="SH1"+%C$,STRT_POS=8,FIELD_LEN=12,FIELD_DESC$=MSG("CARRIER_ID")
21080 GOSUB FIND_RECORD
21090 GOTO DONE
21100 RETURN 
21200 ! 21200,10- Application MasterFile
21210 APP_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=APP_CODE
21220 APP_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
21230 APP_CODE:
21240 GOSUB CHECK_VAR_TAG; VAR$="%app_desc"; GOSUB INIT_DESC
21250 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",2,ERR=INVALID_CODE)
21260 THE_KEY$=FIELD$
21270 X$="ZX0",STRT_POS=3,FIELD_LEN=30,FIELD_DESC$=MSG("APP_CODE")
21280 GOSUB FIND_RECORD
21290 GOTO DONE
21300 RETURN 
21500 ! 21500,10- Action Code
21510 ACT_CODE_FMT:ENTER FIELD$,VAR_TAG$,ERR=ACT_CODE
21520 ACT_CODE_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
21530 ACT_CODE:
21540 GOSUB CHECK_VAR_TAG; VAR$="%ACT_DESC"; GOSUB INIT_DESC
21550 IF NUL(FIELD$) THEN GOTO DONE ELSE FIELD$=FN_INPUT_TO_FIELD$(FIELD$,"Z",1,ERR=INVALID_CODE)
21560 THE_KEY$=FIELD$
21570 X$="QS4"+%C$,STRT_POS=2,FIELD_LEN=30,FIELD_DESC$=MSG("NEXT_A")
21580 GOSUB FIND_RECORD
21590 GOTO DONE
21600 RETURN 
21605 ! Validate G/L Fiscal Year
21608 GL_FISCALYEAR_FMT:ENTER FIELD$,VAR_TAG$,ERR=*NEXT; GOTO GL_FISCALYEAR
21610 GL_FISCALYEAR_VAL:ENTER FIELD$,ERR_MSG$,VAR_TAG$,ERR=*NEXT
21615 GL_FISCALYEAR:
21618 IF NUL(FIELD$) THEN GOTO DONE
21620 THE_KEY$=%X3$(9,3)+"G/LYE"+FIELD$
21625 X$="ZZPARM",STRT_POS=9,FIELD_LEN=4,FIELD_DESC$=MSG("FY")
21630 GOSUB FIND_RECORD
21635 IF POS(MID(TF_DESC$,99,1)="CR")<>0 THEN ERR_MSG$=MSG("CLOSED_FY")
21645 GOTO DONE
21648 RETURN 
21649 ! 
21700 SKIP_DIV_CHECK_FLDS:
21705 ENTER FLDLIST$
21720 %WINQRY_DIV_SKIP_FLDS$=FLDLIST$
21745 EXIT 
21749 ! 
21750 SKIP_DIV_CHECK_FLDS_END:
21755 ENTER 
21770 %WINQRY_DIV_SKIP_FLDS$=""
21795 EXIT 
21799 ! 
56000 ! "191739-Issues w/ Foreign Exchange Rate in GUI                      
56001 ! "192205 Some fields are missing in the customer setup/inquiry
56002 ! "       pgm ARGMAB
56010 ! "182373-GUI-Pricing Tables do not appear to work at all in GUI      
56012 REM "192978-Put 191822 w/o in GUI order Entry                           
56015 REM "190074-SSP184884; Color Scheme field added, new file EE2, can set
56016 ! "197262-Freight Tracking Entry - ECGMUA - Carrier ID name, the query
56017 ! "200161-Program QS2MAA is missing in qatst qui RFQ.                 
56020 ! "201498-Credit Memo Reason codes in TopForm                         
56021 REM "200525-Ability to have storage cost and finance costs for inventory   
56025 REM "205471-Oracle - FFN usage in tf2g progs. to be replaced by FN%FFN  
56027 REM "211380-TopForm file feldnames which are SQL keywords break Oracle. 
56030 REM "215237-Ability to use multiple Net1 merchant accounts in DemandBdge
56032 REM "218234-RFGMAT-Bin Type-Cleanup Panel                               
56033 ! "221450-if you restrict operator to a division you cannot exit out  
56034 REM "223557-Modify Data Replication with the ability to designate ranges
56035 ! "192978-Put 191822 w/o in GUI order Entry                           
56036 REM "230413-Action Codes in T/M are being corrupted                     
56037 REM "233966-Restricting oper to div interfering with PO Header panel
56038 REM "236559-ARGMKA-Commission chargeback-allows entry of an invalid year
56039 REM "237258-Image Library : Add ability to search for images in GUI.    
56040 REM "241256-Incorrect validation msg: CREDIT_CARD_TYPE:  Not Found      
56042 REM "245230-WO243848 - panel issues with SMGMFB need to be corrected    
56044 REM "250525-Freight tracking entry is not working in GUI.  The carrier  
56046 REM "249775-Changes to sales tax parameters; prod code set validation   
56048 REM "274240-268441; WMS Zone is 4 char field, RFZ file, needs to be zero
56049 REM "307210-International shipping address - add country code           
