0010 ! ECGAR1 - WebEC Customer Parameters seetup
0020 ! Generated by ProvideX® NOMADS II File Maintenance on May. 15, 2003 10:00
0035 REM "5.7 - 07/31/13 - 13.568333 - dmm - SSP# 263687
0037 REM "263687-Error generating DB/e orders. (016-EC3SOR-6720) **ECW full**
0040 REM "Copyright 2013 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 PROCESS "ECGAR1","../ECG/EC.EN"
0060 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0$="EC3AR1",X1$="EC Customer Parameters"
0140 ! 
0150 X0=-1,X2=-1
0160 CALL "ZZCOMP",X0$,X11$,X2$,X3$,X4$,X5$,X0,X1,X2; IF X1>0 THEN CMD_STR$="END"; EXIT 
0170 ! 
0190 DIM Z[NUM(X3$(60,3))]
0200 ! Files
0210 Z$="01O ECS...  02O AR1...  03O AR2...  06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0
0300 ! IOList Section
0310 IOLIST ECS$
0320 IOLIST GL1$
0400 ! System Parameters
0410 GOSUB GET_SYS_PARAM
0430 CALL "*wingrp;disable",FIELDS.GRP$; ENABLE_FLG=0
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0520 IF ARG_1$<>"" THEN CUSTOMER$=ARG_1$,CUSTOMER.CTL'VALUE$=CUSTOMER$; MULTI_LINE LOCK CUSTOMER.CTL; GOTO FIND_REC
0550 ! 
0790 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
1000 ! READ RECORD
1010 FIND_REC:
1015 IF NUL(CUSTOMER$) THEN RETURN 
1020 KEY_1$=CUSTOMER$
1025 IF STP(QRY_VAL$,3,"-")=CUSTOMER$ THEN LL+=1; IF LL=2 THEN LL=0; RETURN ! SSP#242146
1030 FIND (Z[1],KEY=KEY_1$,DOM=TERM_MSG)IOL=0310
1040 ! 
1050 GOSUB LOAD_INFO; GOSUB READ_AR1
1060 CALL "*wingrp;Enable",BUTTONS.GRP$; CALL "*wingrp;Enable",FIELDS.GRP$; ENABLE_FLG=1
1070 B_ECS$=ECS$
1185 REFRESH_FLG=1
1190 RETURN 
1500 ! Write Record
1510 WRITE_REC:
1540 WRITE (Z[1],KEY=KEY_1$)IOL=0310
1550 ! MSGBOX "Record Updated!","FYI","!"
1560 GOSUB CLEAR_REC
1570 IF ARG_1$<>"" THEN CMD_STR$="E"
1575 IF B_ECS$(172,60)<>ECS$(172,60) AND ECPARM$(1183,1)<>"Y" THEN MSGBOX "Do you wish to run the order Sort Rebuild",MSG("CONFIRMING"),"?,YESNO",OPT$; IF OPT$="YES" THEN TMP$=ECS$(1,10),SAVE_GUI=%GUI,%GUI=1; CALL "EC3UT8",%X3$,%X4$,"",TMP$; %GUI=SAVE_GUI ! SSP254578, need %GUI set even if coming from CHUI menu option, save off then reset when done. SSP263687, don't ask for sort rebuild if sys parm set to bypass.
1580 B_ECS$=ECS$
1590 RETURN 
2000 ! Load Information
2010 LOAD_INFO:
2013 IF NUL(ECS$) THEN RETURN 
2015 CUSTOMER$=ECS$(1,10)
2020 CUST_LOGO_FILE_NAME$=ECS$(11,30); COMP_LOGO_FILE_NAME$=ECS$(354,30); CUST_IMAGE_PATH$=ECS$(112,60)
2030 CSR_EMAIL_FOR_BUYER$=ECS$(42,60); CSR_EMAIL_ACTIONS$=ECS$(102,10)
2040 SALESPR_EMAIL_4_BYR$=ECS$(384,60); SALESPR_EMAIL_ACTION$=ECS$(444,10) ! SSP#254128
2050 BUY_CONT_NAME$=ECS$(248,30); BUY_CONT_PHONE$=ECS$(234,14)
2060 BUY_CONT_FAX$=ECS$(278,14); BUY_CONT_EMAIL$=ECS$(454,60); NO_SHW_PRICE_FOR_BYR$=ECS$(41,1)
2065 CUST_USER_DEF_1$=ECS$(751,1),CUST_USER_DEF_2$=ECS$(752,1),CUST_USER_DEF_3$=ECS$(753,1),CUST_USER_DEF_4$=ECS$(754,1),CUST_USER_DEF_5$=ECS$(755,1),CUST_USER_DEF_6$=ECS$(756,1),CUST_USER_DEF_7$=ECS$(757,1),CUST_USER_DEF_8$=ECS$(758,1),CUST_USER_DEF_9$=ECS$(759,1),CUST_USER_DEF_10$=ECS$(760,1) ! WO249058
2070 ORD_STAT_SORT_CUST_1$=ECS$(172,10); ORD_STAT_SORT_CUST_2$=ECS$(182,10); ORD_STAT_SORT_CUST_3$=ECS$(192,10)
2075 ORD_APPR_WS_EMAIL$=ECS$(761,1) ! WO253784, Emails to worksheet email address?
2076 INV_SN_ALLOW_ZERO$=ECS$(765,1) ! WO264379, Invoice/Ship Notice: Allow zero quantity shipped lines?
2077 ALWAYS_SALES_ORDER$=ECS$(762,1) ! WO256739, Override order type to Sales Order?
2078 ORD_APPR_WS_EDIT$=ECS$(763,1) ! WO255476, Allow approvers to edit worksheets?
2079 SHIP_NOTICE_ALL_MATCHING$=ECS$(764,1) ! WO263088, Ship Notice: All SM4 matching order/invoice?
2080 ORD_STAT_SORT_LOC_1$=ECS$(202,10); ORD_STAT_SORT_LOC_2$=ECS$(212,10); ORD_STAT_SORT_LOC_3$=ECS$(222,10)
2090 WHSE_GRP$=ECS$(515,21); PUL_INVT_OPP_WHSE_OE$=ECS$(233,1)
2100 CATALOG_1$=ECS$(536,10); CATALOG_2$=ECS$(546,10); CATALOG_3$=ECS$(556,10); CATALOG_4$=ECS$(566,10); CATALOG_5$=ECS$(576,10)
2110 ALLOW_MAN_SHIP_TO$=ECS$(232,1); GEN_RON$=ECS$(292,1); DISPLAY_EC_PROMO$=ECS$(600,1)
2120 ACTV_ORD_MAX$=ECS$(586,1); ACTIVATE_SHIPTO$=ECS$(587,1); ACTIVATE_SINGLE_INST$=ECS$(588,1)
2130 ALT_TERMS$=ECS$(589,2); ACCUM_MAX_CHK$=ECS$(591,2); ACTV_ORD_APPR$=ECS$(593,1)
2140 ORD_APPR_VP$=ECS$(594,1); ORD_APPR_OM$=ECS$(595,1); REL_NON_APPR$=ECS$(596,1)
2150 SUPP_FMS_USE$=ECS$(598,1); SUPP_BUY_DEF$=ECS$(599,1); PREV_ONHOLD_ORD$=ECS$(597,1); ALWAYS_USE_FMS$=ECS$(601,1)
2170 B_ECS$=ECS$
2172 BUYER_EMAIL$=ECS$(608,1)
2173 ORD_APPR_OC_APRVR$=ECS$(748,1) ! WO244587, Send order confirmation to approver's buyer email address?
2174 ORD_APPR_BUDGET$=ECS$(749,1); OVER_BUDGET_CC$=ECS$(750,1) ! 242686
2175 FRT_MARKUP$=ECS$(609,2)
2176 ECP_TEMPLATE_BUYER$=ECS$(611,15),DISPLAY_SAGE$=ECS$(626,1)
2177 COLOR_SCHEME$=ECS$(602,6)
2178 BASE_PAGE_REF$=ECS$(627,60),CGI_COMMAND$=ECS$(687,60) ! SSP228104
2179 USE_LOT_SELL_PRICE$=ECS$(747,1) ! 227556
2180 REFRESH_FLG=1
2185 CALL "*wingrp;Enable",BUTTONS.GRP$; CALL "*wingrp;Enable",FIELDS.GRP$; ENABLE_FLG=1
2188 GOSUB READ_AR1
2190 RETURN 
2300 ! Load Slections
2310 LOAD_SELECTION:
2315 ECS$(1,10)=CUSTOMER$
2320 ECS$(11,30)=CUST_LOGO_FILE_NAME$; ECS$(354,30)=COMP_LOGO_FILE_NAME$; ECS$(112,60)=CUST_IMAGE_PATH$
2330 ECS$(42,60)=CSR_EMAIL_FOR_BUYER$; ECS$(102,10)=CSR_EMAIL_ACTIONS$
2340 ECS$(384,60)=SALESPR_EMAIL_4_BYR$; ECS$(444,10)=SALESPR_EMAIL_ACTION$ ! SSP#254128
2350 ECS$(248,30)=BUY_CONT_NAME$; ECS$(234,14)=BUY_CONT_PHONE$
2360 ECS$(278,14)=BUY_CONT_FAX$; ECS$(454,60)=BUY_CONT_EMAIL$; ECS$(41,1)=NO_SHW_PRICE_FOR_BYR$
2365 ECS$(751,1)=CUST_USER_DEF_1$,ECS$(752,1)=CUST_USER_DEF_2$,ECS$(753,1)=CUST_USER_DEF_3$,ECS$(754,1)=CUST_USER_DEF_4$,ECS$(755,1)=CUST_USER_DEF_5$,ECS$(756,1)=CUST_USER_DEF_6$,ECS$(757,1)=CUST_USER_DEF_7$,ECS$(758,1)=CUST_USER_DEF_8$,ECS$(759,1)=CUST_USER_DEF_9$,ECS$(760,1)=CUST_USER_DEF_10$ ! WO249058
2370 ECS$(172,10)=ORD_STAT_SORT_CUST_1$; ECS$(182,10)=ORD_STAT_SORT_CUST_2$; ECS$(192,10)=ORD_STAT_SORT_CUST_3$
2375 ECS$(761,1)=ORD_APPR_WS_EMAIL$ ! WO253784, Emails to worksheet email address?
2376 ECS$(765,1)=INV_SN_ALLOW_ZERO$ ! WO264379, Invoice/Ship Notice: Allow zero quantity shipped lines?
2377 ECS$(762,1)=ALWAYS_SALES_ORDER$ ! WO256739, Override order type to Sales Order?
2378 ECS$(763,1)=ORD_APPR_WS_EDIT$ ! WO255476, Allow approvers to edit worksheets?
2379 ECS$(764,1)=SHIP_NOTICE_ALL_MATCHING$ ! WO263088, Ship Notice: All SM4 matching order/invoice?
2380 ECS$(202,10)=ORD_STAT_SORT_LOC_1$; ECS$(212,10)=ORD_STAT_SORT_LOC_2$; ECS$(222,10)=ORD_STAT_SORT_LOC_3$
2390 ECS$(515,21)=WHSE_GRP$; ECS$(233,1)=PUL_INVT_OPP_WHSE_OE$
2400 ECS$(536,10)=CATALOG_1$; ECS$(546,10)=CATALOG_2$; ECS$(556,10)=CATALOG_3$; ECS$(566,10)=CATALOG_4$; ECS$(576,10)=CATALOG_5$
2410 ECS$(232,1)=ALLOW_MAN_SHIP_TO$; ECS$(292,1)=GEN_RON$; ECS$(600,1)=DISPLAY_EC_PROMO$
2420 ECS$(586,1)=ACTV_ORD_MAX$; ECS$(587,1)=ACTIVATE_SHIPTO$; ECS$(588,1)=ACTIVATE_SINGLE_INST$
2430 ECS$(589,2)=ALT_TERMS$; ECS$(591,2)=ACCUM_MAX_CHK$; ECS$(593,1)=ACTV_ORD_APPR$
2440 ECS$(594,1)=ORD_APPR_VP$; ECS$(595,1)=ORD_APPR_OM$; ECS$(596,1)=REL_NON_APPR$
2450 ECS$(598,1)=SUPP_FMS_USE$; ECS$(599,1)=SUPP_BUY_DEF$; ECS$(597,1)=PREV_ONHOLD_ORD$; ECS$(601,1)=ALWAYS_USE_FMS$
2460 ECS$(608,1)=BUYER_EMAIL$
2462 ECS$(748,1)=ORD_APPR_OC_APRVR$ ! WO244587, Send order confirmation to approver's buyer email address? 
2463 ECS$(749,1)=ORD_APPR_BUDGET$; ECS$(750,1)=OVER_BUDGET_CC$ ! 242686
2465 ECS$(609,2)=FRT_MARKUP$
2467 ECS$(611,15)=ECP_TEMPLATE_BUYER$,ECS$(626,1)=DISPLAY_SAGE$
2470 ECS$(602,6)=COLOR_SCHEME$
2472 ECS$(627,60)=BASE_PAGE_REF$,ECS$(687,60)=CGI_COMMAND$ ! SSP228104
2473 ECS$(747,1)=USE_LOT_SELL_PRICE$ ! 227556
2490 RETURN 
2500 ! Delete Record
2510 DELETE_REC:
2520 MSGBOX MSG("DELETE_REC"),MSG("CONFIRM"),"?,YesNo",ANS$
2530 IF ANS$="NO" THEN RETURN 
2540 REMOVE (Z[1],KEY=KEY_1$,DOM=*NEXT) ! SSP#242146
2550 ! MSGBOX "Record Deleted!","FYI","!"
2570 GOSUB CLEAR_REC
2580 IF ARG_1$<>"" THEN CMD_STR$="E"
2590 RETURN 
3000 ! First Record
3010 FIRST_REC:
3020 KEY_1$=KEF(Z[1],END=NO_FIRST)
3030 READ (Z[1],KEY=KEY_1$)IOL=0310
3040 GOSUB LOAD_INFO
3090 RETURN 
3200 ! Last Record
3210 LAST_REC:
3220 KEY_1$=KEL(Z[1],ERR=NO_LAST)
3230 READ (Z[1],KEY=KEY_1$)IOL=0310
3240 GOSUB LOAD_INFO
3290 RETURN 
3400 ! Prior Record
3410 PRIOR_REC:
3420 KEY_1$=KEP(Z[1],END=START_FILE)
3430 READ (Z[1],KEY=KEY_1$)IOL=0310
3440 GOSUB LOAD_INFO
3490 RETURN 
3600 ! Next Record
3610 NEXT_REC:
3620 KEY_1$=KEY(Z[1],END=END_FILE)
3630 READ (Z[1],KEY=KEY_1$)IOL=0310
3640 GOSUB LOAD_INFO
3690 RETURN 
5000 ! Check Changes
5010 CHECK_CHANGES:
5020 IF ECS$=B_ECS$ THEN RETURN 
5030 MSGBOX MSG("REC_ALTERD"),MSG("UPDATE"),"?,YesNo",ANS$
5040 IF ANS$="NO" THEN CMD_STR$="END"; EXIT 
5050 GOSUB WRITE_REC
5090 RETURN 
5500 ! CLEAR RECORD
5510 CLEAR_REC:
5515 CUSTOMER$=""
5520 CUST_LOGO_FILE_NAME$=""; COMP_LOGO_FILE_NAME$=""; CUST_IMAGE_PATH$=""
5530 CSR_EMAIL_FOR_BUYER$=""; CSR_EMAIL_ACTIONS$=""
5540 SALESPR_EMAIL_4_BYR$=""; SALESPR_EMAIL_ACTION$="" ! SSP#254128
5550 BUY_CONT_NAME$=""; BUY_CONT_PHONE$=""
5560 BUY_CONT_FAX$=""; BUY_CONT_EMAIL$=""; NO_SHW_PRICE_FOR_BYR$=""
5565 CUST_USER_DEF_1$="",CUST_USER_DEF_2$="",CUST_USER_DEF_3$="",CUST_USER_DEF_4$="",CUST_USER_DEF_5$="",CUST_USER_DEF_6$="",CUST_USER_DEF_7$="",CUST_USER_DEF_8$="",CUST_USER_DEF_9$="",CUST_USER_DEF_10$="" ! WO249058
5570 ORD_STAT_SORT_CUST_1$=""; ORD_STAT_SORT_CUST_2$=""; ORD_STAT_SORT_CUST_3$=""
5575 ORD_APPR_WS_EMAIL$="" ! WO253784, Emails to worksheet email address?
5577 ALWAYS_SALES_ORDER$="" ! WO256739, Override order type to Sales Order?
5580 ORD_STAT_SORT_LOC_1$=""; ORD_STAT_SORT_LOC_2$=""; ORD_STAT_SORT_LOC_3$=""
5590 WHSE_GRP$=""; PUL_INVT_OPP_WHSE_OE$=""
5600 CATALOG_1$=""; CATALOG_2$=""; CATALOG_3$=""; CATALOG_4$=""; CATALOG_5$=""
5610 ALLOW_MAN_SHIP_TO$=""; GEN_RON$=""; DISPLAY_EC_PROMO$=""
5620 ACTV_ORD_MAX$=""; ACTIVATE_SHIPTO$=""; ACTIVATE_SINGLE_INST$=""
5630 ALT_TERMS$=""; ACCUM_MAX_CHK$=""; ACTV_ORD_APPR$=""
5640 ORD_APPR_VP$=""; ORD_APPR_OM$=""; REL_NON_APPR$=""
5650 SUPP_FMS_USE$=""; SUPP_BUY_DEF$=""; PREV_ONHOLD_ORD$=""; ALWAYS_USE_FMS$=""
5655 ECP_TEMPLATE_BUYER$="",DISPLAY_SAGE$=""
5657 BASE_PAGE_REF$="",CGI_COMMAND$="",COLOR_SCHEME$="",FRT_MARKUP$="" ! SSP228104
5658 USE_LOT_SELL_PRICE$="" ! 227556
5660 ORD_APPR_BUDGET$="",OVER_BUDGET_CC$="" ! 242686
5675 NEXT_ID=CUSTOMER.CTL,NEXT_FOLDER=FLDR.ECGAR1.1.CTL
5680 REFRESH_FLG=1
5682 BUYER_EMAIL$=""
5683 ORD_APPR_OC_APRVR$="" ! WO244587
5685 CALL "*wingrp;disable",FIELDS.GRP$; ENABLE_FLG=0
5690 RETURN 
8000 ! Messages
8010 TERM_MSG:
8020 MSGBOX MSG("ADD_RECORD"),MSG("CONFIRM"),"?,YesNo",ANS$
8030 IF ANS$="NO" THEN CUSTOMER$=""; NEXT_ID=CUSTOMER.CTL; EXIT 
8040 DIM ECS$(1000),B_ECS$(1000); NEXT_ID=CUST_LOGO_FILE_NAME.CTL ! ssp 190554
8045 GOSUB COPY_OPTION
8050 CALL "*wingrp;Enable",FIELDS.GRP$
8060 CALL "*wingrp;Enable",BUTTONS.GRP$; CALL "*wingrp;Enable",FIELDS.GRP$; ENABLE_FLG=1
8070 GOSUB READ_AR1
8090 RETURN 
8100 ! No First Record
8110 NO_FIRST:
8120 MSGBOX MSG("REC_NO_1ST"),"FYI","!"
8130 RETURN 
8200 ! No Last Record
8210 NO_LAST:
8220 MSGBOX MSG("REC_NO_LST$"),"FYI","!"
8230 RETURN 
8300 ! Start of File
8310 START_FILE:
8320 MSGBOX MSG("START_FILE"),"FYI","!"
8330 RETURN 
8400 ! End of File
8410 END_FILE:
8420 MSGBOX MSG("END_OF_FIL"),"FYI","!"
8430 RETURN 
8500 ! Invalid Day Message
8510 INVALID_MSG:
8520 MSGBOX MSG("INVALID_D"),"FYI","!"
8590 RETURN 
9000 ! Parameters
9010 GET_SYS_PARAM:
9020 DIM ECPARM$(1275); READ (Z[6],KEY=X3$(9,3)+"E/C",DOM=*NEXT)ECPARM$(1) ! SSP263687
9090 RETURN 
9999 END 
10000 ! Custom Routines
10010 CUST_IMAGE_PATH:
10020 IF X3$(188,3)="ECW" THEN PATH$=STP(ECPARM$(198,60),3," "),P=LEN(PATH$); IF NUL(CUST_IMAGE_PATH$) THEN CUST_IMAGE_PATH$=PATH$; REFRESH_FLG=1
10050 RETURN 
10100 QUERY:
10110 PROCESS "QRY_ECS","../ECG/EC.EN",VAL$; IF STP(VAL$)="" THEN RETURN 
10120 CUSTOMER$=VAL$
10150 GOSUB FIND_REC
10160 NEXT_ID=CUST_LOGO_FILE_NAME.CTL
10180 REFRESH_FLG=1
10190 RETURN 
10200 READ_AR1:
10210 READ (Z(2),KEY=CUSTOMER$,DOM=*RETURN)AR1$
10215 READ (Z(3),KEY=AR1$(359,2),DOM=*NEXT)AR2$
10220 RETURN 
11000 SEL_DRAG:
11005 LIST_BOX READ LIST_BOX_1.CTL,IDX; LIST_BOX FIND LIST_BOX_1.CTL,IDX,LIST_BOX_1$
11010 TXT$=LIST_BOX_1$,REFRESH_FLG=1,XX=POS(SEP=TXT$); IF XX<>0 THEN TXT$=TXT$(1,XX-1)
11020 EXECUTE "ORD_STAT_SORT_CUST_"+STR(LINE)+".CTL'VALUE$=TXT$,ORD_STAT_SORT_CUST_"+STR(LINE)+"$=txt$"
11050 RETURN 
11060 SEL_DRAG_2:
11065 LIST_BOX READ LIST_BOX_1.CTL,IDX; LIST_BOX FIND LIST_BOX_1.CTL,IDX,LIST_BOX_1$
11070 TXT$=LIST_BOX_1$,REFRESH_FLG=1,XX=POS(SEP=TXT$); IF XX<>0 THEN TXT$=TXT$(1,XX-1)
11080 EXECUTE "ORD_STAT_SORT_LOC_"+STR(LINE)+".CTL'VALUE$=TXT$,ORD_STAT_SORT_LOC_"+STR(LINE)+"$=txt$"
11090 RETURN 
12000 SEL_DRAG_CAT:
12001 LIST_BOX READ CAT_VAL.CTL,IDX; LIST_BOX FIND CAT_VAL.CTL,IDX,CAT_VAL$
12010 TXT$=CAT_VAL$,REFRESH_FLG=1,XX=POS(SEP=TXT$); IF XX<>0 THEN TXT$=TXT$(1,XX-1)
12020 EXECUTE "CATALOG_"+STR(LINE)+".CTL'VALUE$=TXT$,catalog_"+STR(LINE)+"$=txt$"
12050 RETURN 
13000 DRAG_ON:
13010 DROP LIST_BOX_1.CTL ON ORD_STAT_SORT_CUST_1.CTL RETURN 20
13020 DROP LIST_BOX_1.CTL ON ORD_STAT_SORT_CUST_2.CTL RETURN 30
13030 DROP LIST_BOX_1.CTL ON ORD_STAT_SORT_CUST_3.CTL RETURN 40
13040 DROP LIST_BOX_1.CTL ON ORD_STAT_SORT_LOC_1.CTL RETURN 50
13050 DROP LIST_BOX_1.CTL ON ORD_STAT_SORT_LOC_2.CTL RETURN 60
13060 DROP LIST_BOX_1.CTL ON ORD_STAT_SORT_LOC_3.CTL RETURN 70
13070 RETURN 
14000 DRAG_OFF:
14010 DROP LIST_BOX_1.CTL ON ORD_STAT_SORT_CUST_1.CTL REMOVE 
14020 DROP LIST_BOX_1.CTL ON ORD_STAT_SORT_CUST_2.CTL REMOVE 
14030 DROP LIST_BOX_1.CTL ON ORD_STAT_SORT_CUST_3.CTL REMOVE 
14040 DROP LIST_BOX_1.CTL ON ORD_STAT_SORT_LOC_1.CTL REMOVE 
14050 DROP LIST_BOX_1.CTL ON ORD_STAT_SORT_LOC_2.CTL REMOVE 
14060 DROP LIST_BOX_1.CTL ON ORD_STAT_SORT_LOC_3.CTL REMOVE 
14090 RETURN 
15000 DRAG_ON_2:
15010 DROP CAT_VAL.CTL ON CATALOG_1.CTL RETURN 20
15020 DROP CAT_VAL.CTL ON CATALOG_2.CTL RETURN 30
15030 DROP CAT_VAL.CTL ON CATALOG_3.CTL RETURN 40
15040 DROP CAT_VAL.CTL ON CATALOG_4.CTL RETURN 50
15050 DROP CAT_VAL.CTL ON CATALOG_5.CTL RETURN 60
15090 RETURN 
16000 DRAG_OFF_2:
16010 DROP CAT_VAL.CTL ON CATALOG_1.CTL REMOVE 
16020 DROP CAT_VAL.CTL ON CATALOG_2.CTL REMOVE 
16030 DROP CAT_VAL.CTL ON CATALOG_3.CTL REMOVE 
16040 DROP CAT_VAL.CTL ON CATALOG_4.CTL REMOVE 
16050 DROP CAT_VAL.CTL ON CATALOG_5.CTL REMOVE 
16090 RETURN 
17000 LOAD_CATALOG:
17010 CALL "ECGMCC"
17020 LIST_BOX LOAD CAT_VAL.CTL,""
17030 IDX=0,_EDA=HFN; OPEN (_EDA,IOL=*,REC=EDA$)"EDA"+%C$
17040 READ (_EDA,KEY="",DOM=*NEXT)
17050 READ (_EDA,END=END_EDA)
17060 IDX+=1; LIST_BOX LOAD CAT_VAL.CTL,IDX,STP(EDA.CATALOG_ID$)+SEP+STP(EDA.TF_DESCRIPTION$)
17070 GOTO 17050
17080 END_EDA:
17090 CLOSE (_EDA)
17100 RETURN 
17500 LOAD_SORT:
17510 CALL "ECGSRA"
17520 LIST_BOX LOAD LIST_BOX_1.CTL,""
17530 IDX=0,_ECU=HFN; OPEN (_ECU,IOL=*,REC=ECU$)"ECU"+%C$
17540 READ (_ECU,KEY="",DOM=*NEXT)
17550 READ (_ECU,END=END_ECU)
17560 IDX+=1; LIST_BOX LOAD LIST_BOX_1.CTL,IDX,STP(ECU.CODE_SORT$)+SEP+STP(ECU.TF_DESC$)
17570 GOTO 17550
17580 END_ECU:
17590 CLOSE (_ECU)
17600 RETURN 
17700 CHECK_TERMS:! SSP#258784
17710 DIM CCPLUS_ALT_TERM$(100); IF STP(ALT_TERMS$,3)="" THEN RETURN ELSE FIND (Z(3),KEY=ALT_TERMS$)CCPLUS_ALT_TERM$
17720 IF CCPLUS_ALT_TERM$(57,1)<>"Y" THEN RETURN 
17730 ALT_TERMS$=""; MSGBOX MSG("ALT_TERM_3"),_FYI$,"!"
17740 NEXT_ID=ALT_TERMS.CTL; REFRESH_FLG=1
17790 RETURN 
18000 SEL_PASSWORD:
18010 AA=BUYER_PASSWORD.CTL,BB$=A'*
18020 ESCAPE 
20000 COPY_OPTION:
20005 PRINT 'CI',
20010 PROCESS "ECGAR1.COPY","../ECG/EC.EN",OPTION$,FROM_CUST$
20020 IF OPTION$<>"1" THEN RETURN 
20025 IF STP(FROM_CUST$)="" THEN RETURN ! SSP246828 jdf
20030 FIND RECORD (Z[1],KEY=FROM_CUST$,DOM=20080)COPY_FROM$ ! SSP246828 jdf
20050 COPY_FROM$(1,10)=CUSTOMER$
20060 WRITE RECORD (Z[1],KEY=COPY_FROM$(1,10))COPY_FROM$
20070 GOTO FIND_REC
20080 MSGBOX MSG("ECGAR1_12"),MSG("FYI") ! SSP246828 jdf
20085 GOTO 8040 ! SSP246828 jdf
20099 ! 
56000 REM "190305-Create new Freight Markup Parameter for Webec Customers
56001 ! "190554-Getting program exception in order entry. Tried deleting the
56002 ! "       OS_BYDATE and reentering but still stuck in error handler."
56003 REM "208674-Sage On Line - Webec Interface                              
56005 REM "211380-TopForm file feldnames which are SQL keywords break Oracle. 
56008 REM "228104-Ability to have a custom base page ref and cgi command for
56009 REM "227556-Create new EC program to determine highest lot sell price,  
56010 REM "244587-EC Customer Parameter - Send order confirmation to approver?
56011 REM "246753-Ability to Copy from an existing ECS record
56012 REM "242686-Custom project using the EC Budget module.                  
56014 REM "249058-10 EC Buyer & 10 EC Customer user defined 1 character fields
56016 REM "253784-Order Approval; Send approval type email to worksheet email 
56018 REM "254578-ECGAR1 calls EC3UT8 to rebuild order sorts, displays CHUI   
56020 REM "256739-EC Customer Parameter to make all EC orders Sales Order type
56021 REM "255476-TVIINC workflow - Phase 1: Approver edit worksheets feature 
56022 REM "263088-Pier1; Modify EC Invoice/ShipNotice programs used in SJ     
56024 REM "264379-Addt'l to WO263088; EC Cust Parm-Allow 0 qty shipped inv lns
56026 REM "263687-Error generating DB/e orders. (016-EC3SOR-6720) **ECW full**
