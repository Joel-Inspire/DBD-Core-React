0010 ! ECGXOA - XML Outgoing Parameter Setup
0035 REM "5.7 - 03/15/18 - 11.785833 - jvv - SSP# 299143
0037 REM "299143-PVX 2017 windx on PVX 7 data set error in buyer setup at    
0040 REM "Copyright 2018 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 IF TCB(88)=0 THEN MSGBOX "You must be using Windx to access this program" ELSE PROCESS "ECGXOA","../ECG/EC.EN"
0055 IF TCB(13)=1 THEN RUN "ZMENU" ELSE EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0$="EC3XOA",X1$="XML Outgoing Parameter Setup"
0140 ! 
0150 X0=-1,X2=-1
0160 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2; IF X1>0 THEN GOSUB WRAPUP
0170 ! 
0190 DIM Z[NUM(X3$(60,3))]
0200 ! Files
0210 Z$="01X ZZPARM  06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0
0230 GOSUB READ_INFO
0300 ! Iolist Section
0310 IOLIST EC$(1,LEN(EC$)),EC[0],EC[1],EC[2]
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0780 REFRESH_FLG=1
0790 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
1000 ! Get XML Parameter Information
1010 READ_INFO:
1020 DIM EC$(512),EC[2]
1030 READ (Z[1],KEY=X3$(9,3)+"XMLOUT",DOM=ADD_MSG)IOL=0310
1050 B_EC$=EC$
1090 RETURN 
2000 ! Load Screen with Parameter Information
2010 LOAD_SCREEN:
2020 ECG.X001$=EC$(10,15); ECG.X002$=EC$(25,15); ECG.X003$=EC$(40,10)
2030 ECG.X004$=EC$(50,120); ECG.X005$=EC$(170,40)
2040 ECG.X006$=EC$(210,1) ! SSP224325, use carton pack as divisor
2050 ECG.X007$=EC$(211,120),ECG.X008$=EC$(331,40) ! SSP278673, Flowpoint URL and Security Token
2085 REFRESH_FLG=1
2090 RETURN 
3000 ! Write the record
3010 WRITE_REC:
3030 GOSUB LOAD_INFO ! SSP279128 IF EC$=B_EC$ THEN RETURN 
3040 WRITE (Z[6],KEY=X3$(9,3)+"XMLOUT")IOL=0310
3080 B_EC$=EC$
3090 RETURN 
4000 ! Load Parameter string with user input from screen
4010 LOAD_INFO:
4020 EC$(10,15)=ECG.X001$; EC$(25,15)=ECG.X002$; EC$(40,10)=ECG.X003$
4030 EC$(50,120)=ECG.X004$; EC$(170,40)=ECG.X005$
4040 EC$(210,1)=ECG.X006$ ! SSP224325, use carton pack as divisor
4050 EC$(211,120)=ECG.X007$,EC$(331,40)=ECG.X008$ ! SSP278673, Flowpoint URL and Security Token
4085 ! SSP279128 WRITE (Z[6],KEY=X3$(9,3)+"XMLOUT")IOL=0310
4090 RETURN 
5000 ! Check Changes
5010 CHECK_CHANGES:
5015 GOSUB LOAD_INFO ! SSP279128
5030 IF B_EC$=EC$ THEN RETURN 
5040 MSGBOX MSG("REC_ALTERD"),MSG("UPDATED"),"?,YESNO",ANS$
5050 IF ANS$="NO" THEN RETURN 
5060 GOSUB WRITE_REC
5090 RETURN 
8000 ! Add Messages
8010 ADD_MSG:
8020 MSGBOX MSG("ADD_RECORD"),MSG("VERIFY"),"?,YESNO",ANS$
8030 IF ANS$="NO" THEN CMD_STR$="END"; RETURN 
8040 DIM EC$(512); B_EC$=EC$
8045 EC$(1,9)=X3$(9,3)+"XMLOUT" ! 283349
8050 NEXT_ID=ECG.X001.CTL
8090 RETURN 
9999 END 
18000 SEL_PASSWORD:! SSP279128, masked fields, copied from ECGMAA
18001 RETURN ! PRINT 'CI', SSP 299143
18010 L=0,OP$=ID'*,XX=ID'COL,YY=ID'LINE,XXX=ID'COLS,YYY=ID'LINES; DIM OP$[200],NA$[200]
18020 ! 
18030 NXT_OPT:
18040 X=POS(","=OP$); IF X=0 THEN GOTO END_OPT
18050 LST$=OP$(1,X-1),OP$=OP$(X+1),L=L+1,OP$[L]=LST$,NA$[L]=EVS("ID'"+LST$+"$")
18060 ! PRINT OP$[L],"  ",NA$[L]
18070 GOTO NXT_OPT
18080 ! 
18090 END_OPT:
18100 MULTI_LINE REMOVE ID
18110 IF REST=0 THEN MULTI_LINE ID,@(XX,YY,XXX,YYY),OPT="H"+OPT$; HIDE CONTROL ID+3000; REFRESH_FLG=1 ELSE MULTI_LINE ID,@(XX,YY,XXX,YYY),OPT="H$"+OPT$; HEIGHT$=ID'HEIGHT$; SHOW CONTROL ID+3000; REFRESH_FLG=1
18120 FOR AA=1 TO L
18130 BB$=PAD(OP$[AA],6," "); IF POS(BB$="Len   Col   Cols  Line  Lines Width Height",6)<>0 THEN CONTINUE
18140 IF NOT(NUL(NA$[AA])) THEN EXECUTE "id'"+OP$[AA]+"$="+QUO+NA$[AA]+QUO
18150 NEXT AA
18160 RETURN 
56000 ! Program changes starting 9/22/06
56002 REM "198994-Import XML to create cust supply p.o. and sls order p.o
56004 REM "193728-Four51 Webservices; ShipNoticeRequest,UpdateProductInventory
56006 REM "224325-UpdateProductInventory, use carton pack as divisor.
56008 REM "278673-Flowpoint; Template/EC3SN1 changes for Ship Notice/Closeout 
56010 REM "279128-See 278673; Past issues with ECGXOA-Outgoing XML Parameters 
