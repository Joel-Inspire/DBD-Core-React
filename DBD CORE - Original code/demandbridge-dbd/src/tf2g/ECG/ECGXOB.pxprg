0010 ! ECGXOB - XML Counters Setup
0035 REM "5.7 - 03/15/12 - 23.411111 - crg - SSP# 251794
0037 REM "251794-Inbound EDI 940, Outbound EDI 997. Create custom program to 
0040 REM "Copyright 2012 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 IF TCB(88)=0 THEN MSGBOX "You must be using Windx to access this program" ELSE PROCESS "ECGXOB","../ECG/EC.EN"
0055 IF TCB(13)=1 THEN RUN "ZMENU" ELSE EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0130 X0$="EC3XOB",X1$="XML Counters Setup"
0140 ! 
0150 X0=-1,X2=-1
0160 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2; IF X1>0 THEN GOSUB WRAPUP
0170 ! 
0190 DIM Z[NUM(X3$(60,3))]
0200 ! Files
0210 Z$="01X ZZPARM  06O ZZPARM  "
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0
0230 GOSUB READ_INFO
0300 ! Iolist Section
0310 IOLIST EC$(1,LEN(EC$)),EC[0],EC[1],EC[2]
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0780 REFRESH_FLG=1
0790 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0970 RETURN 
1000 ! Get XML Parameter Information
1010 READ_INFO:
1020 DIM EC$(512),EC[2]
1030 READ (Z[1],KEY=X3$(9,3)+"XMLCOUNT",DOM=ADD_MSG)IOL=0310
1050 B_EC$=EC$
1090 RETURN 
2000 ! Load Screen with Parameter Information
2010 LOAD_SCREEN:
2021 ECG.CNT1$=EC$(12,10)
2022 ECG.CNT2$=EC$(22,10)
2023 ECG.CNT3$=EC$(32,10)
2024 ECG.CNT4$=EC$(42,10)
2025 ECG.CNT5$=EC$(52,10)
2026 ECG.CNT6$=EC$(62,10)
2027 ECG.CNT7$=EC$(72,10)
2028 ECG.CNT8$=EC$(82,10)
2029 ECG.CNT9$=EC$(92,10)
2030 ECG.CNT10$=EC$(102,10)
2085 REFRESH_FLG=1
2090 RETURN 
3000 ! Write the record
3010 WRITE_REC:
3030 IF EC$=B_EC$ THEN RETURN 
3040 WRITE (Z[6],KEY=X3$(9,3)+"XMLCOUNT")IOL=0310
3080 B_EC$=EC$
3090 RETURN 
4000 ! Load Parameter string with user input from screen
4010 LOAD_INFO:
4021 EC$(12,10)=ECG.CNT1$
4022 EC$(22,10)=ECG.CNT2$
4023 EC$(32,10)=ECG.CNT3$
4024 EC$(42,10)=ECG.CNT4$
4025 EC$(52,10)=ECG.CNT5$
4026 EC$(62,10)=ECG.CNT6$
4027 EC$(72,10)=ECG.CNT7$
4028 EC$(82,10)=ECG.CNT8$
4029 EC$(92,10)=ECG.CNT9$
4030 EC$(102,10)=ECG.CNT10$
4085 WRITE (Z[6],KEY=X3$(9,3)+"XMLCOUNT")IOL=0310
4090 RETURN 
5000 ! Check Changes
5010 CHECK_CHANGES:
5030 IF B_EC$=EC$ THEN RETURN 
5040 MSGBOX MSG("REC_ALTERD"),MSG("UPDATED"),"?,YESNO",ANS$
5050 IF ANS$="NO" THEN RETURN 
5060 GOSUB WRITE_REC
5090 RETURN 
8000 ! Add Messages
8010 ADD_MSG:
8020 MSGBOX MSG("ADD_RECORD"),MSG("VERIFY"),"?,YESNO",ANS$
8030 IF ANS$="NO" THEN CMD_STR$="END"; RETURN 
8040 DIM EC$(512); B_EC$=EC$
8045 EC$(1,11)=X3$(9,3)+"XMLCOUNT"
8050 NEXT_ID=ECG.CNT1.CTL
8090 RETURN 
9999 END 
10000 ! 
10005 GET_COUNTER_VALUE:
10050 ENTER COUNTER,RETVAL$,MASK$,INCR_VAL,ERR=*NEXT
10055 IF NUL(MASK$) THEN MASK$=DIM(9,"0") ! Default mask
10060 DIM EC$(512),EC[2]
10065 ZZPARM=FN%FFN("ZZPARM"); IF ZZPARM<0 THEN ZZPARM=HFN; OPEN (ZZPARM)"ZZPARM"
10070 IF INCR_VAL THEN EXTRACT (ZZPARM,KEY=%C$+"XMLCOUNT")IOL=0310 ELSE FIND (ZZPARM,KEY=%C$+"XMLCOUNT")IOL=0310
10080 SWITCH COUNTER
10101 CASE 1; RETVAL$=STR(NUM(EC$(12,10),ERR=*PROCEED)+INCR_VAL:MASK$,ERR=*PROCEED); IF INCR_VAL THEN EC$(12,10)=STR(NUM(RETVAL$):DIM(9,"0")) END_IF ; BREAK
10102 CASE 2; RETVAL$=STR(NUM(EC$(22,10),ERR=*PROCEED)+INCR_VAL:MASK$,ERR=*PROCEED); IF INCR_VAL THEN EC$(22,10)=STR(NUM(RETVAL$):DIM(9,"0")) END_IF ; BREAK
10103 CASE 3; RETVAL$=STR(NUM(EC$(32,10),ERR=*PROCEED)+INCR_VAL:MASK$,ERR=*PROCEED); IF INCR_VAL THEN EC$(32,10)=STR(NUM(RETVAL$):DIM(9,"0")) END_IF ; BREAK
10104 CASE 4; RETVAL$=STR(NUM(EC$(42,10),ERR=*PROCEED)+INCR_VAL:MASK$,ERR=*PROCEED); IF INCR_VAL THEN EC$(42,10)=STR(NUM(RETVAL$):DIM(9,"0")) END_IF ; BREAK
10105 CASE 5; RETVAL$=STR(NUM(EC$(52,10),ERR=*PROCEED)+INCR_VAL:MASK$,ERR=*PROCEED); IF INCR_VAL THEN EC$(52,10)=STR(NUM(RETVAL$):DIM(9,"0")) END_IF ; BREAK
10106 CASE 6; RETVAL$=STR(NUM(EC$(62,10),ERR=*PROCEED)+INCR_VAL:MASK$,ERR=*PROCEED); IF INCR_VAL THEN EC$(62,10)=STR(NUM(RETVAL$):DIM(9,"0")) END_IF ; BREAK
10107 CASE 7; RETVAL$=STR(NUM(EC$(72,10),ERR=*PROCEED)+INCR_VAL:MASK$,ERR=*PROCEED); IF INCR_VAL THEN EC$(72,10)=STR(NUM(RETVAL$):DIM(9,"0")) END_IF ; BREAK
10108 CASE 8; RETVAL$=STR(NUM(EC$(82,10),ERR=*PROCEED)+INCR_VAL:MASK$,ERR=*PROCEED); IF INCR_VAL THEN EC$(82,10)=STR(NUM(RETVAL$):DIM(9,"0")) END_IF ; BREAK
10109 CASE 9; RETVAL$=STR(NUM(EC$(92,10),ERR=*PROCEED)+INCR_VAL:MASK$,ERR=*PROCEED); IF INCR_VAL THEN EC$(92,10)=STR(NUM(RETVAL$):DIM(9,"0")) END_IF ; BREAK
10110 CASE 10; RETVAL$=STR(NUM(EC$(102,10),ERR=*PROCEED)+INCR_VAL:MASK$,ERR=*PROCEED); IF INCR_VAL THEN EC$(102,10)=STR(NUM(RETVAL$):DIM(9,"0")) END_IF ; BREAK
10135 DEFAULT ; RETVAL$="?"
10140 END SWITCH 
10170 IF INCR_VAL THEN WRITE (ZZPARM,KEY=%C$+"XMLCOUNT")IOL=0310
10195 EXIT 
10199 ! 
56000 ! Program changes
56002 REM "251794-Inbound EDI 940, Outbound EDI 997. Create custom program to 
