0010 ! EGCFM1 - WebEC Item Parameters setup
0035 REM "5.7 - 10/26/20 - 13.805555 - dmm - SSP# 300318
0037 REM "300318-FlowPoint; Propago item price/qty break price update feature
0040 REM "Copyright 2020 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0043 ! 
0044 IF %DELETE THEN %DELETE=0; EXIT ! SSP 207047
0045 _CUSTOMER$=%CUSTOMER$; _ITEM_CODE$=%ITEM_CODE$
0050 PROCESS "ECGFM1","../ECG/EC.EN"
0060 %CUSTOMER$=_CUSTOMER$; %ITEM_CODE$=_ITEM_CODE$
0070 EXIT 
0090 ! 
0100 ! 100 - Initialization
0110 INIT:
0120 ! 
0125 IF %DELETE THEN %DELETE=0; CMD_STR$="E"; EXIT ! SSP 207047
0130 X0$="EC3FM1",X1$="EC Item Parameters"
0140 ! 
0150 X0=-1,X2=-1
0160 CALL "ZZCOMP",X0$,X11$,X2$,X3$,X4$,X5$,X0,X1,X2; IF X1>0 THEN CMD_STR$="END"; EXIT 
0170 ! 
0190 DIM Z[NUM(X3$(60,3))],FM1[31],IC0[30]
0200 ! Files
0210 Z$="01O ECR...  02O IC0...  03O FM1...  06O ZZPARM  07O ECS...  12O PP3...  13O EDC...  15O AR1...  " ! SSP 194210
0220 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0
0300 ! IOList Section
0310 IOLIST ECR$(1) ! SSP 300361
0320 IOLIST GL1$
0330 IOLIST IC0$,IC0{ALL}
0340 IOLIST FM1$,FM1{ALL}
0400 ! System Parameters
0410 GOSUB GET_SYS_PARAM
0430 CALL "*wingrp;disable",FIELDS.GRP$; ENABLE_FLG=0
0490 RETURN 
0500 ! 500 - Main panel post_display logic
0510 MAIN_POST_DISPLAY:
0515 DIM ECR$(999) ! SSP 212071 SSP300361
0520 IF NOT(NUL(%CUSTOMER$)) AND NOT(NUL(%ITEM_CODE$)) THEN {
0530 CUSTOMER$=%CUSTOMER$; ITEM_CODE$=%ITEM_CODE$,EXIT_SCR=1 ! SSP 212978
0540 DISABLE CONTROL CUSTOMER.CTL; DISABLE CONTROL ITEM_CODE.CTL
0550 GOSUB FIND_REC; GOSUB GET_ITEM; ECR$(1,20)=CUSTOMER$+ITEM_CODE$; GOSUB READ_PP3 ! ssp 199292
0560  }
0570 NEXT_ID=CUSTOMER.CTL
0580 REFRESH_FLG=1
0790 RETURN 
0900 ! 900 - Wrapup
0910 WRAPUP:
0920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0960 %CUST_NAME$=""; %ITEM_DESC$=""
0970 RETURN 
1000 ! READ RECORD
1010 FIND_REC:
1015 IF NUL(CUSTOMER$) THEN CUSTOMER$=PAD(CUSTOMER$,10)
1020 ! KEY_1$=CUSTOMER$
1030 ! FIND (Z[1],KEY=KEY_1$,DOM=TERM_MSG)IOL=0310
1040 ! 
1050 ! GOSUB LOAD_INFO
1060 ! CALL "*wingrp;Enable",BUTTONS.GRP$; CALL "*wingrp;Enable",FIELDS.GRP$
1070 ! B_ECR$=ECR$
1185 REFRESH_FLG=1
1190 RETURN 
1200 ! READ RECORD
1210 FIND_REC_2:
1215 IF NUL(CUSTOMER$) AND NUL(ITEM_CODE$) THEN RETURN 
1220 KEY_1$=CUSTOMER$+ITEM_CODE$
1230 FIND (Z[1],KEY=KEY_1$,DOM=TERM_MSG)IOL=0310
1240 ! 
1250 GOSUB LOAD_INFO
1260 CALL "*wingrp;Enable",BUTTONS.GRP$; CALL "*wingrp;Enable",FIELDS.GRP$; ENABLE_FLG=1
1270 B_ECR$=ECR$
1285 REFRESH_FLG=1
1290 RETURN 
1300 ! GET ITEM INFORMATION
1310 GET_ITEM:
1315 ITEM_CODE$=PAD(ITEM_CODE$,10)
1320 IF NOT(NUL(CUSTOMER$)) THEN GOTO 1350
1325 KEY_2$="          "+ITEM_CODE$
1330 READ (Z[2],KEY=KEY_2$,DOM=INVALID_ITM)IOL=0330
1335 %ITEM_DESC$=IC0$(21,40)
1337 GOSUB FIND_REC_2
1340 REFRESH_FLG=1; RETURN 
1345 GET_FM1:
1350 KEY_3$=CUSTOMER$+ITEM_CODE$
1360 READ (Z[3],KEY=KEY_3$,DOM=INVALID_ITM)IOL=0340
1370 %ITEM_DESC$=FM1$(42,40)
1375 CALL "FMGFN1;CHECK_FOR_CHILD",ERR=*NEXT,X3$,X4$,CUSTOMER$,MID(FM1$,185,10),SRCC_FOUND; IF SRCC_FOUND THEN MSGBOX ("This is a child item and should not be changed") ! SSP 307512
1380 REFRESH_FLG=1
1385 GOSUB FIND_REC_2
1390 RETURN 
1500 ! Write Record
1510 WRITE_REC:
1540 WRITE (Z[1],KEY=KEY_1$)IOL=0310
1542 CALL "FMGFN1;CHECK_FOR_PARENT",ERR=*NEXT,X3$,X4$,CUSTOMER$,SRC_FOUND; IF SRC_FOUND THEN CALL "FMGFN1;UPDATE_ITEM_ROUTINE",X3$,X4$,CUSTOMER$,"ALL",ITEM_CODE$,0,0 ! SSP 307512
1545 IF MID(ECPARM$,947,1)="Y" THEN CALL "ECGFM3",CUSTOMER$,ITEM_CODE$
1548 IF MID(ECPARM$,554,1)="Y" THEN CALL "ECGFM2",CUSTOMER$,ITEM_CODE$
1550 GOSUB CLEAR_REC ! MSGBOX "Record Updated!","FYI","!"
1580 B_ECR$=ECR$
1585 IF EXIT_SCR THEN CMD_STR$="END" ! SSP 207047 SSP 212978
1590 RETURN 
2000 ! Load Information
2010 LOAD_INFO:
2013 IF NUL(ECR$) THEN RETURN 
2015 CUSTOMER$=ECR$(1,10); ITEM_CODE$=ECR$(11,10)
2020 DEF_CATEGORY$=ECR$(21,10); CATEGORY_2$=ECR$(193,10); CATEGORY_3$=ECR$(203,10)
2030 CATEGORY_4$=ECR$(213,10); CATEGORY_5$=ECR$(223,10); CATEGORY_6$=ECR$(325,10)
2040 CATEGORY_7$=ECR$(335,10); CATEGORY_8$=ECR$(345,10),CATEGORY_9$=ECR$(355,10)
2050 CATEGORY_10$=ECR$(365,10); CATEGORY_11$=ECR$(375,10),CATEGORY_12$=ECR$(385,10)
2060 CATEGORY_13$=ECR$(395,10); CATEGORY_14$=ECR$(405,10),CATEGORY_15$=ECR$(415,10)
2070 CATEGORY_16$=ECR$(425,10); CATEGORY_17$=ECR$(435,10),CATEGORY_18$=ECR$(445,10)
2080 CATEGORY_19$=ECR$(455,10); CATEGORY_20$=ECR$(465,10)
2085 PDF_QTY$=ECR$(576,1) ! SSP 184559
2086 IF STP(ECR$(520,8),2)="" THEN ECR$(520,8)="0" ! ssp 300361
2090 LOC_MONTH_REQ_MAX=NUM(ECR$(520,8))
2100 SECURE_CODES_1$=ECR$(233,2); SECURE_CODES_2$=ECR$(235,2); SECURE_CODES_3$=ECR$(237,2); SECURE_CODES_4$=ECR$(239,2); SECURE_CODES_5$=ECR$(241,2) ! SSP#230234
2110 IMAGE_FILE_NAME_1$=ECR$(31,30); IMAGE_FILE_NAME_2$=ECR$(61,30); IMAGE_FILE_NAME_3$=ECR$(91,30)
2120 IMAGE_FILE_NAME_4$=ECR$(121,30); IMAGE_FILE_NAME_5$=ECR$(151,30)
2130 WAREHOUSE_GROUP$=ECR$(304,21); PARTY_ID_3RD$=ECR$(243,10)
2140 CREATE_PO_WHEN_ORDER1$=ECR$(255,1); START_PO$=ECR$(529,1); END_PO$=ECR$(530,1),PO3$=ECR$(574,1),PO4$=ECR$(575,1)
2145 QTY_BREAKS_ONLY$=ECR$(572,1); PROMO$=ECR$(531,1); PROMO_DESC$=ECR$(532,40)
2150 ALLOW_MULT_ORD$=ECR$(528,1); PRICE_SOURCE$=ECR$(253,1) ! IF PRICE_SOURCE$=" " THEN PRICE_SOURCE$=ECPARM$(559,1)
2155 EXT_REF_1$=ECR$(577,20) ! 208092
2160 ITEM_SEL_CODE_1$=ECR$(475,3); ITEM_SEL_CODE_2$=ECR$(478,3); ITEM_SEL_CODE_3$=ECR$(481,3); ITEM_SEL_CODE_4$=ECR$(484,3); ITEM_SEL_CODE_5$=ECR$(487,3)
2170 ITEM_SEL_CODE_6$=ECR$(490,3); ITEM_SEL_CODE_7$=ECR$(493,3); ITEM_SEL_CODE_8$=ECR$(496,3); ITEM_SEL_CODE_9$=ECR$(499,3); ITEM_SEL_CODE_10$=ECR$(502,3)
2175 EXCLUDE_INVENTORY_EXPORT$=ECR$(597,1),EXCLUDE_PRICE_EXPORT$=ECR$(598,1) ! WO294840
2180 ITEM_SEL_CODE_11$=ECR$(505,3); ITEM_SEL_CODE_12$=ECR$(508,3); ITEM_SEL_CODE_13$=ECR$(511,3); ITEM_SEL_CODE_14$=ECR$(514,3); ITEM_SEL_CODE_15$=ECR$(517,3)
2181 IF STP(CUSTOMER$)="" THEN PRICE_SOURCE$="I"
2182 GOSUB READ_PP3; GOSUB READ_ECS; GOSUB READ_AR1 ! WO294840
2185 B_ECR$=ECR$
2190 REFRESH_FLG=1
2195 CALL "*wingrp;Enable",BUTTONS.GRP$; CALL "*wingrp;Enable",FIELDS.GRP$; ENABLE_FLG=1
2199 RETURN 
2300 ! Load Slections
2310 LOAD_SELECTION:
2311 DIM ECR$(999) ! SSP 300361
2315 ECR$(1,10)=CUSTOMER$; ECR$(11,10)=ITEM_CODE$
2320 ECR$(21,10)=DEF_CATEGORY$; ECR$(193,10)=CATEGORY_2$; ECR$(203,10)=CATEGORY_3$
2330 ECR$(213,10)=CATEGORY_4$; ECR$(223,10)=CATEGORY_5$; ECR$(325,10)=CATEGORY_6$
2340 ECR$(335,10)=CATEGORY_7$; ECR$(345,10)=CATEGORY_8$; ECR$(355,10)=CATEGORY_9$
2350 ECR$(365,10)=CATEGORY_10$; ECR$(375,10)=CATEGORY_11$; ECR$(385,10)=CATEGORY_12$
2360 ECR$(395,10)=CATEGORY_13$; ECR$(405,10)=CATEGORY_14$; ECR$(415,10)=CATEGORY_15$
2370 ECR$(425,10)=CATEGORY_16$; ECR$(435,10)=CATEGORY_17$; ECR$(445,10)=CATEGORY_18$
2380 ECR$(455,10)=CATEGORY_19$; ECR$(465,10)=CATEGORY_20$
2390 ECR$(520,8)=STR(LOC_MONTH_REQ_MAX)
2400 ECR$(233,2)=SECURE_CODES_1$; ECR$(235,2)=SECURE_CODES_2$; ECR$(237,2)=SECURE_CODES_3$; ECR$(239,2)=SECURE_CODES_4$; ECR$(241,2)=SECURE_CODES_5$ ! SSP#230234
2410 ECR$(31,30)=IMAGE_FILE_NAME_1$; ECR$(61,30)=IMAGE_FILE_NAME_2$; ECR$(91,30)=IMAGE_FILE_NAME_3$
2420 ECR$(121,30)=IMAGE_FILE_NAME_4$; ECR$(151,30)=IMAGE_FILE_NAME_5$
2430 ECR$(304,21)=WAREHOUSE_GROUP$; GOSUB SEL_WHSGRP; ECR$(243,10)=PARTY_ID_3RD$
2435 ECR$(572,1)=QTY_BREAKS_ONLY$; ECR$(531,1)=PROMO$; ECR$(532,40)=PROMO_DESC$
2440 ECR$(255,1)=CREATE_PO_WHEN_ORDER1$; ECR$(529,1)=START_PO$; ECR$(530,1)=END_PO$,ECR$(574,1)=PO3$,ECR$(575,1)=PO4$
2450 ECR$(528,1)=ALLOW_MULT_ORD$; ECR$(253,1)=PRICE_SOURCE$
2455 ECR$(577,20)=EXT_REF_1$ ! 208092
2460 ECR$(475,3)=ITEM_SEL_CODE_1$; ECR$(478,3)=ITEM_SEL_CODE_2$; ECR$(481,3)=ITEM_SEL_CODE_3$; ECR$(484,3)=ITEM_SEL_CODE_4$; ECR$(487,3)=ITEM_SEL_CODE_5$
2470 ECR$(490,3)=ITEM_SEL_CODE_6$; ECR$(493,3)=ITEM_SEL_CODE_7$; ECR$(496,3)=ITEM_SEL_CODE_8$; ECR$(499,3)=ITEM_SEL_CODE_9$; ECR$(502,3)=ITEM_SEL_CODE_10$
2475 ECR$(597,1)=EXCLUDE_INVENTORY_EXPORT$,ECR$(598,1)=EXCLUDE_PRICE_EXPORT$ ! WO294840
2480 ECR$(505,3)=ITEM_SEL_CODE_11$; ECR$(508,3)=ITEM_SEL_CODE_12$; ECR$(511,3)=ITEM_SEL_CODE_13$; ECR$(514,3)=ITEM_SEL_CODE_14$; ECR$(517,3)=ITEM_SEL_CODE_15$
2485 ECR$(576,1)=PDF_QTY$ ! SSP 184559
2490 RETURN 
2500 ! Delete Record
2510 DELETE_REC:
2520 MSGBOX MSG("DELETE_REC"),MSG("CONFIRM"),"?,YesNo",ANS$
2530 IF ANS$="NO" THEN RETURN 
2540 REMOVE (Z[1],KEY=KEY_1$,ERR=*NEXT)
2550 ! MSGBOX "Record Deleted!","FYI","!"
2570 GOSUB CLEAR_REC
2571 CMD_STR$="END" ! SSP 207047
2590 RETURN 
3000 ! First Record
3010 FIRST_REC:
3020 KEY_1$=KEF(Z[1],END=NO_FIRST)
3030 READ (Z[1],KEY=KEY_1$)IOL=0310
3040 GOSUB LOAD_INFO
3050 GOSUB GET_ITEM
3090 RETURN 
3200 ! Last Record
3210 LAST_REC:
3220 KEY_1$=KEL(Z[1],ERR=NO_LAST)
3230 READ (Z[1],KEY=KEY_1$)IOL=0310
3240 GOSUB LOAD_INFO
3250 GOSUB GET_ITEM
3290 RETURN 
3400 ! Prior Record
3410 PRIOR_REC:
3420 KEY_1$=KEP(Z[1],END=START_FILE)
3430 READ (Z[1],KEY=KEY_1$)IOL=0310
3440 GOSUB LOAD_INFO
3450 GOSUB GET_ITEM
3490 RETURN 
3600 ! Next Record
3610 NEXT_REC:
3620 KEY_1$=KEY(Z[1],END=END_FILE)
3630 READ (Z[1],KEY=KEY_1$)IOL=0310
3640 GOSUB LOAD_INFO
3650 GOSUB GET_ITEM
3690 RETURN 
4000 ! INITIALIZE FOLDERS
4010 INIT_FOLDER:
4020 SWITCH FOLDER_ID$
4040 CASE "ECGFM1.3"
4045 IF ECR$(255,1)="Y" THEN CALL "*WINGRP;ENABLE",PO.GRP$ ELSE CALL "*WINGRP;DISABLE",PO.GRP$
4046 ! SSP300318-DBD-131-DBSPT-78893 KEEP FIELDS ENABLED REGARDLESS OF CUSTOMER SETTING IF MID(AR1$,474,1)="Y" THEN CALL "*wingrp;Enable",EXCLUDE.GRP$ ELSE CALL "*wingrp;Disable",EXCLUDE.GRP$ ! WO294840 SSP 307293
4047 ! SSP300318-DBD-131-DBSPT-78893 KEEP FIELDS ENABLED REGARDLESS OF CUSTOMER SETTING IF MID(AR1$,542,1)="Y" THEN CALL "*wingrp;Enable",EXCLUDE2.GRP$ ELSE CALL "*wingrp;Disable",EXCLUDE2.GRP$ ! SSP300318-DBD-131-DBSPT-78893
4050 BREAK
4080 END SWITCH 
4085 REFRESH_FLG=1
4090 RETURN 
5000 ! Check Changes
5010 CHECK_CHANGES:
5015 IF STP(ECR$)="" OR MID(ECR$,1,100)=DIM(100) THEN RETURN 
5020 IF ECR$=B_ECR$ THEN RETURN 
5030 MSGBOX MSG("REC_ALTERD"),MSG("UPDATE"),"?,YesNo",ANS$
5040 IF ANS$="NO" THEN CMD_STR$="END"; EXIT 
5050 GOSUB WRITE_REC
5090 RETURN 
5500 ! CLEAR RECORD
5510 CLEAR_REC:
5515 CUSTOMER$=""; ITEM_CODE$=""
5520 DEF_CATEGORY$=""; CATEGORY_2$=""; CATEGORY_3$=""
5530 CATEGORY_4$=""; CATEGORY_5$=""; CATEGORY_6$=""
5540 CATEGORY_7$=""; CATEGORY_8$=""; CATEGORY_9$=""
5550 CATEGORY_10$=""; CATEGORY_11$=""; CATEGORY_12$=""
5560 CATEGORY_13$=""; CATEGORY_14$=""; CATEGORY_15$=""
5570 CATEGORY_16$=""; CATEGORY_17$=""; CATEGORY_18$=""
5580 CATEGORY_19$=""; CATEGORY_20$=""
5590 LOC_MONTH_REQ_MAX=0
5600 SECURE_CODES_1$=""; SECURE_CODES_2$=""; SECURE_CODES_3$=""; SECURE_CODES_4$=""; SECURE_CODES_5$="" ! SSP#230234
5610 IMAGE_FILE_NAME_1$=""; IMAGE_FILE_NAME_2$=""; IMAGE_FILE_NAME_3$=""
5620 IMAGE_FILE_NAME_4$=""; IMAGE_FILE_NAME_5$=""
5630 WAREHOUSE_GROUP$=""; PARTY_ID_3RD$=""
5635 QTY_BREAKS_ONLY$=""; PROMO$=""; PROMO_DESC$=""
5640 CREATE_PO_WHEN_ORDER1$=""; START_PO$=""; END_PO$=""
5650 ALLOW_MULT_ORD$=""; PRICE_SOURCE$=""
5655 EXT_REF_1$="" ! 208092
5660 ITEM_SEL_CODE_1$=""; ITEM_SEL_CODE_2$=""; ITEM_SEL_CODE_3$=""; ITEM_SEL_CODE_4$=""; ITEM_SEL_CODE_5$=""
5665 EXCLUDE_INVENTORY_EXPORT$="",EXCLUDE_PRICE_EXPORT$="" ! WO294840
5670 ITEM_SEL_CODE_6$=""; ITEM_SEL_CODE_7$=""; ITEM_SEL_CODE_8$=""; ITEM_SEL_CODE_9$=""; ITEM_SEL_CODE_10$=""
5675 NEXT_ID=CUSTOMER.CTL
5680 ITEM_SEL_CODE_11$=""; ITEM_SEL_CODE_12$=""; ITEM_SEL_CODE_13$=""; ITEM_SEL_CODE_14$=""; ITEM_SEL_CODE_15$=""
5685 REFRESH_FLG=1; NEXT_ID=CUSTOMER.CTL,%ITEM_DESC$=""
5686 CALL "*WINGRP;DISABLE",FIELDS.GRP$; CALL "*WINGRP;DISABLE",BUTTONS.GRP$
5690 RETURN 
8000 ! Messages
8010 TERM_MSG:
8012 CALL "FMGFN1;CHECK_FOR_CHILD",ERR=*NEXT,X3$,X4$,CUSTOMER$,MID(FM1$,185,10),SRCC_FOUND; IF SRCC_FOUND THEN MSGBOX ("This is a child item and should not be changed") ! SSP 307512
8020 MSGBOX MSG("ADD_RECORD"),MSG("CONFIRM"),"?,YesNo",ANS$
8030 IF ANS$="NO" THEN GOSUB CLEAR_REC; NEXT_ID=CUSTOMER.CTL; CMD_STR$="END"; EXIT ! SSP#282520  SSP 307293
8040 DIM ECR$(999); ECR$(1,20)=KEY_1$; NEXT_ID=CUST_LOGO_FILE_NAME.CTL ! SSP#305146 SSP 300361
8050 CALL "*wingrp;Enable",BUTTONS.GRP$; CALL "*wingrp;Enable",FIELDS.GRP$; ENABLE_FLG=1
8060 IF PRICE_SOURCE$=" " OR STP(PRICE_SOURCE$)="" THEN PRICE_SOURCE$=ECPARM$(559,1),REFRESH_FLG=1
8070 GOSUB READ_PP3; GOSUB READ_ECS; GOSUB READ_AR1 ! WO294840
8075 PDF_QTY$="N" ! SSP 184559
8090 RETURN 
8100 ! No First Record
8110 NO_FIRST:
8120 MSGBOX MSG("REC_NO_1ST"),"FYI","!"
8130 RETURN 
8200 ! No Last Record
8210 NO_LAST:
8220 MSGBOX MSG("REC_NO_LST$"),"FYI","!"
8230 RETURN 
8300 ! Start of File
8310 START_FILE:
8320 MSGBOX MSG("START_FILE"),"FYI","!"
8330 RETURN 
8400 ! End of File
8410 END_FILE:
8420 MSGBOX MSG("END_OF_FIL"),"FYI","!"
8430 RETURN 
8500 ! Invalid Day Message
8510 INVALID_MSG:
8520 MSGBOX MSG("INVALID_D"),"FYI","!"
8590 RETURN 
8800 ! Invalid Item Code Message
8810 INVALID_ITM:
8820 MSGBOX MSG("INVA_ITEM"),MSG("WARNING"),"STOP"
8830 ITEM_CODE$=""; NEXT_ID=ITEM_CODE.CTL,CHANGE_FLG=0 ! SSP 212071
8890 RETURN 
9000 ! Parameters
9010 GET_SYS_PARAM:
9020 DIM ECPARM$(1000); READ (Z[6],KEY=X3$(9,3)+"E/C",DOM=*NEXT)ECPARM$
9030 FOR AA=261 TO 301 STEP 10
9040 IF STP(ECPARM$(AA,10))="" THEN CO$="" ELSE CO$=":"
9050 XX+=1; EXECUTE "TXT"+STR(XX)+"$=MSG("+QUO+"T_ECGMPA_2"+QUO+")+"+QUO+" "+STR(XX)+" :"+STP(ECPARM$(AA,10))+" "+CO$+QUO
9060 NEXT 
9070 XX=0
9090 RETURN 
9999 END 
10100 QUERY:
10110 PROCESS "QRY_ECR","../ECG/EC.EN",VAL$; IF STP(VAL$)="" THEN RETURN 
10120 CUSTOMER$=VAL$(1,10); ITEM_CODE$=VAL$(11,10)
10150 GOSUB FIND_REC_2
10160 NEXT_ID=DEF_CATEGORY.CTL
10180 REFRESH_FLG=1
10190 RETURN 
11000 ! Item Query
11010 ITEM_QUERY:
11020 VAL$=""
11030 IF NUL(CUSTOMER$) THEN %ITEM_CUST$="          "; PROCESS "QRY_IC0.1.4","../ICG/IC.EN",VAL$; IF NUL(VAL$) THEN RETURN ELSE QRY_VAL$=VAL$
11040 IF NOT(NUL(CUSTOMER$)) THEN %CUSTOMER$=CUSTOMER$; PROCESS "QRY_FM1_ITEM","../FMG/FM.EN",VAL$; IF NUL(VAL$) THEN RETURN ELSE QRY_VAL$=VAL$
11070 REFRESH_FLG=1
11080 RETURN 
11500 ! Start PO Code Validation.
11510 START_PO_VAL:
11520 IF POS(START_PO$=" 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",1)=0 THEN MSGBOX MSG("INV_ST_PO"),MSG("FYI"),"STOP"; NEXT_ID=START_PO.CTL; START_PO$=""; GOTO 11580
11580 REFRESH_FLG=1
11590 RETURN 
11600 ! End PO Code Validation.
11610 END_PO_VAL:
11620 IF POS(END_PO$=" 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",1)=0 THEN MSGBOX MSG("INV_END_PO"),MSG("FYI"),"STOP"; NEXT_ID=END_PO.CTL; END_PO$=""; GOTO 11680
11680 REFRESH_FLG=1
11690 RETURN 
11700 READ_PP3:
11710 DIM PP3$(125); FIND (Z[12],KEY=ECR$(1,20),DOM=*NEXT)PP3$
11720 CODE$=MID(PP3$,21,10)
11730 RETURN 
11740 READ_ECS:
11750 DIM ECS$(1000); FIND (Z(7),KEY=ECR$(1,10),DOM=*NEXT)ECS$
11760 RETURN 
11800 READ_AR1:! WO294840
11810 DIM AR1$(600); FIND (Z[15],KEY=ECR$(1,10),DOM=*RETURN)AR1$(1)
11820 ! SSP300318-DBD-131-DBSPT-78893 KEEP FIELDS ENABLED REGARDLESS OF CUSTOMER SETTING IF AR1$(474,1)="Y" THEN CALL "*wingrp;Enable",EXCLUDE.GRP$ ELSE CALL "*wingrp;Disable",EXCLUDE.GRP$
11821 ! SSP300318-DBD-131-DBSPT-78893 KEEP FIELDS ENABLED REGARDLESS OF CUSTOMER SETTING IF MID(AR1$,542,1)="Y" THEN CALL "*wingrp;Enable",EXCLUDE2.GRP$ ELSE CALL "*wingrp;Disable",EXCLUDE2.GRP$ ! SSP300318-DBD-131-DBSPT-78893
11840 RETURN 
11845 ! 
12000 SEL_WHSGRP: REFRESH_FLG=1
12010 READ (Z(13),KEY=WAREHOUSE_GROUP$,DOM=NO_WHSGRP)WHSGRP$
12020 FOR AA=0 TO 11
12030 ECR$(AA*4+256,4)=WHSGRP$(AA*4+82,4)
12040 NEXT 
12050 RETURN 
12060 NO_WHSGRP:
12070 ECR$(256,48)=DIM(48),%EC_WHSE_GRP_DESC$=""
12080 RETURN 
56000 ! "194210-GUI EC Item Parameters, enter a warehouse group by item, not
56001 ! "184559-WO181992, EC Item Parameter "PDF link in place of qty?"     
56002 REM "198385-Item being put on backorder instead of pulling from warehous
56010 ! "199292-EC-Promo item setup.  When you get to the webec screen to   
56011 ! "       add promo item, at the bottom, the description field"
56012 ! "207047-PE in Custom Item Setup-Web.EC parms                        
56013 REM "208092-Four51 Update Product Inventory Web service modifications   
56014 ! "212071-PE in Web.EC Parm                                           
56015 ! "212978-ECGFM1 - WebEC Item Parameters screen, when you SAVE the    
56016 REM "282520-Set up new custom item, save custom item setup/inquiry, get 
56018 REM "294840-EC Item Parameters to exclude from inventory and/or price   
56019 REM "300361-Getting message - current record has been altered.          
56020 REM "300361-Getting message - current record has been altered.          
56021 REM "305146-I cannot checked the Exclude from Price Export box in       
56022 REM "300361-Getting message - current record has been altered.          
56023 REM "307293-Err 47 in ECGFM1 (DBSPT-95404)                              
56024 REM "300318-FlowPoint; Propago item price/qty break price update feature
56025 REM "300318-FlowPoint; Propago item price/qty break price update feature
