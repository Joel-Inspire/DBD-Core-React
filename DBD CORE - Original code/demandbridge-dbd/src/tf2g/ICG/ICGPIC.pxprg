0010 ! ICGPIC - View Picture
0020 ! "6.0 - 06/17/04 - 12:06 PM - jir
0030 ! "Copyright 2004 Computer Software Inc.; Norcross, Georgia
0035 REM "5.5 - 09/10/07 - 10.821944 - jdf - SSP# 211380
0037 REM "211380-TopForm file feldnames which are SQL keywords break Oracle. 
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 SETERR EXIT_PGM
0060 ENTER TF_NAME$
0070 PROCESS "ICGPIC","../ICG/IC.EN",TF_NAME$
0080 EXIT 
0100 INIT:! ^100,10
0110 TF_NAME$=ARG_1$,XX=POS(DLM=TF_NAME$,-1); IF XX<>0 THEN REAL_NAME$=TF_NAME$(XX+1) ELSE REAL_NAME$=TF_NAME$
0120 _FIL_NO=HFN; OPEN (_FIL_NO,ERR=NO_FILE)TF_NAME$; CLOSE (_FIL_NO); _FIL_NO=0
0130 IF DEC(MID(MSE,22,1))>0 THEN WDX$="[WDX]" ELSE WDX$=""
0140 IF WDX$<>"" THEN {
0150 CALL WDX$+"*WINDX.UTL;GET_LWD",WINDX_DIR$
0160 IF WINDX_DIR$(LEN(WINDX_DIR$),1)<>DLM THEN WINDX_DIR$+=DLM
0170  }
0180 IF NOT(LEN(WDX$)) THEN {
0190 PICTURE$=".\"+REAL_NAME$
0200  } ELSE {
0210 PICTURE$=WINDX$+WINDX_DIR$+"topform\"+REAL_NAME$
0220  }
0230 ! 
0240 CH1=HFN; OPEN (CH1,ERR=COPY_FILE)"[wdx]"+PICTURE$
0250 CLOSE_FILES:
0260 IF _FIL_NO THEN CLOSE (_FIL_NO,ERR=*NEXT)
0270 IF CH1 THEN CLOSE (CH1,ERR=*NEXT)
0280 %PIC$=PICTURE$
0290 RETURN 
0500 NO_FILE:
0510 TF_NAME$="../ZZG/nofound.bmp",REAL_NAME$="nofound.bmp"
0520 CH1=HFN; OPEN (CH1,ERR=NOFOUND)TF_NAME$; CLOSE (CH1)
0530 GOTO 0130
0540 NOFOUND: CMD_STR$="e"; EXIT 
3000 EXIT_PGM:
9999 END 
21000 CHECK_BMP_FILE:! 21000,10
21010 ! Check BMP on WINDX
21020 IF DEC(MID(MSE,22,1))>3 THEN WINDX=1,WDX$="[wdx]" ELSE WINDX=0,WDX$=""
21030 CALL WDX$+"*windx.utl;get_lwd",LOCATION$
21040 XX=POS("/"=LOCATION$,-1); IF XX<>0 THEN LOCATION$=LOCATION$(1,XX)+"lib/_bmp/"
21050 XX=POS("\"=LOCATION$,-1); IF XX<>0 THEN LOCATION$=LOCATION$(1,XX)+"lib\_bmp\"
21060 CN1=HFN; OPEN (CN1)"../lib/*bmp"
21070 READ (CN1,END=EOF)TF_NAME$
21080 IF TF_NAME$="." OR TF_NAME$=".." THEN GOTO 21070
21090 CN2=HFN; OPEN (CN2,ISZ=2048)"../lib/*bmp/"+TF_NAME$
21100 PTH$=SUB(PTH$,"/","\"),XX=POS("\pvx"=PTH$); IF XX<>0 THEN PTH$=PTH$(XX)
21110 CN2=HFN; OPEN (CN2,ERR=COPY_FILE)"[wdx]../lib/_bmp/"+TF_NAME$
21120 CLOSE (CN2)
21130 GOTO 21070
21140 EOF:
21150 CLOSE (CN1,ERR=*NEXT)
21160 CLOSE (CN2,ERR=*NEXT)
21170 CLOSE (CN3,ERR=*NEXT)
21180 EXIT 
21190 COPY_FILE:
21200 SERIAL "[WDX]"+PICTURE$
21210 CN2=HFN; OPEN (CN2,ISZ=2048)"[wdx]"+PICTURE$
21220 CN3=HFN; OPEN (CN3,ISZ=2048)TF_NAME$
21230 READ RECORD (CN3,END=END_COPY)FR$
21240 WRITE RECORD (CN2)FR$
21250 GOTO 21230
21260 END_COPY:
21270 CLOSE (CN3,ERR=*NEXT)
21280 CLOSE (CN2,ERR=*NEXT)
21290 GOTO CLOSE_FILES
56000 REM "211380-TopForm file feldnames which are SQL keywords break Oracle. 
