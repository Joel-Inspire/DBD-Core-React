0010 REM "Calculate new date <ynewdt>
0030 REM "(C) 1985-1988 Basic Ideas, Inc; Atlanta, GA. USA
0035 REM "This software contains trade secrets and proprietary information"
1000 ENTER X3$,D0$,D0,D1$
1010 SETERR 9000
1020 D0=INT(D0)
1060 DIM D[12]; D[1]=31,D[2]=28,D[3]=31,D[4]=30,D[5]=31,D[6]=30,D[7]=31,D[8]=31,D[9]=30,D[10]=31,D[11]=30,D[12]=31
1090 ON W0 GOTO 1100,4000,5000,6000
1100 REM "D0 = NUMBER OF DAYS
1120 Q1=NUM(D0$(5,2)),Q0=NUM(D0$(3,2)),Q2=NUM(D0$(1,2),ERR=1121); GOTO 1150
1125 F0=1
1130 Q2=(ASC(D0$(1,1))-65)*10+1900+NUM(D0$(2,1))
1150 IF Q0>12 THEN Q0=Q0-12,Q2=Q2+1
1200 REM "
1210 W0=D0
1220 Q1=Q1+D0
1240 IF Q1>0 THEN GOTO 1300
1245 Q0=Q0-1; IF Q0=0 THEN Q2=Q2-1,Q0=12
1250 X=Q0,X1=Q2; GOSUB 8100
1260 Q1=Q1+Q
1270 GOTO 1240
1300 REM "
1310 X=Q0,X1=Q2; GOSUB 8100
1320 IF Q1<=Q THEN GOTO 2000
1330 Q0=Q0+1,Q1=Q1-Q; IF Q0=13 THEN Q0=1,Q2=Q2+1
1350 GOTO 1310
2000 REM "
2020 IF F0=0 THEN D1$=STR(Q2:"00")+STR(Q0:"00")+STR(Q1:"00") ELSE D1$=CHR(INT((Q2-1900)/10)+65)+STR(MOD(Q2,10))+STR(Q0:"00")+STR(Q1:"00")
2050 GOTO 9900
8100 REM "GET MAX # DAYS FOR MONTH X IN Q FOR YEAR X1
8110 Q=31-SGN(POS(STR(X:"00")="0904061102",2))
8120 IF X=2 THEN Q=Q-1-SGN(FPT(X1/4))
8190 RETURN 
8905 REM DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
8910 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
9900 REM 
9910 EXIT 
9999 END 
