0010 REM "Report Options Selection <ZZRPTO>
0020 SETESC 9300; SETERR 9000
0030 REM "(C) 1984 & 1985 Basic Ideas, Inc; Atlanta, Georgia.
0035 REM "5.7 - 06/30/09 - 16.478333 - tma - SSP# 230905
0037 REM "230905-Program FM2RIS - Open Sales Order Report, getting stuck     
0040 REM "Copyright 2009 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Y0$,A$,A{ALL},A0,C0,X0
0095 REM " LET V0=3
0100 SETERR 9000; IF ERR=36 THEN IF X3$="?" THEN CALL "ZZHELP","ZZRPTO","",0; EXIT 
0110 X0$="ZZRPTO",X1$=""
0120 DIM S$(128),C$(300),F$(138)
0130 X0$="ZZRPTO",M1$="Normal        Compressed    Special Mode 1Special Mode 2"
0140 DEF FNS$(Z1$)=Z1$(1,POS("   "=Z1$+"   ")-1)
0200 REM "
0220 IF A$="" THEN A$=S$,A$(1,1)="I",A$(2,6)="U",A$(8,1)="N",A$(9,2)="NN" ELSE A$=A$+S$(1,LEN(S$)-LEN(A$))
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0360 IOLIST F$,F[0],F[1],F[2]
0370 IOLIST PRTMODE$:[LEN(1)],PRT_ID$:[LEN(6)],PRT_STATUS$:[LEN(1)],PRT_VERT$:[LEN(1)],PRT_HORZ$:[LEN(1)],PRT_AUX1$:[LEN(1)],PRT_AUX2$:[LEN(1)],PRT_AUX3$:[LEN(1)],PRT_AUX4$:[LEN(1)],PRT_LINES_PAGE$:[LEN(2)],PRT_FRM_CDE$:[LEN(1)],PRT_DESC$:[LEN(47)],PRT_JCARD$:[LEN(60)],PRT_JCARD_UNLCK$:[LEN(1)]
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="06O ZZPARM  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 0521,9900
0530 CALL "ZZ2PRP","EF",EF_USED$,EF_DATE$; IF EF_USED$="Y" THEN EF_USED=1 ELSE EF_USED=0
0600 REM "Current Ptr Config
0610 READ (Z[6],KEY="PRINTERS",DOM=0611)P0$,P$; GOTO 0620
0611 DIM P0$(89); P$="LP"
1000 REM "
1040 A$=A$+S$(1,LEN(S$)-LEN(A$))
1050 GOSUB 7800
1100 IF C0=2 THEN X0=3 ELSE X0=-1
1510 A1$=K9$
1700 REM "
1710 ON A0 GOTO 2000,1770,1760
1760 GOSUB 6000; ON A0-2 GOTO 1780,1770
1770 GOSUB 6200; ON A0-3 GOTO 1780,1800
1780 X0=5
1820 CALL "ZZPROM","1",X3$,S3,"","","V",X0
1830 ON S3+1 GOTO 1900,1840,2000
1880 GOTO 9900
1900 X0=X0-2,C0=0,X1=1; GOTO 2020
2000 REM "DATA SEQ
2010 C0=0,X0=0,X1=1
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF C0>3 OR X0<0 THEN GOTO 1800
2035 IF X0*6+11<LEN(V9$) THEN IF V9$(X0*6+11,1)="2" THEN GOTO 2020
2040 ON X0 GOTO 2100,2150,2200,2250,2400,2300,2350,2450,2500,2550,1800
2100 REM "Q=Queued, S=Spooled
2110 CALL "ZZENTR","SRUX",A{ALL},A$,X4$,X3$,24,4+V0,1+K9,1,C0,"",X$,"IQS","ZZRPTO00","IQS","",""; IF C0=6 THEN GOSUB 6400; C0=1
2140 GOTO 2020
2150 REM "Output Device
2155 GOSUB 7100
2160 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,24,6+V0,2+K9,6,C0,"",X$,"","ZZRPTO02","ZZ9","",""; IF C0=6 THEN GOSUB 6400; C0=1
2170 IF C0>0 THEN GOSUB 7150
2190 GOTO 2020
2200 REM "Status (Normal, Ghost)
2205 GOTO 2020; REM IF A$(2+K9,1)="T" THEN GOTO 02020 ELSE IF X3$(28,1)<>"1" THEN LET A$(8+K9,1)="N"; PRINT @(47,8+V0),"N"; GOTO 02020
2210 CALL "ZZENTR","SRU",A{ALL},A$,X4$,X3$,24,8+V0,8+K9,1,C0,"",X$,"NG","ZZRPTO04","","",""
2240 GOTO 2020
2250 REM "Vertical Print Mode
2252 IF A$(2+K9,1)="T" THEN GOTO 2020
2255 N=66; GOSUB 7200
2260 CALL "ZZENTR","SRUX",A{ALL},A$,X4$,X3$,24,8+V0,9+K9,1,C0,"",X$,O$,"ZZRPTO06","NC12","",""; IF C0=6 THEN GOSUB 6400; C0=1
2265 IF C0<0 THEN GOTO 2020 ELSE M=0; GOSUB 7400
2270 IF C0>0 THEN GOSUB 7150
2290 GOTO 2020
2300 REM "Auxillary Print Codes
2302 IF A$(2+K9,1)="T" THEN GOTO 2020
2305 GOSUB 7300; IF I0=0 THEN GOTO 2020
2310 CALL "ZZENTR","SERU",A{ALL},A$,X4$,X3$,24,10+V0,11+K9,1,C0,"",X$,O$,"ZZRPTO08"," 123","",O0$; IF C0=6 THEN GOSUB 6400; C0=1
2320 IF NUM(A$(11+K9,1))<>0 THEN PRINT @(55,14+V0),C$(NUM(A$(11+K9,1))*16+282,16)
2340 GOTO 2020
2350 REM "Lines per Page
2355 IF A$(2+K9,1)="T" THEN GOTO 2020
2360 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,24,12+V0,15+K9,2,C0,"",X$,"","ZZRPTO10","","",""
2390 GOTO 2020
2400 REM "Horizontal Print Mode
2402 IF A$(2+K9,1)="T" THEN GOTO 2020
2405 N=138; GOSUB 7200
2410 CALL "ZZENTR","SRU",A{ALL},A$,X4$,X3$,24,9+V0,10+K9,1,C0,"",X$,O$,"ZZRPTO06","NC12","",""; IF C0=6 THEN GOSUB 6400; C0=1
2420 M=1; GOSUB 7400
2440 GOTO 2020
2450 REM "Forms Code
2455 IF A$(2+K9,1)="T" THEN GOTO 2020 ELSE O$="FORM"
2460 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,24,13+V0,17+K9,1,C0,"",X$,O$,"ZZRPTO06","ZZPB","ZZ2PCA",""; IF C0=6 THEN GOSUB 6400; C0=1
2470 IF C0>0 THEN READ (Z[6],KEY="FORM"+A$(17,1),DOM=2460)IOL=0360; PRINT @(27,13+V0),F$(6,30),
2475 IF C0>0 THEN GOSUB 7150
2490 GOTO 2020
2500 REM "Job Card Data
2505 IF EF_USED THEN GOTO 2506 ELSE GOTO 2020
2510 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,16,16,65,60,C0,"",X$,"","ZZRPTO08","","",""; IF C0=6 THEN GOSUB 6400; C0=1
2540 GOTO 2020
2550 REM "Allow job card to be modified
2555 IF EF_USED THEN GOTO 2556 ELSE GOTO 2020
2560 CALL "ZZENTR","YU",A{ALL},A$,X4$,X3$,32,17,125,1,C0,"",X$,"","ZZRPTO10","","",""; IF C0=6 THEN GOSUB 6400; C0=1
2590 GOTO 2020
6000 REM "BACKGROUND
6005 PRINT @(0,3+V0),'CE','SB',
6010 PRINT @(12,4),"Print mode:",@(27,4),"(I=Immediate, Q=Queued, S=Spooled)",
6012 PRINT @(9,6),"Output Device:",@(3,8),"Vertical print mode:",@(1,9),"Horizontal print mode:",@(1,10),"Auxillary print codes:",@(8,12),"Lines per page:",@(4,13),"Special forms code:",
6020 IF EF_USED THEN PRINT @(0,15),Z0$,@(31,15),"  Electronic Forms ",@(1,16),"Job Card Data:",@(1,17),"Allow job card to be modified?",
6060 REM CALL "ZZVDTP",X3$,X0$,"*","",-V0
6180 PRINT (0,ERR=6131)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6220 PRINT @(24,4+V0),A$(1+K9,1),@(24,6+V0),A$(2+K9,6),
6225 PRINT @(16,16),A$(65,60),@(32,17),A$(125,1),
6230 GOSUB 7000
6250 REM " IF A$(2+K9,1)<>"T" THEN GOSUB 06300 ELSE GOSUB 06300; REM PRINT @(0,10+V0),'CE',
6305 REM " IF X3$(28,1)<>"1" THEN PRINT @(47,8+V0),"N/A" ELSE PRINT @(47,8+V0),A$(8+K9,1),
6310 PRINT @(24,8+V0),A$(9+K9,1),@(24,9+V0),A$(10+K9,1),
6370 PRINT @(24,10+V0),A$(11+K9,1)," ",A$(12+K9,1)," ",A$(13+K9,1)," ",A$(14+K9,1),
6375 M=0; GOSUB 7400; M=1; GOSUB 7400
6380 GOSUB 7700; PRINT @(24,13+V0),A$(17,1),@(27,13+V0),F$(6,30),
6385 PRINT @(16,16),A$(65,60),@(32,17),A$(125,1),
6390 RETURN 
6400 REM "WHOLE SCREEN
6410 GOSUB 6000
6430 GOSUB 6200
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
7000 REM "Display device description"
7010 PRINT @(32,6+V0),'CL',
7015 IF A$(2+K9,1)="A" THEN P=POS(FID(0)=P$,2); IF P=0 THEN GOTO 7070
7016 IF A$(2+K9,1)="U" THEN Q$=X3$(172,2) ELSE Q$=A$(2+K9,2)
7017 IF Q$="A " THEN Q$=FID(0)
7020 P=POS(Q$=P$,2); IF P=0 THEN GOTO 7070
7030 P1$=P0$(INT(P/2)*8+9,8); DIM C$(300)
7040 READ (Z[6],KEY="ptr"+P1$,DOM=7090)C$
7050 PRINT @(32,6+V0),C$(12,24),
7060 RETURN 
7070 GOTO 7090; REM ON POS(A$(2+K9,1)="TAU") GOTO 7090,7075,7080,7085
7075 PRINT @(32,6+V0),"User's Terminal",; GOTO 7090
7080 PRINT @(32,6+V0),"Auxillary Printer",; GOTO 7090
7085 PRINT @(32,6+V0),"User's default ","(",FNS$(X3$(172,6)),")",; GOTO 7090
7090 RETURN 
7100 REM "Set X$ for output device
7105 X$="Devices: U-User's Default, T-Term."
7107 IF POS(FID(0)=P$,2)<>0 THEN IF FNS$(P0$(INT(POS(FID(0)=P$,2))/2*8+9,8))<>"" THEN X$=X$+", A-Aux."
7110 FOR I=1 TO LEN(P$) STEP 2
7120 IF P$(I,1)<>"T" THEN P2$=P$(I,2)+FNS$("-"+P0$(INT(I/2)*8+9,8)); IF LEN(X$)+LEN(P2$)+2>80 THEN EXITTO 7145 ELSE X$=X$+", "+P2$
7140 NEXT I
7145 RETURN 
7150 REM "Validate Output Device"
7152 P6$=A$(2+K9,2); IF P6$="U " THEN P6$=X3$(172,2)
7153 IF P6$="A " THEN P6$=FID(0)
7155 DIM C$(300)
7156 IF POS(" "<>A$(2+K9,6))=0 THEN GOTO 7190
7157 IF A$(2+K9,1)=" " THEN A$(2+K9,6)=A$(3+K9,5); PRINT @(24,6+V0),A$(2+K9,6),; GOTO 7157
7158 ON POS(A$(2+K9,1)="TUA") GOTO 7167,7160,7161,7165
7160 A$(15+K9,2)="22"; GOSUB 7740; GOTO 7190
7165 P6$=FID(0); GOTO 7170
7170 IF POS(P6$=P$,2)=0 THEN GOTO 7190 ELSE P=POS(P6$=P$,2)
7175 P1$=P0$(INT(P/2)*8+9,8); DIM C$(300)
7180 READ (Z[6],KEY="ptr"+P1$,DOM=2160)C$
7185 PRINT @(32,6+V0),C$(12,24),
7188 GOSUB 7700
7190 RETURN 
7200 REM "Set x$ and o$ for vert & horz. print modes"
7210 X$="Modes: ",O$=""
7220 IF POS(" "<>C$(N,16))<>0 THEN X$=X$+" N=Normal,",O$=O$+"N"
7230 IF POS(" "<>C$(N+16,16))<>0 THEN X$=X$+" C=Compressed,",O$=O$+"C"
7240 IF POS(" "<>C$(N+32,16))<>0 THEN X$=X$+" 1=Special Mode 1,",O$=O$+"1"
7250 IF POS(" "<>C$(N+48,16))<>0 THEN X$=X$+" 2=Special Mode 2,",O$=O$+"2"
7255 IF O$="" THEN IF N=66 THEN EXITTO 2290 ELSE EXITTO 2440
7260 X$=X$(1,LEN(X$)-1)
7290 RETURN 
7300 REM "Set X$ and O$ and O0$ for Auxillary Print codes"
7305 X$="Special Modes: ",O$=" ",I0=0
7310 FOR I=1 TO 5
7320 IF POS(" "<>C$(I*16+202,16))<>0 THEN X$=X$+STR(I:"#")+", ",O$=O$+STR(I:"#"),I0=I0+1
7330 NEXT I
7340 IF O$=" " THEN X$=""; EXITTO 2340 ELSE X$=X$(1,LEN(X$)-2)
7350 IF I0=0 THEN GOTO 7390 ELSE IF I0>3 THEN O0$="03H0" ELSE O0$=STR(I0-1:"00")+"H0"
7390 RETURN 
7400 REM "Print mode description, M=0 do vert mode, M=1 do horiz mode
7410 IF M=0 THEN M$=A$(9+K9,1),M0=8+V0 ELSE M$=A$(10+K9,1),M0=9+V0
7420 PRINT @(32,M0),M1$(POS(M$="NC12")*14-13,14),
7445 RETURN 
7500 REM "CUSTOM PROGRAMMING ROUTINES
7700 REM "GET LINES PER PAGE
7702 IF A$(2,2)="T " THEN GOTO 7740
7705 Q=POS(A$(9+K9,1)="N C 1 2"); IF Q=0 THEN Q=1
7710 Q$=C$(Q+129,2),Q=NUM(Q$,ERR=7711)
7720 GOSUB 7800
7730 IF F[1]<>0 THEN A$(15,2)=STR(Q*F[1]:"00")
7740 PRINT @(24,12+V0),A$(15,2),
7790 RETURN 
7800 REM "GET FORM CODE
7810 DIM F0$(60),F[10]; READ (Z[6],KEY="FORM"+A$(17,1),DOM=7811)IOL=0360
7890 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y0=ERR,Y1=TCB(5)
9040 CALL "ZZERRM",Y1$,X0$,Y2$,X3$,Y0,Y1,Y2,Y3,0
9050 ON Y2 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y2$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9930 X0=0,Q1$=A1$; EXIT ! SSP#230905
9999 END 
