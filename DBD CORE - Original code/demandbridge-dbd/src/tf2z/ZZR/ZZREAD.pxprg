0010 REM "FORCE READ RECORD IN FILE F WITH KEY OF K$ <ZZREAD>
0030 REM "(C) 1985,1986,1987 Basic Ideas, Inc; Atlanta, Ga.
0035 REM "This software contains trade secrets and proprietary information"
0040 REM "DATED 4/19/84 BY JSC
1000 ENTER F,K$,A$,A{ALL},S8; A$="",S8=-1
1100 F$=FID(F,ERR=9000),D=ASC(F$(20)),S0=SSZ(D),A$="",F9=14
1110 DIM Z$(50,$00$); CLOSE (14); OPEN (14,ISZ=256)F$(4,6)+F$(21)
1120 S=DEC($00$+F$(1,3)),B=DEC($00$+F$(15,2)),R=DEC($00$+F$(12,3)),K=DEC(F$(11,1))-4,P=2; IF R>32768 THEN K=K-2,P=3
1140 IF B=0 OR POS(F$(10,1)=$0002$)=0 THEN GOTO 9900 ELSE DIM B$(S0),C$(S0); READ RECORD (F9,IND=0)B$
1150 IF K>0 THEN S1=INT((S0-1-2*P)/(K+2*P)),S2=INT(R/S1*2+2),K$=K$+Z$,K$=K$(1,K)
1180 IF F$(10,1)=$00$ THEN S2=0,Y=NUM(K$); GOTO 1265
1200 REM "GET PRIMARY KEY SECTOR
1210 READ RECORD (F9,IND=1)C$
1220 N=ASC(C$(1,1)),L=P*2+K,C$=C$(2+P)
1250 X=POS(K$=C$(P+1),L); IF X=0 THEN GOTO 1400 ELSE X=X+2+K,Y$=C$(X,P)
1255 Y9$=""; FOR X=LEN(Y$) TO 1 STEP -1; Y9$=Y9$+Y$(X,1); NEXT X; Y=DEC(Y9$)
1265 Z0=Y*B,Z1=MOD(Z0,256),Z0=INT(Z0/256),Z2=Z0+S+S2; Z1=Z1+1
1270 DIM D$(256); READ RECORD (F9,IND=Z2-S)D$
1280 IF A$>"" THEN A$=A$+D$ ELSE A$=D$(Z1)
1285 IF LEN(A$)<B THEN Z2=Z2+1; GOTO 1270 ELSE IF LEN(A$)>B THEN A$=A$(1,B)
1290 GOTO 5000
1410 X=POS(K$<C$(P+1),L); IF X=0 THEN Y=DEC(C$(N*L,2)); GOTO 1441 ELSE Y$=C$(X,P)
1435 IF P=2 THEN Y$=Y$(2)+Y$(1,1) ELSE Y$=Y$(3,1)+Y$(2,1)+Y$(1,1)
1440 Y=DEC(Y$); IF Y=0 THEN GOTO 2000
1445 READ RECORD (F9,IND=Y)C$; GOTO 1211
2000 REM "GET NEXT KEY/RECORD
2010 K$=C$(X,K),X=X+1+K,Y=DEC(C$(X,P)),S8=11
2030 GOTO 1265
4000 REM "CONVERT NUMERICS TO ARRAY
4020 X$=$8A$,P0=0
4030 P=POS(X$=A$); IF P=0 THEN P=POS($000000$=A$+$000000$)-1,A$=A$(1,P); GOTO 4090 ELSE N$=A$(P+1),A$=A$(1,P-1),P0=0
4035 P=POS(X$=N$); IF P=0 THEN GOTO 4090 ELSE Q$=N$(1,P-1),N$=N$(P+1),N=0,N=NUM(Q$,ERR=4036)
4040 SETERR 4095; A[P0]=N,P0=P0+1; SETERR 9000
4050 GOTO 4035
4090 SETERR 4095; A[P0]=0,P0=P0+1; GOTO 4090
4095 SETERR 9000
4100 RETURN 
5000 REM 
5020 GOSUB 4000
5090 GOTO 9900
9900 REM "
9960 EXIT 
9999 END 
