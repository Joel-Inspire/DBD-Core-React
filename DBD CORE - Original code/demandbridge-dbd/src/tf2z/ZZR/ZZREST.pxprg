0010 REM "Audit Report Restart Logic <ZZREST>
0030 REM "(C) 1985,1986,1987 Basic Ideas, Inc; Atlanta, Ga.
0035 REM "This software contains trade secrets and proprietary information"
0100 REM SETESC 9300; SETERR 9000
0310 IOLIST X0$,K0$,K1$,K0,K1
1000 ENTER X3$,P,F,W9,W3,W,X0$,K0$,K1$,K0,K1
1020 GOSUB 3200
1050 IF W9<0 THEN GOTO 3000 ELSE READ (F,KEY="",DOM=9900)IOL=0310
1060 IF W3<81 THEN X=20 ELSE X=10
1100 DIM Y5$(W3),Y6$(W3); FOR Z=0 TO 2; GOSUB 7300; NEXT Z
1110 Y5$(X+10)=U0$(9,65); GOSUB 7300; FOR Z=0 TO 1; GOSUB 7300; NEXT Z
1115 Q$=FNS$(U0$(74,50))+":"; Y5$(FNR(24,Q$))=Q$
1120 Q$=FNS$(U0$(124,20))+":"; Y5$(FNR(50,Q$))=Q$,Y5$(X+52)=K0$; GOSUB 7300
1130 IF K1$<>"" THEN Q$=FNS$(U0$(144,20))+":"; Y5$(FNR(50,Q$))=Q$,Y5$(X+52)=K1$; GOSUB 7300
1140 IF K0>0 THEN Q$=FNS$(U0$(164,20))+":"; Y5$(FNR(50,Q$))=Q$,Y5$(X+52)=STR(K0); GOSUB 7300
1150 FOR Z=0 TO 2; GOSUB 7300; NEXT Z
1200 GOSUB 2000
1215 Y5$(X+17)=L0$(546,8),Y5$(X+29)=L0$(186,8),Y5$(X+63)=L0$(194,8),Y5$(X+76)=L0$(202,8),Y5$(X+88)=L0$(472,16); GOSUB 7300; GOSUB 7300
1220 CALL "ZZDISP","DX",X0$(10,6),"",X3$,Q0$,"",0,0,""
1225 CALL "ZZDISP","TX",X0$(16,4),"",X3$,Q1$,"",0,0,""
1228 Q$=X3$(21,6); CALL "ZZDISP","DX",Q$,"",X3$,Q2$,"",0,0,""
1230 Q$=STR(TIM*1000:"0000"); CALL "ZZDISP","TX",Q$,"",X3$,Q3$,"",0,0,""
1235 Q$=FNS$(U0$(184,30))+":"
1240 Y5$(FNR(16,Q$))=Q$,Y5$(X+18)=X0$(1,6),Y5$(X+29)=X0$(7,3)+" "+O1$(5,25),Y5$(X+61)=Q0$,Y5$(X+75)=Q1$,Y5$(X+88)=X0$(20,4)+"."+X0$(24,2); GOSUB 7300; GOSUB 7300
1255 Q$=FNS$(U0$(214,30))+":"
1260 Y5$(FNR(16,Q$))=Q$,Y5$(X+18)=X3$(1,6),Y5$(X+29)=X3$(40,3)+" "+O2$(5,25),Y5$(X+61)=Q2$,Y5$(X+76)=Q3$,Y5$(X+88)=X3$(178,4)+"."+X3$(182,2); GOSUB 7300; GOSUB 7300
1300 REM 
1305 FOR Q=0 TO 3; GOSUB 7300; NEXT Q
1320 FOR Q=0 TO 5
1330 Q$=U0$(244+Q*60,60); IF POS(" "<>Q$)>0 THEN Y5$(X+15)=Q$; GOSUB 7300
1340 NEXT Q
1500 REM "End"
1505 GOTO 9900
2000 REM "Read in operators"
2010 DIM O1$(60),O2$(60)
2020 READ (P,KEY="o"+X0$(7,3),DOM=2021)O1$
2030 READ (P,KEY="o"+X3$(40,3),DOM=2031)O2$
2050 Q$=STR(INT(TIM):"00")+STR(FPT(TIM)*100:"00")
2090 RETURN 
3000 REM "MAKE RECORD
3010 X0$=X3$(1,6)+X3$(40,3)+X3$(21,6)+STR(TIM*100:"0000")+X3$(178,6)
3030 WRITE (F,KEY="",DOM=3050)IOL=0310
3050 READ (F,KEY="")IOL=0310
3090 GOTO 9900
3200 REM "Get text
3210 L0$=X3$(239,1); CALL "ZZLANG",X3$,L0$
3220 READ (P,KEY="RESTART"+X3$(239,1),DOM=3230)U0$; GOTO 3250
3230 IF X3$(239,1)<>" " THEN READ (P,KEY="RESTART ")U0$
3290 RETURN 
7300 REM "Output line Y5$ to output device
7310 W=W+1
7330 IF POS(" "<>Y5$)=0 THEN PRINT (W9)"" ELSE PRINT (W9)Y5$; DIM Y5$(W3)
7395 RETURN 
8930 DEF FNS$(Z$)=Z$(1,POS("  "=Z$+"  ")-1)
8935 DEF FNR(Z,Z$)=Z-LEN(Z$)-1+X
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5)
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9900 REM 
9950 EXIT 
9999 END 
