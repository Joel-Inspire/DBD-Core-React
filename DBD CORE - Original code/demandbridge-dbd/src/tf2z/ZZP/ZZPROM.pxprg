0010 REM "<ZZPROM> Fast Prompt Routine
0030 REM "(C) 1985-1989 Basic Ideas, Inc; Atlanta, Ga.
0035 REM "5.7 - 09/06/16 - 16.125 - crg - SSP# 286997
0036 REM "5/22/01 -PLH - line 1570 print changed 'CL' TO 'CE'
0037 REM "286997-Batch update prompts hidden from view; users are not able to
0040 REM "Copyright 2016 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0049 ! test
0320 DIM S$(132),M$(132,"_"),Z9$(6,$00$)
0980 X1=-1,X2=X1,X4=-1,C0=-1,T=10,D1=448
1000 SETERR 1005; ENTER X0$,X1$,X0,X2$,X3$,X$,X1; GOTO 1010
1005 IF X0$="?" THEN CALL "ZZPDOC","ZZPROM"; EXIT ELSE EXIT ERR
1010 SETERR 9000; SETESC 9300; X8=X1
1012 IF %BYPASS_R4_REPORT=1 AND (X0$="R4" OR X0$="X0ZZ2RMA" OR X0$="L1ZZPRIN") THEN X0=0; EXIT ! SSP 228852!230842
1013 P_L22=22,P_L23=23
1014 IF %BYPASS_R4_REPORT=1 AND X0$="YE" AND %GUI THEN X0=1; EXIT ! SSP 228852!SSP#230349
1025 IF LEN(X1$)>340 THEN D2$=ATH(X1$(340,12)+X1$(D1,10*12)),A0$=$1B$+"B"+X1$(46,1),A1$=$1B$+"E"+X1$(46,1),D2$=D2$+ATH(X1$(340,9*12))
1030 D0=NUM(X1$(60,3)); IF D0=0 THEN D0=14
1040 IF MID(X0$,1,1)="." THEN X$=X$+".",X0$=X0$(2)
1110 DIM P$(10); P$(1,1)=X1$(239,1),P$(2)=X0$,P$(10,1)=X1$(238,1)
1120 X4$=X$; CLOSE (D0); OPEN (D0)"ZZT2"; READ (D0,KEY=P$,DOM=1122)I0,V0$,X4$,Q5$,Q3$,Q4$,S0$,P9,S0,X5$,Q$,X9,Q6$,Q0$,Q2$,H9$; GOTO 1135
1130 IF MID(P$,1,1)<>" " THEN P$(1,1)=""; GOTO 1120 ELSE IF POS("S"=X4$)>0 THEN EXIT ELSE IF POS("R"=X4$)=0 THEN EXIT 11 ELSE EXIT 
1135 X4$=X4$+X$
1136 IF NOT(NUL(%IL_IMAGE_TYPE$)) THEN GOSUB SETUP_FOR_IMAGES
1140 IF POS("."=X4$)>0 THEN PRINT 'RB',
1150 IF POS("T"=X4$)>0 THEN X2$=Q$,Q$=""; GOTO 9920 ELSE IF POS("Q"=X4$)>0 OR POS("R"=X4$)>0 THEN Q0$=Q$ ELSE X8=0; IF X2$="" THEN X2$=Q$
1155 IF POS("W"=X4$)>0 THEN P_L22=14,P_L23=15
1160 IF X8<>0 THEN P=POS($1B02$=V0$); IF P>0 THEN V0$(P+3,1)=CHR(X8)
1321 X5$=X1$(276,2); IF POS("="=X4$)>0 THEN X5$=X4$(1+POS("="=X4$))
1325 IF POS("R"=X4$)>0 OR POS("Q"=X4$)>0 THEN S0=0 ELSE IF POS("S"=X5$)>0 THEN S0=1 ELSE IF POS("H"=X5$)>0 THEN S0=2 ELSE S0=0
1330 IF POS("T"=X4$)>0 THEN X0=POS(S$(1,16)=X2$+S$,16),X2$=X2$(1,X0-1),X0=INT(X0/16); GOTO 9920
1340 GOSUB 7000; GOSUB 7700
1370 IF S0=0 AND POS("R"=X4$)=0 AND POS("Q"=X4$)=0 THEN GOSUB 7100
1540 IF X2<0 THEN X2=P_L22
1543 IF POS("W"=X4$)>0 THEN X2=P_L23
1545 IF POS("Q"=X4$)>0 AND X2$>"" THEN V0$=V0$+X2$(2)
1560 IF POS("R"=X4$)>0 THEN X2$=Q0$; IF POS("Q"=X4$)=0 THEN GOTO 1700 ELSE GOTO 9900
1570 IF POS("Q"=X4$)>0 THEN IF %GUI THEN GOSUB GUI_MESSAGE ELSE PRINT @(0,22),'CE',V0$," ", END_IF ; GOTO 9900; REM ELSE @(X9,21),X2$,;GOTO 9900
1580 REM ******* LOOP RE-ENTRY SELECTION NOT PICKED*******
1581 REM 1 = SOFT PROMPT, 2 = HELP PROMPTS, 0 = ALL ELSE
1585 ON S0 GOSUB 8000,8100,8400
1610 IF S0>0 OR POS("Q"=X4$)>0 THEN X0=C0; GOTO 1700
1620 P0=1,X0=-1
1625 IF MID(Q2$,P0)="" THEN GOTO 9500 ELSE P=POS("|"=Q2$(P0)),X0=X0+1
1630 Q$=Q2$(P0,P-1),P0=P0+P; IF Q$="\" THEN Q$=""
1635 IF Q$="" THEN IF Q4$="" THEN GOTO 1700 ELSE GOTO 1625
1640 FOR X=1 TO LEN(Q$)
1650 IF MID(Q$,X,1)<"a" OR MID(Q$,X,1)>"z" THEN IF LEN(Q4$)<X THEN EXITTO 1625 ELSE IF MID(Q4$,X,1)<>MID(Q$,X,1) THEN EXITTO 1625
1655 IF MID(Q$,X,1)>="a" AND MID(Q$,X,1)<="z" THEN IF LEN(Q4$)<X THEN EXITTO 1700 ELSE IF CHR(ASC(MID(Q$,X,1))-32)<>MID(Q4$,X,1) THEN EXITTO 1625
1680 NEXT X
1690 IF LEN(Q4$)>LEN(Q$) THEN GOTO 1625
1700 REM **********************************
1790 GOTO 9900
5005 L1$="",L2$=""
5010 P=POS("-"=X6$)
5020 IF P=0 THEN GOTO 5100
7000 REM OPEN SYSTEM PROMPT DATA FILE
7005 CLOSE (D0); OPEN (D0)"ZZT"; F0=D0; RETURN 
7090 RETURN 
7100 REM *******PROCESS PHRASE PROMPTS***********
7105 Q2$="",Q0$=FNS$(P$(12,65))
7110 FOR X=0 TO 9
7115 IF POS(" "<>MID(P$,82+X*16))=0 THEN EXITTO 7131
7125 Q$=FNS$(P$(82+X*16,16)); IF Q$<>"" THEN IF Q$="\" THEN Q$="|" ELSE Q$=Q$+"|"
7128 IF Q$<>"" THEN Q2$=Q2$+Q$
7130 NEXT X
7140 Q2$=Q2$+X9$
7145 GOSUB 7900
7150 IF S0=0 AND POS("Q"=MID(P$,77,5))=0 AND POS("R"=MID(P$,77,5))=0 THEN Q0$=Q0$+": "
7195 RETURN 
7600 REM *****************************
7610 PRINT @(0,P_L22),'CE',
7615 X$=FNS$(P$(C0*35+324,35))
7620 X0=0; IF MID(X$,1,1)=":" THEN CALL X$(2),X1$,X3$,"",""; EXIT 69
7630 X0=0; CALL "ZZPROM",ERR=7631,X$,X1$,X0,"","","",X1
7640 IF X0=0 THEN RESET ; GOTO 1580
7690 RESET ; GOTO 1700
7700 REM *******FIRST INDEX FIELD FROM ZZT USED TO GET NEW CONTENTS P$******
7705 X0$=X0$+S$(1,8-LEN(X0$)); DIM P$(709); FIND (D0,IND=I0)P$(1); GOTO 7790
7710 Q$=X1$(239,1)+X0$
7715 FIND (D0,KEY="P?"+Q$,DOM=7720)P$(1); GOTO 7790
7720 IF MID(Q$,1,1)<>" " THEN Q$(1,1)=""; GOTO 7715
7730 IF POS("S"=X4$)=0 THEN EXIT 99 ELSE EXIT 
7799 RETURN 
7900 REM **************************
7910 IF MID(X2$,1,1)="+" THEN P=POS($1B02$=V0$(2)); IF P=0 THEN GOTO 7950 ELSE V0$=V0$(1,P)+" "+X2$(2)+V0$(P+1); GOTO 7990
7920 IF Q$>"" THEN P=POS($1B02$=V0$(2)); V0$=V0$(1,4)+X2$+V0$(P+1); GOTO 7990
7925 P=POS($1B02$=V0$),L0=21; L0=ASC(V0$(P+3)); IF POS("W"=X4$)=0 AND (L0<21 OR L0>23) THEN L0=21 ELSE L0=L0-1
7930 V0$=$1B0200$+CHR(L0)+X2$+V0$
7960 P=POS("|"=V0$); IF P>0 THEN P1=POS(" "=V0$(P)+" ")-1; V0$=V0$(1,P-1)+A0$+V0$(P+1,P1)+A1$+V0$(P+P1+1); GOTO 7960
7995 RETURN 
8000 REM ******OPTIONS NO RESPONSE OR RETURN TEXT TO CALLIING PROG*****
8005 PRINT V0$,
8015 IF POS("Q"=X4$)=0 THEN CALL "ZZINPT","",X1$,X0,"",X3$,X4$,X1,X2,X3,X4,"",X6$,X7$,L0$,L1$,L2$,L3$,Y1$,A9$,Q4$
8050 RETURN 
8100 REM *******SOFT PROMPTS************
8104 IF %GUI THEN GOTO GUI_PROMPT
8105 GOSUB 8700; X9=0; IF POS("*"=MID(X1$,154,6))>0 THEN GOSUB 8500
8110 REM IF M0=0 THEN READ RECORD (D0,SIZ=1,TIM=0,ERR=8111) Q$
8115 IF X2$>"" THEN GOSUB 7900
8120 PRINT @(0,P_L22),'CE',V0$,
8130 GOSUB 8200; IF C0<0 THEN GOTO 8130 ELSE C0=C0-1
8135 P=POS(STR(C0:"000")=Q5$,3); IF P=0 THEN PRINT 'RB',; GOTO 8130 ELSE P=INT(P/3),P=NUM(Q3$(P*3+1,3),ERR=7600)
8137 IF POS("P"=MID(P$,289+C0*3,3))>0 THEN Q$=P$(324+C0*35,6); CALL "ZZPASW",X1$,"",Q$,"00",70,23,O; IF O<>0 THEN GOTO 8100
8140 IF POS(STR(C0:"000")=Q4$,3)>0 THEN GOSUB 8300; IF V0>0 THEN IF S0=2 THEN EXITTO 8400 ELSE GOTO 8100
8145 IF POS(STR(C0:"000")=S0$,3)>0 THEN GOSUB 8800; IF C0<0 THEN IF S0<>2 THEN GOTO 8100 ELSE EXITTO 8400
8190 C0=P; RETURN 
8200 REM ***********************
8202 IF M0=0 THEN IF MID(X1$,338,2)<>"  " THEN Q$=ATH(X1$(338,2)),X1$(338,2)=""; GOTO 8210
8205 PRINT @(P9-1,P_L23),; IF M0=0 THEN READ RECORD (D0,SIZ=1,TIM=T,ERR=8850)Q$ ELSE GOSUB 8250
8207 IF Q$="" THEN GOTO 8205
8210 IF Q$=$0D$ THEN C0=1,X3=C0; GOTO 8240 ELSE IF Q$=$03$ AND MID(X1$,47,1)="1" THEN EXIT 66
8211 IF Q$=$10$ THEN IF TCB(88) THEN CALL "*conv.tbd/tf_control" ELSE CALL "ZZSCRN",X1$,""; GOTO 8205 ELSE IF Q$=$05$ THEN EXIT 67 ! <plh>
8212 X8$=Q$,C0=-1,P=POS(X8$=D2$,6); IF P>0 THEN GOTO 8235 ELSE IF POS("C"=X4$+X5$)>0 OR POS("L"=X5$)>0 THEN P=POS(Q$=Q6$); IF P>0 THEN C0=NUM(Q5$((P-1)*3+1,3))+1,X3=C0; IF C0=VIEW_IMAGE_CO THEN GOTO 8236 ELSE GOTO 8240 ELSE IF ASC(Q$)>90 THEN Q$=CHR(ASC(Q$)-32); GOTO 8212
8213 PRINT 'RB',; GOTO 8200
8225 Q$=""; IF M0=0 THEN READ RECORD (D0,SIZ=1,TIM=1,ERR=8235)Q$ ELSE GOSUB 8250
8227 IF X8$="" THEN IF Q$=$03$ THEN EXIT 66
8230 X8$=X8$+Q$; IF LEN(X8$)>6 THEN GOTO 8235 ELSE P=POS(X8$+Z9$(1,6-LEN(X8$))=D2$,6); IF P=0 THEN GOTO 8225
8235 IF Q$="" THEN PRINT 'RB',; GOTO 8200 ELSE IF LEN(X8$)>6 THEN PRINT 'RB',; RETURN ELSE P=POS(X8$+Z9$(1,6-LEN(X8$))=D2$,6); IF P=0 THEN GOTO 8225 ELSE C0=INT(P/6)+1,X3=C0
8236 IF C0=VIEW_IMAGE_CO THEN GOSUB VIEW_IMAGES; C0=0,X3=0; GOTO 8200
8245 RETURN 
8255 CALL "ZZDEMO",X1$,1,D0,Q$,M0; RETURN 
8290 RETURN 
8300 REM ***********************
8305 Q$=FNS$(P$(82+C0*16,16)),V$=""; PRINT @(0,P_L22),'CE',
8310 IF POS("W"=X4$)>0 THEN CALL "ZZPROM","V AW2PIE",X1$,0,V$,"","",14; V$=V$+" "+Q$; GOTO 8316
8315 CALL "ZZPROM","V",X1$,0,V$,"","",0; V$=V$+" "+Q$
8318 IF POS("W"=X4$)>0 THEN CALL "ZZPROM","Y AW2PIE",X1$,V0,V$,Q$,"",15; V$=V$+" "+Q$; GOTO 8321
8320 CALL "ZZPROM","Y",X1$,V0,V$,Q$,"",0
8390 RETURN 
8400 REM *******OPTIONS: HELP PROMPTS *********
8410 Q$="CDH"; IF POS("M"=X4$)>0 THEN Q$=Q$+"M"
8420 CALL "ZZSLCT",X1$,Q$,"","",Q2$,"",H9$,Y0,C0,Y1
8440 C0=NUM(Q5$(C0*3+1,3)); GOSUB 8135; IF C0<0 THEN GOTO 8420
8490 X0=C0; GOTO 9900
8500 REM *******"CHECK BUFFER CHARACTER FOR VALID ANS *******
8515 X1$(338,2)="",X4=0; READ RECORD (D0,SIZ=1,TIM=0,ERR=7780)Q$
8520 C0=POS(Q$+$0000000000$=D2$); IF C0=0 THEN GOTO 8550 ELSE C0=INT(C0/6)
8525 P=POS(STR(C0:"000")=Q5$,3); IF P>0 THEN EXITTO 8135
8550 IF POS("C"=X4$+X5$)>0 OR POS("L"=X5$)>0 THEN P=POS(Q$=Q6$); IF P>0 THEN C0=NUM(Q5$((P-1)*3+1,3)); EXITTO 8135 ELSE IF ASC(Q$)>90 THEN Q$=CHR(ASC(Q$)-32); GOTO 8550
8560 X1$(338,2)=HTA(Q$)
8580 RETURN 
8700 REM ***********************
8710 T0$=FNS$(X1$(169,3)),D0$="",D0$=FID(D0,ERR=8711)
8715 CLOSE (D0); IF LEN(T0$)=2 THEN OPEN (D0)T0$ ELSE CALL "ZZDEMO",X1$,0,D0,Q$,M0
8740 RETURN 
8750 REM ***********************
8755 CALL "ZZPASW",X3$,"","TMDATA","00",70,22,O
8805 Q$=""
8807 IF %GUI THEN GOTO GUI_SELECT
8810 CALL "ZZPROM","X0ZZPROM",X1$,0,Q$,"","R",0; PRINT @(0,P_L22),'CE',@(0,P_L23),Q$,":",; Q=LEN(Q$)+2
8830 DIM A4$(3); CALL "ZZENTR","ZX",A{ALL},A4$,"",X1$,Q,P_L23,1,3,C0,"","","","","","",""; IF C0<0 THEN RETURN 
8840 IF POS("V"=X4$)=0 OR A4$="" THEN EXITTO 1580 ELSE P=-1,X1=NUM(A4$)
8845 RETURN 
8850 REM ***********************
8860 IF MID(X1$,78,1)<>"1" OR POS(MID(X1$,185,1)="RUA*")>0 THEN GOTO 8205 ELSE Q=1+POS("M"=X1$(185,1)); CALL "ZZTIME",ERR=8861,X1$,Q,0; T9=0
8864 GOTO 8205
8890 RETURN 
8910 DEF FNS$(Z0$)=Z0$(1,POS("    "=Z0$+"    ")-1)
9000 REM ********ERROR HANDLING***************
9020 EXIT ERR
9021 ESCAPE 
9310 IF MID(X1$,47,1)="1" THEN EXIT 66 ELSE RETURN 
9510 IF POS("V"=X4$)=0 OR Q4$="" THEN GOTO 1580 ELSE X0=-1,X1=NUM(Q4$,ERR=1580); GOTO 9900
9900 REM *********EXIT PROGRAM**************
9905 IF POS("{"=X0$)=0 THEN X1$(29,1)=""
9910 IF POS("Q"=X4$)=0 AND POS("R"=X4$)=0 THEN PRINT @(0,P_L22),'CE',
9920 CLOSE (F0,ERR=9921)
9940 EXIT 
9999 END 
10000 GUI_PROMPT:! Prompt using GUI box
10005 CALL "[wdx]*windx.utl;get_lwd",_L$; _L$=SUB(_L$,"in\WindX","in\lib\_bmp\db_logo.ico") ! SSP 226398
10010 GOSUB GUI_WINDOW_ADD
10200 ! Display prompt
10201 IF %ZZCOMP_WIN_ID THEN RR=78 ELSE RR=98 ! SSP 226398
10205 PRINT @(0,FIRST_LINE),'CE','IMAGE'("FRAME"),'FRAME'(@X(0),@Y(FIRST_LINE-1),@X(RR),@Y(FIRST_LINE+3),-2), ! SSP 226398
10207 X2$=STP(MNEMONIC X2$),P$(12,65)=STP(MNEMONIC P$(12,65))
10210 PRINT 'BLACK','FONT'("MS Sans Serif",1),'TEXT'(@X(1),@Y(FIRST_LINE),STP(X2$)),'TEXT'(@X(1),@Y(FIRST_LINE+1),STP(P$(12,65))), ! Display prompt info SSP 226398
10211 ! PRINT 'CS','FONT'("Arial",1.25,"B"),'TEXT'(@X(1),@Y(0),STP(X2$)),'TEXT'(@X(1),@Y(1),STP(P$(12,65))), ! Alternative we played with, had issues with BR,ER mnuemonics
10215 CURR_ID=20000,BUTTON_COL=0,BUTTON_LINE=FIRST_LINE+3.5,BUTTONS_DONE=0,BUTTON_WIDTH=10,DOWN_ARROW_INDEX=0,UP_ARROW_INDEX=0 ! buttons will start at ctl id 20000 and in column one, line 2, set button width here SSP 226398
10220 DIM BUTTON_NAME$(208),ARROW_NAME$(64),ARROW_TEXT$(64); BUTTON_NAME$(1)="Enter",BUTTON_NAME$(17)="F1",BUTTON_NAME$(33)="F2",BUTTON_NAME$(49)="F3",BUTTON_NAME$(65)="F4",BUTTON_NAME$(81)="F5",BUTTON_NAME$(97)="F6",BUTTON_NAME$(113)="F7",BUTTON_NAME$(129)="F8",BUTTON_NAME$(145)="F9",BUTTON_NAME$(161)="F10",BUTTON_NAME$(177)="F11",BUTTON_NAME$(193)="F12"; ARROW_NAME$(1)="Up",ARROW_TEXT$(1)="Previous",ARROW_NAME$(17)="Down",ARROW_TEXT$(17)="Next",ARROW_NAME$(33)="Left",ARROW_NAME$(49)="Right" ! This may be moved to a global set in startup or ZSTART or tffunction.def
10235 MATCH_LIST$="" ! build list in format of {ctl value}[ 3 digit C0 value + 3digit select value + B_OPT$](single letter to match) as we build the buttons, we can easily search this list later to get select value & options if needed.
10250 FOR B_INDEX=0 TO 10
10255 B_TEXT$=STP(P$((B_INDEX*16)+82,16)); B_OPT$=P$(B_INDEX*3+291,3); B_KEY$=P$(B_INDEX*3+258,3),FKEY_TEXT$=BUTTON_NAME$((B_INDEX*16)+1,16),C0_INDEX=B_INDEX
10260 IF UCS(B_TEXT$)="(DOWN ARROW)" THEN DOWN_ARROW_INDEX=B_INDEX ELSE IF UCS(B_TEXT$)="(UP ARROW)" THEN UP_ARROW_INDEX=B_INDEX
10270 IF B_TEXT$<>"" AND POS("Q"=B_OPT$)=0 THEN {
10275 GOSUB ADD_BUTTON
10280  }
10285 NEXT B_INDEX
10290 IF DOWN_ARROW_INDEX<>0 THEN B_TEXT$=STP(ARROW_TEXT$(17,16)); B_OPT$=P$(DOWN_ARROW_INDEX*3+291,3); B_KEY$=P$(DOWN_ARROW_INDEX*3+258,3),FKEY_TEXT$=STP(ARROW_NAME$(17,16)),C0_INDEX=DOWN_ARROW_INDEX; GOSUB ADD_BUTTON
10292 IF UP_ARROW_INDEX<>0 THEN B_TEXT$=STP(ARROW_TEXT$(1,16)); B_OPT$=P$(UP_ARROW_INDEX*3+291,3); B_KEY$=P$(UP_ARROW_INDEX*3+258,3),FKEY_TEXT$=STP(ARROW_NAME$(1,16)),C0_INDEX=UP_ARROW_INDEX; GOSUB ADD_BUTTON
10299 ! 
10300 ! receive & process input
10301 IF NOT(%ZZCOMP_WIN_ID) THEN MX=MAX(LEN(STP(X2$)),LEN(STP(P$(12,65)))),MX-=INT(LEN(X2$)/6+2),RRR=(BUTTONS_DONE*10)+5,RRR=MAX(RRR,MX),CCC=INT((100-RRR)/2),TT=INT((CC-RRR)/2); PRINT 'SIZE'(RRR,7),'MOVE'(TT,DY); PRINT (0,ERR=*NEXT)'IMAGE'(DELETE "FRAME"),'IMAGE'("FRAME"),'FRAME'(@X(0),@Y(FIRST_LINE-1),@X(RRR-2),@Y(FIRST_LINE+3),-2),; PRINT 'BLACK','FONT'("MS Sans Serif",1),'TEXT'(@X(1),@Y(FIRST_LINE),STP(X2$)),'TEXT'(@X(1),@Y(FIRST_LINE+1),STP(P$(12,65))), ! Display prompt info   SSP226398
10305 ! Evaluate input, check match_list, if not found loop back, else set X0 to selection and I_OPT$ to options for that selection
10310 VALID_INPUT=0
10315 REPEAT 
10316 IF %ZZCOMP_WIN_ID THEN PRINT 'GOTO'(%ZZCOMP_WIN_ID), ! SSP 199634
10320 IN$=""; OBTAIN (0,ERR=*NEXT,SIZ=1)@(0,FIRST_LINE+0),'CURSOR'("OFF"),'ME',IN$,'MN'; CTL_IN=CTL; IF CTL<0 AND CTL>-1000 THEN CALL "*control"; GOTO *SAME ! SSP 199634
10330 IF IN$<>"" THEN {! they typed a letter
10335 ITMP=POS("("+UCS(IN$)+")"=MATCH_LIST$); IF ITMP<>0 THEN MATCH$=MID(MATCH_LIST$,ITMP-10,9),VALID_INPUT=1
10350  } ELSE {! they hit a control key
10354 ! they pressed a button 
10355 IF CTL_IN>=20000 AND CTL_IN<=20010 THEN ITMP=POS("{"+STR(CTL_IN)+"}"=MATCH_LIST$); IF ITMP<>0 THEN MATCH$=MID(MATCH_LIST$,ITMP+8,9); VALID_INPUT=1 ! 
10359 ! They hit return or a function key
10360 IF CTL_IN>=0 AND CTL_IN<=10 THEN ITMP=(CTL_IN*3)+258; IF STP(P$(ITMP,3))<>"" THEN MATCH$=STR(CTL_IN:"000")+P$(ITMP,3)+P$(ITMP+33,3),VALID_INPUT=1 ! get info directly from p$
10364 ! They hit the down arrow
10365 IF CTL_IN=-1012 AND DOWN_ARROW_INDEX<>0 THEN ITMP=(DOWN_ARROW_INDEX*3)+258; IF STP(P$(ITMP,3))<>"" THEN MATCH$=P$(ITMP,3)+P$(ITMP+33,3),VALID_INPUT=1 ! get info directly from p$
10369 ! they hit the up arrow
10370 IF CTL_IN=-1011 AND UP_ARROW_INDEX<>0 THEN ITMP=(UP_ARROW_INDEX*3)+258; IF STP(P$(ITMP,3))<>"" THEN MATCH$=P$(ITMP,3)+P$(ITMP+33,3),VALID_INPUT=1 ! get info directly from p$
10375 IF CTL_IN=-1010 THEN PRINT 'GOTO'(%ZZCOMP_WIN_ID),'MOVE'(5,5), ! SSP 286997 reposition the prompt dialog window within view of the user
10380  }
10390 UNTIL VALID_INPUT
10399 ! 
10400 ! Analyze MATCH$
10415 C0=0,C0=NUM(MID(MATCH$,1,3),ERR=*NEXT)
10510 GOSUB GUI_WINDOW_DROP
10520 GOTO 8135
10595 RETURN 
10599 ! 
10600 GUI_SELECT:! Select field number in GUI
10605 GOSUB GUI_WINDOW_ADD
10610 CALL "ZZPROM","X0ZZPROM",X1$,0,Q$,"","R",0; PRINT @(0,FIRST_LINE+0),'CE',Q$+":",; Q=LEN(Q$)+2
10620 INPUT @(Q+1,FIRST_LINE+0),A4$
10650 X1=NUM(A4$,ERR=GUI_SELECT_ERROR); IF X1=0 THEN GOTO GUI_SELECT_ERROR
10660 P=-1
10690 GOSUB GUI_WINDOW_DROP
10695 RETURN 
10696 GUI_SELECT_ERROR:GOSUB GUI_WINDOW_DROP; EXITTO 1580
10699 ! 
10700 GUI_MESSAGE:! Open window & display message, leave window open
10705 GOSUB GUI_WINDOW_ADD
10710 PRINT @(0,FIRST_LINE+0),'CE',@(0,FIRST_LINE+1),PAD(V0$,78,2),
10715 PRINT V0$,
10780 PRINT (0)'GOTO'(CURR_WIN), ! Return control to the main window , JIR
10785 ! PRINT (0,ERR=*NEXT)'WHITE','BACKGR','BLUE',
10795 RETURN 
10799 ! 
11000 ADD_BUTTON:! add a button given MATCH_LIST,CURR_ID, B_KEY$,B_OPT$,B_TEXT$,FKEY_TEXT$,C0_INDEX, uses BUTTON_COL, BUTTON_WIDTH,BUTTONS_DONE
11010 MATCH_LIST$+="{"+STR(CURR_ID)+"}["+STR(C0_INDEX:"000")+B_KEY$+B_OPT$+"]"; IF POS("("+MID(B_TEXT$,1,1)+")"=MATCH_LIST$)=0 THEN MATCH_LIST$+="("+MID(B_TEXT$,1,1)+")"; B_TEXT$="&"+B_TEXT$ ! If not already on list, add to match list and then set first letter as ALT+key
11015 BUTTON CURR_ID,@(BUTTON_COL,BUTTON_LINE,BUTTON_WIDTH,2)=STP(FKEY_TEXT$)+$0A0D$+B_TEXT$,MSG=STP(B_TEXT$,3,"&"),FNT="MS Sans Serif,1",TIP=STP(FKEY_TEXT$)+" = "+STP(B_TEXT$,3,"&") ! CURR_ID'TEXTCOLOR$="Light Blue" ! JIR SSP 226398
11020 BUTTON_COL+=BUTTON_WIDTH,CURR_ID+=1,BUTTONS_DONE+=1
11095 RETURN 
11099 ! 
11100 GUI_WINDOW_ADD:! setup window for GUI functions
11105 IF %ZZCOMP_WIN_ID THEN FIRST_LINE=22,CURR_WIN=%ZZCOMP_WIN_ID; GOTO GUI_WINDOW_ADD_END ELSE FIRST_LINE=0
11110 WIN_ID=200,IDTMP$=FIN(0),CURR_WIN=DEC($00$+IDTMP$(10,1))
11115 ! calculate location for dialogue box
11120 OBJ$=OBJ(0),MSE$=MSE
11125 DX=INT(MAX(0,DEC($00$+OBJ$(21,2))/DEC($00$+MSE$(10,1))))+1; DY=INT(MAX(1,DEC($00$+OBJ$(23,2))/DEC($00$+MSE$(11,1))))+DEC($00$+OBJ$(11,2))-1
11130 ! build window
11134 PRINT (0,ERR=*NEXT)'DROP'(WIN_ID),
11135 ! PRINT 'B?','DIALOGUE'(8,5,78,20,WIN_ID,OPT="hcZ"); GOTO 11143 ! For testing this line is helpful
11136 CC=%NOMAD_XMAX/%NOMAD_XCHAR,LL=%NOMAD_YMAX/%NOMAD_YCHAR,DX=INT((CC-100)/2),DY=INT((LL-10)/2),OPT$="czZ^",INIT_TXT$=%X3_COMP$+" - "+%X3_COMP_NAME$,INIT_TXT$=%TF_TITLE$+" - "+%TF_PROG$ ! SSP 226398
11137 IF %NOMAD_XMAX=0 THEN DX=2,DY=14
11138 IF LEN(INIT_TXT$)>256 THEN INIT_TXT$=%X3_COMP$+" - "+STP(%X3_COMP_NAME$)
11140 PRINT (0,ERR=*NEXT)'B?','BLACK','DIALOGUE'(DX,DY,100,7,WIN_ID,INIT_TXT$,OPT=OPT$) ! SSP 226398
11180 GUI_WINDOW_ADD_END:
11195 RETURN 
11199 ! 
11200 GUI_WINDOW_DROP:! Drop the GUI window
11210 IF %ZZCOMP_WIN_ID THEN GOSUB DROP_BUTTONS; PRINT (0,ERR=*NEXT)'IMAGE'(DELETE "FRAME"), ELSE PRINT (0,ERR=*NEXT)'DROP'(WIN_ID),
11214 PRINT (0,ERR=11216)'B?','BLACK',; GOTO 11216 ! for now  try always restoring to windows style
11215 IF %ZZCOMP_WIN_ID THEN PRINT (0,ERR=*NEXT)'B?','BLACK', ELSE PRINT (0,ERR=*NEXT)'BACKGR','BLUE','WHITE',
11295 RETURN 
11299 ! 
11300 DROP_BUTTONS:! when in ZZCOMP window, we aren't dropping the window, but we need to clean up the buttons and text
11310 PRINT @(0,FIRST_LINE),'CE',
11320 FOR BINDEX=20000 TO CURR_ID
11330 BUTTON REMOVE BINDEX,ERR=*NEXT
11350 NEXT BINDEX
11395 RETURN 
11399 ! ***********************************************************
12000 SETUP_FOR_IMAGES:! Add View image option to prompt & F11 to D2$ string
12005 IF NUL(%WDX$) OR NOT(%HAS_IMAGE_LIB) THEN RETURN ! Only for Windx
12010 ! Add to V0$, if 5 things in V0$ then add to next line, else just add on the end
12015 IF MID(%IL_IMAGE_TYPE$,1,1)="R" AND MID(%IL_IMAGE_TYPE$,1,3)<>"RFQ" THEN TYPE$="Audit Rpt" ELSE TYPE$="Images"
12020 IF POS(ESC+"BR"=V0$,1,0)>=5 OR LEN(V0$)>93 AND POS($020017$=V0$)=0 THEN V0$(4,1)=$16$; V0$+=" "+ESC+$020017$+ESC+$0101$+ESC+"BRF11"+ESC+"ER View "+TYPE$ ELSE V0$+=ESC+"BRF11"+ESC+"ER View "+TYPE$
12025 P9+=15,Q6$+="V",Q5$+="020"
12030 D2$+=$00007A000000$,VIEW_IMAGE_CO=INT(LEN(D2$)/6)
12095 RETURN 
12099 ! **************************************************************
12100 VIEW_IMAGES:! Call panel to view the images
12145 IF MID(%IL_IMAGE_TYPE$,1,1)="R" AND MID(%IL_IMAGE_TYPE$,1,3)<>"RFQ" THEN TYPE$="ILGVWA" ELSE TYPE$="ILGVWM"
12150 CALL TYPE$,ERR=*NEXT,%IL_IMAGE_TYPE$,%IL_IMAGE_KEY$
12195 RETURN 
12199 ! ******************************************************
56000 ! "199634-Program GLGRDS General Ledger Detail Transaction Report the 
56010 ! "226398-Modify ZZPROM to display GUI like prompts                   
56011 ! "228852-Remove the print alignment questions in all areas since they
56012 REM "286997-Batch update prompts hidden from view; users are not able to
