0010 REM "Printer special effects output <ZZPTRE>
0035 REM "3.6 - 05/11/92 - 15.5
0040 REM "Copyright 1992 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1015 REM "X0$=PRINTER TYPE, X1$=SPECIAL EFFECT, X0=DEVICE
1020 ENTER X3$,X0$,X1$,H0$,H1$,H2$,H1,H2,H3,H4,H5
1025 X1$=FNS$(X1$)
1030 IF LEN(X1$)>3 THEN IF X1$(LEN(X1$)-2)="OFF" THEN H0=1,X1$=X1$(1,LEN(X1$)-3)
1090 CLOSE (14); OPEN (14)"ZT0"
1095 F0=14
1200 DIM Q$(14); Q$(1)=X0$
1220 Q$(9)=X1$
1240 READ (F0,KEY=Q$,DOM=9900)Q$,Q0,Q1
1245 IF Q0<>0 THEN IF Q0>0 THEN H2=Q0 ELSE H2=H2*ABS(Q0)
1246 IF Q1<>0 THEN IF Q1>0 THEN H3=Q1 ELSE H3=H3*ABS(Q1)
1250 IF H0=1 THEN P0$=Q$(65,30) ELSE P0$=Q$(35,30)
1290 GOSUB 5100
1940 GOTO 9900
5100 P0$=FNS$(P0$)
5101 P=POS("1B"=P0$); IF P>0 THEN P0$(P,2)="9B"; GOTO 5101
5102 P=POS("ES"=P0$); IF P>0 THEN P0$(P,2)="1B"; GOTO 5102
5105 PRINT (H1,ERR=5106)ATH(P0$),; GOTO 5190
5110 FOR I=1 TO LEN(P0$) STEP 2
5120 IF P0$(I,2)<>"  " THEN IF POS(P0$(I,2)="ES1B",2)<>0 THEN PRINT (H1)'ES', ELSE IF P0$(I,1)=" " THEN PRINT (H1)P0$(I+1,1), ELSE PRINT (H1)ATH(P0$(I,2)),
5124 GOTO 5180
5125 X$="+ ("+F1$+")"; CALL "ZZPROM","X4ZZPRIN",X3$,X4,X$,"","",0; IF X4=0 THEN RETRY ELSE IF X4=2 THEN GOTO 5630
5130 SETERR 9000; EXITTO 5635
5185 NEXT I; SETERR 9000
5190 RETURN 
8900 DEF FNS$(Z9$)=Z9$(1,POS("  "=Z9$+"  ")-1)
9940 EXIT 
9999 END 
