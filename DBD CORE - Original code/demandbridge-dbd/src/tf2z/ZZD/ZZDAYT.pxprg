0010 REM "SPECIAL INTERIM ROUTINE <ZZDAYT>
0035 REM "This software contains trade secrets and proprietary information"
1000 ENTER D0$,D0
1010 SETERR 9000
1060 DIM D[12]; D[1]=31,D[2]=28,D[3]=31,D[4]=30,D[5]=31,D[6]=30,D[7]=31,D[8]=31,D[9]=30,D[10]=31,D[11]=30,D[12]=31
1100 REM "D0 = NUMBER OF DAYS
1120 Q1=NUM(D0$(5,2)),Q0=NUM(D0$(3,2)),Q2=NUM(D0$(1,2),ERR=1121); GOTO 1150
1125 F0=1
1130 Q2=(ASC(D0$(1,1))-65)*10+1900+NUM(D0$(2,1))
1190 GOTO 5000
1200 REM "
1210 W0=D0
1220 Q1=Q1+D0
1240 IF Q1>0 THEN GOTO 1300
1245 Q0=Q0-1; IF Q0=0 THEN Q2=Q2-1,Q0=12
1250 X=Q0,X1=Q2; GOSUB 8100
1260 Q1=Q1+Q
1270 GOTO 1240
1300 REM "
1310 X=Q0,X1=Q2; GOSUB 8100
1320 IF Q1<=Q THEN GOTO 2000
1330 Q0=Q0+1,Q1=Q1-Q; IF Q0=13 THEN Q0=1,Q2=Q2+1
1350 GOTO 1310
2000 REM "
2020 IF F0=0 THEN D1$=STR(Q2:"00")+STR(Q0:"00")+STR(Q1:"00") ELSE D1$=CHR(INT((Q2-1900)/10)+65)+STR(MOD(Q2,10))+STR(Q0:"00")+STR(Q1:"00")
2050 GOTO 9900
3300 REM "CALC JULIAN DATE FOR M D Y = Q0,Q1,Q2
3310 Z0$="000031059090120151181212243273304334"
3320 Q=NUM(Z0$((Q0-1)*3+1,3))+Q1; IF Q0>2 THEN Q=Q+1-SGN(FPT(Q2/4))
3330 W1=Q+Q2*1000; RETURN 
4000 REM "Calculate # of days between D0$ and D1$
4010 D$=D0$; GOSUB 7000; X=D
4020 D$=D1$; GOSUB 7000
4030 D0=D-X
4090 GOTO 9900
5000 REM 
5005 D7$="Sunday   Monday   Tuesday  WednesdayThursday Friday   Saturday"
5010 D$=D0$; GOSUB 7000
5030 D0=MOD(D-715290,7)+1,D1$=FNS$(D7$(D0*9-8,9))
5090 RETURN 
6000 REM "RETURN DATE-A
6010 GOSUB 3300; W1=W0
6020 GOSUB 5000; W2=D0
6030 GOSUB 8100; W3=Q
6190 GOTO 9900
7000 REM " Convert YYYYMMDD to NNNNNNN
7001 REM "uses D$, D - assumes D() array is set - Algorithm supplied by Dennis Young
7010 D=0; IF LEN(D$)=6 THEN GOSUB 7500
7020 FLOATING POINT 
7030 D1=NUM(D$(1,4),ERR=7090),D2=NUM(D$(5,2),ERR=7090),D3=NUM(D$(7,2),ERR=7090)
7040 IF D1<1752 THEN GOSUB 7100 ELSE IF D1>1752 THEN GOSUB 7200 ELSE GOSUB 7100; IF D=0 THEN GOSUB 7200
7090 PRECISION 2
7095 RETURN 
7100 REM "From 01/01/0001 to 09/02/1752
7110 GOSUB 7800
7120 IF D7=3 THEN D[2]=29
7130 GOSUB 7810
7140 IF D>0 THEN D=D4*146100+D5*36525+D6*1461+D7*365+D
7150 IF D>639798 THEN D=0
7190 RETURN 
7200 REM "From 09/14/1752 to 12/31/9999
7210 GOSUB 7800
7220 IF D7=3 AND (D6<24 OR D5=3) THEN D[2]=29
7230 GOSUB 7810
7240 IF D>0 THEN D=D4*146097+D5*36524+D6*1461+D7*365+D
7250 IF D>639796 THEN D=D+2 ELSE D=0
7290 RETURN 
7500 REM "Convert 6 digit date to "YYYYDDMM" format
7510 D9=NUM(D$(1,2),ERR=7511)+1900; GOTO 7515
7511 D9=(ASC(D$(1,1))-65)*10+1900+NUM(D$(2,1))
7520 D$=STR(D9:"0000")+D$(3,4)
7590 RETURN 
7800 REM "Calculate D4 thru D7
7802 D7=D1-1,D4=INT(D7/400),D7=D7-D4*400,D5=INT(D7/100),D7=D7-D5*100,D6=INT(D7/4),D7=D7-D6*4
7809 RETURN 
7810 REM 
7812 IF D3>D[D2] THEN GOTO 7819
7814 D=D3,D9=D2-1
7816 IF D9>0 THEN D=D+D[D9],D9=D9-1; GOTO 7816
7819 RETURN 
8100 REM "GET MAX # DAYS FOR MONTH X IN Q FOR YEAR X1
8110 Q=31-SGN(POS(STR(X:"00")="0904061102",2))
8120 IF X=2 THEN Q=Q-1-SGN(FPT(X1/4))
8190 RETURN 
8905 REM DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
8910 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
9900 REM 
9910 EXIT 
9999 END 
