1020 ENTER X3$,X4$,L0$,L1$,L2$,X0$,C0$,X1$,X0,X1,X2,X3,X4
3005 X=X3,X3=4,X8$=X1$(X2,X3)+" ",X$=X3$(221,5)
3010 X7$="00101"; IF X8$="     " THEN X8$=X$+" x  " ELSE Q$=X8$; CALL "ZZDISP","TX",Q$,"",X3$,X8$,"",0,0,""; Q$="    "
3040 CALL "ZZINPT","",X3$,0,X0$+C0$,Q$,X2$,X0,X1,X4,5,X8$,X7$+X$+" x  ","",L0$,L1$,L2$,L3$,"","",""; IF X4=5 THEN GOTO 8000 ELSE IF Q$=" " THEN X1$(X2,X3)=""; GOTO 3090 ELSE Q$=Q$(1,POS("  "=Q$+"  ")-1)
3045 IF Q$="" AND POS("X"=C0$)>0 THEN X4=-X4
3048 IF Q$="" THEN GOTO 3090 ELSE REM ON POS(" "<>X1$(X2,X3)) GOTO 3090,3091
3050 Q$=Q$(1,POS("  "=Q$+"  ")-1)
3055 IF Q$(1,1)>"2" THEN Q$="0"+Q$
3056 IF LEN(Q$)=3 THEN Q$=Q$(1,2)+"0"+Q$(3) ELSE IF LEN(Q$)=2 THEN Q$=Q$+"00"
3057 IF LEN(Q$)<4 THEN GOTO 3020
3060 H=NUM(Q$(1,2),ERR=3020),M=NUM(Q$(3,2),ERR=3020); IF LEN(Q$)=4 AND X3$(67,1)="1" THEN IF H<7 AND H>0 THEN H=H+12
3065 IF H<0 OR H>24 OR M<0 OR (M>60 AND X3$(67,1)<>"3") THEN GOTO 3020 ELSE IF X3$(67,1)<>"3" THEN M=M/60*100
3070 IF POS(X3$(205,1)=Q$)>0 AND H<12 THEN H=H+12 ELSE IF H>11 AND POS(X3$(202,1)=Q$)>0 THEN H=H-12
3080 Q$=STR(H*100+M:"0000")
3085 X1$(X2,X3)=Q$
3090 IF ABS(X4)<5 THEN CALL "ZZDISP","T",X1$(X2,X3),"",X3$,"","",X0,X1,X4$
3095 X3=X
9940 EXIT 
9999 END 
