0010 REM "TERMINAL HOLDING PROGRAM <ZZEND>
0035 REM "5.1 - 01/29/03 - 11.833888 - dmm - SSP# 133604
0040 REM "Copyright 2003 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 GOSUB 2000
0055 IF POS("MS"=SYS)=1 THEN PRINT 'CS',; GOTO END_SESSION_6000
0060 IF X3$>"" THEN IF X3$(77,1)<>"T" THEN PRINT 'LF','LF',; GOTO END_SESSION_6000
0100 BEGIN ; OPEN (1)FID(0); CALL "ZZDROP",ERR=0121
0220 PRINT @(0,0),
0230 SETERR 9905
0300 READ RECORD (1,SIZ=1)Q$; PRINT 'RB',; IF Q$<>" " THEN GOTO 0300 ELSE RUN "START"
2000 ! ^ 2000
2010 CALL "ZZUSER",X3$,"X","CSI",0,0
2020 DIM S$(400,"0"); IF X3$>"" THEN X3$=X3$+S$
2030 IF X3$>"" THEN X3$(60,3)="001"; GOSUB 3000
2040 IF X3$="" THEN GOTO 2100 ELSE L0$=X3$(239,1); CALL "ZZLANG",X3$,L0$
2050 IF NOT(%GUI) THEN CALL "ZZPROM","X0ZZEND",X3$,0,L1$,"","",0
2060 IF NOT(%GUI) THEN PRINT 'CS',
2070 IF NOT(%GUI) THEN CALL "ZZDISP","-","1016","",X3$,"","",0,0,X4$
2080 IF NOT(%GUI) THEN PRINT @(20,12),L1$,@(20,14),L0$(58,40),
2090 GOTO CLEAN_FILES
2100 DIM Z$(80,"-"); PRINT 'CS',@(0,10),Z$,@(0,16),Z$,@(20,12),"This terminal is available for use",@(20,14),"Press the space bar to continue:",; Z$=""
2110 CLEAN_FILES:
2120 CLOSE (14); OPEN (14)"ZZPARM"
2130 EXTRACT (14,KEY=FID(0)+"DATE",DOM=2160)D9$
2140 D9$(20,9)=""
2150 WRITE (14)D9$
2160 RETURN 
3000 ! ^ 3000 "UPDATE OPERATOR CODE
3010 RETURN 
6000 ! ^ 6000 "RELEASE CODE
6010 END_SESSION_6000:
6020 H_FID=FFN("FIDNUM")
6030 IF H_FID=-1 THEN CLOSE (14); H_FID=14; OPEN (H_FID,ERR=6080)"FIDNUM"
6040 EXTRACT (H_FID,KEY=MID(FID(0),1,2),DOM=6080)D9$
6050 D9$=""
6060 WRITE (H_FID)D9$
6070 CLOSE (H_FID)
6080 RELEASE 
6090 ! EXIT FOR SESSION
9900 ! ^9900
9910 BEGIN 
9920 IF X3$>"" THEN IF X3$(77,1)="U" THEN GOTO END_SESSION_6000
9930 SETERR 9940; RUN "ZSTART"
9940 SETERR 9950; RUN "**"
9950 SETERR 9955; RUN "P4UTIL"
9960 END 
9999 END 
