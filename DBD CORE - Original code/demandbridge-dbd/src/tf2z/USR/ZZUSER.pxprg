0010 REM "Authorize System for terminals <ZZUSER>
0035 REM "4.1 - 05/08/97 - 15.51
0040 REM "Copyright 1996 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1020 SETERR 1025; ENTER X3$,X0$,S1$,U0,X9
1025 SETERR 9000
1026 OPSYS$="U"; IF X3$>"" THEN IF X3$(77,1)<>"U" AND POS("MS"=SYS)=1 THEN OPSYS$="D" END_IF ELSE IF POS("MS"=SYS)=1 THEN OPSYS$="D"
1027 ! 0=%SSN; IF OPSYS$="D" THEN CALL "ZZNTSN",X3$,%SSN,FLAG$,MASTER_SSN; IF FLAG$="Y" THEN S0=MASTER_SSN ! <mk> SSN
1030 DIM Z$(9,"0"),Z0$(10,$00$),S$(12); PRINT 'RB',; S9$="SEC"+STR(S0:Z$); CALL "ZZCRYP",X3$,S1$,"","E",S9$,A{ALL},C8$,X9; IF X3$>"" THEN F0=NUM(X3$(60,3)) ELSE F0=14
1050 EXIT ! No longer needed
1088 IF F0=0 THEN F0=14
1095 CLOSE (F0); OPEN (F0)"ZZPARM"; IF X0$="?" OR X0$="??" OR X0$="X" OR X0$="" THEN GOSUB 2500; GOTO 9900 ELSE IF X0$(1,1)="!" THEN X0$=X0$(2); GOTO 2000
1100 EXIT 89
2000 REM "SET SYSTEM PARAMETERS
2080 A$=S9$(4)+"U"+STR(U0:"000")
2090 A$=A$+X0$+$CC$
2130 CALL "ZZCRYP",X3$,S1$,"","E",A$,A{ALL},C9$,X9
2140 CLOSE (F0); OPEN (F0)"ZZPARM"; WRITE RECORD (F0,KEY=C8$)C9$
2290 GOTO 9900
2500 REM 
2520 EXTRACT RECORD (F0,KEY=C8$)C9$; C9$=C9$(1,POS(Z0$=C9$+Z0$)-1)
2540 CALL "ZZCRYP",X3$,S1$,"","U",A$,A{ALL},C9$,X9
2545 P=POS($CC$=A$),C1$=A$(P+1),A$=A$(1,P-1)
2560 U0=NUM(A$(11,3)),X9=POS(FID(0)=A$(14))
2561 U0=5
2570 IF X0$="?" OR X0$="??" THEN X0$=C1$; GOTO 7000 ELSE IF X0$="X" THEN GOTO 2700
2575 Q$=FID(0),X8=LEN(C1$)/(LEN(Q$)+12); IF POS(Q$=C1$,LEN(Q$)+12)=0 THEN X8=X8+1
2580 REM " pvx IF X9>0 OR X8>U0 THEN EXIT 89
2600 REM "UPDATE RECORD
2602 C2$=DAY; C2$=C2$(7,2)+C2$(1,2)+C2$(4,2)+STR(INT(100*TIM):"0000")+"  "
2605 IF POS(Q$=C1$,LEN(Q$)+12)>0 THEN GOTO 2680 ELSE C1$=C1$+Q$+C2$
2610 A$=A$+$CC$+C1$
2620 GOTO 2130
2690 RETURN 
2700 REM "REMOVE ENTRY
2720 Q$=FID(0),P=POS(Q$=C1$,LEN(Q$)+12); IF P=0 THEN GOTO 2780
2725 C1$=C1$(1,P-1)+C1$(P+12+LEN(Q$)),A$=A$+$CC$+C1$
2730 GOTO 2130
2740 GOTO 9900
7000 REM "
7010 IF C1$="" THEN GOTO 7090
7015 GOTO 7090
7020 FOR X=1 TO LEN(C1$) STEP 14
7040 PRINT C1$(X,2),"  ",FND$(C1$(X+2,6)),"  ",FNT$(C1$(X+8,4)),"  ",C1$(X+12,2)
7050 NEXT X
7090 EXIT 
8910 DEF FND$(Z9$)=Z9$(3,2)+"/"+Z9$(5,2)+"/"+Z9$(1,2)
8915 DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
9005 CLOSE (F0)
9010 X9=TCB(5)*1000+ERR
9020 EXIT 89
9920 CLOSE (F0)
9940 PRINT 'RB',; EXIT 
9999 END 
