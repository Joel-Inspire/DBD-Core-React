0010 REM "Display Memory Usage Utility <ZZBANK>
0100 I=0; SETERR 0101; ENTER I,X3$
0105 GOSUB 3000
0110 SETERR 9900; I=INT(I); IF I>0 AND I<16 THEN GOTO 0200
0120 FOR I=1 TO 15; B$=TSK(I)
0125 IF B$>"" THEN I9=I; IF POS(FID(0)=B$(5),6)>0 THEN EXITTO 0200
0130 NEXT I; GOTO 9900
0210 I8=I
0220 IF I>15 OR I<1 THEN GOTO 7700 ELSE R=3,C=0; PRINT @(0,3),'CE',
1010 S=BSZ(I),B$=TSK(I); IF S=0 THEN IF C0=0 THEN GOTO 7700 ELSE IF S=0 THEN GOTO 7730
1020 PRINT @(C+1,R),"BANK "+STR(I),@(C,R+1),S:M$," AVAIL ",; IF I=I9 THEN PRINT "/ ",DSZ:M$," =DSZ"
1030 IF LEN(B$)=0 THEN GOTO 1100
1050 FOR K=0 TO LEN(B$)/6-1; S=DEC(B$(K*6+3,2))
1070 PRINT @(C,R+2+K),S:M$,@(C+6),B$(6*K+5,2)
1075 IF Z0>0 THEN GOSUB 3100; PRINT @(C+16,R+2+K),Z0$(146,6),"  ",Q$
1080 NEXT K
1090 IF R+K>T THEN T=R+K
1100 B$=PUB(I); IF LEN(B$)=0 THEN GOTO 1990
1110 R=R+K; FOR K=0 TO LEN(B$)/12-1
1120 S=DEC(B$(K*12+3,2))
1130 PRINT @(C,R+2+K),S:M$,@(C+6),B$(12*K+5,8),
1135 GOSUB 1200; PRINT @(C+24),Q$,
1140 NEXT K
1150 IF R+K>T THEN T=R+K
1190 GOTO 1900
1200 REM "GET PROG
1220 CALL "ZZXPRG",Q$,0,B$(12*K+5,8)
1290 RETURN 
1990 B=B+1,C=C+15; IF MOD(B,5)=0 THEN C=2,Q=Q+T+1,T=2
2010 PRINT @(0,19),"CONFIGURED TERMINALS: ",
2020 B$=TSK(0); FOR I=1 TO LEN(B$) STEP 6; IF B$(I,1)="T" THEN PRINT B$(I,2)," ",
2030 NEXT I
2040 PRINT @(0,20),"THIS IS TERMINAL "+FID(0)
2050 GOTO 7700
3000 REM "
3010 FOR Z0=1 TO 14; Q$=FID(Z0,ERR=3011); IF POS("ZZPARM"=Q$)=4 THEN EXITTO 3030
3020 NEXT Z0; Z0=0
3050 RETURN 
3100 REM "GET TERM RECORD
3110 Z0$="",Q$=""; READ (Z0,ERR=3180,KEY=B$(6*K+5,2)+"      ")Z0$
3120 CALL "ZZXPRG",Q$,0,Z0$(146,6)
3180 RETURN 
7710 CALL "ZZPROM","4",X3$,S3,"","","V",X0; IF S3=2 THEN GOTO 9900 ELSE IF S3<0 THEN IF X0>15 THEN IF C0>0 THEN GOTO 7730 ELSE I=I8; GOTO 0200
7715 IF S3<0 THEN RESET ; C0=0; I=X0; GOTO 0200
7720 IF C0>1 AND S3>1 OR (C0=0 AND S3=0) THEN GOTO 9900
7725 IF S3=1 THEN GOTO 7750
7730 IF C0>0 THEN NEXT T0
7750 C0=1; FOR T0=1 TO 15; I=T0
7760 GOTO 0200
9900 REM "
9930 SETERR 9960
9940 EXIT 
9960 RUN "ZMENU"
9999 END 
