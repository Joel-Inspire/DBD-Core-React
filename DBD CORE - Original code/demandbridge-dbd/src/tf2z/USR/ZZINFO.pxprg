0010 REM "Return File Information <ZZINFO>
0035 REM "5.6 - 08/21/08 - 11.743055 - tma - SSP# 222131
0037 REM "222131-Problem with printing invoices                              
0040 REM "Copyright 2008 DemandBridge, Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0990 REM "F=DEVICE #, R0=RECS USED, R1=TOT RECS, K=KEY, B=B/R, D=DISC
0995 REM "S0=TOTAL SECTORS, S1=STARTING SECTOR, X0=STATUS (0=OK, >0=ERROR)
0996 REM "F$=FILE NAME
1000 REM "
1020 ENTER F,X0,X3$,R0,R1,K,B,D,T0,S0,F$
1040 SETERR 9000; X0=0,X9=0
1100 IF F=0 THEN F=NUM(X3$(60,3)); CLOSE (F); X9=1; GOTO 1250
1200 REM "
1210 IF F=0 THEN GOTO 9800 ELSE F$=FN%FID$(F,ERR=1250); IF LEN(F$)=2 THEN GOTO 9800
1240 GOTO 1300
1250 IF F$="" THEN IF ERR=14 THEN X0=-1; GOTO 9850 ELSE X0=-ERR; GOTO 9850
1255 CLOSE (F); OPEN (F,ERR=9800)F$; X9=1
1260 GOTO 1210
1300 REM "
1310 D=ASC(F$(20,1)),S1=DEC(F$(1,3)),R1=DEC(F$(12,3))
1320 B=DEC(F$(15,2)),T0=ASC(F$(10,1)),K=ASC(F$(11,1)),S0=DEC(F$(17,3))-S1
1325 IF T0<10 THEN IF B=0 AND K>0 THEN T0=T0+1
1330 IF K>0 THEN K=K-4; IF R1>32767 THEN K=K-2
1335 IF T0=11 THEN T0=8
1340 IF K>0 OR UCS(MID(F$,19,1))="O" THEN GOSUB 3000
1350 IF T0=0 THEN R0=0; READ (F,ERR=1351,IND=0)R0; R0=R0+1
1420 F$=STP(F$(4,6)+F$(21,2),1)
1490 GOTO 9900
3000 REM "UNIX RECORDS USED
3010 CLOSE (14); OPEN (14,ERR=3200)F$(4,6)+F$(21,2)
3020 B$=FN%FIN$(14,"NUMREC"); R0=NUM(B$)
3025 CLOSE (14)
3030 IF L9=1 THEN LOCK (F,ERR=*NEXT) ! SSP#222131
3050 IF Q9$>"" THEN ERASE Q9$
3090 RETURN 
3200 REM "LOCKED FILE
3210 IF ERR=0 THEN UNLOCK (F,ERR=3300); L9=1; GOTO 3010
3215 EXIT ERR
3220 CALL "ZZULNK",F$(4,6)+F$(21),F,14,X9,0,0
3230 Q9$=FID(0)+"TMP"; OPEN (14,ISZ=256)Q9$; GOTO 3020
3290 RETURN 
3310 GOTO 9000
4000 REM "TBOS RECORDS
4010 REM "DIM B$(128); GET D,S1,B$
4090 RETURN 
9000 X0=ERR; EXIT ERR
9805 X0=-1
9920 IF X9=1 THEN CLOSE (F)
9940 EXIT 
9999 END 
