0010 REM "Encrypt/Unencrypt Data to Key <ZZCRYP>
0035 REM "4.0 - 07/29/96 - 14.9 - wmz
0040 REM "Copyright 1996 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1010 REM "K$=KEY TO CRYPT, K8$=OPTIONS, A$,A(ALL)=DATA TO CRYPT, K9$=Encrypt, Unencrypt, C9$=ENCRYPTED DATA, X9=result (0=OK)
1015 REM SETERR 01040
1020 ENTER X3$,K$,K8$,K9$,A$,A{ALL},C9$,X9; GOTO 1100
1040 IF X3$="?" THEN CALL "ZZPDOC","ZZCRYP"; EXIT 
1050 EXIT 36
1100 SETERR 9000
1220 IF K9$="E" THEN GOTO 2000 ELSE IF K9$="U" THEN GOTO 2500
1240 EXIT 99
2000 REM "Encrypt data
2010 K0=LEN(K$),C9$="",K9=ASC(K$)+K0
2020 FOR X=1 TO LEN(A$)
2040 C9=ASC(A$(X,1)),C8=ASC(K$(1+MOD(X-1,K0)))
2050 K=C9+C8+K9
2055 IF K>255 THEN K=K-255; GOTO 2055
2080 C9$=C9$+CHR(K),K9=K9+K
2085 IF K9>255 THEN K9=K9-255
2090 NEXT X
2480 GOTO 9900
2500 REM "Unencrypt Data
2510 K0=LEN(K$),A$="",K9=ASC(K$)+K0
2550 FOR X=1 TO LEN(C9$)
2580 C9=ASC(C9$(X,1)),C8=ASC(K$(1+MOD(X-1,K0)))
2620 K=C9-C8-K9
2625 IF K<0 THEN K=K+255; GOTO 2625
2680 A$=A$+CHR(K),K9=K9+C9
2685 IF K9>255 THEN K9=K9-255; GOTO 2685
2690 NEXT X
2980 X9=0; GOTO 9900
9040 X9=ERR; GOTO 9920
9840 X9=-1; GOTO 9920
9910 X9=0
9940 EXIT 
9999 END 
