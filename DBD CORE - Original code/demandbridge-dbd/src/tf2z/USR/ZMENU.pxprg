0010 REM "System Menu Selection Program <ZMENU>
0035 REM "5.7 - 08/27/14 - 8.821388 - crg - SSP# 243030
0036 REM "MOD 2300S -2499 FOR ERROR 1 ON WRITE
0037 REM "243030-Panel issues when GUI panels are executed via CHUI, font    
0040 REM "Copyright 2014 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 BEGIN ; SETESC 9300; SETERR 9000; ENDTRACE 
0120 DEF FNS$(X$)=X$(1,POS("    "=X$+"    ")-1)
0130 DEF FNP(X$)=38-INT(LEN(X$)/2)
0135 DEF FNQ(X0,X1)=X1-LEN(FNS$(L0$(X0,8)))-1
0140 DEF FNR$(X0)=FNS$(L0$(X0,8))+": "
0175 %GUI=0; ERROR_HANDLER ! 191274 - if in ZMENU then this should always be 0 and clear auto error handler
0200 REM "
0205 CALL "ZZTRMI"
0210 CALL "ZZCOMP",ERR=9700,X0$,X1$,X2$,X3$,X4$,X5$,-1,0,0
0212 IF POS("G"=FID(0))=1 THEN BEGIN ; IF MID(X3$,77,1)="T" THEN RELEASE ELSE RUN "ZZMNUG"
0215 G9=POS("      "=X3$(21,6))
0220 F0=NUM(X3$(60,3))-1,T9=ASC(X3$(197,1))-100,T9=T9*60
0360 IOLIST X3$,M1$,X4$,D0$,X$,A9$
0405 DIM Z[NUM(X3$(60,3))],S$(80)
0410 Z$="01O ZMP...  02O ZM1...  03O ZS0...  04O ZM0... 05O ZX0 13O ZZPARM "
0450 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0455 F0=Z[13]
0460 SETERR 0461; REMOVE (F0,KEY=X3$(1,6)+"PF",DOM=0461)
0461 SETERR 9000
0465 PRINT (0,ERR=0466)'T1',
0470 PRINT (0,ERR=0471)'DM',
0520 READ (F0,KEY="LANG"+X3$(239,1),DOM=0521)L0$; GOTO 0530
0525 READ (F0,KEY="LANG ",DOM=0600)L0$
0530 O8$=FNS$(L0$(218,45)),O9$=FNS$(L0$(263,45))
0535 O8=44,O9=35-INT(LEN(O9$)/2); IF LEN(O8$)>O8 THEN O8=LEN(O8$)+2
0540 %HAS_IMAGE_LIB=0; IF FN%HAS_MODULE("IL") THEN FIND (F0,KEY=%C$+"I/L",DOM=*NEXT); %HAS_IMAGE_LIB=1
0550 %NOMADS_PROCESS$="",%NOMADS_ONEXIT$=""; IF NOT(NUL(%WDX$)) THEN FIND (Z[13],KEY="o"+X3$(40,3),DOM=*NEXT)OP$; IF MID(OP$,112,1)="Y" THEN %NOMADS_PROCESS$="ZZ2WDX;GUI_INIT",%NOMADS_ONEXIT$="ZZ2WDX;GUI_WRAPUP" ! 243030
0600 REM "
0610 DIM S$(80),P0$(100)
0620 X8=56,F9=Z[13],X3$(185,1)=""
0630 N1$=FNS$(X3$(86,40))
0635 IF MID(X3$,9,3)="M" OR MID(X3$,330,1)="1" THEN N1$=X3$(9,3)+"-"+N1$
0640 READ (F9,KEY=X3$(1,8))IOL=0360; S0$="*",X3$(185,1)="M"
0650 DIM D0$(28); D0$(1,6)=X3$(1,2)+"DATE"
0655 READ (F9,KEY=D0$(1,6),DOM=0656)D0$(1); REM GOSUB 4200; X3$(21,6)=D0$(7,6); IF POS(" "<>X3$(15,6))>0 THEN IF POS(" "<>D0$(23,6))>0 THEN GOTO 0680
0656 GOSUB 4200; X3$(21,6)=D0$(7,6); IF POS(" "<>X3$(15,6))>0 THEN IF POS(" "<>D0$(23,6))>0 THEN GOTO 0680
0660 X3$(15,6)=D0$(7,6),D0$(20,9)="SYS"+D0$(7,6); WRITE (F9,KEY=D0$(1,6))D0$
0690 PRINT 'CS',
1000 REM "GET MENU
1005 E0=1
1010 IF M1$="" THEN M1$=X3$(140,3)
1012 IF MID(M1$,1,3)="C/E" OR MID(M1$,1,2)="CE" THEN CALL "ZZ2PRP","CE",RESULT$,MOD_DATE$; IF RESULT$<>"Y" THEN IF LEN(M1$)<=3 THEN DIM M1$(3) ELSE M1$=M1$(4); GOTO 1012; REM "if menu is C/E or starts with CE then they must have CE app installed otherwise goto previous menu or main menu
1015 G0$="",Q$=X3$(239,1)+M1$(1,3); READ (Z[1],KEY=Q$,DOM=1016)M2$,Q9$; GOTO 1030
1020 IF MID(Q$,1,1)=" " THEN GOTO 2900 ELSE Q$=" "+Q$(2); READ (Z[1],KEY=Q$,DOM=2900)M2$,Q9$
1030 IF MID(M2$,2,3)="ZZZ" THEN M2$(53,3)=T$
1040 FIND (Z[1],KEY=M1$(1,3)+X3$(198,1),DOM=1041)*,G0$
1100 REM "
1200 REM "DISPLAY MENU
1205 CALL "ZZ2CLR"; REM " SSP# 146930 - CLEAR GLOBAL VARIABLE
1210 PRINT 'CS','SB',
1220 IF MID(X3$,78,1)="1" THEN PRINT @(FNQ(194,9),2),FNS$(L0$(194,8)),":",@(FNQ(202,69),2),FNS$(L0$(202,8)),":",
1240 Q$=FNS$(M2$(5,40)); IF Q$="" THEN GOTO 1250
1250 PRINT @(FNP(N1$),0),N1$,@(FNP(Q$),1),Q$,
1255 PRINT @(74,1)," (",FID(0),")",; IF MID(X3$,40,3)<>"   " THEN PRINT @(FNQ(186,69),1),FNS$(L0$(186,8)),": ",X3$(40,3), ELSE PRINT @(FNQ(54,69),1),FNS$(L0$(546,8)),X3$(1,8)
1258 Q$=M2$(2,3); IF X3$(239,1)<>" " THEN Q$=X3$(239,1)+"-"+Q$
1260 IF MID(M2$,2,3)<>"   " THEN PRINT @(FNQ(178,9)),FNR$(178),Q$,
1265 GOSUB 4200; IF S0$="*" THEN GOTO 1300 ELSE S0$="**"
1270 IF MID(M2$,45,6)=MID(S$,1,6) THEN GOTO 1300
1275 DIM P0$(120); P0$(15,6)=M2$(45,6),P0$(21,2)=M2$(51,2),P0=2,S0=1
1280 GOSUB 5200; IF O<0 THEN GOTO 2900
1300 REM "DATE RECORDS
1305 GOSUB 6900
1310 IF MID(M2$,53,3)<>"   " THEN IF MID(M2$,53,3)<>MID(X3$,12,3) OR D9$="" THEN GOSUB 3900 ELSE GOSUB 4180
1350 REM "CHECK APPLICATION
1352 S9=0
1355 IF LEN(M2$)<77 THEN GOTO 1400 ELSE IF MID(M2$,76,2)="  " THEN GOTO 1400 ELSE CALL "ZZ2PRP",M2$(76,2),RESULT$,DTMP$; IF RESULT$="Y" THEN GOTO 1400
1360 O$=""; READ (Z[5],KEY=M2$(76,2),DOM=1361)O$; O$=O$(3,30)
1365 PRINT @(12,7),"Application:",@(30),M2$(76,2)
1366 PRINT @(12,9),"Description:",@(30),O$
1370 O$="This application has not been activated ("+M2$(76,2)+"-"+M2$(2,3)+")"
1375 CALL "ZZPROM",".4",X3$,0,O$,"","",0
1376 PRINT @(0,7),'CE',; S9=1; GOTO 1400
1380 GOTO 2900
1410 PRINT @(0,3),
1415 IF %TERM_TYPE$="WINDX   " OR %TERM_TYPE$="WYSE50  " THEN GOSUB 8200; PRINT (0,ERR=1416)'GS',G0$,'GE','SF', ELSE PRINT (0,ERR=1416)'SB',G0$,'SF',
1418 PRINT @(0,3),"",
1420 PRINT @(0,3),Q9$,
1425 IF S9=1 THEN PRINT @(0,21),'CL',@(5),'BB',"* This application is not active.  You may only view menus. *",'EB',
1460 IF POS("X"=M2$(56,12))>0 THEN GOSUB 7800
1800 REM "OPTION ENTRY
1815 PRINT @(0,22),'CE',@(O8-LEN(O8$)-2,22),O8$,; IF M1$>"" THEN IF POS("ZZ"=M1$)<>1 AND POS("X"=X3$(154,6))=0 THEN PRINT @(O9,23),O9$,
1820 DIM O$(7); O=LEN(O$); CALL "ZZENTR","SUT@",X{ALL},O$,X4$,X3$,O8,22,1,O,C0,"","",L0$(5,1),"MENU","","",""; IF C0=.1 THEN GOTO 1815 ELSE IF C0=10 THEN T5=1; GOSUB 6800; GOTO 1820 ELSE IF C0=7 THEN GOTO 6600 ELSE IF ABS(C0)>4 THEN GOTO 1200 ELSE O$=FNS$(O$),S0$=""
1825 IF C0=4 THEN GOTO 3100 ELSE IF O$="" THEN GOTO 2900
1827 IF MID(X3$,51,1)="0" THEN IF O$="X" OR O$="OFF" THEN GOTO 3000
1830 IF MID(X3$,51,1)="0" OR LEN(O$)<3 THEN GOTO 1980
1900 REM "DIRECT OPTIONS
1915 IF O$="OFF" THEN GOTO 3000
1920 IF O$="DAY" THEN GOSUB 4210; GOTO 1400
1921 IF O$="DATE" THEN GOSUB 4000; GOTO 1400
1925 IF O$="COMP" THEN GOSUB 5000; GOTO 1200
1926 IF O$="PROG" OR O$="MAINT" THEN GOSUB 5100; GOTO 2200
1927 IF O$="MAIN" THEN M1$=""; GOTO 1000
1930 IF O$="BASIC" THEN GOTO 9800
1932 IF O$="CSMENU" THEN GOSUB 7885; GOTO 1800
1935 IF O$="LOGIN" THEN RUN "ZSTART"
1940 IF O$="STAT" THEN CALL "ZZSSTA",X3$; GOTO 1400
1945 IF Q$="MAINT" THEN GOSUB 5100
1950 IF O$="HELP" THEN CALL "ZZHELP","ZMENU",X3$,X0; GOTO 1200
1955 IF O$="ABOUT" THEN CALL "TF"+%LIC_COMP$+";MIKE"; CALL "ZZPROM","4",X3$,Z,"","","",0; GOTO 1200
1960 IF O$="VER" THEN CALL "ZZ2PRX"; GOTO 1200
1980 IF MID(X3$,45,1)="1" THEN IF LEN(O$)=3 THEN Q0$=O$; GOTO 2100
1985 IF LEN(O$)=1 THEN O$=O$+" "
1989 Q$=M2$(2,3); IF MID(M2$,76,2)="CS" THEN Q$="FMC"
1990 READ (2,KEY=Q$+O$(1,2),DOM=6000)P0$(1); IF P0$(15,8)<>S$(1,8) THEN GOTO 1995
1992 IF POS("X"=M2$(56,12))>0 THEN IF X7<>1 THEN IF POS(X3$(9,3)=P0$(23),3)=0 THEN GOTO 6000 ! SSP202107, was 56,20, s/b 56,12
1995 IF MID(P0$,6,1)<>"M" THEN READ (Z[3],KEY=M2$(2,3)+O$(1,2)+S$(1,6),DOM=1996)S0$; P0$(15,8)=S0$(12,8) ELSE Q0$=O$
2000 REM "OPTION TIME
2020 Q0$=FNS$(P0$(7,8)),Q1$="",S0=0; GOSUB 5200; IF O<0 THEN GOTO 1800
2025 IF P0$(6,1)="M" THEN Q0$=P0$(7,3); GOTO 2100 ELSE IF P0$(6,1)="W" THEN GOTO 2500 ELSE IF P0$(6,1)<>"O" THEN GOTO 2200
2030 REM "SYSTEM OPTION
2035 O$=Q0$; GOTO 1900
2100 REM "DAUGHTER MENU
2102 IF MID(Q0$,1,3)="C/E" OR MID(Q0$,1,2)="CE" THEN CALL "ZZ2PRP","CE",RESULT$,MOD_DATE$; IF RESULT$<>"Y" THEN GOTO 1800; REM "if menu is C/E or starts with CE then they must have CE app installed
2104 IF POS(Q0$(1,3)=M1$)=1 THEN GOTO 1800
2105 READ (Z[3],KEY=Q0$(1,3)+S$(1,8),DOM=2106)S0$; P0$(15,8)=S0$(12,8); GOSUB 5200; IF O<0 THEN GOTO 1800
2110 M1$=Q0$(1,3)+M1$
2190 GOTO 1000
2200 REM "PROGRAM
2202 IF S9>0 THEN GOTO 1800
2205 IF O9<0 THEN P0$(6,1)="N"
2210 PRINT @(0,22),'CE',; REM CALL "ZZCHKP",X3$,Q0$,Q; IF Q=0 THEN GOTO 01800
2220 X3$(146,8)=Q0$,X9=0
2245 X3$(178,6)="",X3$(174,4)=""; IF FNS$(P0$(78,8))>"" AND X3$(145,1)="1" THEN CALL "ZZBATC",X3$,X4$,P0$(78,8),X9
2250 IF LEN(Q0$)>=6 THEN IF P0$(6,1)="A" THEN CALL "ZZAUDT",X3$,Q0$(1,6)+P0$(78),F9,X9
2255 X3$(185,1)=P0$(6,1),X3$(188,9)=P0$(23,9)
2260 IF MID(P0$,6,1)="A" AND X9<0 THEN GOTO 1800 ELSE ON X9 GOTO 2261,1800,1200
2280 FOR X=1 TO 14; CLOSE (X); NEXT X
2300 REM "RUN PROG Q0$
2315 X$=FNS$(P0$(23))
2320 CLOSE (F9); OPEN (F9)"ZZPARM"
2340 WRITE (F9,KEY=X3$(1,8),ERR=2400)IOL=0360
2345 %X3$=X3$,%X3_SET=1,%X4$=X4$ ! update globals if needed 166626
2350 IF MID(P0$,6,1)="N" THEN Q0$="ZMAINT"
2385 SETERR 2395
2386 IF LEN(Q0$)=2 AND POS(Q0$+"0"=%TSK_DEVICES$,3)<>0 THEN GOTO OPTION_NOT_AVAILABLE ! SSP#263239
2387 F8=HFN; OPEN (F8,ERR=OPTION_NOT_AVAILABLE)Q0$; FIB$=FIB(F8); CLOSE (F8); IF FIB$(19,1)<>"P" THEN GOTO OPTION_NOT_AVAILABLE; REM "Make sure Q0$ is a program
2390 RUN Q0$
2395 OPTION_NOT_AVAILABLE:CALL "ZZPROM","X1ZMENU",X3$,A,"","","",0; GOTO 0010
2400 REM "Error on write
2410 E0=ERR; IF E0=1 AND M1$>"" THEN M1$=Q$; GOTO 2340
2490 GOTO 9000
2500 REM "WINDOW TYPE (UNIX ONLY)
2505 IF S9>0 THEN GOTO 1800
2510 IF MID(X3$,77,1)<>"U" THEN CALL "ZZPROM","X3ZMENU",X3$,0,"","","",0; GOTO 1800
2520 SETERR 2545
2530 PRINT 'CS',
2535 Q$=FNS$(P0$(7,8)); IF Q$="" THEN Q$=FNS$(P0$(23)) ELSE Q$="win."+Q$
2540 INVOKE Q$
2545 SETERR 9000
2550 CALL "ZZPROM","X4ZMENU",X3$,0,"","","",0
2560 GOTO 1200
2900 REM "GO TO PRIOR MENU
2910 IF M1$="" THEN GOTO 1820 ELSE REM IF POS(M1$(1,3)="PLAZZS",3)>0 THEN LET O$="LOGIN"; GOTO 1935
2920 M1$=M1$(4),S0$="*"
2930 IF M1$="" AND MID(M2$,2,3)=MID(X3$,140,3) THEN GOTO 1820 ELSE GOTO 1000
3000 REM "
3010 REMOVE (F9,KEY=X3$(1,8),DOM=3011)
3040 RUN "ZZEND"
3100 REM "STATUS OPTIONS
3102 IF POS("X"=X3$(154,6))>0 THEN GOTO 1820
3105 IF POS("ZZZ"=M1$)=1 THEN GOTO 1800 ELSE IF M2$>"" THEN T$=M2$(53,3)
3110 M1$="ZZZ"+M1$
3130 GOTO 1000
3490 RETURN 
3900 REM "GET DATE
3905 IF MID(M2$,53,3)="   " THEN RETURN 
3910 P=POS(M2$(53,3)=D0$(20),9); IF P=0 THEN GOTO 4000 ELSE P=P+22
3915 IF MID(D0$,P,6)=MID(S$,1,6) THEN GOTO 4000 ELSE GOTO 4160
4000 REM "DATE CODE
4005 D$=M2$(53,3); IF D$="   " THEN CALL "ZZPROM","X0ZMENU",X3$,0,"","","",0; RETURN 
4006 X2=5,X3=10,X0=8,X1=70
4007 DIM Q$(X1-2)
4010 CALL "ZZGRPH",X3$,"B",X{ALL},"",X2,X3,0,0,0,X0,X1,T2,0,0
4012 FOR X=1 TO X0-2; PRINT @(X2+1,X3+X),Q$,; NEXT X
4015 EXTRACT (F9,KEY=D0$(1,6),DOM=4016)D0$
4030 P=POS(D$=D0$(20),9); IF P=0 THEN D0$=D0$+D$+"      "; GOTO 4030 ELSE P=P+22
4100 REM "
4110 Q$=FNS$(L0$(380,30)); IF LEN(D0$)>28 THEN Q$=Q$+" ("+D$+")"
4117 PRINT @(38-LEN(Q$),X3+3),Q$,":",
4118 REM PRINT @(38-LEN(Q$),X3+3),; PRINT (0,ERR=04120) 'BB',
4120 REM PRINT Q$,":",; PRINT (0,ERR=04121) 'EB',
4140 CALL "ZZENTR","D1",X{ALL},D0$,X4$,X3$,41,3+X3,P,6,C0,"","","","","","",""
4145 FOR X=0 TO X0; PRINT @(X2,X3+X),S$(1,X1),; NEXT X
4150 WRITE (F9,KEY=D0$(1,6))D0$
4160 REM "ADJUST TERMINAL DATE
4170 X3$(12,3)=M2$(53,3),X3$(15,6)=D0$(P,6)
4172 CALL "ZZDISP","DX",D0$(P,6),"",X3$,D9$,"",0,0,""
4180 Q$=FNS$(L0$(380,30))+": "+D9$; PRINT @(FNP(Q$),2),Q$
4190 RETURN 
4200 REM "Set date & time
4201 Q1$=DAY; REM IF MID(X3$,77,1)="U" THEN Q1$=DAY; GOTO 4204
4202 REM IF MID(X3$,1,2)<>"T0" OR MID(M2$,2,3)<>"   " THEN GOTO 4225 ELSE Q1$=DAY
4204 REM IF X3$(51,1)="2" THEN LET Q1$=Q1$(7,2)+Q1$(4,2)+Q1$(1,2) ELSE IF X3$(51,1)="3" THEN LET Q1$=Q1$(1,2)+Q1$(4,2)+Q1$(7,2) ELSE LET Q1$=Q1$(7,2)+Q1$(1,2)+Q1$(4,2)  + LINE 4205 : LET Q1$(1,1)=CHR(65+NUM(Q1$(1,1)))
4205 Q1$=DTE(JUL(0,0,0):"YYYYMMDD"),Q1$=CHR(NUM(Q1$(1,3))-125)+Q1$(4)
4206 IF Q1$=MID(D0$,7,6) THEN GOTO 4225
4210 CALL "ZZSETD",X3$,X4$,D0$,3; GOSUB 6900; PRINT @(0,4),'CE',
4220 WRITE (F9,KEY=D0$(1,6))D0$; Q1$=D0$(7,6); GOSUB 4240
4225 RETURN 
4230 REM "LAST ACCESS
4240 DIM O0$(120); EXTRACT (F9,KEY="o"+X3$(40,3))O0$(1); O0$(76,6)=X3$(21,6),O0$(82,4)=STR(TIM*100:"0000"),O0$(86,8)=X3$(1,8); WRITE (F9)O0$; G9=0
4245 RETURN 
5000 REM "COMPANY SELECTION
5040 Z9=1,P0$(78,8)=""
5050 CALL "ZZMNUC",X3$,X4$,T0$,N1$
5090 IF Z9=1 THEN Q0$="ZMENU"; EXITTO 2200
5095 RETURN 
5100 REM "ENTER SELECTED PROGRAM
5105 IF O$="MAINT" THEN O9=-1
5110 PRINT @(0,23),'CL',@(0,22),'CL',@(25),L0$(210,8),":",
5115 DIM O$(8); O=LEN(O$)
5120 CALL "ZZENTR","SUX",X{ALL},O$,X4$,X3$,35,22,1,O,C0,"","","","","","",""; PRINT @(0,22),'CL',; IF C0<0 THEN GOTO 1810
5140 Q0$=O$
5190 RETURN 
5200 REM "ACCESS CONTROL
5220 X$=P0$(21,2); CALL "ZZPASW",X3$,"",P0$(15,6),X$,70,22,O
5290 RETURN 
6001 DIM P0$(90); P0$(6,1)="?"
6002 IF LEN(O$)=2 THEN IF MID(O$,1,1)="*" THEN O$=O$+"PSD"
6005 IF POS("*"=O$)=1 OR (LEN(O$)>=2 AND X3$(51,1)="1") THEN Q0$=O$; GOTO 2200
6010 CALL "ZZPROM","X1ZMENU",X3$,A,"","","",0
6025 GOTO 1810
6100 REM "BOX
6110 PRINT 'SB',
6120 CALL "ZZGRPH",X3$,"B",X{ALL},0,3,0,0,0,19,80,0,0,0
6130 PRINT 'SF',
6190 RETURN 
6610 H0$=M2$(2,3)+O$
6620 CALL "ZZHELP",H0$,X3$,X0
6640 IF X0=0 THEN GOTO 1800 ELSE GOTO 1200
6890 REM "
6895 T9=T9-10
6898 IF T9<0 THEN IF MID(X3$,197,1)<>$FF$ THEN GOTO 3000
6905 G9$=X3$(21,6)
6910 IF MID(X3$,78,1)="1" THEN IF T5=1 AND X3$(238,1)="2" THEN T5=0; PRINT 'ER',; CALL "ZZTIME",ERR=6911,X3$,2,0; PRINT 'BR', ELSE CALL "ZZTIME",ERR=6911,X3$,2,0
6920 IF G9=1 OR G9$<>X3$(21,6) THEN GOSUB 4230
6990 RETURN 
7805 X0=0,X7=SGN(POS($7E$=X3$(30,6)))
7810 READ (Z[2],KEY=M2$(2,3),DOM=7811)
7815 READ (Z[2],END=7880)P0$(1)
7820 IF P0$(1,3)<>M2$(2,3) THEN GOTO 7880 ELSE IF X7<>1 THEN IF POS(X3$(9,3)=P0$(23,55))=0 THEN GOTO 7815
7830 P0=5,P1=5+X0; IF X0>13 THEN P0=45,P1=P1-13
7835 IF MID(P0$,6,1)="M" THEN READ (Z[4],KEY=" "+P0$(7,3),DOM=7836)X$; X$=X$(5,30); GOTO 7845
7840 CALL "ZZXPRG",X$,0,P0$(7,8),0,0
7845 X0=X0+1
7850 PRINT @(P0,P1),P0$(4,2),". ",X$
7870 GOTO 7815
7880 IF X0<>0 THEN RETURN 
7882 IF X7>0 THEN EXITTO 2900
7885 CALL "ZZPROM","X5ZMENU",X3$,S3,"","","",0; IF S3=1 THEN X3$(30,1)=$7E$; GOTO 7800 ELSE EXITTO 2900
7890 RETURN 
8100 REM "
8180 RELEASE 
8200 ! FIX WINDX graphics
8205 TMP=POS($B1$=G0$); IF TMP<>0 THEN G0$=G0$(1,TMP-1)+'GE'+'BR'+" "+'ER'+'GS'+G0$(TMP+1); GOTO *SAME
8210 TMP=POS($B2$=G0$); IF TMP<>0 THEN G0$=G0$(1,TMP-1)+'GE'+'SB'+'BR'+" "+'ER'+'SF'+'GS'+G0$(TMP+1); GOTO *SAME
8245 RETURN 
9000 REM "ERROR
9005 SETERR 9000
9010 E0=ERR,E1=TCB(5); IF E0=39 THEN GOTO 9060 ELSE IF E0=69 OR E0=66 THEN GOTO 1200 ELSE IF ERR=67 THEN RUN "ZSTART"
9040 CALL "ZZERRM",E0$,"ZMENU",E2$,X3$,E0,E1,E2,E3,0
9050 ON E2 GOTO 9060,9100,9900,9070
9060 RETRY 
9070 GOTO 9900
9080 RETRY 
9100 REM " TRANSFER CONTROL
9190 GOTO 9900
9350 RETURN 
9700 RUN "ZSTART"
9900 REM "END PROGRAM
9920 SETERR 9960
9925 IF %TERM_TYPE$="WINDX   " THEN PRINT '_WHITE','BLACK','DF',
9940 BEGIN ; PRINT 'CS',SYS," ",SSN
9960 REM " pvx RUN "*"
9970 DELETE 
9999 END 
56000 REM "202107-Oracle Database integration with TopForm
56001 REM "263239-At the bottom of the main menu in CHUI type "PO" and you    
56002 REM "243030-Panel issues when GUI panels are executed via CHUI, font    
