0010 REM "Check for available space for call <ZZCHKP>
0030 REM "(C) 1985-1988 Basic Ideas, Inc; Atlanta, GA. USA
0035 REM "This software contains trade secrets and proprietary information"
1010 SETERR 1030
1020 ENTER X3$,P0$,X0
1025 P0=0,X0=0,M9=5000; SETERR 9800; GOTO 1040
1030 IF X3$="?" THEN CALL "ZZPDOC","ZZCHKP"; EXIT ELSE EXIT ERR
1060 IF P0$="" THEN CALL "ZZPROM","X2ZZCHKP",X3$,0,"","","",0; GOTO 9800
2000 CALL "ZZXPRG",P5$,F9,P0$,M0,X9
2020 IF X9<=0 THEN Q$="+("+STR(-X9)+","+P0$+")"; CALL "ZZPROM","X0ZZCHKP",X3$,0,Q$,"","",0; GOTO 9800
2030 GOSUB 3000
2040 M1=DSZ-M0; IF M1>=P[0] THEN X0=1; GOTO 2200
2042 IF P[0]=0 THEN GOTO 2200
2045 Q$="+ ("+P0$+", M="+STR(DSZ)+", R="+STR(P[0]+M0)+")"
2050 CALL "ZZPROM","X1ZZCHKP",X3$,0,Q$,"","",0; GOTO 9800
2200 REM "CHECK SECURITY
2210 Q0$=P$(9,6),Q1$=P$(15,2),Q=X0,X0=0
2220 CALL "ZZPASW",X3$,"AC",Q0$,Q1$,45,22,O0
2240 IF O0<0 THEN X0=0 ELSE X0=Q
2290 GOTO 9900
3010 CLOSE (14); OPEN (14)"ZS1"
3020 DIM P$(128),P[1]; P$(1)=P0$,P[0]=0; FIND (14,KEY=P$(1,8),DOM=3021)P$(1),P[0]
3090 CLOSE (14); RETURN 
9800 REM "BAD END
9940 EXIT 
9999 END 
