0010 REM "SET SCREEN EDITOR CONTROL KEYS <XZCTRL>
0020 SETESC 9300; SETERR 9000
0030 REM "(C) 1984 Basic Ideas, Inc; Atlanta, Georgia.
0035 REM "    This software contains trade secrets and proprietary information"
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,X5$,X6$; Z0$="*"
0100 SETERR 9000; SETESC 9300
0110 X0$="XZCTRL",X1$="Set Screen Editor Control Keys",K9$=FID(0)+"XCTR"
0115 W0=5,D0=24,X1$=""
0120 DIM Z$(80,"-"),S$(D0*20)
0130 K0=0,K1=0; DIM A1$(K0)
0150 REM "W0 IS TIME TO WAIT ON ERRORS;  D0=NUMBER OF ITEMS
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,"*",X5$,X0,X1,X2; IF X4$="END" THEN GOTO 9900
0260 CALL "ZZCTLK",X3$,K9$,"Z"; K9$="XCTR"+K9$
0265 GOSUB 7100
0290 DEF FNS$(E2$)=E2$(1,POS("   "=E2$+"   ")-1)
0300 REM "IOLISTS
0310 IOLIST A$
0312 IOLIST X3$,M1$,M2$,M3$,M4$
0400 REM "FILES
0405 DIM F[NUM(X3$(60,3))]
0410 F$="01O ZZPARM  06O ZZPARM  09O "+FID(0)+"      "
0420 CALL "ZZFLES",X3$,Y1$,Y0$,F$,F{ALL},Z0,0; ON Z0 GOTO 0421,9900
0600 REM "
0620 GOSUB 7000
1000 REM "
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1040 GOSUB 7100
1060 GOSUB 6000
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0
1120 IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1
1140 ON X0 GOTO 1500
1200 REM "
1215 IF C0<0 THEN ON INT(-C0)-1 GOTO 6800,9900
1490 GOTO 1120
1500 REM "
1510 A1$=K9$
1520 READ (F[1],KEY=A1$,DOM=1600)IOL=0310
1530 IF LEN(A$)<LEN(S$) THEN A$=A$+S$(1,LEN(S$)-LEN(A$))
1590 GOTO 1700
1600 REM "
1620 GOSUB 7100
1630 GOSUB 6015
1690 GOTO 2000
1700 REM "
1710 GOSUB 6015
1800 REM "
2010 PRINT @(0,22),"Press M to modify these settings, P to print this screen, or E to Exit: ",
2020 READ RECORD (F[9],SIZ=1)Q$
2022 IF POS(Q$="Pp")>0 THEN CALL "ZZSCRN",ERR=2000,X3$,X4$; GOTO 2000
2025 PRINT @(0,22),'CL',
2026 REM IF Q$=$12$ THEN GOTO 7600; REM "RESTORE DEFAULT SETTINGS
2027 REM IF Q$=$15$ THEN GOTO 7700; REM "UPDATE NEW SCREEN SETTINGS
2030 IF POS(Q$="MEme")=0 THEN GOTO 2000
2040 IF POS(Q$="Ee")>0 THEN GOTO 6700
2100 REM "MODIFY SELECTION
2110 PRINT @(0,22),'CL',"Press the letter of the key to Modify or press 0 to Exit",
2120 READ RECORD (F[9],SIZ=1)Q$
2125 PRINT @(0,22),'CL',
2126 IF Q$>="a" AND Q$<="z" THEN Q$=CHR(ASC(Q$)-32)
2130 IF POS(Q$=W9$)=0 THEN GOTO 2100
2135 IF Q$="0" THEN GOTO 6700
2200 REM "MAKE SETTINGS FOR NEW KEY ENTRY
2210 Q0=POS(Q$=W9$)-2
2215 X0=20,X1=Q0+4; IF Q0>W9 THEN X0=X0+40,X1=X1-W9-1
2220 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,X0,X1,Q0*20+13,8,C0,"","","ENTER A BRIEF (8 CHAR) DESCRIPTION OF THIS KEY","","","",""
2225 W0$=W$(Q0*20+1,20),X0=X0+9
2230 GOSUB 8000
2240 A$(Q0*20+1,12)=HTA(Q$)
2390 GOTO 2100
6000 REM "BACKGROUND
6005 PRINT @(0,3),'CE','SB',
6006 CALL "ZZVDTP",X3$,X0$,"","",0
6010 RETURN 
6015 W9$="0",W9=INT((D0-.1)/2); PRINT 'SF',
6020 FOR X=0 TO D0-1
6025 X0=0,X1=X+4; IF X>W9 THEN X0=40,X1=X1-W9-1
6026 W9$=W9$+CHR(ASC("A")+X)
6030 PRINT @(X0+20,X1),A$(X*20+13,8)," ",FNS$(A$(X*20+1,12))
6035 NEXT X
6070 PRINT 'SB',; CALL "ZZDISP","-",STR(W9+5:"00"),"",X3$,"","",X0,L0,X4$; PRINT 'SF',
6080 REM ""PRINT@(0,15),'BB',"*",'EB'," - FLASHING INDICATES MODIFIED SETTING",@(0,16),Z$
6190 RETURN 
6200 REM "DISPLAY DATA
6220 PRINT @(15,3),A$(1,6),
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 PRINT @(0,3),'CE',
6410 GOSUB 6000
6420 GOSUB 6450
6430 IF X1>0 THEN GOSUB 6200
6440 IF ABS(C0)>6 THEN C1=ABS(C0)-8
6445 RETURN 
6450 REM "DISPLAY KEYS
6460 PRINT 
6490 RETURN 
6500 REM "DELETE
6510 REMOVE (F[1],KEY=A1$,DOM=6511)
6590 GOTO 1630
6700 REM "ADD ENTRY
6710 WRITE (F[1],KEY=A1$)IOL=0310
6790 GOTO 9900
6800 REM "NEXT ENTRY IN FILE
6810 A1$=KEY(F[1],END=1140); A$(1,LEN(A1$))=A1$
6820 GOSUB 6450
6840 GOTO 1520
6900 REM "GET ACCOUNT PARAMETERS
6990 RETURN 
6995 CALL "ZZPROM","4",X3$,A,"THE "+Q$+"PARAMETERS HAVE NOT BEEN SET","","",0; GOTO 9900
7090 RETURN 
7100 REM "SET UP DATA
7110 W$="DATA FIELD          LEFT 1 CHAR         RIGHT 1 CHAR        UP 1 CHAR           DOWN 1 CHAR         START OF LINE       POSITION CURSOR     ATTACH SCREEN       COPY SCREEN         RELEASE             PRINT SCREEN        CROSS REF REPORT    INSERT TEXT         DELETE TEXT         CLEAR TO END LINE   END EDITOR          REPEAT CHARACTER    HELP SCREEN         TAB SET/RELEASE     TAB OVER            "
7115 W$=W$+"RETURN KEY          "+"NEXT WORD           "
7116 W$=W$+"SPECIAL KEY         "
7120 DIM A$(D0*20)
7130 A$="B8          <F1>    C8          L-Arrow CA          R-Arrow C5          U-Arrow CD          D-Arrow F0          Crtl-BA 40          @       BC          <F5>    BD          <F6>    BF          <F8>    10          Ctrl-P              N/A                 N/A                 N/A     D0          Del     CC          End     12          Ctrl-R  C4          Home    14          Ctrl-T  09          Tab     0D          Return  F1          Ctrl-RA 19          Ctrl-Y  07          Ctrl-G  "
7160 IF LEN(W$)<LEN(S$) THEN W$=W$+S$(1,LEN(S$)-LEN(W$))
7190 RETURN 
7600 REM "RESTORE DEFAULT SETTINGS
7610 GOSUB 7100
7620 GOSUB 6000; GOSUB 6015
7690 GOTO 2000
7700 REM "UPDATE PROGRAM
7710 Q$="7130A$="+$22$+A$+$22$
7720 EXECUTE Q$
7740 SAVE 
7790 GOTO 2000
8000 REM "INPUT STRING ON SCREEN
8010 PRINT @(0,22),'CL',@(5),"PRESS THE KEY TO BE USED FOR ",FNS$(W0$)," ANDWAIT...:",@(X0,X1),
8100 Q$=""
8105 PRINT @(X0,X1),S$(1,10),@(X0,X1),
8110 READ RECORD (F[9],SIZ=1,TIM=7,ERR=8200)Q0$
8115 Q$=Q$+Q0$; PRINT HTA(Q0$),
8120 READ RECORD (F[9],SIZ=1,TIM=1,ERR=8150)Q0$
8130 Q$=Q$+Q0$; PRINT HTA(Q0$),
8135 IF LEN(Q$)<5 THEN GOTO 8120 ELSE GOTO 8160
8150 RETURN 
8160 PRINT 'RB',@(0,22),'CL',"TOO MANY CHARACTERS IN INPUT - WAIT TO RETRY...",
8165 WAIT W0; PRINT 'RB',
8166 PRINT (0,ERR=8167)'CI',
8170 GOTO 8000
8200 PRINT 'RB',@(0,22),'CL',"NO KEY PRESSED - WAIT TO CONTINUE...",
8210 WAIT W0; PRINT 'RB',
8215 PRINT @(X0,X1),FNS$(A$(Q0*20+1,12)),
8220 EXITTO 2385
9000 REM "ERROR PROCESSING
9010 E0=ERR,E1=TCB(5)
9015 SETERR 9016; E0$=LST(PGM(E1))
9016 SETERR 9000
9040 CALL "ZZERRM",E0$,X0$,E1$,X3$,E0,E1,E2,E3,0
9050 ON E2 GOTO 9060,9100,9900,8981,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE E1$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 X5$=A$,X6$=""; EXIT 
9940 BEGIN ; SETESC 9350
9950 RUN "ZMENU"
9999 END 
