0010 REM "Release Unix/Xenix Ghost Tasks <ZGHOST>
0030 REM "(C) 1985-1989 Basic Ideas, Inc; Atlanta, GA. USA
0035 REM "This software contains trade secrets and proprietary information"
0100 BEGIN 
0120 W0=30
2000 REM 
2010 GOTO 2100
2020 INPUT C0$
2040 IF C0$(1)<>"GHCTRL" THEN GOTO 2020
2060 PRINT "OK"
2120 OPEN (1)"ZZPARM"
3000 REM "CYCLE THROUGH FOR GHOST TASKS...
3020 READ (1,KEY="GHOST",DOM=4000)A0$,A1$
3030 IF A1$="" THEN GOTO 5000
3040 G$=A1$(1,2); IF G$(1,2)=FID(0) THEN GOTO 3120
3050 CLOSE (2); OPEN (2,ERR=3200)G$
3080 SETERR 3400; RELEASE G$
3100 REM "CHANGE CONTROL RECORD
3110 EXTRACT (1,KEY=A0$)A0$,A1$
3120 P=POS(G$=A1$,32); IF P=0 THEN GOTO 3000
3140 A1$=A1$(1,P-1)+A1$(P+32)
3150 WRITE (1,KEY=A0$)A0$,A1$
3190 GOTO 3000
3400 SETERR 9000
3410 GOTO 3100
3420 IF ERR=13 THEN GOTO 3100
3490 GOTO 3000
5000 REM "WAIT FOR NEXT CYCLE
5020 WAIT W0
5090 GOTO 3000
9000 REM "ERROR IN GHOST CONTROL
9020 RUN "ZGHOST"
9999 END 
