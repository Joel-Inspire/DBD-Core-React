0100 BEGIN 
0110 OPEN (1)"ZW2"
0120 OPEN (2)"TK2"
0130 OPEN (3)"*MEMORY*" ! Hold issue#'s that meet the criteria
0140 ERASE "/tmp/guiwork",ERR=*PROCEED; SERIAL "/tmp/guiwork"
0145 OPEN LOCK (4)"/tmp/guiwork"
0200 ! Process ZW2 to get issues that are co 999, or category CD,GA,GE,GS
0210 READ (1,END=0290)ZW2$
0220 IF ZW2$(240,10)="0000099900" OR POS(ZW2$(173,2)="CDGAGEGS",2) THEN ISSUES+=1; WRITE (3,KEY=ZW2$(1,6))ZW2$(1,6),ZW2$(240,10),ZW2$(173,2)
0225 IF MOD(++C,500)=1 THEN PRINT C," ",ZW2.REF_NUM$
0230 GOTO 0210
0290 PRINT "Matching Issues: ",ISSUES
0300 ! Process TK2, see if in date range and see if in issues file (3)
0305 PRINT (4)"EMPLOYEE_CODE"+$09$+"LOG_DATE"+$09$+"SERVICE_CODE"+$09$+"PROJECT_CODE"+$09$+"CLIENT_CODE"+$09$+"SEQUENCE"+$09$+"DESCRIPTION"+$09$+"HOURS"+$09$+"CATEGORY"
0310 START_DATE$="K40101",END_DATE$="K41231"
0320 READ (2,END=0395)TK2$,HOURS
0325 IF MOD(++C1,1000)=1 THEN PRINT C1
0330 IF TK2$(5,6)<START_DATE$ OR TK2$(5,6)>END_DATE$ THEN GOTO 0320
0340 READ (3,KEY=TK2$(14,6),DOM=0320)REF_NUM$,*,CATEGORY$ ! If here then we found a match, write out
0345 LOG_ENTRIES+=1
0350 PRINT (4)TK2$(1,4)+$09$+FN%FMT_TFDATE$(TK2$(5,6),"%Mz/%Dz/%Y")+$09$+TK2$(11,3)+$09$+TK2$(14,6)+$09$+TK2$(25,3)+$09$+TK2$(30,2)+$09$+TK2$(32,35)+$09$+STR(HOURS)+$09$+CATEGORY$
0380 GOTO 0320
0395 PRINT "Matching log entries: ",LOG_ENTRIES
0396 ESCAPE 
