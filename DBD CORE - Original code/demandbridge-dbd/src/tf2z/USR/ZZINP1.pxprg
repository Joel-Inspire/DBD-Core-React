0010 REM "Keyboard Input Routine <ZZINPT>
0030 REM "(C) 1984-1988 Basic Ideas, Inc; Atlanta, Ga.
0110 SETESC 9300
0310 DEF FNS$(Z0$)=Z0$(1,POS("   "=Z0$+"   ")-1)
0980 X1=-1,X2=X1,X4=-1,C0=-1,T=10,D1=340
1000 ENTER X0$,X1$,X0,X2$,X3$,X4$,X1,X2,X3,X4,X5$,X6$,X7$,L0$,L1$,L2$,L3$,Y1$,A9$,Q4$
1005 IF X2$="" THEN X2$="SU",Z1=0 ELSE Z1=1
1010 SETERR 9000; GOSUB 9600
1015 DIM S$(132),M$(132,X1$(84,1)),Z9$(6,$00$)
1020 IF X2$(1,1)="P" THEN X7$=X3$,X3$=""
1025 D2$=ATH(X1$(D1,14*9)),A0$=$1B$+"B"+X1$(79,1),A1$=$1B$+"E"+X1$(79,1)
1026 IF POS("F"=X2$(2))>0 THEN D2$=ATH(X1$(D1))
1030 S=X0,A7$="-"
1050 D0=NUM(X1$(60,3)),D0$="",T0$=FNS$(X1$(169,3)),D0$=FID(D0,ERR=1051)
1055 T0=0,Q9=1+POS("M"=X1$(185,1)); IF POS("G"=FID(0))=1 THEN D0=0; GOTO 1075
1060 IF T0$<>D0$ OR LEN(D0$)<>2 THEN CLOSE (D0); IF LEN(T0$)=2 THEN OPEN (D0)T0$
1065 IF LEN(T0$)>2 THEN CALL "ZZDEMO",X1$,0,D0,Q$,M0
1080 IF POS("<"=X2$(2))>0 OR POS(">"=X2$(2))>0 OR POS("^"=X2$(2))>0 THEN C2=1
1085 IF X2$(1,1)="V" THEN V4=LEN(L1$)/16-1,V5=X4,X4=1
1090 IF Z1=0 THEN GOSUB 8000; GOTO 9900
3002 P0$="*",P3=LEN(X5$),X0=0; IF P3=0 THEN P3=X4
3005 IF X5$>"" THEN X9$=M$(1,LEN(X5$)) ELSE X9$=M$(1,X4),X5$=X9$
3007 IF C2>0 THEN IF LEN(X5$)<12 THEN X5$=X5$+S$(1,12-LEN(X5$))
3010 ON POS(X1$(238,1)="1") GOTO 3011,3012
3011 IF X5$>"" THEN IF POS("P"=X2$(2))=0 THEN PRINT @(X1,X2),A0$,X5$,A1$, ELSE PRINT @(X1,X2),A0$,M$(1,LEN(X5$)),A1$,; GOTO 3015
3012 IF X5$>"" THEN PRINT @(X1+LEN(X5$),X2),A1$,@(X1,X2),$08$,A0$,; IF POS("P"=X2$(2))=0 THEN PRINT @(X1,X2),X5$, ELSE PRINT @(X1,X2),M$(1,LEN(X5$)),
3015 IF X6$="" THEN X6$=S$(1,LEN(X9$)) ELSE Z9=NUM(X6$(1,1),ERR=3016)
3020 IF LEN(X6$)>X4 AND X2$(1,1)<>"N" THEN X9$=X6$(X4+1),X6$=X6$(1,X4) ELSE IF X2$(1,1)="N" THEN X9$=X5$,X6$="",M$="##########",P0=POS("."=X7$),P1=POS("-"=X7$),P2=0; IF P0>0 THEN P2=MOD(INT(X4/10),10); DIM Z8$(P2,"0"); IF P1=LEN(X7$) THEN P4=SGN(POS("0"<>X7$(P0+1)))
3021 SETERR 9000
3025 IF X6$>"" THEN X6$=X6$+"0" ELSE IF X2$(1,1)<>"N" THEN DIM Z$(X4,"0"); X6$=Z$,Z$=""
3050 IF POS(X1$(84,1)<>X5$)=0 THEN DIM E0$(LEN(X5$)) ELSE E0$=X5$
3052 IF X2$(1,1)<>"A" THEN GOTO 3075
3055 IF A9$>"" THEN IF X2$(1,1)="A" THEN A9=LEN(A9$),A9$=A9$+"?"
3060 DIM A[4]; Q0=0,Q1=0; FOR X=1 TO LEN(A9$)-1
3065 A8$=A8$+STR(Q0:"0"); IF A9$(X,1)=A7$ THEN A[Q0]=Q1,Q0=Q0+1,Q1=0 ELSE Q1=Q1+1
3070 NEXT X; DIM Z$(LEN(X9$),"0")
3075 IF X2$(1,1)="D" THEN D$=X1$(80,3); IF X1$(80,1)="1" THEN D$="157"
3080 IF X5$>"" THEN IF X1$(238,1)<>"1" THEN PRINT @(X1,X2),A0$,
3085 GOSUB 8000
3090 IF C0=8 THEN C0=3.2 ELSE IF C0=9 THEN C0=3.1
3092 X3=C0
3095 IF X5$>"" THEN IF ABS(X3)<5 OR ABS(X3)>10 OR ABS(X3)=7 THEN IF X1$(238,1)="1" THEN GOSUB 8755 ELSE PRINT 'SF',
3205 IF E9>0 THEN Q4$=Q4$+E0$
3220 IF Q4$>"" THEN X3$=Q4$; IF X2$(1,1)="N" THEN X3$=STR(Q)
3420 GOTO 9900
4010 T$=""; FOR T=1 TO LEN(Q4$); IF Q4$(T,1)<>"," AND Q4$(T,1)<>" " THEN T$=T$+Q4$(T,1); NEXT T ELSE NEXT T
5005 L1$="",L2$=""
5010 P=POS("-"=X6$)
5020 IF P=0 THEN GOTO 5100
6990 GOTO 9900
7010 Q=POS(A7$=A9$(X+Z+1)); IF Q=0 THEN PRINT 'RB',; GOTO 8042
7020 IF A9$(X+Z+1)="A" THEN Q$=Q$+S$(1,P); GOTO 7090
7030 Q=NUM(A8$(X+Z+1,1),ERR=8042)
7035 Q0=0; IF Q>0 THEN FOR L=0 TO Q-1; Q0=Q0+A[L]; NEXT L
7038 IF Q4$>"" THEN Q$=Q4$(Q0+1) ELSE Q$=""
7040 Q4$=Q4$(1,Q0),X=X-LEN(Q$)
7055 Q$=STR(NUM(Q$,ERR=8042):Z$(1,A[Q]))
7090 GOTO 8080
7210 IF Q$<>" " THEN PRINT 'RB',; GOTO 8030 ELSE V5=MOD(V5+1,V4+1); Q$=STR(V5:"0")
7220 X5$=L1$(V5*16+1,16); PRINT @(X1,X2),X5$,
7240 GOTO 8030
7995 RETURN 
8010 X=0,Y=X2,Q4$="",Z=0; IF X2$(1,1)="D" THEN IF X1$(80,1)="3" THEN IF POS("1"=X2$(2))>0 THEN IF X5$(1,1)<"A" THEN Q$=X5$(1,2); GOTO 8080
8012 IF X2$(1,1)="P" THEN IF X7$(1,1)<>" " THEN P=POS(" "=X7$); IF P=4 THEN Q$=X7$(1,3),Z=1; GOTO 8080
8015 IF X2$(1,1)="D" THEN IF X1$(48,1)="3" THEN IF X5$(1,1)<"A" THEN Q$=X5$(1,4); GOTO 8080 ELSE Q$="1987"; GOTO 8080
8025 IF LEN(X6$)>X THEN Z=Z+NUM(X6$(X+1,1))
8030 IF Z1=1 THEN IF X>X4 THEN X=X-1,Q4$=Q4$(1,X); PRINT 'RB',
8035 IF POS("E"=X2$(2))>0 THEN IF X2$(1,1)<>"X" THEN IF X=X4 THEN C0=0; RETURN 
8042 PRINT @(X1+X+Z,Y),; IF POS("*"=X1$(154,6))>0 THEN IF X1$(338,2)<>"  " THEN Q$=ATH(X1$(338,2)),X1$(338,2)=""; GOTO 8046
8045 IF M0=0 THEN READ RECORD (D0,SIZ=1,TIM=T,ERR=8800)Q$ ELSE CALL "ZZDEMO",X1$,1,D0,Q$,M0
8047 IF Q$=$03$ AND X1$(47,1)="1" THEN EXIT 66 ELSE IF Q$=$05$ AND X1$(47,1)="1" THEN EXIT 67 ELSE IF Q$=$19$ THEN C0=5; GOTO 8100
8050 IF Q$="" OR Q$=$0D$ THEN C0=1; GOTO 8100 ELSE IF Q$=$08$ THEN C0=2; GOTO 8100 ELSE IF POS(Q$=D2$,6)>0 THEN GOSUB 8200; IF C0>=0 THEN GOTO 8100 ELSE PRINT 'RB',; GOTO 8042
8051 IF Q$=$1B$ THEN GOTO 8042 ELSE IF Q$<$20$ OR Q$>$7F$ THEN GOTO 8042 ELSE IF A9>1 THEN X2$(1,1)=A9$(X+Z+1,1) ELSE IF X2$(1,1)="V" THEN GOTO 7200
8052 IF Q$=" " AND POS("N"=X2$(2))>0 THEN Q$="_" ELSE IF POS("U"=X2$(2))>0 THEN IF Q$>="a" AND Q$<="z" THEN Q$=CHR(ASC(Q$)-32)
8053 IF LEN(X2$)>4 THEN IF X2$(1,1)="X" THEN C0=POS(Q$=X2$(5)); IF C0=0 THEN PRINT 'RB',; GOTO 8042 ELSE GOTO 8100
8054 IF X=X4 AND X>0 THEN PRINT 'RB',; GOTO 8030 ELSE IF X2$="S" OR X2$="SX" THEN GOTO 8080 ELSE IF A9=1 THEN X2$(1,1)=A9$(X+Z+1,1)
8060 IF X2$(1,1)="N" THEN GOTO 8300 ELSE IF P0$>"" THEN IF POS(X2$(1,1)="ZDP")>0 OR (X2$(1,1)="T" AND X<4) AND POS(Q$="0123456789 ")=0 THEN PRINT 'RB',; GOTO 8045
8062 IF X2$(1,1)="D" THEN IF X=NUM(D$(2,1))-1 AND Q$>"1" THEN Q$="0"+Q$ ELSE IF X=NUM(D$(3,1))-1 AND Q$>"3" THEN Q$="0"+Q$ ELSE IF Q4$=" " THEN PRINT 'RB',; GOTO 8042 ELSE IF Q$=" " THEN GOTO 8080
8065 IF X2$(1,1)="T" THEN IF X=4 AND (Q$<>X1$(202,1) AND Q$<>X1$(205,1)) THEN PRINT 'RB',; GOTO 8045 ELSE IF X=0 AND Q$>"2" THEN Q$="0"+Q$ ELSE IF X=2 AND (Q$>"5" AND X1$(67,1)<>"3") THEN Q$="0"+Q$
8080 IF POS("L"=X2$(2))>0 AND Q$=" " THEN Q$="_"
8082 IF POS("P"=X2$(2))=0 THEN PRINT (T0,ERR=8042)@(X1+X+Z,X2),Q$,
8085 Q4$=Q4$+Q$; IF X<X4 AND X4>0 OR X4<=0 THEN X=X+LEN(Q$) ELSE PRINT 'RB',
8087 IF E9=1 THEN E0$=E0$(1,LEN(E0$)-1),E1$=Q4$+E0$; PRINT (T0)E0$(1,X4-LEN(Q4$)),
8090 IF X4>0 THEN IF X=LEN(Q$) THEN IF POS("P"=X2$(2))=0 THEN PRINT @(X1+LEN(Q$)+Z,X2),X9$(1+LEN(Q$)+Z),
8092 IF X2$(1,1)="D" THEN IF X=NUM(X1$(80,1))-1 THEN Q$="19",Z=Z+1; GOTO 8080
8095 GOTO 8025
8101 IF X2$(1,1)="V" THEN Q$=STR(V5:"0")
8102 IF POS(X2$(1,1)="XV")>0 THEN Q4$=Q$; RETURN 
8104 IF C0=6 THEN IF X<X4 AND P>0 AND X2$(1,1)="S" AND Z1<>0 AND A9=0 THEN Q4$=Q4$+E0$(1,1),E9=1,X=X+1,E0$=E0$(2)+" ",E1$=Q4$+E0$; GOTO 8042 ELSE IF A9>0 THEN GOTO 7000 ELSE PRINT 'RB',; GOTO 8042
8105 IF Q4$="" AND C0=2 THEN IF D2$(7,6)<>D2$(13,6) THEN GOTO 8042
8106 IF C0=7 THEN GOTO 8450
8109 IF C0=3 THEN C0=2; GOTO 8150
8110 IF C0=3 THEN C0=2 ELSE IF C0<>2 THEN GOTO 8150
8115 IF POS("N"=X2$)=1 THEN GOTO 8400
8118 IF X=0 THEN Q4$=Q4$(1,POS("V"=X2$(1,1))); GOTO 8155
8119 IF E9>0 THEN E0$=Q4$(X,1)+E0$; IF X=1 THEN GOTO 8990
8120 IF X5$>"" THEN IF X=1 THEN X=0,Z=Z9,Q4$=""; IF POS("P"=X2$(2))=0 THEN PRINT @(X1,X2),X5$,; GOTO 8040 ELSE GOTO 8040
8125 IF X6$>"" THEN Z=Z-NUM(X6$(X+1,1)),X=X-1,Q4$=Q4$(1,X); IF POS("P"=X2$(2))<>0 THEN GOTO 8041 ELSE IF E9=1 THEN PRINT @(X1+X+Z,X2),E1$(X+Z+1,1),; GOTO 8041 ELSE PRINT @(X1+X+Z,X2),X9$(X+Z+1,1),; GOTO 8041
8130 PRINT @(X1+X-1,X2)," ",; X=X-1,Q4$=Q4$(1,X); GOTO 8040
8150 IF C0=5 THEN C0=7
8155 X3=C0; IF POS("N"=X2$)<>1 THEN Q4$=Q4$(1,X) ELSE IF POS("."=Q4$)=0 THEN IF POS("."=X2$(2))>0 THEN IF Q4$>"" THEN Q4$=Q4$+"."
8160 IF C0<>10 OR POS("C"=X2$(2))>0 THEN RETURN ELSE IF X<>0 THEN GOTO 8042
8162 CALL "ZZINPO",L0$,L2$,Q4$,X1$,X2$,X3$,X4$,X5$,X9$,Y1$,C0,X1,X2,X3,X4,A0
8165 IF A0<0 THEN ON -A0 GOTO 8000,8000,8100,8190
8170 ON A0 GOTO 8171,8175,8500,8500,8600,8850,8180,8900,8960,8970,8700,8720,8172,8185,8190,8950,8995,8199
8172 C0=.1,X3=C0; EXIT 65
8175 GOSUB 8750; GOSUB 8770; CALL "ZZHELP",L0$,X1$,A; GOSUB 8700; IF A=0 THEN GOSUB 8755; GOTO 8171 ELSE EXIT 69
8180 IF X1$(77,1)="T" THEN GOSUB 8771
8182 CALL "ZZNOTE",X1$,X4$,"N","",""
8184 GOSUB 8725
8186 EXIT 69
8190 RETURN 
8220 Q9$=Q$,C0=-1; P=POS(Q9$=D2$,6); IF P=0 THEN PRINT 'RB',; Q$=""; RETURN ELSE GOTO 8235
8230 P=POS(Q9$=D2$,6); IF P=0 THEN PRINT 'RB','CI',; RETURN ELSE IF M0=0 THEN READ RECORD (D0,SIZ=1,TIM=POS("P"=X1$(77,1)),ERR=8240)Q$ ELSE CALL "ZZDEMO",X1$,1,D0,Q$,M0
8232 Q9$=Q9$+Q$; IF LEN(Q9$)>6 THEN GOTO 8235 ELSE P=POS(Q9$+Z9$(1,6-LEN(Q9$))=D2$,6); IF P=0 THEN GOTO 8230
8235 IF LEN(Q9$)>6 THEN PRINT 'RB',; RETURN ELSE P=POS(Q9$+Z9$(1,6-LEN(Q9$))=D2$,6); IF P=0 THEN GOTO 8230 ELSE C0=INT(P/6)+1,X3=C0; RETURN 
8240 PRINT 'CI','RB',; RETURN 
8250 Z=POS("."=Q$); IF Z>0 THEN Z=Z+1,Z=LEN(Q$(Z))-SGN(POS("-"=Q$(Z))+POS("R"=Q$(Z))); IF Z>P2 THEN GOTO 8395
8302 IF Q8$>"" THEN Q8$=Q8$+Q$
8305 IF X1$(126,1)<>"." THEN IF Q$=X1$(126,1) THEN Q$="." ELSE IF Q$="." THEN Q$="X"
8310 IF Q$="-" THEN GOTO 8475 ELSE IF POS(Q$="1234567890.-")=0 OR (Q$="." AND (POS("."=X7$)=0 OR POS("."=Q4$)>0)) THEN PRINT 'RB',; GOTO 8045
8315 IF P0=0 THEN IF Q$="." THEN PRINT 'RB',; GOTO 8045
8320 Q4$=Q4$+Q$; IF Q4$="." THEN Q=0; GOTO 8330
8322 Q=NUM(Q4$,ERR=8395); IF POS("."=X2$(2))>0 AND POS("."=Q4$)=0 THEN Q=NUM(Q4$+".",ERR=8323) ELSE IF P2>0 THEN IF POS("."=Q4$)=0 THEN Q=Q/10^P2
8330 Q$=STR(Q:X7$); IF LEN(Q$)<>LEN(X7$) THEN GOTO 8395 ELSE IF Q4$="-" AND P2>0 THEN Q$(LEN(Q$)-P2-1)="-" ELSE IF Q4$="-" THEN Q4$(LEN(Q4$),1)="-"
8333 IF Q>0 THEN IF LEN(Q$)<LEN(STR(-Q:X7$)) THEN GOTO 8395
8345 P=POS("."=Q4$); IF P>0 THEN IF LEN(Q4$(P+1))>P2 THEN IF Q8>0 THEN Q8=0,Q4$=Q8$,Q8$=""; GOTO 8322 ELSE GOTO 8395
8350 Z=POS("."=Q$); IF Z>POS("."=X7$) THEN GOTO 8395
8352 IF P=0 THEN GOTO 8360 ELSE P=LEN(Q4$(P+1)); IF P>P2 THEN P=P2
8355 Q$=Q$(1,POS("."=Q$)+P)+M$(1,P2-P)+Q$(POS("."=Q$)+1+P2),Z=POS("."=Q$)+P
8360 IF POS("M"=X2$)=0 THEN PRINT @(X1,X2),Q$, ELSE CALL "ZZDISP","N",Q$,"",X1$,"","",X1,X2,""
8390 GOTO 8040
8395 Q4$=Q4$(1,LEN(Q4$)-1); PRINT 'RB',; GOTO 8322
8405 IF Q4$="" THEN C0=2,X=0; GOTO 8150 ELSE IF LEN(Q4$)=1 THEN PRINT @(X1,X2),X9$,
8410 Q4$=Q4$(1,LEN(Q4$)-1); IF Q4$>"" THEN GOTO 8322 ELSE GOTO 8040
8452 IF X2$(1,1)="N" THEN GOTO 8480 ELSE IF X2$(1,1)<>"S" OR Z1=0 THEN PRINT 'RB',; GOTO 8030
8455 IF E9=0 THEN PRINT 'RB'; GOTO 8030 ELSE E9=1,E1$=E1$(1,X)+E1$(X+2)+" ",E0$=E1$(X+1),Q4$=E1$(1,X)
8460 PRINT @(X1+X+Z,X2),E1$(X+1,X4-LEN(Q4$)),
8470 GOTO 8042
8476 IF POS("&"=X2$(2))>0 THEN PRINT 'RB',; GOTO 8042
8477 IF Q4$="" THEN Q4$=X9$,Q7=1,Q8=1,Q8$=Q$ ELSE Q8=0,Q7=POS("."=Q4$)
8480 GOSUB 8490; Q=-Q; Q4$=STR(Q),Q$=STR(Q:X7$); IF Q7>0 THEN IF POS("."=Q4$)=0 THEN Q4$=Q4$+"."+Z8$(1,P2)
8485 GOTO 8322
8492 T$="",P=POS("CR"=Q4$)+POS("-"=Q4$); FOR T=1 TO LEN(Q4$); IF POS(Q4$(T,1)="0123456789"+X1$(126,1))>0 THEN T$=T$+Q4$(T,1)
8493 NEXT T; IF P>0 THEN T$="-"+T$
8494 IF X1$(126,1)<>"." THEN Q=POS(X1$(126,1)=T$); IF Q>0 THEN T$(Q,1)="."
8495 Q4$=T$,T$="",Q=NUM(Q4$); RETURN 
8505 IF POS("/"=L1$)=1 THEN L$=L1$(2) ELSE L$="ZZLIST"
8520 IF POS(X3$(77,1)="UP")>0 THEN GOTO 8526 ELSE P9$=""; DROP "ZZFLES",ERR=8521; P9$=P9$+"ZZFLES"
8525 DROP "ZZCOMP",ERR=8526; P9$=P9$+"ZZCOMP"
8565 Q=0; IF POS(X2$(1,1)="TD")>0 THEN Q=-2
8570 CALL L$,X1$,X4$,L1$,Y1$,Y2$,Q0$,Z0,X5,X4+Q,X2$,X7$,A0-2,X5$
8575 IF POS(X3$(77,1)="UP")=0 THEN GOSUB 8725
8580 IF Q0$<>"" THEN Q4$=Q0$,C0=6,X3=C0 ELSE IF Z0=0 THEN GOTO 8171 ELSE C0=5,X3=C0
8590 RETURN 
8605 IF L2$="X" THEN C0=102,X3=C0; GOTO 8690
8610 C0=5,X1$(201,1)=CHR(ASC(X1$(201,1))+1),X3=C0; SETERR 8680
8620 CALL "ZZCHKP",X1$,L2$,Q; IF Q=0 THEN GOTO 8171
8630 CALL L2$,X1$,X4$,Y1$,Y2$; SETERR 9000
8635 GOSUB 8700
8640 IF Y2$>"" THEN Q4$=Y2$(LEN(Y1$)+1),C0=6,X3=C0 ELSE C0=5,X3=C0
8680 X1$(201,1)=CHR(ASC(X1$(201,1))-1); SETERR 9000; IF ERR=12 THEN GOTO 8042
8690 RETURN 
8725 IF P9$="" THEN RETURN ELSE FOR P9=1 TO LEN(P9$) STEP 6; ADDR P9$(P9,6),ERR=8726
8730 NEXT P9; RETURN 
8750 IF X1$(238,1)="1" THEN PRINT (0,ERR=8753)@(X1+P3,X2),'EB',@(X1-1,X2),'BB',; RETURN 
8751 IF POS("P"=X2$(2))=0 THEN PRINT (0,ERR=8753)@(X1,X2),'BB',X5$,'EB',
8753 RETURN 
8755 IF X1$(238,1)="1" THEN PRINT @(X1,X2),$08$," ",@(X1+LEN(X5$),X2)," ", ELSE PRINT @(X1,X2),'SF',X5$,
8756 RETURN 
8771 IF POS(X1$(77,1)="UP")>0 THEN RETURN ELSE DROP "ZZCOMP",ERR=8772; P9$=P9$+"ZZCOMP"
8773 DROP "ZZFLES",ERR=8774; P9$=P9$+"ZZFLES"
8779 RETURN 
8810 IF POS("T"=X2$(2))>0 THEN X3=10; EXIT ELSE IF X1$(78,1)<>"1" OR POS(X1$(185,1)="RUA*")>0 THEN GOTO 8820
8815 IF T9<10 THEN CALL "ZZTIME",ERR=8816,X1$,Q9,0; T9=T9+1; IF Z1>0 THEN IF X1$(238,1)="0" THEN PRINT A0$,
8820 GOTO 8042
8991 X=0,Z=0,Q4$=""; IF X5$>"" THEN E1$=X5$,E0$=X5$
8992 IF POS("P"=X2$(2))=0 THEN PRINT @(X1,X2),E1$,
8994 GOTO 8040
8995 CALL "UT2FLA",ERR=8996
8997 GOTO 8940
9010 PRINT @(0,22),'CL',"ERR=",ERR," LINE: ",TCB(5)
9020 EXIT ERR
9300 IF X1$(47,1)="1" THEN EXIT 66 ELSE RETURN 
9310 RETURN 
9600 Q$="000"+X1$(163,6),Q=NUM(Q$)
9605 RETURN 
9610 IF POS("G"=FID(0))<>1 THEN Q$=X1$(40,12)+Q$+$1F$+X1$(154,18),Q$=HTA(HSH(Q$)); IF Q$<>X1$(73,4) OR Q<>MOD(%SSN,1000000) THEN GOTO 9630
9620 RETURN 
9630 RESET ; SETERR 0000; EXIT 89
9940 EXIT 
9999 END 
