0010 REM "Window text Box Display <ZZWNDO>
0030 REM "(C) 1985-1988 Basic Ideas, Inc; Atlanta, GA. USA
0035 REM "3.8 - 09/25/95 - 15.53 - tma
0040 REM "Copyright 1995 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1020 ENTER X3$,G9$,X0,X1,X2,X3,X9,T1$,T0,T1,T2,P0$,P2$,P1$,L8,X8
1030 SETERR 9000
1040 IF POS("!"=G9$)>0 THEN G0$=G9$(POS("!"=G9$))
1090 DIM S$(X1-2-2*SGN(X9)*NUM(X3$(238,1)))
1095 T1$=T1$(POS(" "<>T1$)),P1$="",P2$="",L8=0
1205 PRINT 'ER',
1210 CALL "ZZGRPH",X3$,G0$+"B",X{ALL},"",X2,X3,0,0,0,X0,X1,T2,0,0
1215 IF T2=1 THEN PRINT (0,ERR=1216)@(0,0),
1310 FOR X=1 TO X0-2
1320 PRINT @(X2+1,X+X3),
1325 IF X9=1 THEN IF X3$(238,1)="1" THEN PRINT @(X2+LEN(S$)+2,X+X3),'ER',@(X2+1,X3+X),'BR', ELSE PRINT 'BR',
1330 PRINT S$,
1335 IF X9=1 THEN IF X3$(238,1)="0" THEN PRINT 'ER',
1340 NEXT X
2005 IF X9=1 THEN IF X3$(238,1)="0" THEN PRINT 'BR',
2010 X=X2+1+SGN(X9*NUM(X3$(238,1))),Y=X3+1,L0=X1-1-2*X9*NUM(X3$(238,1)),L1=X3+X0-1,L2=X,T0$=T1$,T1$=""
2020 P=POS(" "<>T0$); IF P=0 THEN GOTO 2300 ELSE T0$=T0$(P)
2030 Q=LEN(T0$); IF Q<L0 THEN Q$=T0$+" " ELSE Q$=T0$(1,L0-1)
2032 P=POS("\"=Q$); IF P>0 THEN Q$=Q$(1,P)+" "
2035 Q$=Q$(1,LEN(Q$)-1),T1$=T1$+T0$(1,LEN(Q$)),T0$=T0$(LEN(Q$)+1)
2040 IF T0=1 THEN Q=INT((L0-LEN(Q$))/2) ELSE Q=1
2050 T9=X+Q,L=Y-3; GOSUB 2600; Y=Y+1
2090 GOTO 2020
2320 IF X9>0 THEN IF X3$(238,1)="0" THEN PRINT 'ER',
2400 IF G9=0 THEN IF P0$>"" THEN IF P0$="*" THEN GOSUB 8800 ELSE CALL "ZZPROM",P0$,X3$,X8,"","","",0
2405 IF POS("X"=G9$)>0 THEN GOTO 2480
2410 IF T1>0 THEN GOSUB 6000
2420 IF POS("R"=G9$)>0 THEN CALL "ZZGRPH",X3$,"B",X{ALL},"",X2,X3,0,0,0,X0,X1,T2,0,0; PRINT @(I0-1,I1),S$,
2490 GOTO 9900
2605 IF POS("R"=G9$)>0 AND G9>0 THEN PRINT 'SB',
2610 P0=1,T8=0; P=POS("\"=Q$); IF P>0 THEN Q$(P,1)=""
2620 P=POS("["=Q$); IF P=0 THEN PRINT @(T9+T8,3+L),Q$,; GOTO 2770
2630 PRINT @(T8+T9,3+L),Q$(P0,P-1),
2640 Q$=Q$(P+1),T8=T8+P,P1=POS("]"=Q$); IF P1>0 THEN P$=Q$(1,P1-1)
2650 GOSUB 2750
2660 P7=T8+T9-1,P8=P7+R0,P9=3+L,T8=T8+LEN(P$)-1
2670 REM LET P8=P8+NUM(X3$(238,1)),P7=P7-NUM(X3$(238,1))
2673 P7=P7-NUM(X3$(238,1))
2680 REM LET T8=T8+NUM(X3$(238,1))
2685 IF X3$(238,1)="0" THEN PRINT @(P7,P9),; IF X9>0 THEN PRINT 'BB', ELSE PRINT 'BU',
2690 IF X3$(238,1)="0" THEN PRINT P$,; IF X9>0 THEN PRINT 'BR', ELSE PRINT 'EU',
2700 IF X9=0 THEN IF X3$(238,1)<>"0" THEN PRINT @(P8,P9),'EU',@(P7,P9),'BU',P$,
2705 IF X9>0 THEN IF X3$(238,1)<>"0" THEN PRINT @(P8,P9),'BR',@(P7,P9),'BB',P$,
2710 Q$=Q$(P1+1)
2715 IF Q$>"" THEN IF Q$(1,1)=" " THEN T8=T8+1,Q$=Q$(2); GOTO 2715
2720 Y$=CHR(P7)+CHR(P9)+CHR(LEN(P$))+P$,P2$=P2$+Y$,P1$=P1$+$1B$+CHR(L8)+R$
2730 L8=L8+1
2740 GOTO 2620
2760 R0=POS(":"=P$),R$=P$(R0+1),R=LEN(R$),P$=P$(1,R0-1),R0=LEN(P$)
2770 RETURN 
6005 PRINT 'ER',
6010 FOR X=0 TO X0
6020 PRINT @(X2,X+X3),S$+"    ",
6030 NEXT X
6090 RETURN 
8815 I0=X2,I1=X3+X0-2,I0=I0+2
8820 PRINT @(I0,I1),'BB',"Press Return",'EB',
8825 PRINT @(I0+14),; READ RECORD (0,SIZ=1)Q$; IF Q$=$03$ THEN EXIT 67 ELSE IF Q$<>$0D$ THEN GOTO 8825
8890 RETURN 
9000 PRINT @(0,22),"ERROR: ",ERR," LINE: ",TCB(5),; INPUT *
9940 EXIT 
9999 END 
