0010 REM "Initialize files <ZZINIT>
0035 REM "5.7 - 12/21/20 - 16.218333 - crg - SSP# 000001
0037 REM "000001-Internal call for timekeeping                               
0040 REM "Copyright 2020 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1000 REM 
1010 SETERR 9700; ENTER F0$
1020 LOG_OPTIONS$="A"; CALL "ZZ2LOG;OPEN_LOG",ERR=*NEXT,TMPX3$,TMPX4$,FN%GET_BASENAME$(PGN)+"."+FID(0)+".log",LOG_OPTIONS$,LOG_CHANNEL
1030 DIM TMPX3$(100),TMPX4$(100); CALL "ZZ2LOG;LOG_MSG",ERR=*NEXT,TMPX3$,TMPX4$,LOG_CHANNEL,""+F0$+"|"+FN%GET_STACK$,%LOG_INFO
2000 REM "
2005 IF MOD(LEN(F0$),2)<>0 THEN GOTO 9700
2010 IF F0$="" THEN GOTO 9900 ELSE FOR X=1 TO LEN(F0$) STEP 2
2020 H9$="No FID",F=NUM(F0$(X,2),ERR=9700),F$=FID(F,ERR=2050),FILE$=FIN(F,"FILENAME"); CLOSE (F)
2025 H9$=F$(4,6)+F$(21,2),H9$=STP(H9$,1); GOTO 2070
2060 PRINT @(0,22),'CE','RB',"Conflict "+STR(E0)+" File: "+H9$+", Program "+PGN+" @ "+STR(TCB(5))+" <Ret> to Retry ",@(0,23),"Contact Support if condition persists - Do NOT interrupt this process.",; INPUT @(78,22),*,@(0,22),'CE',; IF TCB(5)=2020 THEN GOTO 2020 ELSE GOTO 2025
2070 REFILE H9$,ERR=REFILE_ERR
2072 DIM TMPX3$(100),TMPX4$(100); CALL "ZZ2LOG;LOG_MSG",ERR=*NEXT,TMPX3$,TMPX4$,LOG_CHANNEL,""+H9$+"|"+FN%GET_STACK$,%LOG_INFO
2075 OPEN (F)F$(4,6)+F$(21,2)
2077 CONTINUE:
2080 IF F$(10,1)=$00$ THEN GOSUB 5200
2090 NEXT X
2100 REM "
2190 GOTO 9900
5200 REM "INITIALIZE INDEXED FILE F0
5210 DIM Y[4]
5220 Z=NUM(FIN(F,"MAXREC")); Y[3]=Z-1,Y[4]=-1,Y[2]=1
5230 Y[4]=-1; WRITE (F,IND=0)Y[0],Y[1],Y[2],Y[3],Y[4]
5290 RETURN 
7000 REFILE_ERR:
7002 IF H9$<>FILE$ THEN GOTO 7020 ! SSP#205455 showed up in oracle testing T/M Profile >6 characters h9$<>whole file name
7005 IF %GUI THEN X$="+("+FILE$+", "+STR(ERR)+" in use by process: "+FN%TCB87$("%p, %U") ELSE X$=FILE$+", "+STR(ERR)+" in use by process: "+FN%TCB87$("%p, %U") ! 248257
7010 CALL "ZZPROM",".4",%X3$,S3,X$,"","",0
7020 REFILE FILE$,ERR=REFILE_ERR
7030 OPEN (F)FILE$
7045 GOTO CONTINUE
9700 REM 
9720 EXIT 99
9800 REM 
9900 REM 
9910 CALL "ZZ2LOG;CLOSE_LOG",ERR=*NEXT,TMPX3$,TMPX4$,LOG_CHANNEL
9920 EXIT 
9999 END 
56002 REM "248257-Modify the Error Handler program, report more information   
