0010 REM "Display background screen <ZZVRDY>
0030 REM "(C) 1985,1986 Basic Ideas, Inc; Atlanta, Ga.
0035 REM "4.1 - 02/08/97 - 13.03 - kmc
0040 REM "Copyright 1997 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1000 ENTER X3$,X0$,V0$,R0,R1,R2,R3
1005 DIM S$(R3)
1010 IF X1$="*" THEN X1=-1 ELSE IF V0<0 THEN C0=ABS(V0),V0=0
1015 C0=C0+3
1120 F9$=FID(14,ERR=1121)
1190 CLOSE (14); OPEN (14)"ZMP"
1410 G0$=""; FIND (14,KEY=V0$+X3$(198,1),DOM=1411)*,G0$
1420 V1$=""; READ RECORD (14,KEY=V0$+X3$(239,1),DOM=1500)V1$
1490 GOTO 2000
1510 READ RECORD (14,DOM=1520,KEY=V0$+" ")V1$; GOTO 2000
1550 GOTO 9900
2010 V1$=MID(V1$,9),P=POS($8A$=V1$),X1$=MID(V1$,1,P-1),V1$=MID(V1$,P+1,POS($8A000000$=V1$(P+1))-1)
2015 LFPOS=POS($8A$=V1$); IF LFPOS<>0 THEN V1$(LFPOS,1)=" "; GOTO 2015
2038 PRINT 'SB',; IF POS("B"=X0$)>0 THEN PRINT 'BX',
2040 FOR X=R1 TO R1+R2; PRINT @(R0,X),S$(1,R3),; NEXT X
2060 GOSUB 3000
2080 IF G0$>"" THEN V1$=G0$; PRINT 'BG',; GOSUB 3000; PRINT 'EG',
2085 PRINT 'SF',
2095 GOTO 9900
3000 REM "PARSE UP PRINT STRING
3005 REM "C0 IS START LINE
3010 P=1,E1=C0,E0=0
3020 Q=POS($1B$=V1$(P+1)+$1B$)
3025 Q$=MID(V1$,P,Q),P=P+Q
3040 IF MID(Q$,1,2)=$1B01$ THEN E0=ASC(Q$(3,1)),Q$=MID(Q$,4); GOSUB 5000; GOTO 3090
3045 IF Q$=$1B4C46$ THEN E1=E1+1; GOTO 3090
3090 IF MID(V1$,P)>"" THEN GOTO 3020
3095 RETURN 
4020 CLOSE (14); OPEN (14,ERR=4090)"ZZG"
4050 READ (14,KEY=V0$,DOM=4090)*,G0$
4060 CALL "ZZ2ASG",X3$,G0$,"",0
4090 RETURN 
5000 REM "PRINT Q$ AT E0,E1
5005 REM "R0,R1 IS START CO-ORD, R2=#LINES, R3=WIDTH
5010 IF E1<R1 OR E1>R1+R2 THEN GOTO 5290
5015 IF E0>R0+R3 THEN GOTO 5290
5020 E=E0+LEN(Q$); IF E<R0 THEN GOTO 5290
5040 IF E0<R0 THEN Q$=MID(Q$,R0-E0+1),E0=R0
5045 IF E>R0+R3 THEN Q$=MID(Q$,1,LEN(Q$)-(E-(R0+R3)))
5090 PRINT @(E0,E1),Q$,
5290 RETURN 
5985 PRINT 'SB',
9910 CLOSE (14); IF F9$>"" THEN IF LEN(F9$)=2 THEN OPEN (14)F9$ ELSE OPEN (14)F9$(4,6)+F9$(21,2)
9950 EXIT 
9999 END 
