0010 REM "Terminal Control Key Settings <ZZCTRL>
0020 SETESC 9300; SETERR 9000
0035 REM "3.9 - 04/09/96 - 14.19 - wmz
0040 REM "Copyright 1995 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$; Z8$="*"
0100 SETERR 9000
0110 X0$="ZZCTRL",X1$="Terminal Control Key Settings"
0115 X1$=""
0120 DIM Z9$(12,"0")
0135 C9=-1,D0=340; DIM X3$(D0-1)
0200 REM **********"CHECK IF PARAMETER PASSED"*******
0205 IF Z8$>"" THEN PRINT @(0,1),'CL',@(0,3),'CE',; GOTO 0260
0210 PRINT 'CS','SB',@(0,2),Z0$,
0240 PRINT @(0,1),'CL',@(35-INT(LEN(X1$)/2),1),X1$,
0260 IF X3$="" THEN X3$=S$
0280 REM ****** GET TERMINAL NAME(KEY) *********
0290 CALL "ZZCTLK",X3$,K9$,"Z"; K9$="TCTL"+K9$,K9=LEN(K9$)
0300 REM "IOLISTS
0310 IOLIST A$
0312 IOLIST X3$,M1$,M2$,M3$,M4$,A9$
0500 REM "FILES
0505 DIM Z[14]
0520 GOSUB 7900; Z[1]=X0,Z[13]=X0,X3$(1,8)=FID(0)
0570 FIND (Z[1],KEY=X3$(1,8),DOM=0590)IOL=0312
0600 REM ******* "DISPLAY BACKGROUND SCREEN" **********
0680 CALL "ZZVDTP",X3$,X0$,X1$,V0$,0
1000 REM ******** "LOAD TERMINAL VARIABLE" ********
1035 DIM A$(321+K9)
1040 A$(1,LEN(A$))="TCTLXXXXXXXXC4          0D          C8          C8          BB          C1          CA          D0          C5          CD          RESERVEDReturn  <--     <--     <F4>    <F10>   -->     Del     <F2>    <F3>    B8          B9          BA          BB          BC          BD          BE          BF          C0          C1           "
1045 A$(1,LEN(K9$))=K9$
1046 REM ****** "COMPUTE CNTRL KEYS, DISPLAY KEYS, ERROR DO BACKGROUND *****
1050 GOSUB 7500
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1500
1200 REM "
1215 IF C0<0 THEN ON INT(-C0)-1 GOTO 6800,9800
1500 REM "
1505 Z9=-1,A2$="",A3$="",A4$="",A5$=""
1510 A1$=K9$
1520 READ (Z[1],KEY=A1$,DOM=1521)IOL=0310; GOSUB 7500
1525 Z9=0
1590 GOTO 1700
1600 REM "
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630
1630 GOTO 9800
1690 GOTO 2000
1700 REM "
1790 GOSUB 6200
1800 REM "
1810 PRINT @(0,22),'CL',@(5,22),"Press M to modify the current settings or E to end: ",
1820 READ RECORD (0,SIZ=1)Q$; IF POS(Q$="eE")>0 THEN GOTO 5000 ELSE IF POS(Q$="uU")>0 THEN GOSUB 8400; GOTO 1800 ELSE IF POS(Q$="mM")=0 THEN PRINT 'RB',; GOTO 1800
1840 PRINT @(0,22),'CL',@(5),"Press C to modify control keys, F for function keys, E to end: ",; READ RECORD (0,SIZ=1)Q$
1845 IF POS(Q$="eE")>0 THEN GOTO 1800 ELSE IF POS(Q$="cCfF")=0 THEN GOTO 1840
1850 IF POS(Q$="cC")>0 THEN F$="Control key",F0=0 ELSE F$="Function key",F0=1
1860 PRINT @(0,22),'CL',@(5),"Enter the ",F$," digit 0-9 to modify or E to end: ",; READ RECORD (0,SIZ=1)Q$
1870 IF POS(Q$="eE")>0 THEN GOTO 1840
1880 IF POS(Q$="0123456789")=0 THEN PRINT 'RB',; GOTO 1860
1885 F1=NUM(Q$)
1900 REM "SET VALUES
1905 W0$=F$+" "+STR(F1)
1910 Q1=6+F1,Q0=28; IF F0=1 THEN Q0=65
1920 GOSUB 8000
1930 IF Q$="" THEN GOTO 1860 ELSE Q$=HTA(Q$),Q=1+K9+F0*200+F1*12
1935 A$(Q,12)=Q$
1940 PRINT @(Q0,Q1),Q$,"*",
1945 IF F0=1 THEN GOTO 1860
1990 GOTO 1860
2100 REM "Hex value
2110 CALL "ZZENTR","SX",A{ALL},A$,X4$,X3$,28,6,1+K9,12,C0,"","{3"+X$,K9$,"ZZCTRL00","ZZPA","","09V0"; IF C0=6 THEN GOSUB 6400; C0=1
2140 GOTO 2020
2150 REM "Control key names
2160 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,43,6,121+K9,8,C0,"","{3"+X$,"","ZZCTRL02","","","09V0"
2190 GOTO 2020
2200 REM "Function keys Hex Value
2210 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,65,6,201+K9,12,C0,"","{3"+X$,"","ZZCTRL04","","","09V0"
2240 GOTO 2020
5000 REM 
5050 GOTO 6700
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6060 PRINT @(0,3),V0$,
6081 ESCAPE 
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6220 PRINT @(28,6),A$(1+K9,12),@(28,7+V0),A$(13+K9,12),@(28,8+V0),A$(25+K9,12),@(28,9+V0),A$(37+K9,12),@(28,10+V0),A$(49+K9,12),@(28,11+V0),A$(61+K9,12),@(28,12+V0),A$(73+K9,12),@(28,13+V0),A$(85+K9,12),@(28,14+V0),A$(97+K9,12),@(28,15+V0),A$(109+K9,12),@(43,6),A$(121+K9,8),@(43,7+V0),A$(129+K9,8),@(43,8+V0),A$(137+K9,8),@(43,9+V0),A$(145+K9,8),@(43,10+V0),A$(153+K9,8),@(43,11+V0),A$(161+K9,8),@(43,12+V0),A$(169+K9,8),@(43,13+V0),A$(177+K9,8),@(43,14+V0),A$(185+K9,8),@(43,15+V0),A$(193+K9,8),@(65,6),A$(201+K9,12),@(65,7+V0),A$(213+K9,12),@(65,8+V0),A$(225+K9,12),@(65,9+V0),A$(237+K9,12),@(65,10+V0),A$(249+K9,12),@(65,11+V0),A$(261+K9,12),@(65,12+V0),A$(273+K9,12),@(65,13+V0),A$(285+K9,12),@(65,14+V0),A$(297+K9,12),@(65,15+V0),A$(309+K9,12),
6250 PRINT @(43,11+V0),"<F10>",
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 PRINT @(0,3),'CE','SB',
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6490 RETURN 
6500 REM "DELETE
6510 REMOVE (Z[1],KEY=A1$,DOM=6511)
6590 GOTO 1630
6600 REM "ALT KEY DATA READS
6690 RETURN 
6700 REM "ADD ENTRY
6710 WRITE (Z[1],KEY=A1$)IOL=0310
6790 GOTO 1630
6800 REM "NEXT ENTRY IN FILE
6810 A1$=KEY(Z[1],END=6895)
6820 IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 6895
6825 A$(1,LEN(A1$))=A1$
6830 GOSUB 6600
6835 GOSUB 6450
6890 GOTO 1515
6895 PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=1140); GOTO 1140
7000 REM 
7500 REM ********* "COMPUTE CTRL STUFF "**********
7505 Q0$=""
7510 FOR X=1 TO 9; Q$=FNS$(A$(1+K9+X*12,12)),Q$=Q$+Z9$(1,12-LEN(Q$)); Q0$=Q0$+Q$; NEXT X
7520 FOR X=0 TO 9; Q$=FNS$(A$(201+K9+X*12,12)),Q$=Q$+Z9$(1,12-LEN(Q$)); Q0$=Q0$+Q$; NEXT X
7580 X3$=X3$(1,D0-1)+Q0$
7590 RETURN 
7900 REM ***** GET OR OPEN ZZPARM, OPEN TERMINAL FOR READING ********
7901 X0=0,X1=-1; CLOSE (14); OPEN (14)FID(0); Z[9]=14
7905 X0=X0+1
7910 Q$=FID(X0,ERR=7950); IF LEN(Q$)=2 THEN GOTO 7905 ELSE IF Q$(4,6)="ZZPARM" THEN GOTO 7990
7950 IF ERR=14 AND X1<0 THEN X1=X0 ELSE IF ERR=41 THEN GOTO 7980
7960 GOTO 7905
7980 IF X1>0 THEN X0=X1; OPEN (X1)"ZZPARM" ELSE X0=-1
7990 RETURN 
8000 REM *****"INPUT STRING ON SCREEN READ TERMINAL AS FILE *****
8010 PRINT @(5,22),"Press the key to be used for ",FNS$(W0$)," and wait...:",
8100 Q$=""
8110 READ RECORD (Z[9],SIZ=1,TIM=7,ERR=8200)Q0$
8115 Q$=Q$+Q0$
8120 READ RECORD (Z[9],ERR=8150,SIZ=1,TIM=1)Q0$
8130 Q$=Q$+Q0$; GOTO 8120
8150 IF LEN(Q$)<=6 THEN PRINT @(0,22),'CL',; RETURN 
8160 PRINT 'RB',@(0,22),'CL',"TOO MANY CHARACTERS IN INPUT - WAIT TO RETRY...",
8165 WAIT W0; PRINT 'RB',@(0,22),'CL'
8170 GOTO 8000
8200 PRINT 'RB',@(0,22),'CL',"NO KEY PRESSED - WAIT TO CONTINUE...",
8210 WAIT W0; PRINT 'RB',@(0,22),'CL',
8220 RETURN 
8400 REM ******** "SAVE DEFAULTS ********
8410 IF Z9$="*" THEN PRINT 'RB',; GOTO 8440
8420 EXECUTE "1040A$(1,LEN(A$))="+$22$+A$+$22$
8430 SAVE 
8440 RETURN 
8910 DEF FNS$(X$)=X$(1,POS("  "=X$+"  ")-1)
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9930 SETERR 9940; Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
