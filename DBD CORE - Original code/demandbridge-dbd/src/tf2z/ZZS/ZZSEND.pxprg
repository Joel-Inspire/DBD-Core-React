0010 REM "SEND SMC DATA FILES - ZZSEND
0100 BEGIN 
0105 GOSUB 3400
0106 DIM Z0$(256,$00$)
0110 OPEN (2)"T5"
0120 OPEN (5)"$ERR"
0140 PRINT 'CS',
0150 PRINT "** TRANSFER SMC PROGRAMS **"
0160 PRINT 'LF','LF',
0201 GOTO 0300
0209 GOTO 0275
0211 F9$="ZZ2MMA"
0212 F9$="BIISNDZZ2MMBXZCTRL"
0213 F9$=""
0275 IF F9$="" THEN GOTO 0300
0280 GOTO 2015
0300 SETERR 2000
0302 PRINT ""
0305 INPUT "ENTER FILE NAME: ",F$
0306 GOTO 0375
0330 IF F$="" THEN GOTO 9900
0375 PRINT ""
0380 PRINT "FILE: ",F$,
0385 WAIT 3
0400 REM 
0410 CLOSE (1); OPEN (1,ERR=0300,ISZ=256)F$; F$=FID(1),F9=-1
0411 IF F$(10,1)=$00$ THEN GOTO 2000
0415 IF F$(10,1)<>$04$ THEN CLOSE (1); OPEN (1)F$(4,6)+F$(21); F$=FID(1)
0435 F$=$FFFFFF$+F$,F8=0
0440 WRITE RECORD (2)HTA(F$)
0445 WAIT 2
0450 F9=0; EXTRACT RECORD (1,IND=0,ERR=0456)A$; IF F$(13,1)<>$04$ THEN F9=LEN(A$); GOTO 0456 ELSE F9=-1
0455 F7=256+DEC(A$(1,3)),A$="",F7=INT(F7/256)
0460 PRINT @(18),F8:"##0"," OF ",F7:"###"," ",100*F8/F7:"###0","% Complete",
0600 REM "
0602 IF F9=-1 THEN GOTO 0618
0610 K$=KEY(1,END=2000); READ RECORD (1)A$
0612 A$=A$(1,POS(Z0$=A$+Z0$)-1)
0615 F8=F8+1; A$=K$+"G"+A$+"H"; GOTO 0625
0618 SETERR 9000; IF F9=-1 THEN F8=IND(1); IF F8>F7 THEN GOTO 2000
0620 IF F9=-1 THEN READ RECORD (1,END=2000)A$
0630 GOTO 0700
0640 PRINT @(10),X:"#,##0",
0650 GOTO 0885
0800 REM "
0801 PRECISION 4; T0=TIM; PRECISION 2
0805 S0=8; IF F9<>-1 THEN S0=1; IF LEN(A$)/8=INT(LEN(A$)/8) THEN S0=8
0810 Q$=HTA(A$)
0820 FOR X=1 TO LEN(Q$) STEP S0
0825 PRINT @(10),X:"#,##0",
0840 WRITE RECORD (2,SIZ=1)Q$(X,S0)
0860 GOSUB 7000
0880 NEXT X
0882 WAIT 1
0885 IF F9=-1 THEN PRINT @(18),F8:"##0"," OF ",F7:"###"," ",100*F8/F7:"###0","% Complete",
0886 PRECISION 4; T0=3600*(TIM-T0)
0890 GOTO 0600
2000 REM "END
2002 SETERR 0000
2005 IF F9$="" THEN GOTO 0300
2010 F9$=F9$(7)
2015 IF F9$="" THEN GOTO 9900 ELSE F$=F9$(1,6)
2040 GOTO 0310
2090 GOTO 9900
3000 REM "GET NEXT FILE NAME
3010 CLOSE (9); OPEN (9)"DEV"
3020 K$=KEY(9,END=3080); READ (9)
3022 IF K$(1,5)<>"ZZXAP" AND K$(1,5)<>"ZZXGL" THEN GOTO 3020
3030 IF K$(7,2)="  " THEN F9$=F9$+K$(1,6); PRINT K$(1,6)," ",
3050 GOTO 3020
3080 ESCAPE 
3090 RETURN 
3100 REM 
3120 F9$="ZY2MMAZY2PLAZY2PLBZY2PLDZY2PLEZY2PLSZY2PLUZY2PRSZZ2ACCZZ2ASSZZ2BAAZZ2BAGZZ2BASZZ2BAYZZ2BAZZZ2BCAZZ2BOXZZ2FAAZZ2FCAZZ2FCBZZ2FCSZZ2FPAZZ2LAAZZ2LABZZ2MBAZZ2MBBZZ2MDAZZ2MDXZZ2MMAZZ2MMBZZ2MNPZZ2MOAZZ2PAAZZ2PBAZZ2PCAZZ2PLCZZ2PLDZZ2RAAZZ2RABZZ2RACZZ2RADZZ2RAEZZ2RAFZZ2RCAZZ2RCBZZ2RCCZZ2RCDZZ2RCEZZ2RLAZZ2RMAZZ2RMSZZ2RRAZZ2RRSZZ2RSSZZ2SYSZZ3MAAZZ3MBAZZ3MMAZZ3MMBZZ9BAAZZACCTZZADDRZZAVSPZZBANKZZCALCZZCOMPZZCTRLZZDATEZZDCHKZZDEQUZZDISCZZDISPZZDROPZZEND ZZENTRZZERPTZZERRMZZEXPFZZFDEFZZFILEZZFIXEZZFIXLZZFIXPZZFLESZZFMAPZZFUNCZZGHSTZZHDINZZHDOCZZHEADZZHELPZZINFOZZINITZZINPTZZLFIXZZLISTZZMAILZZMASKZZMDOCZZMERGZZMESGZZOPTNZZPACKZZPRINZZPROMZZREADZZREBUZZRESTZZRPTOZZSCRNZZSECTZZSENDZZSEQUZZSETDZZSORTZZSSTAZZSTRTZZTIMEZZVOLSZZXGL1"
3190 RETURN 
3400 REM "DISABLE OTHER DISKS
3401 GOTO 3490
3410 FOR X=0 TO 4
3415 SETERR 3416; ENABLE (X)
3420 SETERR 0000; DISABLE (X)
3430 NEXT X
3490 RETURN 
7000 REM "
7005 Z0=200
7008 IF S0=1 THEN Z0=14
7010 FOR Z=0 TO Z0; NEXT Z
7050 RETURN 
9000 REM "ERR
9005 SETERR 9080
9010 READ (5,IND=0)P; P=P+1; WRITE (5,IND=0)P
9020 WRITE (5,IND=P)"ERROR: ",ERR," LINE: ",TCB(5)," PROG: ",F$(7,6)+F$(24,2),"IND:",F8
9080 SETERR 9000
9090 GOTO 2000
9900 REM 
9901 ESCAPE 
9910 IF A5=1 THEN GOTO 9990
9915 A5=1
9916 ENABLE (3)
9920 GOSUB 3000
9930 GOTO 2015
9950 END 
