0010 REM "Screen selection routine <ZZSLCT>
0030 REM "(C) 1985,1986,1987 Basic Ideas, Inc; Atlanta, Ga.
0035 REM "3.8 - 08/29/95 - 15.81 - kmc
0040 REM "Copyright 1995 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0990 SETERR 9000
1020 ENTER X3$,X9$,C1$,R4$,D$,P0$,H9$,X8,X9,Y0
1025 A0$=$1B$+"B"+X3$(46,1),A1$=$1B$+"E"+X3$(46,1); IF A0$(1,1)=" " THEN A0$="",A1$=""
1030 X9=-1; IF D$="" THEN GOTO 9900
1040 IF POS(X3$(238,1)="02")<>0 THEN D9=1
1050 IF POS("D"=X9$)>0 THEN D2=1,C0=0
1210 Y0$="",Y1$="",Y0=1,D0$=D$
1220 Y0$=Y0$+D0$(1,2)+BIN(Y0,2)+D0$(3,1),D0=ASC(D0$(3,1)),Y0=Y0+D0
1225 Y1$=Y1$+D0$(4,D0),D0$=D0$(D0+4); IF D0$>"" THEN GOTO 1220
1410 P9$=X3$(29,1),X3$(29,1)=""
2005 Y0=X8
2010 IF Y0<0 THEN IF POS("X"=X9$)>0 AND C0<>0 THEN GOTO 3030 ELSE Y0=LEN(Y0$)/5-1
2012 IF Y0*5>=LEN(Y0$) THEN IF POS("X"=X9$)>0 AND C0<>0 THEN GOTO 3020 ELSE Y0=0,D2=0
2020 X=ASC(Y0$(Y0*5+1,1)),Y=ASC(Y0$(Y0*5+2,1)),S0=DEC(Y0$(Y0*5+3,2)),S1=ASC(Y0$(Y0*5+5,1)),Q$=Y1$(S0,S1)
2025 X0=X,X1=X+S1
2110 IF D9=1 THEN PRINT @(X0,Y),A0$,Q$,A1$,'ER', ELSE PRINT @(X1,Y),A1$,@(X0-1,Y),A0$,
2120 IF POS("H"=X9$)>0 THEN IF D2<>0 AND POS("M"=X9$)>0 OR (D2=0 AND POS("M"=X9$)=0) THEN GOSUB 4000
2140 IF D2=0 THEN W$=" "; CALL "ZZENTR","XPUF"+X4$,X{ALL},W$,"",X3$,X0,Y,1,L,C0,"",P0$+"","","","","",""; C0$=STR(C0:"000") ELSE X4$=X4$+Q$(1,1)
2410 IF C0=1 OR C0>10 THEN IF POS("R"=X9$)>0 THEN GOTO 2425
2420 IF D9=1 THEN PRINT @(X0,Y),Q$, ELSE PRINT @(X0-1,Y)," ",Q$," ",
2425 IF D2=0 THEN IF POS("C"=X9$)>0 AND POS(W$=X4$)>0 OR POS(C0$=C1$,3)>0 THEN GOTO 3000
2430 IF C0=4 AND POS("C"=X9$)=0 THEN X9=1; GOTO 9900 ELSE IF C0=1 THEN X9=Y0; GOTO 9900
2440 IF C0=2 OR C0=3.2 THEN Y0=Y0-1 ELSE IF C0=6 OR C0=3.1 OR C0=0 THEN Y0=Y0+1 ELSE PRINT 'RB',
2580 GOTO 2010
3005 IF C1$>"" THEN IF POS(C0$=C1$,3)>0 THEN X9=(-INT(POS(C0$=C1$,3)/3))-2; EXIT 
3010 X9=POS(W$=X4$)-1; EXIT 
3020 X9=2; EXIT 
3030 X9=1; EXIT 
3090 EXIT 
4005 H$=FNS$(H9$(Y0*35+1,35)),H0=1,H1=LEN(H$); IF H$>"" THEN IF POS("M"=X9$)=0 THEN PRINT @(0,23),'CL'," ",H$, ELSE PRINT @(12+X0,Y),H$,
4090 RETURN 
8910 DEF FNS$(Z$)=Z$(1,POS("     "=Z$+"     ")-1)
9005 IF ERR=65 OR ERR=66 OR ERR=69 THEN SETERR 9000; RETRY 
9010 PRINT @(0,20),"ERR ",ERR,"@ ",TCB(5)," PROG: ZZSLCT",; INPUT *
9040 EXIT ERR
9950 EXIT 
9999 END 
