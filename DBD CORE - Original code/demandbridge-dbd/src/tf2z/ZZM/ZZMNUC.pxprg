0010 REM "Select Company Code <ZZMNUC>
0030 REM "(C) 1985,1986 Basic Ideas, Inc; Atlanta, Ga.
0035 REM "5.7 - 06/11/09 - 8.770833 - tma - SSP# 230563
0037 REM "230563-Problem with tfcentral login after new release, setting     
0040 REM "Copyright 2009 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 REM 
0120 X1$="Company Selection"; DIM S$(40)
0320 DEF FNS$(Q$)=Q$(1,POS(S$=Q$+S$)-1)
1020 ENTER X3$,X4$,T0$,N1$
1030 SETERR 9000
1040 FOR X=1 TO 13; Q$=FID(X,ERR=1045); NEXT X; EXIT 14
1050 F9=X,F8=1; EXITTO 1051
1055 OPEN (F9)"ZZPARM"; READ (F9,KEY="o"+X3$(40,3),DOM=9900)O9$; IF T0$>"" THEN C0$=T0$; GOTO 1720
1060 PRINT @(0,4),'CE'
1100 REM 
1110 READ (F9,KEY="o"+X3$(40,3),DOM=9900)O9$
1200 REM "DISPLAY COMPANIES
1205 L0=0,L1=0
1220 READ (F9,KEY="CMP000",DOM=1221)
1250 READ (F9,END=1300)F$
1260 IF LEN(F$)<6 THEN GOTO 1300
1270 IF F$(1,3)<>"CMP" THEN GOTO 1300
1272 REM IF F$(181,1)<>" " THEN IF POS(F$(181,1)=X3$(154,8))=0 THEN GOTO 01250
1273 IF F$(181,1)<>" " THEN IF POS(F$(181,1)=O9$(43,8))=0 THEN GOTO 1250
1280 PRINT @(18,5+L0),F$(4,3),"  ",F$(7,40)
1285 L0=L0+1
1288 IF L0>=13 THEN L2=1; GOTO 1300
1290 GOTO 1250
1310 CALL "ZZPROM","X0ZZMNUC",X3$,0,O0$,"","",0
1320 CALL "ZZPROM","X1ZZMNUC",X3$,0,O1$,"","",0
1600 REM "
1610 REM IF L3>0 AND L0<=13 THEN GOTO 01220
1620 DIM C0$(3)
1625 O$=O0$; IF L2>0 THEN O$=O1$
1630 PRINT @(0,22),O$,
1640 CALL "ZZENTR","ZX",X{ALL},C0$,X4$,X3$,2+LEN(O$),22,1,3,C0,"","","","","","",""; PRINT @(0,22),'CL',; IF C0$="000" THEN DIM F$(200); GOTO 1725
1660 IF C0=-1 AND L2>0 THEN GOSUB 7000; GOTO 1250
1670 IF C0<0 THEN GOTO 9900
1720 DIM F$(195); READ (F9,KEY="CMP"+C0$,DOM=1721)F$(1); GOTO 1725
1722 IF T0$>"" THEN GOTO 9900 ELSE GOTO 1630
1730 IF F$(181,1)=" " OR POS(F$(181,1)=O9$(43,8))>0 THEN GOTO 1800
1740 CALL "ZZPROM","X2ZZMNUC",X3$,0,"","","",0; GOTO 1600
1810 X3$(9,3)=C0$
1812 N1$=FNS$(F$(7,40)); IF N1$="" THEN N1$="Computer Software Inc." ELSE IF X3$(27,1)="1" AND X3$(9,3)<>"   " THEN N1$=X3$(9,3)+" - "+N1$
1840 X3$(86,40)=N1$
1845 X3$(64,3)=F$(182,3),X3$(145,1)=F$(194,1),X3$(330,1)=F$(195,1)
1850 X4$=""; FIND (F9,KEY=X3$(9,3)+"ZZP",DOM=1851)X4$
1855 FIND (F9,KEY="   ZZP",DOM=1856)Q$; X4$=X4$+Q$(7)
1860 X3$(69,1)=F$(185,1)
1870 IF X3$(330,1)<>"1" THEN GOTO 1890 ELSE READ (F9,KEY="R/L"+X3$(9,3),DOM=1871)R9$; X3$(331,2)=R9$(7,2); GOTO 1890
1875 CALL "ZZPROM",".4",X3$,0,"This company is setup as a remote location but has no RL parameters","","",0
1900 REM "DISK
1905 D0$=FNS$(F$(186,8))
1910 CLOSE (14); OPEN (14,ERR=1911)D0$; Q$=FID(14); CLOSE (14); X3$(31,1)=STR(ASC(Q$(20,1)):"0"); GOTO 1920
1990 GOTO 9900
6220 PRINT @(0,0),'CL',@(0,1),'CL',@(35-INT(LEN(X1$)/2),1),X1$,@(0,2),Z$
6225 PRINT @(0,3),'CE',
7000 REM 
7005 L0=0,L1=0,L3=1; PRINT @(0,4),'CE',
7090 RETURN 
9005 IF ERR=65 THEN GOTO 9920
9010 PRINT @(0,22),'CE',"ERROR ",ERR," AT LINE ",TCB(5)," ZZMNUC",; INPUT *
9900 REM "
9905 IF NOT(%TFCENTRAL) THEN %C$=X3$(9,3) ! 224474  SSP#230563
9910 IF F8>0 THEN CLOSE (F9)
9920 EXIT 
9999 END 
56001 REM "224474-%C$ not being updated when company code changes here     
