0010 REM "Foreign Language Interface <ZZLANG>
0030 REM "(C) 1985,1986 Basic Ideas, Inc; Atlanta, Ga.
0035 REM "This software contains trade secrets and proprietary information"
1000 REM "
1030 ENTER X3$,L$
1100 REM "FILES
1110 IF X3$>"" THEN F9=NUM(X3$(60,3))
1115 IF F9=0 THEN F9=14
1120 F9$=FID(F9,ERR=1121)
1130 CLOSE (F9); OPEN (F9)"ZZPARM"
1135 IF L$="" THEN IF X3$(77,1)=" " THEN L$=" "
1140 IF L$="" THEN GOTO 1200 ELSE FIND (F9,KEY="LANG"+L$,DOM=1141)L$; GOTO 1630
1150 FIND (F9,KEY="LANG ",DOM=9900)L$; GOTO 9900
1200 L9=1
1202 FIND (F9,KEY="INSTALL",DOM=1203)Q$; IF Q$(76,1)="0" THEN L$=Q$(77,1); GOTO 1600
1205 L0$="",L0=0
1210 READ (F9,KEY="LANG",DOM=1211)
1220 K$=KEY(F9,END=1400); IF POS("LANG"=K$)<>1 THEN GOTO 1400
1230 READ (F9)Q$; IF L0=0 THEN K$=KEY(F9,END=1400); IF POS("LANG"=K$)<>1 THEN GOTO 1400
1240 IF L0$="" THEN PRINT @(0,4),'CE',
1245 L$=FNS$(Q$(18,40))
1250 PRINT @(48-LEN(L$),6+L0),L$,@(55),Q$(314,6)
1380 L0=L0+1,L0$=L0$+Q$(5,1)+Q$(308,12)+Q$(58,40)
1390 GOTO 1220
1400 REM "SELECT
1405 C0=0,L$=" "; IF L0<=0 THEN GOTO 1600
1410 CLOSE (F9); D0=F9; IF POS("G"=FID(0))<>1 THEN OPEN (F9)FID(0) ELSE D0=0
1415 PRINT @(51,C0+6),L0$(C0*53+2,6),'CL',
1420 Q$=FNS$(L0$(C0*53+13,40)),L$=L0$(C0*53+1,1)
1430 PRINT @(0,21),'CL',@(39-INT(LEN(Q$)/2),21),Q$,
1440 PRINT @(50,C0+6),">",
1450 REM "
1455 READ RECORD (D0,SIZ=1,TIM=60,ERR=1600)Q$; PRINT @(54,C0+6)," ",
1460 IF Q$=" " THEN GOTO 1600 ELSE PRINT @(50,C0+6),'CL',@(55,C0+6),L0$(C0*53+7,6),
1480 C0=C0+1,C0=MOD(C0,L0)
1490 GOTO 1415
1600 REM "
1610 CLOSE (F9); OPEN (F9)"ZZPARM"
1620 Q$=L$; DIM L$(660); READ (F9,KEY="LANG"+Q$)L$(1)
1630 DIM L1$(40); READ (F9,KEY="PRFD"+L$(5,1),DOM=1631)L1$(1)
1640 GOSUB 7500
1690 GOTO 9900
7500 REM "Set X3$ language params
7505 X3$(221,5)=L1$(9,1)+L1$(9,1)+":"+L1$(10,1)+L1$(10,1)
7510 X3$(239,1)=L$(5,1),X3$(202,6)=L1$(11,6)
7515 X3$(70,3)=L1$(6,3)
7555 X3$(208,12)=L$(308,12),X3$(128,12)=L$(534,12)
7560 X3$(240,24)=L$(570,24),X3$(264,12)=L$(626,12)
7590 RETURN 
8910 DEF FNS$(Z$)=Z$(1,POS("   "=Z$+"   ")-1)
9900 REM 
9910 CLOSE (F9); IF F9$>"" THEN IF LEN(F9$)=2 THEN OPEN (F9)F9$ ELSE OPEN (F9)F9$(4,6)+F9$(21,2)
9950 EXIT 
9999 END 
