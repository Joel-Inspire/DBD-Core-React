0010 REM "CHECK FOR DUPLICATE FILES <UT2DUP>
0020 BEGIN 
0030 INPUT 'CS',"ENTER DISK NUMBER TO CHECK: ",D
0040 D$="D"+STR(D)
0050 ADDR "ZZXPRG",ERR=0051
0110 OPEN (1,ERR=0020)D$
0120 Q$="TMP"+FID(0); ERASE Q$,ERR=0121; GOTO 0120
0125 SORT Q$,8,500
0126 OPEN (3)Q$
0130 INPUT "HARD COPY? (Y/N): ",L9$; IF L9$="N" THEN GOTO 0131 ELSE IF L9$<>"Y" THEN GOTO 0130 ELSE OPEN (7)"LP"; PRINT (7)'FF'
1010 D0=IND(1); READ RECORD (1,END=1200)K$; K$=FNZ$(K$(3))
1011 GOTO 1015
1012 K$=KEY(1,END=1200); K$=K$(1,8)
1015 CLOSE (1); OPEN (1,ERR=1050)K$; Q$=FID(1); IF Q$(10,1)>CHR(9) THEN GOTO 1050 ELSE Q$=""; CALL "ZZXPRG",ERR=1016,Q$,1,""; CLOSE (1)
1020 DISABLE (D)
1025 PRINT @(0),K$," ",
1030 OPEN (2,ERR=1040)K$; F$=FID(2)
1031 PRINT "  DUPLICATED"," ",Q$," DISK ",ASC(F$(20,1))
1032 WRITE (3,KEY=K$)
1035 IF L9$="Y" THEN PRINT (7)K$," DUPLICATED ON DISK: ",ASC(F$(20,1))," ",Q$
1038 CLOSE (2)
1040 ENABLE (D)
1050 CLOSE (1); OPEN (1)D$; READ (1,IND=D0); GOTO 1000
1060 GOTO 1000
1201 ESCAPE 
4000 REM 
4020 DROP "ZZXPRG",ERR=4021
8910 DEF FNZ$(X$)=X$(1,POS($0000$=X$+$0000$)-1)
