0100 BEGIN 
0150 INPUT "Approximate # of postings: ",A$; A=NUM(A$,ERR=0150)
0200 OPEN (1)"GL2002"
0220 ERASE "KKK",ERR=0221
0230 SORT "KKK",46,600
0250 OPEN (2)"KKK"
0300 REM READ (1,KEY="4",DOM=0301) 
0400 K$=KEY(1); READ (1,KEY=K$)A$,B$,A0
0410 REM IF K$(1,2)="45" THEN GOTO 1000
0500 PRINT A$(1,12)," ",A$(32,2),
0600 IF A$(32,2)<>"AR" THEN PRINT ""; GOTO 0400
0700 DIM C$(46); C$(1)=B$(17,5)+"00000"+B$(5,8)+A$(1,12)+STR(A0); PRINT "   ",C$
0750 C=NUM(C$(1,10),ERR=0900),C=NUM(C$(11,10),ERR=0900),C=NUM(C$(21,10),ERR=0900)
0800 WRITE (2,KEY=C$)
0900 GOTO 0400
1000 REM "REBUILD ARO PART
1005 I1=1
1010 CLOSE (1); CLOSE (2); CLOSE (3)
1020 OPEN (1)"AR6002"
1030 OPEN (2)"KKK"
1040 OPEN (3)"ARO002"
1080 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14]
1085 IOLIST C$,C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7]
1100 REM 
1105 READ (1,KEY="",DOM=1106)
1110 DIM B[14]; K0$=KEY(1,END=2000); READ (1,END=2000)IOL=1080
1120 PRINT B$(1,10)," ",B$(11,8)
1130 IF B[0]=0 THEN GOTO 1110
1135 IF B[3]=0 THEN B[0]=0; WRITE (1,KEY=K0$)IOL=1080; GOTO 1110
1140 READ (2,KEY=B$(1,18),DOM=1141)
1150 K$=KEY(2,END=1300)
1160 IF K$(1,18)<>B$(1,18) THEN IF B[3]<>0 THEN K$=B$(1,18)+"401990000000"+STR(-B[9]) ELSE B[0]=0; WRITE (1,KEY=K0$)IOL=1080; GOTO 1110
1165 B[0]=I1; WRITE (1,KEY=K0$)IOL=1080
1180 DIM C[7],C$(60)
1190 C$(1)=K$(1,18)+"  A"+B$(20,6)+B$(127,6)+B$(102,6)+K$(19,12),C[3]=NUM(K$(31))
1195 I2=0; READ (2,END=1200); K$=KEY(2,END=1200); IF K$(1,18)=B$(1,18) THEN I2=I1+1
1200 WRITE (3,IND=I1)I2,IOL=1085; I1=I1+1
1210 IF I2=0 THEN GOTO 1110 ELSE I1=I2; GOTO 1180
1300 ESCAPE 
