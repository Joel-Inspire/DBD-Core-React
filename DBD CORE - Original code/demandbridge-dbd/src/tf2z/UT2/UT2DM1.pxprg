0010 REM "Demo 1 System Menu Selection <UT2DM1>
0035 REM "2.3.2
0040 REM "Copyright 1986 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 BEGIN 
0120 DEF FNS$(X$)=X$(1,POS("    "=X$+"    ")-1)
0130 DEF FNP(X$)=38-INT(LEN(X$)/2)
0135 DEF FNQ(X0,X1)=X1-LEN(FNS$(L0$(X0,8)))-1
0140 DEF FNR$(X0)=FNS$(L0$(X0,8))+": "
0190 IF POS("G"=FID(0))=1 THEN RELEASE 
0200 REM "
0210 CALL "ZZCOMP",ERR=9700,X0$,X1$,X2$,X3$,X4$,X5$,-1,0,0
0215 CALL "ZZDAPP",X3$,"AALL"
0220 F0=NUM(X3$(60,3))-1,T9=ASC(X3$(197,1))-100,T9=T9*60
0300 M9$="   A/RARRARA   E/QT/M   O/PP/O   I/CF/M   A/PAPR   G/L   "
0360 IOLIST X3$,M1$,X4$,D0$
0405 DIM Z[NUM(X3$(60,3))]
0410 Z$="01O ZMP...  02O ZM1...  "
0450 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0460 REMOVE (F0,KEY=X3$(1,6)+"PF",DOM=0461)
0520 READ (F0,KEY="LANG"+X3$(239,1),DOM=0521)L0$; GOTO 0530
0525 READ (F0,KEY="LANG ",DOM=0600)L0$
0530 O8$=FNS$(L0$(218,45)),O9$=FNS$(L0$(263,45))
0535 O8=44,O9=35-INT(LEN(O9$)/2); IF LEN(O8$)>O8 THEN O8=LEN(O8$)+2
0600 REM "
0610 DIM S$(12),P0$(40)
0620 X8=56,F9=NUM(X3$(60,3))-1,X3$(185,1)=""
0640 READ (F9,KEY=X3$(1,8))IOL=0360; S0$="*",X3$(185,1)="M"
0645 GOSUB 5060
0650 DIM D0$(19); D0$(1,6)=X3$(1,2)+"DATE"
0655 READ (F9,KEY=D0$(1,6),DOM=0656)D0$; X3$(21,6)=D0$(7,6)
0660 PRINT 'CS',
1000 REM "GET MENU
1010 IF M1$="" THEN M1$=X3$(140,3)
1015 G0$="",Q$=X3$(239,1)+M1$(1,3); READ (Z[1],KEY=Q$,DOM=1016)M2$,Q9$; GOTO 1030
1020 IF Q$(1,1)=" " THEN GOTO 2900 ELSE Q$=" "+Q$(2); READ (Z[1],KEY=Q$,DOM=2900)M2$,Q9$
1030 IF M2$(2,3)="ZZZ" THEN M2$(53,3)=T$
1040 FIND (Z[1],KEY=M1$(1,3)+X3$(198,1),DOM=1041)*,G0$
1100 REM "
1200 REM "DISPLAY MENU
1210 PRINT 'CS','SB',
1220 IF X3$(78,1)="1" THEN PRINT @(FNQ(194,9),2),FNS$(L0$(194,8)),":",@(FNQ(202,69),2),FNS$(L0$(202,8)),":",
1240 Q$=FNS$(M2$(5,40)); IF Q$="" THEN GOTO 1250
1250 PRINT @(FNP(N1$),0),N1$,@(FNP(Q$),1),Q$,
1255 PRINT @(74,1)," (",FID(0),")",; IF X3$(40,3)<>"   " THEN PRINT @(FNQ(186,69),1),FNS$(L0$(186,8)),": ",X3$(40,3), ELSE PRINT @(FNQ(54,69),1),FNS$(L0$(546,8)),X3$(1,8)
1258 Q$=M2$(2,3); IF X3$(239,1)<>" " THEN Q$=X3$(239,1)+"-"+Q$
1260 IF M2$(2,3)<>"   " THEN PRINT @(FNQ(178,9)),FNR$(178),Q$,
1265 GOSUB 4200; IF S0$="*" THEN GOTO 1300 ELSE S0$="**"
1270 IF M2$(45,6)=S$(1,6) THEN GOTO 1300
1275 DIM P0$(60); P0$(15,6)=M2$(45,6),P0$(21,2)=M2$(51,2),P0=2,S0=1
1280 GOSUB 5200; IF O<0 THEN GOTO 2900
1300 REM "DATE RECORDS
1305 GOSUB 6900
1310 IF M2$(53,3)<>"   " THEN IF M2$(53,3)<>X3$(12,3) OR D9$="" THEN GOSUB 3900 ELSE GOSUB 4180
1415 PRINT @(0,3),'SB','BG',G0$,'EG','SF',
1420 PRINT @(0,3),Q9$,
1800 REM "OPTION ENTRY
1802 M9=M9+3; IF M9+1>LEN(M9$) THEN M9=0
1804 O$=M9$(M9+1,3),C0=0,S0$=""
1815 PRINT @(O8-LEN(O8$)-2,22),O8$,'CL',; IF M1$>"" THEN IF POS("ZZ"=M1$)<>1 THEN PRINT @(O9,23),O9$,
1817 M8$=""; INPUT (0,ERR=1818,TIM=3)@(O8,22),M8$; IF M8$="X" THEN END ELSE IF M8$="Y" THEN RUN "ZMENU"
1818 GOTO 1821
1820 DIM O$(7); O=LEN(O$); CALL "ZZENTR","SUT@",X{ALL},O$,X4$,X3$,O8,22,1,O,C0,"","",L0$(5,1),"MENU","ZM0","",""; IF C0=.1 THEN GOTO 1815 ELSE IF C0=10 THEN GOSUB 6800; GOTO 1820 ELSE IF ABS(C0)>4 THEN GOTO 1200 ELSE O$=FNS$(O$),S0$=""
1825 IF C0=4 THEN GOTO 3100 ELSE IF O$="" THEN GOTO 2900
1830 IF X3$(51,1)="0" THEN GOTO 1980
1900 REM "
1915 IF O$="OFF" THEN GOTO 3000
1920 IF O$="DAY" THEN GOSUB 4210; GOTO 1400
1921 IF O$="DATE" THEN GOSUB 4000; GOTO 1400
1925 IF O$="COMP" THEN GOSUB 5000; GOTO 1200
1926 IF O$="PROG" OR O$="MAINT" THEN GOSUB 5100; GOTO 2200
1927 IF O$="MAIN" THEN M1$=""; GOTO 1000
1930 IF O$="BASIC" THEN GOTO 9800
1935 IF O$="LOGIN" THEN RUN "ZSTART"
1940 IF O$="STAT" THEN CALL "ZZSSTA",X3$; GOTO 1400
1945 IF Q$="MAINT" THEN GOSUB 5100
1980 IF X3$(45,1)="1" THEN IF LEN(O$)=3 THEN Q0$=O$; GOTO 2100
1985 IF LEN(O$)=1 THEN O$=O$+" "
1990 READ (2,KEY=M2$(2,3)+O$(1,2),DOM=6000)P0$
1995 GOTO 2020
2000 REM "OPTION TIME
2020 Q0$=FNS$(P0$(7,8)),Q1$="",S0=0; GOSUB 5200; IF O<0 THEN GOTO 1200
2025 IF P0$(6,1)="M" THEN Q0$=P0$(7,3); GOTO 2100 ELSE IF P0$(6,1)<>"O" THEN GOTO 2200
2030 REM "SYSTEM OPTION
2035 O$=Q0$; GOTO 1900
2100 REM "DAUGHTER MENU
2104 IF POS(Q0$(1,3)=M1$)=1 THEN GOTO 1800
2110 M1$=Q0$(1,3)+M1$
2190 GOTO 1000
2200 REM "PROGRAM
2205 IF O9<0 THEN P0$(6,1)="N"
2215 X3$(185,1)=P0$(6,1),X3$(188,9)=P0$(23,9)
2240 FOR X=1 TO 4; CLOSE (X); NEXT X
2250 IF P0$(6,1)="A" THEN CALL "ZZAUDT",X3$,Q0$(1,6),F9,X9 ELSE X3$(178,6)=""
2300 REM "RUN PROG Q0$
2310 X3$(146,8)=Q0$
2340 WRITE (F9,KEY=X3$(1,8))IOL=0360
2350 IF P0$(6,1)="N" THEN Q0$="ZMAINT"
2385 SETERR 0010
2390 RUN Q0$
2900 REM "GO TO PRIOR MENU
2910 IF M1$="" THEN GOTO 1820 ELSE REM IF POS(M1$(1,3)="PLAZZS",3)>0 THEN LET O$="LOGIN"; GOTO 1935
2920 M1$=M1$(4),S0$="*"
2930 IF M1$="" AND M2$(2,3)=X3$(140,3) THEN GOTO 1820 ELSE GOTO 1000
3000 REM "
3010 REMOVE (F9,KEY=X3$(1,8),DOM=3011)
3040 RUN "ZZEND"
3100 REM "STATUS OPTIONS
3105 IF POS("ZZZ"=M1$)=1 THEN GOTO 1800 ELSE IF M2$>"" THEN T$=M2$(53,3)
3110 M1$="ZZZ"+M1$
3130 GOTO 1000
3900 REM "GET DATE
3905 IF M2$(53,3)="   " THEN RETURN 
3910 P=POS(M2$(53,3)=D0$(20),9); IF P=0 THEN GOTO 4000 ELSE P=P+22
3915 IF D0$(P,6)=S$(1,6) THEN GOTO 4000 ELSE GOTO 4160
4000 REM "DATE CODE
4005 D$=M2$(53,3); IF D$="   " THEN CALL "ZZPROM","X0ZMENU",X3$,0,"","","",0; RETURN 
4015 EXTRACT (F9,KEY=D0$(1,6),DOM=4016)D0$
4030 P=POS(D$=D0$(20),9); IF P=0 THEN D0$=D0$+D$+"      "; GOTO 4030 ELSE P=P+22
4100 REM "
4110 Q$=FNS$(L0$(380,30)); IF LEN(D0$)>28 THEN Q$=Q$+" ("+D$+")"
4120 PRINT @(0,4),'CE',@(38-LEN(Q$),7),Q$,":"
4140 CALL "ZZENTR","D1",X{ALL},D0$,X4$,X3$,41,7,P,6,C0,"","","","","","",""
4145 PRINT 'CF',
4150 WRITE (F9,KEY=D0$(1,6))D0$
4160 REM "ADJUST TERMINAL DATE
4170 X3$(12,3)=M2$(53,3),X3$(15,6)=D0$(P,6)
4172 CALL "ZZDISP","DX",D0$(P,6),"",X3$,D9$,"",0,0,""
4180 Q$=FNS$(L0$(380,30))+": "+D9$; PRINT @(FNP(Q$),2),Q$
4190 RETURN 
4200 REM "Set date & time
4202 IF X3$(1,2)<>"T0" OR M2$(2,3)<>"   " THEN GOTO 4225 ELSE Q1$=DAY
4204 IF X3$(51,1)="2" THEN Q1$=Q1$(7,2)+Q1$(4,2)+Q1$(1,2) ELSE IF X3$(51,1)="3" THEN Q1$=Q1$(1,2)+Q1$(4,2)+Q1$(7,2) ELSE Q1$=Q1$(7,2)+Q1$(1,2)+Q1$(4,2)
4205 Q1$(1,1)=CHR(65+NUM(Q1$(1,1)))
4206 IF Q1$=D0$(7,6) THEN GOTO 4225
4210 CALL "ZZSETD",X3$,X4$,D0$,3; GOSUB 6900; PRINT @(0,4),'CE',
4220 WRITE (F9,KEY=D0$(1,6))D0$
4225 RETURN 
5000 REM "COMPANY SELECTION
5040 Z9=1
5050 CALL "ZZMNUC",X3$,X4$,T0$,N1$
5055 X4$=""; FIND (F9,KEY=X3$(9,3)+"ZZP",DOM=5056)X4$
5056 FIND (F9,KEY="   ZZP",DOM=5057)Q$; X4$=X4$+Q$(7)
5060 N1$=FNS$(X3$(86,40)); IF N1$="" THEN N1$="Basic Ideas, Inc." ELSE IF X3$(27,1)="1" AND X3$(9,3)<>"   " THEN N1$=X3$(9,3)+" - "+N1$
5090 IF Z9=1 THEN Q0$="ZMENU"; EXITTO 2200
5095 RETURN 
5100 REM "ENTER SELECTED PROGRAM
5105 IF O$="MAINT" THEN O9=-1
5110 PRINT @(0,23),'CL',@(0,22),'CL',@(25),L0$(210,8),":",
5115 DIM O$(8); O=LEN(O$)
5120 CALL "ZZENTR","SUX",X{ALL},O$,X4$,X3$,35,22,1,O,C0,"","","","","","",""; PRINT @(0,22),'CL',; IF C0<0 THEN GOTO 1810
5140 Q0$=O$
5190 RETURN 
5200 REM "PASSWORD
5205 IF P0$(15,6)=S$(1,6) THEN GOTO 5400 ELSE O=-1,P$=STR(3+P0:"00"),W0=60,W1=22,O$=FNS$(L0$(118,20)); PRINT 'SF',
5210 IF S0=1 THEN W0=40,W1=12,S0=0,Q$=FNS$(M2$(5,40)); PRINT @(39-INT(LEN(Q$)/2),W1-2),Q$
5215 PRINT @(W0-LEN(O$)-3,W1),O$,":",
5240 DIM O$(6); PRINT 'RB',; CALL "ZZENTR","SPUT",X{ALL},O$,X4$,X3$,W0,W1,1,6,C0,"","","","","","",""
5250 IF O$=P0$(15,6) THEN PRINT 'CF',; O=0,S0=0; GOTO 5400 ELSE IF ABS(O)>2 THEN GOTO 5900 ELSE O=O-1; GOTO 5240
5400 REM "
5410 P$=STR(4+P0:"00"); IF P0$(21,2)<>"  " THEN IF P0$(21,2)>X3$(43,2) THEN GOTO 5900 ELSE GOTO 5450
5450 REM "
5490 RETURN 
5900 REM "
5905 O=-1
5920 FOR X=0 TO 40; PRINT 'RB',; NEXT X
5925 CALL "ZZPROM","X2ZMENU",X3$,A,"","","",0
5990 RETURN 
6010 CALL "ZZPROM","X1ZMENU",X3$,A,"","","",0
6025 GOTO 1810
6100 REM "BOX
6110 PRINT 'SB',
6120 CALL "ZZGRPH",X3$,"B",X{ALL},0,3,0,0,0,19,80,0,0,0
6130 PRINT 'SF',
6190 RETURN 
6890 REM "
6895 T9=T9-10
6898 IF T9<0 THEN GOTO 3000
6910 IF X3$(78,1)="1" THEN CALL "ZZTIME",ERR=6911,X3$,2,0
6990 RETURN 
8100 REM "
8180 RELEASE 
9000 REM "ERROR
9005 SETERR 9000
9010 E0=ERR,E1=TCB(5); IF E0=39 THEN GOTO 9060 ELSE IF E0=69 THEN GOTO 1200
9040 CALL "ZZERRM",E0$,"ZMENU",E2$,X3$,E0,E1,E2,E3,0
9050 ON E2 GOTO 9060,9100,9900,9070
9060 RETRY 
9070 GOTO 9900
9080 RETRY 
9100 REM " TRANSFER CONTROL
9190 GOTO 9900
9300 REM "
9350 RETURN 
9700 RUN "ZSTART"
9900 REM "END PROGRAM
9920 SETERR 9960
9940 BEGIN ; PRINT 'CS',SYS," ",SSN
9960 DELETE 0001,9999
9999 END 
