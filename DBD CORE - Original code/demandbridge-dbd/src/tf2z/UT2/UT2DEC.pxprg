0010 REM "DE-COMPILE GRAPHICS IMAGE FOR SCREEN <DECOMP>
0020 REM "PROGRAM: UT2DEC"
0040 REM "Copyright 1987 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 BEGIN 
0105 DIM S$(10),B9$(80,"-")
0110 OPEN (1)"ZMP"
0120 OPEN (2)"ZZG"
0130 OPEN (3)"ZZPARM"
0140 READ (3,KEY="GRIBM PC  "+" ")C0$
0145 C0$=C0$(158)
0150 OPEN (5)"ZM0"
0155 OPEN (6)"ZZ0"
0180 PRINT 'CS',"** DE-COMPILE SCREEN PRINT IMAGE UTILITY **",'LF'
0200 INPUT 'LF',"ENTER MODE (1=REPORT DIFFERENCES, 2=CHANGE DIFFERENCES, 3=ASK IF CHANGE): ",Q$; IF Q$="1" THEN R0=1 ELSE IF Q$="2" THEN R0=2 ELSE IF Q$="3" THEN R0=3 ELSE IF Q$="" THEN GOTO 9900 ELSE GOTO 0200
0220 INPUT 'LF',"ENTER TYPE (1=MENUS, 2=SCREENS, 3=BOTH): ",Q$; IF Q$="" THEN GOTO 0200 ELSE IF Q$="1" THEN R1=1 ELSE IF Q$="2" THEN R1=2 ELSE IF Q$="3" THEN R1=3 ELSE GOTO 0220
0240 INPUT 'LF',"ALL OR SELECTED (S=SELECTED, A=ALL): ",Q$; IF Q$="" THEN GOTO 0220 ELSE IF Q$="A" THEN R2=1 ELSE IF Q$="S" THEN R2=2 ELSE GOTO 0240
0250 REM "PROCESS FROM PRINT FILE
0255 IF R2=1 THEN GOSUB 4000
0310 IOLIST A$,V0$,T0$,V1$,V2$,V2
0405 IF R2=1 THEN IF K0$="" THEN GOTO 9900 ELSE IF R1=1 THEN K$=K0$(1,3),K0$=K0$(4) ELSE K$=K0$(1,6),K0$=K0$(7)
0406 IF R1=1 THEN Q$=K$; GOTO 0520 ELSE IF R1=2 THEN Q$=K$; GOTO 0610
0410 IF R2=1 THEN IF R1=1 THEN K$=KEY(5,END=2200); READ (5); Q$=K$(2); GOTO 0520
0415 IF R2=1 THEN IF R1=2 THEN K$=KEY(6,END=2200); READ (6); Q$=K$(1,6); GOTO 0610
0480 IF R2=2 THEN IF R1=1 THEN GOTO 0500 ELSE IF R1=2 THEN GOTO 0600 ELSE GOTO 0500
0500 REM "ENTER SELECTED MENU
0505 INPUT 'LF',"ENTER MENU CODE: ",Q$; IF R1=3 AND Q$="" THEN GOTO 0600 ELSE IF CTL=4 THEN GOTO 9900
0520 IF Q$="" THEN GOTO 2000 ELSE Q$=Q$+S$; Q$=" "+Q$(1,3)
0550 K$=Q$,F0=5,K9$=Q$(2)+"0",K7$=Q$(2),R9=1
0590 GOTO 0800
0600 REM "ENTER SCREEN
0605 INPUT 'LF',"ENTER THE SCREEN CODE: ",Q$; IF CTL=4 THEN GOTO 9900
0610 IF R1=3 AND Q$="" THEN GOTO 0500 ELSE Q$=Q$+S$; Q$=Q$(1,6)+" "
0620 F0=6,K$=Q$,K9$=Q$(1,6)+"0",K7$=Q$(1,6),R9=2
0630 GOTO 0800
0800 REM "READ RECORD K$ FROM FILE F0
0805 B0$="",B1$="",B2$="",A$=""
0810 IF R9=2 THEN READ (1,KEY=K$,DOM=0812)K8$,*,B0$ ELSE READ (1,KEY=K$,DOM=0812)K8$,B0$
0812 READ (1,KEY=K9$,DOM=0814)K9$,B1$
0814 READ (2,KEY=K7$,DOM=0815)K7$,B2$
0815 GOTO 0830
0820 PRINT 'RB','LF',"CODE: ",K9$," DOES NOT HAVE PRINT IMAGE."; GOTO 2000
0830 K0=0; READ (F0,KEY=K$,DOM=0831)IOL=0310; K0=1; GOTO 0850
0835 PRINT 'RB',"WARNING: CODE: ",K$,"; NO ENTRY IN TEXT FORM..."
0840 IF F0=6 THEN DIM A$(237); A$(1)=K$ ELSE DIM A$(75); A$(1)=K$
0900 REM "CHECK PRINT IMAGE
0902 PRINT @(0),'CL',"CHECKING CODE: ",K$,
0905 G0=1,B$=B0$; GOSUB 6000
0910 IF V0$>"" THEN IF POS(B9$=V0$)>0 THEN GOSUB 8200
0915 IF G0$=V0$ THEN GOTO 1000 ELSE IF B0$="" THEN PRINT 'RB',"SCREEN PRINT IMAGE DOES NOT EXIST FOR:",K$
0916 IF A$="" THEN GOTO 0990
0920 IF V0$="" THEN PRINT 'LF',"SCREEN TEXT MISSING FOR CODE: ",K$ ELSE PRINT 'LF',"SCREEN TEXT DIFFERENT FOR CODE: ",K$
0940 IF R0=1 THEN GOTO 0990 ELSE IF R0=3 THEN INPUT 'LF','RB',"CHANGE TEXT ENTRY? (Y=YES, N=NO): ",Q$; IF Q$="N" THEN GOTO 0990 ELSE IF Q$<>"Y" THEN GOTO 0940
0950 V0$=G0$; WRITE (F0,KEY=K$)IOL=0310
1000 REM "CHECK GRAPHICS IMAGE
1010 G0=0; B$=B1$
1015 IF B1$="" THEN GOTO 1090
1020 GOSUB 6000
1025 IF G0$=B2$ THEN GOTO 1200 ELSE IF B2$="" THEN PRINT 'LF',"GRAPHICS TEXT MISSING FOR: ",K7$ ELSE PRINT 'LF',"GRAPHICS DIFFERENT FOR ",K7$
1030 IF A$="" THEN PRINT 'LF','RB',"UNABLE TO CHANGE TEXT - NO PRIMARY ENTRY"; GOTO 1090
1040 IF R0=1 THEN GOTO 1090 ELSE IF R0=3 THEN INPUT 'LF','RB',"CHANGE TEXT ENTRY? (Y=YES, N=NO): ",Q$; IF Q$="N" THEN GOTO 1090 ELSE IF Q$<>"Y" THEN GOTO 1040
1050 IF POS(" "<>G0$)>0 THEN WRITE (2,KEY=K7$)K7$,G0$
1090 GOTO 1200
1210 IF R2=2 THEN GOTO 0480
1300 REM "GET NEXT SCREEN 
2000 REM "NEXT SELECTED STEP
2010 IF R2=1 THEN GOTO 0400
2090 GOTO 9900
2220 GOTO 9900
4000 REM "GET PRINT FILE NAMES
4002 PRINT 'LF',"CHECKING PRINT FILE FOR ENTRIES...",
4005 K0$=""
4010 READ (1,KEY="",DOM=4011)
4020 K$=KEY(1,END=4090); READ (1)*,Q$; IF POS(" "<>Q$)=0 THEN GOTO 4020
4030 IF LEN(K$)=4 THEN IF R1<>1 THEN GOTO 4020 ELSE IF K$(1,1)<>" " THEN GOTO 4020 ELSE IF POS(K$(1,3)=K0$,3)=0 THEN K0$=K0$+K$(2,3)
4040 IF LEN(K$)=7 THEN IF R1<>2 THEN GOTO 4020 ELSE IF POS(K$(1,6)=K0$,6)=0 THEN K0$=K0$+K$(1,6)
4050 PRINT @(35),K$,
4080 GOTO 4020
4095 RETURN 
5000 REM "SCREEN IMAGE
5020 G0=1; GOSUB 6000
5080 ESCAPE 
5090 RETURN 
6000 REM 
6005 G1$=B$
6010 DIM G0$(1520)
6020 Z0$=$1B$,Z1$=$1B$+"LF",Z2$=Z0$+"BR",Z0=-1,P9=0
6030 P=POS(Z1$=G1$+Z1$),Q$=G1$(1,P-1); IF P+3<=LEN(G1$) THEN G1$=G1$(P+3),Z0=Z0+1 ELSE Z0=Z0+1,G1$=""
6032 IF P=0 THEN ESCAPE 
6080 P0=Z0*80+1
6100 P=POS(Z0$=Q$); IF P=0 THEN X$=Q$; GOSUB 8000; G0$(P0)=X$,Q$=""; GOTO 6180
6105 IF POS(Z2$=Q$)=1 THEN X$="|",G0$(P0)=X$,P0=P0+1,Q$=Q$(4); GOTO 6100
6110 IF P=1 THEN Q=ASC(Q$(3)),P0=Z0*80+Q+1,Q$=Q$(4); GOTO 6100
6120 X$=Q$(1,P-1); GOSUB 8000; G0$(P0)=X$,Q$=Q$(P),P=1; GOTO 6100
6180 IF G1$>"" THEN GOTO 6030
6195 RETURN 
8000 REM "CONVERT GRAPHICS TO CHARACTERS
8002 IF X$="" OR G0=1 THEN GOTO 8090
8005 Y$=X$,X$=""
8020 FOR X=1 TO LEN(Y$); Y=POS(HTA(Y$(X,1))=C0$)
8025 IF Y=0 THEN X$=X$+" "; GOTO 8035
8030 X$=X$+CHR(65+INT(Y/2))
8040 NEXT X
8090 RETURN 
8200 REM "TAKE DASHLINES OUT OF SCREEN TEXT
8210 FOR X=1 TO LEN(V0$) STEP 80
8215 IF V0$(X,80)=B9$ THEN V0$(X,80)=""
8220 NEXT X
8240 RETURN 
9999 END 
