0010 REM "Inventory conversion program <UT2ICC>
0050 REM "Design ONLY for Creative Business Systems - 08/17/87
0090 BEGIN 
0100 OPEN (1)"IC0X"
0110 OPEN (2)"IC1X"
0120 OPEN (3)"IC9X"
0130 OPEN (4)"IC0001"
0140 OPEN (5)"IC1001"
0150 OPEN (6)"IC2001"
0160 OPEN (7)"IC9001"
0190 OPEN (13)"ZZPARM"
0220 DIM Z0$(80,"-"),S$(20)
0230 REM "Set D0$ to day
0235 D0$=DAY,D0$="I7"+D0$(1,2)+D0$(4,2)
0300 IOLIST S
0305 REM "IC0X
0310 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13],A[14],A[15],A[16],A[17],A[18]
0315 REM "IC1X
0320 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8]
0335 REM "IC0001
0340 IOLIST D$,D[0],D[1],D[2],D[3],D[4],D[5],D[6],D[7],D[8],D[9],D[10],D[11],D[12],D[13],D[14],D[15],D[16],D[17],D[18],D[19]
0345 REM "IC1001
0350 IOLIST E$,E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10]
0355 REM "IC2001
0360 IOLIST F$,F[0],F[1],F[2],F[3],F[4],F[5],F[6],F[7],F[8],F[9],F[10],F[11],F[12],F[13],F[14],F[15],F[16]
0490 IOLIST M$,M[0],M[1]
0500 REM 
0510 PRINT 'CS',
0520 PRINT @(20,1),"Convert Inventory Files",@(0,2),Z0$,
1000 REM "Go through IC0X to build IC0001 and IC2001
1005 PRINT @(15,10),"Phase I - Inventory Items -",
1010 DIM A$(140),A[18],D$(128),D[19],F$(65),F[16]
1015 K$=KEY(1,END=2000)
1017 PRINT @(44,10),'CL',K$(11),
1020 READ (1,KEY=K$)IOL=0310
1100 REM "Build up D$,D() for IC0001
1105 D$(1,95)=A$(1,95),D$(96,12)=A$(128,12),D$(120,8)=A$(120,8)
1110 FOR I=0 TO 12; D[I]=A[I]; NEXT I
1115 FOR I=14 TO 17; D[I]=A[I]; NEXT I
1120 D[18]=D[17],D[19]=D[14]
1125 GOSUB 5000
1190 WRITE (4,KEY=K$)IOL=0340
1200 REM "Setup IC2001 record
1210 F$(1,20)=A$(1,20),F$(21,10)=A$(82,10),F$(31,4)=A$(92,4),F$(35,20)=A$(96,20),F$(55,4)=A$(116,4)
1215 F[14]=A[13],F[15]=A[16],F[16]=D[19]
1220 GOSUB 5100
1290 WRITE (6,KEY=F$(1,34))IOL=0360
1900 REM 
1910 GOTO 1010
2000 REM "Convert IC1X to IC1001
2005 PRINT @(10,10),'CE',"Phase II - Inventory Location Records - ",
2010 DIM B$(45),B[8],E$(59),E[10]
2015 K$=KEY(2,END=3000)
2017 PRINT @(50,10),K$(11,10)," - ",K$(21,4),
2020 READ (2,KEY=K$)IOL=0320
2100 REM 
2110 E$(1,24)=B$(1,24),E$(29,16)=B$(29,16),E$(53,6)=B$(29,6)
2120 FOR I=0 TO 8; E[I]=B[I]; NEXT I
2190 WRITE (5,KEY=K$)IOL=0350
2900 REM 
2990 GOTO 2010
3000 REM "Convert IC9X to IC9001
3005 PRINT @(10,10),'CE',"Phase III - Inventory Statisitics -",
3015 K$=KEY(3,END=9900)
3017 PRINT @(46,10),K$(11,10)," - 5000",
3020 READ RECORD (3,KEY=K$)C$
3030 G$=C$(1,20)+"5000"+C$(21)
3035 G$=G$(1,128)
3040 WRITE RECORD (7,KEY=K$(1,20)+"5000"+K$(21))G$
3090 GOTO 3015
5000 REM "Check U/M's and set D(14) and D(15) if necess
5005 IF D$(120,4)=S$(1,4) THEN IF D$(124,4)=S$(1,4) THEN D$(120,4)="EACH" ELSE D$(120,4)=D$(124,4)
5010 IF M$(4,4)<>D$(120,4) THEN DIM M$(21),M[1]; READ (13,KEY="U/M"+D$(120,4),DOM=5011)IOL=0490
5020 IF M$(20,1)="Y" THEN IF M[0]<>0 THEN D[14]=M[0] ELSE D[14]=M[1]
5055 IF D$(124,4)=S$(1,4) THEN D$(124,4)=D$(120,4)
5060 IF M$(4,4)<>D$(124,4) THEN DIM M$(21),M[1]; READ (13,KEY="U/M"+D$(124,4),DOM=5061)IOL=0490
5070 IF M$(20,1)="Y" THEN IF M[0]<>0 THEN D[15]=M[0] ELSE D[15]=M[1]
5080 IF D[14]=0 THEN D[14]=1
5082 IF D[15]=0 THEN D[15]=1
5090 RETURN 
5100 REM "Check F(14)
5105 IF F$(55,4)=S$(1,4) THEN F$(55,4)="EACH"
5110 IF M$(4,4)<>F$(55,4) THEN DIM M$(21),M[1]; READ (13,KEY="U/M"+F$(55,4),DOM=5111)IOL=0490
5120 IF M$(20,1)="Y" THEN IF M[0]<>0 THEN F[14]=M[0] ELSE F[14]=M[1]
5140 RETURN 
9900 REM "End
9910 PRINT @(0,3),'CE',
9915 INPUT @(20,10),"Process complete - <Return> to continue ",*
9950 RUN "ZMENU"
