0010 REM "Reformat data for PC File FOrmats <ZZ2OUT>
0030 REM "(C) 1985-1988 Basic Ideas, Inc; Atlanta, GA. USA
0035 REM "4.4 - 06/21/00 - 17.04 - tma - SSP# 127416
0040 REM "Copyright 2000 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1020 ENTER X3$,R0$,X0$,Q$,N,P0,Y5$
1025 DIM S$(40)
1030 T0$=$0D0A$,T1$=$22$,T2$=","
1035 L0=POS(R0$(3,3)="ASCDIFPRNWP ",3)/3; L0=INT(L0)
1036 IF R0$(3,3)="WP " THEN T0$=$120A$
1040 N$=""
1090 ON LEN(Q$) GOTO 2000,4000
2000 REM "NUMERIC OUTPUT
2030 ON L0 GOTO 2050,2100,2200,2300
2050 REM "STRAIGHT ASCII TEXT
2055 N$=STR(N)
2060 IF R0$(6,1)="L" THEN N$=N$+T0$ ELSE IF POS(R0$(6,1)=" C,"+$22$)>0 THEN N$=N$+"," ELSE IF R0$(6,1)="*" THEN N$=N$+$8A$ ELSE IF R0$(6,1)="S" THEN N$=N$+";"
2090 GOTO 8000
2100 REM "DIF FORMAT
2110 DIM M0$(14,"0"); M0$="-0."+M0$
2120 IF FPT(N)=0 THEN IF ABS(N)<32767 THEN N$=STR(N); GOTO 2150 ELSE FLOATING POINT 
2140 I=INT(N),F=FPT(N),E=EPT(N)-1,E0=10^E,N0=N/E0
2145 N$=STR(N0:M0$)+"E"+STR(E:"+00")
2150 N$="0,"+N$+T0$+"V"+T0$
2190 GOTO 8000
2200 REM "LOTUS IMPORT FORMAT PRN
2220 N$=T1$+STR(N)+T1$+T2$
2290 GOTO 8000
2300 REM "WORD PERFECT MERGE FILE
2310 N$=STR(N)+T0$
2390 GOTO 8000
4000 REM "STRING DATA
4020 ON L0 GOTO 4050,4100,4200,4300
4050 REM "ASCII FORMAT
4055 N$=FNS$(Q$); IF R0$(6,1)=T1$ THEN N$=T1$+N$+T1$+T2$ ELSE IF R0$(6,1)="," THEN N$=N$+"," ELSE IF R0$(6,1)="L" THEN N$=N$+T0$ ELSE IF R0$(6,1)="*" THEN N$=N$+$8A$ ELSE IF R0$(6,1)="S" THEN N$=N$+";"
4090 GOTO 8000
4100 REM "DIF FORMAT
4120 IF LEN(Q$)>12 THEN Q$=FNS$(Q$)
4130 N$="1,0"+T0$+T1$+Q$+T1$+T0$
4190 GOTO 8000
4200 REM "PRN FORMAT
4220 N$=T1$+Q$+T1$+T2$
4290 GOTO 8000
4300 REM "WORD PERFECT MERGE FILE
4310 N$=FNS$(Q$)+T0$
4390 GOTO 8000
8000 REM "ADD TO STRING
8010 IF R0$(3,4)="ASCF" THEN Y5$(P0,LEN(N$))=N$ ELSE Y5$=Y5$+N$
8090 GOTO 9900
8910 DEF FNS$(Z$)=Z$(1,POS(S$=Z$+S$)-1)
9940 EXIT 
9999 END 
