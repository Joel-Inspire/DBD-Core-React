0010 REM "Statistical Data Retrieval <ZZ2MDZ>
0035 REM "5.2 - 05/08/03 - 12.068055 - dmm - SSP# 160697
0040 REM "Copyright 2003 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0310 IOLIST F0$,F0
0990 REM "S0$ IS SERIES AND DATA, R0$-R1$ ARE RANGE, Y$=YEAR
1000 ENTER X3$,S0$,D0$,R{ALL},R0$,R1$,Y$,M0$,M1$,X9$,Y{ALL}
1010 IF LEN(S0$)=1 THEN S1$=S0$,S0$="G/L" ELSE S1$=S0$(4),S0$=S0$(1,3)
1020 GOTO 1090
1080 S0$="G/L",Y$="1987",S1$="A"
1085 R0$="510",R1$="590"
1090 DIM Z0$(12,"0")
1200 REM "FILE
1220 DIM Z[NUM(X3$(60,3))]
1240 Z$="01O ZZPARM  "
1250 GOSUB 7800
1400 REM "
1410 Q$="STAT"+S0$; FIND (Z[1],KEY=Q$,DOM=8010)IOL=0310
1420 F1=POS(S1$=F0$(49),17); IF F1=0 THEN GOTO 8020 ELSE F1=F1+48
1500 REM "DATA FILE
1520 Z$="02O "+F0$(28,6)+"  "+"03O "+F0$(35,6)+"  "
1540 GOSUB 7800
1600 REM "GET DATA
2000 REM "READ RECORDS
2010 DIM R[14]
2020 K$=R0$; READ (Z[3],KEY=R0$,DOM=2025); GOTO 2030
2025 K$=KEY(Z[3],END=3000); READ (Z[3],KEY=K$)
2026 REM PRINT @(12,18),"WORKING ON ACCOUNT: ",K$,
2030 IF K$(1,LEN(R1$))>R1$ THEN GOTO 3000
2035 IF M0$+M1$>"" THEN CALL "ZZFLTR",X3$,M0$,M1$,K$,G0,0; ON G0 GOTO 2025,2036
2038 REM PRINT @(24,16),"ACCOUNT: ",K$,
2040 K$=K$+Y$; GOSUB 7300
2050 FOR X=0 TO 13; R[X]=R[X]+I[X]; NEXT X
2090 IF R1$<>"" THEN GOTO 2025
2100 REM 
3190 GOTO 9900
7300 REM "
7310 DIM I[14]
7315 F9$=F0$
7320 CALL "ZZPACK",X3$,"R",F0$(F1+2,3),"",0,0,I{ALL},Z[2],S1$,K$,F9$
7390 RETURN 
7400 REM "ONLY GET APPROPRIATE PERIOD(S)
7800 REM 
7820 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0
7890 RETURN 
8010 Q$="Statistical series "+Q$+" data not found."; CALL "ZZPROM","4",X3$,0,Q$,"","",0; GOTO 9800
8020 Q$="Statistics type "+S1$+" Not found in series "+S0$; CALL "ZZPROM","4",X3$,0,Q$,"","",0; GOTO 9800
9800 REM "COME TO A BAD END
9801 EXIT ERR
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9940 EXIT 
9999 END 
