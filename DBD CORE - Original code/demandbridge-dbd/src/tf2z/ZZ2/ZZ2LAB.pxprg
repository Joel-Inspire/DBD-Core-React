0010 REM "Lookup File Information - B <ZZ2LAB>
0025 REM "CREATED: 06/14/85; LEVEL: N5.17A; S/N: 1318
0030 REM "(C) 1984 Basic Ideas, Inc; Atlanta, Georgia.
0035 REM "    This software contains trade secrets and proprietary information"
0100 ENTER X3$,Q$,Z{ALL},A{ALL},A,B,C0,N,X4$
0101 SETERR 9000
0110 C0=0
0130 C8=10,C6=14,C7=-1
0160 DEF FNP$(Z9$)="("+Z9$(1,3)+") "+Z9$(4,3)+"-"+Z9$(7,4)+" Ext: "+Z9$(11,4)
0180 IF A>=0 THEN C7=A; GOTO 2000
0300 REM "IOLISTS
0320 IOLIST B$
1030 DIM B$(60)
1700 REM "
1790 GOTO 1900
1800 REM "ADD ENTRY
1820 Q$(C6*C7+1,C6)=A$
1900 REM "CURRENT COUNTER
1905 ON C0-1 GOTO 1910,1930,1950
1910 C7=C7+1; IF C7>=C8 THEN GOTO 9900
1920 GOTO 2000
1930 C7=C7-1; IF C7<0 THEN GOTO 9900
1940 GOTO 2000
1950 REM "
1960 GOTO 9900
2000 REM "DATA SEQ
2005 PRINT @(2,18),C7+1:",##0",":"
2010 C0=0,X0=-1,X1=1,A$=Q$(C6*C7+1,C6),A1$=A$
2015 GOSUB 6200
2020 C9=1,Z9=1,X$="",C1=X0; IF C0=2 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1
2025 IF C0>3 THEN X0=X0+999
2030 IF A<0 THEN A=C7,X0=B
2035 IF A1$<>A$ THEN GOSUB 7100
2036 IF X0<>C1 THEN A1$=A$
2040 ON X0+1 GOTO 1800,2100,2150,2200,2250,2300,2350,1800
2110 CALL "ZZENTR","ZQ",A{ALL},A$,X4$,X3$,16,18,1,1,C0,"",X$,"","ZZ2LAB02","","",""; IF ABS(C0)>4 THEN GOTO 9800
2140 GOTO 2020
2160 CALL "ZZENTR","ZQ",A{ALL},A$,X4$,X3$,24,18,2,3,C0,"",X$,"","ZZ2LAB04","","",""; IF ABS(C0)>4 THEN GOTO 9800
2190 GOTO 2020
2210 CALL "ZZENTR","SQU",A{ALL},A$,X4$,X3$,34,18,5,1,C0,"",X$,"","ZZ2LAB06","","",""; IF ABS(C0)>4 THEN GOTO 9800
2240 GOTO 2020
2260 CALL "ZZENTR","ZQ",A{ALL},A$,X4$,X3$,44,18,6,3,C0,"",X$,"","ZZ2LAB08","","",""; IF ABS(C0)>4 THEN GOTO 9800
2290 GOTO 2020
2310 CALL "ZZENTR","ZQ",A{ALL},A$,X4$,X3$,58,18,9,3,C0,"",X$,"","ZZ2LAB10","","",""; IF ABS(C0)>4 THEN GOTO 9800
2340 GOTO 2020
2360 CALL "ZZENTR","SQU",A{ALL},A$,X4$,X3$,72,18,12,3,C0,"",X$,"","ZZ2LAB12","","",""; IF ABS(C0)>4 THEN GOTO 9800
2390 GOTO 2020
6200 REM "DISPLAY DATA
6220 PRINT @(16,18),A$(1,1),@(24,18),A$(2,3),@(34,18),A$(5,1),@(44,18),A$(6,3),@(58,18),A$(9,3),@(72,18),A$(12,3),
6390 RETURN 
7000 REM "CUSTOM PROGRAMMING ROUTINES
7001 REM "Display an Item routine"
7010 ON POS(Q1$(5,1)=" SZDNAP") GOTO 7020,7099,7020,7020,7030,7040,7050,7060
7020 DIM D$(NUM(Q1$(9,3),ERR=7099),STR(I+1:"0"))
7025 GOTO 7090
7030 CALL "ZZDISP","DX","I"+STR(I+1:"0")+STR(I+1:"00")+STR(I+1:"00"),"",X3$,D$,"",0,0,X4$
7035 GOTO 7090
7040 CALL "ZZMASK",ERR=7041,Q1$(9,3),D$
7045 IF POS("#"=D$)=0 THEN GOTO 7090 ELSE D$(POS("#"=D$),1)=STR(I+1:"0"); GOTO 7045
7047 GOTO 7090
7050 DIM D1$(NUM(Q1$(9,3),ERR=7099),STR(I+1:"0"))
7055 CALL "ZZDISP","AX",D1$,Q1$(12,3),X3$,D$,"",0,0,X4$
7058 GOTO 7090
7060 DIM D0$(14,STR(I+1:"0")); D$=FNP$(D0$)
7061 GOTO 7090
7090 IF NUM(Q1$(2,3),ERR=7099)+LEN(D$)<=N THEN PRINT @(NUM(Q1$(2,3),ERR=7099),NUM(Q1$(1,1),ERR=7099)+13),D$,
7099 RETURN 
7100 REM "routine to display all items"
7101 PRINT @(0,13),'CL','LF','CL',
7105 FOR I=0 TO C8
7106 IF I=C7 THEN Q1$=A$; GOTO 7130
7110 IF Q$(C6*I+5,1)=" " THEN EXITTO 7199
7120 Q1$=Q$(C6*I+1,C6)
7130 GOSUB 7000
7140 NEXT I
7199 RETURN 
9000 REM "ERROR PROCESSING
9010 E0=ERR,E1=TCB(5)
9015 SETERR 9016; E0$=LST(PGM(E1))
9016 SETERR 9000
9040 CALL "ZZERRM",E0$,X0$,E1$,X3$,E0,E1,E2,E3,0
9050 ON E2 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE E1$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9900 REM "END PROGRAM
9905 GOSUB 7100
9910 A=C7,B=X0
9920 EXIT 
9999 END 
