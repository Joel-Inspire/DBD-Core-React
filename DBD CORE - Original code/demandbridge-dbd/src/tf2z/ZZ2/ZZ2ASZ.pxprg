0010 REM "Screen Entry Data Element Setup <ZZ2ASZ>
0015 REM "Prog Type: IE-2.5     
0020 SETESC 9300; SETERR 9000
0030 REM "(C) 1985,1986,1987 Basic Ideas, Inc; Atlanta, Ga.
0035 REM "This software contains trade secrets and proprietary information"
0040 REM "and may not be reproduced in any form.
0090 CLEAR ; ENTER X3$,X4$,Q1$,Q2$,A$,S3
0100 SETERR 9000
0110 X0$="ZZ2ASZ",X1$="Screen Entry Data Element Setup"
0115 X1$=""
0120 T9$="D006P014T004B001Y001C922M163V001"
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0310 IOLIST A$(1)
0320 IOLIST B$
0330 IOLIST C$,C[0],C[1]
0340 IOLIST D$,D[0],D[1]
0350 IOLIST E$
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01O ZZ3...  02O ZZE...  03O ZZL...  04O ZZA...  05O ZZF...  13O ZZPARM  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z1 GOTO 0521,9900
0670 PRINT @(0,3),'CE',
0680 GOSUB 6000
1030 DIM B$(136),C$(344),C[1],D$(110),D[1],E$(120),S$(30)
1070 IF A$(196,1)=" " THEN GOSUB 8100
1075 GOSUB 6600; GOSUB 6200
1100 X0=3; IF C0=2 THEN X0=23 ELSE X0=X0-1,C0=0
1510 A1$=K9$
1710 ON A0 GOTO 2000,1770,1760
1760 GOSUB 6000; ON A0-2 GOTO 1780,1770
1770 GOSUB 6200; ON A0-3 GOTO 1780,2000
1810 X0=4,C0=0
1820 CALL "ZZPROM","1A",X3$,S3,"","","",0; ON S3 GOTO 2000,9900,2000,9900
1880 GOTO 9900
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF INT(C0)=3 THEN GOSUB 7300 ELSE IF C0>3 OR X0<0 THEN GOTO 1800
2040 ON X0 GOTO 2100,2150,2250,3000,2300,3250,2200,3100,2400,2450,3050,2350,2500,2550,3300,2600,2700,3150,3200,2650,2750,2950,2800,2850,2900,1800
2105 GOTO 2020
2110 CALL "ZZENTR","ZX",A{ALL},A$,X4$,X3$,26,3,1,4,C0,"","{3"+X$,K9$,"ZZ2ASZ00","ZZ2A","",""; IF ABS(C0)>4 THEN GOTO 9900
2140 GOTO 2020
2160 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,26,4,3,2,C0,"","{3"+X$,"","ZZ2ASZ02","","",""; IF ABS(C0)>4 THEN GOTO 9900
2190 GOTO 2020
2205 Q$=A$(5,2)+A$(119,2)
2210 CALL "ZZENTR","SUX",A{ALL},Q$,X4$,X3$,26,6,1,4,C0,"","{3"+X$,"","ZZ2ASZ04","","",""; IF ABS(C0)>4 THEN GOTO 9900
2215 IF POS(Q$(1,1)="SRCZTPDANQLYB+-MV")=0 THEN GOTO 2200 ELSE A$(5,2)=Q$(1,2),A$(119,2)=Q$(3)
2220 P=POS(A$(5,1)=T9$,4); IF P=0 THEN GOTO 2020 ELSE A$(11,3)=T9$(P+1,3); IF A$(6,1)="B" THEN A$(11,3)="099"
2225 PRINT @(26,9),A$(11,3),
2230 IF C0>0 THEN GOSUB 7600
2240 GOTO 2020
2255 GOTO 2020
2260 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,45,3,7,2,C0,"","{3"+X$,"","ZZ2ASZ06","","",""; IF ABS(C0)>4 THEN GOTO 9900
2290 GOTO 2020
2305 GOTO 2020
2310 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,45,4,9,2,C0,"","{3"+X$,"","ZZ2ASZ08","","",""; IF ABS(C0)>4 THEN GOTO 9900
2340 GOTO 2020
2355 IF POS(A$(5,1)=T9$,4)>0 THEN GOTO 2020
2360 CALL "ZZENTR","SZU",A{ALL},A$,X4$,X3$,26,9,11,3,C0,"","{3"+X$,"","ZZ2ASZ10","","",""; IF ABS(C0)>4 THEN GOTO 9900
2365 IF A$(11,3)>"078" THEN IF A$(5,1)<>"C" THEN A$(5,1)="N"; PRINT @(26,6),"N"
2370 GOSUB 7600
2390 GOTO 2020
2405 IF POS(A$(5,1)="AV")=0 THEN A$(14,8)=""; PRINT @(46,6),A$(14,8),; GOTO 2020 ELSE Q=3+5*POS("V"=A$(5,1))
2410 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,46,6,14,Q,C0,"","{3"+X$,"","ZZ2ASZ12","","",""; IF ABS(C0)>4 THEN GOTO 9900
2440 GOTO 2020
2460 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,26,7,22,30,C0,"","{3"+X$,"","ZZ2ASZ14","","",""; IF ABS(C0)>4 THEN GOTO 9900
2490 GOTO 2020
2510 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,26,10,130,50,C0,"","{3"+X$,"","ZZ2ASZ16","","",""; IF ABS(C0)>4 THEN GOTO 9900
2540 GOTO 2020
2555 Q$=A$(53,2)
2560 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,26,11,53,2,C0,"","{3"+X$,"","ZZ2ASZ18","","",""; IF ABS(C0)>4 THEN GOTO 9900
2565 IF C0>0 THEN IF POS(A$(53,1)="FA")=0 THEN A$(55,6)="",A$(81,1)="",A$(121,4)=""; PRINT @(26,12),A$(55,6),@(26,13),A$(81,1),@(26,14),A$(121,2),@(42,14),A$(123,2),
2590 GOTO 2020
2605 IF POS(A$(53,1)="FA")=0 THEN GOTO 2020
2610 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,26,12,55,6,C0,"","{3"+X$,"","ZZ2ASZ20","ZZE","ZZ2FAA",""; IF ABS(C0)>4 THEN GOTO 9900
2620 FIND (Z[2],KEY=A$(55,6),DOM=2610)IOL=0320
2625 PRINT @(34,12+V0),B$(7,30),
2630 IF C0>0 THEN GOSUB 7800
2640 GOTO 2020
2655 Q0=26,Q1=15; IF POS(A$(53,1)="FA")>0 THEN Q0=60,Q1=14
2660 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,Q0,Q1,61,20,C0,"","{3"+X$,"","ZZ2ASZ22","","",""; IF ABS(C0)>4 THEN GOTO 9900
2690 GOTO 2020
2705 IF POS(A$(53,1)="FA")=0 THEN GOTO 2020
2710 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,26,13,81,1,C0,"","{3"+X$,"","ZZ2ASZ24","","",""; IF ABS(C0)>4 THEN GOTO 9900
2720 GOSUB 7900
2735 IF A$(81,1)>"0" THEN IF E9$(56,1)<>" " THEN IF E9$(56,3)<>A$(11,3) THEN CALL "ZZPROM","Y",X3$,Q,"Length of verify item differs: should be "+E9$(56,3)+". Fix it?","","",0; IF Q=0 THEN A$(11,3)=E9$(56,3); PRINT @(26,9),A$(11,3),
2740 GOTO 2020
2760 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,26,16,82,6,C0,"","{3"+X$,"","ZZ2ASZ26","ZZL","ZZ2LAA",""; IF ABS(C0)>4 THEN GOTO 9900
2770 IF A$(5,1)<>"V" THEN IF A$(82,1)<>" " THEN FIND (Z[3],KEY=" "+A$(82,6)+"  ",DOM=2760)IOL=0330
2790 GOTO 2020
2810 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,26,18,88,2,C0,"","{3"+X$,"","ZZ2ASZ28","","",""; IF ABS(C0)>4 THEN GOTO 9900
2840 GOTO 2020
2860 CALL "ZZENTR","SRU",A{ALL},A$,X4$,X3$,26,19,90,1,C0,"","{3"+X$,"HV","ZZ2ASZ30","HV","",""; IF ABS(C0)>4 THEN GOTO 9900
2890 GOTO 2020
2910 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,42,19,91,1,C0,"","{3"+X$,"","ZZ2ASZ32","","",""; IF ABS(C0)>4 THEN GOTO 9900
2940 GOTO 2020
2960 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,26,17,92,8,C0,"","{3"+X$,"","ZZ2ASZ34","","",""; IF ABS(C0)>4 THEN GOTO 9900
2990 GOTO 2020
3005 IF C0<>2 THEN GOTO 2020
3010 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,69,3,100,3,C0,"","{3"+X$,"","ZZ2ASZ36","","",""; IF ABS(C0)>4 THEN GOTO 9900
3040 GOTO 2020
3060 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,26,8,103,16,C0,"","{3"+X$,"","ZZ2ASZ38","","",""; IF ABS(C0)>4 THEN GOTO 9900
3090 GOTO 2020
3105 GOTO 2020
3110 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,28,6,119,2,C0,"","{3"+X$,"","ZZ2ASZ40","","",""; IF ABS(C0)>4 THEN GOTO 9900
3140 GOTO 2020
3155 IF A$(81,1)<"1" OR POS(A$(53,1)="FA")=0 THEN GOTO 2020
3160 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,26,14,121,2,C0,"","{3"+X$,"","ZZ2ASZ42","","",""; IF ABS(C0)>4 THEN GOTO 9900
3190 GOTO 2020
3205 IF A$(81,1)<"1" OR POS(A$(53,1)="FA")=0 THEN GOTO 2020
3210 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,42,14,123,2,C0,"","{3"+X$,"","ZZ2ASZ44","","",""; IF ABS(C0)>4 THEN GOTO 9900
3240 GOTO 2020
3260 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,62,4,180,16,C0,"","{3"+X$,"","ZZ2ASZ38","ZZA","ZZ2FDA",""; IF ABS(C0)>4 THEN GOTO 9900
3270 IF C0>0 THEN D$(1)=""; IF A$(180,16)<>S$(1,16) THEN FIND (Z[4],KEY=A$(180,16),DOM=3250)IOL=0340; GOSUB 8000
3290 GOTO 2020
3340 GOTO 2020
6015 PRINT (0,ERR=6006)'SB',
6055 CALL "ZZDISP","-","05","",X3$,"","",X0,0,X4$
6060 CALL "ZZVDTP",X3$,X0$,X1$,V0$,0
6190 RETURN 
6205 PRINT 'SF',
6210 Q0=26,Q1=15; IF A$(53,1)="F" THEN Q0=60,Q1=14
6215 PRINT @(26,6),A$(5,2)+A$(119,2)
6220 PRINT @(26,3),A$(1,2),@(26,4),A$(3,2),@(45,3),A$(7,2),@(45,4),A$(9,2),@(62,4),A$(180,16),@(26,9),A$(11,3),@(46,6),A$(14,8),@(26,7),A$(22,30),
6224 PRINT @(26,10),A$(130,50),
6230 PRINT @(26,11),A$(53,2),@(26,12),A$(55,6),@(34,12+V0),B$(7,30),
6240 PRINT @(Q0,Q1),A$(61,20),@(26,13),A$(81,1),@(26,16),A$(82,6),@(26,18),A$(88,2),@(26,19),A$(90,1),@(42,19),A$(91,1),@(26,17),A$(92,8),@(69,3),A$(100,3),@(26,8),A$(103,16),@(26,14),A$(121,2),@(42,14),A$(123,2),
6280 PRINT @(26,14),A$(121,2),@(42,14),A$(123,2),
6310 GOSUB 7600
6320 PRINT @(29,13),E$(13,30),
6390 RETURN 
6410 GOSUB 6000
6430 GOSUB 6200
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6610 FIND (Z[2],KEY=A$(55,6),DOM=6611)IOL=0320
6620 FIND (Z[3],KEY=" "+A$(82,6)+"  ",DOM=6621)IOL=0330
6630 GOSUB 7700
6690 RETURN 
7310 ON FPT(C0)*10 GOTO 7390,7325,7330,7390
7325 IF V8$="" THEN X0=X0+4; GOTO 7390 ELSE X0=NUM(V8$(POS(STR(X0:"00")<=V8$,2),2)); GOTO 7390
7330 IF V8$="" THEN X0=X0-6; GOTO 7335 ELSE X0=POS(STR(X0-1:"00")<=V8$,2)-2; IF X0<0 THEN X0=0; GOTO 7390 ELSE X0=NUM(V8$(X0,2)); GOTO 7390
7335 IF X0<0 THEN X0=0; GOTO 7390
7390 C0=3; RETURN 
7410 A1$=A$; DIM A$(240); A$(1)=A1$,V9=0
7420 FIND (Z[1],KEY=A1$,DOM=7430)IOL=0310
7435 V9=1
7440 A1$=A$(1,11),A$=A$(12)
7450 IF V9=1 THEN GOSUB 6600; GOSUB 6200
7490 RETURN 
7610 PRINT @(32,9),'CL',; IF POS(A$(5,1)="CN")>0 THEN CALL "ZZMASK",A$(11,3)+A$(5,2),M0$; PRINT @(32,9),M0$,
7620 RETURN 
7705 E$(1)=""
7710 Q=NUM(A$(81,1)),Q9=0; IF Q=0 THEN GOTO 7720 ELSE Q$=A$(55,6); READ (Z[5],KEY=Q$,DOM=7711)
7715 E$(1)=""; READ (Z[5],END=7720)IOL=0350; Q9=Q9+1; IF Q9=1 THEN E9$=E$
7716 IF Q9<Q AND Q9<10 THEN GOTO 7715
7720 IF Q<>Q9 THEN E$(1)=""
7795 RETURN 
7810 A$(82,6)=A$(55,6),A$(92,8)=B$(58,6)
7840 PRINT @(26,16),A$(82,6),@(26,17),A$(92,8),
7845 RETURN 
7910 GOSUB 7700; PRINT @(29,13),E$(13,30),; A$(17,3)=E$(56,3)
7915 Q=NUM(A$(9,2))+2+NUM(A$(11,3))+3*POS("A"=A$(5,1)); IF POS(A$(81,1)="0 ")>0 THEN A$(121,4)="" ELSE IF A$(121,4)="    " THEN A$(121,4)=STR(Q:"00")+A$(7,2)
7920 PRINT @(26,14),A$(121,2),@(42,14),A$(123,2),
7945 RETURN 
8010 A$(5,2)=D$(74,2),A$(119,2)=D$(76,2),A$(81,1)="",A$(11,3)=D$(84,3),A$(14,3)=D$(78,3),A$(82,6)=D$(179,8),A$(92,8)=D$(187,6),A$(121,4)=""
8015 A$(55,6)=D$(87,6),A$(61,20)=D$(149,30)
8040 IF POS(" "<>A$(55,6))>0 THEN A$(53,2)="F" ELSE A$(53,2)=""
8045 E$(1)=""; IF POS(A$(53,1)="FA")>0 THEN A$(81,1)="2"; GOSUB 7900
8050 A$(103,16)=A$(180,16)
8090 GOSUB 6200
8095 EXITTO 1800
8110 Q$=FNS$(A$(22,16)); IF Q$="" THEN GOTO 8190
8115 Q=ASC("a")-ASC("A"); FOR X=1 TO LEN(Q$); IF Q$(X,1)=" " THEN Q$(X,1)="_" ELSE IF Q$(X,1)>="a" AND Q$(X,1)<="z" THEN Q$(X,1)=CHR(ASC(Q$(X,1))-Q)
8120 NEXT X
8140 D$(1)=Q$; FIND (Z[4],KEY=D$(1,16),DOM=8190)IOL=0340
8145 A$(180,16)=D$(1,16),A$(103,16)=D$(1,16); GOSUB 8000; A$(196,1)="*"
8150 IF POS(A$(53,1)="FA")>0 THEN A$(81,1)="2"; GOSUB 7900
8160 X0=8; EXITTO 2000
8195 RETURN 
8300 REM "CHECK ON EXIT
8310 IF A$(11,3)="000" OR A$(11,3)="   " THEN CALL "ZZPROM","X0ZZ2ASZ",X3$,S3,"","","",0; IF S3=0 THEN X0=11; EXITTO 2040 ELSE GOTO 8390
8390 RETURN 
8910 DEF FNS$(Z$)=Z$(1,POS("  "=Z$+"  ")-1)
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9910 GOSUB 8300
9920 SETERR 9940
9930 EXIT 
9940 ESCAPE 
9999 END 
