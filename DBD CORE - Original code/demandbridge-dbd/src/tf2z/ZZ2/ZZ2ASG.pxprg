0010 REM "Editor Graphics Interface <ZZ2ASG>
0030 REM "(C) 1985,1986,1987 Basic Ideas, Inc; Atlanta, Ga.
0035 REM "This software contains trade secrets and proprietary information"
0330 DIM S$(20)
0410 ENTER X3$,G0$,C0$,C9,V0$
0420 IF C9<>2 THEN GOSUB 2000 ELSE B$=C0$
0430 CLOSE (14); OPEN (14)FID(0)
0550 X=1,Y=3,X0=X,Y0=Y
0555 D0$=CHR(30)+CHR(31)+CHR(17)+CHR(16); IF FID(0)<>"T0" THEN D0$="^V<>"
0605 W0=80,W1=19,W2=120,B0$="",R5$=CHR(192),D0=1
0620 IF C9=0 OR C9=2 THEN GOSUB 6000; GOTO 9900
0810 IF G0$="" THEN DIM G0$(W0*W1) ELSE GOSUB 6000
0940 X0=0,Y0=3
0992 PRINT 'RB',
1010 Q$=""
1075 IF G<>0 THEN PRINT @(X0,Y0),'EG',D0$(G,1),'BG',
1080 PRINT @(X0,Y0),
1120 READ RECORD (14,SIZ=1)Q$
1180 P9=X0+80*(Y0-3)+1
1205 IF Q$=" " THEN GOTO 1270
1210 GOSUB 8000; IF C0>=0 THEN Q$=""
1212 IF C0>=0 THEN X$=G0$(P9,1); IF X$=" " THEN PRINT @(X0,Y0),X$, ELSE PRINT @(X0,Y0),FNG$(ASC(X$)-65),; IF V0$>"" THEN X$=V0$(P9,1); IF X$<>" " THEN PRINT @(X0,Y0),'EG',X$,'BG',
1215 IF C0=23 THEN GOTO 9900
1220 ON C0 GOTO 1225,1400,1420,1440,1460,1480,1500,1120
1240 Q=ASC(Q$)-ASC("A"); IF Q<0 OR Q>25 THEN GOTO 0990
1280 P9=X0+80*(Y0-3)+1,G0$(P9,1)=Q$
1282 IF Q$=" " THEN IF V0$>"" THEN PRINT V0$(P9,1),; GOTO 1290
1285 IF Q$=" " THEN PRINT Q$, ELSE PRINT FNG$(Q),
1320 ON G GOTO 1000,1445,1465,1400,1420
1402 G=3
1405 IF X0>0 THEN GOTO 3350 ELSE GOTO 0990
1421 G=4
1425 IF X0<W0 THEN GOTO 3400 ELSE GOTO 0990
1440 G=1
1445 IF Y0>3 THEN GOTO 3250 ELSE GOTO 0990
1461 G=2
1465 IF Y0<21 THEN GOTO 3300 ELSE GOTO 0990
1480 GOTO 0990
1500 GOTO 1550
1505 Q$="     "
1515 PRINT @(0,22),"Enter the screen position in an X,Y or X only format:",
1520 CALL "ZZENTR","SX",A{ALL},Q$,X4$,X3$,54,22,1,5,C0,"","","ENTER THE SCREEN POSITION AS XX OR XX,YY","","","",""; PRINT @(0,22),'CL',; IF C0<0 THEN GOTO 1000
1525 Q$=FNS$(Q$),Q=NUM(Q$,ERR=1526); IF Q>=0 AND Q<W0 THEN X0=(Y-3)*W0+Q+1; GOTO 1550 ELSE GOTO 0990
1530 P=POS(","=Q$); IF P=0 THEN GOTO 0990 ELSE Q0=NUM(Q$(1,P-1),ERR=0990),Q1=NUM(Q$(P+1),ERR=0990)
1535 IF Q0<0 OR Q0>=W0 OR Q1<3 OR Q1>W1 THEN GOTO 0990
1540 X0=Q0+(Q1-3)*W0+1; GOTO 1550
1555 Y=INT((X0-1)/W0),X=X0-Y*W0-1,Y=Y+3
1560 IF C9$="" THEN GOTO 1000
1580 ON POS(C9$="A") GOTO 1840
2010 CLOSE (14); OPEN (14)"ZZPARM"
2015 FIND (14,KEY="GRCTRL")Q$; Q=NUM(X3$(198,1)),Q$=Q$(8+Q*8,8)
2020 Q$=Q$+" "
2030 READ (14,KEY="GR"+Q$)B$
2065 GOSUB 8000
2070 X$=ATH(FNS$(B$(12,12))); IF X$>"" THEN GOSUB 6925
2090 RETURN 
3030 G0$=G0$+"/"
3050 IF G0$="/" THEN RETURN 
3055 Q=0,X=0
3060 IF G0$(1,1)="B" THEN GOSUB 6000; GOTO 3050
3062 IF G0$(1,1)="-" THEN G$="@000"+G0$(2,3)+"R80",G0$=G$+G0$(5)
3063 IF POS(G0$(1,1)="@")>0 THEN GOTO 3100
3065 X=X+1,Q=NUM(G0$(2,X),ERR=3070); GOTO 3065
3070 IF Q>0 THEN DIM G$(Q,G0$(1,1)); G0$=G$+G0$(1+X)
3110 IF G0$(1,1)="I" THEN GOTO 3500
3160 IF G0$(1,1)<>"@" THEN GOTO 3200
3165 X0=NUM(G0$(2,3)),Y0=NUM(G0$(5,3)),G0$=G0$(8); PRINT @(X0,Y0),; GOTO 3050
3265 IF Q$>"" OR G=X9 THEN Y0=Y0-1
3295 GOTO 3800
3315 IF Q$>"" OR G=X9 THEN Y0=Y0+1
3340 GOTO 3800
3360 G0=0
3365 IF Q$>"" OR G=X9 THEN X0=X0-1
3390 GOTO 3800
3410 G0=0
3415 IF Q$>"" OR G=X9 THEN X0=X0+1
3440 GOTO 3800
3510 G$=G0$(2,1),G0$=G0$(3)
3520 G0=POS(G$="LRTB")+6
3525 IF G0=7 THEN X0=X0-1 ELSE IF G0=8 THEN X0=X0+1 ELSE IF G0=9 THEN Y0=Y0-1 ELSE IF G0=10 THEN Y0=Y0-1
3530 PRINT @(X0,Y0),; GOSUB 6900
3590 GOTO 3050
3810 X9=G
3820 GOTO 1000
3910 G0$=G0$(2),X9=G
6005 IF G0$="" THEN GOTO 6090 ELSE Q0=ASC("A")
6008 IF C9<>2 THEN PRINT 'SB',
6010 FOR X=0 TO W1-1; Q$=G0$(X*W0+1,W0),P=1
6015 Q=POS(" "<>Q$(P)); IF Q=0 THEN GOTO 6080
6020 P=P+Q-1,Q=ASC(Q$(P,1))-Q0
6025 IF C9<>2 THEN PRINT (0,ERR=6026)@(P-1,X+3),FNG$(Q), ELSE G0$(X*W0+P,1)=FNG$(Q)
6030 P=P+1
6040 GOTO 6015
6080 NEXT X
6090 RETURN 
6910 X$=FNG$(G0),G9=G0
6920 IF POS($1B$=X$)=0 THEN PRINT X$,; RETURN 
6925 FOR Q=1 TO LEN(X$); IF X$(Q,1)=$1B$ THEN PRINT 'ES', ELSE PRINT X$(Q,1),
6930 NEXT Q; RETURN 
6990 RETURN 
7010 INPUT @(0,0),Q$,
7015 IF Q$="" THEN EXIT 
7020 G0$=Q$; GOSUB 3000
7090 GOTO 7000
8005 C0=-1
8020 P=POS(HTA(Q$)=C0$,20); IF P=0 THEN GOTO 8090 ELSE Q0$=Q$
8025 GOTO 8050
8040 READ RECORD (14,SIZ=1,TIM=1,ERR=8070)Q$
8045 Q0$=Q0$+Q$
8050 IF LEN(Q0$)>6 THEN PRINT 'RB'; GOTO 8090
8055 Q$=HTA(Q0$),Q$=Q$+S$(1,12-LEN(Q$))
8060 P=POS(Q$=C0$,20); IF P=0 THEN GOTO 8040 ELSE P=INT(P/20)
8065 C0=P,C$=STR(C0:"00"); GOTO 8090
8070 PRINT 'RB'
8090 RETURN 
8810 X$=ATH(FNS$(B$(28,12))); IF X$>"" THEN GOSUB 6925
8815 RETURN 
8820 X$=ATH(FNS$(B$(142,16))); IF X$>"" THEN GOSUB 6925
8840 RETURN 
8910 DEF FNS$(Z$)=Z$(1,POS(S$=Z$+S$)-1)
8915 DEF FNT$(Z$)=Z$(POS(" "<>Z$))
8920 DEF FNG$(G9)=ATH(B$(158+G9*2,2))
9910 IF C9<>2 THEN GOSUB 8800; GOSUB 8820
9999 END 
