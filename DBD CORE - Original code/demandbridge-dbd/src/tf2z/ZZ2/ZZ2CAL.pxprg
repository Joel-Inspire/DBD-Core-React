0010 REM "Calendar /Memo Module <ZZ2CAL>
0030 REM "(C) 1985,1986,1987 Basic Ideas, Inc; Atlanta, Ga.
0035 REM "4.0 - 08/06/96 - 12.98 - tma - SSP# 067958
0040 REM "Copyright 1996 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0110 SETERR 9000
0120 DIM S$(40)
0440 IOLIST A$
1020 SETERR 1021; ENTER X3$
1021 SETERR 9000
1025 DIM Z[NUM(X3$(60,3))]; Z$="01O ZYM... 02O ZY5...  "
1030 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 1031,9900
1040 X0$="ZZ2CAL"
1050 O9$=""; GOSUB 8000; GOSUB 7800; GOSUB 7900; GOSUB 8800
1055 D9$=X3$(21,6); IF D9$=S$(1,6) THEN D9$="I70601"
1060 Q0=NUM(D9$(3,2)),Q1=NUM(D9$(5,2)),Q2=1900+10*(ASC(D9$(1,1))-65)+NUM(D9$(2,1))
3415 GOSUB 8300
3420 GOSUB 4200
3430 CALL "ZZPROM","X0ZZ2CAL",X3$,S3,"","","",0; ON S3 GOTO 9900,3431
3432 IF S3=7 THEN CALL "ZY2DAA"; GOTO 1050
3435 IF S3=5 THEN GOSUB 8700; GOTO 3400 ELSE IF S3=6 THEN GOSUB 4000; GOTO 3400
3450 X9=0; IF S3=1 THEN X9=-1 ELSE IF S3=2 THEN X9=1 ELSE IF S3=3 THEN D9$(3,2)=STR(Q0-1:"00"),Q0=Q0-1 ELSE IF S3=4 THEN D9$(3,2)=STR(Q0+1:"00"),Q0=Q0+1
3455 IF Q0=0 THEN Q0=12,D9$(1,2)=BIN(DEC(D9$(1,2))-1,2),D9$(3,2)="12"
3460 Q$=D9$; CALL "ZZDATE",X3$,"",Q$,D9$,X9,0,0,0,0,0,0,"","",""
3480 GOTO 1060
4040 DIM T1$(6+35*9)
4050 T1$(1)=X3$(40,3)+D9$
4070 FIND (Z[1],KEY=T1$(1,9),DOM=4071)T1$
4120 CALL "ZZENTR","SX",X{ALL},T1$,X4$,X3$,45,11,10,32,C0,"","","","","","","08V0"
4190 IF POS(" "<>T1$(10))>0 THEN WRITE (Z[1],END=4400,KEY=T1$(1,9))T1$ ELSE REMOVE (Z[1],KEY=T1$(1,9),DOM=4191)
4195 RETURN 
4210 T1$=X3$(40,3)+D9$
4220 FIND (Z[1],KEY=T1$,DOM=4250)T1$; T9$="*"
4230 FOR X=0 TO 8
4235 PRINT @(45,11+X),T1$(10+X*32,32),
4240 NEXT X
4245 GOTO 4290
4250 IF T9$="" THEN GOTO 4290 ELSE DIM T1$(10*33); T9$=""; FOR X=0 TO 8; PRINT @(45,11+X),T1$(10+X*32,32),; NEXT X; GOTO 4290
4290 RETURN 
4295 RETURN 
4410 F0$=STR(Z[1]:"00")
4420 CALL "ZZEXPF",X3$,"","?","",Q; ON Q GOTO 4430,9900
4490 RETRY 
7060 GOSUB 8000
7810 PRINT @(0,3),'CE',
7820 CALL "ZZVDTP",X3$,X0$,"*",V0$,0
7885 PRINT 'SF',
7890 RETURN 
7905 PRINT 'SB',
7910 FOR X=0 TO 6; PRINT @(2+X*6,7),Q0$(1+X*48,3),; NEXT X
7915 PRINT 'SF',
7940 RETURN 
8010 Q0$=""
8012 FOR X=1 TO 12
8015 CLOSE (14); OPEN (14)"ZY2"
8020 DIM A$(110); READ (14,KEY=X3$(239,1)+STR(X:"00"),DOM=8021)IOL=0440; GOTO 8040
8025 IF X3$(239,1)<>" " THEN READ (14,KEY=" "+STR(X:"00"),DOM=8026)IOL=0440
8040 Q0$=Q0$+A$(100,8)+A$(52,20)+A$(80,20)
8050 NEXT X
8090 RETURN 
8310 IF D9$(1,4)=O9$ THEN GOTO 8380 ELSE PRINT 'CF',
8330 CALL "ZZDAYT",D9$(1,4)+"01",D9
8332 CALL "ZZDINF",X3$,D9$,"",0,D0,D8,0,0,0
8335 D9=D9-1
8360 FOR X=0 TO D8-1
8365 X0=MOD(D9+X,7),X1=INT((D9+X)/7)
8370 GOSUB 8500
8375 NEXT X; O9$=D9$(1,4)
8380 GOSUB 8400; PRINT @(47,4),S$(1,31),@(47,4),D0$,@(16-INT(LEN(M0$)/2),5),M0$,
8385 IF S9$>"" THEN PRINT @(47,5),S9$(7,30), ELSE PRINT @(47,5),S$(1,30),
8390 RETURN 
8405 CALL "ZZDAYT",D9$,D5; D0$=FNS$(Q0$((D5-1)*48+29,20))+",  "
8410 Q=NUM(D9$(3,2)),D1=NUM(D9$(5,2)),Q$=Q0$((Q-1)*48+9,20); D0$=D0$+FNS$(Q$)
8420 D0$=D0$+" "+STR(D1)+", "+STR(INT(D0/1000))
8425 M0$=FNS$(Q0$((Q-1)*48+9,20))+", "+STR(INT(D0/1000))
8430 S9$=""; FIND (Z[2],KEY=D9$,DOM=8431)S9$
8440 RETURN 
8500 REM "DETERMINE IF DATE IS SPECIAL
8510 Q$=D9$(1,4)+STR(X+1:"00")
8520 S9$=""; FIND (Z[2],KEY=Q$,DOM=8521)S9$
8525 Z0=X0*6+3,Z1=X1*2+9
8526 IF S9$>"" THEN IF S9$(37,1)="1" THEN GOTO 8540
8530 IF X3$(278,1)="1" THEN PRINT @(Z0-1,Z1),'ER',STR(X+1:"#0"), ELSE PRINT @(Z0-1,Z1)," ",STR(X+1:"#0")," "
8535 GOTO 8590
8540 IF S9$(37,1)<>"1" THEN GOTO 8590
8550 IF X3$(238,1)="1" THEN PRINT @(Z0+2,Z1),'ER',@(Z0-1,Z1),'BR',STR(X+1:"#0"), ELSE PRINT @(Z0-1,Z1),'BR',STR(X+1:"#0"),'ER',
8595 RETURN 
8730 T0$=X3$(52,4)
8740 CALL "ZZENTR","TUX",X{ALL},T0$,X4$,X3$,66,7,1,4,C0,"","","","","","",""
8745 IF C0>0 THEN X3$(52,4)=T0$
8790 RETURN 
8840 Q$=X3$(52,4); IF Q$<>"    " THEN CALL "ZZDISP","T!",Q$,"",X3$,"","",66,7,""
8890 RETURN 
8910 DEF FNS$(Z$)=Z$(1,POS("  "=Z$+"  ")-1)
9001 PRINT ERR,TCB(5); INPUT *
9005 IF ERR=65 THEN RETRY 
9010 EXIT ERR
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940; EXIT 
9940 RUN "ZMENU"
9999 END 
