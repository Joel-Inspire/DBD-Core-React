0010 REM "Write Mail Message <ZZ2MAZ>
0035 REM "3.8 - 08/01/95 - 11.42 - kmc
0040 REM "Copyright 1995 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 ENTER X3$,A1$,A$
0140 S9$=$7E$
0310 IOLIST A$(1)
0320 IOLIST B$,A$(19,41)
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X ZZM... 02O ZZN...  13O ZZPARM  "
0520 GOSUB 9750; ON Z0 GOTO 0521,9900
0585 W9$=""; CALL "RT2PRM",ERR=0586,X3$,X4$,W9$
6700 REM "ADD ENTRY
6710 IF POS("*"=A$(1,3))>0 THEN GOSUB 7600 ELSE GOSUB 7700
6790 GOTO 9900
7600 REM "SET MESSAGE FOR A$
7610 M$=A$(1,3); READ (Z[13],KEY="o",DOM=7611)
7620 K$=KEY(Z[13],END=7690); IF K$(1,1)<>"o" THEN GOTO 7690 ELSE READ (Z[13])O$
7630 IF M$(1,3)="***" OR (M$(1,1)="*" AND M$(2,2)=O$(74,2)) THEN A1$(1,3)=O$(2,3),A$(1,3)=O$(2,3); GOSUB 7700
7640 GOTO 7620
7695 RETURN 
7700 REM "WRITE MESSAGE FOR AN OPERATOR
7710 WRITE (Z[1],KEY=A1$)IOL=0310
7711 IF W9$>"" THEN CALL "RT2WOR",ERR=7712,X3$,X4$,"!"+A$(1,3),"ZZM...","U",A1$,A$,0,A{ALL}; REM "Record remote T/M change
7712 PRINT @(0,22),'CL',"UPDATING MAIL: ",A1$,
7715 IF A$(60,6)<>"      " THEN IF A$(60,6)>X3$(21,6) THEN GOTO 7730
7720 CALL "ZZSETM",X3$,A$(1,3),"+"
7730 GOSUB 7800
7745 RETURN 
7800 REM "Tracking record
7810 DIM B$(32)
7820 B$(4,1)="I"; B$(1,3)=A$(14,3),B$(5,3)=A$(1,3),B$(8,10)=A$(4,10)
7860 WRITE (Z[2],KEY=B$(1,17))IOL=0320
7863 IF W9$>"" THEN B9$=B$(1,17); CALL "RT2WOR",ERR=7864,X3$,X4$,"!"+B$(1,3),"ZZN...","U",B9$,B$+S9$+A$(19,41),0,A{ALL}; REM "Record remote T/M change
7865 B$(1,7)=A$(1,3)+"R"+A$(14,3)
7870 WRITE (Z[2],KEY=B$(1,17))IOL=0320
7875 IF W9$>"" THEN B9$=B$(1,17); CALL "RT2WOR",ERR=7876,X3$,X4$,"!"+B$(1,3),"ZZN...","U",B9$,B$+S9$+A$(19,41),0,A{ALL}; REM "Record remote T/M change
7880 READ (Z[13],KEY=K$,DOM=7881)
7895 RETURN 
8000 REM "Mail message for remote location
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9999 END 
