0010 REM "Data File Layout Printing <ZZXFCA>
0020 REM "(C) 1984 & 1985 BASIC IDEAS, INC; ATLANTA, GA.
0030 REM "    THIS SOFTWARE CONTAINS TRADE SECRETS AND PROPRIETARY INFORMATION
0090 CLEAR ; SETERR 9000
0105 SETERR 9000; SETESC 9300
0110 X0$="ZZXFCA",X1$="Data File Layout Printing"
0120 DIM A[1]
0130 F0=0,F1=1,H0=115
0140 DIM S$(10)
0200 REM "
0220 DIM T[F0,F1]
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2; IF X4$="END" THEN GOTO 9900
0300 REM "IOLISTS
0305 REM "IOLIST FOR ZZF - FILE DATA MAINTENANCE
0310 IOLIST A$,A[0],A[1]
0400 REM "FILES
0405 DIM Z[20]
0410 Z$="01O ZZF     02O ZZE     "
0420 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0425 ON Z0 GOTO 0426,9900
0500 REM "PRINTER
0510 H0$="I"
0520 CALL "ZZPRIN",X0$,X3$,Y0$,"",Z{ALL},H0$,H1$,H4,H9,H2,H3,H0; ON H0 GOTO 0521,9900
0600 INPUT @(12,22),"ENTER THE FILE NAME: ",Q$
0610 IF Q$="" OR Q$="END" THEN GOTO 9900
0620 DIM T[F0,F1]
0700 REM "Get file name for Header"
0710 H0$="File layout for: "+Q$,H1$=""
0720 Q1$=Q$+S$(1,6-LEN(Q$))
0730 READ (Z[2],KEY=Q1$,DOM=0800)B$
0740 H1$=B$(7,40)
0750 H1$=H1$(1,POS("    "=H1$+"    ")-1)
0900 REM "POSITION READ
0920 READ (Z[1],KEY=Q$,DOM=0921)
0930 T=0
1000 REM "READ NEXT RECORD
1020 READ (Z[1],END=5000)IOL=0310
1100 REM "RANGE CHECK
1120 IF A$(1,LEN(Q$))>Q$ THEN GOTO 5000
1130 T=T+1
1200 REM "SUBTOTALS
1300 REM "READ OTHER DATA
1310 S0=S0+1
1400 REM "SECONDARY READ
1490 IF H8=0 OR H1>H4 THEN GOSUB 6000
1500 REM "PRINT DATA
1510 PRINT (H9)@(0),A$(7,3),@(4),S0:"###",@(8),A$(13,40),@(56),A$(53,3),@(64),A$(10,3),@(77),A$(56,3),@(88),A$(59,9),@(100),A$(68,6)
1800 REM "ACCUMULATE TOTALS
1890 L=L+1,T[0,0]=T[0,0]+1
1990 GOTO 1000
5000 REM "END OF PRINT
5010 IF T=0 THEN GOTO 0600
5020 IF H2=1 THEN GOTO 5200
5025 E9$="END"
5030 T$="REPORT",T=0; GOSUB 7000
5200 REM "
5280 PRINT (H9)'FF',
5283 H8=0,H1=0,S0=0
5285 GOTO 0600
5290 GOTO 9900
6000 REM "PAGE HEADER
6040 CALL "ZZHEAD",X0$,X1$,X2$,X3$,H0$,H1$,H2$,H3$,H0,H1,H9,H8,H4,H3,H6,H4$,H5$
6045 ON H3 GOTO 6046,9900
6085 GOSUB 6100
6090 RETURN 
6100 REM "
6110 PRINT (H9)@(0),"Data",@(55),"Data",@(61),"String",@(68),"Pos",@(72),"/",@(75),"Length",@(82),"or",@(88),"Special",@(100),"Verify"
6120 PRINT (H9)@(0),"Seq",@(8),"Description",@(55),"Type",@(61),"Array",@(67),"Index",@(77),"Mask",@(88),"Output",@(101),"File"
6130 PRINT (H9)@(0),"-----",@(8),"---------------------------------------------",@(55),"----",@(61),"-----------",@(75),"---------",@(88),"----------",@(100),"--------"
6290 RETURN 
7000 REM "TOTALS LOGIC
7010 IF T$="" THEN GOTO 7100
7090 PRINT (H9)'LF',@(0),"NUMBER OF ITEMS PRINTED: ",T[0,0]
7100 REM "ACCUMULATE TOTALS
7110 IF F=F0 THEN GOTO 7190
7120 FOR X=0 TO F1
7130 T[F+1,X]=T[F+1,X]+T[F,X],T[F,X]=0
7140 NEXT X
7190 RETURN 
9000 REM "ERROR PROCESSING
9010 E0=ERR,E1=TCB(5)
9015 SETERR 9016; E0$=LST(PGM(E1))
9016 SETERR 9000
9040 CALL "ZZERRM",E0$,X0$,E1$,X3$,E0,E1,E2,E3
9050 ON E2 GOTO 9060,9100,9900,9070
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE E1$
9080 SETERR 9000; RETRY 
9100 REM " TRANSFER CONTROL
9190 GOTO 9900
9300 REM "ESCAPE
9310 SETESC 9350
9320 IF X3$(47,1)<>"N" THEN SETESC 0000; RETURN 
9350 RETURN 
9900 REM "END PROGRAM
9920 BEGIN 
9940 RUN "ZMENU"
9999 END 
