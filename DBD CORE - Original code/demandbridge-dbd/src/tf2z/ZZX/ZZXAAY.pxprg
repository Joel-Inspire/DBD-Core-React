0010 REM "DETERMINE NUMERIC MASK <ZZMASK>
0030 REM "(C) 1985,1986 Basic Ideas, Inc; Atlanta, Ga.
0035 REM "This software contains trade secrets and proprietary information"
1010 ENTER P$,M$; M$=""; IF LEN(P$)>3 THEN P9$=P$(4),P$=P$(1,3)
7215 IF LEN(P$)=0 THEN GOTO 2406 ELSE IF LEN(P$)>3 THEN GOTO 7210
7220 IF LEN(P$)=1 THEN A=NUM(P$)
7225 IF LEN(P$)=2 THEN A=NUM(P$(1,1)),B=NUM(P$(2))
7230 IF LEN(P$)=3 THEN A=NUM(P$(1,1)),B=NUM(P$(2,1)),C=NUM(P$(3))
7235 IF C*3>=A THEN M$=""; GOTO 7280
7240 IF C<>0 THEN M$=",###"+M$,C=C-1,A=A-3; GOTO 7240
7245 IF A<0 THEN M$=M$(LEN(M$)+A)
7250 IF A>0 THEN M$="#"+M$,A=A-1; GOTO 7250
7255 IF B=0 THEN M$(LEN(M$),1)="0"; GOTO 7270
7260 M$=M$+"."
7265 IF B>0 THEN DIM Z$(B,"0"); M$=M$+Z$
7290 IF POS("C"=P9$)>0 THEN M$=M$+"CR" ELSE IF POS("D"=P9$)>0 THEN M$=M$+"DR" ELSE IF POS("&"=P9$)=0 THEN M$=M$+"-"
9950 EXIT 
9999 END 
