0010 REM "Sort File Data Maintenance <ZZXFAB>
0020 SETESC 9300; SETERR 9000
0030 REM "(C) 1984 Basic Ideas, Inc; Atlanta, Georgia.
0035 REM "    This software contains trade secrets and proprietary information"
0100 ENTER A$,Z9,C9,X3$,Z0$,Z{ALL},L0
0110 X0$="ZZXFAB"
0310 IOLIST A$
0620 GOSUB 6400
0650 X0=2; ON C9 GOTO 1800,2040
1600 REM "
1630 GOTO 9800
1650 REM "SORT SEQUENCE
1665 Q$=A$(63,56),Q0=0,Q1=0
1670 CALL "ZZXFAD",X3$,Q$,Z{ALL},A{ALL},Q0,Q1,C0
1675 A$(63,56)=Q$
1680 CALL "ZZPROM","X0ZZ2FAB",X3$,L0,"","","",0; ON L0 GOTO 1650,6500,9800
1800 REM "
1810 A1$=A$(1,6)
1820 CALL "ZZPROM","X1ZZ2FAB",X3$,Z,"","","",X0
1825 ON Z GOTO 1855,1650,9800,6500
1830 GOTO 2000
1850 REM "MODIFY
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880
1860 EXTRACT (Z[1],KEY=A1$,DOM=1870)IOL=0310
1870 GOSUB 6200
1890 ON Z+1 GOTO 2040,1830
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1
2020 C9=1,Z9=1; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1
2025 IF C0>3 THEN X0=X0+999
2040 ON X0 GOTO 2100,2150,2200,2250,2300,2350,1800
2100 REM "DESCRIPTION
2110 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,33,3,7,40,C0,"",X$,"","ZZE02","","",""; IF C0>6 THEN GOSUB 6400; ON C1 GOTO 2110,2111
2140 GOTO 2020
2150 X$="ENTER THE File Type"
2155 GOTO 2190
2160 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,11,5,47,1,C0,"",X$,"","ZZE04","","",""; IF C0>6 THEN GOSUB 6400; ON C1 GOTO 2160,2161
2190 GOTO 2020
2200 REM "KEY SIZE
2210 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,30,5,48,2,C0,"",X$,"","ZZE06","","",""; IF C0>6 THEN GOSUB 6400; ON C1 GOTO 2210,2211
2240 GOTO 2020
2250 X$="ENTER THE Primary File"
2260 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,18,8,50,6,C0,"",X$,"","ZZE08","ZZE","",""; IF C0>6 THEN GOSUB 6400; ON C1 GOTO 2260,2261
2290 GOTO 2020
2300 X$="ENTER THE Secondary Source File"
2310 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,18,10,56,6,C0,"",X$,"","ZZE10","ZZE","",""; IF C0>6 THEN GOSUB 6400; ON C1 GOTO 2310,2311
2340 GOTO 2020
2350 X$="ENTER THE Temp/Perm Sort"
2360 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,18,12,62,1,C0,"",X$,"","ZZE12","","",""; IF C0>6 THEN GOSUB 6400; ON C1 GOTO 2360,2361
2390 GOTO 2020
6000 REM "BACKGROUND
6005 PRINT @(0,7),'CE','SB',
6060 PRINT @(4,8),"Primary File:",@(0,10),"Secondary Source:",@(2,12),"Temp/Perm Sort:",@(0,14),Z0$,
6065 PRINT (0,ERR=6066)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6220 PRINT @(33,3),A$(7,40),@(11,5),A$(47,1),@(30,5),A$(48,2),@(61,5),FNB$(A$(46,1)),@(18,8),A$(50,6),@(18,10),A$(56,6),@(18,12),A$(62,1),
6390 RETURN 
6400 REM "WHOLE SCREEN
6410 GOSUB 6000
6420 GOSUB 6200
6430 IF K>0 THEN GOSUB 6200
6440 IF ABS(C0)>6 THEN C1=ABS(C0)-8
6445 RETURN 
6450 REM "DISPLAY KEYS
6460 PRINT @(11,3),A$(1,6),
6490 RETURN 
6500 REM "DELETE
6510 L0=1; GOTO 9800
6590 GOTO 1630
6700 REM "ADD ENTRY
6710 WRITE (Z[1],KEY=A1$)IOL=0310
6790 GOTO 1630
8920 DEF FNB$(Z9$)=X3$(214-6*POS(Z9$="1"),1)
9000 REM "ERROR PROCESSING
9010 E0=ERR,E1=TCB(5)
9015 SETERR 9016; E0$=LST(PGM(E1))
9016 SETERR 9000
9040 CALL "ZZERRM",E0$,X0$,E1$,X3$,E0,E1,E2,E3,0
9050 ON E2 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9800 REM "RUN FIRST OVERLAY
9820 EXIT 
9900 REM "END PROGRAM
9950 EXIT 
9999 END 
