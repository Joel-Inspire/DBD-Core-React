0010 REM "Sort File Data Management - D <ZZXFAD>
0030 REM "(C) 1984 Basic Ideas, Inc; Atlanta, Georgia.
0035 REM "    This software contains trade secrets and proprietary information"
0100 ENTER X3$,Q$,Z{ALL},A{ALL},A,B,C0
0110 C0=0,X0$="ZZXFAD"
0130 C8=8,C6=7,C7=-1
0150 GOSUB 6000
0180 IF A>=0 THEN C7=A; GOTO 2000
0300 REM "IOLISTS
0320 IOLIST B$
1700 REM "
1790 GOTO 1900
1800 REM "ADD ENTRY
1820 Q$(C6*C7+1,C6)=A$
1900 REM "CURRENT COUNTER
1905 ON C0-1 GOTO 1910,1930,1950
1910 C7=C7+1; IF C7>=C8 THEN GOTO 9900
1920 GOTO 2000
1930 C7=C7-1; IF C7<0 THEN GOTO 9900
1940 GOTO 2000
1950 REM "
1960 GOTO 9900
2000 REM "DATA SEQ
2005 PRINT @(25,8),C7+1:"0",":"
2010 C0=0,X0=-1,X1=1,A$=Q$(C6*C7+1,C6)
2015 GOSUB 6200
2020 C9=1,Z9=1,X$=""; IF C0=2 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1
2025 IF C0>3 THEN X0=X0+999
2030 IF A<0 THEN A=C7,X0=B
2040 ON X0+1 GOTO 1800,2100,2150,2200,2250,1800
2110 CALL "ZZENTR","ZQ",A{ALL},A$,X4$,X3$,25,10,1,1,C0,"",X$,"","ZZXFAD02","ZZE","",""; IF ABS(C0)>4 THEN GOTO 9800
2119 GOTO 2121
2120 FIND (Z[2],KEY=A$(1,1),DOM=2110)IOL=0320
2140 GOTO 2020
2160 CALL "ZZENTR","SQUR",A{ALL},A$,X4$,X3$,25,12,2,1,C0,"",X$,"A+-I","ZZXFAD04","","",""; IF ABS(C0)>4 THEN GOTO 9800
2190 GOTO 2020
2210 CALL "ZZENTR","ZQ",A{ALL},A$,X4$,X3$,25,14,3,3,C0,"",X$,"","ZZXFAD06","","",""; IF ABS(C0)>4 THEN GOTO 9800
2240 GOTO 2020
2260 CALL "ZZENTR","ZQ",A{ALL},A$,X4$,X3$,25,16,6,2,C0,"",X$,"","ZZXFAD08","","",""; IF ABS(C0)>4 THEN GOTO 9800
2290 GOTO 2020
6000 REM "BACKGROUND
6005 PRINT @(0,7),'CE','SB',
6060 PRINT @(10,8),"Sort Sequence:",@(14,10),"File Code:",@(16,12),"A/+/-/I:",@(0,14),"Starting Position/Index:",@(17,16),"Length:",
6065 PRINT (0,ERR=6066)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6220 PRINT @(25,10),A$(1,1),@(25,12),A$(2,1),@(25,14),A$(3,3),@(25,16),A$(6,2),
6390 RETURN 
7000 REM "CUSTOM PROGRAMMING ROUTINES
9000 REM "ERROR PROCESSING
9010 E0=ERR,E1=TCB(5)
9015 SETERR 9016; E0$=LST(PGM(E1))
9016 SETERR 9000
9040 CALL "ZZERRM",E0$,X0$,E1$,X3$,E0,E1,E2,E3,0
9050 ON E2 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE E1$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9900 REM "END PROGRAM
9910 A=C7,B=X0
9920 EXIT 
9999 END 
