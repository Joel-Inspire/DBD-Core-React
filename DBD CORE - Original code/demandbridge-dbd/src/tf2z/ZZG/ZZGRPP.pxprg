0010 REM "Printer Graphics Module <ZZGRPP>
0030 REM "(C) 1985-1989 Basic Ideas, Inc; Atlanta, GA. USA
0035 REM "5.7 - 12/17/10 - 14.401666 - crg - SSP# 237164
0037 REM "237164-Install Unform. Implement electronic forms support in Unform
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0110 SETERR 9000
1020 ENTER X3$,X1$,X{ALL},M0$,S0,S1,Q0,Q1,Q2,S2,S3,S4,S5,S6,D9$,F0,F1,F9,T9$,T9
1040 G0$=X1$
1045 IF POS("!"=G0$)=1 THEN G9$=G0$(2,1),G0$=G0$(3) ELSE G9$=" "
1205 DIM S$(16)
1210 GOSUB 2000
1220 IF G0$="?" THEN GOTO 7000
1225 IF G0$="G" THEN GOTO 4000
1230 IF G0$="B" THEN GOSUB 6000; GOTO 9940
1250 GOSUB 3000
1290 GOTO 9900
1900 REM "FIND PRINTER TYPE
1910 Q$="ASCII   "; X$=FID(F9,ERR=1990); IF X$<>FID(0) THEN GOTO 1920
1915 CALL "ZZCTLK",X3$,Q$,"Z"; IF Q$="" THEN Q$="ANSI    " ELSE Q$=Q$+"        ",Q$=Q$(1,8)
1916 GOTO 1950
1920 IF LEN(X$)>2 THEN GOTO 1990 ELSE READ (14,KEY="PRINTERS")P0$,P1$; P0$=P0$(9)
1925 P=POS(X$=P1$,2); IF P=0 THEN GOTO 1990
1930 Q$=P0$(INT(P/2)*8+1,8)
1990 RETURN 
2010 CLOSE (14); OPEN (14)"ZZPARM"
2015 GOSUB 1900
2018 CLOSE (14); OPEN (14)"ZZPARM"
2020 IF G9$>"" THEN READ (14,KEY="GR"+Q$+G9$,DOM=2021)B$; GOTO 2040
2030 CLOSE (14); OPEN (14)"ZZPARM"; READ (14,KEY="GR"+Q$,DOM=2031)B$; GOTO 2040
2035 IF POS("MISC"=Q$)=1 THEN EXIT ELSE CALL "ZZPROM",".4",X3$,0,"The graphics interface for term type "+Q$+" is not defined","","",0; Q$(1)="MISC",G9$=" "; GOTO 2020
2065 GOSUB 8000
2070 X$=ATH(FNS$(B$(12,12))); IF X$>"" THEN GOSUB 6925
2090 RETURN 
3030 G0$=G0$+"/"
3050 IF G0$="/" THEN RETURN 
3055 Q=0,X=0
3060 IF G0$(1,1)="B" THEN GOSUB 6000; GOTO 3050
3062 IF G0$(1,1)="-" THEN G$="@000"+G0$(2,3)+"R80",G0$=G$+G0$(5)
3063 IF POS(G0$(1,1)="@")>0 THEN GOTO 3100
3065 X=X+1,Q=NUM(G0$(2,X),ERR=3070); GOTO 3065
3070 IF Q>0 THEN DIM G$(Q,G0$(1,1)); G0$=G$+G0$(1+X)
3110 IF G0$(1,1)="I" THEN GOTO 3500
3160 IF G0$(1,1)<>"@" THEN GOTO 3200
3165 X0=NUM(G0$(2,3)),Y0=NUM(G0$(5,3)),G0$=G0$(8); PRINT @(X0,Y0),; GOTO 3050
3210 G=POS(G0$(1,1)="UDLR")
3240 ON G-1 GOTO 3250,3300,3350,3400
3260 G0=1; IF G9=0 THEN IF X9=3 THEN G0=5 ELSE IF X9=4 THEN G0=6
3265 IF G0=1 THEN Y0=Y0-1
3270 PRINT @(X0,Y0),FNG$(G0),
3295 GOTO 3800
3310 G0=1; IF G9=0 THEN IF X9=3 THEN G0=3 ELSE IF X9=4 THEN G0=4
3315 IF G0=1 THEN Y0=Y0+1
3330 PRINT @(X0,Y0),FNG$(G0),
3340 GOTO 3800
3360 G0=0; IF G9=1 THEN IF X9=1 THEN G0=4 ELSE IF X9=2 THEN G0=6
3365 IF G0=0 THEN X0=X0-1
3370 PRINT @(X0,Y0),FNG$(G0),
3390 GOTO 3800
3410 G0=0; IF G9=1 THEN IF X9=1 THEN G0=3 ELSE IF X9=2 THEN G0=5
3415 IF G0=0 THEN X0=X0+1
3430 PRINT @(X0,Y0),FNG$(G0),
3440 GOTO 3800
3510 G$=G0$(2,1),G0$=G0$(3)
3520 G0=POS(G$="LRTB")+6
3525 IF G0=7 THEN X0=X0-1 ELSE IF G0=8 THEN X0=X0+1 ELSE IF G0=9 THEN Y0=Y0-1 ELSE IF G0=10 THEN Y0=Y0-1
3530 PRINT @(X0,Y0),; GOSUB 6900
3590 GOTO 3050
3810 G0$=G0$(2),X9=G
3820 GOTO 3050
3910 G0$=G0$(2),X9=G
4030 C0=2,B9=0
4120 X0=S0,Y0=S1-S2,W0=S3,H0=S2; GOSUB 6100
4205 B0=0,B1=0
4210 Q9=0; FOR X=Q0 TO Q1
4220 Q9=Q9+1; IF X[X]<B0 THEN B0=X[X]
4225 IF X[X]>B1 THEN B1=X[X]
4230 B9=B9+X[X]
4250 NEXT X
4255 S9=2,Q=2; IF B0<0 THEN Q=3
4260 W0=INT((S3-Q)/Q9); IF W0>5 THEN S9=3
4261 S=W0-S9,W1=W0-S
4265 W2=(B1-B0+B9/Q9/10)/S2,W3=S1-2,Q=25*10^(EPT(W2)-1); IF Q>25 OR Q<=25 THEN Q=Q/20 ELSE IF Q=0 THEN Q=1
4266 S8=2; IF S>4 THEN S8=INT(S/2)
4267 W2=INT((Q+W2)/Q)*Q
4275 IF B0<0 THEN W4=INT((ABS(W2)+ABS(B0))/W2) ELSE W4=0
4280 FOR Y=2 TO S2-1; DIM Q$(S3-2,FNG$(0))
4284 D9$(FNP(S0,S1-Y),1)=FNG$(7),D9$(FNP(S0+S3-1,S1-Y),1)=FNG$(8)
4285 D9$(FNP(S0+1,S1-Y),LEN(Q$))=Q$
4290 NEXT Y
4305 DIM Q$(S9,FNG$(13)),W$(S2-2)
4310 Q9=-1; FOR Z0=Q0 TO Q1; Q9=Q9+1
4340 IF X[Z0]=0 THEN GOTO 4360 ELSE H=INT(X[Z0]/W2); IF H=0 THEN H=SGN(X[Z0])
4350 FOR X=SGN(H) TO H STEP SGN(H); D9$(FNP(S8+S0+1+Q9*W0,W3+1-W4-X),LEN(Q$))=Q$; NEXT X
4380 NEXT Z0
4405 IF M0$="" THEN M0$="####,##0-"
4408 GOSUB 8800
4410 Q9=-1; FOR X=Q0 TO Q1; Q9=Q9+1
4415 Q=S0+S8+Q9*(S+W1)+1,Q$=FNT$(STR(X[X]:M0$)); IF LEN(M0$)>2*(S+W1) THEN Q$=""; GOTO 4420
4417 IF X3$(126,2)<>".," THEN CALL "ZZDISP","NMX",STR(X[X]:M0$),"",X3$,Q$,"",0,0,X4$
4420 GOSUB 4800; IF Q$>"" THEN D9$(FNP(Q+4-LEN(Q$),S1+MOD(Q9,2)),LEN(Q$))=Q$
4430 NEXT X
4440 FOR X=0 TO S2-1 STEP 2
4442 Q=INT((W2*X-W4*W2)/W2)*W2
4445 CALL "ZZDISP","NMX",STR(Q:M0$),"",X3$,Q$,"",0,0,X4$
4448 D9$(FNP(S0-1-LEN(M0$),S1-X-1),LEN(Q$))=Q$
4450 NEXT X
4490 GOTO 4900
4800 REM "STRING TAGS FOR COLUMNS
4820 IF T9=0 THEN D9$(FNP(Q,W3+1-W4),2)=STR(Q9+1:"##"); RETURN 
4830 D9$(FNP(Q,W3+1-W4),T9)=T9$(Q9*T9+1,T9)
4890 RETURN 
4910 IF S5>0 THEN CALL "ZZPROM","4",X3$,0,"","","",0
4940 GOTO 9900
6010 G9=-1,X9=-1
6080 X0=S0,Y0=S1,W0=S3,H0=S2
6109 REM "PRINT @(X0,Y0),
6110 D9$(FNP(X0,Y0),1)=FNG$(3)
6120 W=W0-2,Y=Y0
6130 DIM Q$(W,FNG$(0)); D9$(FNP(X0+1,Y0),LEN(Q$))=Q$
6140 D9$(FNP(X0+W+1,Y0),1)=FNG$(4)
6155 H=H0-2
6160 FOR X=1 TO H; D9$(FNP(X0,Y0+X),1)=FNG$(1),D9$(FNP(X0+W0-1,Y0+X),1)=FNG$(1); NEXT X
6170 D9$(FNP(X0,Y0+H+1),1)=FNG$(5)
6180 DIM Q$(W,FNG$(0)); D9$(FNP(1+X0,Y0+H+1),LEN(Q$))=Q$
6185 D9$(FNP(X0+W+1,Y0+H+1),1)=FNG$(6)
6195 RETURN 
6910 X$=FNG$(G0),G9=G0
6920 IF POS($1B$=X$)=0 THEN PRINT X$,; RETURN 
6925 PRINT 'BO',X$,'EO',
6990 RETURN 
7010 INPUT @(0,0),Q$,
7015 IF Q$="" THEN EXIT 
7020 G0$=Q$; GOSUB 3000
7090 GOTO 7000
8010 X$=ATH(FNS$(B$(76+S4*22,16))),P0=NUM(B$(92+S4*22,3)),P1=NUM(B$(95+S4*22,3))
8015 IF X$>"" THEN GOSUB 6925; WAIT 1
8090 RETURN 
8810 X$=ATH(FNS$(B$(28,12))); IF X$>"" THEN GOSUB 6925
8815 RETURN 
8820 X$=ATH(FNS$(B$(142,16))); IF X$>"" THEN GOSUB 6925
8840 RETURN 
8910 DEF FNS$(Z$)=Z$(1,POS(S$=Z$+S$)-1)
8915 DEF FNT$(Z$)=Z$(POS(" "<>Z$))
8920 DEF FNG$(G9)=ATH(B$(158+G9*2,2))
8925 DEF FNP(D8,D9)=F1*D9+D8+1
9010 PRINT @(0,22),"ERROR ",ERR," LINE ",TCB(5); INPUT *
9905 IF S6=1 THEN PRINT @(0,3),'CE',
9910 GOSUB 8800; GOSUB 8820
9940 PRINT (0,ERR=9941)'EG',
9999 END 
56001 REM "237164-Install Unform. Implement electronic forms support in Unform
