0010 REM "GL2DTE - Check if records exist in any closed G/L periods
0035 REM "4.4 - 06/11/99 - 8.52 - tma - SSP# 113857
0040 REM "Copyright 1999 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 ENTER X3$,X4$,YR$,FLAG$; REM "YR$ ="YYYYPP (YEAR+PERIOD TO BE CHECKED) FLAG$="*"  (IF THERE IS A CLOSED PERIOD)
0110 XX$=X3$
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01O ZZPARM  02O ZZPARM  03O ZY9...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0900 REM "SET VARIABLES
0910 DIM OPER$(255),GL$(300)
0920 Z1$=""
1000 REM "BEGIN
1020 DIM OPER$(255); READ (Z[1],KEY="osec"+X3$(40,3),DOM=1040)OPER$(1)
1030 IF OPER$(58,1)="Y" THEN GOTO 9900
1040 READ (Z[1],KEY=X3$(9,3)+"G/L",DOM=9900)GL$(1)
1050 IF GL$(256,1)<>"Y" THEN GOTO 9900
1060 IF X3$(145,1)="1" THEN GOTO 1300
1200 REM "BUILD REQUIRED FILES FOR NON-BATCH SYSTEMS
1210 Z1$="ARBARPARRAPCAPDAPRGL7ICAPO7"
1220 FOR ZZ=1 TO LEN(Z1$)/3
1230 ZZ$="02C  02O "+Z1$(ZZ*3-2,3)+"...  "
1240 CLOSE (Z[2])
1250 CALL "ZZFLES",X3$,Y1$,Y0$,ZZ$,Z{ALL},Z0,Z1; ON Z0 GOTO 1251,9900
1260 GOSUB 2000
1270 NEXT ZZ
1290 GOTO 9900
1300 REM "BUILD VARIABLES FOR SYSTEMS USING BATCHES
1305 X3$(174,4)="    "
1310 K0$=KEY(Z[3],END=1400)
1320 READ RECORD (Z[3],KEY=K0$)KK$
1330 IF KK$(110,3)<>X3$(9,3) THEN GOTO 1310
1335 IF KK$(6,6)="AP2CAA" THEN GOTO 1310
1340 GOSUB 3000; REM "FIND THE FILE TO USE
1350 ZZ1$=ZZ1$+KK$(1,4)
1380 Z1$=Z1$+ZZZ$
1390 GOTO 1310
1400 REM "PROCESS BATCH  FILES
1405 Z1$=Z1$+"ARR",ZZ1$=ZZ1$+"    "
1410 X3$(174,4)="    "
1415 FOR XX2=1 TO LEN(Z1$)/3
1425 ZZ$="02C  02O "+Z1$(XX2*3-2,3)+"...  "
1428 REM IF ZZ$(5,3)="ARR" THEN LET ZZ$(8,3)=X3$(9,3); CALL "*FID"; PRINT "ZZ$=>",ZZ$,"<",; INPUT *; ESCAPE
1435 XX$=X3$
1437 IF ZZ$(5,3)="ARR" THEN XX$(174,4)="" ELSE XX$(174,4)=ZZ1$(XX2*4-3,4)
1440 REM IF ZZ$(5,3)="ARR" THEN ESCAPE
1445 REM PRINT @(20,18),ZZ$,
1450 CALL "ZZFLES",XX$,Y1$,Y0$,ZZ$,Z{ALL},Z0,Z1; ON Z0 GOTO 1451,9900
1460 GOSUB 2000
1480 NEXT XX2
1490 GOTO 9900
2000 REM 
2010 READ (Z[2],KEY="",DOM=2011)
2020 Z9$=KEY(Z[2],END=2090)
2030 REM PRINT ZZ$,"   ",X3$(174,4),"   ",Z9$,'CL',; INPUT *
2050 IF ZZ$(5,3)<>"PO7" AND NUM(YR$)>=NUM(Z9$(1,6)) THEN FLAG$="*"; GOSUB 4000; REM DISPLAY MESSAGE
2060 IF ZZ$(5,3)="PO7" AND NUM(YR$)>=NUM(Z9$(45,6)) THEN FLAG$="*"; GOSUB 4000; REM DISPLAY MESSAGE
2090 RETURN 
3000 REM "FIND FILE NAME TO USE BASED ON BATCH #
3005 ZZZ$=""
3010 IF KK$(6,6)="IC2TDA" THEN ZZZ$="ICA"
3012 IF KK$(6,6)="AP2DAA" THEN ZZZ$="APD"
3014 IF KK$(6,6)="AP2CMA" THEN ZZZ$="APR"
3016 IF KK$(6,6)="GL2JAA" THEN ZZZ$="GL7"
3018 IF KK$(6,6)="AR2EAA" THEN ZZZ$="ARB"
3020 IF KK$(6,6)="PO2MAG" THEN ZZZ$="PO7"
3022 IF KK$(6,6)="AR2CAA" THEN ZZZ$="ARP"
3024 IF KK$(6,6)="AP2CAA" THEN ZZZ$="APH"
3030 IF ZZZ$="" THEN ESCAPE 
3090 RETURN 
4000 REM "DISPLAY MESSAGE
4020 GOSUB 4100
4060 IF FLAG$="*" THEN CALL "ZZPROM","4",X3$,0,"          Closed Period, 'NO' entries prior to FY "+GL$(34,4)+" Period "+GL$(38,2)+" Allowed. ","","",0
4090 RETURN 
4100 REM "PRINT PROGRAM THAT HAS ENTRIES
4105 NAME$=""
4110 IF ZZ$(10,3)="ICA" THEN NAME$="Inv Trans Entry (I/C-T1) "
4112 IF ZZ$(10,3)="APD" THEN NAME$="A/P Inv Entry (A/P-I1) "
4114 IF ZZ$(10,3)="APR" THEN NAME$="Man Check entry (A/P-M1) "
4116 IF ZZ$(10,3)="GL7" THEN NAME$="G/L Journal Entry (G/L-J1) "
4118 IF ZZ$(10,3)="ARB" THEN NAME$="A/R Inv Entry (A/R-I1) "
4120 IF ZZ$(10,3)="PO7" THEN NAME$="P/O Receipt Entry (P/O-P3) "
4122 IF ZZ$(10,3)="ARP" THEN NAME$="Cash Receipt Entry (A/R-C1) "
4124 IF ZZ$(10,3)="APC" THEN NAME$="A/P Spec Inv Select (A/P-C2) "
4126 IF ZZ$(10,3)="ARR" THEN NAME$="Finance Charge Posting (ARP-F2) "
4180 NAME$=NAME$+"has records for current period in it "
4185 IF XX$(174,4)<>"    " THEN NAME$=NAME$+"(Batch "+XX$(174,4)+")"
4190 PRINT @(0,21),NAME$,'CL',
4195 RETURN 
9900 REM "END PROGRAM
9901 ESCAPE 
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 EXIT 
9950 RUN "ZMENU"
9999 END 
