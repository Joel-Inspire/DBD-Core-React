0035 REM "4.4 - 07/06/00 - 16.52 - kmc - SSP# 120358
0040 REM "Copyright 2000 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 BEGIN 
0102 PRINT 'CS',@(0,3),"Build GL Renumber file GLN from GLLIST"
0105 OPEN (13)"ZZPARM"
0106 FIND (13,KEY=FID(0)+DIM(6))X3$,*,X4$
0110 OPEN (1)"GLN"+X3$(9,3)
0130 OPEN (3)"GL1"+X3$(9,3)
0190 CALL "ZZINIT","01"
0200 REM "Get fields to process
0205 INPUT "File name of import file: ",FILE_NAME$; IF CTL=4 THEN GOTO 9900
0210 INPUT "Column for old number: ",OLD$; IF CTL=4 THEN GOTO 9900 ELSE OLD_COL=NUM(OLD$,ERR=0210)
0220 INPUT "Column for new number: ",NEW$; IF CTL=4 THEN GOTO 9900 ELSE NEW_COL=NUM(NEW$,ERR=0220)
0300 OPEN LOCK (2,ERR=0301,OPT="TEXT")FILE_NAME$; GOTO 0302
0301 INPUT "Error in open of file = ",ERR," "; GOTO 0200
0390 MISSING=0,COUNT=0
0400 REM "Read each record and put into IN$
0405 READ (2,END=0500)REC$
0407 DIM IN$[20]; INDEX=1
0410 P=POS(","=REC$); IF P=0 THEN IN$[INDEX]=REC$; GOTO 0411 ELSE IF P=1 THEN TMP$="",REC$=REC$(2) ELSE IF P=LEN(REC$) THEN TMP$=REC$,REC$="" ELSE TMP$=REC$(1,P-1),REC$=REC$(P+1) END_IF ; IN$[INDEX]=TMP$,INDEX=INDEX+1; GOTO 0410
0420 OLD_NUM$=IN$[OLD_COL],NEW_NUM$=IN$[NEW_COL]
0425 IF LEN(OLD_NUM$)<12 THEN OLD_NUM$=OLD_NUM$+DIM(12,"0"),OLD_NUM$=OLD_NUM$(1,12)
0427 IF LEN(NEW_NUM$)<12 THEN NEW_NUM$=NEW_NUM$+DIM(12,"0"),NEW_NUM$=NEW_NUM$(1,12)
0428 IF FN%NMV(OLD_NUM$)=0 THEN GOTO 0405 ELSE COUNT=COUNT+1; IF MOD(COUNT,50)=1 THEN PRINT COUNT," ",OLD_NUM$," ",NEW_NUM$
0430 FIND (3,KEY=OLD_NUM$,DOM=0431)GL1$; GOTO 0432
0431 MISSING=MISSING+1; DIM GL1$(100); GL1$(13,35)="***Missing***"
0450 DIM GLN$(59); GLN$(1,12)=OLD_NUM$,GLN$(13,35)=GL1$(13,35),GLN$(48,12)=NEW_NUM$
0460 WRITE (1,KEY=GLN$(1,12))GLN$; GOTO 0462
0495 GOTO 0405
0500 REM "End
0505 PRINT "Total records imported = ",COUNT,'LF',"Missing old G/L numbers = ",MISSING,'LF',"Duplicate old G/L numbers = ",DUPLICATE,; INPUT *
0510 GOTO 9900
9900 REM "END
9905 RUN "ZMENU"
9999 END 
