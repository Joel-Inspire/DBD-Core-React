0010 REM "Print Std G/L lines data <GL2XRA>
0035 REM "5.3 - 11/15/04 - 13.218333 - kmc - SSP# 174140
0040 REM "Copyright 2004 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0140 Z0$="###,###,###.00DR",Z1$="#,###.00"
0165 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
0320 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9]
0340 IOLIST D$
1000 REM "
1020 SETERR 1021; ENTER X3$,X4$,W3,W9,W,W0,X3,F8,F9,V{ALL},T4,P9,C9,T1$,T2$,Y5$,O0,R0,R1,R2,R6$
1022 REM "ENTER X3$,X4$,W3,W9,W,W0,X3,F8,F9,V[ALL],T4,P9,C9,T1$,T2$,Y5$,O0,R0,R1,R2
1030 SETERR 9000
1035 DIM B[9]
1040 IF C9<2 THEN GOTO 1100
1050 IF C9=5 THEN GOTO 2703
2000 REM "Print Lines or Detail"
2020 IF X3<1 THEN GOTO 2700
2025 IF W>W0 THEN C9=2; GOSUB 6000
2026 X4=X3
2030 READ (F8,IND=X3)X3,IOL=0320
2035 IF R1=0 THEN GOTO 2090
2040 FOR X=0 TO 3; Q=B[X]-B[X+4]; IF R1=1 THEN Q=B[X+4]
2045 Q=Q*R0
2050 B[X]=Q; NEXT X; IF X3<=0 THEN B[3]=R2
2055 R2=R2-B[3]
2090 DIM D$(60); FIND (F9,ERR=2092,KEY=B$(O0+7,12))IOL=0340
2095 IF B[3]=0 THEN GOTO 2020
2135 IF T4=0 OR C9>=2 THEN GOSUB 2500
2136 IF C9=3 THEN GOTO 2205
2140 T4=T4+1
2200 REM "Print Each Line
2205 IF W>W0 THEN X3=X4,C9=3; GOSUB 6000
2265 IF D$(49,2)<>"JC" THEN GOTO 2350
2280 CALL "ZZDISP","AX",B$(O0+19,9),"J/C",X3$,X$,"",0,0,X4$; Y5$(P9+5)=X$
2300 CALL "ZZDISP","AX",B$(O0+28,9),"JCC",X3$,X$,"",0,0,X4$; Y5$(P9+20)=X$
2310 Y5$(P9+34)=B$(O0+37,1),Y5$(P9+37)=STR(B[0]:Z1$),Y5$(P9+50)=STR(B[2]:Z1$),Y5$(P9+60)=STR(B[1]:Z1$)
2350 Y5$(P9+70+J0)=STR(T4:"###")
2355 CALL "ZZDISP","AX",B$(O0+7,12),"G/L",X3$,X$,"",0,0,X4$; Y5$(P9+75+J0)=X$,G0=LEN(X$)+1
2360 Y5$(P9+75+G0)=D$(13,35)
2365 Y5$(P9+114)=STR(B[3]:Z0$)
2380 GOSUB 7300
2400 REM "Accumulate Line Totals"
2410 V[1]=V[1]+B[3]
2499 GOTO 2020
2500 REM "Line Header
2510 C9=-1
2520 IF W+2>W0 THEN X3=X4,C9=4; GOSUB 6000 ELSE GOSUB 7300
2530 Y5$(P9+70)="Ln#",Y5$(P9+75)="G/L Account",Y5$(P9+117)="Distribution"
2535 IF D$(49,2)="JC" THEN Y5$(P9+5)="Job Number",Y5$(P9+20)="Cost Code",Y5$(P9+33)="Type",Y5$(P9+40)="Units",Y5$(P9+53)="Hours",Y5$(P9+64)="Rate"
2540 Y5$(P9+70+J0)="Ln#",Y5$(P9+75+J0)="G/L Account",Y5$(P9+117)="Distribution"; GOSUB 7300
2690 RETURN 
2700 REM "Line Totals"
2701 IF T4=1 THEN GOTO 2785
2702 IF W+2>W0 THEN X3=0,C9=5; GOSUB 6000
2705 Y5$(P9+114)=T1$(1,LEN(Z0$)); GOSUB 7300
2720 Y5$(P9+114)=STR(V[1]:Z0$); GOSUB 7300
2785 GOSUB 7300
2795 GOTO 5000
5000 REM "END OF LINES
5010 C9=0
5090 EXIT 
6000 REM "PAGE UP
6090 EXIT 
7300 REM "Output line Y5$ to output device
7310 W=W+1
7320 IF (X3$(146,6)="AR2DBS" OR X3$(146,6)="AP2DBS") AND R6$(1,1)="Y" THEN CALL "ZR2DNL",ERR=7321,X3$,X4$,Y5$,R6$; REM "Send line to repository
7325 IF %IL_PDF THEN PRINT (%IL_PDF,ERR=*NEXT)Y5$ ! 174140
7330 IF Y5$=Y6$ THEN PRINT (W9)'LF', ELSE PRINT (W9)Y5$; DIM Y5$(W3)
7395 RETURN 
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9999 END 
