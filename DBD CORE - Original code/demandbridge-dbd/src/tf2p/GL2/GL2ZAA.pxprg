0010 REM "Accounting Period Calculation <GL2ZAA>
0030 REM "(C) 1985 BY Computer Software Inc, Atlanta, Ga.
0035 REM "    THIS SOFTWARE CONTAINS TRADE SECRETS AND PROPRIETARY INFORMATION"
0100 SETESC 9300
0160 DEF FNP$(Z9$)="("+Z9$(1,3)+") "+Z9$(4,3)+"-"+Z9$(7,4)
0165 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
0170 DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
0320 DEF FNX$(Z0$)=Z0$(1,POS(S$=Z0$+S$)-1)
0325 DEF FNS(Z0$)=LEN(FNX$(Z0$))
0330 DEF FNE$(Z0$)=CHR(NUM(Z0$(1,3))-190+65)+Z0$(4,1)
0990 PRECISION 14
0999 REM "X0$=DATE, X3$=CONTROL RECORD, G0$=FISCAL YEAR, G1$=PERIOD, G2$=CURRENT FISCAL YEAR, G3$=CURRENT PERIOD, G9=0 IF ERROR
1000 SETERR 1020; ENTER X0$,X3$,G0$,G1$,G2$,G3$,G9
1020 SETERR 9000
1100 G9=0
1120 FIND (Z[6],KEY=X3$(9,3)+"G/L",DOM=4000)A$
1140 G2$=A$(23,4),G3$=A$(27,2)
1200 FIND (X[6],KEY=X3$(9,3)+"G/LYE"+G2$,DOM=4100)A1$
9000 REM "ERROR PROCESSING
9010 E0=ERR,E1=TCB(5)
9020 IF E0=66 THEN EXIT E0
9040 CALL "ZZERRM",E0$,"ZZENTR",E1$,X3$,E0,E1,E2,E3,0
9050 ON E2 GOTO 9060,9100,9900,9070
9080 RETRY 
9100 REM " TRANSFER CONTROL
9190 EXIT ERR
9350 RETURN 
9900 REM "END PROGRAM
9920 BEGIN 
9940 RUN "ZMENU"
9999 END 
