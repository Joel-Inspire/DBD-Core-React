0010 ! IMGLIB object
0030 ! 
0035 REM "5.5 - 09/24/07 - 10.571388 - jme - SSP# 203099
0037 REM "203099-Enhancements to Output Director.  Provide ability for
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 DEF CLASS "IMGLIB" CREATE REQUIRED DELETE REQUIRED 
0110 LIKE "FILE"
0200 ! start variable list
0210 LOCAL IL0
1000 FUNCTION GET_DIR(*)
1020 FILENO=DTI
1030 X=_OBJ'READBYKEY(0,TYPE$)
1040 X=_OBJ'READNEXT(); IF X THEN IF OUTPUT_TYPE$<>TYPE$ THEN X=0
1050 IF X THEN {
1052 DIM DTI[4]
1053 IOLIST DTI$
1060 READ DATA FROM REC(IOL(FILENO)) TO IOL=1053
1070 CURRENT_QUEUE$=DTI$(1,30)
1075 IL_DT1$="",IL_DT2$=DTI$(39,10)+DTI$(96,9)
1080  }
1090 RETURN X
8999 END DEF
9999 END 
10000 ON_CREATE:
10005 OPEN_STATUS=0
10007 FILENAME$="IL0"
10010 COMPANY$=%C$ ! OOP_SYS=NEW("SYSTEM"); COMPANY$=OOP_SYS'GET_COMPANY$; DROP OBJECT OOP_SYSS
10051 OPEN (HFN,IOL=*,ERR=*RETURN)FILENAME$+COMPANY$ ! open object command prevents file i/o to opened channel outside object
10060 IOL=LFO
10070 STATIC IOL=IOL(IL0)
10080 OPEN_STATUS=1
10090 RETURN 
10098 ! 
10099 ! 
10100 ON_DELETE:
10110 IF OPEN_STATUS THEN CLOSE (IL0)
10190 RETURN 
10198 ! 
10199 ! 
56000 REM "203099-Enhancements to Output Director.  Provide ability for
