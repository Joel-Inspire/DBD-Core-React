0100 BEGIN 
0150 OPEN (10)"ZZPARM"; READ (10,KEY=FID(0)+"      ")X3$
0160 READ (10,KEY=X3$(9,3)+"ZZP")X4$
0210 OPEN (1)"APJ"+X3$(9,3)
0300 ERASE "APTOUT",ERR=0301
0320 F$=FID(1); SERIAL "APTOUT",DEC(F$(20,1)),0
0330 OPEN LOCK (2,OPT="TEXT")"APTOUT"
0500 READ (1,IND=0)MAXREC
0900 PRINT @(0,22),'CE',"Processing: ",
1000 REM 'MAINLINE
1010 FOR INDEX=1 TO MAXREC
1020 READ (1,IND=INDEX)IOL=9010
1040 IF MOD(INDEX,20)=0 THEN PRINT @(0,22),'CL',INDEX,
1050 IF B$(1,10)<>"0000005150" THEN GOTO 1500
1100 DATEIN$=B$(49,6); GOSUB 7500
1200 DIM DATA$(48)
1210 DATA$(1,20)=B$(1,20)
1220 DATA$(21,10)=DATEOUT$
1230 DATA$(31,18)=STR(C:"##############.00-")
1300 WRITE (2)DATA$
1500 NEXT INDEX
2000 INPUT (0,LEN=1)@(0,22),'CL','RB',"Process complete <RETURN> ",*; GOTO 9500
7500 REM '
7520 CALL "ZZDISP","DX",DATEIN$,"",X3$,DATEOUT$,"",0,0,X4$
7530 DATEOUT$=DATEOUT$(7,4)+DATEOUT$(1,2)+DATEOUT$(4,2)
7590 RETURN 
9010 IOLIST A,B$,C
9500 RUN "ZMENU"
