0010 REM "Convert IEEE String (HEX) to Number <ZZIEEE>
1050 ENTER X0,N0$,N
1060 IF X0=0 THEN N=0 ELSE N$=""
1065 FLOATING POINT 
1090 IF X0=1 THEN GOTO 2000
1120 X0=0; DIM I0$(8,$00$); FOR X=8 TO 1 STEP -1
1130 I0$(X,1)=CHR(2^X0); X0=X0+1
1140 NEXT X
1180 R$=ATH(N0$),N$=""
1205 IF R$="" THEN GOTO 1240 ELSE Q$=R$(1,1),R$=R$(2)
1210 FOR X=1 TO 8; IF AND(Q$,I0$(X,1))<>$00$ THEN N$=N$+"1" ELSE N$=N$+"0"
1220 NEXT X
1230 GOTO 1200
1300 REM "GET EXPONENT
1305 IF N$(1,1)="1" THEN S0=-1 ELSE S0=1
1310 E0=0; Q$=N$(2,11); FOR X=LEN(Q$) TO 1 STEP -1
1320 IF Q$(X,1)="1" THEN E0=E0+2^(11-X)
1340 NEXT X; E0=E0-1023; E0=2^E0
1400 REM 
1410 N=0,X0=0
1420 FOR X=13 TO 64; X0=X-12
1430 IF N$(X,1)="1" THEN N=N+2^(-X0)
1460 NEXT X
1500 N=E0*(1+N)*S0
1590 GOTO 9900
2000 REM "CONVERT NUMBER TO IEEE FORMAT
2010 GOSUB 8600
2100 REM "GET SIGN
2110 IF N<0 THEN N$="1" ELSE N$="0"
8605 DIM A[52],E[15]
8610 A[1]=2,A[2]=4,A[3]=8,A[4]=16,A[5]=32,A[6]=64,A[7]=128,A[8]=256,A[9]=512,A[10]=1024,A[11]=2048,A[12]=4096,A[13]=8192,A[14]=16384,A[15]=32768,A[16]=65536,A[17]=131072,A[18]=262144,A[19]=524288,A[20]=1048576,A[21]=2097152,A[22]=4194304,A[23]=8388608,A[24]=16777216,A[25]=33554432,A[26]=67108864,A[27]=134217728,A[28]=268435456,A[29]=536870912,A[30]=1073741824
8615 A[31]=.2147483648E+138,A[32]=.4294967296E+138,A[33]=.8589934592E+138,A[34]=.17179869184E+139,A[35]=.34359738368E+139,A[36]=.68719476736E+139,A[37]=.137438953472E+140,A[38]=.274877906944E+140,A[39]=.549755813888E+140,A[40]=.1099511627776E+141,A[41]=.2199023255552E+141,A[42]=.4398046511104E+141,A[43]=.8796093022208E+141,A[44]=.17592186044416E+142,A[45]=.35184372088832E+142,A[46]=.70368744177664E+142
8660 E[1]=3,E[2]=6,E[3]=9,E[4]=13,E[5]=16,E[6]=19,E[7]=23,E[8]=26,E[9]=29,E[10]=33,E[11]=36,E[12]=39,E[13]=43
8695 RETURN 
9940 EXIT 
9999 END 
