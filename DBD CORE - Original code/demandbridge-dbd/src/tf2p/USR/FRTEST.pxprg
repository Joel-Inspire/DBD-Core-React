0010 REM "READ THRU FS6 FIND MATCH IN AR6 TO REBUILD FREIGHT IN FMZ
0110 DIM A[7],B[14],C[14]
0220 OPEN (2)"FS6434"
0230 OPEN (3)"AR6434"
0240 OPEN (4)"FMZ434"
0320 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7]
0330 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14]
0340 IOLIST C$,C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14]
2000 REM "READ THRU FS6 AND TRY TO MATCH UP IN FMY
2005 ESCAPE 
2010 READ (2,KEY="0009701000",DOM=2011)
2020 K$=KEY(2,END=5000)
2025 IF K$(1,10)<>"0009701000" THEN ESCAPE 
2030 READ (2,KEY=K$)IOL=0320
2035 ESCAPE 
2040 IF A$(11,1)<>"D" THEN GOTO 2020
3000 REM "READ FROM AR6 TO FIND FREIGHT WITH PART OF IOL=320
3010 READ (3,KEY=A$(1,10)+A$(40,8),DOM=2020)IOL=0330
3030 REM "IF B$(19,1)<>"D" THEN GOTO 02020
3031 ESCAPE 
3040 IF NUM(B$(11,8))<500000 THEN GOTO 2020
3500 REM "READ FMZ FILE AND TRY TO ADD FREIGHT FROM AR6 TO FMZ
3505 ESCAPE 
3510 READ (4,KEY=A$(1,10),DOM=3511)
3520 J$=KEY(4,END=2020)
3530 READ (4,KEY=J$)IOL=0340
3540 IF A$(1,10)<>J$(1,10) THEN GOTO 2020
3550 IF C$(35,1)<>"I" THEN GOTO 3520
3560 IF C$(185,7)<>B$(11,7) THEN GOTO 3520
3565 IF C$(16,10)<>A$(12,10) THEN GOTO 3520
3566 ESCAPE 
3570 C[7]=B[8]
3680 ESCAPE ; WRITE (4,KEY=J$)IOL=0340
3690 GOTO 2020
5000 REM "EOJ
5010 ESCAPE 
