0010 REM "Select database items - ZZBKEY
0030 REM "(C) 1985-1988 Basic Ideas, Inc; Atlanta, GA. USA
0035 REM "This software contains trade secrets and proprietary information"
0075 REM "S0=STARTING POSITION OF TEXT DISPLAY, S1=LINE, S2=NUMBER OF LINES ALLOWED, S3=WIDTH OF FIELD, F0=FILE SLOT NUMBER, K9$=HIGH ORDER KEY PART,K0=MAX LENGTH OF ENTERED KEY
0099 REM LET X0$="E",V1$="",S0=3,S1=11,S2=11,K0=20,F0=Z(4),K9$="CUSTOMER.MASTER     ",K$="",T0=12,T1=7,K2$=""; GOTO 00101
0100 ENTER X3$,X0$,V1$,A$,S0,S1,S2,K0,F0,K9$,K$,K4$,T0,T1,C0
0200 REM "
0220 DIM S$(60),Z9$(6,$00$); D2$=ATH(X3$(340)); D0=NUM(X3$(60,3))
0625 K9=LEN(K9$)
0655 G0$="B",S3=K0+4; IF V1$>"" THEN G0$="!A"+G0$
0670 FOR X=S1+1 TO S1+S2-2
0675 PRINT @(S0+1,X),S$(1,K0+2),
0677 NEXT X
0680 A0$=$1B$+"B"+X3$(79,1),A1$=$1B$+"E"+X3$(79,1)
0970 IF K$>"" THEN K$=FNS$(K$); K0$=K$; GOSUB 5900
0980 D9=POS("D"=X0$); GOSUB 6000; D9=0
0990 CLOSE (D0); OPEN (D0)FID(0)
1020 REM 
1025 REM K9$=HIGH ORDER KEY PART
1100 REM "POSITION
1120 IF X0$="D" THEN GOTO 9900
1990 T0$=$C5CD$; IF X3$(238,1)="1" THEN T0$=$0B0A$
1995 PRINT 'SF',
2000 REM "ENTRY
2020 CLOSE (14); OPEN (14)FID(0); PRINT @(T0,T1),S$(1,K0),@(T0,T1),K0$,; READ RECORD (14,SIZ=1)Q$; GOSUB 8200; IF C0<0 THEN GOTO 2100
2040 REM IF Q$="*" OR Q$="_" OR Q$="." OR (Q$>="A" AND Q$<="Z" OR (Q$>="0" AND Q$<="9")) THEN GOTO 02100
2060 IF C0=2 OR C0=3 THEN IF K0$="" THEN GOTO 7600 ELSE PRINT 'BS'," ",$08$,; K0$=K0$(1,LEN(K0$)-1); GOSUB 5900; GOTO 2020
2065 IF C0=1 THEN K$=K5$; GOTO 7500
2070 IF C0=8 THEN GOSUB 6400; GOTO 2000
2075 IF C0=9 THEN GOSUB 6300; GOTO 2000
2080 IF C0=4 THEN IF K0$="" THEN GOTO 9900 ELSE K$=K5$; GOTO 7500
2090 GOTO 2000
2105 IF Q$>="a" AND Q$<="z" THEN Q$=CHR(ASC(Q$)-(ASC("a")-ASC("A")))
2108 IF Q$<CHR(32) THEN GOTO 2020
2110 IF LEN(K0$)=K0 THEN PRINT 'RB',; GOTO 2020
2120 K0$=K0$+Q$
2125 PRINT Q$,
2130 GOSUB 5900
2140 GOTO 2020
5900 REM "LOOK FOR START KEY
5902 K2$=K0$; IF K1$="" THEN GOTO 6000
5905 READ (F0,KEY=K9$+K0$,DOM=5906)
5910 Q$=K1$(LEN(K1$)-K0+1,K0)
5935 REM "PAST THE LAST ONE
5940 IF K0$>Q$(1,LEN(K0$)) THEN GOTO 5990
5945 IF K0$<K1$(1,LEN(K0$)) THEN GOTO 5990
5950 IF K0$>K1$(1,LEN(K0$)) THEN GOTO 5980
5960 E$=K9$+K1$(1,K0); CALL "ZZKEYP",ERR=5965,0+F0,E$
5965 IF E$>"" THEN IF E$(1,K9)=K9$ THEN IF E$(K9+1,LEN(K0$))>=K0$ THEN GOTO 5990
5980 GOSUB 6200; RETURN 
6000 REM "DISPLAY SCREEN STARTING WITH K0$
6005 IF K1$>"" THEN K3$=K1$(1,K0)
6010 E9=0,E8=0,K5$=""; READ (F0,KEY=K9$+K2$,DOM=6011); E8=1,K$=K9$+K2$
6020 FOR X=0 TO S2-3
6030 IF E8=0 THEN K$=KEY(F0,END=6110) ELSE E8=0
6035 READ (F0,END=6110); IF K$(1,K9)<>K9$ THEN GOTO 6110
6040 Q$=K$(K9+1,K0)
6045 IF X=0 THEN IF Q$=K3$ THEN EXITTO 6150 ELSE K1$="",K6$=""
6048 K1$=K1$+Q$,K6$=K6$+K$,K6=LEN(K$)
6050 IF D9=0 THEN PRINT @(2+S0,1+X+S1),Q$+S$(1,LEN(Q$)-K0),
6090 GOTO 6140
6110 E9=1
6120 Q$=S$(1,K0); GOTO 6050
6140 NEXT X
6180 IF K0$>"" THEN GOSUB 6200
6190 RETURN 
6200 REM "HIGHLIGHT CLOSEST
6205 IF K0$="" THEN ON LEN(K5$) GOTO 6290,6215
6208 IF POS(K0$=K1$,K0)=0 THEN IF K0$>"" THEN K0$=K0$(1,LEN(K0$)-1); PRINT 'RB',; GOTO 6290
6210 Q=POS(K0$<=K1$,K0); IF Q=0 OR Q=(K5-1)*K0+1 THEN GOTO 6250
6215 IF K5$>"" THEN X0=S0+2,X1=S1+K5; IF X3$(238,1)="1" THEN PRINT @(X0-1,X1)," ",@(X0+K0,1)," ", ELSE PRINT @(X0,X1),A1$,K5$,
6230 IF K0$="" THEN GOTO 6290 ELSE K5=INT(Q/K0)+1,K5$=K1$((K5-1)*K0+1,K0),X1=S1+K5,X0=S0+2
6240 IF X3$(238,1)="1" THEN PRINT @(X0+K0,X1),A1$,@(X0-1,X1),A0$, ELSE PRINT @(X0,X1),A0$,K5$,A1$,
6290 IF K0$="" THEN K5$="",K5=0
6295 RETURN 
6300 REM "NEXT ENTRY DOWN ON SCREEN
6330 IF K5<LEN(K1$)/K0 THEN K0$=K1$(K5*K0+1,K0); GOSUB 6200; GOTO 6390
6335 IF E9=1 THEN GOTO 6495 ELSE IF E9=0 THEN READ (F0,KEY=K9$+K1$(LEN(K1$)-K0+1),DOM=6336)
6340 K$=KEY(F0,END=6360); IF K$(1,K9)<>K9$ THEN E9=1 ELSE K2$=K$(K9+1,K0),K0$=K2$; GOSUB 6000; GOSUB 6200
6390 GOTO 6490
6400 REM "PRIOR ENTRY 
6410 IF K5>1 THEN K0$=K1$((K5-2)*K0+1,K0); GOSUB 6200; GOTO 6490
6420 E$=K9$+FNS$(K1$(1,LEN(K1$)))
6425 CALL "ZZKEYP",ERR=6490,F0+0,E$
6430 K0$=E$(K9+1,K0),K2$=K0$,K5$=""; GOSUB 6000
6440 GOSUB 6200
6490 K0$=FNS$(K0$)
6495 RETURN 
7000 REM "RE-DISPLAY SCREEN TEXT
7010 IF V1$="" THEN GOTO 7090
7020 CALL "ZZVRDY",X3$,V1$,S0,S1,S2+3,S3
7090 RETURN 
7500 REM "SELECTED ITEM
7505 K$=K0$; K=POS(K$=K1$,K0); IF K>0 THEN K=INT(K/K0),K$=K6$(K*K6+1,K6)
7510 IF K$="" THEN GOTO 9900 ELSE READ (F0,KEY=K$)F0$
7515 IF F0$(81,1)<>"*" THEN GOTO 9900 ELSE Q=POS("*"=F0$(21,20)); IF Q>0 THEN F0$(Q+20,1)=""
7520 IF F0$(81,1)="*" THEN K4$=K4$+F0$(21,20); K9$=F0$(21,20)
7530 PRINT @(T0,T1-1),F0$(21,20),
7535 K$="",K6$="",K1$="",K2$="",K0$=""
7540 GOTO 0670
7600 REM "GO BACK 1 LEVEL
7610 IF K4$="" THEN K9$=A$(30,20); GOTO 7645
7615 K9$=K4$(LEN(K4$)-19,20),K4$=K4$(1,LEN(K4$)-20)
7645 PRINT @(T0,T1-1),K9$,; GOTO 7535
8000 REM "Get all entries...
8220 Q9$=Q$,C0=-1,P=POS(Q9$=D2$,6); IF P=0 THEN RETURN ELSE GOTO 8235
8230 IF M0=0 THEN READ RECORD (14,SIZ=1,TIM=0,ERR=8235)Q$ ELSE CALL "ZZDEMO",X1$,1,D0,Q$,M0
8232 Q9$=Q9$+Q$; IF LEN(Q9$)>6 THEN GOTO 8235 ELSE P=POS(Q9$+Z9$(1,6-LEN(Q9$))=D2$,6); IF P=0 THEN GOTO 8230
8235 IF LEN(Q9$)>6 THEN PRINT 'RB',; RETURN ELSE P=POS(Q9$+Z9$(1,6-LEN(Q9$))=D2$,6); IF P=0 THEN GOTO 8230 ELSE C0=INT(P/6)+1,X3=C0; RETURN 
8915 DEF FNS$(X$)=X$(1,POS(S$=X$+S$)-1)
9920 IF V1$>"" THEN GOSUB 7000
9940 EXIT 
9999 END 
