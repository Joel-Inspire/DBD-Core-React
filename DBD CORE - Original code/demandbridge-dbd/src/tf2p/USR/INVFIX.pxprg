0010 REM "Change customer code to another
0110 DIM A$(100)
0210 OPEN (1)"IC0500"
0220 OPEN (2)"IC1500"
0230 OPEN (3)"ICF500"
0240 OPEN (4)"FS6500"
0290 PRINT 'CS'
0800 C0=4
0900 GOSUB 6000
1000 REM "READ FROM IC0 FIRST
1010 CALL "ZZENTR","AXUX",A{ALL},A$,X4$,X3$,16,3,1,10,C0,"A/R","{1"+X$,"","FM2LAA00","AR1","",""; IF ABS(C0)>=4 THEN GOTO 5000
1020 PRINT @(16,3),A$(1,10)
1500 REM "New customer code
1510 CALL "ZZENTR","AXUX",A{ALL},A$,X4$,X3$,16,10,31,10,C0,"A/R","{2"+X$,Q$,"FM2LAA06","AR1","",""; IF ABS(C0)>=4 THEN GOTO 1350
1520 PRINT @(16,10),A$(31,10)
2000 REM "read from files
2010 READ (1,KEY=A$(1,10),DOM=2011)
2020 READ RECORD (1,END=2200)B$
2030 IF B$(1,10)<>A$(1,10) THEN GOTO 2200
2050 JL$=B$(1,20),B$(1,10)=A$(31,10)
2080 WRITE RECORD (1,KEY=B$(1,20))B$
2090 REMOVE (1,KEY=JL$)
2095 GOTO 2020
2200 REM "READ IC1 FILE
2210 READ (2,KEY=A$(1,20),DOM=2211)
2220 READ RECORD (2,END=2500)C$
2230 IF C$(1,10)<>A$(1,10) THEN GOTO 2500
2250 JL$=C$(1,24),C$(1,10)=A$(31,10)
2280 WRITE RECORD (2,KEY=C$(1,24))C$
2290 REMOVE (2,KEY=JL$)
2295 GOTO 2220
2500 REM "ICF FILE
2510 READ (3,KEY=A$(1,10),DOM=2511)
2520 READ RECORD (3,END=2700)D$
2530 IF D$(1,10)<>A$(1,10) THEN GOTO 2700
2550 JL$=D$(1,32),D$(1,10)=A$(31,10)
2580 WRITE RECORD (3,KEY=D$(1,32))D$
2590 REMOVE (3,KEY=JL$)
2595 GOTO 2520
2700 REM "READ FS6 FILE
2710 READ (4,KEY=A$(1,10),DOM=2711)
2720 READ RECORD (4,END=2900)E$
2730 IF E$(1,10)<>A$(1,10) THEN GOTO 2900
2750 JL$=E$(1,30),E$(1,10)=A$(31,10)
2780 WRITE RECORD (4,KEY=E$(1,30))E$
2790 REMOVE (4,KEY=JL$)
2795 GOTO 2720
5000 REM "EOJ
5010 RUN "ZMENU"
6000 REM "BACKGROUND
6010 PRINT @(0,1),"FROM:",@(1,3),"Customer code:",@(0,8),"TO:",@(1,10),"New Cust code:",
6090 RETURN 
