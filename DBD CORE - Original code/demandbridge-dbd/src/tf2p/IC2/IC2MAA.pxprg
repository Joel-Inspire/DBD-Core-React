0010 REM "Inventory Assistant <IC2MAA>
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 10/27/14 - 11.999444 - jvv - SSP# 273055
0037 REM "273055-Expand IC2 for 6 additional cost breaks, allow entry in GUI 
0040 REM "Copyright 2014 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$; X9=1
0100 SETERR 9000
0110 X0$="IC2MAA",X1$="Inventory Assistant",K9$="",K9=0
0130 K0=20,K1=1
0135 C9=-1
0160 DEF FNP$(Z9$)="("+Z9$(1,3)+") "+Z9$(4,3)+"-"+Z9$(7,4)+" Ext: "+Z9$(11,4)
0165 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
0170 DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
0200 REM "
0230 IF Q1$<>"" THEN X2=-1; PRINT @(0,8),'CE',
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1),A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13],A[14],A[15],A[16],A[17],A[18],A[19],A[20],A[21],A[22],A[23],A[24],A[25],A[26],A[27],A[28],A[29],A[30],A[31],A[32],A[33],A[34],A[35],A[36],A[37],A[38],A[39],A[40]
0311 IOLIST A$(1),STR(A[0]),A[1],STR(A[2]),A[3],STR(A[4]),A[5],STR(A[6]),A[7],STR(A[8]),A[9],STR(A[10]),A[11],STR(A[12]),STR(A[13]),A[14],A[15],A[16],STR(A[17]),STR(A[18]),A[19],STR(A[20]),A[21],STR(A[22]),A[23],STR(A[24]),A[25],STR(A[26]),A[27],STR(A[28]),A[29],STR(A[30]),A[31],STR(A[32]),A[33],A[34],A[35],A[36],A[37],A[38],A[39],A[40]
0350 IOLIST E$,E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10],E[11],E[12],E[13],E[14],E[15],E[16],E[17],E[18],E[19],E[20],E[21],E[22],E[23],E[24],E[25],E[26],E[27],E[28],E[29],E[30]
0360 IOLIST F$,F[0],F[1],F[2],F[3],F[4],F[5],F[6],F[7],F[8],F[9],F[10],F[11],F[12],F[13],F[14],F[15],F[16],F[17],F[18],F[19],F[20]
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X IC0...  02O IC5...  03O IC4...  04O AR1...  05O IC2...  06O FM1...  07O ICD...  08O AP4...  09O FM0...  13O ZZPARM  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0585 RT$=""; CALL "RT2PRM",ERR=0586,X3$,X4$,RT$
0590 READ (Z[1],KEY=K9$,DOM=0591)
0600 REM "
0610 FIND (Z[13],KEY=X3$(9,3)+"I/C")P0$
0680 GOSUB 6000
1000 REM "
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1035 DIM A$(187+K9),A[40]
1045 A$(1)=A1$; IF A1$="" THEN A$(1)=K9$
1060 GOSUB 6450
1100 REM 
1110 C0=0,C9=0,Z9=0
1200 REM 
1201 IF Q1$<>"" THEN A$(1,20)=Q1$; GOTO 1500
1205 A0=2
1210 CALL "IC2ICE",X3$,X4$,A$,A[15],-A0,Z[1],Z[4],C0,X0,P0$(38,1); IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1210,1211
1215 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1210,6800,9800,6970
1220 IF A$(11,1)="?" THEN GOTO 4000
1500 REM "
1505 Z9=-1,A2$="",A3$="",A4$="",A5$=""
1510 A1$=A$(1,K9+20)
1520 READ (Z[1],KEY=A1$,DOM=1600)IOL=0310
1525 Z9=0
1530 A2$=A$(61,3)+A$(1,20),A3$=A$(82,14)+A2$
1590 GOTO 1700
1600 REM "
1610 IF X9=1 THEN CALL "ZZPROM",".4",X3$,0,"Set up not allowed using the assistant feature!","","",0; GOTO 1000
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630
1630 IF Q1$<>"" AND LEN(U1$)>3 AND (U1$(1,3)="AR3" OR U1$(1,3)="FM2") THEN GOTO 9700 ELSE GOTO 1000
1650 REM "Default customer specific"
1655 IF POS(" "<>A$(1,10))=0 THEN GOTO 1680
1656 DIM F[20]; FIND (Z[6],KEY=A$(1,20),DOM=1657)IOL=0360; GOSUB 8000; GOTO 1670
1660 A$(1,10)=""; FIND (Z[1],KEY=A$(1,20),DOM=1677)IOL=0310; A$(1,10)=A1$(1,10)
1665 A$(96,12)="",A[17]=0,A[18]=0
1670 WRITE (Z[1],KEY=A1$)IOL=0311
1671 WRITE (Z[2],KEY=A$(61,3)+A$(1,20))
1672 WRITE (Z[3],KEY=A$(82,14)+A$(61,3)+A$(1,20))
1674 IF RT$>"" THEN IF RT$(7,1)="H" THEN CUST$=A$(1,10); CALL "RT2WOC",ERR=1675,X3$,X4$,CUST$,"IC0...","U",A$(1,20)
1675 GOTO 1500
1677 A$(1,10)=A1$(1,10)
1680 GOTO 1900
1690 GOTO 2000
1700 REM "
1790 GOSUB 6000; GOSUB 6200
1800 REM "
1830 GOTO 2000
1850 REM "MODIFY
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE IF Z9=0 THEN Z9=1
1860 EXTRACT (Z[1],KEY=A1$,DOM=1870)IOL=0310
1865 C9=1
1870 GOSUB 6200
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
1900 REM " Do First Time Stuff"
1910 Q$="IC2MAB"; GOTO 3100
1920 READ (Z[1],KEY=A1$,ERR=1921)IOL=0310
2000 REM "
2010 P0=21,P=0; IF P0$(38,1)="Y" THEN P1=8 ELSE P1=8
2020 PRINT @(0,P1),'CE',
2030 Q$="Item Pricing/Constant Setup",P$="CIC2MAB"; GOSUB 3000
2032 Q$="Supplier Purchasing Setup",P$="CIC2MAD"; GOSUB 3000
2033 Q$="Supplier Cost Comparison",P$="CIC2MAG"; GOSUB 3000
2035 Q$="Inventory Availability Inquiry",P$="CIC2MAC"; GOSUB 3000
2040 Q$="Inventory across Locations Inquiry",P$="CIC2MAF"; GOSUB 3000
2055 Q$="Detail Transaction Inquiry",P$="CIC2MAT"; GOSUB 3000
2060 Q$="Statistical Data Inquiry",P$="CIC2MDA"; GOSUB 3000
2070 Q$="Open Sales Order Inquiry",P$="CIC2MAJ"; GOSUB 3000
2080 Q$="Open P.O. Inquiry",P$="CIC2MAI"; GOSUB 3000
2090 IF P0$(51,1)="Y" THEN Q$="Quantity Break Pricing Setup",P$="CIC2MHA"; GOSUB 3000
2092 Q$="Order History Display",P$="CIC2MAK"; GOSUB 3000
2095 Q$="Delete All Item Data",P$="PDELETE"; GOSUB 3000
2100 REM "
2120 CALL "ZZPROM","M0",X3$,Z,"","","",21
2122 DIM Q$(2)
2125 CALL "ZZENTR","ZX",A{ALL},Q$,X4$,X3$,61,21,1,2,C0,"",X$,"","AR2MAA10","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2125,2126
2127 Q0=NUM(Q$,ERR=2125); PRINT @(18,20),'CL',
2129 IF C0<0 AND LEN(U1$)>=6 AND U1$(1,6)="FM2IAZ" THEN GOTO 9700
2130 IF C0<0 THEN Q1$=""; GOTO 1000
2134 IF Q0<1 OR Q0>P THEN GOTO 2120
2165 Q$=P8$((Q0-1)*6+1,6)
2170 IF POS("z"=A$(1,10))>0 THEN IF Q$<>"IC2MDA" THEN Q$="NA"
2215 IF Q$(1,2)="NA" THEN CALL "ZZPROM","4",X3$,Q1,"Option "+STR(Q0)+" is unavailable","","",0; GOTO 2120
2245 IF Q$="DELETE" THEN GOTO 6500
2250 IF Q$="IC2MDA" THEN CALL "IC2MDA",X3$,X4$,"I/C",A1$,Y0$; CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,-1; PRINT @(0,3),'CE',; GOSUB 6000; GOSUB 6200; GOTO 2000
2265 IF P9$(Q0,1)="R" THEN GOTO 3100
2275 CALL Q$,ERR=2000,X3$,X4$,Q0$,A1$
2285 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,-1
2286 GOSUB 6000; GOSUB 6200
2290 GOTO 2000
3000 REM "print menu line
3020 P=P+1,P8$=P8$+P$(2),P9$=P9$+P$(1,1)
3040 PRINT @(P0,P1+P),P:"##.#",Q$
3090 RETURN 
3100 REM "SETUP RUN SEQUENCE
3105 P$=Q$
3110 U0$=X3$(1,6)+"PF"
3120 Q$=STR(LEN(A1$):"00")+A1$
3123 IF LEN(U1$)<5 THEN U1$="" ELSE IF U1$(1,6)=X0$ THEN U1$=""
3125 U1$=P$+Q$+X0$+Q$+U1$
3130 WRITE (Z[13],KEY=U0$)U0$,U1$
3180 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
3190 SETERR 3195; RUN P$
3195 SETERR 9000
3200 REM "COULDN'T RUN
3210 REMOVE (Z[13],KEY=U0$,DOM=3211)
3215 U1$=""
3290 GOTO 2000
3400 REM "STATISTICES
3420 CALL "ZZ2MDA",ERR=2280,X3$,X4$,"I/C",A1$,Y0$
3430 GOSUB 6400
3490 GOTO 2000
4000 REM "Supplier item number search
4020 DIM I2$(34); C7=4,I0=-1,C9=1
4040 GOSUB 4640
4060 X$="",C0=ABS(C0),I0=I0+1; IF C0=2 THEN IF I0>0 THEN I0=I0-2
4080 IF ABS(C0)=4 THEN GOTO 4760 ELSE IF INT(C0)=3 OR ABS(C0)>3 OR I0<0 THEN I0=999; GOTO 4100
4100 ON I0 GOTO 4240,4120,4320,4400
4120 REM "Plant
4140 IF POS(" "<>A$(94,10))<>0 THEN J1$="P"+A$(94,10) ELSE J1$="P"+I2$(1,10)
4160 CALL "ZZENTR","SUZX",A{ALL},I2$,X4$,X3$,26,21,11,4,C0,"","{3"+X$,J1$,"FM2ODB74","FM0P","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 4160,4161
4180 IF I2$(11,4)="    " OR I2$(11,4)="0000" THEN GOTO 4220
4200 FIND (Z[9],KEY=J1$+I2$(11,4),DOM=4160)
4220 GOTO 4060
4240 REM "Vendor
4260 CALL "ZZENTR","AU",A{ALL},I2$,X4$,X3$,8,21,1,10,C0,"A/P","{3"+X$,"","FM2ODB76","AP4","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 4260,4261
4280 IF ABS(C0)<>4 THEN FIND (Z[8],KEY=I2$(1,10),DOM=4260)
4300 GOTO 4060
4320 REM "Supplier item number
4340 J1$=I2$(1,14)
4360 CALL "ZZENTR","S",A{ALL},I2$,X4$,X3$,49,21,15,20,C0,"","{3"+X$,J1$,"FM2ODB78","/FM2OBI","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 4360,4361
4380 GOTO 4060
4400 REM "Lookup Item number"
4460 READ (Z[7],KEY=I2$,DOM=4461)
4480 I3$=KEY(Z[7],END=4540)
4500 IF I3$(1,LEN(I2$))<>I2$ THEN GOTO 4540
4520 A$(1,20)=I3$(35,20)
4580 IF A$(1,20)<>I3$(35,20) THEN GOTO 4320
4600 PRINT @(0,21),'CL',
4620 C7=3,C0=0
4630 GOTO 1221
4640 REM "
4660 PRINT @(0,21),'CL','SB',@(0,21),"Vendor:",@(20,21),"Plant:",@(32,21),"Supplier Number:",'SF',
4680 CALL "ZZDISP","A",I2$(1,10),"A/P",X3$,"","",8,21,X4$
4700 PRINT @(26,21),I2$(11,4),@(49,21),I2$(15,20),
4720 RETURN 
4760 DIM I2$(LEN(I2$))
4770 PRINT @(0,21),'CL',
4780 GOTO 1000
4800 GOSUB 4640; GOTO 4100
6000 REM "BACKGROUND
6060 CALL "IC2ICE",X3$,X4$,"",0,0,0,0,0,0,P0$(38,1)
6070 PRINT 
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6425 IF MID(A$,11,1)="?" THEN GOSUB 4640
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6460 CALL "IC2ICE",X3$,X4$,A$,A[15],1,Z[1],Z[4],C0,X0,P0$(38,1)
6470 IF P0$(47,1)="Y" THEN IF POS(" "<>A$(128,40))>0 THEN PRINT @(39,7),'CL',A$(128,40),
6490 RETURN 
6500 REM "DELETE
6510 IF A$(108,1)="I" THEN A8$="Reactivate" ELSE A8$="Delete"
6520 CALL "ZZPROM",".Y",X3$,Z,"|Verify you wish to "+A8$,"","",0
6521 IF Z=1 AND A$(108,1)<>"I" THEN GOTO 1790
6523 ON Z GOTO 6524,6530
6525 IF A$(108,1)="I" THEN A$(108,1)="A"; WRITE (Z[1],KEY=A1$)IOL=0311; IF RT$>"" THEN IF RT$(7,1)="H" THEN CUST$=A$(1,10); CALL "RT2WOC",ERR=1790,X3$,X4$,CUST$,"IC0...","U",A$(1,20) END_IF ; GOTO 1790 ELSE GOTO 1790
6530 Q2$="",Q0$="I/C",Q1$=A1$,Q3$="M"
6540 CALL "IC2UPB",ERR=6541,X3$,X4$,Q0$,Q1$,Q2$,Q3$
6550 IF Q2$="Y" THEN A8$="Record deleted!",A9$="4"; GOTO 6580
6560 A8$="Activity detected. - Record set to inactive for later removal.",A9$=".4"
6570 A$(108,1)="I"; WRITE (Z[1],KEY=A1$)IOL=0311
6575 IF RT$>"" THEN IF RT$(7,1)="H" THEN CUST$=A$(1,10); CALL "RT2WOC",ERR=6576,X3$,X4$,CUST$,"IC0...","U",A$(1,20)
6580 CALL "ZZPROM",A9$,X3$,Z,A8$,"","",0; GOTO 6590
6590 IF Q2$="Y" THEN GOTO 1630 ELSE GOTO 1790
6600 REM "ALT KEY DATA READS
6690 RETURN 
6700 REM "ADD ENTRY
6705 IF Z9=0 THEN GOTO 6790
6710 WRITE (Z[1],KEY=A1$)IOL=0311
6715 IF RT$>"" THEN IF RT$(7,1)="H" THEN CUST$=A$(1,10); CALL "RT2WOC",ERR=6716,X3$,X4$,CUST$,"IC0...","U",A$(1,20)
6720 IF A$(61,3)+A$(1,20)<>A2$ THEN REMOVE (Z[2],KEY=A2$,DOM=6721)
6725 WRITE (Z[2],KEY=A$(61,3)+A$(1,20))
6730 IF A$(82,14)+A$(61,3)+A$(1,20)<>A3$ THEN REMOVE (Z[2],KEY=A3$,DOM=6731)
6735 WRITE (Z[3],KEY=A$(82,14)+A$(61,3)+A$(1,20))
6790 GOTO 1630
6800 REM "NEXT ENTRY IN FILE
6805 ON 10*FPT(C0)+2 GOTO 6850,6806
6810 A1$=KEY(Z[1],END=6895)
6820 IF A1$="" THEN GOTO 6800 ELSE IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 6895
6825 A$(1,LEN(A1$))=A1$
6830 GOSUB 6600
6835 GOSUB 6450
6840 GOTO 1515
6850 REM "PRIOR ENTRY
6855 CALL "ZZKEYP",ERR=6856,Z[1],A1$; GOTO 6820
6860 CALL "ZZKEYL",ERR=6861,Z[1],A1$; GOTO 6820
6870 GOTO 6895
6890 GOTO 1515
6895 PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=1140); GOTO 1140
8000 REM "Setup item based on FM1 record
8005 A$(21,43)=F$(42,40)+F$(21,3),A$(64,18)=F$(24,18),A$(82,14)=F$(82,14),A$(120,8)=F$(100,4)+F$(100,4),A[0]=F[3],A[14]=F[4],A[15]=F[4],A[19]=F[0],A[16]=F[18]
8010 DIM E$(115),E[30] ! WO273055
8015 E$(1,20)=A$(1,20),E$(21,14)=A$(82,14),E$(55,4)=F$(96,4),E[0]=F[1],E[14]=F[2],E[15]=A[16],E[16]=A[19]
8020 WRITE (Z[5],KEY=E$(1,34))IOL=0350
8040 RETURN 
8110 F$(42,40)=A$(21,43)
8950 REM "Program flow logic
8960 DIM U0$(6); U0$(1)=FID(0); U0$=U0$+"PF"
8970 CLOSE (14); OPEN (14)"ZZPARM"; FIND (14,KEY=U0$,DOM=8990)U0$,U1$
8975 IF U1$="" THEN RETURN 
8980 Q1=NUM(U1$(7,2)),Q1$=U1$(9,Q1),U1$=U1$(Q1+9)
8985 IF Q1<>20 THEN Q1$=""; GOTO 8975
8987 IF LEN(U1$)>=6 AND U1$(1,3)="FM2" THEN PRINT @(40,5),"                 ",
8990 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,4800
9700 REM "PROG FLOW
9710 IF U1$="" THEN REMOVE (Z[13],KEY=U0$,DOM=9900); GOTO 9900
9715 IF U1$(1,6)="FM2IAZ" THEN P=POS(Q1$=U1$); IF P<>0 THEN U1$=U1$(1,6)+STR(NUM(U1$(7,2))+1:"00")+U1$(9,LEN(Q1$))+"@"+U1$(9+LEN(Q1$))
9720 WRITE (Z[13],KEY=U0$)U0$,U1$
9725 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9730 RUN U1$(1,6)
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 SETERR 9940; Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
56000 REM "273055-Expand IC2 for 6 additional cost breaks, allow entry in GUI 
