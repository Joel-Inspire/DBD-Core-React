0010 REM "Cross-index Docutec POs in ICF <IC2UTZ>
0035 REM "3.5.0 - 05/13/91 - 10.71
0040 REM "Copyright 1991 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 BEGIN 
0210 PRINT 'CS','LF','LF',"Create Conversion POs for DOCUTEC ICF file",@(0,5),
0310 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7]
0410 OPEN (1)"ICF047"
0420 Q$="TMP"+FID(0)
0425 ERASE Q$,ERR=0426; GOTO 0425
0430 DIRECT Q$,15,5000,32,0,0
0440 OPEN (2)Q$
1000 REM 
1005 PRINT "Building cross index file..."
1020 READ (1,END=2000)A$
1030 PRINT @(0),A$(56,12),
1080 Q$=A$(56,12),R0=1
1085 READ (2,KEY=Q$,DOM=1088)Q$,Q,R0; R0=R0+1
1090 WRITE (2,KEY=Q$)Q$,0,R0
1200 GOTO 1020
2000 REM "CYCLE BACK THROUGH AND ASSIGN BOGUS PO NUMBER
2005 PRINT 'LF','LF',"Determining Conversion PO numbers..."
2010 READ (2,KEY="",DOM=2011)
2015 R0=0
2020 READ (2,END=3000)Q$
2030 R0=R0+1
2035 PRINT @(0),R0:"##,##0",
2050 WRITE (2,KEY=Q$)Q$,R0
2080 GOTO 2020
3000 REM "CYCLE THROUGH ICF AND PLUG PO#
3005 PRINT 'LF','LF',"Setting conversion PO numbers in ICF..."
3010 DIM A[7]
3020 READ (1,KEY="",DOM=3021)
3040 K$=KEY(1,END=4000); EXTRACT (1,END=4000)IOL=0310
3045 PRINT @(0),K$,
3060 READ (2,KEY=A$(56,12))*,R0
3080 A$(41,9)=STR(R0:"00000000")+"0"
3090 WRITE (1,KEY=K$)IOL=0310
3180 GOTO 3040
4000 REM 
4050 PRINT 'LF','LF',"COMPLETED!"
4090 GOTO 9900
9999 END 
