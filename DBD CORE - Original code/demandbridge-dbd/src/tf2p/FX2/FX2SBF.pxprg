0010 REM "Output Fax File <FX2SBF>
0035 REM "5.0 - 02/21/02 - 12.858611 - dmm - SSP# 146274
0040 REM "Copyright 2002 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 REM "We'll send in a command to perform and a string array of information to use, bucket 1 of the string array will be the unformatted fax number
0100 ENTER X3$,X4$,COMMAND$,DATA${ALL},X9; SETERR 9000
0500 REM "Files
0505 DIM Z[NUM(X3$(60,3))]
0510 Y$="13O ZZPARM  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Y$,Z{ALL},Z0,Z1
0750 CALL "FX2SBC",X3$,Z[13],PARMS$,Q; ON Q GOTO 9900,0770
0755 CALL "ZZPROM",".4",X3$,0,"You are not configured for the Fax output option!","","",0; GOTO 9900
0800 OPTIONS$="S",FAX$=DATA$[1]; CALL "FX2SBA",X3$,X4$,FAX$,PARMS$,OPTIONS$,X9; IF X9=1 THEN GOTO 9900
0820 DATA$[1]=OPTIONS$
1000 REM "Insert string array info into command
1010 INDEX=POS("$["=COMMAND$); IF INDEX=0 THEN GOTO 2000
1020 END_INDEX=POS("]"=COMMAND$(INDEX+2)),END_INDEX_2=POS("]"=COMMAND$)
1030 BUCKET$=COMMAND$(INDEX+2,END_INDEX-1)
1040 BUCKET=NUM(BUCKET$,ERR=9900)
1050 COMMAND$=COMMAND$(1,INDEX-1)+DATA$[BUCKET]+COMMAND$(END_INDEX_2+1)
1060 GOTO 1010
2000 REM "Perform command
2010 IF X3$(77,1)="U" THEN COMMAND$=COMMAND$+" >/dev/null"
2020 IF X3$(77,1)="U" THEN COMMAND=SYS(COMMAND$); GOTO COMMAND_DONE
2025 CALL "ZZ2CMD",X3$,X4$,COMMAND$,"","IN",COMM_CODE,COMM_CODE$
2090 COMMAND_DONE:GOTO 9900
8910 DEF FNS$(X$)=X$(1,POS(S$=X$+S$)-1)
9040 EXIT ERR
9900 REM 
9940 EXIT 
9999 END 
