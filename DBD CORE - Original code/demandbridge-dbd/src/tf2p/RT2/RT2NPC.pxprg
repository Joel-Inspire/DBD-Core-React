0010 REM "Remote Telemarketing - Initialize new PC<RT2NPC>
0020 REM "4.4 - 10/12/01 - 10.08 - plh - SSP# 129412
0030 REM "Copyright 2001 Computer Software Inc.; Norcross, Georgia
0040 REM "        Licensed Software - All Rights Reserved.
0089 ! ^89
0099 SETERR 9000
0109 EXIT 
0119 ! 
0300 ! 300
0310 REM "IOLISTS
0320 IOL_TF0:IOLIST COMP_CODE$,DATA_PREFIX$,PROG_PREFIX$,LISC_COMP$,CONFIG_DESC$
0330 ! 
1000 ! ^ 1000
1010 BUILD_TF0:
1020 ENTER SALESPERSON$,RESULT
1021 RESULT=1
1030 _TF0=UNT
1040 OPEN (_TF0,ERR=1640)"TF0"
1050 FINFO$=FIB(_TF0)
1060 ! 
1070 NEW_NAME$="RT"+PAD(SUB(UCS(SALESPERSON$)," ","X"),4,1,"X")+"TF0"
1080 OUT_FILE$=%DATAPATH$+DLM+NEW_NAME$
1090 ERASE OUT_FILE$,ERR=*NEXT
1100 FINFO$(4,6)=PAD(NEW_NAME$,6,1)
1110 FINFO$(25,60)=PAD(OUT_FILE$,60,1)
1120 FILE FINFO$
1130 DIM PC$:IOL=IOL_TF0
1140 _NEW=UNT
1150 OPEN (_NEW,ERR=1640)OUT_FILE$
1160 ! 
1170 READ (_TF0,KEY="",ERR=*NEXT)
1180 ! 
1190 READ (_TF0,END=1280)IOL=IOL_TF0
1200 PC.COMP_CODE$=PAD(COMP_CODE$,6,1)
1210 PC.DATA_PREFIX$="tf2d\ C:\PVX\" ! Data files in tf2d
1220 PC.PROG_PREFIX$="nomads\ tf2p\===\ tf2p\USR\ tf2y\ tf2z\===\ tf2z\USR\ UTILS\ C:\PVX\" ! programs in the normal places
1230 PC.LISC_COMP$=LISC_COMP$
1240 PC.CONFIG_DESC$=CONFIG_DESC$
1250 WRITE RECORD (_NEW)PC$
1260 READ DATA FROM "" TO PC$
1270 GOTO 1190
1280 RESULT=0
1281 ! 
1290 CLOSE (_TF0,ERR=*NEXT)
1300 CLOSE (_NEW,ERR=*NEXT)
1320 EXIT 
1330 ! 
1630 ! ^ 100
1640 COPY_INSTALL_FILES:
1650 ENTER IN_FILE$,SALESPERSON$,RESULT
1660 RESULT=1
1680 P=POS(DLM=IN_FILE$,-1)
1681 IF P THEN FILENAME$=MID(IN_FILE$,P+1) ELSE FILENAME$=IN_FILE$
1690 NEW_NAME$="RT"+PAD(SUB(UCS(SALESPERSON$)," ","X"),4,1,"X")+FILENAME$
1700 OUT_FILE$=%DATAPATH$+DLM+NEW_NAME$
1710 ERASE OUT_FILE$,ERR=*NEXT
1720 SERIAL OUT_FILE$
1730 IND_CNT=0,BYT_CNT=0
1740 _IN=HFN
1750 OPEN (_IN,ERR=1850,ISZ=256)IN_FILE$
1760 _OUT=HFN
1770 OPEN (_OUT,ERR=1850,ISZ=1)OUT_FILE$
1780 ! 
1790 READ RECORD (_IN,IND=IND_CNT,END=1830)HOST$
1800 WRITE RECORD (_OUT,IND=BYT_CNT)HOST$
1810 IND_CNT=IND_CNT+1,BYT_CNT=BYT_CNT+LEN(HOST$)
1820 GOTO 1780
1830 RESULT=0
1840 ! 
1850 CLOSE (_IN,ERR=*NEXT)
1860 CLOSE (_OUT,ERR=*NEXT)
1870 EXIT 
9000 ! ^ 9000
