0010 REM "Salesperson Setup <RT2MAA>
0015 REM "Prog Type: I -   032
0020 SETESC 4040; SETERR 3880
0035 REM "4.4 - 08/16/00 - 10.76 - plh - SSP# 128549
0040 REM "Copyright 2000 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0110 X0$="RT2MAA",X1$="Salesperson Setup",K9$="",K9=0
0130 K0=4,K1=1
0135 C9=-1
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 4185
0245 IF X3$(65,1)>"2" THEN PRECISION NUM(X3$(65,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1)
0320 IOLIST B$
0350 RT6_IOL:IOLIST RT6$,RT6[0],RT6[1],RT6[2],RT6[3],RT6[4]
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X RT0...  02O AR3... 03O RT2... 04O RT4... 05O RT6... 13O ZZPARM  "
0520 GOSUB 4120; ON Z0 GOTO 0521,4160
0590 READ (Z[1],KEY=K9$,DOM=0591)
0600 REM "
0680 GOSUB 2900
1000 REM PRINT BACKGROUND
1010 Y8=1,Z8=0; CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1030 DIM B$(244)
1035 DIM A$(181)
1045 A$(1,LEN(A1$))=A1$; IF A1$="" THEN A$(1,LEN(K9$))=K9$
1060 PRINT (0,ERR=1070)'CF',; GOSUB 3150; GOTO 1100
1070 GOSUB 2900; GOSUB 3150
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 SETERR 3880; C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 4160
1140 ON X0 GOTO DISPLAY_SP_KEY,1500
1200 DISPLAY_SP_KEY:REM "Salesperson
1210 A$(1,4)="    "
1211 CALL "ZZENTR","SZXUX",A{ALL},A$,X4$,X3$,27,3,1,4,C0,"","{1"+X$,K9$,"RT2MAA00","AR3","AR2MBB",""; IF C0=6 THEN GOSUB 3090; C0=1
1212 IF INT(ABS(C0))=3 THEN C0=-ABS(C0); READ (Z[1],KEY=A$(1,4),DOM=1213)
1215 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1210,3350,4150,3515
1220 IF V9<>-2 THEN FIND (Z[2],KEY=A$(1,4),DOM=1210)IOL=0320
1225 PRINT @(32,3),B$(5,35),
1240 GOTO 1120
1500 REM "NOW THAT KEY IS ENTERED, AND VERIFIED IN RT0 & AR3, GET T/M LISTS
1505 Z9=-1,Z8=0,C9=0,A2$="",A3$="",A4$="",A5$=""
1510 A1$=A$(1,4)
1516 DIM PREV_OPTIONS$(20)
1520 READ (Z[1],ERR=3520,KEY=A1$,DOM=1600)IOL=0310
1523 PREV_OPTIONS$(1)=A$(80,20)
1525 Z9=0,V7$=""; GOSUB 2880
1530 A2$=A$(5,3)+A$(1,4)
1535 GOSUB 2780
1590 GOTO 1700
1600 REM "ERROR PROCEDURE
1615 IF X3$(185,1)="I" THEN CALL "ZZPROM","2A",X3$,0,"","","",0; GOTO 1630
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630
1630 IF Z8=1 THEN REMOVE (Z[1],KEY=A1$,DOM=1000); GOTO 1000 ELSE GOTO 1000
1655 Z8=1
1680 GOSUB 3700
1690 GOTO TEXTBOXES_INIT
1700 REM "DISPLAY DATA
1790 GOSUB 3010
1800 REM "
1805 IF C0=3 THEN IF V8$="" THEN X0=X0-5; GOTO 2040 ELSE X0=NUM(V8$(LEN(V8$)-3,2)); GOTO 2040
1815 IF X3$(185,1)="I" THEN CALL "ZZPROM","4A",X3$,Z,"","","",0; GOTO 3340
1820 CALL "ZZPROM",STR(6+C9)+" RT2MAA",X3$,Z,"","","V",X0; ON Z GOTO 1850,3190,1630,3270,1821
1825 GOTO 3270
1830 GOTO TEXTBOXES_INIT
1850 REM "MODIFY
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE IF Z9=0 THEN Z9=1
1860 GOSUB 3660
1870 GOSUB 3010
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO TEXTBOXES_INIT
2000 TEXTBOXES_INIT:REM "START OF FIELD PROCESSING,LOOP REENTRY AT TEXTBOXES_LOOP_START
2010 C0=0,X0=-1,X1=1
2020 TEXTBOXES_LOOP_START:
2021 SETERR 3880; X$="",Q$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF INT(C0)=3 THEN GOSUB 3590 ELSE IF C0>3 OR X0<0 THEN GOTO 1800
2038 IF X0<LEN(V7$) THEN V7$(X0+1,1)=""
2040 ON X0 GOTO 2100,2150,2200,2580,2290,2320,2610,2680,2730,2470,2510,2540,2350,2380,2410,2440,1800
2100 TF_OPERATOR_CODE:
2110 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,27,5,5,3,C0,"","{3"+X$,"","RT2MAA02","","ZR2MBA",""; IF C0=6 THEN GOSUB 3090; C0=1
2140 GOTO TEXTBOXES_LOOP_START
2150 COMPUTER_TYPE:
2160 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,27,6,8,30,C0,"","{3"+X$,"","RT2MAA04","","",""
2190 GOTO TEXTBOXES_LOOP_START
2200 BASIC_SERIAL_NO:
2205 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,27,7,38,10,C0,"","{3"+X$,"","RT2MAA06","","",""
2210 IF STP(A$(38,10),3," ")="" THEN {
2215 GOTO 2260 }
2220  } ELSE {! "Search apps records
2225 SSN$=A$(38,10),APP_MISSING=1
2230 CALL "TF"+%LIC_COMP$+";OSCAR",APP$,SSN$
2235 FOR X=1 TO LEN(APP$) STEP 17
2240 IF MID(APP$,X,2)="TM" THEN APP_MISSING=1; EXITTO 2250
2245 NEXT X
2250 IF APP_MISSING THEN CALL "ZZPROM",".4",X3$,Z,"This serial number is not licensed as a Remote Client","","",0; GOTO 2205
2255  }
2260 GOTO TEXTBOXES_LOOP_START
2290 NEXT_RT1_SEQ_NO:
2300 CALL "ZZENTR","SUZ",A{ALL},A$,X4$,X3$,27,8,48,5,C0,"","{3"+X$,"","RT2MAA08","","",""
2310 GOTO TEXTBOXES_LOOP_START
2320 NEXT_PACKAGE_SEQ_NO:
2330 CALL "ZZENTR","SUZ",A{ALL},A$,X4$,X3$,27,9,53,2,C0,"","{3"+X$,"","RT2MAA10","","",""
2340 GOTO TEXTBOXES_LOOP_START
2350 LAST_GENERATED_PACKAGE_ON:
2360 CALL "ZZENTR","D",A{ALL},A$,X4$,X3$,27,18,57,6,C0,"","{3"+X$,"","RT2MAA16","","",""
2370 GOTO TEXTBOXES_LOOP_START
2380 LAST_GENERATED_PACKAGE_TIME:
2390 CALL "ZZENTR","T",A{ALL},A$,X4$,X3$,39,18,63,4,C0,"","{3"+X$,"","RT2MAA18","","",""
2400 GOTO TEXTBOXES_LOOP_START
2410 LAST_RECEIVED_PACKAGE_ON:
2420 CALL "ZZENTR","D",A{ALL},A$,X4$,X3$,27,19,67,6,C0,"","{3"+X$,"","RT2MAA20","","",""
2430 GOTO TEXTBOXES_LOOP_START
2440 LAST_RECEIVED_PACKAGE_TIME:
2450 CALL "ZZENTR","T",A{ALL},A$,X4$,X3$,39,19,73,4,C0,"","{3"+X$,"","RT2MAA22","","",""
2460 GOTO TEXTBOXES_LOOP_START
2470 ITEM_MASTER:REM TO TRANSFER
2480 X$="Includes Product Locator Information"
2490 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,27,13,77,1,C0,"","{3"+X$,"","RT2MAA24","","",""
2500 GOTO TEXTBOXES_LOOP_START
2510 STOCK_INVENTORY:REM TO TRANSFER
2520 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,27,14,78,1,C0,"","{3"+X$,"","RT2MAA26","","",""
2530 GOTO TEXTBOXES_LOOP_START
2540 LISTS:REM "T/M lists to transfer
2550 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,27,16,80,4,C0,"","{3"+X$,"","RT2MAA03","ZP0","","04H2"
2560 GOSUB CHECK_OPTIONS
2570 GOTO TEXTBOXES_LOOP_START
2580 AUTOEXPANDING_FILES:
2590 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,71,7,100,1,C0,"","{3"+X$,"","RT2MAA30","","",""
2600 GOTO TEXTBOXES_LOOP_START
2610 CONNECTION_TYPE:REM UPDATE VIA (EMAIL,INTERNET,SERIAL)
2620 X$="E - Email,   I - Internet"
2630 IF POS(" "=MID(A$,151,1))>0 THEN A$(151,1)="E"
2640 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,71,9,151,1,C0,"","{3"+X$,"","RT2MAA32","","",""
2650 IF POS(A$(151,1)="EI")=0 THEN GOTO 2640 ELSE X$=""
2660 IF A$(151,1)<>"E" THEN A$(121,30)=""; A$(152,30)=""; X0=X0+2
2670 GOTO TEXTBOXES_LOOP_START
2680 SP_EMAIL_ADDRESS:
2690 X$="REQUIRES ENTRY"
2700 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,27,10,121,30,C0,"","{3"+X$,"","RT2MAA34","","",""
2710 IF POS($20$+$00$:A$(121,30))=0 THEN GOTO SP_EMAIL_ADDRESS
2720 X$=""; GOTO TEXTBOXES_LOOP_START
2730 HOST_EMAIL_ADDRESS:
2740 X$="REQUIRES ENTRY"
2750 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,27,11,152,30,C0,"","{3"+X$,"","RT2MAA36","","",""
2760 IF POS($20$+$00$:A$(121,30))=0 THEN GOTO HOST_EMAIL_ADDRESS
2770 X$=""; GOTO TEXTBOXES_LOOP_START
2780 REM "Get encrypted record from RT4 and decrypt the date
2790 DIM GOOD_TILL$(6)
2800 AUTH_KEY$="RT"+A$(1,4); REM "Spaces ok
2810 SSN$=A$(38,10)
2820 IF LEN(SSN$)<10 THEN SSN$="0"+SSN$; GOTO 2820; REM "up to 10 spaces front 0 filled
2830 CALL "ZZCRYP",X3$,SSN$,"","E",AUTH_KEY$,A{ALL},ENCODED_KEY$,X9
2840 DIM RT4$(24); RT4$(1,12)=HTA(ENCODED_KEY$)
2850 READ (Z[4],KEY=RT4$(1,12),DOM=2865)RT4$(1)
2860 CALL "ZZCRYP",X3$,SSN$,"","U",GOOD_TILL$,A{ALL},ATH(RT4$(13,12)),X9
2870 RETURN 
2880 REM "Alt sort keys
2890 RETURN 
2900 BACKGROUND_DISPLAY:
2910 PRINT (0,ERR=2915)'SB',
2920 PRINT @(14,3+V0),"Salesperson:",@(0,4+V0),Z0$,
2930 PRINT @(4,5+V0),"TopForm Operator Code:",@(12,6+V0),"Computer type:",@(10,7+V0),"Basic Serial No:",@(40,7+V0),"Don't use Autoexpanding files?",@(5,8+V0),"Next RT1 sequence no:",@(1,9+V0),"Next Package sequence no:",@(0,18+V0),"Last generated package on:",@(1,19+V0),"Last received package on:",
2940 PRINT @(6,10+V0),"Sales Email Address:",@(47,9+V0),"Update Connection Type:",@(7,11),"Host Email Address:"
2950 PRINT @(0,13+V0),"Transfer All Item Masters?",
2960 PRINT @(1,14),"Transfer Stock Inventory?",
2970 PRINT @(7,16),"Transfer T/M Lists:",
2980 PRINT @(49,18),"Authorized to:",
2990 PRINT (0,ERR=2995)'SF',
3000 RETURN 
3010 DATA_DISPLAY:
3020 GOSUB 3150
3030 PRINT @(27,5),A$(5,3),@(27,6),A$(8,30),@(27,7),A$(38,10),@(71,7),A$(100,1),@(27,8),A$(48,5),@(27,9),A$(53,2),@(27,18),FND$(A$(57,6)),@(39,18),FNT$(A$(63,4)),@(27,19),FND$(A$(67,6)),@(39,19),FNT$(A$(73,4)),
3040 PRINT @(27,10),A$(121,30),@(71,9),A$(151,1),@(27,11),A$(152,30)
3050 PRINT @(27,13),A$(77,1),@(27,14),A$(78,1),
3060 FOR INDEX=0 TO 4; PRINT @(27+6*INDEX,16),A$(80+4*INDEX,4),; NEXT INDEX
3070 IF GOOD_TILL$>"" THEN PRINT @(64,18),FND$(GOOD_TILL$),
3080 RETURN 
3090 SCREEN_DISPLAY:
3100 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
3110 GOSUB 2900
3120 IF C9>0 THEN GOSUB 3010 ELSE GOSUB 3150
3130 IF ABS(C0)>4 THEN C0=ABS(C0)-5
3140 RETURN 
3150 REM "DISPLAY KEYS
3160 IF C9<0 THEN GOTO 3140
3170 PRINT @(27,3),A$(1,4),@(32,3),B$(5,35),
3180 RETURN 
3190 REM "DELETE
3200 REMOVE (Z[1],KEY=A1$,DOM=3205)
3210 REMOVE (Z[3],KEY=A2$,DOM=3215)
3220 A$(80,20)=""; GOSUB CHECK_OPTIONS; REM "Remove RT6 records by blank lists for this salesperson
3230 A1$=""; GOTO 1630
3240 REM "ALT KEY DATA READS
3250 FIND (Z[2],KEY=A$(1,4),DOM=3255)IOL=0320
3260 RETURN 
3270 REM "ADD ENTRY
3280 GOSUB CHECK_OPTIONS
3290 IF Z9=0 THEN IF Z=6 THEN GOTO 3330 ELSE GOTO 3340 END_IF ELSE IF V7$>"" THEN X0=POS(" "<>V7$); IF X0>0 THEN X0=X0-1; GOTO 2038
3300 WRITE (Z[1],KEY=A1$)IOL=0310
3310 IF A$(5,4)+A$(1,4)<>A2$ THEN REMOVE (Z[3],KEY=A2$,DOM=3315)
3320 WRITE (Z[3],KEY=A$(5,3)+A$(1,4))
3330 IF Z=6 THEN A5$=A1$; CALL "RT2MFA",X3$,X4$,"",A5$; Z=0; GOSUB 3090
3340 C9=0; IF Z=6 OR K1=0 THEN GOTO 4160 ELSE IF Z<4 THEN GOTO 1000 ELSE C0=-(3.1+(Z-4)/10); GOTO 3350
3350 REM "NEXT ENTRY IN FILE
3360 ON 10*FPT(C0)+2 GOTO 3430,3365
3370 A1$=KEY(Z[1],END=3500)
3380 IF A1$="" THEN GOTO 3350 ELSE IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 3500
3390 A$(1,LEN(A1$))=A1$
3400 GOSUB 3240
3410 GOSUB 3150
3420 GOTO 1515
3430 REM "PRIOR ENTRY
3440 CALL "ZZKEYP",ERR=3450,Z[1],A1$; GOTO 3380
3450 CALL "ZZPROM","K0",X3$,S3,"","","",0; ON S3 GOTO 3455,4160
3460 PRINT 'RB',; CALL "ZZKEYL",ERR=3465,Z[1],A1$; GOTO 3380
3470 GOTO 1100
3480 GOTO 3500
3490 GOTO 1515
3500 CALL "ZZPROM","K1",X3$,S3,"","","",0; IF S3=1 THEN GOTO 4160 ELSE IF A1$="" THEN GOTO 3460 ELSE PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=3505)
3510 ON S9 GOTO 3370,1100
3520 REM "Forced read
3530 IF ERR<>0 THEN GOTO 3880
3540 CALL "ZZREAD",Z[1],A1$,A$,A{ALL},S8; ON S8 GOTO 3545,1630
3550 GOSUB 3010
3560 CALL "ZZPROM","E0",X3$,0,"","","",0; GOTO 3580
3570 CALL "ZZPROM","E0A",X3$,0,"","","",0; GOTO 3580
3580 GOTO 1630
3590 REM 
3600 ON FPT(C0)*10 GOTO 3640,3610,3620,3640
3610 IF V8$="" THEN X0=X0+4; GOTO 3640 ELSE X0=NUM(V8$(POS(STR(X0:"00")<=V8$,2),2)); GOTO 3640
3620 IF V8$="" THEN X0=X0-6; GOTO 3630 ELSE X0=POS(STR(X0-1:"00")<=V8$,2)-2; IF X0<0 THEN X0=0; GOTO 3640 ELSE X0=NUM(V8$(X0,2)); GOTO 3640
3630 IF X0<0 THEN X0=0; GOTO 3640
3640 IF X0>0 THEN X0=X0-0
3650 C0=3; RETURN 
3660 REM "EXTRACT
3670 EXTRACT (Z[1],ERR=3520,KEY=A1$,DOM=3690)IOL=0310
3680 C9=1,Z9=1; GOSUB 2880
3690 RETURN 
3700 REM "EXTRACT NEW ENTRY
3710 WRITE (Z[1],KEY=A1$,DOM=3570)IOL=0310; GOTO 3660
3720 RETURN 
3730 CHECK_OPTIONS:REM "check current options against previous options and adjust RT6 entries accordingly
3740 CURRENT_OPTIONS$=A$(80,20)
3750 IF CURRENT_OPTIONS$=PREV_OPTIONS$ THEN GOTO 3790; REM "skip remove check, but always make sure that current options are on file
3760 FOR OPTION_INDEX=1 TO LEN(PREV_OPTIONS$)-3 STEP 4
3770 IF POS(PREV_OPTIONS$(OPTION_INDEX,4)=CURRENT_OPTIONS$,4)=0 THEN REMOVE (Z[5],KEY=PREV_OPTIONS$(OPTION_INDEX,4)+A$(1,4),DOM=3775)
3780 NEXT OPTION_INDEX
3790 FOR OPTION_INDEX=1 TO LEN(CURRENT_OPTIONS$)-3 STEP 4
3800 FIND (Z[5],KEY=CURRENT_OPTIONS$(OPTION_INDEX,4)+A$(1,4),DOM=3810); GOTO 3820
3810 DIM RT6$(124),RT6[4]; RT6$(1,4)=CURRENT_OPTIONS$(OPTION_INDEX,4),RT6$(5,4)=A$(1,4),RT6$(9,2)="NY",RT6$(23,1)="N"; WRITE (Z[5],KEY=RT6$(1,8),DOM=3815)IOL=RT6_IOL
3820 NEXT OPTION_INDEX
3830 END_CHECK_OPTIONS:RETURN 
3840 DEF FNP$(Z9$)="("+Z9$(1,3)+") "+Z9$(4,3)+"-"+Z9$(7,4)+" Ext: "+Z9$(11,4)
3850 DEF FND$(Z9$)=Z9$(3,2)+"/"+Z9$(5,2)+"/"+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
3860 DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
3870 DEF FNB$(Z9$)=X3$(214-6*NUM(Z9$),1)
3880 REM "ERROR PROCESSING
3890 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 4080
3900 SETERR 3905; Y8$=LST(PGM(Y6))
3910 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
3920 REM 
3930 ON Y7 GOTO 3950,4000,4150,3960,3990
3940 REM 
3950 RETRY 
3960 SETERR 3980
3970 EXECUTE Y7$
3980 SETERR 3880; RETRY 
3990 SETERR 0000; RETRY 
4000 REM " TRANSFER CONTROL
4010 ON Y8 GOTO 4160,0990,4185
4020 GOTO 0990
4030 GOTO 4150
4040 SETESC 4070
4050 SETERR 4070
4060 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
4070 SETERR 3880; SETESC 4040; RETURN 
4080 REM "CTRL LOGIC
4090 SETERR 3880; GOSUB 3090
4100 ON C9 GOTO 1140,2040
4110 RETURN 
4120 REM "FILES
4130 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
4140 RETURN 
4150 REM "EXIT PROGRAM
4160 REM "END PROGRAM
4170 Y8=2
4180 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
4190 SETERR 4200; Q1$=A1$; EXIT 
4200 SETESC 4070
4210 RUN "ZMENU"
4220 END 
