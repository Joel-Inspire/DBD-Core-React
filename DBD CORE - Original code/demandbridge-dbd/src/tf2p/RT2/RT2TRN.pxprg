0010 REM "<RT2TRN> R/T Remote Transfer Starter
0015 REM "Prog Type: IP-3.1.2
0020 SETESC 9300; SETERR 9000
0035 REM "4.4 - 08/30/00 - 17.6 - plh - SSP# 128549
0040 REM "Copyright 2000 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0070 REM "R$ are parmeters read
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="RT2TRN",X1$="R/T Remote Transfer Starter"
0120 DIM S$(40)
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0250 ! 
0300 REM "IOLISTS
0310 IOLIST A$
0320 IOLIST B$
0330 ! 
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0506 REM RT0 WAS ORIGINALLY JUST RT0, NOT RT0...
0510 Z$="01O RT0... 13O ZZPARM "
0520 GOSUB 9750; ON Z0 GOTO 0521,9900
0539 ! 
0540 REM LET R$="!!!"; CALL "RT2PRM",X3$,X4$,R$; IF R$="" THEN GOTO 09900
0550 R$=Q0$
0600 REM "Get business basic DIR
0610 DIR_NAME$=LWD
0630 ! ** SALES PERSON CODE AND TRANSFER PARAMETERS ** PLH 8/00
0640 SALESPERSON$=Q1$
0650 READ (Z[1],KEY=SALESPERSON$)A$
0660 CONNECT_TYPE$=MID(A$,151,1)
0700 REM "Set DIRectory for Term
0705 TERM_DIR$=STP(MID(R$,42,30),1)
0710 ! 
0900 REM "**** HOST EMAILS OR EXITS HERE ****
0910 IF MID(R$,7,1)<>"R" AND CONNECT_TYPE$="E" THEN CALL "RT2EML",X3$,X4$,A$,SALESPERSON$
0920 IF MID(R$,7,1)<>"R" THEN GOTO 9900
0930 ! 
1000 REM **** CLIENT SIDE PROCESSING ****
1002 REM "Lines 1000-4000 CHANGED 8/00 BY PETER HIGGINS TO USE EMAIL TRANS
1005 REM CHECK CONNECTION TYPE E-EMAIL, I-INTERNET FTP, S-SERIAL(TERM)
1010 IF CONNECTION_TYPE$="S" THEN GOTO 3000
1020 IF CONNECTION_TYPE$="I" THEN GOTO 2000
1021 ! 
1030 REM * ITS AN EMAIL CONNECTION ** ! for Windows Clients only
1040 COMMAND$=DIR_NAME$+"\"+"RT2WIN.EXE "+DIR_NAME$+"\HT"+SALESPERSON$+" "+OUT_MAIL$
1050 GOTO 4000
1060 ! 
2000 REM * ITS FTP ** NOT IMPLEMENTED YET
2010 ! 
3100 REM **** SERIAL - ORIGINAL TINY TERM CODE - SETUP TERM RUN ****
3110 REM "Start process by running Term with following params:
3111 REM THIS CANNOT HAPPEN IN PVX
3120 REM "salesperson name, business basic DIR,  host basic DIR from parms
3130 COMMAND$=TERM_DIR$+"\WTERM32 -u "+DIR_NAME$+"\RT_TRANS "+SALESPERSON$+" "+DIR_NAME$+" "+R$(12,30)
4000 REM **** RUN SYSTEM COMMAND ****
4010 INVOKE COMMAND$
5000 GOTO 9900
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9120 ON Y8 GOTO 9900,0990,9920
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 SETERR 9940; Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
