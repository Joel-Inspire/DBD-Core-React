0010 REM "<RT2BEG> Unpack initial programs and files for Remote T/M
0020 REM "4.1 - 03/16/98 - 17.85 - kmc - SSP# 091410
0030 REM "Copyright 1997 Computer Software Inc.; Norcross, Georgia
0040 REM "        Licensed Software - All Rights Reserved.
0050 SETERR 0630
0060 DIM Z0$(80,"_")
0070 REM "Display Screen
0080 PRINT 'SHOW'(2),@(0,0),'CS',@(0,2),Z0$
0090 WAIT (0)
0110 X0$="RT2BEG",X1$="Unpack Initial TopForm Files"
0120 PRINT @(0,1),X0$,@(40-INT(LEN(X1$)/2),1),X1$,
0140 REM "Check for RTINIT file
0150 SP_NAME$=ARG(1,ERR=*NEXT)
0160 SP_NAME$=PAD(SUB(SP_NAME$," ","X"),4,2,"X")
0170 ! 
0180 OPEN_DATA_FILE:
0190 FILE_NAME$="RT"+SP_NAME$+"00"
0200 OPEN (1,ERR=MISSING_FILE)FILE_NAME$
0210 CLOSE (1)
0220 ! 
0230 ! Okay to process file
0240 DIM X3$(1024)
0250 X3$(48,1)="1",X3$(59,1)="/",X3$(60,3)="020"; X3$(238,1)="0"
0260 ! 
0270 ! Set x3$(9,3)
0280 ! CHECK Number of Users and Serial number
0300 CALL "TF500;KILO",USERS; IF USERS<1 THEN MSGBOX "Users=",STR(USERS),"STOP"; RELEASE 
0310 CALL "TF500;NOVEMBER",ERR=*NEXT; X3$(9,3)=%C$; GOTO 0340
0320 MSGBOX STR(%SSN)+" not in licensed list","STOP"; RELEASE 
0330 ! 
0340 ! 
0350 X3$(340)="0D00000000000800000000009B0000000000814400000000814A000000009C00000000009E00000000009900000000009A0000000000814100000000814200000000814300000000814400000000814500000000814600000000814700000000814800000000814900000000814A0000000000000000000000000000000"; REM "Add function key hex codes
0360 ! 
0361 CALL "RT2PIN",X3$,X4$,FILE_NAME$,OPTION$,RETSTR$,RETVAL
0370 ! 
0380 GOSUB PARAMETER_SETUP
0390 ! 
0400 RUN "ZSTART",ERR=*NEXT
0410 RELEASE 
0420 ! 
0430 PARAMETER_SETUP:REM "Setup parameters as needed
0440 REM "Add password to csi & SYS operators of tf + salesperson code
0450 CLOSE (14); OPEN (14)"ZZPARM"
0460 READ RECORD (14,KEY="ocsi",DOM=*NEXT)A$; A$(35,6)="TF"+SP_NAME$; WRITE RECORD (14,KEY="ocsi")A$
0470 READ RECORD (14,KEY="oSYS",DOM=*NEXT)A$; A$(35,6)="TF"+SP_NAME$; WRITE RECORD (14,KEY="oSYS")A$
0480 REM "Set R/T params to remote and add salesperson code
0490 REM "Key sp name from only entry in RT0
0500 CLOSE (13); OPEN (13,ERR=*NEXT)"RT0"+X3$(9,3); GOTO 0520
0510 OPEN (13,ERR=0575)"RT0"
0520 SP_KEY$=KEY(13,END=*NEXT)
0530 TERM_DIR$="C:\TTPRO"; TERM_DIR$=ARG(2,ERR=*NEXT)
0540 IF POS("/"=TERM_DIR$)<>0 THEN TERM_DIR$(POS("/"=TERM_DIR$),1)="\"; GOTO *SAME
0550 DIM COMP$(7); READ (14,KEY="CMP",DOM=*NEXT)
0560 READ (14)COMP$
0570 READ RECORD (14,KEY=COMP$(4,3)+"R/T",DOM=*NEXT)A$
0580 A$(7,1)="R",A$(8,4)=SP_KEY$,A$(42,30)=TERM_DIR$
0590 WRITE RECORD (14,KEY=X3$(9,3)+"R/T")A$
0600 END_PARAMETER_SETUP:RETURN 
0610 ! 
0620 ! 
0630 REM "Error
0640 MSGBOX "Err= "+STR(ERR)+" Line #= "+STR(TCB(5)),"REMOTE TM INSTALL ERROR","?,RETRYCANCEL",RETVAL$
0650 IF RETVAL$="RETRY" THEN RETRY ELSE RELEASE 
0660 MISSING_FILE:
0670 MSGBOX "Could not find "+FILE_NAME$+"!","ATTENTION"
0680 RELEASE 
0690 RELEASE 
