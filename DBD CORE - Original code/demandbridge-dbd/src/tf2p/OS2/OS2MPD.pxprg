0010 REM "<OS2MPD> Office Supply Parameter Setup - SCREEN 2- spr
0020 SETESC 9300; SETERR 9000
0035 REM "5.6 - 12/02/08 - 9.905833 - dmm - SSP# 225094
0037 REM "225094-OSP parameter file layout missing fields, reused one for    
0040 REM "Copyright 2008 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="OS2MPD",X1$="SPR OSS Parameter Setup - Screen 2"
0120 DIM Z0$(80,"-")
0135 C9=-1,V9=-2
0140 Z2$="000000",Z3$="00000"
0170 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
0175 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0290 K9$=X3$(9,3)+"OSP",K9=LEN(K9$)
0295 DIM Z0$(80,X3$(235,1)); Z0$=ESC+"BG"+Z0$+ESC+"EG"
0299 CALL "ZZ2PRP","OS",RESULT$,DATE$; IF RESULT$<>"Y" THEN CALL "ZZPROM",".4",X3$,Z,"ACCESS DENIED! The Office Supply Interface System is not an in stalled module.","","",0; RUN "ZMENU"
0300 REM "IOLISTS
0310 IOLIST A$(1,LEN(A$)),A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9]
0330 IOLIST VENDOR$
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X ZZPARM  06O ZZPARM  15O AP4...  10O FMP...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0600 REM "
0620 GOSUB 6000
1000 REM "
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1035 DIM A$(1024),A[9]
1040 REM IF V9<>-1 THEN GOSUB 6900; REM "DON'T SET DEFAULTS ***********
1045 A$(1,0+K9)=K9$+A1$
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1500
1200 REM "
1215 IF C0<0 THEN GOTO 9900
1500 REM "
1505 Z9=-1
1510 A1$=K9$
1520 READ (Z[1],KEY=A1$,DOM=1600)IOL=0310
1525 Z9=0
1590 GOTO 1700
1600 REM "
1610 GOSUB 7700; GOTO 1500
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630; REM ,6975 DON'T SET DEFAULTS
1630 GOTO 9900
1660 IF V9>=0 THEN GOSUB 6200
1690 GOTO 2000
1700 REM "
1790 GOSUB 6200
1800 REM "
1820 CALL "ZZPROM","P",X3$,Z,"","","",X0; ON Z GOTO 1850,6700
1830 GOTO 2000
1850 REM "MODIFY
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE IF Z9=0 THEN Z9=1
1860 EXTRACT (Z[1],KEY=A1$,DOM=1870)IOL=0310
1865 C9=1
1870 GOSUB 6200
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF C0>3 OR X0<0 THEN GOTO 1800
2035 IF X0*6+11<LEN(V9$) THEN IF V9$(X0*6+11,1)="2" THEN GOTO 2020
2040 ON X0 GOTO 2100,2150,3000,2250,2300,2350,1800
2045 ! ON X0 GOTO 2100,2150,3000,2250,2300,2350,2400,2450,2500,2550,2600,2650,2700,2750,2800,2850,2900,2950,3000,1800
2100 REM Default Column for United Cost        
2110 CALL "ZZENTR","SRU",A{ALL},A$,X4$,X3$,48,3+V0,225,1,C0,Z2$,"{3"+X$,"01234","OS2MPA00","","",""
2140 GOTO 2020
2150 REM "Transmit all Web Ec Orders to United?
2155 X$=""
2160 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,48,4+V0,226,1,C0,"","{3"+X$,"","OS2MPA10","","",""
2190 GOTO 2020
2200 REM "Terms Discount - Special Charge Code
2205 X$="Must be valid special charge code - Enter Extension Only"
2210 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,5,227,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2210,2211
2215 PRINT @(48,5),A$(227,10),
2217 READ (Z[10],KEY="X"+A$(227,10),DOM=2210)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2210
2218 PRINT @(59,5),FMP$(12,20),
2240 GOTO 2020
2250 REM " JDM Order Prefix
2255 X$=""
2260 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,48,6+V0,583,5,C0,"","{2"+X$,"","OS2MPA00","","",""
2265 PRINT @(48,6),A$(583,5),
2290 GOTO 2020
2300 REM " JDM Send Directory
2305 X$=""
2310 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,48,7+V0,588,30,C0,"","{2"+X$,"","OS2MPA00","","",""
2315 PRINT @(48,7),A$(588,30),
2340 GOTO 2020
2350 REM " JDM Recv Directory
2355 X$=""
2360 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,48,8+V0,618,30,C0,"","{2"+X$,"","OS2MPA00","","",""
2365 PRINT @(48,8),A$(618,30),
2390 GOTO 2020
2400 REM " MINIMUM ORDER SPECIAL CHARGE
2405 X$="Must be valid special charge code - Enter Extension Only"
2410 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,9,267,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2410,2411
2415 PRINT @(48,9),A$(267,10),
2417 READ (Z[10],KEY="X"+A$(267,10),DOM=2210)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2410
2418 PRINT @(59,9),FMP$(12,20),
2440 GOTO 2020
2450 REM " SALES TAX CHARGE CODE
2455 X$="Must be valid special charge code - Enter Extension Only"
2460 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,10,277,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2360,2361
2465 PRINT @(48,10),A$(277,10),
2467 READ (Z[10],KEY="X"+A$(277,10),DOM=2460)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2450
2468 PRINT @(59,10),FMP$(12,20),
2490 GOTO 2020
2500 REM "DESK TOP  SPECIAL CHARGE CODE
2505 X$="Must be valid special charge code - Enter Extension Only"
2510 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,11,287,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2510,2511
2515 PRINT @(48,11),A$(287,10),
2517 READ (Z[10],KEY="X"+A$(287,10),DOM=2510)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2510
2518 PRINT @(59,11),FMP$(12,20),
2540 GOTO 2020
2550 REM " GIFT WRAP CHARGE - SPECIAL CHARGE CODE
2555 X$="Must be valid special charge code - Enter Extension Only"
2560 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,12,297,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2560,2561
2565 PRINT @(48,12),A$(297,10),
2567 READ (Z[10],KEY="X"+A$(297,10),DOM=2560)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2550
2568 PRINT @(59,12),FMP$(12,20),
2590 GOTO 2020
2600 REM "INSIDE DELIVERY SPECIAL CHARGE
2605 X$="Must be valid special charge code - Enter Extension Only"
2610 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,13,307,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2610,2611
2615 PRINT @(48,13),A$(307,10),
2617 READ (Z[10],KEY="X"+A$(307,10),DOM=2610)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2610
2618 PRINT @(59,13),FMP$(12,20),
2640 GOTO 2020
2650 REM " STENCILING  SPECIAL CHARGE CODE
2655 X$="Must be valid special charge code - Enter Extension Only"
2660 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,14,317,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2660,2661
2665 PRINT @(48,14),A$(317,10),
2667 READ (Z[10],KEY="X"+A$(317,10),DOM=2660)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2650
2668 PRINT @(59,14),FMP$(12,20),
2690 GOTO 2020
2700 REM "SHRINK WRAP CHARGE
2705 X$="Must be valid special charge code - Enter Extension Only"
2710 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,15,327,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2710,2711
2715 PRINT @(48,15),A$(327,10),
2717 READ (Z[10],KEY="X"+A$(327,10),DOM=2710)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2710
2718 PRINT @(59,15),FMP$(12,20),
2740 GOTO 2020
2750 REM "ADDITIONAL MISC CHARGE #1
2755 X$="Must be valid special charge code - Enter Extension Only"
2760 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,16,337,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2260,2261
2765 PRINT @(48,16),A$(337,10),
2767 READ (Z[10],KEY="X"+A$(337,10),DOM=2760)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2750
2768 PRINT @(59,16),FMP$(12,20),
2790 GOTO 2020
2800 REM " ADDITIONAL MISC CHARGE #2
2805 X$="Must be valid special charge code - Enter Extension Only"
2810 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,17,347,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2810,2811
2815 PRINT @(48,17),A$(347,10),
2817 READ (Z[10],KEY="X"+A$(347,10),DOM=2810)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2810
2818 PRINT @(59,17),FMP$(12,20),
2840 GOTO 2020
2850 REM "ADDITIONAL MISC CHARGE #3
2855 X$="Must be valid special charge code - Enter Extension Only"
2860 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,18,357,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2860,2861
2865 PRINT @(48,18),A$(357,10),
2867 READ (Z[10],KEY="X"+A$(357,10),DOM=2860)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2850
2868 PRINT @(59,18),FMP$(12,20),
2890 GOTO 2020
2900 REM " ADDITIONAL MISC CHARGE #4
2905 X$="Must be valid special charge code - Enter Extension Only"
2910 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,19,367,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2910,2911
2915 PRINT @(48,19),A$(367,10),
2917 READ (Z[10],KEY="X"+A$(367,10),DOM=2910)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2910
2918 PRINT @(59,19),FMP$(12,20),
2940 GOTO 2020
2950 REM "ADDITIONAL MISC CHARGE #5
2955 X$="Must be valid special charge code - Enter Extension Only"
2960 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,48,20,377,10,C0,"","{2"+X$,"X","FS2MCA02","FMPX","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2960,2961
2965 PRINT @(48,20),A$(377,10),
2967 READ (Z[10],KEY="X"+A$(377,10),DOM=2960)FMP$; IF MID(FMP$,61,1)<>"Y" THEN GOTO 2950
2968 PRINT @(59,20),FMP$(12,20),
2990 GOTO 2020
3000 REM "DEFAULT COLUMN FOR CONSUMER PRICE
3010 CALL "ZZENTR","SRU",A{ALL},A$,X4$,X3$,48,5+V0,387,1,C0,Z2$,"{3"+X$,"1234","OS2MPA00","","",""
3040 GOTO 2020
3110 CALL "ZZENTR","SRU",A{ALL},A$,X4$,X3$,48,21+V0,387,1,C0,Z2$,"{3"+X$,"1234","OS2MPA00","","",""
3140 GOTO 2020
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6060 PRINT @(11,3+V0),"Default Column for Cost from Vendor:",
6062 PRINT @(10,4+V0),"Transmit All WebEC Orders to Vendor?:",
6064 PRINT @(13,5+V0),"Default Column for Consumer Price:",
6066 PRINT @(30,6+V0),"JDM Order Prefix:",
6068 PRINT @(28,7+V0),"JDM Send Directory:",
6070 PRINT @(28,8+V0),"JDM Recv Directory:",
6072 GOTO 6165
6074 PRINT @(8,10+V0),"Sales Tax Charge - Special Charge Code:",
6075 PRINT @(7,11+V0),"Desk Top Delivery - Special Charge Code:",
6076 PRINT @(8,12+V0),"Gift Wrap Charge - Special Charge Code:",
6078 PRINT @(2,13+V0),"Inside Delivery Charge - Special Charge Code:",
6080 PRINT @(7,14+V0),"Stenciling Charge - Special Charge Code: ",
6090 PRINT @(6,15+V0),"Shrink Wrap Charge - Special Charge Code:",
6092 PRINT @(0,16+V0),"Additional Misc Charge 1 - Special Charge Code:",
6093 PRINT @(0,17+V0),"Additional Misc Charge 2 - Special Charge Code:",
6094 PRINT @(0,18+V0),"Additional Misc Charge 3 - Special Charge Code:",
6095 PRINT @(0,19+V0),"Additional Misc Charge 4 - Special Charge Code:",
6096 PRINT @(0,20+V0),"Additional Misc Charge 5 - Special Charge Code:",
6098 PRINT @(13,21+V0),"Default Column for Consumer Price:",
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6220 PRINT @(48,3+V0),A$(225,1)
6221 PRINT @(48,4+V0),A$(226,1),
6222 PRINT @(48,5+V0),A$(387,10),
6225 PRINT @(48,6+V0),A$(583,5),
6228 PRINT @(48,7+V0),A$(588,30),
6231 PRINT @(48,8+V0),A$(618,30),
6232 RETURN 
6233 PRINT @(59,8),FMP$(12,20),
6234 PRINT @(48,9+V0),A$(267,10),
6235 READ (Z[10],KEY="X"+A$(267,10),DOM=6237)FMP$
6236 PRINT @(59,9),FMP$(12,20),
6237 PRINT @(48,10+V0),A$(277,10),
6238 READ (Z[10],KEY="X"+A$(277,10),DOM=6240)FMP$
6239 PRINT @(59,10),FMP$(12,20),
6240 PRINT @(48,11+V0),A$(287,10),
6241 READ (Z[10],KEY="X"+A$(287,10),DOM=6243)FMP$
6242 PRINT @(59,11),FMP$(12,20),
6243 PRINT @(48,12+V0),A$(297,10),
6244 READ (Z[10],KEY="X"+A$(297,10),DOM=6246)FMP$
6245 PRINT @(59,12),FMP$(12,20),
6246 PRINT @(48,13+V0),A$(307,10),
6247 READ (Z[10],KEY="X"+A$(307,10),DOM=6249)FMP$
6248 PRINT @(59,13),FMP$(12,20),
6249 PRINT @(48,14+V0),A$(317,10),
6250 READ (Z[10],KEY="X"+A$(317,10),DOM=6252)FMP$
6251 PRINT @(59,14),FMP$(12,20),
6252 PRINT @(48,15+V0),A$(327,10),
6253 READ (Z[10],KEY="X"+A$(327,10),DOM=6255)FMP$
6254 PRINT @(59,15),FMP$(12,20),
6255 PRINT @(48,16+V0),A$(337,10),
6256 READ (Z[10],KEY="X"+A$(337,10),DOM=6258)FMP$
6257 PRINT @(59,16),FMP$(12,20),
6258 PRINT @(48,17+V0),A$(347,10),
6259 READ (Z[10],KEY="X"+A$(347,10),DOM=6261)FMP$
6260 PRINT @(59,17),FMP$(12,20),
6261 PRINT @(48,18+V0),A$(357,10),
6262 READ (Z[10],KEY="X"+A$(357,10),DOM=6264)FMP$
6263 PRINT @(59,18),FMP$(12,20),
6264 PRINT @(48,19+V0),A$(367,10),
6265 READ (Z[10],KEY="X"+A$(367,10),DOM=6267)FMP$
6266 PRINT @(59,19),FMP$(12,20),
6267 PRINT @(48,20+V0),A$(377,10),
6268 READ (Z[10],KEY="X"+A$(377,10),DOM=6270)FMP$
6269 PRINT @(59,20),FMP$(12,20),
6270 PRINT @(48,21),A$(387,1),
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6490 RETURN 
6500 REM "DELETE
6510 REMOVE (Z[1],KEY=A1$,DOM=6511)
6590 GOTO 1630
6600 REM "ALT KEY DATA READS
6690 RETURN 
6700 REM "ADD ENTRY
6705 IF Z9=0 THEN GOTO 6790
6710 WRITE (Z[1],KEY=A1$)IOL=0310
6790 GOTO 1630
6800 REM "NEXT ENTRY IN FILE
6810 A1$=KEY(Z[1],END=1140)
6820 A$(1,LEN(A1$))=A1$
6825 IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 1140
6830 GOSUB 6600
6835 GOSUB 6450
6890 Z9=0; GOTO 1515
6900 REM "GET DEFAULTS
6902 V9$="2103  6703  2105  6705  6707  6709  6710  6712  6713  6715  6716  6718  "
6910 IF V9>=0 THEN READ (Z[6],IND=V9)V9$,IOL=0310; GOTO 6930 ELSE V9=-1
6920 EXTRACT (Z[6],KEY=X0$+"DFLT",DOM=6921)V9$,IOL=0310; V9=IND(Z[6]); READ (Z[6])
6930 RETURN 
6950 REM "WRITE DEFAULT
6955 WRITE (Z[6],KEY=X0$+"DFLT")V9$,IOL=0310
6960 GOSUB 6920; GOTO 1630
6970 REM "ENTRY DEFAULTS
6975 PRINT 'CF'; V9=-2,Q$=""
6980 FOR X=1 TO LEN(V9$) STEP 6
6982 PRINT @(NUM(V9$(X,2)),NUM(V9$(X+2,2))),; IF V9=-2 THEN PRINT V9$(X+4,1), ELSE READ RECORD (0,SIZ=1)Q$; IF POS(Q$="1234Z")=0 THEN PRINT 'RB'; GOTO 6982
6990 IF Q$="Z" THEN EXITTO 6950 ELSE V9$(X+4,LEN(Q$))=Q$; NEXT X
6995 V9=0; GOTO 6980
7500 REM "CUSTOM PROGRAMMING ROUTINES
7525 REM "Modified stmts: 
7550 REM "Added stmts: 
7575 REM "Deleted stmts: 
7700 REM "
7710 WRITE (Z[1],KEY=K9$)IOL=0310
7795 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "OS2MPC"
9999 END 
20000 INIT:
20010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,-1,X1,X2; IF X1>0 THEN CMD_STR$="END"; GOSUB WRAP_UP; GOTO *RETURN
20020 DIM OSG$:"A000:C(6),A001:C(8),A002:C(4),A003:C(3),A004:C(1),A005:C(1),A006:C(2),A007:C(1),A008:C(30),A009:C(1),A010:C(10),A011:C(30),A012:C(60),A013:C(60),A014:C(1),A015:C(1),A016:C(1),A017:C(4),A018:C(1),A019:C(1),A020:C(10),A021:C(10),A022:C(10),A023:C(10),A024:C(10),A025:C(10),A026:C(10),A027:C(10),A028:C(10),A029:C(10),A030:C(10),A031:C(10),A032:C(10),A033:C(10),A034:C(10),A035:C(10),A036:C(1),A037:C(60),A038:C(1),A039:C(5),A040:C(1),A041:C(4),A042:C(1),A043:C(1),A044:C(60),A045:C(60),A046:C(1),A047:C(1),A048:C(5),A049:C(30),A050:C(30),A051:C(1),UNUSED:C(376)"
20021 DIM _CUR.OSG$:"A000:C(6),A001:C(8),A002:C(4),A003:C(3),A004:C(1),A005:C(1),A006:C(2),A007:C(1),A008:C(30),A009:C(1),A010:C(10),A011:C(30),A012:C(60),A013:C(60),A014:C(1),A015:C(1),A016:C(1),A017:C(4),A018:C(1),A019:C(1),A020:C(10),A021:C(10),A022:C(10),A023:C(10),A024:C(10),A025:C(10),A026:C(10),A027:C(10),A028:C(10),A029:C(10),A030:C(10),A031:C(10),A032:C(10),A033:C(10),A034:C(10),A035:C(10),A036:C(1),A037:C(60),A038:C(1),A039:C(5),A040:C(1),A041:C(4),A042:C(1),A043:C(1),A044:C(60),A045:C(60),A046:C(1),A047:C(1),A048:C(5),A049:C(30),A050:C(30),A051:C(1),UNUSED:C(376)"
20022 DIM _ORIG.OSG$:"A000:C(6),A001:C(8),A002:C(4),A003:C(3),A004:C(1),A005:C(1),A006:C(2),A007:C(1),A008:C(30),A009:C(1),A010:C(10),A011:C(30),A012:C(60),A013:C(60),A014:C(1),A015:C(1),A016:C(1),A017:C(4),A018:C(1),A019:C(1),A020:C(10),A021:C(10),A022:C(10),A023:C(10),A024:C(10),A025:C(10),A026:C(10),A027:C(10),A028:C(10),A029:C(10),A030:C(10),A031:C(10),A032:C(10),A033:C(10),A034:C(10),A035:C(10),A036:C(1),A037:C(60),A038:C(1),A039:C(5),A040:C(1),A041:C(4),A042:C(1),A043:C(1),A044:C(60),A045:C(60),A046:C(1),A047:C(1),A048:C(5),A049:C(30),A050:C(30),A051:C(1),UNUSED:C(376)"
20025 DIM Z[NUM(X3$(60,3))]
20030 OSG_IOL:IOLIST OSG$,OSGA001,OSGA002,OSGA003
20031 ORIG_OSG_IOL:IOLIST _ORIG.OSG$,_ORIG.OSGA001,_ORIG.OSGA002,_ORIG.OSGA003
20032 CUR_OSG_IOL:IOLIST _CUR.OSG$,_CUR.OSGA001,_CUR.OSGA002,_CUR.OSGA003
20060 CALL "ZZ2PRP","OS",RESULT$,DATE$; IF RESULT$<>"Y" THEN MSGBOX "","TOPS Module is not installed"; CMD_STR$="END"; GOSUB WRAP_UP; GOTO *RETURN
20090 Z$="01X ZZPARM  06O ZZPARM  15O AP4...  10O FMP...  "
20100 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
20290 RETURN 
20300 WRAP_UP:
20310 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
20490 RETURN 
20500 READ_REC:
20510 PARM_KEY$=%C$+"OSP",KEY_SIZE=LEN(PARM_KEY$)
20530 OSG$(1,KEY_SIZE)=PARM_KEY$
20540 READ (Z[1],KEY=PARM_KEY$,DOM=*NEXT)IOL=OSG_IOL
20545 READ DATA FROM REC(IOL=OSG_IOL) TO IOL=ORIG_OSG_IOL
20550 IF OSG.A006$="FP" THEN BO_DISP$="F" ELSE IF OSG.A006$="TM" THEN BO_DISP$="T" ELSE BO_DISP$=" "
20560 REFRESH_FLG=1
20570 GOSUB GET_DESC
20690 RETURN 
20700 GET_DESC:
20705 DIM FMP$(100)
20710 FMPKEY$="X"+OSG.A020$; GOSUB READ_FMP; A020DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A020.CTL; OSG.A020$=DIM(10)
20712 FMPKEY$="X"+OSG.A021$; GOSUB READ_FMP; A021DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A021.CTL; OSG.A021$=DIM(10)
20714 FMPKEY$="X"+OSG.A022$; GOSUB READ_FMP; A022DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A022.CTL; OSG.A022$=DIM(10)
20716 FMPKEY$="X"+OSG.A023$; GOSUB READ_FMP; A023DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A023.CTL; OSG.A024$=DIM(10); OSG.A023$=DIM(10)
20718 FMPKEY$="X"+OSG.A024$; GOSUB READ_FMP; A024DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A024.CTL; OSG.A024$=DIM(10)
20720 FMPKEY$="X"+OSG.A025$; GOSUB READ_FMP; A025DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A025.CTL; OSG.A025$=DIM(10)
20722 FMPKEY$="X"+OSG.A026$; GOSUB READ_FMP; A026DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A026.CTL; OSG.A026$=DIM(10)
20724 FMPKEY$="X"+OSG.A027$; GOSUB READ_FMP; A027DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A027.CTL; OSG.A027$=DIM(10)
20726 FMPKEY$="X"+OSG.A028$; GOSUB READ_FMP; A028DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A028.CTL; OSG.A028$=DIM(10)
20728 FMPKEY$="X"+OSG.A029$; GOSUB READ_FMP; A029DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A029.CTL; OSG.A030$=DIM(10); OSG.A029$=DIM(10)
20730 FMPKEY$="X"+OSG.A030$; GOSUB READ_FMP; A030DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A030.CTL; OSG.A030$=DIM(10)
20732 FMPKEY$="X"+OSG.A031$; GOSUB READ_FMP; A031DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A031.CTL; OSG.A031$=DIM(10)
20734 FMPKEY$="X"+OSG.A032$; GOSUB READ_FMP; A032DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A032.CTL; OSG.A032$=DIM(10)
20736 FMPKEY$="X"+OSG.A033$; GOSUB READ_FMP; A033DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A032.CTL; OSG.A033$=DIM(10)
20738 FMPKEY$="X"+OSG.A034$; GOSUB READ_FMP; A034DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A034.CTL; OSG.A034$=DIM(10)
20740 FMPKEY$="X"+OSG.A035$; GOSUB READ_FMP; A035DESC$=MID(FMP$,12,30); IF MID(FMP$,61,1)<>"Y" THEN NEXT_ID=OSG.A035.CTL; OSG.A035$=DIM(10)
20745 REFRESH_FLG=1
20749 RETURN 
20750 READ_FMP:
20752 DIM FMP$(100); IF FMPKEY$="X"+DIM(10) THEN FMP$(61,1)="Y"; GOTO *RETURN
20755 READ (Z[10],KEY=FMPKEY$,ERR=*NEXT)FMP$
20760 IF MID(FMP$,61,1)<>"Y" THEN MSGBOX MSG("OSG_SPEC_C"),""
20770 RETURN 
21170 ! 300 - Set up the message library
21180 SETUP_LIBRARY:
21190 _SV_MSGLIB$=MSG(*)
21200 _LANG$=LCS(%NOMAD_DEF_SFX$); IF _LANG$="" THEN _LANG$=LCS(ENV("PVXLANG")); IF _LANG$="" THEN _LANG$=LCS(ENV("LANG")); IF _LANG$="" THEN _LANG$="en"
21210 MESSAGE_LIB "*tfmsglib."+_LANG$,ERR=*NEXT; GOTO 21230
21220 MESSAGE_LIB "*tfmsglib.en"
21230 SET_MSG:GOSUB SETUP_MESSAGES
21240 RETURN 
22300 WRITE_REC:
22352 IF BO_DISP$="F" THEN OSG.A006$="FP" ELSE IF BO_DISP$="T" THEN OSG.A006$="TM" ELSE OSG.A006$=DIM(2)
22360 _CHG1$="",_CHG2$=""
22370 READ (Z[1],KEY=PARM_KEY$,DOM=*NEXT)IOL=CUR_OSG_IOL
22380 GOSUB DETERMINE_CHGS
22390 IF _CHG1$="" AND _CHG2$="" THEN GOTO WRT
22400 IF _CHG1$="" THEN GOTO CHK2
22410 MSGBOX _MSG_UPD_SAME$+SEP+_CHG1$+SEP+SEP+_MSG_OVRWRT_CHG$,_MSG_WARNING$,"Yesno,1,!",_YESNO$
22420 IF _YESNO$="NO" THEN GOTO *RETURN
22430 IF _CHG2$="" THEN GOTO WRT
22440 CHK2:IF _CHG2$<>"" THEN MSGBOX _MSG_UPD_OTHER1$+SEP+_CHG2$+SEP+SEP+_MSG_UPD_OTHER2$,_FYI$,"!"
22450 GOSUB INCORPORATE_CHGS
22460 WRT:WRITE (Z[1],KEY=PARM_KEY$,ERR=WRITE_ERROR)IOL=OSG_IOL
22500 REFRESH_FLG=1
22510 RETURN 
22520 WRITE_ERROR:
22530 IF ERR=11 THEN MSGBOX _MSG_DUP_UNIQUE$,_MSG_CANNOT_WRITE$ ELSE MSGBOX MSG(ERR),_MSG_CANNOT_WRITE$
22540 RETURN 
22810 SETUP_MESSAGES:
22820 _FYI$=MSG("FYI"),_ERROR$=MSG("ERROR")
22830 _MSG_DIRECTORY$=MSG("DIRECTORY")
22840 _MSG_END_OF_FIL$=MSG("END_OF_FIL")
22850 _MSG_FILOPNERR1$=MSG("FILOPNERR1")
22860 _MSG_JUST_CHECK$=MSG("JUST_CHECK")
22870 _MSG_MANDATORY$=MSG("MANDATORY")
22880 _MSG_NEXT$=MSG("NEXT")
22890 _MSG_NON_NUMER$=MSG("NON_NUMER")
22900 _MSG_NOT_FOUND$=MSG("NOT_FOUND")
22910 _MSG_OVRWRT_CHG$=MSG("OVRWRT_CHG")
22920 _MSG_PRECEDING$=MSG("PRECEDING")
22930 _MSG_PREFIX$=MSG("PREFIX")
22940 _MSG_REC_ACCESS$=MSG("REC_ACCESS")
22950 _MSG_REC_ALTERD$=MSG("REC_ALTERD")
22960 _MSG_REC_CR_NEW$=MSG("REC_CR_NEW")
22970 _MSG_REC_LOCKED$=MSG("REC_LOCKED")
22980 _MSG_X$=MSG("REC_MISS","^"),P=POS("^"=_MSG_X$),_MSG_REC_MISS1$=_MSG_X$(1,P-1),_MSG_REC_MISS2$=_MSG_X$(P+1)
22990 _MSG_REC_NOTFND$=MSG("REC_NOTFND")
23000 _MSG_REC_NO_1ST$=MSG("REC_NO_1ST")
23010 _MSG_REC_NO_LST$=MSG("REC_NO_LST")
23020 _MSG_REC_REMOVE$=MSG("REC_REMOVE")
23030 _MSG_REC_UPDADD$=MSG("REC_UPDADD")
23040 _MSG_X$=MSG("REC_VFYDEL","^"),P=POS("^"=_MSG_X$),_MSG_REC_VFYDEL1$=_MSG_X$(1,P-1),_MSG_REC_VFYDEL2$=_MSG_X$(P+1)
23050 _MSG_X$=MSG("REC_VIEW","^"),P=POS("^"=_MSG_X$),_MSG_REC_VIEW1$=_MSG_X$(1,P-1),_MSG_REC_VIEW2$=_MSG_X$(P+1)
23060 _MSG_REQ_FIELDS$=MSG("REQ_FIELDS")
23070 _MSG_START_FILE$=MSG("START_FILE")
23080 _MSG_UPDATE$=MSG("UPDATE")
23090 _MSG_UPD_OTHER1$=MSG("UPD_OTHER1")
23100 _MSG_UPD_OTHER2$=MSG("UPD_OTHER2")
23110 _MSG_UPD_SAME$=MSG("UPD_SAME")
23120 _MSG_WARNING$=MSG("WARNING")
23130 _MSG_CANNOT_WRITE$=MSG("CANT_WRITE")
23140 _MSG_DUP_UNIQUE$=MSG("DUP_UNIQUE")
23150 RETURN 
23350 ! 13000 - Clear the record fields
23900 DETERMINE_CHGS:
23940 DIM _CHG_VAR$(52,"N")
23950 IF _ORIG.OSG.A000$=_CUR.OSG.A000$ OR OSG.A000$=_CUR.OSG.A000$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A000$=OSG.A000$ THEN _CHG2$=_CHG2$+SEP+"OSG.A000 = "+_CUR.OSG.A000$,_CHG_VAR$(1,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A000 = "+_CUR.OSG.A000$
23960 IF _ORIG.OSG.A001$=_CUR.OSG.A001$ OR OSG.A001$=_CUR.OSG.A001$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A001$=OSG.A001$ THEN _CHG2$=_CHG2$+SEP+"OSG.A001 = "+_CUR.OSG.A001$,_CHG_VAR$(2,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A001 = "+_CUR.OSG.A001$
23970 IF _ORIG.OSG.A002$=_CUR.OSG.A002$ OR OSG.A002$=_CUR.OSG.A002$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A002$=OSG.A002$ THEN _CHG2$=_CHG2$+SEP+"OSG.A002 = "+_CUR.OSG.A002$,_CHG_VAR$(3,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A002 = "+_CUR.OSG.A002$
23980 IF _ORIG.OSG.A003$=_CUR.OSG.A003$ OR OSG.A003$=_CUR.OSG.A003$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A003$=OSG.A003$ THEN _CHG2$=_CHG2$+SEP+"OSG.A003 = "+_CUR.OSG.A003$,_CHG_VAR$(4,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A003 = "+_CUR.OSG.A003$
23990 IF _ORIG.OSG.A004$=_CUR.OSG.A004$ OR OSG.A004$=_CUR.OSG.A004$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A004$=OSG.A004$ THEN _CHG2$=_CHG2$+SEP+"OSG.A004 = "+_CUR.OSG.A004$,_CHG_VAR$(5,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A004 = "+_CUR.OSG.A004$
24000 IF _ORIG.OSG.A005$=_CUR.OSG.A005$ OR OSG.A005$=_CUR.OSG.A005$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A005$=OSG.A005$ THEN _CHG2$=_CHG2$+SEP+"OSG.A005 = "+_CUR.OSG.A005$,_CHG_VAR$(6,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A005 = "+_CUR.OSG.A005$
24010 IF _ORIG.OSG.A006$=_CUR.OSG.A006$ OR OSG.A006$=_CUR.OSG.A006$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A006$=OSG.A006$ THEN _CHG2$=_CHG2$+SEP+"OSG.A006 = "+_CUR.OSG.A006$,_CHG_VAR$(7,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A006 = "+_CUR.OSG.A006$
24020 IF _ORIG.OSG.A007$=_CUR.OSG.A007$ OR OSG.A007$=_CUR.OSG.A007$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A007$=OSG.A007$ THEN _CHG2$=_CHG2$+SEP+"OSG.A007 = "+_CUR.OSG.A007$,_CHG_VAR$(8,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A007 = "+_CUR.OSG.A007$
24030 IF _ORIG.OSG.A008$=_CUR.OSG.A008$ OR OSG.A008$=_CUR.OSG.A008$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A008$=OSG.A008$ THEN _CHG2$=_CHG2$+SEP+"OSG.A008 = "+_CUR.OSG.A008$,_CHG_VAR$(9,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A008 = "+_CUR.OSG.A008$
24040 IF _ORIG.OSG.A009$=_CUR.OSG.A009$ OR OSG.A009$=_CUR.OSG.A009$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A009$=OSG.A009$ THEN _CHG2$=_CHG2$+SEP+"OSG.A009 = "+_CUR.OSG.A009$,_CHG_VAR$(10,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A009 = "+_CUR.OSG.A009$
24050 IF _ORIG.OSG.A010$=_CUR.OSG.A010$ OR OSG.A010$=_CUR.OSG.A010$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A010$=OSG.A010$ THEN _CHG2$=_CHG2$+SEP+"OSG.A10 = "+_CUR.OSG.A010$,_CHG_VAR$(11,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A10 = "+_CUR.OSG.A010$
24060 IF _ORIG.OSG.A011$=_CUR.OSG.A011$ OR OSG.A011$=_CUR.OSG.A011$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A011$=OSG.A011$ THEN _CHG2$=_CHG2$+SEP+"OSG.A011 = "+_CUR.OSG.A011$,_CHG_VAR$(12,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A011 = "+_CUR.OSG.A011$
24070 IF _ORIG.OSG.A012$=_CUR.OSG.A012$ OR OSG.A012$=_CUR.OSG.A012$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A012$=OSG.A012$ THEN _CHG2$=_CHG2$+SEP+"OSG.A012 = "+_CUR.OSG.A012$,_CHG_VAR$(13,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A012 = "+_CUR.OSG.A012$
24080 IF _ORIG.OSG.A013$=_CUR.OSG.A013$ OR OSG.A013$=_CUR.OSG.A013$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A013$=OSG.A013$ THEN _CHG2$=_CHG2$+SEP+"OSG.A013 = "+_CUR.OSG.A013$,_CHG_VAR$(14,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A013 = "+_CUR.OSG.A013$
24090 IF _ORIG.OSG.A014$=_CUR.OSG.A014$ OR OSG.A014$=_CUR.OSG.A014$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A014$=OSG.A014$ THEN _CHG2$=_CHG2$+SEP+"OSG.A014 = "+_CUR.OSG.A014$,_CHG_VAR$(15,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A014 = "+_CUR.OSG.A014$
24100 IF _ORIG.OSG.A015$=_CUR.OSG.A015$ OR OSG.A015$=_CUR.OSG.A015$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A015$=OSG.A015$ THEN _CHG2$=_CHG2$+SEP+"OSG.A015 = "+_CUR.OSG.A015$,_CHG_VAR$(16,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A015 = "+_CUR.OSG.A015$
24110 IF _ORIG.OSG.A016$=_CUR.OSG.A016$ OR OSG.A016$=_CUR.OSG.A016$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A016$=OSG.A016$ THEN _CHG2$=_CHG2$+SEP+"OSG.A016 = "+_CUR.OSG.A016$,_CHG_VAR$(17,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A016 = "+_CUR.OSG.A016$
24120 IF _ORIG.OSG.A017$=_CUR.OSG.A017$ OR OSG.A017$=_CUR.OSG.A017$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A017$=OSG.A017$ THEN _CHG2$=_CHG2$+SEP+"OSG.A017 = "+_CUR.OSG.A017$,_CHG_VAR$(18,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A017 = "+_CUR.OSG.A017$
24130 IF _ORIG.OSG.A018$=_CUR.OSG.A018$ OR OSG.A018$=_CUR.OSG.A018$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A018$=OSG.A018$ THEN _CHG2$=_CHG2$+SEP+"OSG.A018 = "+_CUR.OSG.A018$,_CHG_VAR$(19,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A018 = "+_CUR.OSG.A018$
24140 IF _ORIG.OSG.A019$=_CUR.OSG.A019$ OR OSG.A019$=_CUR.OSG.A019$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A019$=OSG.A019$ THEN _CHG2$=_CHG2$+SEP+"OSG.A019 = "+_CUR.OSG.A019$,_CHG_VAR$(20,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A019 = "+_CUR.OSG.A019$
24150 IF _ORIG.OSG.A020$=_CUR.OSG.A020$ OR OSG.A020$=_CUR.OSG.A020$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A020$=OSG.A020$ THEN _CHG2$=_CHG2$+SEP+"OSG.A020 = "+_CUR.OSG.A020$,_CHG_VAR$(21,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A020 = "+_CUR.OSG.A020$
24160 IF _ORIG.OSG.A021$=_CUR.OSG.A021$ OR OSG.A021$=_CUR.OSG.A021$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A021$=OSG.A021$ THEN _CHG2$=_CHG2$+SEP+"OSG.A021 = "+_CUR.OSG.A021$,_CHG_VAR$(22,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A021 = "+_CUR.OSG.A021$
24170 IF _ORIG.OSG.A022$=_CUR.OSG.A022$ OR OSG.A022$=_CUR.OSG.A022$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A022$=OSG.A022$ THEN _CHG2$=_CHG2$+SEP+"OSG.A022 = "+_CUR.OSG.A022$,_CHG_VAR$(23,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A022 = "+_CUR.OSG.A022$
24180 IF _ORIG.OSG.A023$=_CUR.OSG.A023$ OR OSG.A023$=_CUR.OSG.A023$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A023$=OSG.A023$ THEN _CHG2$=_CHG2$+SEP+"OSG.A023 = "+_CUR.OSG.A023$,_CHG_VAR$(24,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A023 = "+_CUR.OSG.A023$
24190 IF _ORIG.OSG.A024$=_CUR.OSG.A024$ OR OSG.A024$=_CUR.OSG.A024$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A024$=OSG.A024$ THEN _CHG2$=_CHG2$+SEP+"OSG.A024 = "+_CUR.OSG.A024$,_CHG_VAR$(25,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A024 = "+_CUR.OSG.A024$
24200 IF _ORIG.OSG.A025$=_CUR.OSG.A025$ OR OSG.A025$=_CUR.OSG.A025$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A025$=OSG.A025$ THEN _CHG2$=_CHG2$+SEP+"OSG.A025 = "+_CUR.OSG.A025$,_CHG_VAR$(26,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A025 = "+_CUR.OSG.A025$
24210 IF _ORIG.OSG.A026$=_CUR.OSG.A026$ OR OSG.A026$=_CUR.OSG.A026$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A026$=OSG.A026$ THEN _CHG2$=_CHG2$+SEP+"OSG.A026 = "+_CUR.OSG.A026$,_CHG_VAR$(27,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A026 = "+_CUR.OSG.A026$
24220 IF _ORIG.OSG.A027$=_CUR.OSG.A027$ OR OSG.A027$=_CUR.OSG.A027$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A027$=OSG.A027$ THEN _CHG2$=_CHG2$+SEP+"OSG.A027 = "+_CUR.OSG.A027$,_CHG_VAR$(28,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A027 = "+_CUR.OSG.A027$
24230 IF _ORIG.OSG.A028$=_CUR.OSG.A028$ OR OSG.A028$=_CUR.OSG.A028$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A028$=OSG.A028$ THEN _CHG2$=_CHG2$+SEP+"OSG.A028 = "+_CUR.OSG.A028$,_CHG_VAR$(29,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A028 = "+_CUR.OSG.A028$
24240 IF _ORIG.OSG.A029$=_CUR.OSG.A029$ OR OSG.A029$=_CUR.OSG.A029$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A029$=OSG.A029$ THEN _CHG2$=_CHG2$+SEP+"OSG.A029 = "+_CUR.OSG.A029$,_CHG_VAR$(30,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A029 = "+_CUR.OSG.A029$
24250 IF _ORIG.OSG.A030$=_CUR.OSG.A030$ OR OSG.A030$=_CUR.OSG.A030$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A030$=OSG.A030$ THEN _CHG2$=_CHG2$+SEP+"OSG.A030 = "+_CUR.OSG.A030$,_CHG_VAR$(31,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A030 = "+_CUR.OSG.A030$
24260 IF _ORIG.OSG.A031$=_CUR.OSG.A031$ OR OSG.A031$=_CUR.OSG.A031$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A031$=OSG.A031$ THEN _CHG2$=_CHG2$+SEP+"OSG.A031 = "+_CUR.OSG.A031$,_CHG_VAR$(32,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A031 = "+_CUR.OSG.A031$
24270 IF _ORIG.OSG.A032$=_CUR.OSG.A032$ OR OSG.A032$=_CUR.OSG.A032$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A032$=OSG.A032$ THEN _CHG2$=_CHG2$+SEP+"OSG.A032 = "+_CUR.OSG.A032$,_CHG_VAR$(33,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A032 = "+_CUR.OSG.A032$
24280 IF _ORIG.OSG.A033$=_CUR.OSG.A033$ OR OSG.A033$=_CUR.OSG.A033$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A033$=OSG.A033$ THEN _CHG2$=_CHG2$+SEP+"OSG.A033 = "+_CUR.OSG.A033$,_CHG_VAR$(34,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A033 = "+_CUR.OSG.A033$
24290 IF _ORIG.OSG.A034$=_CUR.OSG.A034$ OR OSG.A034$=_CUR.OSG.A034$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A034$=OSG.A034$ THEN _CHG2$=_CHG2$+SEP+"OSG.A034 = "+_CUR.OSG.A034$,_CHG_VAR$(35,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A034 = "+_CUR.OSG.A034$
24300 IF _ORIG.OSG.A035$=_CUR.OSG.A035$ OR OSG.A035$=_CUR.OSG.A035$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A035$=OSG.A035$ THEN _CHG2$=_CHG2$+SEP+"OSG.A035 = "+_CUR.OSG.A035$,_CHG_VAR$(36,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A035 = "+_CUR.OSG.A035$
24310 IF _ORIG.OSG.A036$=_CUR.OSG.A036$ OR OSG.A036$=_CUR.OSG.A036$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A036$=OSG.A036$ THEN _CHG2$=_CHG2$+SEP+"OSG.A036 = "+_CUR.OSG.A036$,_CHG_VAR$(37,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A036 = "+_CUR.OSG.A036$
24320 IF _ORIG.OSG.A037$=_CUR.OSG.A037$ OR OSG.A037$=_CUR.OSG.A037$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A037$=OSG.A037$ THEN _CHG2$=_CHG2$+SEP+"OSG.A037 = "+_CUR.OSG.A037$,_CHG_VAR$(38,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A037 = "+_CUR.OSG.A037$
24330 IF _ORIG.OSG.A038$=_CUR.OSG.A038$ OR OSG.A038$=_CUR.OSG.A038$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A038$=OSG.A038$ THEN _CHG2$=_CHG2$+SEP+"OSG.A038 = "+_CUR.OSG.A038$,_CHG_VAR$(39,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A038 = "+_CUR.OSG.A038$
24340 IF _ORIG.OSG.A039$=_CUR.OSG.A039$ OR OSG.A039$=_CUR.OSG.A039$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A039$=OSG.A039$ THEN _CHG2$=_CHG2$+SEP+"OSG.A039 = "+_CUR.OSG.A039$,_CHG_VAR$(40,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A039 = "+_CUR.OSG.A039$
24350 IF _ORIG.OSG.A040$=_CUR.OSG.A040$ OR OSG.A040$=_CUR.OSG.A040$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A040$=OSG.A040$ THEN _CHG2$=_CHG2$+SEP+"OSG.A040 = "+_CUR.OSG.A040$,_CHG_VAR$(41,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A040 = "+_CUR.OSG.A040$
24360 IF _ORIG.OSG.A041$=_CUR.OSG.A041$ OR OSG.A041$=_CUR.OSG.A041$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A041$=OSG.A041$ THEN _CHG2$=_CHG2$+SEP+"OSG.A041 = "+_CUR.OSG.A041$,_CHG_VAR$(42,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A041 = "+_CUR.OSG.A041$
24370 IF _ORIG.OSG.A042$=_CUR.OSG.A042$ OR OSG.A042$=_CUR.OSG.A042$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A042$=OSG.A042$ THEN _CHG2$=_CHG2$+SEP+"OSG.A042 = "+_CUR.OSG.A042$,_CHG_VAR$(43,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A042 = "+_CUR.OSG.A042$
24380 IF _ORIG.OSGA001=_CUR.OSGA001 OR OSGA001=_CUR.OSGA001 THEN GOTO *NEXT ELSE IF _ORIG.OSGA001=OSGA001 THEN _CHG2$=_CHG2$+SEP+"OSGA001 = "+STR(_CUR.OSGA001),_CHG_VAR$(44,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSGA001 = "+STR(_CUR.OSGA001)
24390 IF _ORIG.OSGA002=_CUR.OSGA002 OR OSGA002=_CUR.OSGA002 THEN GOTO *NEXT ELSE IF _ORIG.OSGA002=OSGA002 THEN _CHG2$=_CHG2$+SEP+"OSGA002 = "+STR(_CUR.OSGA002),_CHG_VAR$(45,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSGA002 = "+STR(_CUR.OSGA002)
24400 IF _ORIG.OSGA003=_CUR.OSGA003 OR OSGA003=_CUR.OSGA003 THEN GOTO *NEXT ELSE IF _ORIG.OSGA003=OSGA003 THEN _CHG2$=_CHG2$+SEP+"OSGA003 = "+STR(_CUR.OSGA003),_CHG_VAR$(46,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSGA003 = "+STR(_CUR.OSGA003)
24401 IF _ORIG.OSG.A043$=_CUR.OSG.A043$ OR OSG.A043$=_CUR.OSG.A043$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A043$=OSG.A043$ THEN _CHG2$=_CHG2$+SEP+"OSG.A043 = "+_CUR.OSG.A043$,_CHG_VAR$(47,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A043 = "+_CUR.OSG.A043$
24402 IF _ORIG.OSG.A044$=_CUR.OSG.A044$ OR OSG.A044$=_CUR.OSG.A044$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A044$=OSG.A044$ THEN _CHG2$=_CHG2$+SEP+"OSG.A044 = "+_CUR.OSG.A044$,_CHG_VAR$(48,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A044 = "+_CUR.OSG.A044$
24403 IF _ORIG.OSG.A045$=_CUR.OSG.A045$ OR OSG.A045$=_CUR.OSG.A045$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A045$=OSG.A045$ THEN _CHG2$=_CHG2$+SEP+"OSG.A045 = "+_CUR.OSG.A045$,_CHG_VAR$(49,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A045 = "+_CUR.OSG.A045$
24404 IF _ORIG.OSG.A048$=_CUR.OSG.A048$ OR OSG.A048$=_CUR.OSG.A048$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A048$=OSG.A048$ THEN _CHG2$=_CHG2$+SEP+"OSG.A048 = "+_CUR.OSG.A048$,_CHG_VAR$(50,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A048 = "+_CUR.OSG.A048$
24405 IF _ORIG.OSG.A049$=_CUR.OSG.A049$ OR OSG.A049$=_CUR.OSG.A049$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A049$=OSG.A049$ THEN _CHG2$=_CHG2$+SEP+"OSG.A049 = "+_CUR.OSG.A049$,_CHG_VAR$(51,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A049 = "+_CUR.OSG.A049$
24406 IF _ORIG.OSG.A050$=_CUR.OSG.A050$ OR OSG.A050$=_CUR.OSG.A050$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A050$=OSG.A050$ THEN _CHG2$=_CHG2$+SEP+"OSG.A050 = "+_CUR.OSG.A050$,_CHG_VAR$(52,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A050 = "+_CUR.OSG.A050$
24410 RETURN 
24420 ! 16000 - Incorporate changes made by another user into the record
24430 INCORPORATE_CHGS:
24440 IF _CHG_VAR$(1,1)="Y" THEN OSG.A000$=_CUR.OSG.A000$
24450 IF _CHG_VAR$(2,1)="Y" THEN OSG.A001$=_CUR.OSG.A001$
24460 IF _CHG_VAR$(3,1)="Y" THEN OSG.A002$=_CUR.OSG.A002$
24470 IF _CHG_VAR$(4,1)="Y" THEN OSG.A003$=_CUR.OSG.A003$
24480 IF _CHG_VAR$(5,1)="Y" THEN OSG.A004$=_CUR.OSG.A004$
24490 IF _CHG_VAR$(6,1)="Y" THEN OSG.A005$=_CUR.OSG.A005$
24500 IF _CHG_VAR$(7,1)="Y" THEN OSG.A006$=_CUR.OSG.A006$
24510 IF _CHG_VAR$(8,1)="Y" THEN OSG.A007$=_CUR.OSG.A007$
24520 IF _CHG_VAR$(9,1)="Y" THEN OSG.A008$=_CUR.OSG.A008$
24530 IF _CHG_VAR$(10,1)="Y" THEN OSG.A009$=_CUR.OSG.A009$
24540 IF _CHG_VAR$(11,1)="Y" THEN OSG.A010$=_CUR.OSG.A010$
24550 IF _CHG_VAR$(12,1)="Y" THEN OSG.A011$=_CUR.OSG.A011$
24560 IF _CHG_VAR$(13,1)="Y" THEN OSG.A012$=_CUR.OSG.A012$
24570 IF _CHG_VAR$(14,1)="Y" THEN OSG.A013$=_CUR.OSG.A013$
24580 IF _CHG_VAR$(15,1)="Y" THEN OSG.A014$=_CUR.OSG.A014$
24590 IF _CHG_VAR$(16,1)="Y" THEN OSG.A015$=_CUR.OSG.A015$
24600 IF _CHG_VAR$(17,1)="Y" THEN OSG.A016$=_CUR.OSG.A016$
24610 IF _CHG_VAR$(18,1)="Y" THEN OSG.A017$=_CUR.OSG.A017$
24620 IF _CHG_VAR$(19,1)="Y" THEN OSG.A018$=_CUR.OSG.A018$
24630 IF _CHG_VAR$(20,1)="Y" THEN OSG.A019$=_CUR.OSG.A019$
24640 IF _CHG_VAR$(21,1)="Y" THEN OSG.A020$=_CUR.OSG.A020$
24650 IF _CHG_VAR$(22,1)="Y" THEN OSG.A021$=_CUR.OSG.A021$
24660 IF _CHG_VAR$(23,1)="Y" THEN OSG.A022$=_CUR.OSG.A022$
24670 IF _CHG_VAR$(24,1)="Y" THEN OSG.A023$=_CUR.OSG.A023$
24680 IF _CHG_VAR$(25,1)="Y" THEN OSG.A024$=_CUR.OSG.A024$
24690 IF _CHG_VAR$(26,1)="Y" THEN OSG.A025$=_CUR.OSG.A025$
24700 IF _CHG_VAR$(27,1)="Y" THEN OSG.A026$=_CUR.OSG.A026$
24710 IF _CHG_VAR$(28,1)="Y" THEN OSG.A027$=_CUR.OSG.A027$
24720 IF _CHG_VAR$(29,1)="Y" THEN OSG.A028$=_CUR.OSG.A028$
24730 IF _CHG_VAR$(30,1)="Y" THEN OSG.A029$=_CUR.OSG.A029$
24740 IF _CHG_VAR$(31,1)="Y" THEN OSG.A030$=_CUR.OSG.A030$
24750 IF _CHG_VAR$(32,1)="Y" THEN OSG.A031$=_CUR.OSG.A031$
24760 IF _CHG_VAR$(33,1)="Y" THEN OSG.A032$=_CUR.OSG.A032$
24770 IF _CHG_VAR$(34,1)="Y" THEN OSG.A033$=_CUR.OSG.A033$
24780 IF _CHG_VAR$(35,1)="Y" THEN OSG.A034$=_CUR.OSG.A034$
24790 IF _CHG_VAR$(36,1)="Y" THEN OSG.A035$=_CUR.OSG.A035$
24800 IF _CHG_VAR$(37,1)="Y" THEN OSG.A036$=_CUR.OSG.A036$
24810 IF _CHG_VAR$(38,1)="Y" THEN OSG.A037$=_CUR.OSG.A037$
24820 IF _CHG_VAR$(39,1)="Y" THEN OSG.A038$=_CUR.OSG.A038$
24830 IF _CHG_VAR$(40,1)="Y" THEN OSG.A039$=_CUR.OSG.A039$
24840 IF _CHG_VAR$(41,1)="Y" THEN OSG.A040$=_CUR.OSG.A040$
24850 IF _CHG_VAR$(42,1)="Y" THEN OSG.A041$=_CUR.OSG.A041$
24860 IF _CHG_VAR$(43,1)="Y" THEN OSG.A042$=_CUR.OSG.A042$
24870 IF _CHG_VAR$(44,1)="Y" THEN OSGA001=_CUR.OSGA001
24880 IF _CHG_VAR$(45,1)="Y" THEN OSGA002=_CUR.OSGA002
24890 IF _CHG_VAR$(46,1)="Y" THEN OSGA003=_CUR.OSGA003
24891 IF _CHG_VAR$(47,1)="Y" THEN OSG.A043$=_CUR.OSG.A043$
24892 IF _CHG_VAR$(48,1)="Y" THEN OSG.A044$=_CUR.OSG.A044$
24893 IF _CHG_VAR$(49,1)="Y" THEN OSG.A045$=_CUR.OSG.A045$
24894 IF _CHG_VAR$(50,1)="Y" THEN OSG.A048$=_CUR.OSG.A048$
24895 IF _CHG_VAR$(51,1)="Y" THEN OSG.A049$=_CUR.OSG.A049$
24896 IF _CHG_VAR$(52,1)="Y" THEN OSG.A050$=_CUR.OSG.A050$
24900 RETURN 
56000 REM "203458-Addition of S.P. Richards to TOPS module                    
56002 REM "225094-OSP parameter file layout missing fields, reused one for
