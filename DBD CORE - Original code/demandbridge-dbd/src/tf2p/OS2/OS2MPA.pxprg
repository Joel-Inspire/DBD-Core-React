0010 REM "<OS2MPA> Office Supply Parameter Setup
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 03/18/10 - 11.413611 - jvv - SSP# 237030
0037 REM "237030-O/S System parameter to trigger customer's finders fee when 
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0045 ! THIS PROGRAM WILL NO LONGER BE MODIFIED for CHUI. THE GUI PANEL WILL BE PROCESSED FROM HERE. ALL FUTURE CHANGES NEED TO BE MADE IN FSGMCA PANEL AND THIS  PROGRAM -LINES 10000 onwards. (RE WO 237030)
0046 ! ********************************************************************
0050 IF TCB(88)=0 THEN MSGBOX "You must be using Windx to access this program" ELSE PROCESS "OSGMPA","../OSG/OS.EN" ! WO237030
0055 IF TCB(13)=1 THEN RUN "ZMENU" ELSE EXIT ! WO237030
0060 EXIT ! WO237030
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="OS2MPA",X1$="OSS Parameter Setup"
0120 DIM Z0$(80,"-")
0135 C9=-1,V9=-2
0140 Z2$="000000",Z3$="00000"
0150 VDN$="UUnited Stationers  CS.P.Richards(CAN)  SS.P.Richards(USA)  "
0170 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
0175 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0290 K9$=X3$(9,3)+"OSP",K9=LEN(K9$)
0295 DIM Z0$(80,X3$(235,1)); Z0$=ESC+"BG"+Z0$+ESC+"EG"
0299 CALL "ZZ2PRP","OS",RESULT$,DATE$; IF RESULT$<>"Y" THEN CALL "ZZPROM",".4",X3$,Z,"ACCESS DENIED! The Office Supply Interface System is not an in stalled module.","","",0; RUN "ZMENU"
0300 REM "IOLISTS
0310 IOLIST A$(1,LEN(A$)),A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9]
0330 IOLIST VENDOR$
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X ZZPARM  06O ZZPARM  15O AP4...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0600 REM "
0620 GOSUB 6000
1000 REM "
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1035 DIM A$(1024),A[9]
1040 REM IF V9<>-1 THEN GOSUB 6900; REM "DON'T SET DEFAULTS ***********
1045 A$(1,0+K9)=K9$+A1$
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1500
1200 REM "
1215 IF C0<0 THEN GOTO 9900
1500 REM "
1505 Z9=-1
1510 A1$=K9$
1520 READ (Z[1],KEY=A1$,DOM=1600)IOL=0310
1521 IF A$(57,1)=" " THEN A$(57,1)="S"; REM SSP 191385
1522 IF A$(218,1)=" " THEN A$(218,1)="U"
1525 Z9=0
1590 GOTO 1700
1600 REM "
1610 GOSUB 7700; GOTO 1500
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630; REM ,6975 DON'T SET DEFAULTS
1630 GOTO 9900
1660 IF V9>=0 THEN GOSUB 6200
1690 GOTO 2000
1700 REM "
1790 GOSUB 6200
1800 REM "
1820 CALL "ZZPROM","P",X3$,Z,"","","",X0; ON Z GOTO 1850,6700
1830 GOTO 2000
1850 REM "MODIFY
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE IF Z9=0 THEN Z9=1
1860 EXTRACT (Z[1],KEY=A1$,DOM=1870)IOL=0310
1865 C9=1
1870 GOSUB 6200
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF C0>3 OR X0<0 THEN GOTO 1800
2035 IF X0*6+11<LEN(V9$) THEN IF V9$(X0*6+11,1)="2" THEN GOTO 2020
2040 ON X0 GOTO 2050,2100,2150,2200,2250,2300,2350,2400,2450,2500,2550,2600,2650,2700,2750,2800,2850,2900,2950,3000,1800
2050 REM "Vendor Selection
2055 X$="U=United Stationers, C=S.P.Richards(CAN), S=S.P.Richards(USA)"
2060 CALL "ZZENTR","SRU",A{ALL},A$,X4$,X3$,15,3+V0,212+K9,1,C0,"","{3"+X$,"USC","OS2MPA00","","",""
2065 GOSUB 7200
2070 GOTO 2020
2100 REM "United Stationer's Sign On Account Number
2105 X$="Used only in 'OE01' record in Transmission Header"
2110 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,67,3+V0,0,600,C0,Z2$,"{3"+X$,"","OS2MPA00","","",""
2140 GOTO 2020
2150 REM "United Stationer's Shipping Account Number (used in all places but the header
2155 X$=""
2160 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,67,4+V0,1,600,C0,Z2$,"{3"+X$,"","OS2MPA00","","",""
2190 GOTO 2020
2200 REM "United Stationer's Password
2205 X$=""
2210 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,67,5+V0,1+K9,8,C0,"","{3"+X$,"","OS2MPA04","","",""
2240 GOTO 2020
2250 REM "United Stationer's Connection Id
2255 X$=""
2260 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,67,6+V0,9+K9,4,C0,"","{3"+X$,"","OS2MPA06","","",""
2290 GOTO 2020
2300 REM "United Stationer's Order Taker Id
2305 X$=""
2310 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,67,7+V0,13+K9,3,C0,"","{3"+X$,"","OS2MPA04","","",""
2340 GOTO 2020
2350 REM "United Stationer's Reject Duplicate P.O. (Y/N)
2360 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,67,8+V0,16+K9,1,C0,"","{3"+X$,"","OS2MPA10","","",""
2390 GOTO 2020
2400 REM "United Stationer's Last Transmission Number
2410 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,67,9+V0,2,500,C0,Z3$,"{3"+X$,"","OS2MPA12","","",""
2440 GOTO 2020
2450 REM "United Stationer's ADOT Indicator (S/Y/N)
2455 X$="S=Split Between Facilities, Y=Don't Split(fill from one), N=Don't ADOT"
2460 CALL "ZZENTR","SUR",A{ALL},A$,X4$,X3$,67,10+V0,17+K9,1,C0,"","{3"+X$,"SYN","OS2MPA14","","",""
2490 GOTO 2020
2500 REM "United Stationer's Backorder Disposition (FP/TM)
2505 X$="FP=Fill Partially, TM=Fill Total Merchandise or Nothing"
2510 CALL "ZZENTR","SUR",A{ALL},A$,X4$,X3$,67,11+V0,18+K9,2,C0,"","{3"+X$,"FPTM","OS2MPA16","","",""
2520 IF POS("/"=A$(24,2))>0 THEN GOTO 2500
2540 GOTO 2020
2550 REM "Will Call / Ship Out Order (W/S)
2555 X$="W=Will Call on Order (Pickup), S=Ship Out Order"
2560 CALL "ZZENTR","SUR",A{ALL},A$,X4$,X3$,67,12+V0,20+K9,1,C0,"","{3"+X$,"WS","OS2MPA18","","",""
2590 GOTO 2020
2600 REM "Proxy Number
2610 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,47,13+V0,21+K9,30,C0,"","{3"+X$,"","OS2MPA20","","",""
2640 GOTO 2020
2650 REM "Orders are Drop Ship/single or multi wrap and label or furniture
2655 X$="D=Drop Ship,W=Single Wrap/Label,M=Multi Wrap/Label,F=Furn,S=Standard"
2660 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,67,14+V0,51+K9,1,C0,"","{3"+X$,J$,"OS2MPA22",J1$,"",""
2690 GOTO 2020
2700 REM "UNITED STATIONERS TOP FORM VENDOR NUMBER 
2710 CALL "ZZENTR","AUX",A{ALL},A$,X4$,X3$,67,15+V0,52+K9,10,C0,"A/P","{3"+X$,J$,"IC2MAD12",J1$,"AP2UTE",""
2720 FIND (Z[15],KEY=A$(52+K9,10),DOM=2700)IOL=0330
2725 EXTRACT RECORD (Z[6],KEY=X3$(9,3)+"E/C",DOM=2740)EC_PARMS$
2726 EC_PARMS$(936,10)=A$(58,10)
2727 WRITE RECORD (Z[6],KEY=X3$(9,3)+"E/C")EC_PARMS$
2730 REM "PRINT @(30,16+V0),FNS$(VENDOR$(11,35)),
2740 GOTO 2020
2750 REM " IMPORT DIRECTORY
2760 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,36,16,68,30,C0,"OSP","{3"+X$,"","OS2M PA06","","",""
2790 GOTO 2020
2800 REM "URL - LINE 1                             
2810 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,10,17+V0,98,60,C0,"","{3"+X$,J$,"IC2MAD12","","",""
2840 GOTO 2020
2850 REM "URL LINE 2
2860 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,10,18+V0,158,60,C0,"","{3"+X$,J$,"IC2MAD12","","",""
2890 GOTO 2020
2900 REM " Default Plant Code                  
2910 CALL "ZZENTR","SUZX",A{ALL},A$,X4$,X3$,67,19+V0,221,4,C0,"","{3"+X$,"","OS2MPA10","","",""
2940 GOTO 2020
2950 REM " Customer Pricing Default
2955 X$="L=List, B=Best Price, C=Cust best. If NO Customer Priorities,use this for price"
2960 CALL "ZZENTR","SRU",A{ALL},A$,X4$,X3$,67,20,219,1,C0,"","{3"+X$,"LBC","OS2MAA04","","",""; IF C0=6 THEN GOSUB 6400; C0=1
2990 GOTO 2020
3000 REM " Use Zip Code Routing?                  
3005 X$="Y=Will fill based on Ship-to Zip, N=will use home or ADOT"
3010 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,67,21,220,1,C0,"","{3"+X$,"LB","OS2MAA04","","",""; IF C0=6 THEN GOSUB 6400; C0=1
3040 GOTO 2020
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6010 PRINT @(1,3+V0),"Vendor ID :",
6060 PRINT @(42,3+V0)," Sign On Account Number:",
6062 PRINT @(42,4+V0),"Shipping Account Number:",
6064 PRINT @(56,5+V0)," Password:",
6066 PRINT @(51,6+V0)," Connection Id:",
6068 PRINT @(50,7+V0)," Order Taker Id:",
6070 PRINT @(37,8+V0)," Reject Duplicate P.O. (Y/N):",
6072 PRINT @(40,9+V0)," Last Transmission Number:",
6074 PRINT @(42,10+V0),"ADOT Indicator (S/Y/N):",
6076 PRINT @(35,11+V0)," Backorder Disposition (FP/TM):",
6078 PRINT @(32,12+V0)," WILL CALL / SHIP OUT Order (W/S):",
6080 PRINT @(15,16+V0),"Import Directory: ",
6090 PRINT @(1,14+V0),"Orders are Drop Ship,Single or Multi Wrap/Label,Furn or Standard:",
6091 PRINT @(41,20+V0),"Customer Pricing Default: ",
6092 PRINT @(29,21+V0),"Use Zip Code Routing to Fill Orders?:",
6095 PRINT @(37,15+V0)," Office Products Vendor Code:", ! SSP221193
6096 PRINT @(5,17+V0),"URL: ",
6098 PRINT @(47,19+V0),"Default Plant Code:",
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6218 GOSUB 7200
6220 PRINT @(15,3+V0),VDR$,@(67,3+V0),A[0]:Z2$,@(67,4+V0),A[1]:Z2$,@(67,5+V0),A$(1+K9,8),@(67,6+V0),A$(9+K9,4),@(67,7+V0),A$(13+K9,3),@(67,8+V0),A$(16+K9,1),@(67,9+V0),A[2]:Z3$,@(67,10+V0),A$(17+K9,1),@(67,11+V0),A$(18+K9,2),@(67,12+V0),A$(20+K9,1),@(47,13+V0),A$(21+K9,30),@(67,14+V0),A$(51+K9,1),
6230 CALL "ZZDISP","A",A$(52+K9,10),"A/P",X3$,"","",67,15+V0,X4$
6240 PRINT @(36,16),A$(68,30),
6250 PRINT @(10,17+V0),A$(98,60),
6260 PRINT @(10,18+V0),A$(158,60),
6265 PRINT @(67,19+V0),A$(221,4)
6270 PRINT @(67,20+V0),A$(219,1),
6271 PRINT @(67,21+V0),A$(220,1),
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6490 RETURN 
6500 REM "DELETE
6510 REMOVE (Z[1],KEY=A1$,DOM=6511)
6590 GOTO 1630
6600 REM "ALT KEY DATA READS
6690 RETURN 
6700 REM "ADD ENTRY
6705 IF Z9=0 THEN GOTO 6790
6708 IF A$(57,1)=" " THEN A$(57,1)="S"; REM SSP 191375
6710 WRITE (Z[1],KEY=A1$)IOL=0310
6790 GOTO 1630
6800 REM "NEXT ENTRY IN FILE
6810 A1$=KEY(Z[1],END=1140)
6820 A$(1,LEN(A1$))=A1$
6825 IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 1140
6830 GOSUB 6600
6835 GOSUB 6450
6890 Z9=0; GOTO 1515
6900 REM "GET DEFAULTS
6902 V9$="2103  6703  2105  6705  6707  6709  6710  6712  6713  6715  6716  6718  "
6910 IF V9>=0 THEN READ (Z[6],IND=V9)V9$,IOL=0310; GOTO 6930 ELSE V9=-1
6920 EXTRACT (Z[6],KEY=X0$+"DFLT",DOM=6921)V9$,IOL=0310; V9=IND(Z[6]); READ (Z[6])
6930 RETURN 
6950 REM "WRITE DEFAULT
6955 WRITE (Z[6],KEY=X0$+"DFLT")V9$,IOL=0310
6960 GOSUB 6920; GOTO 1630
6970 REM "ENTRY DEFAULTS
6975 PRINT 'CF'; V9=-2,Q$=""
6980 FOR X=1 TO LEN(V9$) STEP 6
6982 PRINT @(NUM(V9$(X,2)),NUM(V9$(X+2,2))),; IF V9=-2 THEN PRINT V9$(X+4,1), ELSE READ RECORD (0,SIZ=1)Q$; IF POS(Q$="1234Z")=0 THEN PRINT 'RB'; GOTO 6982
6990 IF Q$="Z" THEN EXITTO 6950 ELSE V9$(X+4,LEN(Q$))=Q$; NEXT X
6995 V9=0; GOTO 6980
7200 REM "VENDOR NAME DISPLAY
7210 VDR$=A$(212+K9,1); IF POS(VDR$="SC")=0 THEN VDR$="U"
7215 X=POS(VDR$=VDN$,20),DISP_VD$=VDN$(X+19-18,19)
7218 PRINT @(18,3+V0),DISP_VD$
7220 RETURN 
7500 REM "CUSTOM PROGRAMMING ROUTINES
7525 REM "Modified stmts: 
7550 REM "Added stmts: 
7575 REM "Deleted stmts: 
7700 REM "
7710 WRITE (Z[1],KEY=K9$)IOL=0310
7795 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 SETESC 9350
9950 IF POS(VDR$="SC")<>0 THEN RUN "OS2MPD" ELSE RUN "OS2MPB"
9999 END 
20000 INIT:
20010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,-1,X1,X2; IF X1>0 THEN CMD_STR$="END"; GOSUB WRAP_UP; GOTO *RETURN
20020 DIM OSG$:"A000:C(6),A001:C(8),A002:C(4),A003:C(3),A004:C(1),A005:C(1),A006:C(2),A007:C(1),A008:C(30),A009:C(1),A010:C(10),A011:C(30),A012:C(60),A013:C(60),A014:C(1),A015:C(1),A016:C(1),A017:C(4),A018:C(1),A019:C(1),A020:C(10),A021:C(10),A022:C(10),A023:C(10),A024:C(10),A025:C(10),A026:C(10),A027:C(10),A028:C(10),A029:C(10),A030:C(10),A031:C(10),A032:C(10),A033:C(10),A034:C(10),A035:C(10),A036:C(1),A037:C(60),A038:C(1),A039:C(5),A040:C(1),A041:C(4),A042:C(1),A043:C(1),A044:C(60),A045:C(60),A046:C(1),A047:C(1),A048:C(5),A049:C(30),A050:C(30),A051:C(1),A052:C(1),UNUSED:C(375)"
20021 DIM _CUR.OSG$:"A000:C(6),A001:C(8),A002:C(4),A003:C(3),A004:C(1),A005:C(1),A006:C(2),A007:C(1),A008:C(30),A009:C(1),A010:C(10),A011:C(30),A012:C(60),A013:C(60),A014:C(1),A015:C(1),A016:C(1),A017:C(4),A018:C(1),A019:C(1),A020:C(10),A021:C(10),A022:C(10),A023:C(10),A024:C(10),A025:C(10),A026:C(10),A027:C(10),A028:C(10),A029:C(10),A030:C(10),A031:C(10),A032:C(10),A033:C(10),A034:C(10),A035:C(10),A036:C(1),A037:C(60),A038:C(1),A039:C(5),A040:C(1),A041:C(4),A042:C(1),A043:C(1),A044:C(60),A045:C(60),A046:C(1),A047:C(1),A048:C(5),A049:C(30),A050:C(30),A051:C(1),A052:C(1),UNUSED:C(375)"
20022 DIM _ORIG.OSG$:"A000:C(6),A001:C(8),A002:C(4),A003:C(3),A004:C(1),A005:C(1),A006:C(2),A007:C(1),A008:C(30),A009:C(1),A010:C(10),A011:C(30),A012:C(60),A013:C(60),A014:C(1),A015:C(1),A016:C(1),A017:C(4),A018:C(1),A019:C(1),A020:C(10),A021:C(10),A022:C(10),A023:C(10),A024:C(10),A025:C(10),A026:C(10),A027:C(10),A028:C(10),A029:C(10),A030:C(10),A031:C(10),A032:C(10),A033:C(10),A034:C(10),A035:C(10),A036:C(1),A037:C(60),A038:C(1),A039:C(5),A040:C(1),A041:C(4),A042:C(1),A043:C(1),A044:C(60),A045:C(60),A046:C(1),A047:C(1),A048:C(5),A049:C(30),A050:C(30),A051:C(1),A052:C(1),UNUSED:C(375)"
20025 DIM Z[NUM(X3$(60,3))]
20030 OSG_IOL:IOLIST OSG$,OSGA001,OSGA002,OSGA003
20031 ORIG_OSG_IOL:IOLIST _ORIG.OSG$,_ORIG.OSGA001,_ORIG.OSGA002,_ORIG.OSGA003
20032 CUR_OSG_IOL:IOLIST _CUR.OSG$,_CUR.OSGA001,_CUR.OSGA002,_CUR.OSGA003
20060 CALL "ZZ2PRP","OS",RESULT$,DATE$; IF RESULT$<>"Y" THEN MSGBOX "","TOPS Module is not installed"; CMD_STR$="END"; GOSUB WRAP_UP; GOTO *RETURN
20090 Z$="01X ZZPARM  06O ZZPARM  15O AP4...  "
20100 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
20290 RETURN 
20300 WRAP_UP:
20310 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
20490 RETURN 
20500 READ_REC:
20510 PARM_KEY$=%C$+"OSP",KEY_SIZE=LEN(PARM_KEY$)
20530 OSG$(1,KEY_SIZE)=PARM_KEY$
20540 READ (Z[1],KEY=PARM_KEY$,DOM=*NEXT)IOL=OSG_IOL
20545 READ DATA FROM REC(IOL=OSG_IOL) TO IOL=ORIG_OSG_IOL
20550 IF OSG.A006$="FP" THEN BO_DISP$="F" ELSE IF OSG.A006$="TM" THEN BO_DISP$="T" ELSE BO_DISP$=" "
20552 IF OSG.A014$=" " THEN OSG.A014$="U"
20555 OSGA001$=STR(OSGA001:"000000"),OSGA002$=STR(OSGA002:"000000")
20556 OSGA003$=STR(OSGA003:"00000") ! WO237030
20560 REFRESH_FLG=1
20690 RETURN 
21170 ! 300 - Set up the message library
21180 SETUP_LIBRARY:
21190 _SV_MSGLIB$=MSG(*)
21200 _LANG$=LCS(%NOMAD_DEF_SFX$); IF _LANG$="" THEN _LANG$=LCS(ENV("PVXLANG")); IF _LANG$="" THEN _LANG$=LCS(ENV("LANG")); IF _LANG$="" THEN _LANG$="en"
21210 MESSAGE_LIB "*tfmsglib."+_LANG$,ERR=*NEXT; GOTO 21230
21220 MESSAGE_LIB "*tfmsglib.en"
21230 SET_MSG:GOSUB SETUP_MESSAGES
21240 RETURN 
22300 WRITE_REC:
22352 IF BO_DISP$="F" THEN OSG.A006$="FP" ELSE IF BO_DISP$="T" THEN OSG.A006$="TM" ELSE OSG.A006$=DIM(2)
22360 _CHG1$="",_CHG2$=""
22370 READ (Z[1],KEY=PARM_KEY$,DOM=*NEXT)IOL=CUR_OSG_IOL
22380 GOSUB DETERMINE_CHGS
22390 IF _CHG1$="" AND _CHG2$="" THEN GOTO WRT
22400 IF _CHG1$="" THEN GOTO CHK2
22410 MSGBOX _MSG_UPD_SAME$+SEP+_CHG1$+SEP+SEP+_MSG_OVRWRT_CHG$,_MSG_WARNING$,"Yesno,1,!",_YESNO$
22420 IF _YESNO$="NO" THEN GOTO *RETURN
22430 IF _CHG2$="" THEN GOTO WRT
22440 CHK2:IF _CHG2$<>"" THEN MSGBOX _MSG_UPD_OTHER1$+SEP+_CHG2$+SEP+SEP+_MSG_UPD_OTHER2$,_FYI$,"!"
22450 GOSUB INCORPORATE_CHGS
22460 WRT:WRITE (Z[1],KEY=PARM_KEY$,ERR=WRITE_ERROR)IOL=OSG_IOL
22500 REFRESH_FLG=1
22510 RETURN 
22520 WRITE_ERROR:
22530 IF ERR=11 THEN MSGBOX _MSG_DUP_UNIQUE$,_MSG_CANNOT_WRITE$ ELSE MSGBOX MSG(ERR),_MSG_CANNOT_WRITE$
22540 RETURN 
22810 SETUP_MESSAGES:
22820 _FYI$=MSG("FYI"),_ERROR$=MSG("ERROR")
22830 _MSG_DIRECTORY$=MSG("DIRECTORY")
22840 _MSG_END_OF_FIL$=MSG("END_OF_FIL")
22850 _MSG_FILOPNERR1$=MSG("FILOPNERR1")
22860 _MSG_JUST_CHECK$=MSG("JUST_CHECK")
22870 _MSG_MANDATORY$=MSG("MANDATORY")
22880 _MSG_NEXT$=MSG("NEXT")
22890 _MSG_NON_NUMER$=MSG("NON_NUMER")
22900 _MSG_NOT_FOUND$=MSG("NOT_FOUND")
22910 _MSG_OVRWRT_CHG$=MSG("OVRWRT_CHG")
22920 _MSG_PRECEDING$=MSG("PRECEDING")
22930 _MSG_PREFIX$=MSG("PREFIX")
22940 _MSG_REC_ACCESS$=MSG("REC_ACCESS")
22950 _MSG_REC_ALTERD$=MSG("REC_ALTERD")
22960 _MSG_REC_CR_NEW$=MSG("REC_CR_NEW")
22970 _MSG_REC_LOCKED$=MSG("REC_LOCKED")
22980 _MSG_X$=MSG("REC_MISS","^"),P=POS("^"=_MSG_X$),_MSG_REC_MISS1$=_MSG_X$(1,P-1),_MSG_REC_MISS2$=_MSG_X$(P+1)
22990 _MSG_REC_NOTFND$=MSG("REC_NOTFND")
23000 _MSG_REC_NO_1ST$=MSG("REC_NO_1ST")
23010 _MSG_REC_NO_LST$=MSG("REC_NO_LST")
23020 _MSG_REC_REMOVE$=MSG("REC_REMOVE")
23030 _MSG_REC_UPDADD$=MSG("REC_UPDADD")
23040 _MSG_X$=MSG("REC_VFYDEL","^"),P=POS("^"=_MSG_X$),_MSG_REC_VFYDEL1$=_MSG_X$(1,P-1),_MSG_REC_VFYDEL2$=_MSG_X$(P+1)
23050 _MSG_X$=MSG("REC_VIEW","^"),P=POS("^"=_MSG_X$),_MSG_REC_VIEW1$=_MSG_X$(1,P-1),_MSG_REC_VIEW2$=_MSG_X$(P+1)
23060 _MSG_REQ_FIELDS$=MSG("REQ_FIELDS")
23070 _MSG_START_FILE$=MSG("START_FILE")
23080 _MSG_UPDATE$=MSG("UPDATE")
23090 _MSG_UPD_OTHER1$=MSG("UPD_OTHER1")
23100 _MSG_UPD_OTHER2$=MSG("UPD_OTHER2")
23110 _MSG_UPD_SAME$=MSG("UPD_SAME")
23120 _MSG_WARNING$=MSG("WARNING")
23130 _MSG_CANNOT_WRITE$=MSG("CANT_WRITE")
23140 _MSG_DUP_UNIQUE$=MSG("DUP_UNIQUE")
23150 RETURN 
23350 ! 13000 - Clear the record fields
23900 DETERMINE_CHGS:
23940 DIM _CHG_VAR$(49,"N")
23950 IF _ORIG.OSG.A000$=_CUR.OSG.A000$ OR OSG.A000$=_CUR.OSG.A000$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A000$=OSG.A000$ THEN _CHG2$=_CHG2$+SEP+"OSG.A000 = "+_CUR.OSG.A000$,_CHG_VAR$(1,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A000 = "+_CUR.OSG.A000$
23960 IF _ORIG.OSG.A001$=_CUR.OSG.A001$ OR OSG.A001$=_CUR.OSG.A001$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A001$=OSG.A001$ THEN _CHG2$=_CHG2$+SEP+"OSG.A001 = "+_CUR.OSG.A001$,_CHG_VAR$(2,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A001 = "+_CUR.OSG.A001$
23970 IF _ORIG.OSG.A002$=_CUR.OSG.A002$ OR OSG.A002$=_CUR.OSG.A002$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A002$=OSG.A002$ THEN _CHG2$=_CHG2$+SEP+"OSG.A002 = "+_CUR.OSG.A002$,_CHG_VAR$(3,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A002 = "+_CUR.OSG.A002$
23980 IF _ORIG.OSG.A003$=_CUR.OSG.A003$ OR OSG.A003$=_CUR.OSG.A003$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A003$=OSG.A003$ THEN _CHG2$=_CHG2$+SEP+"OSG.A003 = "+_CUR.OSG.A003$,_CHG_VAR$(4,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A003 = "+_CUR.OSG.A003$
23990 IF _ORIG.OSG.A004$=_CUR.OSG.A004$ OR OSG.A004$=_CUR.OSG.A004$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A004$=OSG.A004$ THEN _CHG2$=_CHG2$+SEP+"OSG.A004 = "+_CUR.OSG.A004$,_CHG_VAR$(5,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A004 = "+_CUR.OSG.A004$
24000 IF _ORIG.OSG.A005$=_CUR.OSG.A005$ OR OSG.A005$=_CUR.OSG.A005$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A005$=OSG.A005$ THEN _CHG2$=_CHG2$+SEP+"OSG.A005 = "+_CUR.OSG.A005$,_CHG_VAR$(6,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A005 = "+_CUR.OSG.A005$
24010 IF _ORIG.OSG.A006$=_CUR.OSG.A006$ OR OSG.A006$=_CUR.OSG.A006$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A006$=OSG.A006$ THEN _CHG2$=_CHG2$+SEP+"OSG.A006 = "+_CUR.OSG.A006$,_CHG_VAR$(7,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A006 = "+_CUR.OSG.A006$
24020 IF _ORIG.OSG.A007$=_CUR.OSG.A007$ OR OSG.A007$=_CUR.OSG.A007$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A007$=OSG.A007$ THEN _CHG2$=_CHG2$+SEP+"OSG.A007 = "+_CUR.OSG.A007$,_CHG_VAR$(8,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A007 = "+_CUR.OSG.A007$
24030 IF _ORIG.OSG.A008$=_CUR.OSG.A008$ OR OSG.A008$=_CUR.OSG.A008$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A008$=OSG.A008$ THEN _CHG2$=_CHG2$+SEP+"OSG.A008 = "+_CUR.OSG.A008$,_CHG_VAR$(9,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A008 = "+_CUR.OSG.A008$
24040 IF _ORIG.OSG.A009$=_CUR.OSG.A009$ OR OSG.A009$=_CUR.OSG.A009$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A009$=OSG.A009$ THEN _CHG2$=_CHG2$+SEP+"OSG.A009 = "+_CUR.OSG.A009$,_CHG_VAR$(10,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A009 = "+_CUR.OSG.A009$
24050 IF _ORIG.OSG.A010$=_CUR.OSG.A010$ OR OSG.A010$=_CUR.OSG.A010$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A010$=OSG.A010$ THEN _CHG2$=_CHG2$+SEP+"OSG.A10 = "+_CUR.OSG.A010$,_CHG_VAR$(11,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A10 = "+_CUR.OSG.A010$
24060 IF _ORIG.OSG.A011$=_CUR.OSG.A011$ OR OSG.A011$=_CUR.OSG.A011$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A011$=OSG.A011$ THEN _CHG2$=_CHG2$+SEP+"OSG.A011 = "+_CUR.OSG.A011$,_CHG_VAR$(12,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A011 = "+_CUR.OSG.A011$
24070 IF _ORIG.OSG.A012$=_CUR.OSG.A012$ OR OSG.A012$=_CUR.OSG.A012$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A012$=OSG.A012$ THEN _CHG2$=_CHG2$+SEP+"OSG.A012 = "+_CUR.OSG.A012$,_CHG_VAR$(13,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A012 = "+_CUR.OSG.A012$
24080 IF _ORIG.OSG.A013$=_CUR.OSG.A013$ OR OSG.A013$=_CUR.OSG.A013$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A013$=OSG.A013$ THEN _CHG2$=_CHG2$+SEP+"OSG.A013 = "+_CUR.OSG.A013$,_CHG_VAR$(14,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A013 = "+_CUR.OSG.A013$
24090 IF _ORIG.OSG.A014$=_CUR.OSG.A014$ OR OSG.A014$=_CUR.OSG.A014$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A014$=OSG.A014$ THEN _CHG2$=_CHG2$+SEP+"OSG.A014 = "+_CUR.OSG.A014$,_CHG_VAR$(15,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A014 = "+_CUR.OSG.A014$
24100 IF _ORIG.OSG.A015$=_CUR.OSG.A015$ OR OSG.A015$=_CUR.OSG.A015$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A015$=OSG.A015$ THEN _CHG2$=_CHG2$+SEP+"OSG.A015 = "+_CUR.OSG.A015$,_CHG_VAR$(16,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A015 = "+_CUR.OSG.A015$
24110 IF _ORIG.OSG.A016$=_CUR.OSG.A016$ OR OSG.A016$=_CUR.OSG.A016$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A016$=OSG.A016$ THEN _CHG2$=_CHG2$+SEP+"OSG.A016 = "+_CUR.OSG.A016$,_CHG_VAR$(17,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A016 = "+_CUR.OSG.A016$
24120 IF _ORIG.OSG.A017$=_CUR.OSG.A017$ OR OSG.A017$=_CUR.OSG.A017$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A017$=OSG.A017$ THEN _CHG2$=_CHG2$+SEP+"OSG.A017 = "+_CUR.OSG.A017$,_CHG_VAR$(18,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A017 = "+_CUR.OSG.A017$
24130 IF _ORIG.OSG.A018$=_CUR.OSG.A018$ OR OSG.A018$=_CUR.OSG.A018$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A018$=OSG.A018$ THEN _CHG2$=_CHG2$+SEP+"OSG.A018 = "+_CUR.OSG.A018$,_CHG_VAR$(19,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A018 = "+_CUR.OSG.A018$
24140 IF _ORIG.OSG.A019$=_CUR.OSG.A019$ OR OSG.A019$=_CUR.OSG.A019$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A019$=OSG.A019$ THEN _CHG2$=_CHG2$+SEP+"OSG.A019 = "+_CUR.OSG.A019$,_CHG_VAR$(20,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A019 = "+_CUR.OSG.A019$
24150 IF _ORIG.OSG.A020$=_CUR.OSG.A020$ OR OSG.A020$=_CUR.OSG.A020$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A020$=OSG.A020$ THEN _CHG2$=_CHG2$+SEP+"OSG.A020 = "+_CUR.OSG.A020$,_CHG_VAR$(21,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A020 = "+_CUR.OSG.A020$
24160 IF _ORIG.OSG.A021$=_CUR.OSG.A021$ OR OSG.A021$=_CUR.OSG.A021$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A021$=OSG.A021$ THEN _CHG2$=_CHG2$+SEP+"OSG.A021 = "+_CUR.OSG.A021$,_CHG_VAR$(22,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A021 = "+_CUR.OSG.A021$
24170 IF _ORIG.OSG.A022$=_CUR.OSG.A022$ OR OSG.A022$=_CUR.OSG.A022$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A022$=OSG.A022$ THEN _CHG2$=_CHG2$+SEP+"OSG.A022 = "+_CUR.OSG.A022$,_CHG_VAR$(23,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A022 = "+_CUR.OSG.A022$
24180 IF _ORIG.OSG.A023$=_CUR.OSG.A023$ OR OSG.A023$=_CUR.OSG.A023$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A023$=OSG.A023$ THEN _CHG2$=_CHG2$+SEP+"OSG.A023 = "+_CUR.OSG.A023$,_CHG_VAR$(24,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A023 = "+_CUR.OSG.A023$
24190 IF _ORIG.OSG.A024$=_CUR.OSG.A024$ OR OSG.A024$=_CUR.OSG.A024$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A024$=OSG.A024$ THEN _CHG2$=_CHG2$+SEP+"OSG.A024 = "+_CUR.OSG.A024$,_CHG_VAR$(25,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A024 = "+_CUR.OSG.A024$
24200 IF _ORIG.OSG.A025$=_CUR.OSG.A025$ OR OSG.A025$=_CUR.OSG.A025$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A025$=OSG.A025$ THEN _CHG2$=_CHG2$+SEP+"OSG.A025 = "+_CUR.OSG.A025$,_CHG_VAR$(26,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A025 = "+_CUR.OSG.A025$
24210 IF _ORIG.OSG.A026$=_CUR.OSG.A026$ OR OSG.A026$=_CUR.OSG.A026$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A026$=OSG.A026$ THEN _CHG2$=_CHG2$+SEP+"OSG.A026 = "+_CUR.OSG.A026$,_CHG_VAR$(27,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A026 = "+_CUR.OSG.A026$
24220 IF _ORIG.OSG.A027$=_CUR.OSG.A027$ OR OSG.A027$=_CUR.OSG.A027$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A027$=OSG.A027$ THEN _CHG2$=_CHG2$+SEP+"OSG.A027 = "+_CUR.OSG.A027$,_CHG_VAR$(28,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A027 = "+_CUR.OSG.A027$
24230 IF _ORIG.OSG.A028$=_CUR.OSG.A028$ OR OSG.A028$=_CUR.OSG.A028$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A028$=OSG.A028$ THEN _CHG2$=_CHG2$+SEP+"OSG.A028 = "+_CUR.OSG.A028$,_CHG_VAR$(29,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A028 = "+_CUR.OSG.A028$
24240 IF _ORIG.OSG.A029$=_CUR.OSG.A029$ OR OSG.A029$=_CUR.OSG.A029$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A029$=OSG.A029$ THEN _CHG2$=_CHG2$+SEP+"OSG.A029 = "+_CUR.OSG.A029$,_CHG_VAR$(30,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A029 = "+_CUR.OSG.A029$
24250 IF _ORIG.OSG.A030$=_CUR.OSG.A030$ OR OSG.A030$=_CUR.OSG.A030$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A030$=OSG.A030$ THEN _CHG2$=_CHG2$+SEP+"OSG.A030 = "+_CUR.OSG.A030$,_CHG_VAR$(31,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A030 = "+_CUR.OSG.A030$
24260 IF _ORIG.OSG.A031$=_CUR.OSG.A031$ OR OSG.A031$=_CUR.OSG.A031$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A031$=OSG.A031$ THEN _CHG2$=_CHG2$+SEP+"OSG.A031 = "+_CUR.OSG.A031$,_CHG_VAR$(32,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A031 = "+_CUR.OSG.A031$
24270 IF _ORIG.OSG.A032$=_CUR.OSG.A032$ OR OSG.A032$=_CUR.OSG.A032$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A032$=OSG.A032$ THEN _CHG2$=_CHG2$+SEP+"OSG.A032 = "+_CUR.OSG.A032$,_CHG_VAR$(33,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A032 = "+_CUR.OSG.A032$
24280 IF _ORIG.OSG.A033$=_CUR.OSG.A033$ OR OSG.A033$=_CUR.OSG.A033$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A033$=OSG.A033$ THEN _CHG2$=_CHG2$+SEP+"OSG.A033 = "+_CUR.OSG.A033$,_CHG_VAR$(34,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A033 = "+_CUR.OSG.A033$
24290 IF _ORIG.OSG.A034$=_CUR.OSG.A034$ OR OSG.A034$=_CUR.OSG.A034$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A034$=OSG.A034$ THEN _CHG2$=_CHG2$+SEP+"OSG.A034 = "+_CUR.OSG.A034$,_CHG_VAR$(35,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A034 = "+_CUR.OSG.A034$
24300 IF _ORIG.OSG.A035$=_CUR.OSG.A035$ OR OSG.A035$=_CUR.OSG.A035$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A035$=OSG.A035$ THEN _CHG2$=_CHG2$+SEP+"OSG.A035 = "+_CUR.OSG.A035$,_CHG_VAR$(36,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A035 = "+_CUR.OSG.A035$
24310 IF _ORIG.OSG.A036$=_CUR.OSG.A036$ OR OSG.A036$=_CUR.OSG.A036$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A036$=OSG.A036$ THEN _CHG2$=_CHG2$+SEP+"OSG.A036 = "+_CUR.OSG.A036$,_CHG_VAR$(37,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A036 = "+_CUR.OSG.A036$
24320 IF _ORIG.OSG.A037$=_CUR.OSG.A037$ OR OSG.A037$=_CUR.OSG.A037$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A037$=OSG.A037$ THEN _CHG2$=_CHG2$+SEP+"OSG.A037 = "+_CUR.OSG.A037$,_CHG_VAR$(38,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A037 = "+_CUR.OSG.A037$
24330 IF _ORIG.OSG.A038$=_CUR.OSG.A038$ OR OSG.A038$=_CUR.OSG.A038$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A038$=OSG.A038$ THEN _CHG2$=_CHG2$+SEP+"OSG.A038 = "+_CUR.OSG.A038$,_CHG_VAR$(39,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A038 = "+_CUR.OSG.A038$
24340 IF _ORIG.OSG.A039$=_CUR.OSG.A039$ OR OSG.A039$=_CUR.OSG.A039$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A039$=OSG.A039$ THEN _CHG2$=_CHG2$+SEP+"OSG.A039 = "+_CUR.OSG.A039$,_CHG_VAR$(40,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A039 = "+_CUR.OSG.A039$
24350 IF _ORIG.OSG.A040$=_CUR.OSG.A040$ OR OSG.A040$=_CUR.OSG.A040$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A040$=OSG.A040$ THEN _CHG2$=_CHG2$+SEP+"OSG.A040 = "+_CUR.OSG.A040$,_CHG_VAR$(41,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A040 = "+_CUR.OSG.A040$
24360 IF _ORIG.OSG.A041$=_CUR.OSG.A041$ OR OSG.A041$=_CUR.OSG.A041$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A041$=OSG.A041$ THEN _CHG2$=_CHG2$+SEP+"OSG.A041 = "+_CUR.OSG.A041$,_CHG_VAR$(42,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A041 = "+_CUR.OSG.A041$
24370 IF _ORIG.OSG.A042$=_CUR.OSG.A042$ OR OSG.A042$=_CUR.OSG.A042$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A042$=OSG.A042$ THEN _CHG2$=_CHG2$+SEP+"OSG.A042 = "+_CUR.OSG.A042$,_CHG_VAR$(43,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A042 = "+_CUR.OSG.A042$
24380 IF _ORIG.OSGA001=_CUR.OSGA001 OR OSGA001=_CUR.OSGA001 THEN GOTO *NEXT ELSE IF _ORIG.OSGA001=OSGA001 THEN _CHG2$=_CHG2$+SEP+"OSGA001 = "+STR(_CUR.OSGA001),_CHG_VAR$(44,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSGA001 = "+STR(_CUR.OSGA001)
24390 IF _ORIG.OSGA002=_CUR.OSGA002 OR OSGA002=_CUR.OSGA002 THEN GOTO *NEXT ELSE IF _ORIG.OSGA002=OSGA002 THEN _CHG2$=_CHG2$+SEP+"OSGA002 = "+STR(_CUR.OSGA002),_CHG_VAR$(45,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSGA002 = "+STR(_CUR.OSGA002)
24400 IF _ORIG.OSGA003=_CUR.OSGA003 OR OSGA003=_CUR.OSGA003 THEN GOTO *NEXT ELSE IF _ORIG.OSGA003=OSGA003 THEN _CHG2$=_CHG2$+SEP+"OSGA003 = "+STR(_CUR.OSGA003),_CHG_VAR$(46,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSGA003 = "+STR(_CUR.OSGA003)
24402 IF _ORIG.OSG.A043$=_CUR.OSG.A043$ OR OSG.A043$=_CUR.OSG.A043$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A043$=OSG.A043$ THEN _CHG2$=_CHG2$+SEP+"OSG.A043 = "+_CUR.OSG.A043$,_CHG_VAR$(47,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A043 = "+_CUR.OSG.A043$
24403 IF _ORIG.OSG.A044$=_CUR.OSG.A044$ OR OSG.A044$=_CUR.OSG.A044$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A044$=OSG.A044$ THEN _CHG2$=_CHG2$+SEP+"OSG.A044 = "+_CUR.OSG.A044$,_CHG_VAR$(48,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A044 = "+_CUR.OSG.A044$
24404 IF _ORIG.OSG.A045$=_CUR.OSG.A045$ OR OSG.A045$=_CUR.OSG.A045$ THEN GOTO *NEXT ELSE IF _ORIG.OSG.A045$=OSG.A045$ THEN _CHG2$=_CHG2$+SEP+"OSG.A045 = "+_CUR.OSG.A045$,_CHG_VAR$(49,1)="Y" ELSE _CHG1$=_CHG1$+SEP+"OSG.A045 = "+_CUR.OSG.A045$
24410 RETURN 
24420 ! 16000 - Incorporate changes made by another user into the record
24430 INCORPORATE_CHGS:
24440 IF _CHG_VAR$(1,1)="Y" THEN OSG.A000$=_CUR.OSG.A000$
24450 IF _CHG_VAR$(2,1)="Y" THEN OSG.A001$=_CUR.OSG.A001$
24460 IF _CHG_VAR$(3,1)="Y" THEN OSG.A002$=_CUR.OSG.A002$
24470 IF _CHG_VAR$(4,1)="Y" THEN OSG.A003$=_CUR.OSG.A003$
24480 IF _CHG_VAR$(5,1)="Y" THEN OSG.A004$=_CUR.OSG.A004$
24490 IF _CHG_VAR$(6,1)="Y" THEN OSG.A005$=_CUR.OSG.A005$
24500 IF _CHG_VAR$(7,1)="Y" THEN OSG.A006$=_CUR.OSG.A006$
24510 IF _CHG_VAR$(8,1)="Y" THEN OSG.A007$=_CUR.OSG.A007$
24520 IF _CHG_VAR$(9,1)="Y" THEN OSG.A008$=_CUR.OSG.A008$
24530 IF _CHG_VAR$(10,1)="Y" THEN OSG.A009$=_CUR.OSG.A009$
24540 IF _CHG_VAR$(11,1)="Y" THEN OSG.A010$=_CUR.OSG.A010$
24550 IF _CHG_VAR$(12,1)="Y" THEN OSG.A011$=_CUR.OSG.A011$
24560 IF _CHG_VAR$(13,1)="Y" THEN OSG.A012$=_CUR.OSG.A012$
24570 IF _CHG_VAR$(14,1)="Y" THEN OSG.A013$=_CUR.OSG.A013$
24580 IF _CHG_VAR$(15,1)="Y" THEN OSG.A014$=_CUR.OSG.A014$
24590 IF _CHG_VAR$(16,1)="Y" THEN OSG.A015$=_CUR.OSG.A015$
24600 IF _CHG_VAR$(17,1)="Y" THEN OSG.A016$=_CUR.OSG.A016$
24610 IF _CHG_VAR$(18,1)="Y" THEN OSG.A017$=_CUR.OSG.A017$
24620 IF _CHG_VAR$(19,1)="Y" THEN OSG.A018$=_CUR.OSG.A018$
24630 IF _CHG_VAR$(20,1)="Y" THEN OSG.A019$=_CUR.OSG.A019$
24640 IF _CHG_VAR$(21,1)="Y" THEN OSG.A020$=_CUR.OSG.A020$
24650 IF _CHG_VAR$(22,1)="Y" THEN OSG.A021$=_CUR.OSG.A021$
24660 IF _CHG_VAR$(23,1)="Y" THEN OSG.A022$=_CUR.OSG.A022$
24670 IF _CHG_VAR$(24,1)="Y" THEN OSG.A023$=_CUR.OSG.A023$
24680 IF _CHG_VAR$(25,1)="Y" THEN OSG.A024$=_CUR.OSG.A024$
24690 IF _CHG_VAR$(26,1)="Y" THEN OSG.A025$=_CUR.OSG.A025$
24700 IF _CHG_VAR$(27,1)="Y" THEN OSG.A026$=_CUR.OSG.A026$
24710 IF _CHG_VAR$(28,1)="Y" THEN OSG.A027$=_CUR.OSG.A027$
24720 IF _CHG_VAR$(29,1)="Y" THEN OSG.A028$=_CUR.OSG.A028$
24730 IF _CHG_VAR$(30,1)="Y" THEN OSG.A029$=_CUR.OSG.A029$
24740 IF _CHG_VAR$(31,1)="Y" THEN OSG.A030$=_CUR.OSG.A030$
24750 IF _CHG_VAR$(32,1)="Y" THEN OSG.A031$=_CUR.OSG.A031$
24760 IF _CHG_VAR$(33,1)="Y" THEN OSG.A032$=_CUR.OSG.A032$
24770 IF _CHG_VAR$(34,1)="Y" THEN OSG.A033$=_CUR.OSG.A033$
24780 IF _CHG_VAR$(35,1)="Y" THEN OSG.A034$=_CUR.OSG.A034$
24790 IF _CHG_VAR$(36,1)="Y" THEN OSG.A035$=_CUR.OSG.A035$
24800 IF _CHG_VAR$(37,1)="Y" THEN OSG.A036$=_CUR.OSG.A036$
24810 IF _CHG_VAR$(38,1)="Y" THEN OSG.A037$=_CUR.OSG.A037$
24820 IF _CHG_VAR$(39,1)="Y" THEN OSG.A038$=_CUR.OSG.A038$
24830 IF _CHG_VAR$(40,1)="Y" THEN OSG.A039$=_CUR.OSG.A039$
24840 IF _CHG_VAR$(41,1)="Y" THEN OSG.A040$=_CUR.OSG.A040$
24850 IF _CHG_VAR$(42,1)="Y" THEN OSG.A041$=_CUR.OSG.A041$
24860 IF _CHG_VAR$(43,1)="Y" THEN OSG.A042$=_CUR.OSG.A042$
24870 IF _CHG_VAR$(44,1)="Y" THEN OSGA001=_CUR.OSGA001
24880 IF _CHG_VAR$(45,1)="Y" THEN OSGA002=_CUR.OSGA002
24890 IF _CHG_VAR$(46,1)="Y" THEN OSGA003=_CUR.OSGA003
24892 IF _CHG_VAR$(47,1)="Y" THEN OSG.A043$=_CUR.OSG.A043$
24893 IF _CHG_VAR$(48,1)="Y" THEN OSG.A044$=_CUR.OSG.A044$
24894 IF _CHG_VAR$(49,1)="Y" THEN OSG.A045$=_CUR.OSG.A045$
24900 RETURN 
25000 VAL_VEND:
25010 IF STP(OSG.A010$,3)="" THEN NEXT_ID=OSG.A010.CTL; GOTO *RETURN
25020 EXTRACT RECORD (Z[6],KEY=X3$(9,3)+"E/C",DOM=25030)EC_PARMS$
25022 EC_PARMS$(936,10)=PAD(OSG.A010$,10)
25025 WRITE RECORD (Z[6],KEY=X3$(9,3)+"E/C")EC_PARMS$
25090 RETURN 
25100 VAL_OSGA001:
25110 OSGA001=NUM(OSGA001$,ERR=*NEXT); OSGA001$=STR(NUM(OSGA001$,ERR=*NEXT):"000000"); REFRESH_FLG=1; GOTO *RETURN
25120 MSGBOX "",MSG("NUMERIC"); NEXT_ID=OSGA001.CTL
25140 RETURN 
25200 VAL_OSGA002:
25210 OSGA002=NUM(OSGA002$,ERR=*NEXT); OSGA002$=STR(NUM(OSGA002$,ERR=*NEXT):"000000"); REFRESH_FLG=1; GOTO *RETURN
25220 MSGBOX "",MSG("NUMERIC"); NEXT_ID=OSGA002.CTL
25240 RETURN 
25250 VAL_PLANT_CODE:
25260 OSG.A017$=STR(NUM(OSG.A017$,ERR=*NEXT):"0000"); REFRESH_FLG=1; GOTO *RETURN
25270 OSG.A017$=PAD(OSG.A017$,4)
25280 REFRESH_FLG=1
25290 RETURN 
25300 VAL_OSGA003:! WO 237030
25310 OSGA003=NUM(OSGA003$,ERR=*NEXT); OSGA003$=STR(NUM(OSGA003$,ERR=*NEXT):"00000"); REFRESH_FLG=1; GOTO *RETURN ! WO 237030
25320 MSGBOX "",MSG("NUMERIC"); NEXT_ID=OSGA003.CTL
25330 RETURN 
56000 REM "191375-Modify United shipping type to be S instead of  
56002 REM "203458-Addition of S.P. Richards to TOPS module                    
56004 REM "221193-CHUI and GUI places that refer to WebEC.
56006 REM "225094-OSP parameter file layout missing fields, reused one for
56008 REM "237030-O/S System parameter to trigger customer's finders fee when 
