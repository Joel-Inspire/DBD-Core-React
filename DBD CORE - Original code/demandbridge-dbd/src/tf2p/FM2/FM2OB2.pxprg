0010 REM "Sales line 2350-2799,3950-3999 <FM2OB2>
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 11/26/23 - 15.357602 - jvv - SSP# 307463
0037 REM "307463-Allow access to all warehouses for an operator who is       
0040 REM "Copyright 2023 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 X0$="FM2OB2"
0100 SETERR 9000
0110 GOSUB CHECK_MFF ! WO 276772
0200 IF L3<>0 THEN GOTO 8000
0300 REM "IOLISTS
0340 IOLIST D$
0350 IOLIST E$,E[0],E[1],E[2]
0351 IOLIST E1$
0390 IOLIST E2$
0400 IOLIST J$,J[0],J[1],J[2],J[3],J[4],J[5],J[6],J[7],J[8]
0410 IOLIST S5$,S[0],S[1]
0420 IOLIST T5$,T[0],T[1]
1700 REM 
1710 GOTO 2040
2000 REM "DATA SEQ
2020 X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF INT(C0)=3 THEN GOSUB 7300 ELSE IF C0>3 OR X0<0 THEN X0=999; GOTO 9900
2040 ON X0 GOTO 9900,9900,9900,9900,9900,9900,9900,2350,2400,2450,2500,2550,2650,2600,3950,2700,2750,9900
2350 REM "Product code
2352 IF A$(155,1)="M" THEN GOTO 2020
2354 FIND (Z[4],KEY="T"+A$(29,3),DOM=2355)IOL=0340
2355 GOSUB 7765
2356 PRINT @(12,22),"Product code - ",D$(5,15),
2360 CALL "ZZENTR","SZXU",A{ALL},A$,X4$,X3$,12,7,29,3,C0,"","{3"+X$,"T","FM2ODB14","FMPP","X",""; IF ABS(C0)=102 THEN L3=1,Q1$="T",Z8$="FM2SAA"; RUN "ZZ2STP" ELSE IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2360,2361
2365 IF C0<=-1 THEN GOTO 2020 ! SSP 276772
2370 FIND (Z[4],KEY="T"+A$(29,3),DOM=2360)IOL=0340
2371 X$=B$(6,10)+A$(29,3)+A$(161,10)+A$(19,10); IF MFF_PARM THEN MFF_KEY$=X$; CALL "FS2MFF",X3$,X4$,X$,X,A$(147,8)+A$(6,3) ELSE CALL "FS2DAF",X3$,X4$,X$,X; IF X$>"" THEN A$(135,1)=X$(11,1),A$(137,10)=X$(1,10),A[11]=X; REM SSP 199045 ;!SSP 276772
2372 PRINT @(12,22),"Product code - ",D$(5,15),
2373 IF MID(D$,47,1)="Y" THEN A[11]=0; REM SSP 199045
2374 IF MID(D$,47,1)="Y" THEN A$(135,1)=" "; REM SSP 199045
2375 IF MID(D$,47,1)="Y" THEN A$(137,10)=DIM(10); REM SSP 199045
2376 GOSUB 7765; REM SSP 199045
2377 PRINT @(0,22),'CL',; IF MFF_PARM THEN GOTO 2390 ! SSP 276772
2378 CALL "ZZDISP","A",A$(137,10),"A/P",X3$,"","",56,18,X4$; PRINT @(67,18),E1$(11,13),@(56,17),A$(135,1),@(66),A[11]:M3$,; REM SSP 209356
2390 GOTO 2020
2400 REM "Left-right
2405 IF A$(155,1)<>"N" THEN GOTO 2020
2410 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,16,7,32,8,C0,"","{3"+X$,"","FM2ODB16","","",""
2440 GOTO 2020
2450 REM "top- bottom
2455 IF A$(155,1)<>"N" THEN GOTO 2020
2460 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,25,7,40,8,C0,"","{3"+X$,"","FM2ODB18","","",""
2490 GOTO 2020
2500 REM "# of plys
2505 IF A$(155,1)<>"N" THEN GOTO 2020
2510 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,35,7,48,2,C0,"","{3"+X$,"","FM2ODB20","","",""
2520 IF A$(48,2)="00" THEN A$(48,2)=""; PRINT @(35,7),A$(48,2),
2540 GOTO 2020
2550 REM "Description
2555 Q3$=B$(6,10)+A$(161,10)+A$(19,10)
2556 Q4$=A$(50,40)
2558 IF B$(43,1)="Y" THEN X$="Use LOOKUP to list previous work orders"
2560 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,39,7,50,40,C0,"","{3"+X$,Q3$,"FM2ODB22","FW0","",""; IF ABS(C0)>4 THEN GOSUB 7500; GOSUB 6400; ON C0 GOTO 2560,2561
2590 GOTO 2020
2600 REM "Plant
2604 IF Q$>"" AND POS(" "<>A$(94,10))=0 OR F1$="*" OR P6$="*" OR F0$<>"" OR A$(155,1)="M" OR A$(9,1)=" " THEN GOTO 2020
2605 J1$="P"+A$(94,10)
2610 CALL "ZZENTR","SUZX",A{ALL},A$,X4$,X3$,72,9,90,4,C0,"","{3"+X$,J1$,"FM2ODB24","FM0P","X",""; IF ABS(C0)=102 THEN L3=2,Q1$="P"+A$(94,10),Z8$="FM2SKA"; RUN "ZZ2STP" ELSE IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2610,2611
2617 IF POS("0"<>A$(90,4))=0 THEN A$(90,4)=""; PRINT @(72,9),'CL',
2618 IF POS(" "<>A$(90,4))=0 THEN DIM E2$(130); GOTO 2630
2620 FIND (Z[9],KEY=J1$+A$(90,4),DOM=2610)IOL=0390
2625 IF C0<0 THEN GOTO 2020
2630 GOSUB 8300
2635 GOSUB 7000
2640 GOTO 2020
2650 REM "Vendor
2654 IF B$(52,1)="Y" AND A$(15,3)<>"   " AND POS(" "<>A$(94,10))=0 OR F1$="*" OR P6$="*" OR F0$<>"" OR A$(155,1)="M" OR A$(9,1)=" " THEN GOTO 2020
2655 J1$=A$(94,10)
2660 CALL "ZZENTR","AU",A{ALL},A$,X4$,X3$,11,9,94,10,C0,"A/P","{3"+X$,"","FM2ODB26","AP4","X",""; IF ABS(C0)=102 THEN L3=3,Q1$="*",Z8$="AP2MAB"; RUN "ZZ2STP" ELSE IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2660,2661
2670 FIND (Z[5],KEY=A$(94,10),DOM=2660)IOL=0350
2675 IF X3$(330,1)="1" THEN IF POS(A$(94,2)="0001",2)=0 THEN CALL "ZZPROM",".4",X3$,0,"You must select a vendor in division 00 or 01","","",0; GOTO 2660
2678 IF A$(9,1)=DIM(1) OR STP(P1$(75,1),2)="" OR P1$(76,1)="Y" THEN GOTO 2679 ELSE CC3$=A$(128,5); CALL "AR2COM","VENDCOM",CC3$,A{ALL},Z[13],0,0,A$; A$(128,5)=CC3$; GOSUB 6400; IF %MSLC THEN CMKEY$="O"+A$(147,8)+B$(6,10)+A$(6,3); CALL "AR2MCM","VENDCOM",CC3$,A{ALL},Z[13],0,0,CMKEY$,0,A$ ! SP217566, SSP 225300
2680 DIM E2$(200); FIND (Z[9],KEY="P"+A$(94,10)+A$(90,4),DOM=2681)IOL=0390
2681 IF J1$=A$(94,10) THEN GOTO 2690
2685 GOSUB 8300
2686 IF E$(246,1)="I" THEN CALL "ZZPROM",".4",X3$,0,"This vendor is inactive, please use another","","",0; GOTO 2660
2687 GOSUB 7000
2688 CALL "AP2MAY",X3$,A$(94,10),2,17,X$; IF X$="Y" THEN GOSUB 6400
2690 GOTO 2020
2700 REM "Starting number
2705 IF POS(A$(155,1)="MS")<>0 THEN GOTO 2020
2706 IF C$(104,1)="N" THEN A$(104,9)=""; PRINT @(48,10),"  (N/A)  ",; GOTO 2020
2710 CALL "ZZENTR","RZ",A{ALL},A$,X4$,X3$,48,10,104,9,C0,"","{3"+X$,"","FM2ODB28","","",""
2740 GOTO 2020
2750 REM "Reorder Date
2755 IF POS(A$(155,1)="MS")<>0 THEN GOTO 2020
2760 CALL "ZZENTR","D",A{ALL},A$,X4$,X3$,69,10,113,6,C0,"","{3"+X$,"","FM2ODB30","","",""
2765 IF POS(" "<>A$(113,6))<>0 AND A$(113,6)<B$(16,6) THEN CALL "ZZPROM",".4",X3$,Z,"The reorder date should be later than the order date!","","",0; GOTO 2760
2785 IF ABS(C0)<2 AND POS(" "<>A$(124,4))<>0 THEN X0=X0+1
2790 GOTO 2020
3950 REM "Ship from
3951 IF A$(9,1)<>" " AND POS("P"=A$(156,5))>0 THEN GOTO 4000
3952 IF POS(A$(155,1)="MS")>0 AND POS("P"=A$(156,5))=0 OR (POS("P"=A$(156,5))=0 AND A$(9,1)<>" ") THEN GOTO 2020
3953 IF A$(155,1)<>"M" AND A$(10,4)="DS  " THEN GOTO 3980
3954 DIM J1$(11); J1$(1,1)="D",J2$=A$(10,4)
3955 X$=""; IF B$(43,1)="Y" THEN X$="Work Order Warehouses must end with a '2' "; IF A$(10,4)="    " THEN IF A$(155,1)="C" THEN A$(10,4)="9002"; GOTO 3960 ELSE A$(10,4)="0002"; GOTO 3960 ELSE GOTO 3960
3956 IF A$(155,1)<>"I" THEN X$="Enter warehouse code 0001 - 9999" ELSE X$="Enter only warehouse codes 0001 - 8999"
3957 IF A$(155,1)="M" THEN X$=X$+" or DS"
3958 IF A$(10,4)="    " AND P3$(153,1)="Y" THEN GOSUB 8450
3959 IF A$(10,4)="    " THEN IF A$(155,1)="C" THEN A$(10,4)="9001" ELSE A$(10,4)="0001"
3960 IF P2$(44,1)="Y" AND A$(2,1)="Y" THEN IF A(0)<>0 OR A(10)<>0 THEN CALL "ZZPROM",".4",X3$,Z,"Lots have been entered, so the whse cannot be changed!","","",0; GOTO 3970; REM "Support Ref# 175797
3961 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,11,10,10,4,C0,"","{3"+X$,J1$,"FM2ODB25","FM0D","X",""; IF ABS(C0)=102 THEN L3=4,Q1$=J1$,Z8$="FM2SKA"; RUN "ZZ2STP" ELSE IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 3960,3961
3962 IF MID(OPPARM$,348,1)<>"Y" THEN IF X3$(333,2)<>"  " THEN A$(11,3)="0"+X3$(333,2); PRINT @(11,10),A$(10,4), ! SSP#286885!ssp#307292 DBSPT-94483!SSP#307330 DBSPT-110365 SSP307430-DBD-333-DBSPT-149880!SSP#307462 DBD-421 SSP307463 DBD-422
3963 IF A$(10,4)="DS  " AND A$(155,1)="M" THEN GOTO 2020 ELSE IF NUM(A$(10,4),ERR=3960)<0 THEN GOTO 3960
3965 IF C0=2 THEN J2_FLAG=1; GOTO 2020
3966 IF A$(155,1)="I" AND NUM(A$(10,4))>8999 THEN GOTO 3960
3967 IF B$(43,1)="Y" THEN IF A$(13,1)<>"2" THEN GOTO 3960
3969 IF POS(A$(155,1)="NM")<>0 THEN IF POS(" "<>A$(10,4))=0 THEN GOTO 3990 ELSE IF POS("0"<>A$(10,4))=0 THEN A$(10,4)=""; PRINT @(11,10),A$(10,4),; GOTO 3990
3970 FIND (Z[9],KEY=J1$+A$(10,4),DOM=3960)E4$
3971 DIM J[8]; FIND (Z[11],KEY=A$(161,10)+A$(19,10)+A$(10,4),DOM=3972)IOL=0400
3972 IF B$(43,1)="Y" THEN T3=J[7]*1.15 ELSE T3=J[7]
3973 T0=J[3]+J[4]-J[5]+J[6],T1=T0-T3,T2=T1+J[8]
3975 GOSUB 8350
3976 IF J2_FLAG=1 OR J2$<>A$(10,4) THEN GOSUB 8400; J2_FLAG=0
3980 IF ABS(C0)=1 AND A$(14,1)<>"Y" THEN X0=X0+1
3985 IF A$(9,1)<>" " AND POS(A$(155,1)="IC")<>0 THEN A$(10,4)="DS"; PRINT @(11,10),A$(10,4),
3990 IF B$(43,1)="Y" THEN IF A$(155,1)="N" THEN GOTO 4100
3995 GOTO 2020
4000 REM "Warehouse Code for Packing List Purposes
4005 X$="For this Direct Ship line, enter the warehouse code for packing list printing",A$(10,4)="DS"
4007 IF A$(94,10)=MID(OSP_PARMS$,58,10) AND MID(OSP_PARMS$,455,4)<>DIM(4) THEN A$(215,4)=MID(OSP_PARMS$,455,4)
4008 IF A$(94,10)=MID(OSP_PARMS$,58,10) AND MID(OSP_PARMS$,648,1)="Y" AND MID(O2$,238,4)<>DIM(4) THEN A$(215,4)=MID(O2$,238,4) ! WO222052, for OS type order lines, if OS parm set, and cust default whse is not blank, use it
4010 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,11,10,215,4,C0,"","{3"+X$,"","FM2OD225","","",""
4020 DIM J1$(15); J1$(1,1)="D",J1$(12,4)=A$(215,4)
4030 FIND (Z[9],KEY=J1$,DOM=4010)
4040 GOTO 2020
4100 REM "Material cost for non-stocks
4105 X$="Enter cost/M of materials for which outside P/O's are being issued"
4110 CALL "ZZENTR","NX",A{ALL},A$,X4$,X3$,32,18,15,822,C0,M1$,"{3"+X$,"","FM2ODB82","","",""
4140 GOTO 2020
6215 DIM C0$(50)
6220 IF A$(155,1)="C" THEN FIND (Z[8],KEY=A$(161,10),DOM=6221)C0$ ELSE GOTO 6230
6221 PRINT @(0,5),'CL','SB',"Cust. no:",@(25,5),"Name:",'SF',
6222 CALL "ZZDISP","A",A$(161,10),"A/R",X3$,"","",10,5,X4$
6223 PRINT @(31,5),C0$(11,35),
6230 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 CALL "FM2OB1",X3$,X4$,6400,N0,A$,A{ALL},B$,E$,E1$,H$,S[2],T[2],E2$,E4$,P3$
6425 GOSUB 6200
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6460 CALL "FM2OB1",X3$,X4$,6450,N0,A$,A{ALL},B$,E$,E1$,H$,S[2],T[2],E2$,E4$,P3$
6490 RETURN 
7000 REM "Prompt after plant/vendor
7010 IF C0>0 AND A$(9,1)<>" " AND POS(A$(155,1)="IC")<>0 AND A[10]<>0 THEN CALL "ZZPROM",".4",X3$,0,"The quantity must be reentered to recompute the cost","","",0
7040 RETURN 
7300 REM 
7310 ON FPT(C0)*10 GOTO 7390,7325,7330,7390
7325 IF V8$="" THEN X0=X0+4; GOTO 7390 ELSE X0=NUM(V8$(POS(STR(X0:"00")<=V8$,2),2)); GOTO 7390
7330 IF V8$="" THEN X0=X0-6; GOTO 7335 ELSE X0=POS(STR(X0-1:"00")<=V8$,2)-2; IF X0<0 THEN X0=0; GOTO 7390 ELSE X0=NUM(V8$(X0,2)); GOTO 7390
7335 IF X0<0 THEN X0=0; GOTO 7390
7390 C0=3; RETURN 
7500 REM "Get workorder record
7505 IF C0<>6 THEN GOTO 7590
7510 CLOSE (14); OPEN (14)"FW0"+X3$(9,3)
7515 DIM Q0[1]
7518 A$(104,9)=A$(50,8)
7520 READ (14,KEY=Q3$+A$(50,8),DOM=7521)Q$,Q0[0],Q0[1]; GOTO 7525
7521 A$(50,40)=Q4$; GOTO 7590
7525 A$(50,40)=Q$(50,40)
7590 RETURN 
7750 REM "Defaults based on product code info
7760 FIND (Z[4],KEY="T"+A$(29,3),DOM=7761)IOL=0340
7775 IF D$(22,1)="N" THEN A[9]=0
7780 GOSUB 8100
7785 IF %MSLC THEN CMKEY$="O"+A$(147,8)+B$(6,10)+A$(6,3); CALL "ARGSCM;COMM_PROD_OVERRIDE",CMKEY$,A$(29,3) ! SSP 225300
7790 RETURN 
8000 REM "Return from setups
8004 IF Q1$="" OR L3=0 THEN GOSUB 6400
8005 L4=L3,L3=0,C0=0; ON L4 GOTO 8090,8010,8020,8030,8040
8010 IF Q1$>"" THEN A$(29,3)=Q1$; GOSUB 6400; GOTO 2361 ELSE GOTO 2350
8020 IF Q1$>"" THEN A$(90,4)=Q1$(12); GOSUB 6400; GOTO 2611 ELSE GOTO 2600
8030 IF Q1$>"" THEN A$(94,10)=Q1$; GOSUB 6400; GOTO 2661 ELSE GOTO 2650
8040 IF Q1$>"" THEN A$(10,4)=Q1$(12); GOSUB 6400; GOTO 3961 ELSE GOTO 3950
8090 GOTO 0300
8100 REM "Set taxable to N if never taxed 
8102 IF B$(86,1)<>"Y" THEN A$(136,1)="N"; ELSE IF A$(136,1)=" " THEN A$(136,1)="Y"; REM SSP187704
8105 ON POS(D$(23,1)="NC") GOTO 8130,8110,8120
8110 A$(136,1)="N"; IF B$(86,1)<>"Y" THEN GOTO 8134 ELSE GOTO 8130; REM IF CUSTOMER IS TAXABLE, CHECK THE ITEM TOO
8120 IF A$(136,1)="Y" THEN A$(136,1)="C"
8130 IF POS(A$(5,1)="IC ")=0 THEN GOTO 8133
8131 IF MID(I$,119,1)=" " THEN GOTO 8132 ELSE IF MID(I$,119,1)="E" THEN A$(136,1)="N" ELSE IF MID(I$,136,1)="C" THEN A$(136,1)="C" ELSE IF MID(I$,119,1)="T" THEN A$(136,1)="Y"; REM SSP 201823 
8132 GOTO 8134
8133 IF MID(C$,387,1)=" " THEN GOTO 8134 ELSE IF MID(C$,387,1)="E" THEN A$(136,1)="N" ELSE IF MID(C$,387,1)="C" THEN A$(136,1)="C" ELSE IF MID(C$,387,1)="T" THEN A$(136,1)="Y"; REM SSP 201823   
8134 PRINT @(42,17),A$(136,1),
8135 IF P3$(186,1)="Y" THEN IF POS(" "<>D$(38,5))>0 THEN A$(128,5)=D$(38,5)
8136 PRINT @(17,17),A$(128,5),
8137 IF ARS$(122,1)="Y" THEN FIND (Z[14],KEY=B$(93,4)+A$(29,3),DOM=8138)ASQ$; A$(128,5)=ASQ$(8,5); PRINT @(17,17),A$(128,5),; REM "WO89451
8140 RETURN 
8300 REM "Display Vendor, Plant name
8310 DIM E3$(40)
8320 IF POS(" "<>E2$(111,16))=0 THEN E2$(111,18)=E$(106,18)
8325 IF POS(" "<>E2$(111,16))=0 THEN E3$(1)=E$(11,35) ELSE E3$(1)=FNS$(E$(11,35))+"-"+FNS$(E2$(111,16))+", "+E2$(127,2)
8335 PRINT @(24,9),E3$,; E3$=""
8340 RETURN 
8350 REM "Display Ship from city/state
8355 IF POS(" "<>E4$(111,16))=0 THEN GOTO 8390
8360 DIM E5$(15)
8365 IF LEN(FNS$(E4$(111,16)))<12 THEN E5$(1)=FNS$(E4$(111,16))+","+E4$(127,2) ELSE E5$(1)=FNS$(E4$(111,16))
8370 PRINT @(16,10),E5$,
8390 RETURN 
8400 REM "Set cost based on location
8405 IF A$(155,1)="N" THEN RETURN 
8410 IF A$(155,1)="C" THEN J2$=B$(6,10)+A$(19,10)+A$(10,4) ELSE DIM J2$(24); J2$(11)=A$(19,10)+A$(10,4)
8411 IF A$(161,10)<>DIM(10) THEN J2$(1,10)=A$(161,10) ! SSP#234727
8415 FIND (Z[11],KEY=J2$,DOM=8422)IOL=0400
8420 IF J[2]<>0 THEN A[1]=J[2]; IF B$(43,1)="Y" THEN IF POS(A$(155,1)="IC")>0 AND A$(10,1)<"9" AND A[2]<>0 THEN A[15]=A[1]*1000/A[2]
8422 IF A$(155,1)="C" AND A$(10,1)="9" THEN A[1]=0,A[3]=0,A[6]=0,A[22]=0,A[23]=0; IF B$(43,1)<>"Y" THEN A[4]=0
8423 CALL "FM2OB4",A{ALL},S{ALL},T{ALL},M0$,M6$,M2$,M3$,S5$,T5$,D0$,A$,I$
8425 REM CALL "FM2OB1",X3$,X4$,6240,N0,A$,A[ALL],B$,E$,E1$,H$,S[2],T[2],E2$,E4$,P3$
8440 RETURN 
8450 REM "Whse sub by division - Not sure about P9$-so if used elsewhere - forget it!
8460 IF LEN(P9$)<>210 AND LEN(P9$)<>0 THEN GOTO 8490 ELSE IF P9$="" THEN DIM P9$(210); CLOSE (14); OPEN (14,ERR=8490)"FSH"+X3$(9,3); FIND (14,KEY=A$(147,2),DOM=8490)P9$
8480 IF NUM(P9$(192,3))>0 THEN A$(11,3)=P9$(192,3); IF A$(155,1)="C" THEN A$(10,1)="9" ELSE A$(10,1)="0"
8490 RETURN 
8900 REM "FNS
8915 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
8920 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9700 REM 
9710 GOTO 9900
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9940 SETESC 9350
9945 L0=1
9950 RUN "FM2OB0"
9999 END 
10000 CHECK_MFF:! SSP 276772
10005 MFF_PARM=0
10010 CHL=UNT; OPEN (CHL,ERR=END_CHECK_MFF)"ZZPARM"
10020 FIND (CHL,KEY=X3$(9,3)+"F/M")OPPARM$
10030 MFF_PARM=0; IF MID(OPPARM$,337,1)="Y" THEN MFF_PARM=1 ! SSP 276772
10050 END_CHECK_MFF:
10060 CLOSE (CHL,ERR=*NEXT)
10070 RETURN 
10090 ! 
56000 REM "201823-Provide the ability to set the taxable flag  by Item        
56001 REM "199045-Workorder to restrict Finder's Fees to items assigned to
56002 REM "209356-Need W/O to add question to OP Special Charges     
56004 REM "217566-Commission substitution by vendor to allow certain house    
56005 REM "222237-Modification to charge house charges by vendor.             
56008 ! WO222052, for OS order lines, use customer default whse for PL print
56009 REM "234727-Problem pulling Cust Owned Inventory, If item has inventory under both From and using customer
56010 REM "276772-Multiple Finder's Fees per Customer/Item/Order Line.        
56011 REM "286885-Workorder quote:  Would like the warehouse restriction in   
56012 REM "292036-Two orders (02-500070 and 02-500011) with items that can't  
56014 REM "307330-DBSPT-110365 Unhook warehouse code from security by operator
56016 REM "307430-DBD-333;Add 101 to some of 288's company specfic code       
56017 REM "307463-Allow access to all warehouses even if security by operator division restriction. 
