0010 REM "Location Count Stop Setup <FM2IAG>
0035 REM "3.1.0
1020 ENTER X3$,A1$,A9$,Z0$,D$,F9
1040 DIM S$(20)
1080 P=POS(S$(1,16)=A9$,16); IF P>0 THEN A9$=A9$(1,P-1)+A9$(P+16)
1210 GOSUB 6000
1240 I0=NUM(D$(246,2)); IF I0=0 THEN GOTO 9900
1280 READ (F9,KEY="d"+A1$,DOM=1281)A7$,A8$
1290 IF A8$="" THEN CALL "ZZPROM",".4",X3$,0,"There are no count stops setup for this location!","","",0; GOTO 9900
1320 GOSUB 6200
2010 DIM A$(16)
2015 PRINT @(13,14),'CL',
2020 CALL "ZZENTR","SZX",A{ALL},A$,X4$,X3$,13,14,1,I0,C0,"","","","FM2IAG00","","",""
2030 IF C0<0 THEN GOTO 9900
2040 P9=POS(A$=A7$(16),16); IF P9=0 THEN GOTO 2000 ELSE P9=INT(P9/16)
2050 PRINT @(30,14),A8$(P9*20+1,20)
2100 REM 
2120 P=POS(A$=A9$,16); IF P>0 THEN GOTO 2200
2130 CALL "ZZPROM","2",X3$,S3,"","","",0; ON S3 GOTO 2131,2000
2135 A9$=A9$+A$(1,16)
2155 GOSUB 6200
2190 GOTO 2000
2200 REM "DISPLAY COUNT LOCATION
2230 CALL "ZZPROM","Y",X3$,S3,"Do you wish to delete this item at this stop?","","",0; ON S3 GOTO 2231,2000
2235 A9$=A9$(1,P-1)+A9$(P+16)
2240 GOTO 2140
6000 REM 
6010 PRINT 'SB',
6060 PRINT @(0,14),'CE',@(0,14),"Count stop: ",@(0,15),Z0$
6090 PRINT 'SF',
6095 RETURN 
6200 REM "DISPLAY
6205 PRINT @(0,16),'CE',
6210 Q=LEN(A9$)/16; IF Q>6 THEN Q=6 ELSE IF Q=0 THEN GOTO 6290
6220 FOR X=0 TO Q-1
6230 PRINT @(0,16+X),A9$(X*16+1,16),
6235 P=POS(A9$(X*16+1,16)=A7$(16),16); IF P>0 THEN P=INT(P/16); PRINT @(20),A8$(P*20+1,20),
6280 NEXT X
6295 RETURN 
9940 EXIT 
