0001 INPUT @(0,22),'RB',"WHY AM I IN FM2OC1? ",*; ESCAPE 
0010 REM "Handle 9000 locations from O/P special shipping <FM2OC1>
0020 SETESC 9300; SETERR 9000
0040 REM "Copyright 1987 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0042 REM "KMc - 12/30/87
0100 SETERR 9000
0120 REM "Assumes H$,H(ALL) is line , B$ is order, will read in PO2 line, and PO1
0380 IOLIST H$,H[0],H[1],H[2],H[3],H[4],H[5],H[6],H[7],H[8],H[9],H[10],H[11],H[12],H[13],H[14],H[15],H[16],H[17],H[18],H[19],H[20],H[21]
0390 IOLIST O$,O[0],O[1],O[2],O[3],O[4],O[5],O[6],O[7],O[8],O[9],O[10],O[11],O[12],O[13],O[14],O[15],O[16],O[17],O[18],O[19]
0400 IOLIST P$
0600 REM "Read in PO1 and PO2 files
0605 DIM O$(145),O[19],P$(200)
0610 READ (Z[9],KEY=H$(147,8)+H$(9,1)+H$(6,3),DOM=0611)IOL=0390
0620 READ (Z[10],KEY=H$(147,8)+H$(9,1),DOM=0621)IOL=0400
0800 REM "Fix PO2 file to be customer inventory
0805 IF Z7=0 THEN GOSUB 8300
0807 IF X0$="FM2ODC" THEN H$(161,10)=B$(6,10); WRITE (Z[8],KEY=A$(166,8)+A$(7,3))IOL=0380
0810 O$(91,10)=H$(161,10),O$(10,1)="I"
0820 WRITE (Z[9],KEY=H$(147,8)+H$(9,1)+H$(6,3))IOL=0390
1000 REM "Check if need to setup item and do so
1009 ESCAPE 
1010 CALL "PO2RUM",X3$,X4$,O$,O{ALL},P$,0
1500 REM "If I type change to C type
1510 IF H$(155,1)="I" THEN H$(155,1)="C"; WRITE (Z[8],KEY=A$(166,8)+A$(7,3))IOL=0380
2000 REM "Take care of FS5
2002 IF A$(8+K9,1)<>"9" THEN GOTO 2100
2005 IF POS(H$(155,1)="IC")<>0 THEN DIM J$(10); REMOVE (Z[11],KEY=J$+H$(19,10)+"DS  "+H$(147,8)+H$(6,3),DOM=2006)
2010 WRITE (Z[11],KEY=H$(161,10)+H$(19,10)+A$(8+K9,4)+H$(147,8)+H$(6,3))
4000 REM 
4010 GOTO 9900
8300 REM "If line H$ needs to take off P/O stuff then do so
8310 CALL "PO2MAH",X3$,"C",H$(147,8)+H$(9,1),"-1"
8320 Z7=1
8340 RETURN 
8900 REM 
8910 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,"FM2OC1",Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9700 REM "PROG FLOW
9710 IF U1$="" THEN REMOVE (Z[13],KEY=U0$,DOM=9900); GOTO 9900
9720 WRITE (Z[13],KEY=U0$)U0$,U1$
9730 RUN U1$(1,6)
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9950 O2=1; RUN "FM2ODC"
9999 END 
