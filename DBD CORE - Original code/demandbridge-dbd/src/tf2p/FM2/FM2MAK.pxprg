0010 REM "Update FS6 for Stock POs (B/S) <FM2MAK>
0035 REM "4.1 - 02/28/97 - 17.12 - wmz - SSP# 082096
0040 REM "Copyright 1997 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 SETERR 9000
0340 IOLIST D$
0350 IOLIST E$,E[0],E[1],E[2],E[3],E[4]
1010 REM "A$=FS2 DATA, B$=FS1 DATA, T$=type already set , T(all) will be valuesfor each of up to 2 types
1020 ENTER X3$,X4$,A$,A{ALL},B$,B{ALL},T$,T{ALL}
1030 X0$="FM2MAK"
1110 DIM Z[NUM(X3$(60,3))]
1120 Z$="04O FM0... 05O PO3...  "; GOSUB 9700
1200 REM 
1210 DIM E[4],S$(40)
1220 IF POS(B$(54,1)="BS")=0 THEN GOTO 3000
1240 GOSUB 2000
1260 GOSUB 2300
1280 GOTO 9900
2000 REM "Get quantitiy going to hidden warehouse - BS orders must have special shipping
2010 T0=0
2020 READ (Z[5],KEY=A$(147,8)+S$(1,5),DOM=2021)
2040 READ (Z[5],END=2080)IOL=0350
2050 IF A$(147,8)+" "+A$(6,3)<>E$(166,9)+E$(7,3) THEN GOTO 2080
2060 GOSUB 2200
2070 GOTO 2040
2080 REM 
2090 RETURN 
2200 REM "Get Hidden Whse Quantity
2220 READ (Z[4],KEY="D"+S$(1,10)+E$(12,4),DOM=2290)IOL=0340
2230 IF D$(234,1)<>"Y" THEN GOTO 2290
2240 T0=T0+E[0]
2290 RETURN 
2300 REM "Set up to 2 order types per line
2320 IF T0<>0 THEN T[0]=T[0]-T0; IF T[0]=0 THEN T[0]=T0,T$="Z" ELSE T$=T$(1,1)+"Z",T[1]=T0
2330 IF POS(T$(1,1)="DF")>0 THEN T$(1,1)="B"
2340 RETURN 
3000 REM " Is the source warehouse hidden? If so, make order history type a B
3020 IF POS(" "<>A$(10,4))=0 OR POS(A$(155,1)="IC")=0 THEN GOTO 3090
3030 READ (Z[4],KEY="D"+S$(1,10)+A$(10,4),DOM=3090)IOL=0340
3040 IF D$(234,1)="Y" THEN T$(1,1)="B"
3090 GOTO 9900
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9700 REM 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9910 Z$="END"; GOSUB 9700
9930 SETERR 9940; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
