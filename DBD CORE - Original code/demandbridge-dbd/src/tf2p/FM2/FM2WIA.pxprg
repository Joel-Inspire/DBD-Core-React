0010 REM "Scan Open Orders for expired Web Ec Orders <FM2WIA>
0015 REM "Prog Type: OD-2.7     
0035 REM "5.1 - 08/20/02 - 12.6575 - lms - SSP# 146930
0040 REM "Copyright 2002 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 9000
0095 PRECISION 14; T2=TIM; PRECISION 2
0100 SETERR 9000; SETESC 9300
0110 X0$="FM2WIA",X1$="Scan Open Orders for Expired WebEc Orders"
0120 DIM A$(128),A[7],C$(170),C[21],D$(397),D[15],S[5]
0140 Z0$="###,###.00-",Z1$="##,###,###.00-",Z2$="##,##0-",Z3$="##0-",Z4$="###.00-",Z5$=Z0$(1,LEN(Z0$)-1)+"#"
0210 T=1,T0=1,T1=3; REM " SSP# 143009
0220 W3=128
0225 W=999
0230 DIM T1$(W3,"-"),T2$(W3,"="),T3$(W3,"*"),Y5$(W3),Y6$(W3),W[4]
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,"",-1,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0260 REM "CALL "ZZRPTP",X3$,X0$,X1$,V9$,V0,Q0$,Q1$,Q2$,Q3$,Q4$,Q5$,Q6$
0270 X1$="Open Sales Order Report"
0300 REM "I/O lists
0305 REM "IOLIST FOR FS1 - FD Sales Order Header
0310 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7]
0325 REM "IOLIST FOR FS2 - FD Sales Order Line Entry
0330 IOLIST C$,C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15],C[16],C[17],C[18],C[19],C[20],C[21]
0335 REM "IOLIST FOR AR1 - Customer Masterfile
0340 IOLIST D$,D[0],D[1],D[2],D[3],D[4],D[5],D[6],D[7],D[8],D[9],D[10],D[11],D[12],D[13],D[14],D[15]
0350 IOLIST S5$,S[0],S[1]
0360 IOLIST F$
0420 IOLIST X3$,X4$,V1$,V3$,V2$,IOL=0425
0425 IOLIST V$,V[0],V[1]
0500 REM "Files
0505 DIM Z[NUM(X3$(60,3))]
0509 REM "Z(10) reserved for Sort File
0510 Y$="01O FS1...  "
0520 GOSUB 9750
0600 READ (Z[13],KEY=X3$(9,3)+"A/R",DOM=9900)P$
0800 REM "Alternate Sort Info & total dim"
0950 REM " Position read"
0990 READ (Z[1],KEY="",DOM=0991)
1000 REM "Read next record and check range
1005 U$=KEY(Z[1],END=5000)
1100 REM "Get record"
1150 READ (Z[1],KEY=U$,ERR=1151,DOM=1000)IOL=0310
1160 PRINT A$(118,8)
1190 IF A$(284,1)<>"Y" THEN GOTO 1000
1200 REM " FOUND ONE ON HOLD...CHECK DATE/TIME
1525 CALL "ZZDISP","AX",A$(6,10),"A/R",X3$,X$,"",0,0,X4$; Y5$(23)=X$
1995 GOTO 1000
5000 REM "End of Print
5295 GOTO 9900
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 1000
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9520 IF Y5=68 THEN RETRY ELSE ON C9 GOTO 1140,2040
9750 REM "Files Routine
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Y$,Z{ALL},Z0,Z1
9770 ON Z0 GOTO 9771,9900
9790 RETURN 
9900 REM "End program
9920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9940 RUN "ZMENU"
9999 END 
