0010 REM "Calculate New Period Ending Date Record <FM2UBZ>
0035 REM "3.7 - 11/15/93 - 11.15 - jsc
0040 REM "Copyright 1993 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1020 ENTER X3$,P$,A$,K9
1040 IF K9<0 THEN K8=1,K9=-K9 ELSE K8=0
2000 GOSUB 7700
2090 GOTO 9900
7700 REM "CALC DATES
7702 Q$=A$(7+K9,6); IF K8<=0 THEN GOTO 7706
7704 IF Q$(2,1)="0" THEN Q$(2,1)="9",Q$(1,1)=CHR(ASC(Q$(1,1))-1) ELSE Q$(2,1)=CHR(ASC(Q$(2,1))-1)
7705 REM "LET Q$=A$(7+K9,6); IF K8>0 THEN LET Q$(2,1)=CHR(ASC(Q$(2,1))-1) 
7706 Q0=NUM(A$(5+K9,2)),Q1=12/Q0,Q2=NUM(Q$(3,2))+1
7710 W0=ASC(Q$),W1=NUM(Q$(2,1))
7735 IF Q1<>INT(Q1) THEN GOTO 7800
7740 FOR I=1 TO Q0
7745 Q2=Q2+Q1
7750 IF Q2>13 THEN Q2=Q2-12,W1=W1+1; IF W1>9 THEN W1=0,W0=W0+1
7755 CALL "ZZDATE",X3$,"",CHR(W0)+STR(W1)+STR(Q2:"00")+"00",W$,0,0,0,0,0,0,0,"","",""
7756 IF Q$(5,2)<"28" THEN W$(5,2)=Q$(5,2)
7760 A$(7+K9+I*6,6)=W$
7770 NEXT I
7775 IF K8<>1 THEN RETURN 
7780 IF A$(19,1)="0" THEN A$(19,1)="9",A$(18,1)=CHR(ASC(A$(18,1))-1) ELSE A$(19,1)=STR(NUM(A$(19,1))-1:"0")
7790 RETURN 
7800 REM "13 PERIODS
7810 IF Q0<>13 THEN GOTO 7890
7820 FOR I=1 TO 13
7830 CALL "ZZDATE",X3$,"",Q$,W$,28,0,0,0,0,0,0,"","",""
7835 Q$=W$
7840 GOTO 7760
7890 RETURN 
7900 REM "
9940 EXIT 
9999 END 
