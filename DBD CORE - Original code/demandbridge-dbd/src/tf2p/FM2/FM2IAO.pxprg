0010 REM "Display Ship-to Address <FM2IAO>
0035 REM "5.6 - 02/11/09 - 0.418055 - crg - SSP# 208586
0037 REM "208586-AR Invoice is not showing up if you look at order           
0040 REM "Copyright 2009 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0095; ENTER X3$,X4$,L9,K9$; GOTO 0100
0095 BEGIN ; K9$="000010000000000077",L9=8
0100 SETERR 9000
0120 X0$="FM2IAO",X1$="Order Shipment History"
0200 DIM S0$(80),E[1],A[8]
0220 M0$="##,###,##0-"
0240 IF X3$="" THEN CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8]
0350 IOLIST E$,E[0]
0500 REM "FILES
0505 Z=NUM(X3$(60,3)); DIM Z[Z]
0510 Z$="01O FS6...  05O ASJ...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 0521,9900
0990 T1=0,T1$="Y"; REM "First count number of shipment histroy records
1000 REM "Get shipment record
1020 READ (Z[5],KEY=K9$,DOM=1021)
1040 K$=KEY(Z[5],END=2000)
1060 IF K$(1,LEN(K9$))<>K9$ THEN GOTO 2000
1080 READ (Z[5],KEY=K$)IOL=0350
1100 READ (Z[1],KEY=E$(1,10)+E$(39,1)+E$(29,10)+E$(11,8)+E$(19,1),DOM=1040)IOL=0310
1120 IF T1$="Y" THEN T1=T1+1; GOTO 1040
1140 T2=T2+1
1160 GOSUB 6200
1165 IF %HAS_IMAGE_LIB THEN %IL_IMAGE_TYPE$="ORDER",%IL_IMAGE_KEY$=MID(A$,22,8); IF NOT(NUL(MID(E$,21,8))) THEN %IL_IMAGE_TYPE$+=SEP+"AR_INVOICE",%IL_IMAGE_KEY$+=SEP+PAD(MID(A$,1,10),10)+PAD(MID(E$,21,8),8) ! 208586
1170 X$="Shipment record "+STR(T2)+" of "+STR(T1)
1180 CALL "ZZPROM","X2AR2MAD",X3$,Z,X$,"","",0; ON Z-1 GOTO 1181,1200,9900
1190 GOTO 1040
1200 REM "REDISPLAY
1220 T2=0; GOTO 1000
2000 REM "General Shipping
2020 IF T1$="Y" THEN IF T1=0 THEN GOTO 2100 ELSE T1$=""; GOSUB 6000; GOTO 1000
2080 GOTO 9900
2100 REM "No shipment history
2120 CALL "ZZPROM",".4",X3$,0,"No Shipment History Available","","",0
2140 GOTO 9900
6000 REM "PRINT BACKGROUND
6020 PRINT @(0,L9),'CE','SB',@(0,L9),"Ship-To Code:",@(0,L9+1),"Ship-To Name:",@(3,L9+2),"Attention:",@(5,L9+3),"Address:",@(5,L9+4),"Address:",@(1,L9+5),"City/St/Zip:",@(4,L9+6),"Mark For:",@(2,L9+7),"Inside Del:",
6040 PRINT @(52,L9),"Invoice No:",@(50,L9+1),"Invoice Date:",@(53,L9+2),"Ship Date:",@(54,L9+3),"Ship Via:",@(51,L9+4),"Shipped Via:",@(50,L9+5),"Cust Svc Rep:",@(51,L9+6),"Qty Shipped:",
6190 RETURN 
6200 REM PRINT DATA
6210 PRINT 'SF',@(14,L9),E$(40,5),@(14,L9+1),E$(45,35),@(14,L9+2),E$(80,30),@(14,L9+3),E$(110,30),@(14,L9+4),E$(140,30),
6220 CALL "ZZDISP","AX",E$(188,9),"ZIP",X3$,X$,"",0,0,X4$
6230 PRINT @(14,L9+5),FNS$(E$(170,16))+" "+E$(186,2)+" "+X$
6240 PRINT @(14,L9+6),E$(230,35),@(14,L9+7),E$(199,15),
6250 CALL "ZZDISP","A",E$(21,8),"AR6",X3$,"","",64,L9,X4$
6260 PRINT @(64,L9+1),FND$(E$(289,6)),@(64,L9+2),FND$(E$(295,6)),@(64,L9+3),E$(265,15),@(64,L9+4),E$(301,15),@(64,L9+5),E$(316,4),@(64,L9+6),E[0]:M0$,
6390 RETURN 
8910 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
8925 DEF FNS$(Z9$)=Z9$(1,POS("  "=Z9$+"  ")-1)
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,1
9045 REM 
9050 ON Y7 GOTO 9060,9100,9190,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0; EXIT ERR
9100 REM " TRANSFER CONTROL
9190 GOTO 9090
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 IF Y5=68 THEN RETRY ELSE ON C9 GOTO 1140,2040
9900 REM "END PROGRAM
9904 %IL_IMAGE_TYPE$="",%IL_IMAGE_KEY$=""
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 EXIT 
9940 SETESC 9350
9950 REM RUN "ZMENU"
9999 END 
56002 REM "208586-AR Invoice is not showing up if you look at order           
