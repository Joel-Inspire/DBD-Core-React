0010 REM "Custom Item File - Status information <FM2IAE>
0020 SETESC 9300; SETERR 9000
0025 REM "(C) Copyright 1986 - All Rights Reserved
0030 REM "By Computer Software Inc., Norcross, Georgia
0035 REM "This software contains trade secrets and proprietary information"
0040 REM "and may not be reproduced in any form.
0100 SETERR 9000
0200 ON J GOTO 9900,1000,1000,1100
1000 REM "Vendor code
1020 Q1$="*"
1030 CALL "AP2MAB",X3$,X4$,Q0$,Q1$
1040 IF Q1$="" THEN C0=0 ELSE C0=1; IF J=1 THEN A$(82,10)=Q1$ ELSE A$(116,10)=Q1$
1050 GOTO 9900
1100 REM "Plant location
1110 Q1$=J9$
1120 CALL "FM2SKA",X3$,X4$,Q0$,Q1$
1130 IF LEN(Q1$)>11 THEN A$(92,4)=Q1$(12),C0=1 ELSE C0=0
1150 GOTO 9900
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 GOSUB 6400
9520 ON C9 GOTO 1140,2040
9700 REM "PROG FLOW
9705 IF U0$="" THEN GOTO 9900
9710 IF U1$="" THEN REMOVE (Z[13],KEY=U0$,DOM=9900); GOTO 9900
9720 WRITE (Z[13],KEY=U0$)U0$,U1$
9725 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9730 RUN U1$(1,6)
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9950 RUN "FM2IAB"
9999 END 
