0010 REM "Write Forms Mgt Customer Report Records <FM2ZUA>
0035 REM "5.4 - 02/21/06 - 8.570277 - jme - SSP# 189071
0037 REM "189071-She is trying to process the FM-P5 for customer 01-195400   
0040 REM "Copyright 2006 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 SETERR 9000
0320 IOLIST B$
0330 IOLIST C$,IOL=0490
0490 IOLIST R0$,W$,W[0],W[1],W[2],W[3],W[4]
1009 REM S0$=1 FOR BY REPORT CODE, S1$=QUEUE FILE - NULL=ZZQ
1010 REM "A$=CUSTOMER CODE
1020 ENTER X3$,A$,S0$,S1$
1040 IF S1$="" THEN S1$="ZZQ"
1205 DIM Z[NUM(X3$(60,3))]
1210 Z$="01O "+S1$+"... 02X FMJ... 03O ZZS... 040 EML... "
1240 GOSUB 9750
1290 DIM W[4],S$(20)
1400 REM 
1410 READ (Z[2],KEY=A$,DOM=1411)
1420 READ (Z[2],END=5500)IOL=0320
1430 IF B$(1,10)<>A$ THEN GOTO 5500
1450 REM GOSUB UPDATE_EML; REM 178627
1500 REM "
1520 FIND (Z[3],KEY=B$(65,6)+B$(15,12),DOM=1420)IOL=0330
1530 K9$=B$(65,6); CALL "ZZRSEQ",X3$,K9$,"?",0,0,0,U{ALL},V{ALL},0,0,L0$,L1$,"","",X9; ON X9 GOTO 1420,1531
1540 W$(1,20)=A$+A$
1590 GOSUB 5000
1690 GOTO 1420
5000 REM "Write Print Data
5015 T0=NUM(C$(71,1))
5020 T1$=L0$((T0-1)*6+1,6),K$=X3$(1,8)
5025 K$=DAY,K$=K$(7,2)+K$(1,2)+K$(4,2),K$=R0$(2,6)+X3$(162,1)+R0$(17,1)+K$+STR(TIM*100:"0000")+" "+K9$(1,6)+X3$(9,3)+X3$(40,3); IF R0$(2,1)="U" THEN K$(1,2)=X3$(172,2)
5030 Q$=K9$; IF S0$<>"1" THEN Q$=S$(1,LEN(K9$))
5035 IF R0$>"" THEN R0$(1,1)="Q"
5070 WRITE (Z[1],KEY=Q$+K$(1,19),DOM=5075)K$,X3$,X4$,T1$,R0$,W$,C$; GOTO 5090
5075 K$(19,1)=CHR(ASC(K$(19,1))+1); GOTO 5070
5090 RETURN 
5500 REM 
5590 GOTO 9900
6000 UPDATE_EML:
6010 READ (Z[4],KEY="CR"+B$(1,10)+DIM(10)+B$(65,6)+DIM(4),KNO=3,DOM=*NEXT,ERR=*RETURN)
6020 KY4$=KEY(Z[4],END=6090); IF KY4$(1,28)<>"CR"+B$(1,10)+DIM(10)+B$(65,6) THEN GOTO *RETURN
6050 EXTRACT (Z[4],KEY=KY4$,ERR=*RETURN)EML$
6060 EML$(389,1)="Y"; WRITE (Z[4],KEY=KY4$)EML$
6070 GOTO 6020
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9120 ON Y8 GOTO 9900,0990,9920
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9905 Y8=2
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 SETERR 9940; Q1$=A1$; EXIT 
9940 SETESC 9350
9999 END 
56000 REM "189071-She is trying to process the FM-P5 for customer 01-195400   
