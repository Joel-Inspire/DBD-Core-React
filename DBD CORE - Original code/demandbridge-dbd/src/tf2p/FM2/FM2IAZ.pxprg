0010 REM "Custom Item Setup/Inquiry <FM2IAZ>
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 03/07/14 - 11.967222 - tma - SSP# 267008
0037 REM "267008-Stock items are not showing the pricing in the shopping cart
0040 REM "Copyright 2014 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="FM2IAZ",X1$="Custom Item Setup/Inquiry",K9$="",K9=0
0120 DIM S$(20)
0130 K0=20,K1=2
0135 C9=-1,NOTE_CHECK$=""
0140 M0$="##,##0-",M1$="###,###.00-",M2$="##,###,##0-",M3$="###.00-"
0145 IF Q1$="" THEN GOSUB 8950
0200 REM "
0230 IF Q1$<>"" THEN X2=-1; IF L0=3 THEN PRINT @(40,5+V0),'CL',@(0,7),'CE', ELSE IF L0<>1 THEN PRINT @(0,3),'CE', ELSE PRINT @(0,3),'CE',
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13],A[14],A[15],A[16],A[17],A[18],A[19],A[20],IOL=0312
0312 IOLIST A[21],A[22],A[23],A[24],A[25],A[26],A[27],A[28],A[29],A[30],A[31]
0320 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14],B[15]
0330 IOLIST C$,C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15],C[16],C[17],C[18],C[19],C[20],C[21],C[22],C[23],C[24],C[25],C[26],C[27],C[28],C[29],C[30],C[31]
0331 IOLIST C$
0340 IOLIST D$,D[0],D[1],D[2]
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0509 REM "Z(9)-Z(12) needed for item copy @ 8300
0510 Z$="01X FM1...  02O AR1... 12O IC0...  03O FMP...  04O AP4...  05O FM2...  06O ZZPARM  07O ARE... 08O FMS...  09O FMU...  10O FMV...  11O FSF...  19O SP0...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0525 IF RETURN$="Y" THEN RETURN ; REM "SSP126960, call to FM2UAB closing files
0530 DIM SEC$(255); READ (Z[6],KEY="osec"+X3$(40,3),DOM=0531)SEC$; REM "WO129971
0580 READ (Z[6],KEY=X3$(9,3)+"A/R",DOM=9800)P0$
0582 READ (Z[6],KEY=X3$(9,3)+"F/M",DOM=0583)OPS_PARM$
0584 READ (Z[6],KEY=X3$(9,3)+"FMS",DOM=*NEXT)FMS_PARM$
0585 W9$=""; CALL "RT2PRM",ERR=0586,X3$,X4$,W9$
0590 READ (Z[1],KEY=K9$,DOM=0591)
0600 REM "
0620 IF L0<>1 THEN GOSUB 6000
0690 READ (Z[1],KEY=K9$,DOM=0691)
1000 REM "
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1030 DIM B$(397),B[15],C$(100),D$(227),D[2],C[31]
1035 DIM A$(448),A[31]
1045 A$(1,10+K9)=K9$+A1$
1050 IF Q1$<>"" THEN IF L0>1 THEN A$(1+K9)=Q1$; GOSUB 6460; GOTO 1100 ELSE GOTO 1100
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9800
1140 ON X0 GOTO 1200,1250,1500
1200 REM "Customer code
1205 IF Q1$>"" THEN A$(1+K9)=Q1$; GOSUB 6460; GOTO 1220
1206 IF LEN(A1$)>=10 THEN A$(1+K9,10)=A1$; GOTO 1220
1210 CALL "ZZENTR","AXUX",A{ALL},A$,X4$,X3$,15,3+V0,1+K9,10,C0,"A/R","{1"+X$,"","FM2IAZ00","AR1","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1210,1211
1212 READ (Z[1],KEY=A$(1+K9,10),DOM=1213)
1215 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1216,6800,9800,6970
1220 FIND (Z[2],KEY=A$(1+K9,10),DOM=1210)IOL=0320
1222 FIND (Z[3],KEY="D"+A$(1,10),DOM=1223)P5$
1225 PRINT @(34,3+V0),B$(11,35),
1240 GOTO 1120
1250 REM "Forms code
1255 IF LEN(Q1$)>10 THEN A$(11+K9,10)=Q1$(11); GOTO 1120
1256 J$=A$(1+K9,10),NOTE_CHECK$="Y"
1260 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,0,6+V0,11+K9,10,C0,"","{2"+X$,J$,"FM2IAZ02","FM1","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1260,1261
1261 IF ABS(C0)=2 AND Q1$<>"" THEN GOTO 9700
1262 IF ABS(C0)=2 AND LEN(A1$)>0 THEN A1$=A1$(1,0)
1265 IF C0=-1 THEN GOTO 1260 ELSE IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1266,6800,9800,6970
1290 GOTO 1120
1500 REM "
1505 Z9=-1; IF LEN(Q1$)>10 THEN Q1$=""
1510 A1$=K9$+A$(LEN(K9$)+1,20),A$(1,LEN(K9$))=K9$
1520 READ (Z[1],KEY=A1$,DOM=1600)IOL=0310; CALL "UPDSP0;GET_IGP",Z[19],A$(1,20),A[3],A[1],NEWPRICE,A[2],A[4],FOUNDSP0; IF FOUNDSP0 AND NEWPRICE<>A[3] THEN A[3]=NEWPRICE
1525 Z9=0,A2$=A$(21,3)+A$(24,16)+A$(40,2)+A$(11,10)+A$(1,10)
1530 FIND (Z[3],KEY=A$(21+K9,3),DOM=1531)IOL=0331
1535 FIND (Z[4],KEY=A$(82+K9,10),DOM=1536)IOL=0340
1590 GOTO 1700
1600 REM "Add new item?
1603 REM "If parm is set to use CIC's, check to see if the proposed item code is already being used as a CIC for this customer @ 1640
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1640,1630
1630 IF LEN(U1$)<6 THEN GOTO 1000 ELSE IF U1$(1,6)="FM2PLA" THEN GOTO 9700 ELSE GOTO 1000
1640 IF OPS_PARM$(246,1)="Y" THEN USED$="",CIC_ITEM$="",TF_ITEM$=""; CALL "FS2DAK",X3$,X4$,2,A1$,USED$,CIC_ITEM$,TF_ITEM$; IF USED$="Y" THEN CALL "ZZPROM",".4",X3$,0,STP(TF_ITEM$,1)+" is using "+STP(CIC_ITEM$,1)+" as it's CIC, you may not add this item code.","","",0; GOTO 1260
1650 GOSUB 5200
1690 Q$="FM2IAA",NEW$="Y"; GOTO 3100
1700 REM "
1780 IF L1=1 THEN PRINT @(0,7),'CE','SB',; GOSUB 6080; GOSUB 6220; GOTO 1800
1790 IF L0<>1 THEN GOSUB 6200
1795 IF A$(195,1)="I" THEN CALL "ZZPROM",".4",X3$,0,"NOTE: This item has been set to INACTIVE status for removal!","","",0
1800 REM "
1801 L0=0
1865 C9=1
1880 IF NOTE_CHECK$="Y" AND OPS_PARM$(283,1)="Y" THEN CALL "FS2DAN",X3$,A1$,9
2005 GOSUB 6000; GOSUB 6200
2010 P0=20,P1=9,P=0,P$="",P9$="",P0$=""
2020 PRINT @(0,P1),'CE',
2025 IF A$(195,1)="I" THEN PRINT @(0,P1+1),"*INACTIVE*"
2030 Q$="Item Setup/Inquiry",P$="RFM2IAA"; GOSUB 3000
2035 Q$="Reorder and Other Item data",P$="RFM2IAC"; GOSUB 3000
2045 Q$="Item Inventory ",P$="RIC2MAZ"; GOSUB 3000
2060 Q$="Item Spec - Ply Section",P$="RFM2IAS"; GOSUB 3000
2065 Q$="Item Spec - Composition Section"; P$="RFM2IAU"; GOSUB 3000
2070 Q$="Item Spec - Comment Section",P$="RFM2IAW"; GOSUB 3000
2080 Q$="Sales Order History Display",P$="RFM2IAK"; GOSUB 3000
2082 REM LET Q$="Requisition History",P$="CFM2IAJ"; GOSUB 03000
2085 REM LET Q$="Forms Management Item Setup",P$="RFM2IAG"; GOSUB 03000
2087 Q$="Customer Location Data",P$="RFM2IAF"; GOSUB 3000
2090 Q$="Item Usage History",P$="CFM2MDA"; GOSUB 3000
2092 Q$="Item Reorder Notes and Other",P$="RFM2IAN"; GOSUB 3000
2095 Q$="Delete All Item Data",P$=" DELETE"; GOSUB 3000
2100 REM "
2120 CALL "ZZPROM","M0",X3$,Z,"","","",22
2122 DIM Q$(2)
2125 CALL "ZZENTR","ZX",A{ALL},Q$,X4$,X3$,59,22,1,2,C0,"",""+X$,"","AR2MAA10","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2125,2126
2127 Q0=NUM(Q$,ERR=2125); PRINT @(18,21),'CE',
2130 IF C0<0 THEN L0=0; GOTO 6700
2134 IF Q0>P THEN GOTO 2120
2160 Q0=NUM(Q$,ERR=2100); IF Q0=0 THEN GOTO 6700 ELSE X$=""
2162 IF Q$(1,2)="04" AND NUM(A$(40,2))<=0 THEN Q$(1,2)="NA",X$="The number of plys is zero!"; GOTO 2240
2163 IF Q$="08" THEN IF POS(A$(108,1)="YU")=0 THEN GOTO 7500
2164 IF POS(A$(108,1)="YU")=0 AND POS(Q$="0809",2)<>0 THEN Q$(1,2)="NA",X$="This is not an IMS item!"; GOTO 2240 ! SSP#230845
2165 Q$=P0$((Q0-1)*6+1,6)
2240 IF Q$(1,2)="NA" THEN CALL "ZZPROM","4",X3$,Q1,"Option "+STR(Q0)+" is not available: "+X$,"","",0; X$=""; GOTO 2120
2243 PRINT @(0,P1),'CE',
2245 IF Q$="DELETE" THEN GOTO 6500
2250 IF Q$="FM2MDA" THEN GOTO 3400
2265 IF P9$(Q0,1)="R" THEN GOTO 3100
2270 IF Q$="FM2IAJ" THEN CALL Q$,X3$,X4$,Q0$,A1$(1,10)+"D"+A1$(11,10); GOTO 2000
2275 CALL Q$,ERR=2280,X3$,X4$,Q0$,A1$
2280 IF Q$="FM2IAA" THEN READ (Z[1],KEY=A1$,ERR=2281)IOL=0310
2285 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,-1,X1,X2
2290 GOTO 2000
3000 REM "print menu line
3020 P=P+1,P0$=P0$+P$(2),P9$=P9$+P$(1,1)
3040 PRINT @(P0,P1+P),P:"##.#",Q$
3090 RETURN 
3100 REM "SETUP RUN SEQUENCE
3105 P$=Q$,L0=0
3110 U0$=X3$(1,6)+"PF"; FIND (Z[6],KEY=U0$,DOM=3111)U0$
3120 Q$=STR(LEN(A1$):"00")+A1$; IF P$="FM2IAF" OR P$="FM2IAD" THEN Q$=Q$+X0$+STR(LEN(A1$)+1:"00")+A1$+"~" ELSE IF P$="FM2IAS" OR P$="FM2IAU" OR P$="FM2IAH" THEN Q$=Q$+X0$+STR(LEN(A1$)+1:"00")+A1$+"!" ELSE Q$=Q$+X0$+Q$
3125 IF P$="IC2MAZ" THEN IF POS(A$(105,1)="YS")>0 THEN GOSUB 7600; IF Q$="" THEN GOTO 2000
3130 U1$=P$+Q$+U1$
3135 IF NEW$="Y" THEN U1$=U1$(1,28)+"FM2IAC"+U1$(7,22)+U1$(29)
3140 WRITE (Z[6],KEY=U0$)U0$,U1$
3190 SETERR 3195; RUN P$
3195 SETERR 9000
3400 REM "CALL HISTORY STUFF
3410 CALL "ZZDAPP",X3$,"DZZCOMPZZFLESZZDISPZZPROM"
3420 CALL Q$,ERR=2280,X3$,X4$,Q0$,A1$,Y0$
3425 CALL "ZZDAPP",X3$,"AALL"
3430 GOSUB 6400
3440 GOTO 2000
5200 REM "Transfer from another customer?"
5204 DIM N$(20),N0$(100),C$(167),C[31]
5205 GOSUB 5390
5206 REM "Customer Code
5207 C7=1,N0=1
5210 CALL "ZZENTR","AXU",A{ALL},N$,X4$,X3$,30,12,1,10,C0,"A/R","{3"+X$,"","FM2ODB03","AR1","",""; IF ABS(C0)>4 THEN GOSUB 6400; GOSUB 5390; ON C0 GOTO 5210,5211
5215 IF POS(" "<>N$(1,10))=0 THEN EXITTO 1651
5220 FIND (Z[2],KEY=N$(1,10),DOM=5210)N0$
5225 PRINT @(42,12),N0$(11,35),
5250 REM "Item code
5255 C0$=N$(1,10),C7=2,N0=1,N$(11,10)=A$(11,10)
5260 CALL "ZZENTR","SUX",A{ALL},N$,X4$,X3$,30,13,11,10,C0,"","{3"+X$,C0$,"FM2ODB13","FM1","",""; IF ABS(C0)>4 THEN GOSUB 6400; GOSUB 5390; ON C0 GOTO 5260,5261
5262 IF ABS(C0)=4 THEN GOTO 1000
5265 IF C0=-2 THEN GOTO 5206 ELSE IF POS(" "<>N$(11,10))=0 THEN GOTO 5050
5270 FIND (Z[1],KEY=N$,DOM=5260)IOL=0330
5275 PRINT @(42,13),C$(42,40),
5300 REM "Convert to new & write out
5305 Q$=C$
5310 C$(1,20)=A$(1,10)+A$(11,10),C$(109)="",C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=0,C[16]=0,C[17]=0,C$(254,1)="0",C$(255,6)=X3$(15,6),C[30]=0
5311 C$(387,1)=Q$(387,1); REM SSP 201823
5312 IF C$(105,1)<>"Y" THEN C$(185,10)=C$(1,10) ! SSP#208991!SSP#267008
5315 C$(238,16)=Q$(238,16),C$(212,3)=Q$(212,3),C[24]=0
5316 DIM CUST_DEF[3]; READ (Z[3],KEY="D"+C$(1,10),DOM=5317)CUST_DEF$,CUST_DEF[0],CUST_DEF[1],CUST_DEF[2],CUST_DEF[3]; C[30]=CUST_DEF[1]
5317 READ (Z[3],KEY="A"+C$(1,10),DOM=5320)CUST_FMS_PARAM_III$
5318 C$(108,1)=CUST_FMS_PARAM_III$(12,1); IF NUM(CUST_FMS_PARAM_III$(13,3))>0 THEN C[22]=NUM(CUST_FMS_PARAM_III$(13,3))
5320 WRITE (Z[1],KEY=C$(1,20))IOL=0330; IF W9$<>"" THEN CUST$=C$(1,10); CALL "RT2WOC",ERR=5321,X3$,X4$,CUST$,"FM1...","U",C$(1,20)
5330 GOSUB 8300
5380 RETURN 
5390 PRINT @(0,11),'CE',@(0,12),"Copy this item from customer:",@(24,13),"item:",
5391 CALL "ZZDISP","A",N$(1,10),"A/R",X3$,"","",30,12,X4$
5392 PRINT @(42,12),N0$(11,35),@(24,13),"item:",@(30,13),N$(11,10),@(42,13),C$(42,40),
5395 RETURN 
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6060 PRINT @(0,3+V0),"Customer code:",@(28,3+V0),"Name:",@(0,4+V0),Z0$,
6070 PRINT @(0,5+V0),"Item code",@(11,5+V0),"P/C",@(16,5+V0),"Left-Rgt Top-Botm Plys",@(40,5+V0),"Item description",@(62),"Rev date:",
6080 PRINT @(0,7+V0),"Vendor:",@(21,7+V0),"Name:",@(62,7+V0),"Plant:",@(0,8+V0),Z0$,
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6220 PRINT @(11,6+V0),A$(21+K9,3),@(16,6+V0),A$(24+K9,8),@(25,6+V0),A$(32+K9,8),@(35,6+V0),A$(40+K9,2),@(39,6+V0),A$(42+K9,40),@(72,5+V0),A$(167,6),
6224 CALL "ZZDISP","A",A$(82+K9,10),"A/P",X3$,"","",8,7+V0,X4$
6228 PRINT @(27,7+V0),D$(11,35),@(69,7+V0),A$(92+K9,4),
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6460 CALL "ZZDISP","A",A$(1+K9,10),"A/R",X3$,"","",15,3+V0,X4$
6464 PRINT @(34,3+V0),B$(11,35),@(0,6+V0),A$(11+K9,10),
6490 RETURN 
6500 REM "DELETE
6505 IF SEC$(71,1)="Y" THEN CALL "ZZPROM",".4",X3$,0,"Access Denied! You may not delete a form.","","",0; GOTO 1800; REM "WO129971,131630
6510 IF A$(195,1)="I" THEN A8$="Reactivate" ELSE A8$="Delete"
6520 CALL "ZZPROM",".Y",X3$,Z,"|Verify you wish to "+A8$,"","",0
6521 IF Z=1 THEN GOTO 1800
6523 ON Z GOTO 6524,6530
6525 IF A$(195,1)="I" THEN A$(195,1)="A"; GOSUB 8400; WRITE (Z[1],KEY=A1$)IOL=0310; IF W9$<>"" THEN CUST$=A1$(1,10); CALL "RT2WOC",ERR=1800,X3$,X4$,CUST$,"FM1...","U",A1$; GOTO 1800 ELSE GOTO 1800
6530 A4$="",A5$="A/R",A6$=A1$,A7$="M"
6540 CALL "FM2UAB",ERR=6541,X3$,X4$,A5$,A6$,A4$,A7$; RETURN$="Y",Y0$=""; GOSUB 0500; RETURN$="N"; REM "SSP126960, FM2UAB closing files
6550 IF A4$="Y" THEN A8$="Record deleted!",A9$="4"; GOTO 6580
6560 A8$="Activity detected. (Open Orders) - Record set to inactive for later removal.",A9$=".4"
6570 A$(195,1)="I"; GOSUB 8400; WRITE (Z[1],KEY=A1$)IOL=0310; IF W9$<>"" THEN CUST$=A1$(1,10); CALL "RT2WOC",ERR=6571,X3$,X4$,CUST$,"FM1...","U",A1$
6580 CALL "ZZPROM",A9$,X3$,Z,A8$,"","",0; GOTO 6590
6590 IF A4$="Y" THEN GOTO 1630 ELSE GOTO 1800
6600 REM "ALT KEY DATA READS
6605 FIND (Z[2],KEY=A$(1+K9,10),DOM=6606)IOL=0320
6610 FIND (Z[3],KEY="D"+A$(1,10),DOM=6611)P5$
6690 RETURN 
6700 REM "ADD ENTRY
6705 IF Z9=0 THEN GOTO 6790
6709 IF A$(105,1)="Y" THEN A$(185,10)=DIM(10) ELSE IF A$(185,10)=DIM(10) THEN A$(185,10)=A$(1,10) ! SSP260170, if stock? set to Y then from customer must be blank.  If stock? is not Y then if from customer is blank, set it to the customer.
6710 WRITE (Z[1],KEY=A1$)IOL=0310; IF W9$<>"" THEN CUST$=A1$(1,10); CALL "RT2WOC",ERR=6711,X3$,X4$,CUST$,"FM1...","U",A1$
6715 GOSUB 8400
6790 GOTO 1630
6800 REM "NEXT ENTRY IN FILE
6805 ON 10*FPT(C0)+2 GOTO 6850,6806
6810 A1$=KEY(Z[1],END=6895)
6820 IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 6895
6821 IF A1$(1,LEN(Q1$))<>Q1$ THEN PRINT 'RB'; READ (Z[1],KEY=Q1$,DOM=1140); GOTO 1140
6825 A$(1,LEN(A1$))=A1$
6830 GOSUB 6600
6835 GOSUB 6450
6840 GOTO 1515
6850 REM PRIOR ENTRY
6855 PREVIOUS_KEY$=KEP(Z[1],ERR=6856); A1$=PREVIOUS_KEY$; GOTO 6820; REM "CALL "ZZKEYP",ERR=06856,Z[1],A1$; GOTO 06820
6860 CALL "ZZKEYL",ERR=6861,Z[1],A1$; GOTO 6820
6870 GOTO 6895
6890 GOTO 1515
6895 PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=1140); GOTO 1140
7500 REM "Non-FMS Casual COunt
7505 PRINT @(0,P1),'CE','SB',@(26,P1+3),"Last casual count date:",@(12,P1+5),"Total count - all customer locations:",'SF',
7510 CALL "ZZDISP","D",A$(323,6),"",X3$,"","",50,P1+3,X4$
7515 PRINT @(50,P1+5),A[20]:M2$,
7520 CALL "ZZPROM","6A",X3$,S3,"","","",0; ON S3 GOTO 2000,7521
7525 IF Z9=0 THEN Z9=1; EXTRACT (Z[1],KEY=A1$)IOL=0310
7530 CALL "ZZENTR","D",A{ALL},A$,X4$,X3$,50,P1+3,323,6,C0,"",""+X$,"","","","",""
7535 IF C0=4 THEN GOTO 7520
7550 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,50,P1+5,20,820,C0,M2$,""+X$,"","","","",""
7555 IF C0=2 THEN GOTO 7530
7580 GOTO 7520
7589 ESCAPE 
7590 GOTO 2000
7600 REM "STOCK ITEM
7605 FIND (Z[12],KEY=A1$,DOM=7610); RETURN 
7610 CALL "ZZPROM","YE",X3$,S3,"This is a stock item.  Do you wish to view the inventory item data?","","",0; IF S3=0 THEN Q$(3,10)=""; PRINT @(15,3),S$(1,10),@(34,3),S$,S$,; RETURN ELSE IF S3=2 THEN Q$=""; RETURN 
7645 RETURN 
8300 REM "Copy records for item copy, keep Z(1) open to write out stuff
8319 REM "Write out to FM2 file
8320 WRITE (Z[5],KEY=C$(21,3)+C$(24,16)+C$(40,2)+C$(11,10)+C$(1,10))
8322 J$=C$(21,3)+C$(24,16)+C$(40,2)+C$(11,10)+C$(1,10)
8325 FOR I=8 TO 11
8330 GOSUB 8350
8335 NEXT I
8340 RETURN 
8350 REM "Transfer records with key N$ in file Z(I) to key A$(1,10)+A$(11,10)
8355 EXTRACT (Z[I],KEY=N$,DOM=8356)
8357 K$=KEY(Z[I],END=8380)
8358 IF MID(K$,1,LEN(N$))<>N$ THEN GOTO 8380
8360 READ RECORD (Z[I],END=8380)A8$
8365 A8$(1,20)=A$(1,10)+A$(11,10)
8370 WRITE RECORD (Z[I],KEY=A8$(1,LEN(K$)))A8$
8373 READ (Z[I],KEY=K$,END=8380)
8375 GOTO 8357
8390 RETURN 
8400 REM "Write out to Remote T/M file if needed
8410 IF W9$>"" THEN IF W9$(7,1)="H" THEN CALL "RT2WOR",ERR=8411,X3$,X4$,"","FM1...","U",A1$,A$,31,A{ALL}; REM "Record remote T/M change if this is the host
8445 RETURN 
8810 PRINT @(0,20),"Select the customer by name: ",
8820 CALL "AR2KEY",X3$,"",20,9,10,10,Z[7],"",K$,40,20,50,Z[2]; PRINT @(0,9),'CE',
8840 RETURN 
8950 REM "Program flow logic
8960 DIM U0$(6); U0$(1)=FID(0),U0$=U0$+"PF"
8970 CLOSE (14); OPEN (14)"ZZPARM"; FIND (14,KEY=U0$,DOM=8990)U0$,U1$
8975 IF U1$(1,6)<>X0$ THEN RETURN 
8980 Q1=NUM(U1$(7,2)),Q1$=U1$(9,Q1),U1$=U1$(Q1+9)
8985 L0=1; IF LEN(U1$)>=6 THEN IF U1$(1,3)="AR2" OR U1$(1,6)="FM2PLA" THEN L0=2
8987 IF Q1$(LEN(Q1$))="~" THEN L1=1,Q1$=Q1$(1,LEN(Q1$)-1) ELSE L1=0
8988 IF Q1$(LEN(Q1$))="!" THEN L0=2,Q1$=Q1$(1,LEN(Q1$)-1)
8989 IF Q1$(LEN(Q1$))="@" THEN L0=3,Q1$=Q1$(1,LEN(Q1$)-1)
8990 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2010
9700 REM "PROG FLOW
9710 IF U1$="" THEN REMOVE (Z[6],KEY=U0$,DOM=9900); GOTO 9900
9720 WRITE (Z[6],KEY=U0$)U0$,U1$
9725 IF U1$(1,6)="AR2MAA" THEN PRINT @(0,3),'CE','SB',@(3,3),"Customer code:",@(38,3),"Name:",@(0,5),Z0$,; IF P0$(15,1)="Y" THEN PRINT @(0,4),"Bill-to customer:",@(38,4),"Name:",
9728 L0=0
9730 RUN U1$(1,6)
9800 REM "EXIT PROGRAM
9810 IF U1$>"" THEN GOTO 9700
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 SETERR 9940; Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
56000 REM "188067-New Pricing changes. Standard GP Percentage for a           
56001 REM "201823-Provide the ability to set the taxable flag  by Item   
56002 REM "208991-Need the From Field to be automatically populated when you  
56003 REM "047384-Show where the activity is when a delete is not allowed.    
56004 REM "260170-FM1, if stock? is Y then from customer must be blank.       
