0010 REM "Convert customer contact records 3.5 <FM2UTW>
0020 SETESC 9300; SETERR 9000
0025 REM "CREATED: 01-08-86; LEVEL: N5.17A; S/N: 1318
0035 REM "This software contains trade secrets and proprietary information"
0040 REM "Produced under license by Computer Software, Inc.
0100 CLEAR ; SETERR 9000
0110 X0$="FM2UTW",X1$="Convert Cust. Contacts to 3.5"
0120 DIM Z0$(80,"-")
0130 K0=6,K1=1
0135 C9=-1,V9=-2
0140 M0$="-###,##0"
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1,LEN(A$)),A[0],A[1],A[2]
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01O FMP... "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0620 GOSUB 6000
0640 CALL "ZZPROM",".Y",X3$,S3,"Do you wish to proceed?","","",0
0645 ON S3 GOTO 0646,9900
0990 K0$="a"
0995 READ (Z[1],KEY=K0$,DOM=0996)
1000 REM 
1020 K$=KEY(1,END=5000); READ (1)A$
1025 IF K$(1,LEN(K0$))<>K0$ THEN GOTO 5000
1040 B$=A$
1050 DIM A$(208)
1055 A$(1)=K$
1060 A$(154,20)=B$(15,30)
1065 A$(194,14)=B$(45,14)
1290 PRINT @(12,20),"Updating: ",K$,
1330 WRITE (Z[1],KEY=K$)A$
1390 GOTO 1000
5000 REM 
5020 CALL "ZZPROM","4",X3$,0,"Utility complete","","",0
5090 GOTO 9900
6000 REM "
6005 PRINT @(0,4),
6010 PRINT "This utility will convert customer contact records into the"
6011 PRINT "3.5 format, allowing for fax numbers and addresses."
6090 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
