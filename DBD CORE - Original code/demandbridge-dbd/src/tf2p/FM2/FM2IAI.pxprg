0010 REM "Item Order History Setup <FM2IAI>
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 06/01/21 - 9.793133 - jvv - SSP# 307357
0037 REM "307357-Update FS6 to allow for more line numbers                   
0040 REM "Copyright 2021 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000; SETESC 9300
0110 X0$="FM2IAI",X1$="Item Order History Setup",K9$="",K9=0
0120 DIM Z0$(80,"-"),S0$(40),S$(40)
0125 V8$="0004071199"
0130 K0=30,K1=5
0135 C9=-1
0140 M0$="##,###,###.00-",M1$="####,###.00-",M2$="#####0-",M3$="##0.00-%",M4$="#####,##0-"
0145 IF Q1$="" AND X9=0 THEN GOSUB 8950
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1),A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7]
0311 IOLIST A$(1),A[0],STR(A[1]),A[2],A[3],STR(A[4]),A[5],A[6],A[7]
0340 IOLIST D$,D[0],D[1],D[2],D[3],D[4],D[5],D[6],D[7],D[8],D[9],D[10],D[11],D[12],D[13],D[14],D[15]
0350 IOLIST E$,E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10],E[11],E[12],E[13],E[14],E[15],E[16],E[17],E[18],E[19],E[20]
0351 IOLIST E$,E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10],E[11],E[12],E[13],E[14],E[15],E[16],E[17],E[18]
0352 IOLIST E$
0353 IOLIST E$,E[0],E[1],E[2]
0370 IOLIST G$
0380 IOLIST H$,H[0],H[1],H[2],H[3],H[4],H[5],H[6],H[7],H[8],H[9],H[10],H[11],H[12],H[13]
0390 IOLIST I$,I[0],I[1],I[2]
0400 IOLIST J$
0410 IOLIST M$,M[0],M[1]
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X FS6...  02O FS7...  03O FS8...  04O AR1...  05O IC0...  06O FM1...  07ORFMP...  08ORAR6...  09ORAP4...  10ORFM0...  11ORFS9...  13O ZZPARM  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0530 DIM SEC$(255); FIND (Z[13],KEY="osec"+X3$(40,3),DOM=0531)SEC$
0560 DIM M6[1]; CALL "IC2PRE",X3$,Z[13],M6$,M6{ALL},"",0,"",0
0570 READ (Z[13],KEY=X3$(9,3)+"F/M")F9$
0585 RT_PARM$=""; CALL "RT2PRM",ERR=0586,X3$,X4$,RT_PARM$
0590 READ (Z[1],KEY=K9$,DOM=0591)
0600 REM "
0610 FIND (Z[13],KEY=X3$(9,3)+"F/M")P0$
0680 GOSUB 6000
0700 DIM X$(10,"X"); CALL "ZZDISP","AX",X$,"A/P",X3$,Q$,"",0,0,X4$
0705 V5=14+LEN(Q$),V6=67-V5
1000 REM "
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1030 DIM D$(397),D[15],E$(139),E[20],G$(60),H$(139),H[13],I$(310),I[2],J$(224),E0$(61),M$(20),M[1]
1035 DIM A$(163+K9),A[7] ! SSP 307357
1036 %IL_IMAGE_TYPE$="",%IL_IMAGE_KEY$=""
1040 REM "Display only case
1041 IF Q0$="DISPLAY" THEN A1$=Q1$,A$(1)=Q1$; GOSUB 6600; GOSUB 6460; GOTO 1520
1045 A$(1,LEN(A1$))=A1$; IF A1$="" THEN A$(1,LEN(K9$))=K9$
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1200,1250,1300,1350,1400,1500
1200 REM "Customer code
1205 IF LEN(A1$)>0 THEN A$(1+K9,10)=A1$(1+K9,10); GOTO 1220
1210 CALL "ZZENTR","AXUX",A{ALL},A$,X4$,X3$,15,3,1+K9,10,C0,"A/R","{1"+X$,K9$,"FM2IAI00","AR1","AR2MAB",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1210,1211
1212 READ (Z[1],KEY=A$(1,10),DOM=1213)
1215 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1210,6800,9800,6970
1220 IF POS(" "<>A$(1,10))=0 THEN DIM D$(LEN(D$)) ELSE FIND (Z[4],KEY=A$(1+K9,10),DOM=1210)IOL=0340
1225 PRINT @(34,3+V0),D$(11,35),
1240 GOTO 1120
1250 REM "Type
1255 IF LEN(A1$)>10 THEN A$(11+K9,1)=A1$(11+K9,1); GOTO 1270
1257 X$="B=custom, D=cust inv, F=inventory, H=nonstock, J=Special, M=Message, Z=Stock PO"
1260 CALL "ZZENTR","SRUUX",A{ALL},A$,X4$,X3$,76,3,11+K9,1,C0,"","{2"+X$,"BDFHJZXM","FM2IAI02","FS6","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1260,1261
1261 IF ABS(C0)=2 AND LEN(A1$)>0 THEN A1$=""; GOTO 1290
1262 READ (Z[1],KEY=A$(1,11),DOM=1263)
1290 GOTO 1120
1300 REM "Item code
1305 IF LEN(A1$)>11 THEN A$(12+K9,10)=A1$(12+K9,10); GOTO 1320
1306 REM IF POS( A$(11+K9,1)="HM")>0 THEN GOTO 1120
1307 IF POS(A$(11+K9,1)="FD")<>0 THEN DIM Q$(10); J0$="AUX",J1$="ICE",J2$="IC0",J3$="IC2MAB" ELSE IF A$(11+K9,1)="J" THEN Q$="",J0$="SUX",J1$="",J2$="FMPX",J3$="FS2MCA" ELSE IF POS(A$(11+K9,1)="HM")<>0 THEN Q$="",J0$="SUX",J1$="",J2$="FM1",J3$="FM2IAB" ELSE Q$=A$(1+K9,10),J0$="SUX",J1$="",J2$="FM1",J3$="FM2IAB"
1308 IF A$(11+K9,1)="D" THEN Q$=A$(1+K9,10)
1310 CALL "ZZENTR",J0$,A{ALL},A$,X4$,X3$,0,6,12+K9,10,C0,J1$,"{2"+X$,Q$,"FM2IAI04",J2$,J3$,""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1310,1311
1311 IF ABS(C0)=2 AND LEN(A1$)>10 THEN A1$=A1$(1,10); GOTO 1340
1312 READ (Z[1],KEY=A$(1,21),DOM=1313)
1315 IF POS(A$(11+K9,1)="HM")>0 THEN GOTO 1120
1320 GOSUB 7500; IF E0=1 THEN GOTO 1310
1325 GOSUB 7650; GOSUB 7700
1340 GOTO 1120
1350 REM "Order Number
1355 IF LEN(A1$)>21 THEN A$(22+K9,8)=A1$(22+K9,8); GOTO 1370
1357 Q$=A$(1+K9,21)
1360 CALL "ZZENTR","AUX",A{ALL},A$,X4$,X3$,16,9,22+K9,8,C0,"O/P","{2"+X$,Q$,"FM2IAI06","FS6","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1360,1361
1361 IF ABS(C0)=2 AND LEN(A1$)>11 THEN A1$=A1$(1,11)
1362 READ (Z[1],KEY=A$(1,29),DOM=1363)
1390 GOTO 1120
1400 REM "Seq
1407 Q$=A$(1+K9,29)
1410 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,7,10,30+K9,1,C0,"","{2"+X$,Q$,"FM2IAI08","FS6","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1410,1411 ! SSP 307357
1412 IF ABS(C0)=2 AND LEN(A1$)>21 THEN A1$=A1$(1,21)
1415 IF C0<0 THEN IF -C0=1 THEN GOTO 6800 ELSE C0=ABS(C0)
1420 IF POS(A$(11+K9,1)="HM")>0 THEN GOSUB 7500; GOSUB 7650; GOSUB 7700
1440 GOTO 1120
1500 REM "
1505 Z9=-1,A2$="",A3$="",A4$="",A5$=""
1510 A1$=A$(1,K9+30)
1520 READ (Z[1],ERR=7200,KEY=A1$,DOM=1600)IOL=0310
1521 IF %HAS_IMAGE_LIB THEN %IL_IMAGE_TYPE$="ORDER",%IL_IMAGE_KEY$=MID(A1$,22,8); IF NOT(NUL(MID(A$,40,8))) THEN %IL_IMAGE_TYPE$+=SEP+"AR_INVOICE",%IL_IMAGE_KEY$+=SEP+PAD(MID(A$,1,10),10)+PAD(MID(A$,40,8),8) ! 208586
1525 Z9=0
1530 FIND (Z[7],KEY="T"+A$(31+K9,3),DOM=1531)IOL=0370
1535 FIND (Z[8],KEY=A$(40+K9,8),DOM=1536)IOL=0380
1540 FIND (Z[9],KEY=A$(87+K9,10),DOM=1541)IOL=0390
1545 FIND (Z[10],KEY="P"+A$(87+K9,14),DOM=1546)IOL=0400
1550 FIND (Z[13],KEY="U/M"+A$(101+K9,4),DOM=1551)IOL=0410
1560 A2$=A$(31,3)+A$(11,1)+A$(12,10)+A$(1,10)+A$(22,8)+A$(30,1)
1565 A3$=A$(1,10)+A$(22,8)+A$(11,1)+A$(12,10)+A$(30,1)
1580 IF Q0$="DISPLAY" THEN GOSUB 6200; GOTO 8000
1590 GOTO 1700
1600 REM "
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630
1630 GOTO 1000
1680 GOSUB 7450
1690 GOTO 2000
1700 REM "
1790 GOSUB 6200
1800 REM "
1820 CALL "ZZPROM",STR(6+C9),X3$,Z,"","","V",X0; ON Z GOTO 1850,6500,1630,6700
1830 GOTO 2000
1850 REM "MODIFY
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE IF Z9=0 THEN Z9=1
1860 GOSUB 7400
1870 GOSUB 6200
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1
2020 C9=1,X$="",Q$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF INT(C0)=3 THEN GOSUB 7300 ELSE IF C0>3 OR X0<0 THEN GOTO 1800
2040 ON X0 GOTO 2100,2150,2200,2250,2300,2350,2400,2450,2500,2650,2700,2550,2600,2750,2800,2850,1800
2100 REM "Product code
2105 IF A$(11+K9,1)="M" THEN GOTO 2020
2110 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,11,6,31+K9,3,C0,"","{3"+X$,"T","FM2IAI10","FMPP","FM2SAA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2110,2111
2111 IF C0=2 THEN GOTO 8200
2120 FIND (Z[7],KEY="T"+A$(31+K9,3),DOM=2110)IOL=0370
2140 GOTO 2020
2150 REM "Order date
2160 CALL "ZZENTR","D",A{ALL},A$,X4$,X3$,27,9,34+K9,6,C0,"","{3"+X$,"","FM2IAI12","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2160,2161
2190 GOTO 2020
2200 REM "Invoice number
2210 CALL "ZZENTR","A",A{ALL},A$,X4$,X3$,16,11,40+K9,8,C0,"AR6","{3"+X$,"","FM2IAI14","AR6","AR2MAK",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2210,2211
2220 FIND (Z[8],KEY=A$(40+K9,8),DOM=2221)IOL=0380
2225 IF POS(" "<>A$(48+K9,6))=0 THEN A$(48+K9,6)=H$(20,6); CALL "ZZDISP","D ",A$(48+K9,6),"",X3$,"","",27,11,X4$
2240 GOTO 2020
2250 REM "Invoice date
2260 CALL "ZZENTR","D",A{ALL},A$,X4$,X3$,27,11,48+K9,6,C0,"","{3"+X$,"","FM2IAI16","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2260,2261
2290 GOTO 2020
2300 REM "Customer P/O
2310 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,61,9,54+K9,15,C0,"","{3"+X$,"","FM2IAI18","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2310,2311
2340 GOTO 2020
2350 REM "Job number
2360 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,61,10,69+K9,12,C0,"","{3"+X$,"","FM2IAI20","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2360,2361
2390 GOTO 2020
2400 REM "Est. Reorder
2410 CALL "ZZENTR","D",A{ALL},A$,X4$,X3$,61,11,81+K9,6,C0,"","{3"+X$,"","FM2IAI22","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2410,2411
2425 IF Q0$="DISPLAY" THEN RETURN 
2440 GOTO 2020
2450 REM "Vendor code
2455 IF A$(11+K9,1)="M" THEN GOTO 2020
2460 CALL "ZZENTR","AU",A{ALL},A$,X4$,X3$,13,14,87+K9,10,C0,"A/P","{3"+X$,"","FM2IAI24","AP4","AP2MAB",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2460,2461
2470 FIND (Z[9],KEY=A$(87+K9,10),DOM=2460)IOL=0390
2475 GOSUB 7800
2490 GOTO 2020
2500 REM "Plant
2505 Q$="P"+A$(87+K9,10)
2510 CALL "ZZENTR","SZX",A{ALL},A$,X4$,X3$,68,14,97+K9,4,C0,"","{3"+X$,Q$,"FM2IAI26","FM0P","FM2SKA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2510,2511
2515 IF C0<0 THEN GOTO 2540
2520 FIND (Z[10],KEY="P"+A$(87+K9,14),DOM=2510)IOL=0400
2530 GOSUB 7800
2540 GOTO 2020
2550 REM "Selling Quantity
2552 IF M$(20,1)="Y" THEN A9=M[1] ELSE A9=A[2]
2553 IF A9=0 THEN A9=1
2554 DIM Q[1]
2555 Q[0]=A[0]/A9
2560 CALL "ZZENTR","NX.",Q{ALL},A$,X4$,X3$,7,18,0,822,C0,M0$,"{3"+X$,"","FM2IAI28","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2560,2561
2565 IF C0<=0 THEN GOTO 2590
2575 A[0]=Q[0]*A9
2580 GOSUB 7900
2590 GOTO 2020
2600 REM "Selling Amt/quantity
2610 PRECISION M6[1]; CALL "ZZENTR","NX",A{ALL},A$,X4$,X3$,22,18,1,M6[0],C0,M6$,"{3"+X$,"","FM2IAI30","","",""; PRECISION 2; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2610,2611
2620 IF C0>=0 THEN GOSUB 7900
2640 GOTO 2020
2650 REM "Selling unit
2660 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,35,18,101+K9,4,C0,"","{3"+X$,"U/M","FM2IAI32","U/M","ZZ2MUA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2660,2661
2665 IF C0<0 THEN GOTO 2690 ELSE DIM M$(20),M[1]
2670 FIND (Z[13],KEY="U/M"+A$(101+K9,4),DOM=2660)IOL=0410
2675 IF M$(20,1)="Y" THEN IF M[0]<>0 THEN A[2]=M[0] ELSE A[2]=M[1]
2680 GOSUB 7900
2690 GOTO 2020
2700 REM "Qty per unit
2705 IF M$(20,1)="Y" THEN GOTO 2020
2710 CALL "ZZENTR","NX",A{ALL},A$,X4$,X3$,42,18,2,600,C0,M2$,"{3"+X$,"","FM2IAI34","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2710,2711
2720 IF C0>=0 THEN GOSUB 7900
2740 GOTO 2020
2750 REM "Combination quantity
2752 IF M$(20,1)="Y" THEN A9=M[1] ELSE A9=A[2]
2753 IF A9=0 THEN A9=1
2754 DIM Q[3]
2755 Q[3]=A[3]/A9
2760 CALL "ZZENTR","NX",Q{ALL},A$,X4$,X3$,7,19,3,822,C0,M0$,"{3"+X$,"","FM2IAI36","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2760,2761
2765 IF C0<=0 THEN GOTO 2775
2770 A[3]=Q[3]*A9
2775 GOSUB 7900
2790 GOTO 2020
2800 REM "Cost per unit
2810 PRECISION M6[1]; CALL "ZZENTR","NX",A{ALL},A$,X4$,X3$,22,19,4,M6[0],C0,M6$,"{3"+X$,"","FM2IAI38","","",""; PRECISION 2; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2810,2811
2820 IF C0>=0 THEN GOSUB 7900
2840 GOTO 2020
2850 REM "Invoiced quantity
2852 IF M$(20,1)="Y" THEN A9=M[1] ELSE A9=A[2]
2853 IF A9=0 THEN A9=1
2854 DIM Q[1]
2855 Q[0]=A[5]/A9
2860 CALL "ZZENTR","NX.",Q{ALL},A$,X4$,X3$,7,21,0,822,C0,M0$,"{3"+X$,"","FM2IAI29","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2860,2861
2865 IF C0<=0 THEN GOTO 2890
2875 A[5]=Q[0]*A9
2890 GOTO 2020
3400 REM "Do Order Notepad
3405 PRINT @(0,3),'CE',
3407 Q1$=A$(22,8)
3410 CALL "FM2NPA",X3$,X4$,"",Q1$
3440 PRINT @(0,3+V0),'CE',; GOSUB 6000; GOSUB 6460; GOSUB 6200
3445 GOTO 8000
3500 REM "Do Tracking Detail
3505 PRINT @(0,3),'CE',
3507 Q1$=A$(22,8)+" "+STR(ASC(A$(30,1))-48:"001")
3510 ! ALL "AR2TDD",ERR=3511,X3$,X4$,"",Q1$
3520 PROCESS "ARGTDD","../ARG/AR.EN",A$(22,8),STR(A$(30,1):"001") ! SSP 257952
3540 PRINT @(0,3+V0),'CE',; GOSUB 6000; GOSUB 6460; GOSUB 6200
3545 GOTO 8000
3700 REM "Job Notes SSP 185579
3705 O$=A$(22,8)
3710 CALL "ZZGMBA",X3$,X4$,"O",O$
3795 GOTO 8000
3799 ! ******************************************************
5100 REM "Show order detail
5104 DIM A9$(2)
5105 PRINT @(27,22),'CE'," Line number:",; CALL "ZZENTR","ZX",A{ALL},A9$,X4$,X3$,43,22,1,2,C0,"","","","FM2IAH08","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 5105,5106
5106 IF C0<0 THEN GOTO 5000 ELSE PRINT @(27,22),'CL',
5107 A9=NUM(A9$,ERR=5104); IF A9<1 OR A9>N THEN GOTO 5104
5108 N0=(A9-1)*LEN(K1$)+1
5110 K2$="*"+A1$+"*"+K0$; IF Q1$<>"" THEN K2$(1,1)="+"
5120 U1$=X0$+STR(LEN(K2$):"00")+K2$+U1$
5125 U1$="FM2IAI"+STR(LEN(K1$):"00")+N$(N0,LEN(K1$))+U1$
5150 GOTO 9700
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6060 PRINT @(0,3+V0),"Customer code:",@(28,3+V0),"Name:",@(70,3+V0),"Type:",@(0,4+V0),Z0$,
6070 PRINT @(0,5+V0),"Item code",@(11,5+V0),"P/C",@(16,5+V0),"Left-Rgt Top-Botm Plys",@(40,5+V0),"Item description",@(0,7+V0),Z0$,
6080 PRINT @(2,9+V0),"Order Number:",@(47,9+V0),"Customer P/O:",@(2,10+V0),"Seq:",@(10,10+V0),"Line: ",@(49,10+V0),"Job number:",@(0,11+V0),"Invoice number:",@(47,11+V0),"Est. Reorder:",@(0,13+V0),Z0$, ! SSP 307357
6090 PRINT @(0,14+V0),"Vendor code:",@(61,14+V0),"Plant:",@(0,15+V0),Z0$,
6100 PRINT @(9,16+V0),"Quantity",@(23,16+V0),"Amt/unit",@(35,16+V0),"Unit",@(41,16+V0),"Qty/unit",@(53,16+V0),"Extension",@(65,16+V0),"Gross Profit",@(0,18+V0),"Price:",@(1,19+V0),"Cost:",
6105 PRINT @(0,21+V0),"Inv'd:",
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6220 PRINT @(11,6),A$(31+K9,3),
6222 IF A$(111,1)<>" " THEN CALL "ZZDISP","AX",A$(22+K9,8),"O/P",X3$,X$,"",0,0,X4$; X$=A$(111,1)+"-"+X$; PRINT @(16,9),X$
6224 CALL "ZZDISP","D ",A$(34+K9,6),"",X3$,"","",27,9,X4$
6228 CALL "ZZDISP","A ",A$(40+K9,8),"AR6",X3$,"","",16,11,X4$
6232 CALL "ZZDISP","D ",A$(48+K9,6),"",X3$,"","",27,11,X4$
6236 PRINT @(61,9),A$(54+K9,15),@(61,10),A$(69+K9,12),
6240 CALL "ZZDISP","D ",A$(81+K9,6),"",X3$,"","",61,11,X4$
6244 CALL "ZZDISP","A ",A$(87+K9,10),"A/P",X3$,"","",13,14,X4$
6246 GOSUB 7800
6248 PRINT @(68,14),A$(97+K9,4),@(35,18),A$(101+K9,4),
6249 IF POS(A$(105,1)="Rx")<>0 THEN PRINT @(47,12),"Don't print on reorder report", ELSE PRINT @(47,12),'CL',
6250 GOSUB 7900
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>0 THEN GOSUB 6200 ELSE GOSUB 6450; GOSUB 6200
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6460 CALL "ZZDISP","A ",A$(1+K9,10),"A/R",X3$,"","",15,3,X4$
6464 PRINT @(34,3+V0),D$(11,35),@(76,3),A$(11+K9,1),
6468 PRINT @(0,6),S0$(1,10),; IF POS(A$(11+K9,1)="DF")=0 THEN PRINT @(0,6),A$(12+K9,10), ELSE CALL "ZZDISP","A ",A$(12+K9,10),"ICE",X3$,"","",0,6,X4$
6472 CALL "ZZDISP","A ",A$(22+K9,8),"O/P",X3$,"","",16,9,X4$
6473 FIND (Z[1],KEY=A$(1,30),DOM=*NEXT)FSLN$; PRINT @(16,10),MID(FSLN$,114,3) ! SSP 307357
6476 PRINT @(7,10),A$(30+K9,1), ! SSP 307357
6480 GOSUB 7700
6490 RETURN 
6500 REM "DELETE
6510 REMOVE (Z[1],KEY=A1$,DOM=6511)
6511 IF RT_PARM$<>"" THEN CUST$=A1$(1,10); CALL "RT2WOC",ERR=6512,X3$,X4$,CUST$,"FS6...","D",A1$
6520 REMOVE (Z[2],KEY=A2$,DOM=6521)
6540 REMOVE (Z[3],KEY=A3$,DOM=6541)
6590 GOTO 1630
6600 REM "ALT KEY DATA READS
6605 FIND (Z[4],KEY=A$(1+K9,10),DOM=6606)IOL=0340
6610 GOSUB 7500
6690 RETURN 
6700 REM "ADD ENTRY
6704 %IL_IMAGE_TYPE$="",%IL_IMAGE_KEY$=""
6705 REM IF Z9=0 THEN GOTO 06790
6710 WRITE (Z[1],KEY=A1$)IOL=0311; IF RT_PARM$<>"" THEN CUST$=A1$(1,10); CALL "RT2WOC",ERR=6711,X3$,X4$,CUST$,"FS6...","U",A1$
6720 IF A2$=A$(31,3)+A$(11,1)+A$(12,10)+A$(1,10)+A$(22,8)+A$(30,1) THEN GOTO 6726
6724 REMOVE (Z[2],KEY=A2$,DOM=6725)
6728 WRITE (Z[2],KEY=A$(31,3)+A$(11,1)+A$(12,10)+A$(1,10)+A$(22,8)+A$(30,1))
6740 IF A3$=A$(1,10)+A$(22,8)+A$(11,1)+A$(12,10)+A$(30,1) THEN GOTO 6746
6744 REMOVE (Z[3],KEY=A3$,DOM=6745)
6748 WRITE (Z[3],KEY=A$(1,10)+A$(22,8)+A$(11,1)+A$(12,10)+A$(30,1))
6790 GOTO 1630
6800 REM "NEXT ENTRY IN FILE
6805 ON 10*FPT(C0)+2 GOTO 6850,6806
6810 A1$=KEY(Z[1],END=6895)
6820 IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 6895
6825 A$(1,LEN(A1$))=A1$
6830 GOSUB 6600
6835 GOSUB 6450
6840 GOTO 1515
6850 REM PRIOR ENTRY
6855 CALL "ZZKEYP",ERR=6856,Z[1],A1$; GOTO 6820
6860 CALL "ZZKEYL",ERR=6861,Z[1],A1$; GOTO 6820
6870 GOTO 6895
6890 GOTO 1515
6895 PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=1140); GOTO 1140
7200 REM "Forced read
7210 IF ERR<>0 THEN GOTO 9000
7220 CALL "ZZREAD",Z[1],A1$,A$,A{ALL},S8; ON S8 GOTO 7221,1630
7230 GOSUB 6200
7240 CALL "ZZPROM","E0",X3$,0,"","","",0; GOTO 7290
7250 CALL "ZZPROM","E0A",X3$,0,"","","",0; GOTO 7290
7290 GOTO 1630
7300 REM 
7310 ON FPT(C0)*10 GOTO 7390,7325,7330,7390
7325 IF V8$="" THEN X0=X0+4; GOTO 7390 ELSE X0=NUM(V8$(POS(STR(X0:"00")<=V8$,2),2)); GOTO 7390
7330 IF V8$="" THEN X0=X0-6; GOTO 7335 ELSE X0=POS(STR(X0-1:"00")<=V8$,2)-2; IF X0<0 THEN X0=0; GOTO 7390 ELSE X0=NUM(V8$(X0,2)); GOTO 7390
7335 IF X0<0 THEN X0=0; GOTO 7390
7390 C0=3; RETURN 
7400 REM "EXTRACT
7410 EXTRACT (Z[1],ERR=7200,KEY=A1$,DOM=7440)IOL=0310
7420 C9=1
7440 RETURN 
7450 REM "EXTRACT NEW ENTRY
7460 WRITE (Z[1],KEY=A1$,DOM=7250)IOL=0311; GOTO 7400
7490 RETURN 
7500 REM "Read in inventory or custom item data save into E0$, E0=1 means not found
7501 REM "E0$=prod code,left-rght,top-bot,plys,desc.; if product code blank then set it
7502 REM "Set E1$=unit of meas., E1=qty/unit
7504 E0=0
7505 ON POS(A$(11+K9,1)="BDFHJM") GOTO 7590,7550,7510,7515,7600,7570,7600
7510 C0$=A$(1+K9,10); GOTO 7520
7515 DIM C0$(10)
7520 DIM E$(139),E[20]; FIND (Z[5],KEY=C0$+A$(12+K9,10),DOM=7521)IOL=0350; GOTO 7525
7521 E0=1; GOTO 7600 ! SSP 221331 - Try looking in FS9, could be item with FROM customer set
7525 E0$=E$(61,21)+E$(21,40),E1$=E$(120,4),E1=E[14]
7545 GOTO 7590
7550 REM "Custom item case
7555 DIM E$(167),E[18]
7560 FIND (Z[6],KEY=A$(1+K9,10)+A$(12+K9,10),DOM=7561)IOL=0351; GOTO 7565
7561 E0=1; GOTO 7600 ! SSP 221331 - Try looking in FS9, could be item with FROM customer set
7565 E0$=E$(21,61),E1$=E$(100,4),E1=E[4]
7569 GOTO 7590
7570 REM "Special stuff
7575 DIM E$(60),E0$(61),E[20]
7580 FIND (Z[7],KEY="X"+A$(12+K9,10),DOM=7581)IOL=0353; GOTO 7582
7581 E0=1
7585 E0$(1,3)=E$(52,3),E0$(22)=E$(12,40),E1$=E$(55,4),E1=E[0]
7590 RETURN 
7600 REM "Read in non stock info from FS9 and put into E0$
7610 DIM E$(81),E[20]
7620 FIND (Z[11],KEY=A$(22+K9,8)+A$(12+K9,10)+A$(30+K9,1),DOM=7621)IOL=0352; GOTO 7625
7621 E0=1
7630 E0$=E$(20,61),E1=0; DIM E1$(4)
7640 GOTO 7590
7650 REM "Take E2$ & default product code if needed
7660 IF POS(" "<>A$(31+K9,3))=0 THEN A$(31+K9,3)=E0$(1,3)
7665 IF POS(" "<>A$(101+K9,4))=0 THEN A$(101+K9,4)=E1$,A[2]=E1
7685 PRINT @(11,6),A$(31+K9,3),@(35,18),A$(101+K9,4),@(42,18),A[2]:M2$,
7690 RETURN 
7700 REM "Display E0$ stuff
7710 PRINT @(16,6+V0),E0$(4,8),@(25),E0$(12,8),@(35),E0$(20,2),@(40),E0$(22),
7740 RETURN 
7800 REM "Print Vendor/Plant description
7805 P9$=FNS$(I$(11,35))
7810 IF POS(" "<>J$(111,16))<>0 THEN P8$=J$(111,18) ELSE IF POS(" "<>I$(106,16))<>0 THEN P8$=I$(106,18) ELSE GOTO 7820
7815 P9$=P9$+"-"+FNS$(P8$(1,16))+", "+P8$(17,2); IF LEN(P9$)>V6 THEN P9$=P9$(1,V6)
7820 PRINT @(V5,14+V0),P9$,
7840 RETURN 
7900 REM "Print extentions,gross profits & combinations etc.
7910 IF MID(M$,20,1)="Y" THEN A9=M[1] ELSE A9=A[2]
7911 IF A9=0 THEN A9=1
7912 IF MID(M$,21,1)="Y" THEN A0=A[0],A5=A[1],A6=A[4]; GOTO 7925
7915 A0=A[0]/A9,A3=INT(A[3])/A9,A5=A0*A[1],A6=A0*A[4]
7918 IF A0=0 THEN A5=A[1],A6=A[4]
7920 IF M[0]<>0 THEN A5=A5/M[0],A6=A6/M[0]
7925 A7=A5-A6; IF A5=0 THEN A8=0 ELSE A8=A7*100/A5
7940 PRINT @(7,18),FNQ$(A0,M0$),@(22,18),A[1]:M6$,@(42,18),A[2]:M2$,@(50,18),A5:M0$,
7942 Q$="(Combination)"; IF FPT(A[3])<>0 THEN Q$="(Combo, "+STR(100*FPT(A[3]))+" orders)"
7944 IF SEC$(63,1)="Y" THEN GOTO 7990
7945 PRINT @(65,18),A7:M0$(2),; IF A3<>0 THEN PRINT @(7,19),FNQ$(A3,M0$),@(7,20),Q$, ELSE PRINT @(7,19),S0$(1,LEN(M0$)),@(7,20),'CE',
7947 PRINT @(7,21),FNQ$(A[5]/A9,M0$),
7950 PRINT @(22,19),A[4]:M6$,@(50,19),A6:M0$,@(71,19),A8:M3$,
7990 RETURN 
8000 REM "Display only case
8005 IF P0$(22,1)="Y" AND POS(A$(11,1)="FHD")>0 THEN CALL "ZZPROM","X1FM2IAI",X3$,Z,"","","",0; ON Z GOTO 8040,8015,8022,8011,3400,3500,8030
8007 IF P0$(239,1)="Y" THEN CALL "ZZPROM","X2FM2IAI",X3$,Z,"","","",0; ON Z GOTO 8040,8015,8022,8050,3400,3500,3700,8030
8010 CALL "ZZPROM","X0FM2IAI",X3$,Z,"","","",0; ON Z GOTO 8040,8015,8022,3400,3500,8030
8011 U1$="FW2MAA38"+A$(1,10)+S0$(1,10)+A$(12,18)+"FM2IAI30"+A1$+U1$
8012 IF A$(11,1)="D" THEN U1$(19,10)=A$(1,10)
8013 GOTO 8040
8015 IF A$(105,1)="R" THEN A$(105,1)=" " ELSE IF A$(105,1)="x" THEN A$(105,1)="X" ELSE IF A$(105,1)="X" THEN A$(105,1)="x" ELSE A$(105,1)="R"
8020 GOTO 8025
8022 X$=""; GOSUB 2400
8025 WRITE (Z[1],KEY=A1$)IOL=0311
8030 GOSUB 6400
8035 GOTO 8000
8040 PRINT @(0,3),'CE',
8045 GOTO 9700
8050 REM "Display Shipping Info
8060 X$=A$(1,10)+A$(22,9)
8065 IF %HAS_IMAGE_LIB THEN SAVE_IL_IMAGE_TYPE$=%IL_IMAGE_TYPE$; SAVE_IL_IMAGE_KEY$=%IL_IMAGE_KEY$ ! 208586
8070 CALL "FM2IAO",X3$,X4$,8,X$
8075 IF %HAS_IMAGE_LIB THEN %IL_IMAGE_TYPE$=SAVE_IL_IMAGE_TYPE$; %IL_IMAGE_KEY$=SAVE_IL_IMAGE_KEY$ ! 208586
8080 C9=0; GOSUB 6400
8090 GOTO 8000
8100 REM "CHANGE CUSTOMER CODE
8102 PRINT @(0,21),'CE',@(5,21),"New customer code:"
8105 DIM X$(20); X$(11,10)=A$(12,10)
8120 CALL "ZZENTR","AXUX",X{ALL},X$,X4$,X3$,40,21,1,10,C0,"A/R","","","","AR1","AR2MAB",""
8125 IF C0=4 OR X$(1,10)=S$(1,10) THEN GOTO 1800
8128 READ (Z[4],KEY=X$(1,10),DOM=8100)Q$; PRINT @(55,21),Q$(11,30),
8130 FIND (Z[6],KEY=X$,DOM=8131); GOTO 8150
8131 FIND (Z[5],KEY=X$,DOM=8132); GOTO 8150
8140 CALL "ZZPROM",".4",X3$,0,"This item not on file for the new customer!","","",0
8145 GOTO 8100
8150 REM "OK TO MOVE
8160 CALL "ZZPROM","Y",X3$,S3,"OK to move this order history record?","","",0
8165 IF S3=1 THEN GOTO 1800
8170 A$(1,10)=X$(1,10); WRITE (Z[1],KEY=A$(1,LEN(A1$)),DOM=8171)IOL=0310; GOTO 8180
8175 CALL "ZZPROM",".4",X3$,0,"Sorry, there is already an order record with the same key","","",0; GOTO 1800
8180 REMOVE (Z[1],KEY=A1$)
8185 GOSUB 6450
8190 GOTO 1630
8200 REM "Change order type
8205 PRINT @(0,21),"Enter the order type: ",
8210 DIM X$(1); X$(1,1)=A$(11,1); CALL "ZZENTR","AXUX",X{ALL},X$,X4$,X3$,40,21,1,1,C0,"","","","","","AR2MAB",""
8215 A$(11,1)=X$
8220 WRITE (Z[1],KEY=A$(1,LEN(A1$)),DOM=8171)IOL=0310; GOTO 8180
8900 REM "Functions
8930 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
8940 DEF FNQ$(Z9,Z9$)=STR(Z9:Z9$(1,POS(".00"=STR(Z9:Z9$)+".00")-1)+"-")
8950 REM "Program flow logic
8960 DIM U0$(6); U0$(1)=FID(0),U0$=U0$+"PF"
8970 CLOSE (14); OPEN (14)"ZZPARM"; FIND (14,KEY=U0$,DOM=8990)U0$,U1$
8975 IF U1$="" THEN GOTO 8990 ELSE IF U1$(1,6)<>X0$ THEN GOTO 8990
8980 Q1=NUM(U1$(7,2)),Q1$=U1$(9,Q1),U1$=U1$(Q1+9)
8985 Q0$="DISPLAY"
8990 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9700 REM "PROG FLOW
9704 %IL_IMAGE_TYPE$="",%IL_IMAGE_KEY$=""
9705 IF X9=1 THEN GOTO 9900
9710 IF U1$="" THEN REMOVE (Z[13],KEY=U0$,DOM=9900); GOTO 9900
9720 WRITE (Z[13],KEY=U0$)U0$,U1$
9725 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9730 RUN U1$(1,6)
9800 REM "EXIT PROGRAM
9805 GOTO 9700
9900 REM "END PROGRAM
9904 %IL_IMAGE_TYPE$="",%IL_IMAGE_KEY$=""
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 SETERR 9940; Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
56002 REM "208586-AR Invoice is not showing up if you look at order           
56003 REM "221331-Description Line in Order History is not displaying when    
56004 REM "257952-Need larger tracking number field to replace 20 character   
56005 REM "307357-Update FS6 to allow for more line numbers                   
