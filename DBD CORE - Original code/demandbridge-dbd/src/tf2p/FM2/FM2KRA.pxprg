0010 REM "Kramer Style Forms Usage Report <FM2KRA>
0015 REM "Prog Type: O -3.0A
0020 REM "SETESC 09300; SETERR 09000
0035 REM "5.7 - 01/27/21 - 13.731111 - tma - SSP# 307329
0036 REM "10/14/91; LINE 1340 ADDED TO ALLOW SKIP OF NON-FMS FORMS
0037 REM "307329-PE in FM2RKA if description is too long                     
0040 REM "Copyright 2021 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; REM "SETERR 09000
0095 PRECISION 14; T2=TIM; PRECISION 2
0110 X0$="FM2KRA",X1$="Forms Usage Report"
0115 M0$="#0.000",M1$="##0-",M2$="##0-",M3$="##.0-",M4$="#,##0"
0120 DIM A$(33),A[75],A0$(33),A0[75],C$(387),C[28],S$(40),D$(397),J[36],FS6[8],X8$(20,"X"),E$(243),L[3],G$(522)
0130 MONTH_HEADER$="JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDECJANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC"
0210 T=1,T0=1,T1=15
0220 W3=330 ! 286670
0225 W=999,WW0=999
0230 DIM T1$(W3,"-"),T2$(W3,"="),T3$(W3,"*"),Y5$(W3),Y6$(W3),W[4],J5$(W3)
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,-1,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0260 CALL "ZZRPTP",X3$,X0$,X1$,V9$,V0,Q0$,Q1$,Q2$,Q3$,Q4$,Q5$,Q6$
0300 REM "I/O lists
0305 REM "IOLIST FOR FMD - Forms Mgt Report Info
0310 IOLIST A0$,A0[0],A0[1],A0[2],A0[3],A0[4],A0[5],A0[6],A0[7],A0[8],A0[9],A0[10],A0[11],A0[12],A0[13],A0[14],A0[15],A0[16],A0[17],A0[18],A0[19],A0[20],A0[21],A0[22],A0[23],A0[24],A0[25],A0[26],A0[27],A0[28],A0[29],A0[30],A0[31],A0[32],A0[33],A0[34],A0[35],A0[36],A0[37],A0[38],A0[39],A0[40],A0[41],A0[42],A0[43],A0[44],A0[45],A0[46],A0[47],A0[48],A0[49],A0[50],A0[51],A0[52],A0[53],A0[54],A0[55],A0[56],A0[57],A0[58],A0[59],A0[60],A0[61],A0[62],A0[63],A0[64],A0[65],A0[66],A0[67],A0[68],A0[69],A0[70],A0[71],A0[72],A0[73],A0[74],A0[75]
0313 IOLIST A0$(1),A0[0],A0[1],A0[2],A0[3],X$
0315 IOLIST X[0],Y9[0],X[1],Y9[1],X[2],Y9[2],X[3],Y9[3],X[4],Y9[4],X[5],Y9[5],X[6],Y9[6],X[7],Y9[7],X[8],Y9[8],X[9],Y9[9],X[10],Y9[10],X[11],Y9[11],X[12],Y9[12],X[13],Y9[13],X[14],Y9[14],X[15],Y9[15],X[16],Y9[16],X[17],Y9[17],X[18],Y9[18],X[19],Y9[19],X[20],Y9[20],X[21],Y9[21],X[22],Y9[22],X[23],Y9[23],X[24],Y9[24],X[25],Y9[25],X[26],Y9[26],X[27],Y9[27],X[28],Y9[28],X[29],Y9[29],X[30],Y9[30],X[31],Y9[31],X[32],Y9[32],X[33],Y9[33],X[34],Y9[34],X[35],Y9[35],X[36],Y9[36],X[37],Y9[37],X[38],Y9[38],X[39],Y9[39],X[40],Y9[40],X[41],Y9[41],X[42],Y9[42],X[43],Y9[43],X[44],Y9[44],X[45],Y9[45],X[46],Y9[46],X[47],Y9[47],X[48],Y9[48],X[49],Y9[49],X[50],Y9[50],X[51],Y9[51],X[52],Y9[52],X[53],Y9[53],X[54],Y9[54],X[55],Y9[55],X[56],Y9[56],X[57],Y9[57],X[58],Y9[58],X[59],Y9[59],X[60],Y9[60],X[61],Y9[61],X[62],Y9[62],X[63],Y9[63],X[64],Y9[64],X[65],Y9[65],X[66],Y9[66],X[67],Y9[67],X[68],Y9[68],X[69],Y9[69],X[70],Y9[70],X[71],Y9[71],X[72],Y9[72],X[73],Y9[73],X[74],Y9[74],X[75],Y9[75],X[76],Y9[76],X[77],Y9[77],X[78],Y9[78],X[79],Y9[79],X[80],Y9[80],X[81],Y9[81],X[82],Y9[82],X[83],Y9[83],X[84],Y9[84],X[85],Y9[85],X[86],Y9[86],X[87],Y9[87],X[88],Y9[88],X[89],Y9[89],X[90],Y9[90],X[91],Y9[91],X[92],Y9[92],X[93],Y9[93],X[94],Y9[94],X[95],Y9[95],X[96],Y9[96],X[97],Y9[97],X[98],Y9[98],X[99],Y9[99],X[100],Y9[100]
0325 REM "IOLIST FOR FM1 - Customer Job Master
0330 IOLIST C$(1),C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15],C[16],C[17],C[18],C[19],C[20],C[21],C[22],C[23],C[24],C[25],C[26],C[27],C[28]
0340 IOLIST D$(1)
0350 IOLIST E$(1)
0370 IOLIST G$
0380 IOLIST FS6$,FS6[0],FS6[1],FS6[2],FS6[3],FS6[4],FS6[5],FS6[6],FS6[7]
0420 IOLIST X3$,X4$,V1$,V3$,V2$,IOL=0425
0425 IOLIST V$,V[0],V[1]
0500 REM "Files
0505 DIM Z[NUM(X3$(60,3))]; GOSUB 7400
0508 IF V$(72,1)="0" THEN Q$="FMC" ELSE Q$="FMD"
0509 IF V$(71,2)="10" THEN Q$="FMC" ELSE Q$="FMD"
0510 Y$="01X "+Q$+"...  03O FM1... 04O AR1... 05O FMP... 06O ZY2    07O FM0...  08O FM3...  09O AR3...  10O FS6...  "; IF V1$(1,3)<>Y$(5,3) THEN Y$=Y$+"02X "+V1$+"  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Y$,Z{ALL},Z0,Z1
0560 READ (Z[13],KEY="STATF/M")F9$
0565 FOR X=0 TO 9; F1$=F1$+F9$(49+X*17,5); NEXT X
0800 REM "Alternate Sort Info & total dim"
0810 DIM U[10,2],U0$(10),Y[5,1]
0815 IF V0=1 THEN V1$="FMD..."
0820 CALL "ZZRSEQ",X3$,X0$,V1$,U,U0,U1,U{ALL},Y{ALL},T0,V0,U0$,T5$,U5$,S9$,X9; ON X9 GOTO 0821,9920
0825 IF V0>1 THEN GOSUB 6950
0850 DIM T[T0,T1]; U5$(1,20)=Q4$
0890 REM "Open Printer
0895 CALL "ZZPRIN",X0$,X3$,Y0$,V3$,Z{ALL},W8$,W9$,W0,W9,W2,W3,W4; ON W4 GOTO 0896,9920
0896 REM "IF FID(0)<>FID(W9) THEN LET W0=34
0897 W8=1,W8$="X"
0898 X$=FID(W9),FORM_CODE$="UR   "+DIM(5)+V$(59,1); CALL "EF2PRM",ERR=0899,X3$,X4$,X$,E7$,E6$,FORM_CODE$,FORM_PARM$; IF E7$(144,2)="JF" THEN JETFORM_MODE=1,JFM$="1",JETFORM_DEV=W9,COMM$="N" ELSE IF E7$(144,2)="UF" THEN UNFORM_MODE=2,UNFORM_DEV=W9 ! SSP 241023
0900 REM 
0910 GOSUB 8600; REM "to set print positions and spacing factors
0920 F0=0; REM "f0=0 haven't printed any yet, f0=1->nowprinting, f0=2->finishing up the last one.
0950 REM " Position read"
0970 DIM V4$(U); U9=1; FOR X=1 TO U0; V4$(U[X,0],U[X,1])=V2$(U9,U[X,1]); U9=U9+2*U[X,1]; NEXT X
0985 V4$(U,1)=CHR(ASC(V4$(U,1))-1)
0990 READ (U1,KEY=V4$,DOM=0991)
0995 GOTO 8300
1000 REM "Read next record and check range
1005 IF F7$="Y" THEN GOTO 8030 ELSE U$=KEY(U1,END=5000)
1010 FOR X=1 TO U0; U2=U[X,0],U3=U[X,0]*2-1,U4=U[X,1]
1020 IF U$(U2,U4)<V2$(U3,U4) THEN READ (U1); EXITTO 1000
1030 IF U$(U2,U4)>V2$(U3+U4,U4) THEN IF X=1 THEN EXITTO 5000 ELSE READ (U1); EXITTO 1000
1040 NEXT X
1100 REM "Get record"
1105 IF V0=2 THEN GOTO 8000
1110 U9$=U$; IF V0<2 THEN GOTO 1150 ELSE U$="",X=0
1120 IF Y[X,0]>0 THEN U$=U$+U9$(Y[X,0],Y[X,1]),X=X+1; GOTO 1120
1130 READ (U1)
1149 REM "This is handled on a customer by customer basis in customer FMS defaults
1150 REM IF U$(21,1)="D" AND U$(22,1)<>"9" THEN READ (Z[1]) ; GOTO 01000; REM "SKIP DISTRIBUTER INVENTORY NOT OWNED BY CUSTOMER
1155 READ (Z[1],KEY=U$,DOM=1000)IOL=0310; IF A0$(1,10)<="0000000000" THEN GOTO 1000; REM "Add to skip extra rcds
1156 IF A0$(89,1)="I" THEN A0[72]=0
1159 IF V0=1 THEN U8$=A$(1,20)
1160 IF A0$(1,20)=A$(1,20) OR X8$(1,20)=A$(1,20) THEN GOSUB 7700; FOR I=0 TO 75; A[I]=A[I]+A0[I]; NEXT I; GOTO 1000
1165 IF F0=0 THEN F0=1; GOTO 1950
1200 REM "Additional Reads
1210 IF D$(1,10)<>A$(1,10) THEN GOSUB 8200
1220 IF D$(1,10)+A$(21,5)<>G$(2,10)+G$(1,1)+G$(12,4) THEN READ (Z[7],KEY=A$(21,1)+D$(1,10)+A$(22,4),DOM=1221)IOL=0370
1330 DIM C$(LEN(C$)); FIND (Z[3],DOM=1331,KEY=A$(1,20))IOL=0330
1340 IF POS("F"=V$(60,11))>0 THEN IF C$(108,1)<>"Y" THEN GOTO 1960
1400 REM "Subtotals"
1410 IF U2$="" THEN GOTO 1490 ELSE FOR T=1 TO U0; IF U8$(U[T,0],U[T,1])<>U2$(U[T,0],U[T,1]) THEN EXITTO 1420 ELSE NEXT T; GOTO 1480
1425 GOSUB 3100
1490 T=0,U2$=U8$
1500 REM "PRINT DATA
1501 NUM_LINES=8; REM SSP
1502 IF POS(X3$(9,3)="598500597",3)>0 THEN NUM_LINES=10; REM SSP
1505 WW0=WW0+1
1510 IF JETFORM_MODE THEN IF WW0>NUM_LINES THEN GOSUB 6000; WW0=1 END_IF ELSE IF W-1>W0 THEN GOSUB 6000; REM SSP 213072
1515 IF JETFORM_MODE THEN F5=1,F5$=C$(345,5); GOSUB 4800 ELSE IF X[1]<>0 THEN Y5$(X[1])=C$(345,5)
1520 IF JETFORM_MODE THEN F5=2,F5$=A$(11,10); GOSUB 4800 ELSE IF X[2]<>0 THEN Y5$(X[2])=A$(11,10) ! SSP#222974
1522 IF JETFORM_MODE THEN F5=3,F5$=C$(42,30); GOSUB 4800 ELSE Y5$(X[3])=C$(42,40)
1530 IF JETFORM_MODE THEN F5=4,F5$=" "; GOSUB 4800 ELSE Y5$(X[4])=" "
1531 IF JETFORM_MODE THEN F5=5,F5$=" "+C$(100,2); GOSUB 4800 ELSE Y5$(X[5])=" "+C$(100,2)
1532 IF JETFORM_MODE THEN F5=6,F5$=STR(C[4]:"####"); GOSUB 4800 ELSE Y5$(X[6])=STR(C[4]:"####")
1535 N1=27,N=A[71],N0=X[27]; GOSUB 2000; REM "Opening inv - whse
1536 REM "IF G$(223,1)="I" THEN LET A[72]=0; REM "0 OUT YOUR SITE IF ISSUE BASED LOCATION
1540 N1=28,N=A[72],N0=X[28]; GOSUB 2000; REM " Opening inv - your site
1545 N1=29,N=A[74],N0=X[29]; GOSUB 2000; REM " Recv'd whse
1550 N1=30,N=A[47]+A[46],N0=X[30]; GOSUB 2000; REM " Drawn - your site
1555 IF LEN(E$)<>0 THEN COMMITTED=A[49]*NUM(E$(226,1)); REM "WO92875
1560 N=A[3]-COMMITTED; IF NUM(E$(226,1))=1 AND A[3]<0 THEN A[3]=0 END_IF ; N1=31,N0=X[31]; GOSUB 2000; REM " Ending inv - whse
1565 N1=32,N=A[4],N0=X[32]; GOSUB 2000; REM " Ending inv - your site
1570 N1=33,N=A[3]+A[4]-COMMITTED,N0=X[33]; GOSUB 2000; REM " Ending inv - total
1575 N1=34,N=A[8],N0=X[34]; GOSUB 2000; REM " Qty on order
1580 I0=1; GOSUB 2200
1590 FOR I2=1 TO 3
1591 IF Q9=1 THEN L0=99.9 ELSE IF C[4]=0 OR (POS("T"=V$(60,11))>0 AND C$(100,4)="M"+DIM(3)) THEN L0=L[I2] ELSE L0=L[I2]/C[4] ! SSP211655, if u/m is thousands and there is a T in the options field, then don't divide by C[4] which would be 1000, want to show amount in thousands
1593 IF JFM$<>"1" THEN IF FPT(L0)=0 THEN Y5$(X[46+I2])=STR(L0:M2$) ELSE Y5$(X[46+I2])=STR(L0:M3$)
1594 IF JFM$="1" THEN IF FPT(L0)=0 THEN F5=46+I2,F5$=STR(L0:M2$); GOSUB 4800 ELSE F5=46+I2,F5$=STR(L0:M3$); GOSUB 4800
1595 NEXT I2
1600 REM 
1610 IF C[4]=0 OR (POS("T"=V$(60,11))>0 AND C$(100,4)="M"+DIM(3)) THEN N9=C[23],N8=C[16] ELSE N9=C[23]/C[4],N8=C[16]/C[4] ! SSP211655, if u/m is thousands and there is a T in the options field, then don't divide by C[4] which would be 1000, want to show amount in thousands
1613 IF Q9=1 THEN N9=99.9
1615 IF JFM$<>"1" THEN IF FPT(N9)=0 THEN Y5$(X[8])=STR(N9:M2$) ELSE Y5$(X[8])=STR(N9:M3$)
1616 IF JFM$="1" THEN IF FPT(N9)=0 THEN F5=8,F5$=STR(N9:M2$); GOSUB 4800 ELSE F5=8,F5$=STR(N9:M3$); GOSUB 4800
1619 IF Q9=1 THEN N7=99.9 ELSE N7=C[22]/30
1620 IF JFM$<>"1" THEN IF FPT(N7)=0 THEN Y5$(X[9])=STR(N7:M2$) ELSE Y5$(X[9])=STR(N7:M3$)
1621 IF JFM$="1" THEN IF FPT(N7)=0 THEN F5=9,F5$=STR(N7:M2$); GOSUB 4800 ELSE F5=9,F5$=STR(N7:M3$); GOSUB 4800
1622 REM "GOSUB 04000
1623 IF Q9=1 THEN N8=99.9
1625 IF JFM$<>"1" THEN IF FPT(N8)=0 THEN Y5$(X[10])=STR(N8:"##") ELSE Y5$(X[10])=STR(N8:"##.#")
1626 IF JFM$="1" THEN IF FPT(N8)=0 THEN F5=10,F5$=STR(N8:M2$); GOSUB 4800 ELSE F5=10,F5$=STR(N8:M3$); GOSUB 4800
1630 GOSUB 4000; REM " IF POS(" "<>C$(126,6))<>0 THEN LET J$=FND$(C$(126,6)), Y5$(X[11])=J$(1,3)+J$(9,2)
1640 GOSUB 4200 ! WO210803, field 91
1680 GOSUB 7300
1700 REM "LINE 2
1709 IF JFM$<>"1" THEN IF X[12]<>0 THEN Y5$(X[12])=A$(48,8) END_IF ELSE F5=12,F5$=A$(48,8); GOSUB 4800
1710 IF JFM$<>"1" THEN IF X[13]<>0 THEN Y5$(X[13])=A$(56,8) END_IF ELSE F5=13,F5$=A$(56,8); GOSUB 4800
1711 IF JFM$<>"1" THEN IF X[14]<>0 THEN Y5$(X[14])=A$(64,2) END_IF ELSE F5=14,F5$=A$(64,2); GOSUB 4800
1712 IF JFM$<>"1" THEN IF X[15]<>0 THEN Y5$(X[15])=C$(238,2) END_IF ELSE F5=15,F5$=C$(238,2); GOSUB 4800
1715 IF JFM$<>"1" THEN IF POS(" "<>C$(238,4))<>0 AND X[16]<>0 THEN Y5$(X[16])=STR(C[25]:"####") END_IF ELSE IF POS(" "<>C$(238,4))<>0 AND X[16]<>0 THEN F5=16,F5$=STR(C[25]:"####"); GOSUB 4800 ELSE F5=16,F5$=""; GOSUB 4800
1719 REM "Watch - X(17) may need changing depending on other values ESP - X(27)
1720 IF JFM$<>"1" THEN IF X[17]<>0 THEN Y5$(X[17])=J5$(X[17]),J5$(1)=""; REM "ELSE IF X[17]<>0 THEN LET F5=17, F5$=J5$(X[17]), J5$(1)=""; GOSUB 04800 ELSE LET F5=17, F5$=""; GOSUB 04800; REM " J5$ SET IN 2000'S
1725 IF JFM$<>"1" THEN IF POS(" "<>A$(26,6))=0 THEN Y5$(X[18])="" ELSE J$=FND$(A$(26,6)),Y5$(X[18])=J$(1,3)+J$(9,2) END_IF ELSE IF POS(" "<>A$(26,6))=0 THEN F5=18,F5$=" "; GOSUB 4800 ELSE J$=FND$(A$(26,6)),F5=18,F5$=J$(1,3)+J$(9,2); GOSUB 4800
1750 REM "IF JETFORM_MODE THEN GOSUB 04100
1752 I0=2; GOSUB 2200
1755 FOR I2=1 TO 3
1756 IF Q9=1 THEN Y5$(X[49+I2])="99.9"; GOTO 1760 ELSE IF L[I2]=0 OR A[3]+A[4]=0 THEN L0=0 ELSE L0=(A[3]+A[4])/L[I2] END_IF END_IF ; IF Q9=1 THEN F5=49+I2,F5$="99.9"
1757 IF L0>99 THEN Y5$(X[49+I2])=">99"; GOTO 1759
1758 IF FPT(L0)=0 THEN Y5$(X[49+I2])=STR(L0:M2$) ELSE Y5$(X[49+I2])=STR(L0:M3$)
1759 IF JETFORM_MODE THEN IF FPT(L0)=0 THEN F5=49+I2,F5$=STR(L0:M2$); GOSUB 4800 ELSE F5=49+I2,F5$=STR(L0:M3$); GOSUB 4800
1760 NEXT I2
1795 GOSUB 7300
1800 REM "Line 3
1805 I0=3; GOSUB 2200
1806 REM "GOTO 01890
1854 REM "Days on hand
1855 FOR I2=1 TO 3
1856 IF Q9=1 THEN L0=9999; GOTO 1858 ELSE IF L[I2]=0 OR A[3]+A[4]=0 THEN L0=0 ELSE L0=(A[3]+A[4])*30/L[I2]
1857 IF JFM$<>"1" THEN IF L0>3000 AND X[52+I2]<>0 THEN Y5$(X[52+I2])=">3000"; GOTO 1860 END_IF ELSE IF L0>3000 AND X[52+I2]<>0 THEN F5=52+I2,F5$=">3000"; GOSUB 4800; GOTO 1860
1858 IF JFM$<>"1" THEN IF X[52+I2]<>0 THEN Y5$(X[52+I2])=STR(L0:M4$) END_IF ELSE IF X[52+I2]<>0 THEN F5=52+I2,F5$=STR(L0:M4$); GOSUB 4800
1860 NEXT I2
1890 GOSUB 7300; IF W<W0+4 THEN GOSUB 7300
1900 REM "Accumulate Totals"
1910 T[T0,0]=T[T0,0]+1
1920 FOR X=0 TO 8; T[T0,X+1]=T[T0,X+1]+A[X]; NEXT X
1922 REM LET T(T0,6)=A(22),T(T0,7)=A(23)
1930 IF Q2=1 THEN RETURN 
1950 REM "Load A from A0 for next one, unless this was the last one (F0=2)
1960 IF F0=2 THEN GOTO 5010 ELSE IF Q9<>1 THEN A$=A0$,J1$=""; DIM J[36],L[3]; GOSUB 7700; FOR I=0 TO 75; A[I]=A0[I]; NEXT I ! SSP212558, added DIM L[3]
1995 IF Q9=1 THEN RETURN ELSE GOTO 1000
2000 REM "Format an print a number, N=number, N0=col #,
2001 REM "Also calc div by second pack and put into J5$
2005 IF JFM$<>"1" THEN IF N0=0 THEN RETURN 
2010 IF C[4]=0 OR (POS("T"=V$(60,11))>0 AND C$(100,4)="M"+DIM(3)) THEN N5=N ELSE N5=N/C[4] ! SSP211655, if u/m is thousands and there is a T in the options field, then don't divide by C[4] which would be 1000, want to show amount in thousands
2018 IF Q9=1 THEN N5=99.999
2020 REM "IF N5<>0 THEN IF FPT(N5)=0 THEN LET Y5$(N0)=STR(N5:"##"), N1$=STR(N5:"#0"); IF JETFORM_MODE THEN LET F5=N1, F5$=N1$; GOSUB 04800 FI ELSE LET Y5$(N0)=STR(N5:"##.###"), N1$=STR(N5:"#0.000"); IF JETFORM_MODE THEN LET F5=N1, F5$=N1$; GOSUB 04800
2022 IF JFM$<>"1" THEN IF N5<>0 THEN IF FPT(N5)=0 THEN Y5$(N0)=STR(N5:"##-"),N1$=STR(N5:"#0-") ELSE Y5$(N0)=STR(N5:"##.###-"),N1$=STR(N5:"#0.000-")
2025 IF JFM$="1" THEN IF N5<>0 THEN IF FPT(N5)=0 THEN N1$=STR(N5:"#0-"),F5=N1,F5$=N1$ ELSE N1$=STR(N5:"##.###-"),F5=N1,F5$=N1$
2028 IF JFM$="1" AND N5<>0 THEN GOSUB 4800
2030 IF JFM$<>"1" THEN IF POS(" "<>C$(238,4))=0 OR C[25]=0 OR X[17]=0 THEN GOTO 2045 ELSE N6=N/C[25]
2032 IF JETFORM_MODE THEN IF POS(" "<>C$(238,4))=0 OR C[25]=0 THEN N6=0; GOTO 2040
2033 IF Q9=1 THEN N6=99.999; GOTO 2035
2034 N6=N/C[25]
2035 REM "IF N6<>0 THEN IF FPT(N6)=0 THEN LET J5$(N0)=STR(N6:"##"), N1$=STR(N6:"#0"); IF JETFORM_MODE THEN LET F5=N1, F5$=N1$; GOSUB 04800 FI ELSE LET J5$(N0)=STR(N6:"##.###"), N1$=STR(N6:"#0.000"); IF JETFORM_MODE THEN LET F5=N1, F5$=N1$; GOSUB 04800
2036 IF JFM$<>"1" THEN IF N6<>0 THEN IF FPT(N6)=0 THEN J5$(N0)=STR(N6:"##"),N1$=STR(N6:"#0") ELSE J5$(N0)=STR(N6:"##.###"),N1$=STR(N6:"#0.000")
2038 IF JFM$="1" THEN IF N6<>0 THEN IF FPT(N6)=0 THEN N1$=STR(N6:"#0"),F5=N1,F5$=N1$ ELSE N1$=STR(N6:"##.###"),F5=N1,F5$=N1$
2039 IF JFM$="1" AND N6<>0 THEN GOSUB 4800
2040 IF JETFORM_MODE THEN IF N5=0 THEN F5=N1,F5$=" "; GOSUB 4800
2042 IF JETFORM_MODE THEN IF N6=0 THEN F5=N1,F5$=" "; GOSUB 4800
2095 RETURN 
2200 REM "Given I0(1,2,or 3) print appropiate J() entries and J1$ data
2202 Q=0; FOR I2=1 TO 12; Q=Q+J[I2+(I0-1)*12]; NEXT I2
2203 IF JFM$<>"1" THEN IF Q9=1 THEN Y5$(X[20])="99"; GOTO 2208 ELSE IF (Q=0 AND MID(V$,73,1)<>"Y") OR J1$="" THEN GOTO 2245; REM "Don't print anything if no usage for the year, SSP 221233, unless param set to Y.!SSP#222974
2204 IF JETFORM_MODE THEN IF (Q=0 AND MID(V$,73,1)<>"Y") OR J1$="" THEN GOSUB 6500; GOTO 2245; REM "Fill in blank fields, SSP 221233, unless param set to Y
2206 IF JETFORM_MODE THEN F5=20,F5$=J1$(I0*2-1,2); GOSUB 4800 ELSE Y5$(X[20])=J1$(I0*2-1,2)
2208 FOR I1=1 TO 12
2210 IF C[4]=0 OR (POS("T"=V$(60,11))>0 AND C$(100,4)="M"+DIM(3)) THEN N5=J[I1+(I0-1)*12] ELSE N5=J[I1+(I0-1)*12]/C[4] ! SSP211655, if u/m is thousands and there is a T in the options field, then don't divide by C[4] which would be 1000, want to show amount in thousands 
2212 IF POS("M"=V$(60,11))<>0 THEN N5=J[I1+(I0-1)*12]/1000; REM "Done for Cindy they require everything in 1000's not u/m (Usage)
2214 IF Q9=1 THEN N5=99.9
2215 REM IF FPT(N5)<>0 THEN LET Y5$(X(21)+(I1-1)*S(3))=STR(N5:M3$) ELSE IF N5<100 THEN LET Y5$(X(21)+(I1-1)*S(3))=STR(N5:M2$) ELSE LET Y5$(X(21)+(I1-1)*S(3)+1)=STR(N5:M2$)
2216 IF JFM$<>"1" THEN IF X[59]=1 AND FPT(N5)=0 THEN Y5$(X[34+I1])=STR(N5:M2$) ELSE Y5$(X[34+I1])=STR(N5:M3$)
2218 IF JETFORM_MODE THEN IF X[59]=1 AND FPT(N5)=0 THEN F5=34+I1,F5$=STR(N5:M2$); GOSUB 4800 ELSE F5=34+I1,F5$=STR(N5:M3$); GOSUB 4800 END_IF 
2220 NEXT I1
2245 RETURN 
3000 REM "Subtotaling Routines"
3050 REM "Add to T$ for total title, T & T5 should be set
3060 IF T7$(1,1)=" " THEN RETURN 
3070 IF T7$(1,1)<>"S" THEN CALL "ZZDISP",T7$(1,1)+"X",T6$,T7$(2,3),X3$,T6$,"",0,0,X4$
3080 IF T$="" THEN T$=T6$ ELSE T$=T$+" "+T6$
3090 RETURN 
3100 REM "Subtotal Logic
3110 FOR T=U0 TO T STEP -1
3130 T$=FNS$(U5$(T*20+1,20)),T6$=U2$(U[T,0],U[T,1]),T7$=T5$(T*4+1,4); GOSUB 3050; IF POS(U0$(T+1,1)="23")>0 THEN GOSUB 7000 ELSE GOSUB 7100
3150 IF POS(U0$(T+1,1)="13")>0 THEN GOSUB 6000
3180 NEXT T
3195 RETURN 
3280 RETURN 
3380 RETURN 
3480 RETURN 
4000 REM " GET LAST ORDER DATE FROM ORDER HISTORY
4010 DIM O[40]; O$=""
4030 CALL "FM2UZD",X3$,X4$,A$(1,20),O$,O{ALL},O4$,O2$,O0,O1,O2,H0$,H1$,""; O=LEN(O$)/23
4040 IF O<>0 THEN J$=FND$(O$((O-1)*23+9,6)),Y5$(X[11])=J$(1,3)+J$(9,2)
4042 IF JETFORM_MODE AND POS(X3$(9,3)="598",3)<>0 AND POS(" "<>C$(126,6))<>0 THEN J$=FND$(C$(126,6)),F5=11,F5$=J$(1,3)+J$(9,2); GOSUB 4800; GOTO 4045 ! SSP#212542
4044 IF JETFORM_MODE THEN IF O<>0 THEN F5=11,F5$=J$(1,3)+J$(9,2); GOSUB 4800 ELSE F5=11,F5$=""; GOSUB 4800
4050 IF O<>0 AND C[4]<>0 THEN READ (Z[10],KEY=A$(1,10)+"B"+A$(11,10)+O$((O-1)*23+1,8)+O$((O-1)*23+21,1),DOM=4051)IOL=0380; N8=FS6[0]/C[4]
4090 RETURN 
4100 REM "PRINT ADDITIONAL DATA
4101 ESCAPE 
4110 N1=27,N=A[71],N0=X[27]; GOSUB 2000; REM "Opening inv - whse
4120 N1=28,N=A[72],N0=X[28]; GOSUB 2000; REM " Opening inv - your site
4130 N1=29,N=A[74],N0=X[29]; GOSUB 2000; REM " Recv'd whse
4140 N1=30,N=A[47]+A[46],N0=X[30]; GOSUB 2000; REM " Drawn - your site
4150 IF LEN(E$)<>0 THEN COMMITTED=A[49]*NUM(E$(226,1)); REM "WO92875
4160 N=A[3]-COMMITTED; IF NUM(E$(226,1))=1 AND A[3]<0 THEN A[3]=0 END_IF ; N1=31,N0=X[31]; GOSUB 2000; REM " Ending inv - whse
4165 N1=32,N=A[4],N0=X[32]; GOSUB 2000; REM " Ending inv - your site
4166 ESCAPE 
4170 N1=33,N=A[3]+A[4]-COMMITTED,N0=X[33]; GOSUB 2000; REM " Ending inv - total
4171 ESCAPE 
4175 N1=34,N=A[8],N0=X[34]; GOSUB 2000; REM " Qty on order
4195 RETURN 
4200 ! WO210803, field 91, print asterisk if item needs to be reordered
4205 IF X[91]=0 THEN GOTO *RETURN
4210 F5=91,F5$=" "
4215 QTY_ON_HAND=A[3]+A[4] ! qty on hand whse plus customer sites
4220 AVG_MOS_USAGE=C[24]; IF AVG_MOS_USAGE=0 THEN AVG_MOS_USAGE=1
4221 IF AVG_MOS_USAGE<0 THEN GOTO 4280 ! SSP212558, if negative avg monthly usage then don't print *
4225 MTH_QTY_ON_HAND=QTY_ON_HAND/AVG_MOS_USAGE
4230 IF C[23]>0 THEN IF C[23]>QTY_ON_HAND THEN F5$="*" END_IF ; GOTO 4280 ! if ROP qty from FM1 is greater than zero, then use it to see if needs reorder
4235 IF C[22]>0 THEN IF C[22]/30>MTH_QTY_ON_HAND THEN F5$="*" END_IF ; GOTO 4280 ! if ROP qty is zero, then try ROP days, if not zero then use it to see if needs reorder
4275 ! print * or not for this item
4280 IF JETFORM_MODE THEN GOSUB 4800 ELSE IF Q9=1 THEN Y5$(X[91],1)="*" ELSE Y5$(X[91],1)=F5$ ! If test pattern then always print asterisk
4290 RETURN 
4295 ! 
4600 REM "Setup Fax String
4602 REM "This was pulled from other prg: vars need to be fixed
4605 DIM XTMP$(3*51)
4610 CALL "ZZDISP","AX",A$(15,10),"F/M",X3$,TMP$,"",0,0,X4$
4615 XTMP$(1)="C"+G$(143,12),XTMP$(27)="C:"+TMP$; REM "Cust
4620 XTMP$(52)="T"+E$(138,12); IF POS(" "<>E$(12,4))=0 THEN XTMP$(78)="T:"+TMP$ ELSE XTMP$(78)="T:"+TMP$+"-"+A$(187,4); REM "Ship to"
4625 XTMP$(103)="S"+D$(127,12); XTMP$(129,25)="S:"+A$(133,4)+"-"+D$(5,30); REM "Salesperson
4640 IF J8=1 THEN FOR TMP=0 TO 2; XTMP$(2+TMP*51,25)=EF_PARAM$(150,12); NEXT TMP; REM "If Alignment, replace with Align from paramtrs
4643 CALL "ZZDISP","AX",A$(7,8),"AR6",X3$,TMP$,"",0,0,X4$; TMP$="USAGE:"+TMP$; REM "Tag 1 for fax
4645 RETURN 
4800 JETFORM_PRINT:REM "For jetform mode add field nominated value with F5 as the field name and F5$ as the value"
4805 IF F5$="" OR STP(F5$,2)="0" OR STP(F5$,2)=".0" THEN F5$=" "
4810 IF STP(F5$,2)="/" OR F5$="00000" THEN F5$=" "
4815 PRINT (W9)"^field "+STP(E7$(146,3),1)+STR(F5:"000"),'LF',F5$
4845 JETFORM_PRINT_END:RETURN 
5000 REM "End of Print
5005 IF F0=1 THEN F0=2; GOTO 1170; REM "FINISH UP LAST ONE IF NEEDED
5010 GOTO 5090
5020 IF W8=0 THEN GOTO 5290
5030 T0$="END"
5050 T=0; GOSUB 3100
5200 REM "
5295 GOTO 9900
6000 REM "Page header
6010 IF JETFORM_MODE OR UNFORM_MODE THEN IF T0$="END" THEN GOTO 6090 ELSE W8=W8+1; GOSUB 6400; GOTO 6060 ! 241023
6011 IF W=999 THEN W=0; GOSUB 6400 ! GOTO 6060 SSP 241023
6040 CALL "ZZHEAD",X0$,X1$,X2$,X3$,W0$,W1$,W2$,W9$,W3,W,W9,W8,W0,W5,W2,W8$,W5$; IF T0$="END" THEN GOTO 6090 ELSE ON W5 GOTO 6041,9910
6041 REM "IF X3$(9,3)="322" THEN PRINT (W9) 'FF'; REM "FORM FEED ON LASER PRINTER
6060 GOSUB 6200
6065 GOSUB 6100
6070 GOSUB 7300
6090 RETURN 
6100 REM "
6195 IF JFM$<>"1" THEN IF FID(W9)=FID(0) THEN PRINT 'SF',
6199 RETURN 
6200 REM "CUSTOMER HEADERS
6205 FOR L9=1 TO 4; GOSUB 7300; NEXT L9; REM "WO91564, was 6 now 4
6206 IF JETFORM_MODE THEN F5=73,F5$=D$(278,4); GOSUB 4800 ELSE IF X[73]<>0 THEN Y5$(X[73])=D$(278,4); REM "WO84429
6207 IF JETFORM_MODE THEN F5=74,F5$=AR3$(5,35); GOSUB 4800 ELSE IF X[74]<>0 THEN Y5$(X[74])=AR3$(5,35); REM "WO84429
6208 GOSUB 7300; GOSUB 7300
6210 IF JETFORM_MODE THEN F5=22,F5$=FNS$(D$(11,35)); GOSUB 4800 ELSE IF X[22]<>0 THEN Y5$(X[22])=FNS$(D$(11,35)) ! ssp#222974
6212 IF JETFORM_MODE THEN F5=23,F5$=D1$; GOSUB 4800 ELSE IF X[23]<>0 THEN Y5$(X[23])=D1$ ! SSP#222974
6215 IF JETFORM_MODE THEN F5=24,F5$=FND$(X3$(21,6)); GOSUB 4800 ELSE IF X[24]<>0 THEN Y5$(X[24])=FND$(X3$(21,6)) ! SSP#222974
6220 IF JETFORM_MODE THEN F5=25,F5$=FND$(D8$); GOSUB 4800 ELSE IF X[25]<>0 THEN Y5$(X[25])=FND$(D8$) ! SSP#222974
6222 IF JETFORM_MODE THEN F5=26,F5$=FND$(D9$); GOSUB 4800 ELSE IF X[26]<>0 THEN Y5$(X[26])=FND$(D9$) ! SSP#SSP222974
6227 IF JETFORM_MODE THEN F5=57,F5$=STR(W8:M2$); GOSUB 4800 ELSE IF X[57]<>0 THEN Y5$(X[57])=STR(W8:M2$)
6230 GOSUB 7300
6235 FOR L9=1 TO 5; GOSUB 7300; NEXT L9
6237 GOSUB MONTH_HEADERS
6238 GOSUB 7300
6240 REM "IF X3$(9,3)="322" THEN GOSUB 07300; REM "ADD EXTRA LINE FEED IN HEADER
6295 RETURN 
6310 F5=81,F5$=STR(T[T,1]:Z0$); GOSUB 4800
6311 F5=82,F5$=STR(T[T,2]:Z0$); GOSUB 4800
6312 F5=83,F5$=STR(T[T,3]:Z0$); GOSUB 4800
6313 F5=84,F5$=STR(T[T,4]:Z0$); GOSUB 4800
6314 RETURN 
6334 RETURN 
6400 REM "Do EF2JET ...
6410 IF JETFORM_MODE THEN CALL "EF2JET",X3$,X4$,E7$,COMM$,JETFORM_DEV,FORM_PARM$,JOB_MODIFIER$,RET$; REM "If jetform mode then do new or eject
6412 IF UNFORM_MODE THEN CALL "EF2UNF",X3$,X4$,E7$,"N",UNFORM_DEV,FORM_PARM$,JOB_MODIFIER$,RET$; REM "If unform mode then do new or eject SSP 241023
6415 W=0,COMM$="E",WW0=0
6445 RETURN 
6500 REM "Fill empty slots in Jetform mode!SSP#222974
6520 F5=20,F5$=" "; GOSUB 4800
6550 FOR II1=1 TO 12
6555 F5=34+II1,F5$=""; GOSUB 4800
6580 NEXT II1
6590 RETURN 
6900 REM "SORT
6990 RETURN 
7000 REM "Totals logic
7002 IF V0=2 AND T$(1,8)="Division" AND P1$(13,1)<>"Y" THEN GOTO 7100
7003 IF JETFORM_MODE=0 THEN IF W+3>W0 THEN GOSUB 6000
7005 IF JETFORM_MODE=0 THEN Y5$(49)=T1$(1,13),Y5$(62)=T1$(1,13),Y5$(75)=T1$(1,12),Y5$(110)=T1$(1,12); IF V0$(74,1)="Y" THEN Y5$(62,48)=""
7006 GOSUB 7300
7010 IF JETFORM_MODE=0 THEN Y5$(1)=T3$(1,T0+1-T)+" "
7015 IF T$<>"" THEN IF JETFORM_MODE=0 THEN Y5$(T0+2-T)=T$+" Total ("+STR(T[T,0]:"0")+"):" ELSE F5=80,F5$=STR(T[T,0]:"0"); GOSUB 4800
7020 IF JETFORM_MODE=0 THEN Y5$(49)=STR(T[T,1]:Z0$),Y5$(62)=STR(T[T,2]:Z0$),Y5$(75)=STR(T[T,3]:Z1$),Y5$(110)=STR(T[T,4]:Z0$); IF V0$(74,1)="Y" THEN Y5$(62,48)="" END_IF ELSE GOSUB 6310
7030 GOSUB 7300
7065 IF JETFORM_MODE=0 THEN IF T$="END" THEN Y5$(49)=T2$(1,13),Y5$(62)=T2$(1,13),Y5$(75)=T2$(1,12),Y5$(110)=T2$(1,12); IF V0$(74,1)="Y" THEN Y5$(62,48)=""
7066 GOSUB 7300
7090 IF T0$="END" THEN IF T=0 THEN GOSUB 7200; GOTO 7190
7095 GOSUB 7300
7100 REM "Accumulate sub totals
7110 IF T=0 THEN GOTO 7190
7120 FOR X=0 TO T1
7130 T[T-1,X]=T[T-1,X]+T[T,X],T[T,X]=0
7140 NEXT X
7190 RETURN 
7200 REM "Elapsed time routine"
7202 GOSUB 7300
7205 GOSUB 7300; Y5$(1)="Number of items printed: "+STR(T[0,0]); GOSUB 7300
7210 PRECISION 14; T2=TIM-T2
7220 IF INT(T2)>0 THEN T4$=STR(INT(T2))+" Hours " ELSE T4$=""
7230 T3=INT(FPT(T2)*3600)
7240 T3=T3/60
7250 T4$=T4$+STR(T3:"##.##")+" Minutes"
7260 Y5$(1)="Elapsed time: "+T4$; GOSUB 7300
7280 PRECISION 2
7290 RETURN 
7300 REM "Output line Y5$ to output device
7305 IF JETFORM_MODE THEN RETURN 
7310 IF POS("V"=W8$)>0 THEN CALL "ZZVIEW",X3$,0,0,W3,W9,W,W9$,Y5$; GOTO 7390
7320 W=W+1
7330 PRINT (W9)STP(Y5$,1); DIM Y5$(W3)
7390 IF W-4>W0 THEN GOSUB 6000
7395 RETURN 
7400 REM "Read report selection parameters"
7410 Z$="12O ZZP     13O ZZPARM  "
7420 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 7421,9900
7430 Y3$=X3$(1,6),Y4$=X3$(178,7)
7435 DIM V[1]
7450 READ (Z[12],KEY=X3$(1,8),DOM=7451)IOL=0420
7480 X3$(178,7)=Y4$,V0=NUM(V$(71,1)),W3$=V$(19,POS("   "=V$(19,40)+"   ")-1) ! SSP#307329
7485 FOR U1=1 TO LEN(V1$); IF V1$(U1,1)=" " THEN V1$(U1,1)="."; NEXT U1 ELSE NEXT U1
7490 RETURN 
7500 REM "Customer Change (This routine is not used???)
7510 READ (Z[6],KEY=U$(1,10))IOL=0360
7515 READ (Z[7],KEY="D"+F$(1,10))IOL=0370
7525 REM "Modified stmts:
7540 D0$=G$(52,4)
7545 P0$=G$(52,4),P1$=G$(56,2),P0=NUM(P1$)
7550 CALL "GL2RZA",X3$,"E"+U$(1,10),P0$,P1$,W2$,Z[8],Z[7]
7575 REM "Deleted stmts:
7590 RETURN 
7600 REM "Prior year periods
7601 ESCAPE 
7610 IF NUM(FNE$(A1$(41,2)))<NUM(D1$) THEN F2=12; GOTO 7630 ELSE IF NUM(FNE$(A1$(41,2)))>NUM(D1$) THEN F2=0; GOTO 7630
7620 P0=POS(A1$(43,2)=H7$,2); F2=P0/2+.5
7640 RETURN 
7650 REM "Current year periods
7660 IF NUM(FNE$(A1$(41,2)))<NUM(D0$) THEN F1=12; GOTO 7680 ELSE IF NUM(FNE$(A1$(41,2)))>NUM(D0$) THEN F1=0; GOTO 7680
7670 P0=POS(A1$(43,2)=H7$,2); F1=P0/2+.5
7680 P0=POS(V0$(78,2)=H7$,2); F3=P0/2-.5
7685 F4=F1-F3
7695 RETURN 
7700 REM "Read current year usage
7705 IF A0$(21,1)="D" THEN GOTO 7795
7707 READ (Z[5],KEY="D"+A0$(1,10))IOL=0350
7708 YEAR$=E$(52,4)+STR(NUM(E$(52,4))-1:"0000")+STR(NUM(E$(52,4))-2:"0000"); IF J1$="" THEN J1$=YEAR$(3,2)+YEAR$(7,2)+YEAR$(11,2)
7710 X9=POS("U"=F1$,5),Q$="R",X$="U",J$=A0$(1,20)+A0$(22,4),D7$=E$(52,4)
7715 FIND (Z[8],KEY=J$+D7$+X$,DOM=7740); GOTO 7720; REM "See if the stats are there if not then skip
7720 DIM G[14]; CALL "ZZPACK",X3$,Q$,F1$(X9+2,3),"",0,0,G{ALL},Z[8],X$,J$+D7$,F9$
7725 FOR I0=1 TO 12; J[I0]=J[I0]+G[I0]; NEXT I0
7740 REM "Read previous year
7745 D7$=STR(NUM(E$(52,4))-1:"0000")
7750 FIND (Z[8],KEY=J$+D7$+X$,DOM=7765); GOTO 7755; REM "See if the stats are there, if not then skip them
7755 DIM G[14]; CALL "ZZPACK",X3$,Q$,F1$(X9+2,3),P9$,0,0,G{ALL},Z[8],X$,J$+D7$,F9$
7760 FOR I0=1 TO 12; J[I0+12]=J[I0+12]+G[I0]; NEXT I0
7765 D7$=STR(NUM(E$(52,4))-2:"0000")
7768 FIND (Z[8],KEY=J$+D7$+X$,DOM=7790); GOTO 7770; REM "See if the stats are there, if not then skip them
7770 DIM G[14]; CALL "ZZPACK",X3$,Q$,F1$(X9+2,3),P9$,0,0,G{ALL},Z[8],X$,J$+D7$,F9$
7775 FOR I0=1 TO 12; J[I0+24]=J[I0+24]+G[I0]; NEXT I0
7790 GOSUB 7800
7795 RETURN 
7800 REM "Calculate avg monthly usage(GIVEN CURRENT VALUES IN J()) for last 4, L(1), last 8, L(2), and last 12, L(3), months
7801 REM "We know that we will start somewhere in the first year (j(1)-j(12))
7802 REM "L0 is total usage so far, L1 is # of months done so far
7805 DIM L[3]; L0=0,L1=0,I0=NUM(E$(56,2)); REM "Read in 7700's
7810 L0=L0+J[I0],L1=L1+1
7814 REM "if proper months back save off, after dividing the total usage by the number of months so far
7815 IF L1=4 THEN L[1]=L0/4 ELSE IF L1=X[58] THEN L[2]=L0/X[58] ELSE IF L1=12 THEN L[3]=L0/12; GOTO 7840
7829 REM "If at jan of a year adjust to start dec of previous year,else just subtract 1
7830 IF I0=1 THEN I0=24 ELSE IF I0=13 THEN I0=36 ELSE I0=I0-1
7835 GOTO 7810
7845 RETURN 
7900 REM "CONVERT VALUES FOR PUBLIC CONSUMPTION
7910 FOR X=0 TO 5
7915 Q[X]=Q[X]/I0
7920 NEXT X
7990 RETURN 
8000 REM "Salesperson/Customer Order
8010 K9$=U$; READ (U1,END=5000)
8020 READ (Z[1],KEY=K9$(5),DOM=8021)
8030 READ (Z[1],END=8090)IOL=0310
8040 IF A0$(1,10)<>K9$(5,10) THEN GOTO 8090
8050 F7$="Y",U$=A0$(1,25),U8$=K9$
8060 GOTO 1156
8090 IF F7$="Y" THEN Q2=1; GOSUB 1165; Q2=0,F0=0,F7$=""; GOTO 1000 ELSE F7$=""; GOTO 1000
8100 REM "RETURN STATUS IN S9$
8105 S9$=""
8110 IF A[5]>0 AND A[6]>0 THEN IF A[5]<A[6] THEN S9$="^ BELOW MINIMUM ^"; GOTO 8180
8180 CALL "FM2MAZ",X3$,C$,S8$
8185 P=POS(C$(42,40)=S8$+S$); IF P>0 THEN S8$=S8$(1,P-1)
8190 RETURN 
8200 REM "Customer Change
8210 READ (Z[4],KEY=A$(1,10))IOL=0340
8215 READ (Z[5],KEY="D"+D$(1,10))IOL=0350
8220 READ (Z[5],KEY="E"+D$(1,10)+E$(52,4))E0$
8223 D9$=E0$(18+6*NUM(E$(56,2)),6)
8224 D8$=E0$(12+6*NUM(E$(56,2)),6); CALL "ZZDATE",X3$,"",D8$,"",1,0,0,0,0,0,0,"","",""; REM "Prev period end date + 1
8235 Q$=D$(1,10); GOSUB 8500; D1$=X$
8240 DIM AR3$(255); FIND (Z[9],KEY=D$(278,4),DOM=8241)AR3$
8279 REM "RESET PAGE NUMBER FOR EACH CUSTOMER ADDED 4/30/93
8280 IF W8<>0 THEN IF JETFORM_MODE OR UNFORM_MODE THEN W8=0 ELSE W8=.1; REM "100442 SSP241023
8285 COMM$="N"
8290 RETURN 
8300 REM "TEST PATTERN
8301 IF JETFORM_MODE THEN GOTO 1000
8304 DIM A$(33),A[75],A0$(33),A0[75],C$(387),C[28],S$(40),D$(397),J[36],J1$(10),E0$(161),AR3$(255),D$(400)
8305 CALL "ZZPROM","R4",X3$,Z,"","","",0
8310 ON Z GOTO 1000,8311,5000
8320 DIM D$(397,"X"),D1$(10,"X"),C$(387,"X"),A$(65,"X"),AR3$(255,"X"),E$(243)
8325 D8$="J59999",D9$="J59999",E0$(26,2)="01"
8330 GOSUB 6000
8335 Q9=1,C[4]=9999,C$(126,6)="J59999",C[25]=9999,A$(26,6)="J59999"
8340 FOR I4=1 TO 3
8345 GOSUB 1500
8350 NEXT I4
8353 FOR X=W+2 TO W0+8; PRINT (W9)'LF',; NEXT X
8355 Q9=0,W=999,U2$=""
8390 GOTO 8300
8450 REM "Place in page offset by a number of lines
8451 REM "F5=field#, F5$=field info, F6=# of lines of offset position
8455 IF X9[F5]=0 THEN GOTO 8495 ELSE IF JETFORM_MODE THEN GOSUB JETFORM_PRINT; GOTO 8495
8460 P$(X9[F5]+(Y9[F5]+F6)*W3,LEN(F5$))=F5$
8495 RETURN 
8500 REM "RETUR  CUST CODE FROM Q$ IN X$
8510 CALL "ZZDISP","AX",Q$,"A/R",X3$,X$,"",0,0,X4$
8520 FIND (Z[4],KEY=Q$,DOM=8521)Q$; Q$=FNS$(Q$(11,35))
8540 RETURN 
8600 REM "Set up column arrays, X()=xpositions, S()=spacing factors
8605 DIM X[100],Y9[100]
8610 READ (Z[13],DOM=8625,KEY="FORMAT"+"UR"+V$(59,1))IOL=0313,IOL=0315; REM "CHG from 8613
8620 IF X[60]=2 THEN M2$="###",M3$="##.#-",M4$="#,###"
8621 RETURN 
8680 REM "Standard values (orig for Hart (comp#111)
8685 REM "LET S(1)=5,S(2)=5,S(3)=5,X(1)=4,X(2)=10,X(3)=31,X(4)=54,X(5)=56,X(6)=60,X(7)=183,X(8)=203,X(9)=208,X(10)=213,X(11)=218,X(12)=31,X(13)=41,X(14)=50,X(15)=56,X(16)=60,X(17)=65,X(18)=112,X(19)=183,X(20)=124
8686 REM "IF X3$(9,3)="111" THEN LET X(5)=56,X(6)=60
8687 REM "LET X(21)=122,X(22)=4,X(23)=57,X(24)=71,X(25)=94,X(26)=113,X(27)=65,X(28)=70,X(29)=77,X(30)=83,X(31)=93,X(32)=100,X(33)=106,X(34)=118
8688 REM "FOR I=1 TO 34; LET X(I)=X(I)+1; NEXT I; REM "SHIFT WHOLE FORM OVER
8689 REM "IF POS(X3$(9,3)="289500",3)<>0 THEN LET X(27)=63,X(28)=69,X(29)=75,X(30)=82,X(5)=53,X(15)=53,X(3)=29
8692 FOR I=1 TO 100; IF X<>56 THEN X[I]=X[I]+X[56]; NEXT I; REM "Shift whole item over
8695 RETURN 
8700 MONTH_HEADERS:REM "Print column headings for period's 1 thru 12
8710 Y=NUM(E0$(26,2),ERR=8795); REM "Set Y to month of first period of customer's fiscal year
8712 IF Y=0 THEN Y=1
8715 X=Y*3-2; REM "Get starting point for month string
8720 FIELD=61
8725 FOR LOOP=1 TO 12
8730 IF JETFORM_MODE THEN F5=FIELD,F5$=MONTH_HEADER$(X,3); GOSUB 4800 ELSE IF X[FIELD]<>0 THEN Y5$(X[FIELD])=MONTH_HEADER$(X,3)
8735 FIELD=FIELD+1,X=X+3
8740 NEXT LOOP
8745 GOSUB 7300
8795 END_MONTH_HEADERS:RETURN 
8800 REM "Place in page, F5 = field #, F5$ = field info
8805 IF X9[F5]=0 THEN GOTO 8845 ELSE IF JETFORM_MODE THEN GOSUB JETFORM_PRINT; GOTO 8345
8806 IF B9=1 THEN CALL "BC2FMY",X3$,X4$,A0$,A0{ALL},F5,F5$,0,0,P$,O$,A9$,"",Q{ALL}; GOTO 8320; REM "Use barcode module
8845 RETURN 
8850 REM "Setup line print
8905 DEF FNP$(Z9$)="("+Z9$(1,3)+") "+Z9$(4,3)+"-"+Z9$(7,4)+" Ext: "+Z9$(11,4)
8910 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
8915 DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
8920 DEF FNB$(Z9$)=X3$(214-6*NUM(Z9$),1)
8940 DEF FNS$(Z$)=Z$(1,POS("   "=Z$+"   ")-1)
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9018 ESCAPE 
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 1000
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000
9520 IF Y5=68 THEN RETRY ELSE ON C9 GOTO 1140,2040
9900 REM "End program
9905 IF POS("V"=W8$)>0 AND JETFORM_MODE=0 AND UNFORM_MODE=0 THEN GOSUB 6000; REM "ELSE IF X3$(9,3)="322" THEN PRINT 'FF'; REM "@PROGRADE, DO FF FOR LASER PRINTER SSP 241023
9909 IF JETFORM_MODE THEN W8=0; REM "if JETFORM then clear page to 0 to print linefeeding
9910 CALL "ZZERPT",X3$,X4$,X0$,Y3$,Y4$,W9,W2,W5,W,W0,W8,T3,V3$
9920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 IF NOT(NUL(Y4$)) THEN CALL Y4$,ERR=*NEXT ELSE RUN Y4$,ERR=9931
9940 IF %GUI THEN EXIT ELSE RUN "ZMENU"
9999 END 
50007 REM "213072-Can the laser Jetform F/M usage report be changed from 8
56000 REM "210803-Modify Usage Report flexible format and printing program,
56002 REM "211655-Modify Usage Report concerning M/1000 U/M, don't want to
56004 REM "212558-WO210803; If the avg monthly usage is negative, don't do
56006 ! SSP212542 (changes incorporated with 212558) Problem with Form Usage report FMR U8
56007 REM "221233-Modify report to print usage amts even if total usage is 0
56008 REM "222974-PE in Print Management Usage Report                         
56010 REM "241023-Modify printing programs to use Unform                      
