0010 REM "Physical Count Entry Detail <FM2PDZ>
0020 SETESC 9300; SETERR 9000
0035 REM "3.7 - 04/19/94 - 9.59 - jsc
0040 REM "Copyright 1994 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0300 REM "IOLISTS
0310 IOLIST A$(1),A[0],A[1],A[2],A[3],A[4],A[5],A[6]
0320 IOLIST B$
0330 IOLIST C$,C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15],C[16],C[17],C[18],C[19],C[20]
0340 IOLIST D$,D[0],D[1],D[2],D[3],D[4],D[5],D[6]
0390 IOLIST E$,E[0],E[1]
0395 IOLIST F$,F[0],F[1]
1020 ENTER X3$,X4$,Z{ALL},F$,F{ALL},A$,A{ALL},M0$,M1$,C$,C{ALL},S9,S0,S1,S2,S3,C0
1025 DIM S$(20)
1045 IF A$(S2,4)="ADJ " THEN DIM F$(21); F[1]=1
1050 FIND (Z[13],KEY="U/M"+A$(S2,4),DOM=1051)IOL=0395
1700 GOTO 2000
1820 GOTO 9900
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF C0>3 OR X0<0 THEN GOTO 1800
2040 ON X0 GOTO 2350,2300,2250,1800
2250 REM "Physical count
2252 IF A[S1]=0 THEN A[S1]=1
2257 DIM J[1]; IF F$(20,1)<>"Y" THEN J[0]=A[S0]/A[S1] ELSE IF F[1]<>0 THEN J[0]=A[S0]/F[1] ELSE J[0]=A[S0]
2260 CALL "ZZENTR","N.",J{ALL},A$,X4$,X3$,40,S9,0,822,C0,M0$,"{3"+X$,Q$,"FM2PDA14","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2260,2261
2270 IF F$(20,1)<>"Y" THEN A[S0]=J[0]*A[S1] ELSE IF F[1]<>0 THEN A[S0]=J[0]*F[1] ELSE A[S0]=J[0]
2280 GOSUB 7500
2290 GOTO 2020
2300 REM "Physical Count Packing
2305 IF A[S1]=0 THEN A[S1]=1
2307 IF F$(20,1)="Y" THEN PRINT @(30,S9),A[S1]:M1$,; GOTO 2020
2308 IF C0<>2 THEN C0=1; GOTO 2020
2310 CALL "ZZENTR","N&",A{ALL},A$,X4$,X3$,30,S9,S1,501,C0,M1$,"{3"+X$,Q$,"FM2PDA16","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2310,2311
2340 GOTO 2020
2350 REM "Physical Count U/M
2355 IF S2=46 THEN IF A$(S2,4)="    " THEN A$(S2,4)=A$(42,4),A[S1]=A[2]; PRINT @(23,15),A$(S2,4),@(30,15),A[S1]:M1$,; X0=X0+1; GOTO 2370
2357 IF A$(S2,4)<>"    " THEN IF C0<>2 THEN C0=1; GOTO 2020
2360 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,23,S9,S2,4,C0,"","{3"+X$,"U/M","FM2PDA18","U/M","ZZ2MUA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2360,2361
2365 IF A$(S2,4)=S$(1,4) THEN A[S0]=0,A[S1]=0; GOTO 9900
2366 IF C0<0 THEN GOTO 2020
2367 IF A$(S2,4)="ADJ " THEN F$(1,7)="U/MADJ",F[0]=0,F[1]=1; GOTO 2371
2370 FIND (Z[13],KEY="U/M"+A$(S2,4),DOM=2360)IOL=0395
2380 IF LEN(C$)>238 THEN IF F$(20,1)<>"Y" THEN P=POS(A$(S2,4)=C$(238,16),4); IF P=0 THEN GOTO 2020 ELSE P=INT(P/4),A[S1]=C[25+P]; GOTO 2020
2385 IF F$(20,1)="Y" THEN IF F[0]<>0 THEN A[S1]=F[0] ELSE A[S1]=F[1]
2390 GOTO 2020
6200 REM "DISPLAY DATA
6205 SETERR 6290
6210 DIM J[1]
6215 GOSUB 6450
6218 IF A[2]=0 THEN A[2]=1
6219 IF A[S1]=0 THEN A[S1]=1
6220 IF A$(41,1)<>" " THEN GOTO 6228
6221 IF A[2]=0 THEN A[2]=1 ELSE IF E[1]=0 THEN E[1]=1
6222 IF E$(20,1)<>"Y" THEN J[0]=(A[0]+A[1])/A[2] ELSE J[0]=(A[0]+A[1])/E[1]
6223 J0=J[0]
6228 IF F$(20,1)<>"Y" THEN J[0]=A[S0]/A[S1] ELSE J[0]=A[S0]/F[1]
6230 PRINT @(23,S9),A$(S2,4),@(30,S9),A[S1]:M1$,@(40,S9),J[0]:M0$,@(63,S9),A[S0]:M0$
6240 IF A$(41,1)=" " AND A[0]+A[1]<>A[S0] THEN GOSUB 7550
7500 REM "If physical = computer, correct rounding
7520 PRINT @(63,S9),A[S0]:M0$,
7590 RETURN 
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 IF Y5=68 THEN RETRY ELSE ON C9 GOTO 1140,2040
9940 EXIT 
9999 END 
