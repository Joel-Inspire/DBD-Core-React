0010 REM "Ship-To Location Setup <FM2LAA>
0015 REM "Prog Type: I -3.0A
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 03/08/22 - 11.739755 - jvv - SSP# 307387
0036 REM "Ready for Mark for at 347,35
0037 REM "307387-EQLink DBD Bridge to Qnet                                   
0038 REM "203458 - SPR FOR TOPS (JV)
0040 REM "Copyright 2022 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0095 IF Q1$="" THEN Q1$=Q0$
0110 X0$="FM2LAA",X1$="Ship-To Location Setup",K9$="",K9=0
0120 DIM S$(20)
0130 K0=15,K1=2
0135 C9=-1
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(65,1)>"2" THEN PRECISION NUM(X3$(65,1),ERR=0246)
0250 K9$="C"
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0299 CALL "ZZ2PRP","OS",RESULT$,DATE$
0300 REM "IOLISTS
0310 IOLIST A$(1)
0320 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14],B[15]
0330 IOLIST C0$
0331 IOLIST C1$
0332 IOLIST C2$
0420 J0$="NOT YET FULLY IMPLEMENTED.  AVAILABLE IN FUTURE RELEASE"
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X FM0... 02O AR1...   03O FMP...  04O FMM...  05OSFM0...  06O AR5...  07O ASR...  08O FTD...  09O OSA...  10O ZY1...  13O ZZPARM  "
0520 GOSUB 9750; ON Z0 GOTO 0521,9900
0530 READ (Z[13],KEY=X3$(9,3)+"F/M")FM_PARAM$
0531 READ (Z[13],KEY=X3$(9,3)+"A/R")P0$; REM SSP 199160
0535 GOSUB SET_READONLY; HAS_EC=0; READ (Z[13],KEY=X3$(9,3)+"E/C",DOM=0536)EC$; HAS_EC=1
0536 QLL=FN%HAS_MODULE("QL") ! SSP 307387
0540 GOSUB CLEAR_READONLY
0580 CALL "ZZ2PRP","SM",SM_ACTIVE$,TMP$
0585 PROMPT_MOD$=""; IF SM_ACTIVE$="Y" THEN PROMPT_MOD$="FM2LAA"
0590 READ (Z[1],KEY=K9$,DOM=0591)
0595 FIND (Z[13],KEY="osec"+X3$(40,3),DOM=0596)OP_SEC$; REM "SSP# 138812 
0600 REM "
0680 GOSUB 6000
1000 REM "
1005 IF SCREEN$="2" THEN SCREEN$=""; GOSUB 6000
1010 Y8=1; CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1030 DIM B$(400),B[15],C$(60)
1032 DIM C0$(20),C1$(20),C2$(20)
1035 DIM A$(618); IF LEN(A1$)=11 THEN A1$=A1$(1,1); REM "SSP# 139226
1045 A$(1,LEN(A1$))=A1$; IF A1$="" THEN A$(1,LEN(K9$))=K9$
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 SETERR 9000; C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1200,1250,1500
1200 REM "
1202 IF Q1$>"" THEN A$(2,10)=Q1$(2); CALL "ZZDISP","A",A$(2,10),"A/R",X3$,"","",15,3,X4$; GOTO 1220
1203 REM IF D0$>"" THEN IF D0$(124,1)="0" THEN LET A1$=A1$(1,1)
1205 IF LEN(A1$)>1 THEN A$(2,10)=A1$(2,10); GOTO 1220
1210 CALL "ZZENTR","AXUX",A{ALL},A$,X4$,X3$,15,3,2,10,C0,"A/R","{1"+X$,"","FM2LAA00","AR1","AR2MAA",""; IF C0=6 THEN GOSUB 6400; C0=1
1212 IF INT(ABS(C0))=3 THEN C0=-ABS(C0); READ (Z[1],KEY=A$(1,11),DOM=1213)
1215 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1210,6800,9800,6970
1220 IF V9<>-2 THEN FIND (Z[2],KEY=A$(2,10),DOM=1210)IOL=0320
1225 PRINT @(30,3),B$(11,35),
1230 DIM D0$(244); FIND (Z[3],KEY="D"+A$(2,10),DOM=1231)D0$
1240 GOTO 1120
1257 Q$=A$(1,11)
1258 X$="F10 retrieves by Phone No."
1259 IF FM_PARAM$(279,1)="Y" THEN GOTO 4900; REM "Entry & lookup by Rec Dept
1260 CALL "ZZENTR","SUZX",A{ALL},A$,X4$,X3$,15,4,12,4,C0,"","{2"+X$,Q$,"FM2LAA02","FM0B","",""; IF C0=6 THEN GOSUB 6400; C0=1
1261 IF ABS(C0)=2 THEN IF Q1$>"" THEN GOTO 1260 ELSE IF LEN(A1$)>1 THEN A1$=A1$(1,1)
1262 IF C0=-7 THEN C0=1; ST$="ST"+Q$; CALL "ZZ2PLU",X3$,A$,1,ST$; IF ST$="" THEN A$(1,11)=Q$; GOTO 1258
1263 READ (Z[1],KEY=A$(1,15),DOM=1264)
1265 IF INT(ABS(C0))=3 THEN GOTO 6800 ELSE IF ABS(C0)=4 THEN GOTO 9900
1290 GOTO 1120
1500 REM "
1505 Z9=-1,Z8=0,C9=0,A2$="",A3$="",A4$="",A5$="",A7$="",A8$=""
1510 A1$=A$(1,15)
1520 READ (Z[1],ERR=7200,KEY=A1$,DOM=1600)IOL=0310
1525 Z9=0,V7$=""; GOSUB 5800
1530 A2$=A$(1,11)+A$(214,9)+A$(12,4),A3$=A$(223,1)
1535 A3$=A$(234,2)+A1$
1537 A4$=A$(1,11)+A$(382,20)+A$(12,4)
1540 A7$=A$(129,9)
1545 A8$=A$(200,10)+"C"+A$(2,14)
1590 GOTO 1700
1600 REM "
1610 IF A$(12,4)="    " THEN GOTO 1000
1615 IF X3$(185,1)="I" THEN CALL "ZZPROM","2A",X3$,0,"","","",0; GOTO 1630
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630
1625 IF FM_PARAM$(244,1)="Y" THEN IF SCREEN$<"2" THEN SCREEN$="2"; GOSUB 6000; GOSUB 6200; GOTO 1820
1630 IF Z8=1 THEN REMOVE (Z[1],KEY=A1$,DOM=1000); IF RT_PARM$<>"" THEN CUST$=A1$(2,10); CALL "RT2WOC",ERR=1000,X3$,X4$,CUST$,"FM0...","U",A1$ END_IF ; GOTO 1000 ELSE GOTO 1000
1655 Z8=1
1680 GOSUB 7450
1685 GOSUB 7900
1686 GOSUB 6200
1690 GOTO 2000
1700 REM "
1790 GOSUB 6200
1800 REM "
1805 IF D0$(24,1)="Y" THEN IF A$(223,1)=" " THEN CALL "ZZPROM",".4",X3$,0,"NOTE: This is an IMS customer, and no location usage method is set!","","",0 ! SSP#282099
1815 IF X3$(185,1)="I" THEN CALL "ZZPROM","4A",X3$,Z,"","","",0; GOTO 6790
1820 CALL "ZZPROM",STR(6+C9)+" "+PROMPT_MOD$,X3$,Z,"","","V",X0; ON Z GOTO 1850,6500,1625,6700,1821
1823 IF Z=6 THEN GOTO 8400
1825 GOTO 6700
1830 GOTO 2000
1850 REM "MODIFY
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE IF Z9=0 THEN Z9=1
1860 GOSUB 7400
1870 GOSUB 6200
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
2000 REM "DATA SEQ
2005 IF SCREEN$="2" THEN GOTO 4000
2010 C0=0,X0=-1,X1=1
2020 SETERR 9000; X$="",Q$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF INT(C0)=3 THEN GOSUB 7300 ELSE IF C0>3 OR X0<0 THEN GOTO 1800
2038 IF X0<LEN(V7$) THEN V7$(X0+1,1)=""
2040 ON X0 GOTO 2100,2550,2150,2200,2250,3400,2950,2450,3200,3100,2350,2400,3350,3550,3150,2500,2300,2600,3500,2650,3050,3250,2700,2750,2800,2850,2900,3000,3300,1800; REM "SSP# 139226
2105 X$="This field is displayed when you enter a ship-to code" ! SSP#253174
2110 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,40,4,16,35,C0,"","{3"+X$,"","FM2LAA04","","",""
2140 GOTO 2020
2152 DIM TAX$(10," "); REM SSP 199160   
2160 Q$=A$(51,163)+TAX$; CALL "ZY2AAA",X3$,X4$,0,7,"A","20Attn",2,Q$,"",0,C0,Q9; A$(51,163)=Q$(1,163); REM SSP 199160
2165 IF Q$(164,10)<>DIM(10) THEN A$(224,10)=Q$(164,10); REM SSP 199160, 251220
2166 CALL "ZZDISP","A   ",A$(224,10),"AR5",X3$,"","",21,17,X4$; REM SSP 199160
2170 IF ABS(C0)>4 THEN GOSUB 6400; GOTO 2160
2190 GOTO 2020
2202 REM IF D0$(24,1)<>"Y" THEN GOTO 02020
2205 X$="Some reports will print this field in addition to the ship-to code"
2210 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,21,12,214,9,C0,"","{3"+X$,"","FM2LAA08","","",""
2220 IF A$(214,9)=S$(1,9) THEN A$(214,9)=A$(12,4); PRINT @(21,12),A$(214,9),
2240 GOTO 2020
2255 IF D0$(24,1)<>"Y" THEN GOTO 2020
2258 IF POS(X3$(9,3)="428123")=0 AND X3$(30,1)="S" THEN X$="C-type locations NOT supported on SL Series" ELSE X$="If no location usage type is set, usage will not be updated for this location!" ! SSP#253174
2260 CALL "ZZENTR","SURU",A{ALL},A$,X4$,X3$,21,13,223,1,C0,"","{3"+X$,"CI ","FM2LAA10","","",""
2270 IF X3$(30,1)="S" AND A$(223,1)="C" AND POS(X3$(9,3)="428123")=0 THEN GOTO 2260
2280 IF D0$(24,1)<>"Y" THEN GOTO 2020
2290 GOTO 2020
2310 CALL "ZZENTR","AU",A{ALL},A$,X4$,X3$,21,17,224,10,C0,"AR5","{3"+X$,"","AR2MAB32","AR5","AR2MEA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2310,2311
2312 IF MID(D0$,244,1)="Y" AND A$(224,10)=DIM(10) THEN CALL "ZZPROM",".4",X3$,0,"You must enter a valid Sales Tax Code!","","",0; GOTO 2310; REM " SSP# 158548
2315 IF POS(" "<>A$(224,10))<>0 THEN READ (Z[6],KEY=A$(224,10),KNO=0,DOM=2310)X$; REM "IF HAS_EC THEN PRINT @(35,21),X$(11,25) ELSE PRINT @(25,21),X$(11,25); REM " SSP# 139226 - NOT ENOUGH ROOM TO DISPLAY STATE AND EMAIL TOO
2340 GOTO 2020
2355 GOTO 2020
2360 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,21,15,234,2,C0,"","{3"+X$,"","FM2LAA14","","",""
2362 IF D0$(24,1)<>"Y" THEN GOTO 2020
2390 GOTO 2020
2402 IF D0$(24,1)<>"Y" THEN GOTO 2020
2403 Q$="c"+A$(2,10)
2405 J0$=""; FIND (Z[3],KEY="c"+A$(2,10)+A$(236,9),DOM=2406)J1$; J1$=FNS$(J1$(21,30)),X$="Currently: "+J1$
2410 CALL "ZZENTR","AU",A{ALL},A$,X4$,X3$,54,13,236,9,C0,"FMA","{3"+X$,Q$,"FM2LAA16","AR2MAP","AR2MAP",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2410,2411
2415 IF A$(236,9)<>S$(1,9) THEN FIND (Z[3],KEY="c"+A$(2,10)+A$(236,9),DOM=2410)J1$
2440 GOTO 2020
2455 IF D0$(24,1)<>"Y" OR POS(A$(223,1)="CE")=0 THEN GOTO 2020
2460 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,21,15,245,1,C0,"","{3"+X$,"","FM2LAA18","","",""
2462 IF D0$(24,1)<>"Y" THEN GOTO 2020
2490 GOTO 2020
2502 IF D0$(24,1)<>"Y" THEN GOTO 2020
2505 IF D0$(24,1)<>"Y" OR A$(245,1)<>"Y" THEN GOTO 2020
2506 GOTO 2020
2510 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,63,14,246,2,C0,"","{3"+X$,"","FM2LAA20","","",""
2540 GOTO 2020
2555 X$="Formal name of ship-to. Leave blank for same as Description field"
2560 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,9,6,248,35,C0,"","{3"+X$,"","FM2LAA22","","",""
2590 GOTO 2020
2605 X$="Y=Exempt, N=Taxable, S=Varies by Invoice Line"
2610 CALL "ZZENTR","SUR",A{ALL},A$,X4$,X3$,27,18,283,1,C0,"","{3"+X$,"YNS","FM2LAA24","","",""
2640 GOTO 2020
2660 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,27,19,284,4,C0,"","{3"+X$,"D","FM2LAA26","FM0D","FM2LAA",""; IF C0=6 THEN GOSUB 6400; C0=1
2665 IF A$(284,4)<>"    " THEN FIND (Z[5],KEY="D"+S$(1,10)+A$(284,4),DOM=2650)
2690 GOTO 2020
2710 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,58,17,288,1,C0,"","{3"+X$,"F","FM2LAA28","FMPF","",""; IF C0=6 THEN GOSUB 6400; C0=1
2720 IF V9<>-2 THEN C0$(1)=""; IF A$(288,1)<>" " THEN FIND (Z[3],KEY="F"+A$(288,1),DOM=2710)IOL=0330
2725 PRINT @(61,17),C0$(3,15)
2740 GOTO 2020
2760 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,58,18,289,1,C0,"","{3"+X$,"H","FM2LAA30","FMPH","",""; IF C0=6 THEN GOSUB 6400; C0=1
2770 IF V9<>-2 THEN C1$(1)=""; IF A$(289,1)<>" " THEN FIND (Z[3],KEY="H"+A$(289,1),DOM=2760)IOL=0331
2775 PRINT @(61,18),C1$(3,15)
2790 GOTO 2020
2810 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,58,19,290,15,C0,"","{3"+X$,"","FM2LAA32","","",""
2840 GOTO 2020
2860 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,58,20,305,1,C0,"","{3"+X$,"S","FM2LAA34","FMPS","",""; IF C0=6 THEN GOSUB 6400; C0=1
2870 IF V9<>-2 THEN C2$(1)=""; IF A$(305,1)<>" " THEN FIND (Z[3],KEY="S"+A$(305,1),DOM=2860)IOL=0332
2875 IF A$(305,1)<>" " THEN PRINT @(61,20),C2$(3,15); IF A$(305,1)<>" " THEN A$(306,15)=C2$(3,15)
2890 GOTO 2020
2910 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,61,20,306,15,C0,"","{3"+X$,"","FM2LAA36","","",""
2940 GOTO 2020
2950 REM "CYCLES FOR COUNT
2951 GOTO 2020; REM IF A$(223,1)<>"E" THEN GOTO 02020
2952 Z4=-1
2954 Z4=Z4+1; IF Z4>12 THEN GOTO 2020
2960 CALL "ZZENTR","SRZ",A{ALL},A$,X4$,X3$,21+Z4*3,14,321+Z4*2,2,C0,"","{3"+X$,"  01020304050607080910111213","FM2LAA38","","",""
2961 IF A$(321+Z4*2,2)="  " THEN A$(321,24)=A$(321,Z4*2); FOR Z4=0 TO 12; PRINT @(21+Z4*3,14),A$(321+Z4*2,2),; NEXT Z4; GOTO 2020
2962 IF C0=4 THEN GOTO 2020
2965 IF C0=2 THEN IF Z4=0 THEN GOTO 2020 ELSE Z4=Z4-1; GOTO 2960
2970 GOTO 2954
2990 GOTO 2020
3000 REM "Mark for - temp. disabled
3005 GOTO 2020
3010 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,44,21,347,35,C0,"","{3"+X$,"","FM2LAA36","","",""
3040 GOTO 2020
3050 REM "Secure forms allowed
3060 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,27,20,347,20,C0,"","{3"+X$,"","FM2LAA38","","",""
3090 GOTO 2020
3100 REM "Location options
3105 X$="A=New entries not counted, B=Stock items not counted, R or W=Auto Replishment"
3110 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,54,12,367,8,C0,"","{3"+X$,"","FM2LAA18","","",""
3140 GOTO 2020
3150 REM "Receiving Department/Additional SORT field
3153 REM "IF FM_PARAM$(250,1)<>"Y" THEN GOTO 02020,REMed this out on 88648, people also use this field as alternate BERT sort
3155 X$="This field can also be used as alternate sort field for BERT."
3160 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,54,15,382,20,C0,"","{3"+X$,"","FM2LAA18","","",""
3190 GOTO 2020
3200 REM "Count entry ID--OCC for #449
3205 IF POS(X3$(9,3)="449500",3)<>0 THEN X$="File ID if OCC (A,B,C...) or blank if not OCC" ELSE X$="Count entry ID"
3210 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,33,15,375,1,C0,"","{3"+X$,"","FM2LAA20","","",""
3240 GOTO 2020
3250 REM "Don't show on Web EC
3255 IF HAS_EC THEN GOTO 3256 ELSE GOTO 3290
3260 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,27,21,235,1,C0,"","{3"+X$,"","FM2LAA21","","",""
3290 GOTO 2020
3300 REM "Email - SSP# 139226
3310 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,37,21,522,40,C0,"","{3"+X$,"","FM2LAA04","","",""; REM " SSP# 139226
3340 GOTO 2020; REM " SSP# 139226
3350 REM " UNITED INFO
3351 IF RESULT$<>"Y" THEN GOTO 3390
3355 X$="D=Drop Ship, W=Single Wrap/Label, M=Multi Wrap and/Label, F=Furn, S =Standard"
3360 CALL "ZZENTR","SRU",A{ALL},A$,X4$,X3$,54,14,376,1,C0,"","{3"+X$,"DWMFS ","FM2LAA21","","",""
3390 GOTO 2020
3400 IF RESULT$<>"Y" THEN GOTO 3490
3405 X$="W=Will Call, S=Ship Out"
3410 CALL "ZZENTR","SRU",A{ALL},A$,X4$,X3$,21,14,377,1,C0,"","{3"+X$,"SW ","FM2LAA21","","",""
3490 GOTO 2020
3500 ! Ignore WebEC maximums? WO176437
3503 IF HAS_EC THEN GOTO *NEXT ELSE GOTO 2020
3505 X$="Y=ignore all WebEC maximums for this shipto. Applies to WebEC only."
3510 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,42,18,601,1,C0,"","{3"+X$,"","FM2LAA52","","",""
3540 GOTO 2020
3545 ! 
3550 REM " UNITED ACCOUNT SSP 176595
3551 IF RESULT$<>"Y" THEN GOTO 3590
3560 CALL "ZZENTR","SZXUX",A{ALL},A$,X4$,X3$,72,14+V0,562+K9,6,C0,"","{1"+X$,K9$,"OS2PAA00","OSA00","OS2PAA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 3560,3561
3590 GOTO 2020
4000 REM "Second Screen Data
4010 C0=0,X0=-1,X1=1
4020 SETERR 9000; X$="",Q$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
4025 IF INT(C0)=3 THEN GOSUB 7300 ELSE IF C0>3 OR X0<0 THEN GOTO 1800
4038 IF X0<LEN(V7$) THEN V7$(X0+1,1)=""
4040 ON X0 GOTO 4100,4100,4100,4100,1800
4100 REM "4 lines of Address
4105 I=X0
4110 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,9,12+I,402+I*30,30,C0,"","{3"+X$,"","FM2LAA48","","",""
4140 GOTO 4020
4900 REM "Entry and lookup by Receiving Department, WO101301
4905 X$="Press Enter to skip -or- Enter Receiving Department (Lookup available)"
4910 DIM TEMP$(20); CALL "ZZENTR","SU",A{ALL},TEMP$,X4$,X3$,15,4,1,20,C0,"","{3"+X$,A$(1,11),"FM2LAA50","FTD","",""; IF ABS(C0)=4 THEN GOTO 9900 ELSE IF C0=6 THEN A$(12,4)=TEMP$; GOSUB 6400; C0=1; GOTO 1261
4915 IF POS(" "<>TEMP$)=0 THEN GOSUB 6400; X$="F10 retrieves by Phone No."; GOTO 1260
4920 CALL "FS2DAM",X3$,X4$,1,A$(1,11),"",TEMP$,TEMP1$
4925 IF POS(" "<>TEMP1$)=0 THEN GOTO 4910
4930 A$(12,4)=TEMP1$,C0=1; PRINT @(15,4),A$(12,4),; GOSUB 6400
4940 GOTO 1261
5800 REM "Alt sort keys
5810 FIND (Z[3],KEY="F"+A$(288,1),DOM=5811)IOL=0330
5815 FIND (Z[3],KEY="H"+A$(289,1),DOM=5816)IOL=0331
5820 FIND (Z[3],KEY="S"+A$(305,1),DOM=5821)IOL=0332
5825 DIM D0$(200); FIND (Z[3],KEY="D"+A$(2,10),DOM=5826)D0$
5830 IF POS(A$(235,1)=" NY")=0 THEN A$(235,1)=" "; REM "Clear old data out
5890 RETURN 
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6006)@(0,11),'CE','SB',
6060 PRINT @(0,3+V0),"Customer code:",@(1,4+V0),"Ship-to code:",@(27,4+V0),"Description:",@(0,5+V0),Z0$,
6070 PRINT @(3,6+V0),"Name:",@(0,11+V0),Z0$,
6075 CALL "ZY2AAA",X3$,X4$,0,7,"A","20Attn",0,Q$,"",0,C0,Q9
6076 IF SCREEN$="2" THEN GOTO 6150
6078 PRINT @(28,11+V0),"Items Management Section",
6080 PRINT @(11,12+V0),"Location:",@(41,13),"Cost center:",@(3,13+V0),"Items mgt method:",@(26,13+V0),"(I-C-blank)",@(4,15),"Use count stops?",@(26,15),"CE ID:",@(36,12),"Location options:",@(38,15),"Receiving Dept:",@(0,16+V0),Z0$,
6085 IF RESULT$="Y" THEN PRINT @(1,14),"Will Call/Ship Out:",@(32,14),"Wrap Label/Drop Ship: ",; REM " SSP148759
6090 PRINT @(5,17+V0),"Sales tax code:",@(37,17+V0),"Default F.O.B. code:",@(3,18+V0),"Is location tax exempt?",@(45,18+V0),"How to ship:",@(6,19+V0),"Default supply whse:",@(41,19+V0),"Inside delivery:",@(48,20+V0),"Ship via:",
6095 IF HAS_EC THEN PRINT @(30,18+V0),"Ignore max?",
6100 PRINT @(5,20),"Secure Items allowed:",
6110 IF HAS_EC THEN PRINT @(10,21),"Exclude from EC?", ! SSP#253486
6120 PRINT @(30,21),"Email:",; REM " SSP# 139226
6125 IF RESULT$="Y" THEN PRINT @(60,14),"Vendor Act:",; REM SSP 176595
6130 PRINT (0,ERR=6131)'SF',
6140 RETURN 
6150 REM "Background Screen #2
6160 PRINT @(0,11),'CE','SB',@(0,11),Z0$,@(1,11),"Additional Shipping Address"
6170 FOR I=1 TO 4; PRINT @(1,11+I),"Line "+STR(I)+":",; NEXT I
6190 GOTO 6130
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6220 PRINT @(40,4),A$(16,35),
6225 Q$=A$(51,163); CALL "ZY2AAA",X3$,X4$,0,7,"A","20Attn",1,Q$,"",0,C0,Q9; A$(51,163)=Q$
6230 IF SCREEN$="2" THEN GOTO 6300
6232 REM "FOR X=0 TO 12; PRINT @(21+X*3,14),A$(321+X*2,2),; NEXT X
6233 PRINT @(21,15),A$(245,1),@(33,15),A$(375,1),@(54,15),A$(382,20),
6234 CALL "ZZDISP","A   ",A$(224,10),"AR5",X3$,"","",21,17,X4$
6235 PRINT @(21,12),A$(214,9),@(54,12),A$(367,8),@(21,13),A$(223,1),
6236 CALL "ZZDISP","A",A$(236,9),"FMA",X3$,"","",54,13,X4$
6238 PRINT @(9,6),A$(248,35),@(27,18),A$(283,1),@(27,19),A$(284,4),@(58,17),A$(288,1),@(58,18),A$(289,1),@(58,19),A$(290,15),@(58,20),A$(305,1),@(61,20),A$(306,15),
6240 PRINT @(27,20),A$(347,20),
6241 IF HAS_EC THEN PRINT @(27,21),A$(235,1),
6250 PRINT @(37,21),A$(522,40); REM " SSP# 139226
6260 PRINT @(61,17),C0$(3,15)
6265 PRINT @(61,18),C1$(3,15)
6266 IF HAS_EC THEN PRINT @(42,18),A$(601,1),
6267 IF RESULT$<>"Y" THEN GOTO 6276
6270 PRINT @(21,14),A$(377,1),@(54,14),A$(376,1),@(72,14+V0),A$(562,6),; REM " SSP# 148759
6290 RETURN 
6300 REM "Display Data for Screen #2
6310 FOR I=0 TO 3; PRINT @(9,12+I),A$(402+I*30,30),; NEXT I
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6460 PRINT 
6464 CALL "ZZDISP","A   ",A$(2,10),"A/R",X3$,"","",15,3,X4$
6468 PRINT @(30,3),B$(11,35),@(15,4),A$(12,4),
6490 RETURN 
6500 REM "DELETE
6501 IF MID(OP_SEC$,76,1)="Y" THEN CALL "ZZPROM",".4",X3$,0,"Access Denied!  You may not delete a Customer Ship-to","","",0; GOTO 1800; REM "SSP# 138812 
6510 REMOVE (Z[1],KEY=A1$,DOM=6511)
6511 IF RT_PARM$<>"" THEN CUST$=A1$(2,10); CALL "RT2WOC",ERR=6512,X3$,X4$,CUST$,"FM0...","D",A1$
6520 REMOVE (Z[4],KEY=A2$,DOM=6521)
6525 REMOVE (Z[7],KEY=A8$,DOM=6526)
6527 REMOVE (Z[8],KEY=A4$,DOM=6528)
6530 CALL "ZZ2SKY",X3$,X4$,"FM0C","DALL",A$,A1$(2,14),"","","","","","","",""
6590 A1$=""; GOTO 1630
6600 REM "ALT KEY DATA READS
6605 FIND (Z[2],KEY=A$(2,10),DOM=6606)IOL=0320
6690 RETURN 
6700 REM "ADD ENTRY
6701 IF SCREEN$<"2" THEN IF POS(FM_PARAM$(279,1)="YF")<>0 THEN GOSUB 8500 ! SSP#239402
6702 IF FM_PARAM$(244,1)="Y" THEN IF SCREEN$<"2" THEN SCREEN$="2"; GOSUB 6000; GOSUB 6200; GOTO 1800
6705 IF Z9=0 THEN GOTO 6790 ELSE IF V7$>"" THEN X0=POS(" "<>V7$); IF X0>0 THEN X0=X0-1; GOTO 2038
6706 IF POS(FM_PARAM$(279,1)="YF")<>0 AND STP(A$(382,20),3," ")="" THEN A$(382,20)=A$(12,4); PRINT @(54,15),A$(382,20),
6707 ! IF POS(FM_PARAM$(279,1)="YF")<>0 THEN GOSUB 8500  !SSP#239402
6708 IF A$(214,9)=S$(1,9) THEN A$(214,9)=A$(12,4); PRINT @(21,12),A$(214,9),
6709 GOSUB 8300
6710 WRITE (Z[1],KEY=A1$)IOL=0310; IF RT_PARM$<>"" THEN CUST$=A1$(2,10); CALL "RT2WOC",ERR=6711,X3$,X4$,CUST$,"FM0...","U",A1$
6712 IF QLL THEN XET$="FM0",XSYS$="EQLINK",XKY$=MID(A1$,2,14),XVAL$=A$(382,20); CALL "UPDZYR;WRITE_XREF",ERR=*NEXT,XET$,XSYS$,XKY$,XVAL$,"Y" ! SSP 307387
6715 REMOVE (Z[4],KEY=A2$,DOM=6716)
6720 WRITE (Z[4],KEY=A$(1,11)+A$(214,9)+A$(12,4))
6725 REMOVE (Z[7],KEY=A8$,DOM=6726)
6727 WRITE (Z[7],KEY=A$(200,10)+"C"+A$(2,14))
6728 REMOVE (Z[8],KEY=A4$,DOM=6729)
6729 IF POS(FM_PARAM$(279,1)="YF")<>0 THEN WRITE (Z[8],KEY=A$(1,11)+A$(382,20)+A$(12,4))
6730 CALL "ZZ2SKY",X3$,X4$,"FM0C","A",A$,A1$(2,14),"","","","","",A7$,"",""
6790 IF Z=6 THEN RETURN END_IF ; C9=0; IF Z=7 OR K1=0 THEN GOTO 9900 ELSE IF Z<4 THEN GOTO 1000 ELSE C0=-(3.1+(Z-4)/10); GOTO 6800
6800 REM "NEXT ENTRY IN FILE
6805 ON 10*FPT(C0)+2 GOTO 6850,6806
6810 A1$=KEY(Z[1],END=6895)
6820 IF A1$="" THEN GOTO 6800 ELSE IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 6895
6825 A$(1,LEN(A1$))=A1$
6830 GOSUB 6600
6835 GOSUB 6450
6840 GOTO 1515
6850 REM "PRIOR ENTRY
6855 A1$=KEP(Z[1],ERR=6856); IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 6856 ELSE GOTO 6820
6856 CALL "ZZPROM","K0",X3$,S3,"","","",0; ON S3 GOTO 6857,9900
6860 PRINT 'RB',; CALL "ZZKEYL",ERR=6861,Z[1],A1$; GOTO 6820
6865 GOTO 1100
6870 GOTO 6895
6890 GOTO 1515
6895 CALL "ZZPROM","K1",X3$,S3,"","","",0; IF S3=1 THEN GOTO 9900 ELSE IF A1$="" THEN GOTO 6860 ELSE PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=6896)
6898 ON S9 GOTO 6810,1100
7200 REM "Forced read
7210 IF ERR<>0 THEN GOTO 9000
7220 CALL "ZZREAD",Z[1],A1$,A$,A{ALL},S8; ON S8 GOTO 7221,1630
7230 GOSUB 6200
7240 CALL "ZZPROM","E0",X3$,0,"","","",0; GOTO 7290
7250 CALL "ZZPROM","E0A",X3$,0,"","","",0; GOTO 7290
7290 GOTO 1630
7300 REM 
7310 ON FPT(C0)*10 GOTO 7390,7325,7330,7390
7325 IF V8$="" THEN X0=X0+4; GOTO 7390 ELSE X0=NUM(V8$(POS(STR(X0:"00")<=V8$,2),2)); GOTO 7390
7330 IF V8$="" THEN X0=X0-6; GOTO 7335 ELSE X0=POS(STR(X0-1:"00")<=V8$,2)-2; IF X0<0 THEN X0=0; GOTO 7390 ELSE X0=NUM(V8$(X0,2)); GOTO 7390
7335 IF X0<0 THEN X0=0; GOTO 7390
7390 IF X0>0 THEN X0=X0-0
7395 C0=3; RETURN 
7400 REM "EXTRACT
7410 EXTRACT (Z[1],ERR=7200,KEY=A1$,DOM=7440)IOL=0310
7420 C9=1,Z9=1; GOSUB 5800
7440 RETURN 
7450 REM "EXTRACT NEW ENTRY
7460 WRITE (Z[1],KEY=A1$,DOM=7250)IOL=0310; GOTO 7400
7490 RETURN 
7500 REM "CUSTOM PROGRAMMING ROUTINES
7510 REM "Vendor for "D" of 8000-8999
7520 PRINT (0,ERR=7521)'SB',
7530 PRINT @(2,4+V0),"Vendor Code:",@(3,5+V0),"Plant Code:",
7535 PRINT (0,ERR=7521)'SF',
7540 CALL "ZZDISP","A",A$(224+K9,10),"A/P",X3$,"","",17,4+V0,X4$
7550 PRINT @(17,5+V0),A$(234,4),
7590 RETURN 
7600 REM "Plant Code
7610 J1$="P"+A$(224,10)
7620 CALL "ZZENTR","SZUX",A{ALL},A$,X4$,X3$,17,5+V0,234+K9,4,C0,"","{2"+X$,J1$,"FM2SKA21",T3$,"",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 7610,7611
7650 DIM A3$(238); READ (Z[1],KEY="P"+A$(224,14),DOM=7651)A3$
7655 A$(16,188)=A3$(16,188)
7690 RETURN 
7700 REM "Set enter & disp params
7710 ON POS(A$(1+K9,1)="CDP") GOTO 7740,7720,7725,7730
7720 T3$="FM0C",T0=3,T0$="A/R",T1$="AR1",T2$="AR2MAB"; GOTO 7740
7725 T3$="FM0D"; PRINT @(17,5+V0),S0$(1,12),@(38,5+V0),'CL',; GOTO 7740
7730 T3$="FM0P",T0=2,T0$="A/P",T1$="AP4",T2$="AP2MAB"; GOTO 7740
7740 RETURN 
7800 REM "Top display
7801 PRINT 'SB',
7802 IF A$(1+K9,1)="D" THEN IF NUM(A$(12+K9,4))>=8000 AND NUM(A$(12+K9,4))<9000 THEN PRINT @(0,7+V0),S0$(1,14),@(32,7+V0),S0$(1,5); GOTO 7805
7803 PRINT @(0,4+V0),S0$,@(0,5+V0),S0$(1,14),@(32,5+V0),S0$(1,5),@(0,7+V0),S0$(1,14),@(32,7+V0),S0$(1,5),
7805 PRINT (0,ERR=7806)'SB',
7810 IF A$(1+K9,1)="C" THEN PRINT @(0,5+V0),"Customer Code:",@(0,7),"Location Code:",@(32,5+V0),"Name:",@(17,15),"Sales Tax Code:",; GOSUB 8100 ELSE PRINT @(0,15),'CL',
7840 PRINT (0,ERR=7841)'SF',
7850 RETURN 
7900 REM "LOCATION DEFAULTS
7910 DIM D0$(200); DIM D0$(200); FIND (Z[3],KEY="D"+A1$(2,10),DOM=7911)D0$
7915 IF D0$(46,2)<>"  " THEN A$(223,1)="I"
7918 IF A$(223,1)=" " THEN A$(223,1)="I"
7919 IF D0$(24,1)<>"Y" THEN A$(223,1)=""
7920 A$(51,163)=B$(56,163)
7922 A$(16,35)=B$(11,35)
7925 A$(283,1)=B$(245,1),A$(224,10)=B$(235,10)
7930 A$(288,18)=D0$(28,18)
7935 CALL "ZZDISP","A   ",A$(224,10),"AR5",X3$,"","",21,17,X4$; REM SSP 199160  
7936 ! IF MID(P0$,134,1)="Y" THEN GOTO 7940 ! 251220
7937 READ (Z[10],KEY=A$(129,9),DOM=7940)ZIP$
7938 IF ZIP$(71,10)<>DIM(10) THEN A$(224,10)=ZIP$(71,10)
7940 GOSUB 6200
7950 RETURN 
8000 REM 
8010 CALL "ZZDISP","A",A$(224,10),"AR5",X3$,"","",39,15,X4$
8015 IF D$>"" THEN PRINT @(53,15),D$(11,25),
8040 RETURN 
8100 REM "C TYPE SCREEN
8102 PRINT 'SB',
8105 PRINT @(8,16),"Items management method:",
8110 REM IF A$(223+K9,1)=" " THEN GOTO 08130
8120 PRINT @(8,16),"Items management method:",@(20,17),"Count Cycle:",@(11,18),"Multiple count stops?",
8125 PRINT @(45,18),"Positions for count stops:"
8130 PRINT 'SB',@(20,19),"Cost center:",
8135 PRINT 'SF',
8145 RETURN 
8200 REM "
8210 PRINT @(39,16+V0),A$(223+K9,1),
8220 IF A$(223+K9,1)<>" " THEN PRINT @(39,17),A$(234+K9,2),@(39,18),A$(245,1),@(72,18),A$(246,2),
8230 CALL "ZZDISP","A",A$(236,9),"FMC",X3$,"","",39,19,X4$
8240 IF G$>"" THEN PRINT @(49,19),G$(21,30),
8290 RETURN 
8300 REM "Check for duplicate!
8310 Q$=A$(1,11)+A$(214,9)+A$(12,4)
8315 READ (Z[4],KEY=Q$(1,20),DOM=8316)
8320 K$=KEY(Z[4],END=8380); IF K$(1,20)<>Q$(1,20) THEN GOTO 8380 ELSE IF K$(21,4)=Q$(21,4) THEN GOTO 8380
8325 IF POS(X3$(9,3)="135020566",3)<>0 THEN GOTO 8380 ! SSP#213756!SSP#278651
8330 CALL "ZZPROM",".4",X3$,0,"This 'Location' already exists for this customer!","","",0
8340 X0=3; EXITTO 2040
8390 RETURN 
8400 REM "Call out to Shipper Id program
8403 GOSUB 6710
8405 TMP$=A$(2,14)
8410 CALL "SH2MCA",ERR=*NEXT,X3$,X4$,"",TMP$ ! SSP239749 jdf
8415 PRINT @(0,3),'CE',; GOSUB 6000; GOSUB 6200; GOTO 1800
8445 RETURN 
8500 REM "Check for duplicate receiving department if parm set for unique
8510 Q$=A$(1,11)+A$(382,20)+A$(12,4)
8515 READ (Z[8],KEY=Q$(1,31),DOM=8516)
8520 K$=KEY(Z[8],END=8580); IF K$(1,31)<>Q$(1,31) THEN GOTO 8580 ELSE IF K$(32,4)=Q$(32,4) THEN GOTO 8580
8530 CALL "ZZPROM",".4",X3$,0,"This 'Receiving Department' already exists for this customer!","","",0
8540 X0=14; EXITTO 2040 ! ssp#239402
8590 RETURN 
8600 SET_READONLY:
8610 SET_PARAM 'XI'
8640 SET_READONLY_END:RETURN 
8645 ! 
8650 CLEAR_READONLY:
8660 SET_PARAM -'XI'
8690 CLEAR_READONLY_END:RETURN 
8695 ! 
8905 DEF FNP$(Z9$)="("+Z9$(1,3)+") "+Z9$(4,3)+"-"+Z9$(7,4)+" Ext: "+Z9$(11,4)
8910 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
8915 DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
8920 DEF FNB$(Z9$)=X3$(214-6*NUM(Z9$),1)
8925 DEF FNS$(Z9$)=Z9$(1,POS(S$=Z9$+S$)-1)
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9120 ON Y8 GOTO 9900,0990,9920
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9905 Y8=2
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 SETERR 9940; Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
56000 REM "191375-Modify United shipping type to be S instead of      
56001 REM "213756-Need to import new location records for a customer.         
56010 REM "199160-Add sales tax codes to ZY2MBA Zip Code Table     
56011 REM "239402-When the Receiving Department has to be Unique due to OPS   
56012 REM "239749-PE(012 FM20DH-2055)                                         
56014 REM "251220-ZY1 zip code lookups no longer retrieving the sales tax code
56015 REM "282099-Program: FMGLAA Change FMS to IMS on message "This is an    
56016 REM "307387-EQLink DBD Bridge to Qnet                                   
