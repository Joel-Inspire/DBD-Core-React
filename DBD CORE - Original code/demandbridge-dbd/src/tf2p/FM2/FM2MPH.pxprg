0010 REM "Freight Markup Table Setup <FM2MPH>
0015 REM "Prog Type: IP-3.0A
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 06/06/17 - 15.689444 - dmm - SSP# 291546
0037 REM "291546-Freight Markup; ability to toggle percentage vs. flat in    
0040 REM "Copyright 2017 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0044 ! ********************************************************************    
0045 ! THIS PROGRAM WILL NO LONGER BE MODIFIED. THE GUI PANEL WILL BE PROCESSED FROM HERE. ALL FUTURE CHANGES NEED TO BE MADE IN FMGMPH PANEL AND PROGRAM. (RE WO 291546)
0046 ! ********************************************************************
0050 IF TCB(88)=0 THEN MSGBOX "You must be using Windx to access this program" ELSE PROCESS "FMGMPH","../OPG/OP.EN" ! WO291546
0055 IF TCB(13)=1 THEN RUN "ZMENU" ELSE EXIT ! WO291546
0060 EXIT ! WO291546
0070 REM "Bucket 11 is minimum 7/8 & 9/10 open for two more table values
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000; SETESC 9300
0110 X0$="FM2MPH",X1$="Freight Markup Table Setup"
0120 DIM Z0$(80,"-")
0130 K0=3,K1=1
0135 C9=-1
0138 LN=1 ! SSP 225881
0140 M0$="###,###,###.00",M1$="###.00-",M2$="###,###.00-"
0150 V1=2
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(65,1)>"2" THEN PRECISION NUM(X3$(65,1),ERR=0246)
0290 K9$="M",K9=LEN(K9$)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1),A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11]
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0509 REM + [201805]-Modified line 510 to open XPM
0510 Z$="01X FMP...  02O AR4... 03O FFA...  04O XPM...  13O ZZPARM  "
0520 GOSUB 9750; ON Z0 GOTO 0521,9900
0590 READ (Z[1],KEY=K9$,DOM=0591)
0600 REM "
0680 GOSUB 6000
1000 REM "
1010 Y8=1; CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1030 DIM AR4$(100)
1035 DIM A$(48),A[11]
1045 A$(1,LEN(A1$))=A1$; IF A1$="" THEN A$(1,LEN(K9$))=K9$
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 SETERR 9000; C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1200,1500
1200 REM "
1205 X$="Set up code 'ZZ' to have Freight Table apply to ALL customers w/o Freight Table"
1207 CALL "UPDFFA;CLEAR_FIELDS",FFA$,FFA{ALL}
1210 CALL "ZZENTR","SZXUX",A{ALL},A$,X4$,X3$,28,3,2,2,C0,"","{1"+X$,K9$,"FM2MPH00","FMPM","",""; IF C0=6 THEN GOSUB 6400; C0=1
1212 IF INT(ABS(C0))=3 THEN C0=-ABS(C0); READ (Z[1],KEY=A$(1,3),DOM=1213); CALL "UPDFFA;READBYKEY",Z[3],0,A$(2,2),SEG2$,SEG3$,SEG4$,SEG5$,FFA$,FFA{ALL},FOUNDFFA
1215 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1210,6800,9800,6970
1240 GOTO 1120
1500 REM "
1505 Z9=-1,C9=0,A2$="",A3$="",A4$="",A5$=""
1510 A1$=A$(1,3)
1520 READ (Z[1],ERR=7200,KEY=A1$,DOM=1600)IOL=0310; CALL "UPDFFA;READBYKEY",Z[3],0,A1$(2,2),SEG2$,SEG3$,SEG4$,SEG5$,FFA$,FFA{ALL},FOUNDFFA
1525 Z9=0,V7$=""; GOSUB 5800
1590 GOTO 1700
1600 REM "
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630
1630 GOTO 1000
1680 GOSUB 7450
1690 GOTO 2000
1700 REM "
1790 GOSUB 6200
1800 REM "
1805 IF C9=0 THEN GOSUB 7500; REM "If no modify done yet, then verify product code is set now, else wait until writing out.
1820 CALL "ZZPROM",STR(6+C9),X3$,Z,"","","V",X0; ON Z GOTO 1850,6500,1630,6700,1821
1825 GOTO 6700
1830 GOTO 2000
1850 REM "MODIFY
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE IF Z9=0 THEN Z9=1
1860 GOSUB 7400
1870 GOSUB 6200
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1
2020 SETERR 9000; X$="",Q$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF INT(C0)=3 THEN GOSUB 7300 ELSE IF C0>3 OR X0<0 THEN GOTO 1800
2038 IF X0<LEN(V7$) THEN V7$(X0+1,1)=""
2040 X9=FNZ(X0-1); ON X0 GOTO 2100,2200,2450,3400,2150,2750,2500,2550,2600,2650,2700,2800,2400,2250,2250,2250,3000,3050,3100,3150,3200,3250,3300,3350,1800 ! ssp 225881
2110 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,28,4,4,30,C0,"","{3"+X$,"","FM2MPH02","","",""
2140 GOTO 2020
2155 X$="Y=No prompt, N=User prompted, C=Prompt >Ceiling, M=No Prompt >Markup Ceiling" ! SSP217965    
2160 CALL "ZZENTR","SUR",A{ALL},A$,X4$,X3$,46,8+LN,34,1,C0,"","{3"+X$,"YNCM","FM2MPH04","","","" ! SSP 217965
2190 GOTO 2020
2200 REM "Freight Markup
2205 X$="Table frt below, if applicable, computed first then this % applied"
2210 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,46,6,0,320,C0,M1$,"{3"+X$,"","FM2MPH05","","","" ! SSP 217965
2240 GOTO 2020
2250 REM TABLE
2255 IF A$(35,1)=" " THEN GOTO 2020 ELSE X$="Enter net invoice amount"; REM "133159
2257 X9=FNZ(X0-3) ! SSP#234561
2260 CALL "ZZENTR","NX",A{ALL},A$,X4$,X3$,0,INT(16+X9/2)+V1,X9,922,C0,M0$,"{3"+X$,"","IC2MFA10","","","" ! SSP#234561
2270 IF ABS(C0)=2 AND FNZ(X0)>0 THEN X0=X0-1,X9=FNZ(X0); GOTO 2300 ELSE IF ABS(C0)=4 THEN GOTO 1800
2272 IF ABS(C0)=3.1 THEN C0=1; GOTO 2020 ELSE IF ABS(C0)=3.2 THEN C0=2; GOTO 2020
2275 IF X0>0 AND A[X9]=0 THEN FOR X=X9 TO 7; A[X]=0; NEXT X; GOSUB 6224; C0=4; GOTO 2020
2302 IF X9<0 THEN X0=X0+1; GOTO 2020
2305 IF A[X9]=0 THEN C0=4; GOTO 2020
2307 IF A$(35,1)="F" THEN X$="Enter % to mark up freight" ELSE X$="Enter % of sale to charge for freight"
2310 CALL "ZZENTR","N&",A{ALL},A$,X4$,X3$,22,INT(16+X9/2)+V1,X9+1,320,C0,M1$,"{3"+X$,"","IC2MFA12","","","" ! SSP#234561
2320 IF C0=2 THEN X0=X0+1 ELSE IF C0=3.1 THEN X0=X0+1,X9=FNZ(X0); C0=1; GOTO 2300 ELSE IF C0=3.2 THEN X0=X0-1,X9=FNZ(X0); C0=1; GOTO 2300
2340 GOTO 2020
2400 REM "Table sales or freight
2405 X$="S=Net sale, F=freight, leave blank if n/a"
2410 CALL "ZZENTR","SRU",A{ALL},A$,X4$,X3$,63,15+LN,35,1,C0,"","{3"+X$,"SF ","FM2MPH14","","",""
2420 IF A$(35,1)<>" " THEN DIM FFA[12]
2425 IF A$(35,1)=" " THEN FOR XX=1 TO 6; A[XX]=0; NEXT XX ! SSP#215335
2440 GOTO 2020
2450 REM "Minimum $ charge
2460 CALL "ZZENTR","NX",A{ALL},A$,X4$,X3$,46,7,11,320,C0,M1$,"{3"+X$,"","FM2MPH16","","",""
2490 GOTO 2020
2500 REM "Create order History
2510 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,46,9+LN,36,1,C0,"","{3"+X$,"","FM2MPH18","","",""
2540 GOTO 2020
2550 REM "Apply commission to markup
2560 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,46,10+LN,37,1,C0,"","{3"+X$,"","FM2MPH20","","",""
2590 GOTO 2020
2600 REM "Commission code
2605 IF A$(37,1)<>"Y" THEN GOTO 2640 ELSE X$="Optional commission code to override commission code on invoice"
2610 CALL "ZZENTR","SZU",A{ALL},A$,X4$,X3$,46,11+LN,38,5,C0,"","{3"+X$,"","FM2MPH22","AR4","AR2MDA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2610,2611
2615 IF STP(A$(38,5),3," ")="" THEN PRINT @(58,11+LN),'CL'; DIM AR4$(LEN(AR4$)); GOTO 2640 ELSE FIND (Z[2],KEY=A$(38,5),DOM=2610)AR4$; PRINT @(58,11+LN),AR4$(6,20),
2640 GOTO 2020
2650 REM "Product Code
2655 IF A$(37,1)<>"Y" THEN GOTO 2690 ELSE X$="Product code to use on invoice line for freight"
2660 CALL "ZZENTR","SZU",A{ALL},A$,X4$,X3$,46,12+LN,43,3,C0,"","{3"+X$,"T","FM2MPH24","FMPP","FM2SAA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2660,2661
2665 FIND (Z[1],KEY="T"+A$(43,3),DOM=2660)PROD$
2670 PRINT @(58,12+LN),PROD$(5,15+LN),
2690 GOTO 2020
2700 REM "Make invoice line cost only?
2705 IF A$(37,1)<>"Y" THEN GOTO 2740 ELSE X$="Y means line will not affect sale price and will not print"
2710 CALL "ZZENTR","YU",A{ALL},A$,X4$,X3$,46,13+LN,46,1,C0,"","{3"+X$,"","FM2MPH26","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2710,2711
2740 GOTO 2020
2750 REM " enter dollar amount for Ceiling
2752 IF POS(A$(34,1)="CM")=0 THEN A[10]=0; GOTO 2020 ! SSP 217965
2755 X$="Enter Maximum amount to use automatic Markup"
2760 CALL "ZZENTR","NX",A{ALL},A$,X4$,X3$,59,8+LN,10,922,C0,M2$,"{3"+X$,"","FM2MPH16","","",""
2790 GOTO 2020
2800 REM "Ship Via code table ssp# 167953
2810 CALL "ZZENTR","SZU",A{ALL},A$,X4$,X3$,46,14+LN,47,2,C0,"","{3"+X$,"S","FM2MPH24","FMPP","FM2SAA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2810,2811
2815 DIM SHIP_VIA$(100); FIND (Z[1],KEY="eV"+A$(47,2),DOM=2840)SHIP_VIA$
2820 PRINT @(58,14+LN),SHIP_VIA$(5,15),
2840 GOTO 2020
3000 REM upto frt1
3005 IF A$(35,1)<>" " THEN GOTO 2020
3010 CALL "ZZENTR","NX",FFA{ALL},FFA$,X4$,X3$,44,17+LN,0,922,C0,M0$,"{3"+X$,"","IC2MFA10","","",""
3040 GOTO 2020
3050 REM frt1 %
3055 IF A$(35,1)<>" " THEN GOTO 2020
3060 CALL "ZZENTR","N&",FFA{ALL},FFA$,X4$,X3$,62,17+LN,1,320,C0,M1$,"{3"+X$,"","IC2MFA12","","",""
3080 GOTO 2020
3100 REM upto frt 2
3105 IF A$(35,1)<>" " THEN GOTO 2020
3110 CALL "ZZENTR","NX",FFA{ALL},FFA$,X4$,X3$,44,18+LN,2,922,C0,M0$,"{3"+X$,"","IC2MFA10","","",""
3140 GOTO 2020
3150 REM frt2 %
3155 IF A$(35,1)<>" " THEN GOTO 2020
3160 CALL "ZZENTR","N&",FFA{ALL},FFA$,X4$,X3$,62,18+LN,3,320,C0,M1$,"{3"+X$,"","IC2MFA12","","",""
3180 GOTO 2020
3200 REM upto frt 3
3205 IF A$(35,1)<>" " THEN GOTO 2020
3210 CALL "ZZENTR","NX",FFA{ALL},FFA$,X4$,X3$,44,19+LN,4,922,C0,M0$,"{3"+X$,"","IC2MFA10","","",""
3240 GOTO 2020
3250 REM frt3 %
3255 IF A$(35,1)<>" " THEN GOTO 2020
3260 CALL "ZZENTR","N&",FFA{ALL},FFA$,X4$,X3$,62,19+LN,5,320,C0,M1$,"{3"+X$,"","IC2MFA12","","",""
3280 GOTO 2020
3300 REM upto frt 4
3305 IF A$(35,1)<>" " THEN GOTO 2020
3310 CALL "ZZENTR","NX",FFA{ALL},FFA$,X4$,X3$,44,20+LN,6,922,C0,M0$,"{3"+X$,"","IC2MFA10","","",""
3340 GOTO 2020
3350 REM frt4 %
3355 IF A$(35,1)<>" " THEN GOTO 2020
3360 CALL "ZZENTR","N&",FFA{ALL},FFA$,X4$,X3$,62,20+LN,7,320,C0,M1$,"{3"+X$,"","IC2MFA12","","",""
3380 GOTO 2020
3400 REM "Flat amount to add to Markup; !ssp 225881
3410 CALL "ZZENTR","NX",A{ALL},A$,X4$,X3$,46,8,9,320,C0,M1$,"{3"+X$,"","FM2MPH16","","",""
3420 GOTO 2020
5800 REM "Alt sort keys
5810 DIM AR4$(100); FIND (Z[2],KEY=A$(38,5),DOM=5811)AR4$
5815 DIM PROD$(46); FIND (Z[1],KEY=A$(43,3),DOM=5816)PROD$
5890 RETURN 
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6060 PRINT @(15,3+V0),"Table code:",@(15,4+V0),"Description:",@(0,5+V0),Z0$,
6070 PRINT @(15,6+V0),"% to markup freight charges:",@(10,7),"Minimum amount to markup freight:",@(14,8),"Flat Amount to add to Markup:",@(14,8+LN+V0),"Automatically markup freight?",@(50,8+LN+V0),"Ceiling: ", ! ssp 225881
6072 PRINT @(3,9+LN),"Create order history for freight charge?",@(8,10+LN),"Apply commission to freight markup?",@(6,11+LN),"Commission code or blank for default:",@(13,12+LN),"Product code for invoice line:",@(15,13+LN),"Make invoice line cost only?",
6074 PRINT @(21,14+LN),"Code Set for Ship Via:",; REM " SSP# 167953
6075 PRINT @(3,15+LN),"Use Left Markup table to markup based upon Freight Amount?",
6080 PRINT @(4,16+LN),"Net Sale up to",@(24),"%",@(41),"Freight Amt up to",@(64),"%"
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6220 PRINT @(28,4),A$(4,30),@(46,6),A[0]:M1$,@(46,7),A[11]:M1$,@(46,8),A[9]:M1$,@(46,8+LN),A$(34,1),@(63,15+LN),A$(35,1),; IF POS(MID(A$,34,1)="CM")<>0 THEN PRINT @(59,8+LN),A[10]:M2$, ! SSP 217965 SSP 225881
6222 PRINT @(46,9+LN),A$(36,1),@(46,10+LN),A$(37,1),@(46,11+LN),A$(38,5),@(58,11+LN),AR4$(6,20+LN),@(46,12+LN),A$(43,3),@(58,12+LN),PROD$(5,15+LN),@(46,13+LN),A$(46,1),
6224 FOR X=0 TO 2; IF A[X*2+1]<>0 THEN PRINT @(0,V1+16+X),A[1+X*2]:M0$,@(22,V1+16+X),A[1+X*2+1]:M1$ ELSE PRINT @(0,V1+16+X),DIM(39) ! SSP#234561
6228 NEXT X
6229 PRINT @(46,14+LN),A$(47,2),; REM " SSP 167953
6230 FIND (Z[1],KEY="eV"+A$(47,2),DOM=6232)SHIP_VIA$
6231 PRINT @(58,14+LN),SHIP_VIA$(5,15),
6255 IF A$(35,1)=" " THEN PRINT @(44,17+LN),FFA[0]:M0$,@(62),FFA[1]:M1$,@(44,18+LN),FFA[2]:M0$,@(62),FFA[3]:M1$,@(44,19+LN),FFA[4]:M0$,@(62),FFA[5]:M1$,@(44,20+LN),FFA[6]:M0$,@(62),FFA[7]:M1$
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6460 PRINT @(28,3),A$(2,2),
6490 RETURN 
6500 REM "DELETE
6508 REM + [201805]-Modified the DOM value from 6511 to 6521 at line 6510
6509 REM + [201805]-Added line 6520 to update XPM
6510 REMOVE (Z[1],KEY=A1$,DOM=6521)
6520 CALL "UPDFMP;DUPLICATE_XPM",Z[4],A$,A{ALL},"D"
6590 GOTO 1630
6600 REM "ALT KEY DATA READS
6690 RETURN 
6700 REM "ADD ENTRY
6703 GOSUB 7500
6705 IF Z9=0 THEN GOTO 6790 ELSE IF V7$>"" THEN X0=POS(" "<>V7$); IF X0>0 THEN X0=X0-1; GOTO 2038
6708 REM + [201805]-Move the compound stmts from 6710 to 6720-6725
6709 REM + [201805]-Added line 6715 to update XPM
6710 WRITE (Z[1],KEY=A1$)IOL=0310
6715 CALL "UPDFMP;DUPLICATE_XPM",Z[4],A$,A{ALL},"U"
6720 FFA$(1,2)=A1$(2,2); CALL "UPDFFA;UPDATE",Z[3],FFA$,FFA{ALL},BUSYFFA
6725 CALL "UPDFFA;UPDATE",Z[3],FFA$,FFA{ALL},BUSYFFA
6790 C9=0; IF Z=6 OR K1=0 THEN GOTO 9900 ELSE IF Z<4 THEN GOTO 1000 ELSE C0=-(3.1+(Z-4)/10); GOTO 6800
6800 REM "NEXT ENTRY IN FILE
6805 ON 10*FPT(C0)+2 GOTO 6850,6806
6810 A1$=KEY(Z[1],END=6895)
6820 IF A1$="" THEN GOTO 6800 ELSE IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 6895
6825 A$(1,LEN(A1$))=A1$
6830 GOSUB 6600
6835 GOSUB 6450
6840 GOTO 1515
6850 REM "PRIOR ENTRY
6855 CALL "ZZKEYP",ERR=6856,Z[1],A1$; GOTO 6820
6860 PRINT 'RB',; CALL "ZZKEYL",ERR=6861,Z[1],A1$; GOTO 6820
6865 GOTO 1100
6870 GOTO 6895
6890 GOTO 1515
6895 IF A1$="" THEN GOTO 6860 ELSE PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=6896)
6898 ON S9 GOTO 6810,1100
7200 REM "Forced read
7210 IF ERR<>0 THEN GOTO 9000
7220 CALL "ZZREAD",Z[1],A1$,A$,A{ALL},S8; ON S8 GOTO 7221,1630
7230 GOSUB 6200
7240 CALL "ZZPROM","E0",X3$,0,"","","",0; GOTO 7290
7250 CALL "ZZPROM","E0A",X3$,0,"","","",0; GOTO 7290
7290 GOTO 1630
7300 REM 
7310 ON FPT(C0)*10 GOTO 7390,7325,7330,7390
7325 IF V8$="" THEN X0=X0+4; GOTO 7390 ELSE X0=NUM(V8$(POS(STR(X0:"00")<=V8$,2),2)); GOTO 7390
7330 IF V8$="" THEN X0=X0-6; GOTO 7335 ELSE X0=POS(STR(X0-1:"00")<=V8$,2)-2; IF X0<0 THEN X0=0; GOTO 7390 ELSE X0=NUM(V8$(X0,2)); GOTO 7390
7335 IF X0<0 THEN X0=0; GOTO 7390
7390 IF X0>0 THEN X0=X0-0
7395 C0=3; RETURN 
7400 REM "EXTRACT
7410 EXTRACT (Z[1],ERR=7200,KEY=A1$,DOM=7440)IOL=0310; CALL "UPDFFA;READBYKEY",Z[3],0,A1$(2,2),SEG2$,SEG3$,SEG4$,SEG5$,FFA$,FFA{ALL},FOUNDFFA
7420 C9=1,Z9=1; GOSUB 5800
7440 RETURN 
7450 REM "EXTRACT NEW ENTRY
7458 REM + [201805]-Moved the compound stmts from 7460 to 7465-7480
7459 REM + [201805]-Added line 7465 to update XPM
7460 WRITE (Z[1],KEY=A1$,DOM=7250)IOL=0310
7465 CALL "UPDFMP;DUPLICATE_XPM",Z[4],A$,A{ALL},"U"
7470 FFA$(1,2)=A1$(2,2)
7475 CALL "UPDFFA;UPDATE",Z[3],FFA$,FFA{ALL},BUSYFFA
7480 GOTO 7400
7490 RETURN 
7500 REM "Check product code if commissioning freight
7505 IF A$(37,1)="Y" AND STP(A$(43,3),3," ")="" THEN CALL "ZZPROM",".4",X3$,Z,"If commissioning Freight Markup, then a product code MUST be provided.","","",0 ELSE GOTO 7545
7510 C0=0,X1=1,X$="",Q$=""
7515 Z9=1,C9=1,X0=7; EXITTO 2040
7545 RETURN 
8905 DEF FNP$(Z9$)="("+Z9$(1,3)+") "+Z9$(4,3)+"-"+Z9$(7,4)+" Ext: "+Z9$(11,4)
8910 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
8915 DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
8920 DEF FNB$(Z9$)=X3$(214-6*NUM(Z9$),1)
8960 DEF FNZ(X)=(X-10)*2+1; REM "133159 
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9120 ON Y8 GOTO 9900,0990,9920
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9905 Y8=2
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 SETERR 9940; Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
56000 REM "192240-looking for the ability to markup freight based on the orig 
56001 REM "201805-Modify FM2MPH to also call UPDFMP to update XPM after       
56002 REM "215335-Freight Markup Table Entry (FM2MPH) does not save the       
56004 REM "217965-Modify Freight Markup table with option to enter ceiling amt
56006 REM "225881-Modify the Freight Market Table to have an option to mark   
56008 REM "291546-Freight Markup; ability to toggle percentage vs. flat in    
