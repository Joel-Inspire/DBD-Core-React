0010 REM "Order Entry Special Shipping Receiving <FM2ODD>
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 10/25/13 - 15.994722 - tma - SSP# 265590
0037 REM "265590-Display issue in Special shipping during PO recvg and AR    
0040 REM "Copyright 2013 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0042 REM "KMc - 12/15/87
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="FM2ODD",X1$="Order Special Shipping",K9$="",K9=0
0120 DIM Z0$(80,"-"),C0$(12),S9$(40)
0130 K0=6,K1=1
0135 C9=-1
0140 M0$="##,###,###.00-",M1$="##,##0"
0145 GOSUB 8950
0175 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
0180 DEF FNN(Z9)=Z9/M
0185 DEF FNR$(Z9$)=Z9$(POS(" "<>Z9$))
0200 REM "
0230 IF Q1$<>"" THEN X2=-1; IF F9$="*" THEN PRINT @(0,7),'CE', ELSE PRINT @(0,3),'CE',
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)),Z1$(LEN(M0$),X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE'),Z1$=MNM('GS')+Z1$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A2$
0320 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14],B[15],B[16],B[17],B[18],B[19],B[20],B[21]
0330 IOLIST C$,C[0],C[1],C[2],C[3]
0340 IOLIST D$
0350 IOLIST E$
0370 IOLIST W$,W[0],W[1],W[2],W[3],W[4],W[5],W[6],W[7],W[8],W[9]
0372 IOLIST S$,S[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],S[8],S[9]
0390 IOLIST P$,P[0],P[1],P[2],P[3]
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X FS1...  02O FS2...  03O PO3...  05O FM0...  06O ZZPARM  07O FS3...  08O AR1...  09O PO7...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0590 READ (Z[1],KEY=K9$,DOM=0591)
0600 REM "
0605 GOSUB 7400
0620 GOSUB 6000
0630 IF POS("P/O"=X4$(7),12)=0 THEN X4$=X4$+"P/O"+" z2Z6A1  "; WRITE (Z[6],KEY=X3$(9,3)+"ZZP")X4$
0800 REM 
1000 REM "
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1030 DIM B$(227),B[22],C$(171),C[3],D$(397),D[15],E$(53),E[1],W[9],S[9]
1035 DIM A$(30)
1045 A$(1,0+K9)=K9$+A1$
1050 IF Q1$<>"" THEN GOTO 1100
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9700
1140 ON X0 GOTO 1200,1250,1300,1350,1500
1200 REM "Invoice number
1202 IF Q1$<>"" THEN A$(1,8)=Q1$; GOSUB 6460; GOTO 1220
1210 CALL "ZZENTR","AXUX",A{ALL},A$,X4$,X3$,17,3,1,8,C0,"AR6","{1"+X$,"","FM2ODD00","AR6","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1210,1211
1215 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1210,1210,9700,6970
1240 GOTO 1120
1250 REM "Invoice date
1255 IF LEN(Q1$)>20 THEN A$(21,6)=Q1$(21,6); CALL "ZZDISP","D",A$(21,6),"",X3$,"","",44,3,X4$; GOTO 1266
1259 A8$=A$(1,9)
1260 CALL "ZZENTR","DX",A{ALL},A$,X4$,X3$,44,3,21,6,C0,"","{2"+X$,"","FM2ODD02","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1260,1261
1262 IF ABS(C0)=2 AND LEN(A1$)>0 THEN A9$(1)="",A1$=A1$(1,0); PRINT 'CF',
1265 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1266,6800,9800
1290 GOTO 1120
1300 REM "Order number
1305 IF LEN(Q1$)>8 THEN A$(9,8)=Q1$(9,8); PRINT @(17,4),FN%ZZDISP$(A$(9,8),"O/P"),; GOTO 1312 ! SSP#265590
1310 CALL "ZZENTR","ZUX",A{ALL},A$,X4$,X3$,17,4,9,8,C0,"","{2"+X$,"","FM2ODD04","FS1","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1310,1311
1312 IF ABS(C0)=2 AND LEN(A1$)>10 THEN A1$=A1$(1,10)
1315 IF C0<0 THEN IF -C0=1 THEN GOTO 1310 ELSE C0=ABS(C0)
1320 READ (Z[1],KEY=A$(9,8),DOM=1310)IOL=0310
1340 GOTO 1120
1350 REM "Line number
1355 IF LEN(Q1$)>16 THEN A$(17,3)=Q1$(17,3); PRINT @(17,5),A$(17,3),; GOTO 1365
1359 Q$=A$(9,8)
1360 CALL "ZZENTR","ZUX",A{ALL},A$,X4$,X3$,17,5,17,3,C0,"","{2"+X$,Q$,"FM2ODD04","FS2","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1360,1361
1365 IF ABS(C0)=2 AND LEN(A1$)>10 THEN A1$=A1$(1,10)
1370 IF C0<0 THEN IF -C0=1 THEN GOTO 1360 ELSE C0=ABS(C0)
1375 READ (Z[2],KEY=A$(9,8)+A$(17,3),DOM=1360)IOL=0320
1379 DIM W$(30); W$(1)=A$
1380 READ (Z[7],KEY=A$(1,19)+" ",DOM=1381)IOL=0370
1385 GOSUB 7700
1390 GOSUB 7750
1395 GOTO 1120
1500 REM "Read PO3 records and set values from FS3 records if avail. then display
1505 T=0; PRINT @(0,9),'CE',
1510 Y=7,L$="",L=0,E0=0; DIM L[20]
1520 A1$=A$(9,8)+" "+A$(17,3)
1530 READ (Z[3],KEY=A1$,DOM=1531)
1550 READ (Z[3],END=1800)IOL=0330
1555 IF LEN(C$)>=259 AND C$(225,35)<>S9$(1,35) THEN C0$=C$(225,28)
1560 IF C$(166,9)+C$(7,3)<>A1$ THEN GOTO 1800
1600 REM 
1610 C[3]=0
1615 DIM P[3]; FIND (Z[9],KEY=A$(9,8)+B$(9,1)+I5$+B$(6,3)+C$(10,1),DOM=1616)IOL=0390; C[3]=P[0]; GOTO 1631
1620 READ (Z[7],KEY=A$(1,19)+C$(10,1),DOM=1630)IOL=0372
1625 C[3]=S[0]
1630 IF C[3]=0 AND C[2]<>0 THEN C[3]=C[2] ! SSP#213465
1635 IF B$(9,1)<>DIM(1) AND C[3]>C[0] THEN DIM AR1$(599); READ (Z[8],KEY=A2$(6,10),DOM=*NEXT)AR1$(1); IF AR1$(526,1)="Y" THEN C[3]=C[0] ! WO263619, don't invoice overruns
1640 IF C[3]=0 AND B[10]<>0 THEN C[3]=C[0]*W[0]/B[10] ! SSP#213465
1700 REM "Display
1710 IF Y>19 THEN E0=1; GOTO 2000
1720 L$=L$+A$(1,19)+C$(10,1)+C$(12,4),L=L+1,T=T+C[3],L[L]=C[3]
1730 GOSUB 7500
1740 IF L[L]<>0 THEN X0=L; GOSUB 7850
1790 GOTO 1550
1800 REM "Input values for a page
1810 GOSUB 7800
1900 REM "End
1910 CALL "ZZPROM","X0PO2MAF",X3$,Z,"","","",0
1915 ON Z GOTO 1950,1500,2000,3000
1950 REM "If not eof then continue with record
1955 IF E0=1 THEN E0=0,L=0,L$="",Y=7; DIM L[20]; PRINT @(0,Y),'CE',; GOTO 1711
1960 REM "If end check balance, and leave
1970 IF T<>W[0] THEN CALL "ZZPROM",".4",X3$,Z,"Distribution is out of balance!","","",0; ON Z GOTO 1900
1980 IF LEN(U1$)>6 THEN IF U1$(1,6)="FM2ODD" THEN GOSUB 8980; GOTO 1000
1990 GOTO 9700
2000 REM "DATA SEQ
2010 C0=0,X0=0,X1=1
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF INT(C0)=3 THEN GOSUB 7300 ELSE IF C0>3 OR X0<0 THEN X0=999
2040 IF X0>0 AND X0<=L THEN GOTO 2100 ELSE GOTO 1900
2100 REM "Receive now
2105 L5=X0*2+5
2107 DIM Q[1],Q1[1]; T=T-L[X0],Q[1]=L[X0]/M,Q1[1]=L[X0] ! WO263619
2110 CALL "ZZENTR","NX.",Q{ALL},A$,X4$,X3$,65,L5,1,822,C0,M0$,"{3"+X$,"","FM2ODD08","","",""
2115 IF C0>0 THEN L[X0]=Q[1]*M
2116 IF B$(9,1)<>DIM(1) AND L[X0]>Q1[1] AND MID(AR1$,526,1)="Y" THEN L[X0]=Q1[1],Q[1]=L[X0]/M; PRINT @(65,L5),STR(Q[1]:M0$), ! WO263619, don't invoice customer for overruns
2120 T=T+L[X0]; IF E0=0 THEN GOSUB 7800
2130 GOSUB 7850
2140 GOTO 2020
3000 REM "Run shipto setup
3005 U2$="FM2ODD"+STR(LEN(Q1$):"00")+Q1$
3010 IF A2$(173,1)="C" THEN U1$="FM2ODC11"+A$(1,8)+A$(20,3)+U2$+U1$ ELSE U1$="PO2MAD12"+A$(1,9)+A$(20,3)+U2$+U1$
3020 GOTO 9710
6000 REM "BACKGROUND
6004 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,-1
6005 PRINT (0,ERR=6016)'SB',
6060 PRINT @(1,3),"Invoice number:",@(30,3),"Invoice date:",@(3,4),"Order number:",@(56),"U/M:",@(4,5),"Line number:",@(0,6),Z0$,
6080 PRINT @(0,6),"Seq code ",@(37)," Quantity ",@(49),"Activity to date",@(69)," Bill now ",
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6220 CALL "ZZDISP","A",A$(7+K9,10),"A/P",X3$,"","",17,4+V0,X4$
6224 PRINT @(5,5+V0),B$(11,35),@(61,4+V0),A$(17+K9,4),@(44,5+V0),A$(21+K9,35),@(17,6),A$(10,10),
6225 PRINT @(10,7),A$(10,3),; GOSUB 7750
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6460 CALL "ZZDISP","A",A$(1,8),"AR6",X3$,"","",17,3,X4$
6490 RETURN 
6600 REM "ALT KEY DATA READS
6690 RETURN 
6700 REM "ADD ENTRY
6790 GOTO 1630
7300 REM 
7310 ON FPT(C0)*10 GOTO 7390,7325,7330,7390
7325 IF V8$="" THEN X0=X0+1; GOTO 7390 ELSE X0=NUM(V8$(POS(STR(X0:"00")<=V8$,2),2)); GOTO 7390
7330 IF V8$="" THEN X0=X0-2; GOTO 7335 ELSE X0=POS(STR(X0-1:"00")<=V8$,2)-2; IF X0<0 THEN X0=0; GOTO 7390 ELSE X0=NUM(V8$(X0,2)); GOTO 7390
7335 IF X0<0 THEN X0=0; GOTO 7390
7390 C0=3; RETURN 
7400 REM "Audit already run
7410 FIND (Z[1],KEY="",DOM=7490)V0$,K0$
7420 IF K0$>"" THEN CALL "ZZPROM","4",X3$,S3,"The update has already been initiated. Press |Return>","","",0; GOTO 9900
7430 EXTRACT (Z[1],KEY="",ERR=9800)
7440 Q$="Audit report "+V0$(22,4)+"."+V0$(26,2)+" has already been printed for this data entry."
7445 PRINT @(6,23),Q$,; CALL "ZZPROM","1",X3$,S3,"","","",0; ON S3 GOTO 9800,7446
7450 REMOVE (Z[1],KEY="")
7490 RETURN 
7500 REM "Display a ship to record
7510 PRINT @(0,Y),C$(10,1),@(2),C$(11,1),"-",C$(12,4),@(35),FNN(C[0]):M0$,@(51),FNN(C[2]):M0$,@(65),FNN(C[3]):M0$,
7512 IF Y=7 THEN PRINT @(9,Y),C0$,
7515 IF C$(11,1)="D" THEN PRINT @(2,Y+1),"Our warehouse in "+FNS$(C$(106,16))+","+C$(122,2), ELSE PRINT @(2,Y+1),FNS$(C$(46,30))+"  "+FNS$(C$(106,16))+","+C$(122,2),
7535 Y=Y+2
7540 RETURN 
7700 REM "Set U/M divisor M
7705 DIM M$(21),M[1]
7710 READ (Z[13],KEY="U/M"+B$(124,4),DOM=7711)M$,M[0],M[1]
7715 IF M$(20,1)="Y" THEN M=M[1] ELSE M=B[5]
7720 IF M=0 THEN M=1
7740 RETURN 
7750 REM "Print desc from B$
7760 H9$=FNS$(B$(32,8)); IF H9$<>"" THEN H9$=H9$+QUO; IF POS(" "<>B$(40,8))<>0 THEN H9$=H9$+"x"
7770 H9$=H9$+FNS$(B$(40,8)); IF H9$<>"" THEN IF POS(" "<>B$(40,8))<>0 THEN H9$=H9$+QUO+" " ELSE H9$=H9$+" "
7775 IF NUM(B$(48,2))<>0 THEN H9$=H9$+B$(48,2)+" Ply "
7780 H9$=H9$+FNS$(B$(50,40))
7785 PRINT @(21,5),H9$,@(65),FNN(W[0]):M0$,
7786 PRINT @(61,4),'CL',FNS$(B$(124,4)),"/",FNR$(STR(B[5]:M1$)), ! SSP#265590
7790 RETURN 
7800 REM "Print total
7810 PRINT @(65,Y-1),Z1$,@(65,Y),FNN(T):M0$,
7840 RETURN 
7850 REM "Write amount out to FS3 file
7854 S1$=L$((X0-1)*24+1,24)
7855 DIM S[9]; S$=W$,S$(1,20)=S1$(1,20),S$(21,6)=A$(21,6),S$(27,4)=S1$(21,4),S[0]=L[X0],S[1]=W[1],S[6]=W[6]; GOSUB 7950
7860 IF S$(20,1)=" " THEN GOTO 7890
7865 IF S[0]<>0 THEN GOTO 7870
7866 REMOVE (Z[7],KEY=S$(1,20),DOM=7867)
7868 GOTO 7890
7870 WRITE (Z[7],KEY=S$(1,20))IOL=0372
7890 RETURN 
7950 REM "Figure extension S(2)
7955 IF M$(21,1)<>"Y" THEN GOTO 7975
7960 PRECISION 14
7965 IF W[0]=0 THEN S[2]=0,S[4]=0 ELSE S[2]=W[2]*L[X0]/W[0],S[4]=W[4]*L[X0]/W[0]
7970 PRECISION 2; S[2]=S[2]+0,S[4]=S[4]+0; GOTO 7990
7975 IF M=0 THEN S[2]=0,S[4]=0 ELSE S[2]=S[0]/M*S[1],S[4]=S[0]/M*S[6]; IF M[0]<>0 THEN S[2]=S[2]/M[0],S[4]=S[4]/M[0]
7990 RETURN 
8950 REM "Program flow logic
8960 DIM U0$(6); U0$(1)=FID(0),U0$=U0$+"PF"
8970 CLOSE (14); OPEN (14)"ZZPARM"; FIND (14,KEY=U0$,DOM=8990)U0$,U1$
8975 IF U1$(1,6)<>X0$ THEN Q1$=""; GOTO 8990
8980 Q1=NUM(U1$(7,2)),Q1$=U1$(9,Q1),U1$=U1$(Q1+9)
8985 IF LEN(Q1$)>26 THEN I5$=Q1$(27),Q1$=Q1$(1,26)
8990 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9700 REM "PROG FLOW
9710 IF U1$="" THEN REMOVE (Z[13],KEY=U0$,DOM=9900); GOTO 9900
9715 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9720 WRITE (Z[13],KEY=U0$)U0$,U1$
9730 RUN U1$(1,6)
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 SETERR 9940; Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
56000 REM "213465-FMGODD/FM2ODD - when there is an overrun. Would like the    
56002 REM "263619-Customer default; Don't invoice customer for overruns?      
56003 REM "265590-Display issue in Special shipping during PO recvg and AR    
