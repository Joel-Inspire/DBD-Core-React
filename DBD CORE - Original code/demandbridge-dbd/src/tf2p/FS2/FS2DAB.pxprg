0010 REM "Requisition/Whse. Release Line Entry <FS2DAB>
0015 REM "File FS2 was marked with "X" on 4/23/92 to hold Extract
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 12/04/23 - 14.000408 - jvv - SSP# 307463
0037 REM "307463-Allow access to all warehouses for an operator who is       
0040 REM "Copyright 2023 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0110 X0$="FS2DAB",X1$="Requisition/Whse. Release Line Entry",K9$="",K9=0
0120 DIM Z0$(80,"-"),S0$(40),S2$(40,"."),P5$(240)
0130 K0=11,K1=2
0135 C9=-1
0140 M0$="##,##0-",M1$="###,###.00-",M2$="####,###.00-",M3$="-####,###.00",M4$="##0-",M5$="#####,###.00-",M7$="####,##0"
0160 V8$="000207102699"
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(65,1)>"2" THEN PRECISION NUM(X3$(65,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1),A[0],A[1],A[2],A[3],A[4],A[5],A[6]
0315 IOLIST A0$(1),A0[0],A0[1],A0[2],A0[3],A0[4],A0[5],A0[6],A0[7],A0[8],A0[9],A0[10],A0[11],A0[12],A0[13],A0[14],A0[15],A0[16],A0[17],A0[18],A0[19],A0[20],A0[21],A0[22],A0[23],A0[24],A0[25],A0[26],A0[27],A0[28],A0[29]
0316 IOLIST A0$(1),A0[0],STR(A0[1]),A0[2],A0[3],STR(A0[4]),A0[5],A0[6],A0[7],A0[8],A0[9],A0[10],A0[11],A0[12],A0[13],A0[14],A0[15],A0[16],A0[17],A0[18],A0[19],A0[20],A0[21],STR(A0[22]),A0[23],A0[24],A0[25],A0[26],A0[27],A0[28],A0[29]
0320 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5]
0325 IOLIST B0$,B0[0],B0[1],B0[2],B0[3],B0[4],B0[5],B0[6],B0[7],B0[8],B0[9],B0[10],B0[11],B0[12],B0[13]
0330 IOLIST C$,C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15]
0335 IOLIST C0$,C0[0],C0[1],C0[2],C0[3],C0[4],C0[5],C0[6],C0[7],C0[8],C0[9],C0[10],C0[11],C0[12],C0[13],C0[14],C0[15]
0340 IOLIST D$,D[0],D[1],D[2],D[3],D[4],D[5],D[6],D[7],D[8],D[9],D[10],D[11],D[12],D[13],D[14],D[15],D[16],D[17],D[18],D[19],D[20],D[21],D[22],D[23],D[24],D[25],D[26],D[27],D[28],D[29],D[30],D[31],D[32],D[33],D[34],D[35],D[36],D[37],D[38],D[39],D[40]
0350 IOLIST E$
0360 IOLIST F$,F[0],F[1],F[2]
0370 IOLIST G$,G[0],G[1],G[2],G[3],G[4],G[5],G[6],G[7],G[8],G[9],G[10],G[11],G[12],G[13],G[14],G[15],G[16],G[17],G[18],G[19],G[20]
0374 IOLIST G3$,G3[0],G3[1],G3[2],G3[3],G3[4]; REM SSP 161760
0380 IOLIST H$,H[0],H[1],H[2],H[3]
0390 IOLIST I$,I[0],I[1],I[2],I[3]
0410 IOLIST F1$,F1[0],F1[1],F1[2],F1[3],F1[4],F1[5],F1[6],F1[7],F1[8],F1[9],F1[10],F1[11],F1[12],F1[13],F1[14],F1[15],F1[16],F1[17],F1[18],F1[19],F1[20],F1[21],F1[22],F1[23],F1[24],F1[25],F1[26],F1[27],F1[28],F1[29],F1[30],F1[31]
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0509 REM "We're using FS1 and FS2 instead of FSM(z(2)) and FSN(z(1)).The program converts the FS1 to FSM data in 8800 and the FS2 to FSN in 8700, the FSN to FS2 in 8750. If anything needs to write out to FS1 then the conv routine and 8850 in FS2DAA needs to be used
0510 Z$="01X FS2...  02X FS1...  03O AR1...  04O IC0...  05O FM0...  06O PO3...  07O IC1...  08O FMP...  09O ICF...  10O AR4...  11O FM1...  12O ASQ...  13O ZZPARM  16O SP0...  17S ICF...  "
0520 GOSUB 9750; ON Z0 GOTO 0521,9900
0590 READ (Z[1],KEY=K9$,DOM=0591)
0600 REM "
0605 DIM S5$(255); FIND (Z[13],KEY="osec"+X3$(40,3),DOM=0606)S5$
0610 FIND (Z[13],KEY=X3$(9,3)+"AR1")P2$
0615 FIND (Z[13],KEY=X3$(9,3)+"A/R")ARS$
0620 FIND (Z[13],KEY=X3$(9,3)+"I/C")P3$
0625 FIND (Z[13],KEY=X3$(9,3)+"F/M")P4$
0626 MFF_PARM=0; IF MID(P4$,337,1)="Y" THEN MFF_PARM=1 ! SSP 276772
0627 GB$=""; FIND (Z[13],KEY=X3$(9,3)+"G/B",DOM=0628)GB$
0630 P9$="F5=availablity by warehouse, F7=pricing table"
0640 L9$="001"
0660 DIM M6[1]; M6$="###,###.00-",M6[0]=621,M6[1]=2; IF P3$(45,1)>"2" THEN DIM M6$(11,"0"); M6[1]=NUM(P3$(45,1)),M6$(1,10-M6[1])="##########",M6$(POS("0"=M6$),1)=".",M6[0]=(10-M6[1])*100+M6[1]*10
0680 GOSUB 6000
0800 REM 
0810 GOSUB 8950
0840 CLOSE (14); DIM P1$(210); OPEN (14,ERR=0841)"FSH"+X3$(9,3); FIND (14,KEY=Q1$(1,2),DOM=0841)P1$
1000 REM "
1010 Y8=1; CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1015 DIM V7$(27); V7$(1,1)="1",V7$(2,1)="1",V7$(3,1)="1",V7$(8,1)="1",V7$(9,1)="1",V7$(27,1)="1"
1030 DIM B$(393),B[7],C$(400),C[15],D$(187),D[40],E$(224),F$(128),F[2],C0$(400),C0[15],B0$(200),B0[13],I$(259),I[3],K[6],G[20],H$(61),H[3],H8$(46); F1$="" ! SSP#277026
1032 F3$=""
1033 DIM A0$(356),A0[29]
1035 DIM A$(153),A[13]
1039 REM "This sets lot flag on line until lots set by item; see line 8325 also
1045 A$(1,LEN(A1$))=A1$; IF A1$="" THEN A$(1,LEN(K9$))=K9$
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 SETERR 9000; C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1200,1250,1500
1200 REM "Requisition number
1204 IF Q1$>"" THEN A$(1,8)=Q1$,A1$=Q1$,Q1$=""; GOSUB 6460
1205 IF LEN(A1$)>0 THEN A$(1,8)=A1$(1,8); GOTO 1220
1210 CALL "ZZENTR","AXUX",A{ALL},A$,X4$,X3$,12,3,1,8,C0,"O/P","{1"+X$,K9$,"FS2DAB00","FS1","FS2DAA",""; IF C0=6 THEN GOSUB 6400; C0=1
1212 IF INT(ABS(C0))=3 THEN C0=-ABS(C0); READ (Z[1],KEY=A$(1,8),DOM=1213)
1215 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1210,6800,9700,6970
1220 IF V9<>-2 THEN EXTRACT (Z[2],KEY=A$(1,8),DOM=1210)IOL=0325
1222 K9$=A$(1,8)
1225 GOSUB 7500
1230 GOSUB 7525
1240 GOTO 1120
1250 REM "Line number
1255 A$(9,3)=L9$,S1=0,DONT_MOD$=""
1257 Q$=A$(1,8),X$="Use LOOKUP to display lines"
1260 CALL "ZZENTR","ZUX",A{ALL},A$,X4$,X3$,1,6,9,3,C0,"","{2"+X$,Q$,"FS2DAB02","13FS2A","",""; IF C0=6 THEN GOSUB 6400; C0=1
1261 IF ABS(C0)=2 THEN GOTO 1260; REM IF ABS(C0)=2 AND LEN(A1$)>0 THEN LET A1$=A1$(1,0)
1262 DIM FS2$(153); READ (Z[1],KEY=A$(1,11),DOM=1263)FS2$ ! SSP#219787
1263 IF ABS(C0)<>4 THEN IF FS2$(9,1)<>" " THEN CALL "ZZPROM",".4",X3$,0,"This line has a PO code and cannot be maintained in req entry","","",0; GOTO 1260 ! SSP#219787
1265 IF INT(ABS(C0))=3 THEN GOTO 6800 ELSE IF ABS(C0)=4 THEN GOTO 9600
1269 REM "Due to FS6 seq counter"
1270 IF A$(9,3)<"001" OR A$(9,3)>"206" THEN GOTO 1260
1280 L9$=STR(NUM(A$(9,3))+1:"000")
1290 GOTO 1120
1500 REM "
1505 Z9=-1,C9=0,A2$="",A3$="",A4$="",A5$=""
1510 A1$=A$(1,11)
1520 READ (Z[1],ERR=7200,KEY=A1$,DOM=1600)IOL=0315
1521 GOSUB 8700
1525 Z9=0,V7$=""; GOSUB 5800
1590 GOTO 1700
1600 REM "
1620 Z=0; GOTO 1650
1630 IF GB$<>"" AND I8$<>"" AND C9=0 THEN GOSUB 7100; GOTO 1000 ELSE IF C9=1 AND Z=2 THEN GOTO 1820 ELSE GOTO 1000
1680 GOSUB 7450
1685 IF %MSLC THEN GOSUB MULTI_COMM_KEY; CALL "ARGSCM;DEFAULT_LINE_SETUP",SC_TYPE$,SC_KEY1$,SC_KEY2$,SC_LINE$ ! SSP 225300
1690 GOTO 2000
1700 REM "
1790 GOSUB 6200
1800 REM "
1810 IF P4$(182,1)="Y" THEN IF J2$<>"  " THEN X0=27; GOTO 2040
1815 IF POS(A$(12,1)="ICS")>0 AND POS(" "<>A$(23,10))=0 THEN GOTO 6500
1820 CALL "ZZPROM",STR(6+C9),X3$,Z,"","","V",X0; ON Z GOTO 1850,6500,1630,6700,1821
1825 GOTO 6700
1830 GOTO 2000
1850 REM "MODIFY
1852 DONT_MOD$="N"; IF A[4]>0 AND P4$(254,1)="Y" THEN DONT_MOD$="Y"
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE IF Z9=0 THEN Z9=1
1860 GOSUB 7400
1862 IF I8$>"" THEN B0$=B0$+"~"+I8$; CALL "FM2ODZ",X3$,-1,A0$,A0{ALL},B0$
1870 GOSUB 6200
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1
2020 SETERR 9000; X$="",Q$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF INT(C0)=3 THEN GOSUB 7300 ELSE IF C0>3 OR X0<0 THEN GOTO 1800
2038 IF X0<LEN(V7$) THEN V7$(X0+1,1)=""
2039 IF X0=26 THEN GOSUB 6950
2040 ON X0 GOTO 2100,2150,2200,2250,2300,2350,2400,2450,2500,2550,2600,2650,2700,2750,2800,3150,2950,3400,2850,2900,3050,3100,3200,3250,3300,3350,3450,3500,3550,3700,1800
2090 REM "Line Type
2101 REM "Maybe Nonstock later! - use a misc special instead for now
2102 F8$=""; IF A$(99,1)="Y" THEN GOTO 2020 ELSE IF ABS(C0)=2 OR A$(12,1)<>" " THEN GOTO 2109
2104 A$(12,1)="I"; IF B$(359,1)="R" THEN A$(12,1)="C"
2106 PRINT @(5,6),A$(12,1),; GOSUB 8250; GOTO 2020
2109 F8$="Y",K$="IMSC",X$="Enter line type: I=inventory, C=customer inventory, M=message, S=special",Q9$=A$(12,1); IF B$(359,1)="R" THEN X$=X$(1,17)+X$(31,31),K$="CM" END_IF ; IF POS(" "<>A$(23,10))<>0 THEN GOTO 2020; REM "119416
2110 CALL "ZZENTR","SURU",A{ALL},A$,X4$,X3$,5,6,12,1,C0,"","{3"+X$,K$,"FS2DAB04","","",""
2112 IF B$(359,1)="R" AND A$(12,1)="I" THEN GOTO 2110
2120 IF A$(12,1)<>"C" THEN A$(13,10)=""; PRINT @(8,5),S0$(1,11),
2130 IF Q9$<>" " AND Q9$<>A$(12,1) THEN Z=13; GOSUB 8300
2140 GOTO 2020
2150 REM "Customer
2152 IF A$(99,1)="Y" OR A$(12,1)<>"C" THEN GOTO 2020
2153 IF B$(359,1)="W" AND POS(" "<>A$(13,10))<>0 THEN GOTO 2020; REM "SSP119416
2154 IF ABS(C0)<>2 AND B$(359,1)="R" AND POS(" "<>A$(13,10))=0 THEN A$(13,10)=B$(21,10); GOSUB 6300; GOTO 2170
2158 Q9$=A$(13,10),X$="Enter customer code"
2160 CALL "ZZENTR","AU",A{ALL},A$,X4$,X3$,8,5,13,10,C0,"A/R","{3"+X$,"","FS2DAB06","13AR1","",""; IF C0=6 THEN GOSUB 6400; C0=1
2170 IF ABS(C0)<>2 THEN FIND (Z[3],KEY=A$(13,10),DOM=2160)IOL=0330
2180 IF POS(" "<>Q9$)>0 AND Q9$<>A$(13,10) THEN Z=23; GOSUB 8300
2190 GOTO 2020
2200 REM "Item number
2203 IF POS(" "<>A$(23,10))<>0 THEN GOTO 2020; REM "SSP119416
2205 IF A$(99,1)="Y" OR POS(A$(12,1)="M")<>0 THEN GOTO 2020
2206 IF A$(12,1)="S" THEN GOTO 3000
2208 Q$=A$(13,10)
2209 IF CIC$="Y" AND POS(" "<>A$(23,10))=0 THEN GOTO 3600
2210 CALL "ZZENTR","AXUF",A{ALL},A$,X4$,X3$,8,6,23,10,C0,"ICE","{3"+X$,Q$,"FS2DAB08","13IC0","IC2MAB",""; IF C0=6 THEN GOSUB 6400; C0=1
2215 IF ABS(C0)=2 OR ABS(C0)=4 AND POS(" "<>A$(23,10))=0 THEN GOTO 2240
2220 IF POS(" "<>A$(23,10))=0 THEN GOTO 2209
2225 IF C0>0 THEN GOSUB 7600; IF C0=99 THEN C0=0; GOTO 2200
2227 IF P4$(243,1)="A" THEN CALL "FS2DAJ",X3$,X4$,A$(13,20),1,13
2230 IF ABS(C0)=1 THEN X0=X0+4
2240 GOTO 2020
2250 REM "Left-Right
2255 IF POS(A$(12,1)="MS")<>0 THEN GOTO 2020
2260 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,19,6,33,8,C0,"","{3"+X$,"","FS2DAB10","","",""
2290 GOTO 2020
2300 REM "Top-Bottom
2305 IF POS(A$(12,1)="MS")<>0 THEN GOTO 2020
2310 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,28,6,41,8,C0,"","{3"+X$,"","FS2DAB12","","",""
2340 GOTO 2020
2350 REM "Number of plys
2355 IF POS(A$(12,1)="MS")<>0 THEN GOTO 2020
2360 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,37,6,49,2,C0,"","{3"+X$,"","FS2DAB14","","",""
2390 GOTO 2020
2400 REM "Description
2410 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,40,6,51,40,C0,"","{3"+X$,"","FS2DAB16","","AR2MKA",""; IF C0=6 THEN GOSUB 6400; C0=1
2420 IF ABS(C0)=4 THEN C0=1
2440 GOTO 2020
2450 REM "Ship from
2451 IF P3$(44,1)="Y" AND D$(112,1)="Y" THEN IF A[2]<>0 OR A[1]<>0 THEN CALL "ZZPROM",".4",X3$,Z,"Lots have been entered, so the whse cannot be changed!","","",0; GOTO 2490
2455 GOSUB 8350
2458 X$=P9$; IF B$(359,1)="R" THEN X$=X$+" ,(From 1st digit must be '9')"
2460 C0=0; CALL "ZZENTR","SZFX",A{ALL},A$,X4$,X3$,60,5,91,4,C0,"","{3"+X$,"D","FS2DAB18","13FM0D","FM2SKA",""; IF C0=6 THEN C0=1
2461 IF MID(P4$,348,1)<>"Y" THEN IF X3$(333,2)<>"  " THEN A$(92,3)="0"+X3$(333,2); PRINT @(60,5),A$(91,4), ! SSP#286885!ssp#307292 DBSPT-94483!SSP#307330 DBSPT-110365 SSP307430-DBD-333-DBSPT-149880!SSP#307462 DBD-421 SSP307463 DBD-422
2462 IF ABS(C0)<14 THEN GOTO 2470
2464 ON ABS(C0)-14 GOSUB 8000,8100,8200,8490
2466 GOTO 2460
2470 IF B$(359,1)="R" AND A$(91,1)<>"9" THEN GOTO 2460 ELSE IF V9<>-2 THEN FIND (Z[5],KEY="D"+S0$(1,10)+A$(91,4),DOM=2460)IOL=0350
2472 IF A$(12,1)="I" AND A$(91,1)="9" THEN CALL "ZZPROM",".4",X3$,0,"Warehouse code cannot begin with a '9'","","",0; GOTO 2460
2475 GOSUB 7550
2477 IF POS(A$(12,1)="IC")=0 THEN GOTO 2490
2480 DIM G$(58),G[20]; FIND (Z[7],KEY=A$(13,20)+A$(91,4),DOM=2481)IOL=0370; GOTO 2483
2481 IF A$(91,1)="9" THEN CALL "ZZPROM",".Y",X3$,Z,"HOLD IT.  There is no customer owned inventory record!  Delete line?","","",0; IF Z=0 THEN GOTO 6500 ELSE GOTO 2460
2482 IF A$(91,1)<>"9" THEN CALL "ZZPROM",".Y",X3$,Z,"This item not setup in this warehouse, set up item?","","",0; IF Z=1 THEN GOTO 6500
2483 Q9=G[3]+G[4]-G[5]+G[6]-G[7]
2485 PRECISION M6[1]; IF A$(91,1)="9" THEN A[4]=0,A[6]=0 ELSE IF D[15]<>0 AND A[6]=0 THEN IF G[2]<>0 THEN A[6]=G[2]*A[0]/D[15] ELSE A[6]=D[18]*A[0]/D[15]
2487 PRECISION 2; GOSUB 7850
2488 J1$=A$(91,4)
2490 GOTO 2020
2500 REM "Unit of measure
2505 IF POS(A$(12,1)="M")<>0 THEN GOTO 2020
2507 IF ABS(C0)<>2 AND Z9=1 AND POS(" "<>A$(95,4))>0 THEN X0=X0+1; GOTO 2020
2510 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,0,9,95,4,C0,"","{3"+X$,"U/M","FS2DAB20","13U/M","",""; IF C0=6 THEN GOSUB 6400; C0=1
2520 IF V9<>-2 THEN FIND (Z[13],KEY="U/M"+A$(95,4),DOM=2510)IOL=0360
2535 GOSUB 7800
2540 GOTO 2020
2550 REM "Quantity per U/M
2553 IF POS(A$(12,1)="M")<>0 THEN GOTO 2020
2555 IF F$(20,1)="Y" THEN GOTO 2570
2560 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,6,9,0,600,C0,"#####0","{3"+X$,"","FS2DAB22","","",""
2570 GOSUB 7800
2580 IF C0>0 THEN IF POS(A$(12,1)="IC")>0 THEN GOSUB 7900; GOSUB 6239
2590 GOTO 2020
2600 REM "Ordered
2602 Q0=0; IF A$(12,1)="M" OR (A$(12,1)="S" AND H$(61,1)="Y") THEN GOTO 2020
2604 IF P3$(44,1)="Y" AND D$(112,1)="Y" AND A[2]<>0 AND ABS(C0)<>2 THEN GOTO 2020
2605 IF GB$<>"" AND POS(A$(12,1)="IC")<>0 THEN IF STP(A$(146,8),3," ")="" THEN GOTO 2606 ELSE GOTO 2640
2608 K[1]=A[1]/D9
2609 X$="Press the F8 key after entry to extend quantity entered by carton pack"
2610 C0=0; CALL "ZZENTR","NFX.",K{ALL},A$,X4$,X3$,13,9,1,821,C0,M5$,"{3"+X$,"","FS2DAB24","","",""; IF K[1]<0 AND S5$(42,1)="Y" THEN GOTO 2608
2611 IF A[3]=0 AND A[2]=0 AND D$(112,1)<>"Y" THEN K[2]=K[1]; A[2]=K[2]*D9
2615 IF ABS(C0)<14 THEN GOTO 2630 ELSE IF ABS(C0)=17 AND A[9]>0 THEN K[1]=K[1]*A[9],C0=1; GOTO 2630
2620 ON ABS(C0)-14 GOSUB 8000,8100,8200,8490
2625 GOTO 2608
2630 IF A$(99,1)="Y" AND ABS(C0)<>2 THEN C0=1
2631 IF C0>0 THEN IF A[1]<0 AND K[1]>=0 THEN GOTO 2608 ELSE A[1]=K[1]*D9; IF DONT_MOD$<>"Y" THEN A[10]=A[4]
2632 IF ABS(C0)=2 THEN GOTO 2640
2633 IF A$(12,1)="S" THEN GOSUB 7848; GOTO 2640
2635 IF C0>0 THEN GOSUB 8550; A[10]=A[4]; GOSUB 7900; GOSUB 7848
2637 GOSUB 4600
2638 IF POS(X3$(9,3)="021",3)>0 THEN IF G[10]>0 AND Q9-A[1]-G[8]<G[10] THEN CALL "ZZPROM",".4",X3$,0,"BELOW REORDER POINT FOR THIS WHSE (Avail Inv. less P/Os less this order)","","",0
2639 IF GB$<>"" AND POS(A$(12,1)="IC")<>0 THEN GOSUB 4300; O_NUM$=A$(1,8),O_DATE$=B$(9,6),O_CUST$=B$(21,10),PROD$=A$(23,10),QUOTE$=A$(146,8),QTY=A[1]/D9; CALL "GB2QUO",X3$,X4$,O_NUM$,O_DATE$,O_CUST$,PROD$,QTY,QUOTE$,NEW_PRICE,RESULT; PRINT @(0,13),'CE',; GOSUB 6900; GOSUB 6950; IF RESULT=1 THEN A[4]=NEW_PRICE; GOSUB 7850; IF O_CUST$="ALL"+DIM(7) THEN A$(146,8)="A"+QUOTE$ ELSE A$(146,8)="C"+QUOTE$ END_IF 
2640 IF C0=1 AND POS(A$(12,1)="IC")>0 AND (D$(112,1)<>"Y" OR P3$(52,1)="C") AND A[2]=0 AND A[3]=0 AND A[1]>=0 THEN X0=X0+2
2641 IF P4$(281,1)="Y" OR P4$(281,1)="B" THEN GOSUB 8400; REM "WO#105419
2645 GOTO 2020
2650 REM "Shipped
2652 IF ABS(C0)=2 OR A$(12,1)="M" OR (A$(12,1)="S" AND H$(61,1)="Y") THEN GOTO 2020
2654 IF A[1]<0 AND POS(A$(12,1)="IC")>0 AND P3$(44,1)="Y" AND D$(112,1)="Y" THEN UOM0=A[0]; GOSUB 4500; GOSUB 4250; GOSUB 7900; GOSUB 6239; GOTO 2666; REM "added uom var 5/6/98 cwj SSP#096315
2656 IF A[2]>=0 THEN IF POS(A$(12,1)="IC")<>0 AND P3$(44,1)="Y" AND D$(112,1)="Y" AND P3$(52,1)<>"C" THEN GOSUB 4100; GOSUB 4250; GOSUB 7900; GOSUB 8550; GOSUB 6239; IF A[2]=0 THEN GOTO 2658 ELSE GOTO 2670
2658 K[2]=A[2]/D9
2659 IF POS(X3$(9,3)="139")<>0 THEN GOTO 2670
2660 IF P4$(256,1)="N" AND A$(12,1)<>"S" AND G[3]+G[4]-G[5]+G[6]-G[7]<=0 THEN K[2]=0; GOTO 2662; REM "Added -G[7] ssp87929
2661 CALL "ZZENTR","NX.",K{ALL},A$,X4$,X3$,27,9,2,821,C0,M5$,"{3"+X$,"","FS2DAB26","","",""; IF K[2]<0 AND S5$(42,1)="Y" THEN GOTO 2658
2665 IF C0>0 THEN A[2]=K[2]*D9,A[3]=A[1]-A[2]; IF A[3]<0 THEN A[3]=0
2666 IF A[2]<>0 THEN GOSUB 7900; GOSUB 6239
2670 IF A[1]=0 AND A[2]<>0 AND C0>0 AND ABS(C0)<>2 THEN A[1]=A[2]; GOSUB 8550; PRINT @(13,9),A[1]/D9:M5$,; GOSUB 7900; GOSUB 7848
2675 IF C0>0 AND ABS(C0)<>2 AND P4$(256,1)="N" AND A$(12,1)<>"S" THEN A[3]=A[1]-A[2]; IF A[3]<0 THEN A[3]=0
2677 GOSUB 6239
2680 GOSUB 4600
2690 GOTO 2020
2700 REM "Backordered
2702 IF POS(X3$(9,3)="139")<>0 AND A[1]-A[2]<>0 THEN GOTO 2710
2705 IF A$(12,1)="M" OR (A$(12,1)="S" AND H$(61,1)="Y") THEN GOTO 2020
2706 IF ABS(C0)<>2 AND A[3]=0 THEN PRINT @(41,9),A[3]:M5$,; GOTO 2020
2707 IF D$(117,1)="Y" THEN A[3]=0; GOTO 2020; REM "WO105428
2708 K[3]=A[3]/D9
2710 CALL "ZZENTR","NX.",K{ALL},A$,X4$,X3$,41,9,3,821,C0,M5$,"{3"+X$,"","FS2DAB28","","",""
2720 IF C0>0 THEN A[3]=K[3]*D9; IF A[1]<=A[2]+A[3] AND A[3]<>A[1]-A[2] THEN A[1]=A[2]+A[3]; PRINT @(13,9),A[1]/D9:M5$,
2730 IF C0>0 AND A[1]>A[2]+A[3] THEN A[2]=A[1]-A[3]; GOSUB 6239
2740 GOTO 2020
2750 REM "Price
2755 IF A$(12,1)="M" OR (A$(12,1)="S" AND H$(61,1)="Y") THEN GOTO 2020
2756 IF A$(91,1)="9" THEN IF ABS(C0)<>2 THEN A[4]=0,A[6]=0,A[10]=0,A[11]=0,C0=1; GOTO 2770 ELSE GOTO 2020 ! SSP#277242
2757 IF A[11]<>0 THEN GOTO 2020
2758 IF POS(A$(12,1)="IC")>0 THEN IF D[20]<>0 THEN X$="Standard Cost: "+STR(D[20]:M1$)
2759 GOSUB GET_PRICE ! SSP188067
2760 PRECISION M6[1]; C0=0; CALL "ZZENTR","NFX&",A{ALL},A$,X4$,X3$,55,9,4,M6[0],C0,M6$,"{3"+X$,"","FS2DAB30","","",""; PRECISION 2
2762 IF ABS(C0)<14 THEN GOTO 2770
2764 ON ABS(C0)-14 GOSUB 8000,8100,8200,8490
2766 GOTO 2760
2770 IF C0>0 THEN GOSUB 7850
2790 GOTO 2020
2800 REM "Extension
2805 IF POS(A$(12,1)="MIC")<>0 OR A[11]<>0 THEN GOTO 2020
2806 IF A$(12,1)="S" AND H$(61,1)<>"Y" THEN GOTO 2020
2810 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,67,9,5,721,C0,M2$,"{3"+X$,"","FS2DAB32","","",""
2840 GOTO 2020
2850 REM "Cost
2851 IF S5$(63,1)="Y" THEN GOTO 2890
2855 IF POS(A$(12,1)="MIC")>0 THEN GOTO 2020
2856 IF A$(12,1)="S" AND H$(61,1)="Y" THEN GOTO 2020
2858 IF ABS(C0)<>2 AND A$(91,1)="9" THEN A[6]=0,C0=1; GOTO 2870
2860 CALL "ZZENTR","NX&",A{ALL},A$,X4$,X3$,55,10,6,621,C0,M1$,"{3"+X$,"","FS2DAB34","","",""
2870 IF C0>0 THEN GOSUB 7850
2890 GOTO 2020
2900 REM "Cost Extension
2901 IF S5$(63,1)="Y" THEN GOTO 2940
2905 IF POS(A$(12,1)="MIC")<>0 THEN GOTO 2020
2906 IF A$(12,1)="S" AND H$(61,1)<>"Y" THEN GOTO 2020
2910 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,67,10,7,721,C0,M2$,"{3"+X$,"","FS2DAB36","","",""
2940 GOTO 2020
2950 REM "Carton labels
2952 IF POS(A$(12,1)="IC")=0 THEN GOTO 2020
2954 REM ABS(C0)<>2 THEN GOTO 02020
2960 PRINT @(27,10),A$(130,1); CALL "ZZENTR","N&",A{ALL},A$,X4$,X3$,22,10,8,300,C0,M4$(1,3),"{3"+X$,"","FS2DAB38","","",""
2965 IF P4$(169,1)<>"Y" OR A[8]=0 THEN GOTO 2020
2970 X$="Enter the carton label flexible format code to use"
2975 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,27,10,130,1,C0,"","{3"+X$,"FORMATCL","FS2DAB88","FFA","",""; IF C0=6 THEN GOSUB 6400; C0=1
2980 IF A$(130,1)<>" " THEN FIND (Z[13],KEY="FORMATCL"+A$(130,1),DOM=2975)
2990 IF P4$(252,1)="Y" THEN GOTO 3650 ELSE GOTO 2020
3000 REM "Special Code Entry
3010 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,8,6,23,10,C0,"","{3"+X$,"X","FS2DAB08","13FMPX","FS2MCA",""; IF C0=6 THEN GOSUB 6400; C0=1
3012 IF POS(" "<>A$(23,10))=0 THEN GOTO 3010
3015 FIND (Z[8],KEY="X"+A$(23,10),DOM=3016)IOL=0380; PRINT @(25,15),H$(52,3); GOTO 3020; REM " ssp#192626
3018 A$(23,10)=""; GOTO 3010
3020 IF C0<=0 THEN GOTO 3040
3022 A$(51,40)=H$(12,40),A$(95,4)=H$(55,4),A[0]=H[0]; IF A[0]=0 THEN A[0]=1
3025 IF H$(61,1)="Y" THEN A[5]=H[1],A[7]=H[2],A[10]=A[5] ELSE A[4]=H[1],A[6]=H[2],A[10]=A[4],A0=H[0]
3027 X$=H$(52,3),A$(140,3)=X$; GOSUB 7650
3030 GOSUB 7800
3035 GOSUB 6239
3040 GOTO 2020
3050 REM "Starting number
3052 IF POS(A$(12,1)="IC")=0 THEN GOTO 2020
3055 IF A$(99,1)="Y" THEN GOTO 2020
3060 CALL "ZZENTR","RZX",A{ALL},A$,X4$,X3$,6,11,100,9,C0,"","{3"+X$,"","FS2DAB10","","",""
3070 IF C0>0 THEN A$(109,9)=STR(NUM(A$(100,9),ERR=3108)+A[1]-1:"#########")
3090 GOTO 2020
3100 REM "Ending number
3102 IF POS(A$(12,1)="IC")=0 THEN GOTO 2020
3105 IF A$(99,1)="Y" THEN GOTO 2020
3110 CALL "ZZENTR","RZ",A{ALL},A$,X4$,X3$,22,11,109,9,C0,"","{3"+X$,"","FS2DAB72","","",""
3120 IF ABS(C0)<>2 AND A$(109,9)<A$(100,9) THEN CALL "ZZPROM",".4",X3$,0,"WARNING - Ending# is less than Starting#","","",0
3140 GOTO 2020
3150 REM "Carton Pack
3155 IF POS(A$(12,1)="IC")=0 THEN GOTO 2020
3160 CALL "ZZENTR","NX",A{ALL},A$,X4$,X3$,6,10,9,600,C0,"#####0","{3"+X$,"","FS2DAB39","","",""
3170 IF C0>0 THEN GOSUB 7900
3190 GOTO 2020
3200 REM "Commission code
3204 IF B$(359,1)="R" OR A$(12,1)="M" OR S5$(33,1)="Y" THEN GOTO 2020
3205 IF MID(S5$,84,1)="Y" THEN GOTO 2020; REM " SSP# 150788
3208 IF %MSLC THEN IF TCB(88)=0 THEN GOTO 2020 ELSE GOTO 3242 ! SSP 22530
3210 X$="Commission Code"; CALL "ZZENTR","SUZ",A{ALL},A$,X4$,X3$,39,11,118,5,C0,"","{3"+X$,"","FS2DAB80","AR4","",""
3220 FIND (Z[10],KEY=A$(118,5),DOM=3210)
3240 GOTO 2020
3242 CALL "ZZPROM","MS",X3$,Z,"","","",0; ON Z GOTO 2020,3243
3243 GOSUB MULTI_COMM_KEY ! SSP 225300
3244 CALL "ARGSCM",X3$,X4$,SC_KEY$,DF_COMM$; A$(118,5)=DF_COMM$ ! SSP225300
3245 GOTO 2020 ! SSP 225300
3250 REM "Taxable?
3254 IF B$(359,1)="R" OR A$(12,1)="M" THEN GOTO 2020
3258 X$="For non-exempt customers, Y=yes, N=no, C=yes, but at 1/2 rate"
3260 CALL "ZZENTR","SUR",A{ALL},A$,X4$,X3$,52,11,123,1,C0,"","{3"+X$,"YNC","FS2DAB82","","",""
3290 GOTO 2020
3300 REM "List Price
3305 IF P4$(155,1)<>"Y" OR A$(91,1)="9" OR A$(12,1)="M" THEN GOTO 2020
3308 X$="List Price"
3310 PRECISION M6[1]; CALL "ZZENTR","NX",A{ALL},A$,X4$,X3$,55,11,10,M6[0],C0,M6$,"{3"+X$,"","FS2DAB84","","",""; PRECISION 2
3320 IF C0>0 THEN GOSUB 7848
3340 GOTO 2020
3350 REM "Line Item Disc%
3355 IF P4$(155,1)<>"Y" OR A$(91,1)="9" OR A$(12,1)="M" THEN GOTO 2020
3358 X$="Line Item Disc% that applies to List Price"
3360 CALL "ZZENTR","NX",A{ALL},A$,X4$,X3$,72,11,11,320,C0,M1$(5),"{3"+X$,"","FS2DAB86","","",""
3370 IF C0>0 THEN GOSUB 7848
3390 GOTO 2020
3400 REM "Fixed Price
3402 IF A$(12,1)="M" OR A$(91,1)="9" THEN GOTO 2020
3405 X$="Fixed Price?"
3410 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,39,10,124,1,C0,"","{3"+X$,"","FS2DAB84","","",""
3440 GOTO 2020
3450 REM "Print On
3455 X$="P=packing list, I=invoice, S=sales order"
3460 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,25,13,125,5,C0,"","{3"+X$,"","FS2DAB86","","",""
3470 FOR I=0 TO 4; IF POS(A$(125+I,1)="SIP ")=0 THEN EXITTO 3460 ELSE NEXT I
3490 GOTO 2020
3500 REM "Cost center
3505 IF P4$(182,1)<>"Y" THEN GOTO 2020
3510 CALL "ZZENTR","AXU",A{ALL},A$,X4$,X3$,25,14,131,9,C0,"FM"+P5$(235,1),"{3"+X$,"","FS2DAB08","","",""; IF C0=6 THEN GOSUB 6400; C0=1
3515 GOSUB 6950; IF MID(A$,131,9)<>MID(S$,1,9) THEN IF MID(J2$,1,1)="1" THEN CALL "ZZPROM",".4",X3$,0,"Cost center is invalid","","",0; GOTO 3510 ELSE IF MID(J2$,2,1)="2" THEN CALL "ZZPROM",".4",X3$,0,"Department code is invalid","","",0; GOTO 3510
3540 GOTO 2020
3550 REM "Product Code
3555 IF A$(12,1)="M" THEN GOTO 2020
3557 X$="Must have product code"
3560 CALL "ZZENTR","SUZ",A{ALL},A$,X4$,X3$,25,15,140,3,C0,"","{3"+X$,"T","FS2DAB90","FMPP","",""; IF C0=6 THEN GOSUB 6400; C0=1
3570 FIND (Z[8],KEY="T"+A$(140,3),DOM=3560)H8$
3572 GOSUB 8500; REM SSP 199045
3580 PRINT @(29,15),H8$(5,15),
3585 IF H8$(22,1)="N" AND A[8]<>0 THEN A[8]=0; GOSUB 6239
3590 GOTO 2020
3600 REM "Customer's Item Code (CIC)
3605 X$="Press Enter to skip -or- Enter Customer's Item Code (Lookup available)"
3610 DIM TEMP$(20); CALL "ZZENTR","SU",A{ALL},TEMP$,X4$,X3$,8,6,1,20,C0,"","{3"+X$,B$(21,10),"FS2DAB09","13FT1","",""; IF C0=6 THEN A$(23,10)=TEMP$; GOSUB 6400; C0=1; GOTO 2211
3615 IF POS(" "<>TEMP$)=0 THEN X$="Enter Item Code"; GOTO 2210
3620 CALL "FS2DAK",X3$,X4$,1,B$(21,10),"",TEMP$,TEMP1$
3625 IF POS(" "<>TEMP1$)=0 THEN GOTO 3610
3630 A$(23,10)=TEMP1$,C0=1; PRINT @(8,6),DIM(20),@(8,6),A$(23,10), ! SSP#216184
3640 GOTO 2211
3650 REM "2nd set of Carton Labels
3655 X$="Enter number of labels for 2nd Carton Label"; PRINT @(27,10),A$(144,1),
3660 CALL "ZZENTR","N&",A{ALL},A$,X4$,X3$,22,10,12,300,C0,M4$(1,3),"{3"+X$,"","FS2DAB38","","",""
3670 X$="Enter the 2nd carton label flexible format code to use"
3680 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,27,10,144,1,C0,"","{3"+X$,"FORMATCL","FS2DAB88","FFA","",""; IF C0=6 THEN GOSUB 6400; C0=1
3685 IF A$(144,1)<>" " THEN FIND (Z[13],KEY="FORMATCL"+A$(144,1),DOM=3680)
3690 GOTO 2020
3700 REM "Special Shipping?
3705 IF A$(12,1)="M" THEN GOTO 2020
3710 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,25,16,145,1,C0,"","{3"+X$,"","FS2DAB90","","",""; IF C0=6 THEN GOSUB 6400; C0=1
3740 GOTO 2020
4100 REM "Dolots, and balance to amount shipped.
4110 X$=A$(13,20)+A$(91,4)+A$(1,11); S1$=A$(95,4)
4115 READ (Z[9],KEY=X$(1,24),DOM=4116)
4120 K$=KEY(Z[9],END=4190); IF K$(1,24)<>X$(1,24) THEN Q0=0,S1=0; GOSUB 8850; GOTO 4190; REM "SSP#119306
4125 Q0=0,F9$=""; IF A[2]=0 AND POS(P3$(52,1)="ABO")<>0 THEN Q0=A[1],F9$=P3$(52,1)
4130 S1=0; CALL "IC2LCA",X3$,X4$,F9$,13,X$,Q0,C,F,S1,S1$,S2,S3$,S3,S4
4132 IF P4$(261,1)="Y" AND F<>0 THEN A[13]=F; CALL "ZZPROM",".4",X3$,0,"Lot Freight Automatically added is: "+STR(F:"$####.00-"),"","",0; GOTO 4136; REM "WO92395
4135 IF P4$(193,1)="Y" AND F<>0 THEN CALL "ZZPROM",".4",X3$,0,"Total Freight on Lots Selected is: "+STR(F:"$####.00-"),"","",0
4140 IF FNS$(S3$(9,3))>"" THEN A$(140,3)=S3$(9,3),X$=A$(140,3); GOSUB 7650
4145 IF FNS$(S3$(12,5))>"" THEN A$(118,5)=S3$(12,5); PRINT @(39,11),A$(118,5),
4150 IF %MSLC THEN IF FNS$(S3$(12,5))>"" THEN GOSUB MULTI_COMM_KEY; CALL "ARGSCM;DEFAULT_LOT_SETUP",SC_KEY$,S3$(12,5) ! SSP 225300
4170 IF Q0=-1 THEN Q0=0; GOTO 4190
4180 A[2]=Q0; IF A[1]=0 THEN A[1]=A[2]; REM "SSP#126306
4181 A[3]=A[1]-A[2]; IF A[3]<0 THEN A[3]=0; REM SSP 213585
4182 CALL "UPDICF;GET_PRICE_CLASS",ERR=*NEXT,Z[17],Z[13],X3$,X$,LOT_PRICE_CLASS$; IF LOT_PRICE_CLASS$<>DIM(3) THEN S1=0; PRICE_CLASS$=LOT_PRICE_CLASS$; GOSUB 8600
4185 GOSUB 4200; GOSUB 7850
4190 X$=""; RETURN 
4200 REM "Set unit cost into A(6) from total cost of lots C
4205 IF A$(91,1)="9" THEN GOTO 4245
4206 REM "IF P4$(254,1)<>"Y" THEN GOTO 04245,THIS PARAMETER SHOULD ONLY HAVE TO DO WITH THE SELL PRICE NOT THE COST FROM THE LOT
4210 CALL "FM2EXT",Z[13],1,A$(95,4),A[0],Q0,U,C,M6[1]
4220 A[6]=U
4245 RETURN 
4250 REM "If price changed then ask to use new price
4255 IF S1=0 THEN GOTO 4290
4257 IF A$(91,1)="9" AND P4$(259,1)="Y" THEN GOTO 4290; REM "ssp#91464
4260 IF A$(95,4)=S1$ AND A[0]=S2 THEN IF A$(91,1)="9" THEN GOTO 4290 ELSE IF DONT_MOD$<>"Y" THEN A[4]=S1; GOTO 4285
4265 A$(95,4)=S1$,A[0]=S2; IF A$(91,1)<>"9" AND DONT_MOD$<>"Y" THEN A[4]=S1,A[10]=A[4]
4268 IF EOM0>0 THEN A[0]=EOM0,EOM0=0; REM "SSP# 096315 cwj 5/7/98
4270 CALL "FM2EXT",Z[13],0,A$(95,4),A[0],A[1],A[4],E,M6[1]; A[5]=E
4280 GOSUB 7800
4285 GOSUB 7850
4295 RETURN 
4300 REM "Gold Bond calculations
4305 IF GB$<>"" THEN IF B$(391,1)="Y" THEN A[2]=A[1] ELSE A[2]=A[1]*(100+NUM(GB$(87,6)))/100 END_IF ; GOTO 4185
4315 GOSUB 4200; GOSUB 7850
4345 RETURN 
4500 REM "Handle returns
4502 Q0$=A$(13,20)+A$(91,4)+A$(1,8)+A$(9,3); CALL "IC2LCA",X3$,"","D",0,Q0$,0; REM "In case they changed a + to -.
4505 Q0$="ICN"+A$(1,8)+A$(9,3)
4510 Q1$=A$(13,20)+A$(91,4)+"      "+"              "
4515 PRINT @(0,3),'CE',
4520 Z$="01C FS2...  02C FS1...  "; GOSUB 9750; CALL "IC2LAB",X3$,X4$,Q0$,Q1$; Z$="01O FS2...  02O FS1...  "; GOSUB 9750
4525 C=0,C=NUM(Q1$,ERR=4526)
4530 Q0=0,Q0=NUM(Q0$,ERR=4531)
4535 GOSUB 4200
4536 IF U>0 THEN A[6]=U
4537 A[5]=A[1]/D9*A[4]/D8,A[7]=A[1]/D9*A[6]/D8
4540 A[2]=-Q0,Q1$=""
4550 PRINT @(0,3),'CE',; GOSUB 6400; GOSUB 6200
4595 RETURN 
4600 REM 
4605 IF POS(A$(12,1)="IC")=0 OR A[1]<0 THEN GOTO 4640; REM "mod cwj 7/9/98 ssp#100011
4610 IF A[1]>Q9 OR A[2]>Q9 AND GB$="" THEN IF S5$(41,1)<>"Y" THEN CALL "ZZPROM",".4",X3$,0,"|WARNING - The quantity ordered exceeds the available quantity for this location","","",0; IF P4$(249,1)="Y" THEN CALL "FS2DAL",X3$,X4$,A$(13,20),B$(109,4),B0$(6,10) END_IF ELSE CALL "ZZPROM",".4",X3$,0,"Line will be deleted since qty ordered exeeds available qty for this location!!","","",0; EXITTO 6500
4620 IF P4$(243,1)<>"N" THEN IF A[1]>Q9 OR A[2]>Q9 THEN CALL "FS2DAJ",X3$,X4$,A$(13,20),0,13; IF P4$(256,1)="N" AND Q9>0 AND A[1]<>0 AND A[3]=0 THEN A[2]=Q9,A[3]=A[1]-A[2]; GOSUB 6239
4630 IF D$(117,1)="Y" AND Q9<=0 THEN CALL "ZZPROM",".4",X3$,Z,"No inventory for this item which is set to never backorder, line will be deleted","","",0; EXITTO 6500; REM "WO105428
4640 RETURN 
5800 REM "Alt sort keys
5810 FIND (Z[3],KEY=A$(13,10),DOM=5811)IOL=0330
5811 IF POS(A$(12,1)="IC")>0 THEN FIND (Z[4],KEY=A$(13,20),DOM=5812)IOL=0340; IF D$(112,1)="Y" THEN A$(99,1)="Y"
5812 IF Z9=1 THEN RETURN 
5816 IF A$(12,1)="S" THEN FIND (Z[8],KEY="X"+A$(23,10),DOM=5817)IOL=0380
5820 FIND (Z[5],KEY="D"+S0$(1,10)+A$(91,4),DOM=5821)IOL=0350
5825 FIND (Z[13],KEY=A$(95,4),DOM=5826)IOL=0360
5827 FIND (Z[8],KEY="T"+A$(140,3),DOM=5828)H8$
5830 PRICE_CLASS$=D$(109,3); GOSUB 8600
5840 GOSUB 7800
5850 DIM G$(58),G[20]; Q9=0; FIND (Z[7],KEY=A$(13,20)+A$(91,4),DOM=5860)IOL=0370
5855 Q9=G[3]+G[4]-G[5]+G[6]-(G[7]+A[1]) ! SSP278012, since ordered amt was uncommitted when accessing existing order, add back in for this calculation of available.
5890 RETURN 
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6060 PRINT @(0,3),"Req number:",@(23,3),"Customer:",@(0,4),Z0$,@(8),"Item#",@(0,5),"Line Tp",@(19,5),"Lft-Rght Top-Botm Ply Description |From:",@(0,7),Z0$,
6070 PRINT @(0,8),"Unit",@(6,8),"Qty/Unit",@(17,8),"Ordered",@(31,8),"Shipped",@(49,8),"B/O",@(59,8),"Price",@(68,8),"Order Value",
6090 PRINT @(0,10),"Pack:",@(14),"Labels:",@(34),"FP?",@(47),"Cost",@(0,11)," St#:",@(16),"End#:",@(35),"CC:",@(47),"Tax?",@(0,12),Z0$,
6150 GOSUB 6900
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6220 PRINT @(5,6),A$(12,1),
6224 GOSUB 6300
6232 CALL "ZZDISP","A   ",A$(23,10),"ICE",X3$,"","",8,6,X4$
6236 PRINT @(19,6),A$(33,8),@(28,6),A$(41,8),@(37,6),A$(49,2),@(40,6),A$(51,40),@(60,5),A$(91,4),
6237 GOSUB 7550
6238 IF A$(12,1)="M" THEN GOTO 6290 ELSE IF A$(12,1)="S" AND H$(61,1)="Y" THEN GOTO 6240 ELSE IF D9=0 THEN D9=1
6239 IF D8<>0 AND D9<>0 THEN A[5]=A[1]/D9*A[4]/D8,A[7]=A[1]/D9*A[6]/D8
6240 PRICE=A[4],COST=A[6],TOTPRICE=A[5],TOTCOST=A[7]; IF S5$(63,1)="Y" THEN PRICE=0,COST=0,TOTPRICE=O,TOTCOST=0; REM "ADDED FOR GOLDBOND  SSP# 100164
6245 PRINT @(0,9),A$(95,4),@(6,9),A[0]:M0$,@(13),A[1]/D9:M5$,@(27),A[2]/D9:M5$,@(41),A[3]/D9:M5$,@(55),PRICE:M6$,@(67),TOTPRICE:M2$,@(6,10),A[9]:M0$,@(22,10),A[8]:M4$,@(27,10),A$(130,1),@(39,10),A$(124,1),@(55,10),COST:M6$,@(67),TOTCOST:M2$,; REM "LINE USE TO BE NUMBER 6239 MOVE TO MAKE SPACE
6250 PRINT @(6,11),A$(100,9),@(22,11),A$(109,9),@(39,11),A$(118,5),@(52,11),A$(123,1),
6260 IF P4$(155,1)="Y" THEN PRINT @(55,11),A[10]:M6$,@(72,11),A[11]:M1$(5),
6290 RETURN 
6300 CALL "ZZDISP","A   ",A$(13,10),"A/R",X3$,"","",8,5,X4$
6370 GOSUB 6950
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6447 PRINT @(0,13),'CE',; RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6464 CALL "ZZDISP","A   ",A$(1,8),"O/P",X3$,"","",12,3,X4$
6466 GOSUB 7525
6468 PRINT @(1,6),A$(9,3),
6480 PRINT @(8,5),S0$(1,11),@(60,5),S0$(1,4),
6490 RETURN 
6500 REM "DELETE
6505 IF B0$(1,1)<>" " AND S5$(54,1)="Y" THEN CALL "ZZPROM",".4",X3$,0,"Access Denied!  Packing List previously printed. May not be deleted.","","",0; GOTO 1820
6507 GOSUB 8750
6509 CALL "FM2ODZ",X3$,-2,A0$,A0{ALL},B0$
6510 REMOVE (Z[1],KEY=A1$,DOM=6511)
6520 IF %MSLC THEN GOSUB MULTI_COMM_KEY; CALL "ARGSCM;DELETE_ORDER_DETAIL",SC_KEY$ ! SSP 225300
6530 IF MFF_PARM THEN CALL "FMGFV5;DELETE_FINDER_FEE_LINES",A1$ ! SSP 276772
6540 L9$=STR(NUM(A$(9,3)):"000")
6590 IF LEN(A1$)>=11 THEN A1$=A1$(1,8)+STR(NUM(A1$(9,3))-1:"000") ELSE A1$=""
6591 GOTO 1630
6600 REM "ALT KEY DATA READS
6605 EXTRACT (Z[2],KEY=A$(1,8),DOM=6606)IOL=0320
6610 READ (Z[5],KEY="C"+B$(21,10)+B$(109,4),DOM=6611)P6$
6690 RETURN 
6700 REM "ADD ENTRY
6701 IF A$(12,1)<>"M" AND A$(140,3)="   " THEN X0=28; GOTO 2040
6702 IF C9=0 THEN GOTO 6785
6704 IF A$(12,1)="C" THEN DIM F1[31]; READ (Z[11],KEY=B0$(6,10)+A$(23,10),DOM=6705)IOL=0410; IF F1[31]>0 THEN IF A[1]>F1[31] THEN CALL "ZZPROM","X0FS2DAB",X3$,Z,"","","",0; ON Z GOTO 6500,6705
6705 IF A$(12,1)="C" AND STP(F1$,3," ")="" THEN DIM F1[31]; READ (Z[11],KEY=A$(13,10)+A$(23,10),DOM=6706)IOL=0410
6706 IF P4$(240,1)="Y" THEN IF A$(12,1)="C" THEN Q$=A$(13,20)+B$(108,5); CALL "FS2DAH",X3$,Q$,A[1],I; ON I GOTO 6500,6707
6708 GOSUB 8750
6709 IF I8$>"" THEN B0$=B0$+"~"+I8$; CALL "FM2ODZ",X3$,1,A0$,A0{ALL},B0$
6710 WRITE (Z[1],KEY=A1$)IOL=0316
6788 IF GB$<>"" THEN LINE_KEY$=A1$; CALL "BM2ENT",X3$,X4$,"U",LINE_KEY$,TOTAL_COST,TOTAL_SP_COST; PRINT @(0,3),'CE',; GOSUB 6000; LINE$=A0$,ORDER$=B0$; DIM LINE[29]; FOR XX=0 TO 29; LINE[XX]=A0[XX]; NEXT XX; CALL "GB2OEL",X3$,X4$,LINE$,LINE{ALL},ORDER$,OPTION$
6789 IF A$(12,1)<>"M" AND A$(145,1)="Y" THEN ORDER_LINE$=A$(1,11); CALL "FM2ODC",X3$,X4$,"",ORDER_LINE$; PRINT @(0,3),'CE',; GOSUB 6000
6790 C9=0; IF Z=6 OR K1=0 THEN GOTO 9700 ELSE IF Z<4 THEN GOTO 1000 ELSE C0=-(3.1+(Z-4)/10); GOTO 6800
6800 REM "NEXT ENTRY IN FILE
6805 ON 10*FPT(C0)+2 GOTO 6850,6806
6810 A1$=KEY(Z[1],END=6895)
6820 IF A1$="" THEN GOTO 6800 ELSE IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 6895
6825 A$(1,LEN(A1$))=A1$
6830 GOSUB 6600
6835 GOSUB 6450
6840 GOTO 1515
6850 REM "PRIOR ENTRY
6855 CALL "ZZKEYP",ERR=6856,Z[1],A1$; GOTO 6820
6860 PRINT 'RB',; CALL "ZZKEYL",ERR=6861,Z[1],A1$; GOTO 6820
6865 GOTO 1100
6870 GOTO 6895
6890 GOTO 1515
6895 IF A1$="" THEN GOTO 6860 ELSE PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=6896)
6896 A1$=KEY(Z[1],END=1100); IF A1$(1,LEN(K9$))<>K9$ THEN A1$=K9$; GOTO 1100
6898 ON S9 GOTO 6810,1100
6900 REM 
6905 PRINT @(0,13),'CE','SB',@(9),"Print on flags:",
6910 Q$="Cost code:"; IF P5$(235,1)="A" THEN Q$="Cost center:" ELSE IF P5$(235,1)="B" THEN Q$="Department:"
6915 IF P4$(182,1)="Y" THEN IF P5$>"" THEN PRINT @(24-LEN(Q$),14),Q$,
6920 PRINT @(11,15),"Product Code:",
6925 PRINT @(7,16),"Special shipping?",
6935 PRINT 'SF',
6940 RETURN 
6950 REM 
6955 GOSUB 6900
6960 PRINT @(25,13),A$(125,5),@(25,15),A$(140,3),@(29,15),H8$(5,15),@(25,16),A$(145,1),
6965 IF P4$(182,1)="Y" THEN CALL "ZZDISP","A",A$(131,9),"FM"+P5$(235,1),X3$,"","",25,14,X4$
6970 J0$="",J5$="",J2$="12"; IF POS(P5$(235,1)="AC")>0 THEN FIND (Z[8],KEY="c"+C0$(1,10)+A$(131,4)+S0$(1,5),DOM=6971)J0$; J0$=FNS$(J0$(21,30))+", ",J2$(1,1)="" ELSE J2$(1,1)=""
6975 IF POS(P5$(235,1)="BC")>0 THEN FIND (Z[8],KEY="f"+C0$(1,10)+S0$(1,4)+A$(135,5),DOM=6976)J5$; J5$=FNS$(J5$(21,30)),J2$(2,1)="" ELSE J2$(2,1)=""
6980 PRINT @(31+5*POS("C"=P5$(235,1)),14),J0$,J5$
6990 RETURN 
7100 REM "Special case, GB mode, I8$ means we came from invoice processing, we did NOT do  a modify, SO: uncommit Bill of Materials, call BOM entry, then recommit them. Normal case happens at 6788 after modify
7105 IF GB$="" THEN GOTO 7145
7110 ORDER_LINE$=A1$; CALL "BM2ICU",X3$,X4$,-1,ORDER_LINE$
7115 LINE_KEY$=A1$; CALL "BM2ENT",X3$,X4$,"U",LINE_KEY$,TOTAL_COST,TOTAL_SP_COST
7130 ORDER_LINE$=A1$; CALL "BM2ICU",X3$,X4$,1,ORDER_LINE$
7140 PRINT @(0,3),'CE',; GOSUB 6000
7145 RETURN 
7200 REM "Forced read
7210 IF ERR<>0 THEN GOTO 9000
7220 CALL "ZZREAD",Z[1],A1$,A$,A{ALL},S8; ON S8 GOTO 7221,1630
7230 GOSUB 6200
7240 CALL "ZZPROM","E0",X3$,0,"","","",0; GOTO 7290
7250 CALL "ZZPROM","E0A",X3$,0,"","","",0; GOTO 7290
7290 GOTO 1630
7300 REM 
7310 ON FPT(C0)*10 GOTO 7390,7325,7330,7390
7325 IF V8$="" THEN X0=X0+4; GOTO 7390 ELSE X0=NUM(V8$(POS(STR(X0:"00")<=V8$,2),2)); GOTO 7390
7330 IF V8$="" THEN X0=X0-6; GOTO 7335 ELSE X0=POS(STR(X0-1:"00")<=V8$,2)-2; IF X0<0 THEN X0=0; GOTO 7390 ELSE X0=NUM(V8$(X0,2)); GOTO 7390
7335 IF X0<0 THEN X0=0; GOTO 7390
7390 IF X0>0 THEN X0=X0-0
7395 C0=3; RETURN 
7400 REM "EXTRACT
7410 EXTRACT (Z[1],ERR=7200,KEY=A1$,DOM=7440)IOL=0315
7419 GOSUB 8700
7420 C9=1,Z9=1; GOSUB 5800
7440 RETURN 
7450 REM "EXTRACT NEW ENTRY
7455 GOSUB 8750
7460 WRITE (Z[1],KEY=A1$,DOM=7250)IOL=0316; GOTO 7400
7490 RETURN 
7500 REM "Convert FS1 record and get Customer record to match req. customer
7510 GOSUB 8800
7515 READ (Z[3],KEY=B$(21,10),DOM=7516)IOL=0335
7516 DIM P5$(240); READ (Z[8],KEY="D"+B$(21,10),DOM=7517)P5$(1)
7518 CALL "FS2DAK",X3$,X4$,0,B$(21,10),CIC$
7520 RETURN 
7525 REM "Display req customer # and name
7530 CALL "ZZDISP","A",B$(21,10),"A/R",X3$,"","",33,3,X4$
7535 PRINT @(45,3),C0$(11,35),
7537 IF P4$(222,1)="Y" THEN CALL "ZZDISP","AX",C0$(220,9),"ARG",X3$,X$,"",0,0,X4$; X$=X$+"-"+C0$(11,35); PRINT @(45,3),X$(1,35),; X$=""
7540 IF POS(X3$(9,3)="049",3)>0 THEN IF NUM(C0$(398,3),ERR=8598)>0 THEN PRINT @(64,2),"Disc = ",NUM(C0$(398,3)),
7545 RETURN 
7550 REM "Print location description
7555 IF POS(" "<>E$(111,18))=0 OR A$(91,4)=S0$(1,4) THEN PRINT @(65,5),'CL',; GOTO 7590
7560 J9$=FNS$(E$(111,16))+","+E$(127,2)
7570 PRINT @(60,5),A$(91,4),@(65,5),'CL',J9$,
7595 RETURN 
7600 REM "Default based on Item number and line type
7605 IF POS(A$(12,1)="IC")=0 THEN GOTO 7700
7606 GOSUB 8150; REM "Check item master for from field
7607 IF F8$="" AND Z9=1 AND POS(" "<>A$(13,10))=0 AND POS(" "<>A$(33,10))=0 THEN FIND (Z[4],KEY=FROM_CUST$+A$(23,10),DOM=7608)IOL=0340; GOSUB 7950; GOTO 7611
7610 FIND (Z[4],KEY=A$(13,20),DOM=7640)IOL=0340
7612 REM IF D$(116,1)="Y" THEN FIND (Z(11),KEY=D$(1,20),DOM=07613) Q$; IF POS(P6$(347,20)=Q$(311,6))=0 THEN CALL "ZZPROM",".4",X3$,0,"This item may not be shipped to this location!","","",0; GOTO 07640
7615 IF D[14]=0 THEN D[14]=1
7620 A$(33,18)=D$(64),A$(51,40)=D$(21),A$(95,4)=D$(120),A[0]=D[14]
7621 IF P3$(44,1)="Y" AND D$(112,1)="Y" THEN A$(99,1)="Y",A0$(2,1)="Y" ELSE A$(99,1)=" ",A0$(2,1)=" "
7623 X$=D$(61,3),A$(140,3)=X$; GOSUB 7650
7625 GOSUB 5820
7628 A[10]=A[4],A[11]=B0[9],A[4]=A[4]-A[4]*A[11]*.01
7630 IF P4$(182,1)="Y" THEN X$=B$(21,10)+B$(109,4)+A$(13,20); CALL "FS2DAE",X3$,X4$,X$,J$; A$(131,9)=J$
7632 IF P4$(241,1)="Y" THEN X=13; CALL "FS2DAI",X3$,A$(13,20),X
7633 IF P4$(283,1)="Y" THEN CALL "FS2DAN",X3$,A$(13,20),13 ! SSP 234111
7634 GOSUB 6236; GOSUB 6950
7635 RETURN 
7640 C0=99,A$(23,10)=""
7645 RETURN 
7650 REM "Does P/C Tax o'ride? / Comm Code by PC?
7651 A0$(249,1)=D$(119,1); REM SSP 201823 hold on to original tax type from item record
7660 FIND (Z[8],KEY="T"+X$,DOM=7690)X$; H8$=X$
7670 IF A$(123,1)="Y" AND POS(X$(23,1)="Y ")=0 THEN A$(123,1)=X$(23,1); REM PRINT @(52,11),A$(123,1),
7672 IF D$(119,1)=" " THEN GOTO 7674
7673 IF D$(119,1)="E" THEN A$(123,1)="N" ELSE IF D$(119,1)="C" THEN A$(123,1)="C" ELSE IF D$(119,1)="T" THEN A$(123,1)="Y"; REM SSP 201823
7674 PRINT @(52,11),A$(123,1),; REM 
7675 IF %MSLC THEN GOSUB MULTI_COMM_KEY; CALL "ARGSCM;COMM_PROD_OVERRIDE",SC_KEY$,A$(140,3); GOTO 7690 ! SSP 225300
7678 IF ARS$(122,1)="Y" THEN FIND (Z[12],KEY=B$(88,4)+A$(140,3),DOM=7679)ASQ$; A$(118,5)=ASQ$(8,5); PRINT @(39,11),A$(118,5),; GOTO 7681; REM "WO89451 SSP 225300
7680 IF P4$(186,1)="Y" THEN IF POS(" "<>X$(38,5))>0 THEN A$(118,5)=X$(38,5); PRINT @(39,11),A$(118,5),
7690 X$=""; RETURN 
7700 REM "Default Special charge type
7745 RETURN 
7750 REM "Feature Driven Pricing
7760 X$=D$(82,10)+D$(168,20)
7770 CALL "FM2OB9",X3$,X$,A$(95,4),A[0],D$(95,4),A[0],A[1],C,U,M6[1]
7780 A[4]=U,A[6]=C
7785 IF U=0 THEN U=D[20],D[20]=C; GOSUB 8608; D[20]=U,P[0,1]=P[1,1]; GOSUB 8555; DIM P[12,1]
7790 RETURN 
7800 REM "u/m stuff
7802 D9=1,D8=1; FIND (Z[13],KEY="U/M"+A$(95,4),DOM=7845)IOL=0360
7805 IF F$(21,1)="Y" THEN A[4]=0
7810 IF F$(20,1)="Y" THEN IF F[0]<>0 THEN A[0]=F[0],D8=F[0] ELSE A[0]=F[1],D8=F[1]
7813 REM "Set divisor
7815 IF F$(20,1)="Y" OR F$(21,1)="Y" THEN D9=1 ELSE D9=A[0]
7816 IF D9=0 THEN D9=1
7817 IF D8=0 THEN D8=1
7820 IF A$(12,1)="S" AND H$(61,1)="Y" THEN GOTO 7840
7822 A[9]=D[19]; IF A[9]=0 THEN IF D9<>1 THEN A[9]=D9 ! IF A[9]=0 THEN IF D9=1 THEN A[9]=D[19] ELSE A[9]=D9!SSP#269662
7825 C=A[0],Q=A[1],U=A[4],E=A[5]
7830 SETERR 7831; IF A0<>C AND Q=0 THEN U0=U; CALL "FM2EXT",Z[13],1,A$(95,4),C,A0,U,U0,M6[1]; REM " ELSE IF E<>0 THEN CALL "FM2EXT",Z[13],1,A$(95,4),C,Q,U,E,M6[1]
7832 A[4]=U,A[5]=E,U=A[6],E=A[7]
7834 SETERR 7835; IF A0<>C AND Q=0 THEN U0=U; CALL "FM2EXT",Z[13],1,A$(95,4),C,A0,U,U0,M6[1] ELSE IF E<>0 THEN CALL "FM2EXT",Z[13],1,A$(95,4),C,Q,U,E,M6[1]
7836 A[6]=U,A[7]=E
7838 SETERR 9000
7839 A0=C
7840 GOSUB 6238
7845 RETURN 
7848 IF P4$(155,1)<>"Y" OR A[11]=0 THEN GOTO 7850 ELSE PRECISION M6[1]; IF A$(12,1)="S" AND H$(61,1)="Y" THEN A[5]=A[10]-A[10]*A[11]*.01; GOTO 7870 ELSE A[4]=A[10]-A[10]*A[11]*.01; REM "Alt entry point for line item discount
7849 PRECISION 2
7850 REM "Calculate extension
7860 A[5]=A[1]/D9*A[4]/D8,A[7]=A[1]/D9*A[6]/D8
7870 GOSUB 6239
7895 RETURN 
7900 REM "Compute carton labels
7904 IF MID(H8$,22,1)="N" THEN A[8]=0; GOTO 7841
7905 Q=A[1]; IF A[2]<>0 THEN Q=A[2]
7910 PRECISION 6
7920 IF POS(X3$(9,3)="074579",3)<>0 AND A[9]>0 THEN A[8]=INT((Q+A[9]-1)/A[9]) ELSE IF A[9]>0 THEN A[8]=INT(Q/A[9]*1.1+.9) ELSE A[8]=0 ! SSP#269662 !SSP#280226!SSP#289303
7930 IF A[8]<0 THEN A[8]=0
7940 PRECISION 2; IF X3$(65,1)>"2" THEN PRECISION NUM(X3$(65,1),ERR=7941)
7945 RETURN 
7950 REM "Change to customer specific inventory
7960 A$(13,10)=FROM_CUST$,A$(12,1)="C"
7965 PRINT @(5,6),A$(12,1),
7970 CALL "ZZDISP","A   ",A$(13,10),"A/R",X3$,"","",8,5,X4$
7980 GOSUB 8250; REM SSP#123439 PET 03/15/2000
7990 RETURN 
8000 REM "Whse availablity
8002 IF POS(A$(12,1)="IC")=0 THEN RETURN 
8005 GOSUB 8475; PRINT @(0,L1-1),'CL',@(2),"Warehouse Location",@(34),"On-Hand",@(44),"Committed",@(57),"AVAILABLE",@(71),"On P/O",
8007 IF P3$(49,1)="Y" THEN PRINT @(71),"On B/O",
8010 READ (Z[7],KEY=A$(13,20),DOM=8011)
8015 READ (Z[7],END=8450)IOL=0370
8020 IF G$(1,20)<>A$(13,20) THEN GOTO 8450
8025 IF L1>20 THEN GOSUB 8450
8030 DIM E$(224); FIND (Z[5],KEY="D"+S0$(1,10)+G$(21,4),DOM=8031)IOL=0350
8032 IF P3$(49,1)="Y" THEN G[7]=G[7]-G[11],G[8]=G[11]
8035 G0=G[3]+G[4]-G[5]+G[6],G0=G0/D9
8040 PRINT @(0,L1),G$(21,4)," ",E$(16,27),@(31),FNQ$(G0,M3$),@(43),FNQ$(G[7]/D9,M3$),@(55),FNQ$(G0-G[7]/D9,M3$),@(67),FNQ$(G[8]/D9,M3$),
8050 L1=L1+1
8060 GOTO 8015
8070 REM "Contract Price from Custom Item Master
8072 IF P4$(225,1)<>"Y" OR A$(91,1)="9" THEN GOTO 8095
8075 DIM F1[31]; READ (Z[11],KEY=B0$(6,10)+A$(23,10),DOM=8095)IOL=0410
8080 IF F1$(105,1)<>"Y" OR DONT_MOD$="Y" OR F1[3]=0 OR F1[4]=0 THEN GOTO 8095; REM "208341
8085 A[4]=F1[3]*A[0]/F1[4]; IF CONTRACT$="N" THEN IF D[14]<>0 THEN A[4]=D[0]*A[0]/D[14] ! WO155894
8086 IF CONTRACT$="Y" THEN A$(124,1)="Y" ELSE IF CONTRACT$="N" THEN A$(124,1)="N"
8090 GOSUB 7848
8095 RETURN 
8100 REM "Lot Inventory - OBSOLETE
8101 X$=""; RETURN 
8150 REM "Check item master for from field and use if not blank or same as ordering customer
8155 FROM_CUST$=B$(21,10)
8160 DIM FM1$(448); READ (Z[11],KEY=FROM_CUST$+A$(23,10),DOM=8195)FM1$
8162 CONTRACT$="Y"; IF MID(P4$,304,1)="Y" AND MID(FM1$,105,1)="Y" AND MID(FM1$,380,6)<>DIM(6) AND MID(FM1$,380,6)<X3$(21,6) THEN CALL "ZZPROM",".4",X3$,0,"Warning! Contract expiration date is "+FND$(FM1$(380,6))+".","","",0; CONTRACT$="N" ! WO155894
8165 IF STP(FM1$(185,10),3," ")="" OR FM1$(185,10)=B$(21,10) THEN GOTO 8195
8170 FROM_CUST$=FM1$(185,10)
8175 IF STP(A$(13,10),3," ")="" THEN GOTO 8176 ELSE A$(13,10)=FROM_CUST$; GOSUB 6300
8195 RETURN 
8200 REM "Display pricing table
8202 IF POS(A$(12,1)="IC")=0 THEN RETURN 
8205 GOSUB 8475
8208 PRECISION M6[1]
8210 PRINT @(0,L1-1),'CL',@(6),"---",@(24),P[0,1]*A[0]/D[14]:"$"+M6$,
8215 FOR I=1 TO 6
8220 IF P[I,0]=0 THEN I=99 ELSE PRINT @(0,L1+I-1),FNQ$(P[I,0]/D9,M3$),@(12),S2$(1,13),@(25,L1+I-1),P[I,1]*A[0]/D[14]:M6$,; IF P[I+6]<>0 THEN PRINT @(40,L1+I-1),FNQ$(P[I+6,0]/D9,M3$),@(52),S2$(1,13),@(65),P[I+6,1]*A[0]/D[14]:M6$,
8225 NEXT I
8228 PRECISION 2
8230 IF P8$>"" THEN PRINT @(0,21),'CL',@(40-INT(LEN(P8$)/2)),P8$,
8240 RETURN 
8250 REM "Set line defaults
8260 A$(123,1)=B$(308,1)
8265 IF A$(12,1)<>"M" AND B$(359,1)<>"R" THEN A[11]=B0[9]
8267 I=POS(A$(12,1)=" ICNS"); IF I>0 THEN X$=P2$(32+I*5,5) ELSE X$=""
8270 C3$="*"+A$(12,1)+X3$(9,3)+B$(83,5),CCM3$=C3$; REM "Don't check P/O code, since we can't enter a DIRect ship here !SSP 225300
8275 CALL "AR2COM","DEFAULT",C3$,C{ALL},Z[13],0,0 ! SSP 225300
8277 A$(118,5)=C3$ ! SSP 225300
8280 IF %MSLC THEN GOSUB MULTI_COMM_KEY; CALL "AR2MCM","DEFAULT",CCM3$,A{ALL},Z[13],0,0,SC_KEY$,0 ! SSP 225300
8285 A$(124,1)="N"; IF U1$(1,6)="AR2EAA" AND P4$(166,1)<>"Y" THEN A$(125,5)="I" ELSE A$(125,5)="PI"; IF POS(" "<>P4$(292,5))>0 THEN A$(125,5)=P4$(292,5); REM "SSP129434
8287 IF P4$(182,1)="Y" THEN IF POS(" "<>B$(109,4))>0 THEN FIND (Z[5],KEY="C"+B$(21,10)+B$(109,4),DOM=8288)X$; IF POS(" "<>X$(236,9))>0 THEN A$(131,9)=X$(236,9)
8288 X$=""
8289 GOSUB 6950
8290 RETURN 
8300 REM "Clear record"
8320 A$(Z)=""; DIM A[13]
8325 IF P3$(44,1)="Y" AND D$(112,1)="Y" THEN A$(99,1)="Y"
8330 GOSUB 8250
8335 GOSUB 6200
8340 RETURN 
8350 REM "Check for Cust owned
8352 IF J1$="" AND P4$(153,1)="Y" AND NUM(P1$(192,3))>0 THEN J1$="0"+P1$(192,3)
8355 IF J1$="" THEN IF A$(1,2)="00" THEN J1$="0001" ELSE J1$="00"+A$(1,2); IF P4$(153,1)<>"Y" THEN J1$(3,2)="01"
8360 IF POS(" "<>A$(91,4))=0 THEN OK$="Y",A$(91,4)=J1$; IF A$(12,1)="C" OR B$(359,1)="R" THEN A$(91,1)="9" ELSE IF A$(12,1)="I" THEN A$(91,1)="0"
8365 IF OK$="Y" AND P4$(282,1)="Y" THEN WHSE$=""; CALL "FM2OLW",X3$,X4$,A$(13,20),WHSE$; IF WHSE$="" THEN GOTO 8366 ELSE A$(91,4)=WHSE$; IF B$(359,1)="R" THEN A$(91,1)="9"; REM "WO109552
8366 OK$="N"
8370 IF A$(91,1)="9" THEN FIND (Z[7],KEY=A$(13,20)+"9"+A$(92,3),DOM=8371); GOTO 8390 ELSE GOTO 8390
8380 IF B$(359,1)<>"R" THEN A$(91,1)="0"
8390 RETURN 
8400 REM "Will this qty ordered now put the item below ROP, WO105419
8404 DIM F1[31]; READ (Z[11],KEY=B0$(6,10)+A$(23,10),DOM=8505)IOL=0410
8405 IF F1[22]=0 AND F1[23]=0 THEN GOTO 8445
8410 ROP_DAYS=0; IF F1[22]>0 THEN ROP_DAYS=F1[22]/30*F1[24]; REM "ROP using ROP in days
8415 ROP_QTY=0; IF F1[23]>0 THEN ROP_QTY=F1[23]; REM "ROP quantity
8420 AVAILABLE=G[3]+G[4]-G[5]+G[6]-G[7]+G[8]
8425 BELOW_DAYS=0; IF ROP_DAYS>0 THEN BELOW_DAYS=ROP_DAYS-(AVAILABLE-A[1])
8430 BELOW_QTY=0; IF ROP_QTY>0 THEN BELOW_QTY=ROP_QTY-(AVAILABLE-A[1])
8435 IF BELOW_DAYS<=0 AND BELOW_QTY<=0 THEN GOTO 8445
8440 IF BELOW_DAYS>0 THEN AMOUNT=BELOW_DAYS,X$=" below ROP using ROP in days from the item master." ELSE AMOUNT=BELOW_QTY,X$=" below ROP using ROP quantity from the item master."
8441 IF BELOW_DAYS>0 AND BELOW_QTY>0 THEN IF BELOW_QTY>BELOW_DAYS THEN AMOUNT=BELOW_QTY,X$=" below ROP using ROP quantity from item master."
8444 CALL "ZZPROM",".4",X3$,0,STR(AMOUNT)+X$,"","",0
8445 RETURN 
8450 REM "Common EOP logic
8460 CALL "ZZPROM","4",X3$,Z,"","","",0
8470 IF L1<=20 THEN RETURN 
8475 L1=14; PRINT @(0,L1),'CE',
8490 RETURN 
8500 REM "Finder's fees for C-types-1st Cust item, 2nd-Ship From Cust, 3rd Cust
8502 IF MFF_PARM THEN GOTO 8520 ! SSP 276772
8505 IF P4$(184,1)="Y" AND POS(A$(12,1)="IC")=0 THEN GOTO 8540
8510 IF POS(" "<>A$(23,10))=0 THEN GOTO 8540
8520 X$=B$(21,10)+A0$(29,3)+A$(13,20); IF MFF_PARM THEN CALL "FS2MFF",X3$,X4$,X$,X,A1$; RETURN ELSE CALL "FS2DAF",X3$,X4$,X$,X ! SSP 276772
8530 IF X$>"" AND X<>0 THEN A0$(135,1)=X$(11,1),A0$(137,10)=X$(1,10),A0[11]=X
8540 RETURN 
8550 REM "Pick-a-Price
8552 IF POS(" "<>D$(168,20))>0 THEN GOTO 7750
8555 IF A$(91,1)="9" OR DONT_MOD$="Y" OR (S1<>0 AND A$(99,1)="Y" AND NOT(A$(143,1)="Y" AND MID(P4$,311,1)="Y")) THEN GOTO 8598 ! 185554 skip pricing if Lot sales price (S1<>0) and lot item (99,1)=Y, but not if Item price class(143,1)=Y and param P4$(311,)=Y !SSP 231471
8558 PRECISION M6[1]
8560 IF DONT_MOD$<>"Y" AND A[4]=A[10] THEN A[4]=P[0,1]*A[0]/D[14]
8561 IF P[1,0]=0 THEN GOTO 8595
8570 FOR I=1 TO 12
8580 IF ABS(A[1])<P[I,0] THEN I=99; GOTO 8590
8585 IF P[I,0]<>0 THEN A[4]=P[I,1]*A[0]/D[14]
8590 NEXT I
8595 PRECISION 2
8597 IF POS(X3$(9,3)="049500",3)>0 THEN IF NUM(C0$(398,3),ERR=8598)>0 THEN A[4]=A[4]*(100-NUM(C0$(398,3)))*.01
8598 GOSUB 8070
8599 RETURN 
8600 REM "Load Pricing Array
8601 DIM P[12,1],Q[24]
8602 IF POS(" "<>MID(D$,168,20))<>0 THEN DIM P[12,1]; P8$="Feature Driven Pricing"; RETURN 
8605 P8$="Standard pricing from item file"
8608 PRECISION M6[1]
8610 DIM P[12,1]; P[0,1]=D[0]
8620 FOR I=1 TO 6; P[I,0]=D[1+(I-1)*2],P[I,1]=D[2+(I-1)*2],P[I+6,0]=D[21+(I-1)*2],P[I+6,1]=D[22+(I-1)*2]; NEXT I
8625 IF POS(" "<>PRICE_CLASS$+C0$(398,3))>0 THEN X$="~"+PRICE_CLASS$+C0$(398,3)+D$(1,20); DIM Q[35]; CALL "IC2ICF",X3$,Z[8],X$,A[0],D[15],D[14],D[0],D[18],D[17],D[20],Q{ALL}
8626 PRECISION 2
8627 IF X$="" THEN A$(143,1)="N"; RETURN ELSE A$(143,1)="Y"
8628 IF P3$(71,1)="Y" THEN A$(143,1)="N"
8630 DIM P[12,1]; P[0,1]=Q[0]
8635 FOR I=0 TO 11
8640 P[I+1,0]=Q[I*2+1]+0,P[I+1,1]=Q[I*2+2]
8645 NEXT I
8650 P8$=">> Special"+X$(2)+" <<"
8690 RETURN 
8700 REM "Load FS2 record into FSN format
8705 A$(1,8)=A0$(147),A$(9,3)=A0$(6),A$(23,10)=A0$(19),A$(99,1)=A0$(2,1),A$(124,1)=A0$(4,1),A$(125,5)=A0$(156,5),A$(130,1)=A0$(1,1),A$(131,9)=A0$(205,9),A$(140,3)=A0$(29,3),A$(143,1)=A0$(214,1),A$(144,1)=A0$(220,1)
8710 A$(33,58)=A0$(32),A$(91,4)=A0$(10),A$(95,4)=A0$(124),A$(100,18)=A0$(104,9)+A0$(189,9),A$(145,1)=A0$(18,1),A$(146,8)=A0$(221,8)
8715 A[0]=A0[5],A[1]=A0[0],A[10]=A0[10],A[2]=A0[7],A[3]=A0[8],A[4]=A0[4],A[5]=A0[6],A[12]=A0[24],A[13]=A0[17]; REM "Added [13], lot frt, SSP94420
8720 REM IF A0$(155,1)="C" THEN LET A$(13,10)=A0$(161),A$(12,1)="I" ELSE LET A$(12,1)=A0$(155,1)
8722 A$(12,11)=A0$(155,1)+A0$(161,10),A$(123,1)=A0$(136,1),A$(118,5)=A0$(128,5)
8730 A[6]=A0[1],A[7]=A0[3],A[8]=A0[9],A[9]=A0[12],A[10]=A0[22],A[11]=A0[23]
8745 RETURN 
8750 REM "Load FSN record into FS2 format
8752 A0[1]=A[6],A0[3]=A[7],A0[9]=A[8],A0[24]=A[12]
8755 A0$(147,8)=A$(1),A0$(6,3)=A$(9),A0$(19,10)=A$(23),A0$(2,1)=A$(99,1)
8760 A0$(32,58)=A$(33),A0$(10,4)=A$(91),A0$(124,4)=A$(95),A0$(104,9)=A$(100,9),A0$(189,9)=A$(109,9),A0$(1,1)=A$(130,1),A0$(205,9)=A$(131,9),A0$(214,1)=A$(143,1),A0$(220,1)=A$(144,1),A0$(221,8)=A$(146,8)
8764 IF F1$<>"" THEN A0$(94,10)=F1$(82,10) ELSE IF POS(A$(12,1)="IC")<>0 AND STP(F1$,3)="" AND D$<>"" THEN A0$(94,10)=D$(82,10); REM "162818!SSP#277026
8765 A0[5]=A[0],A0[10]=A0[10]+A[1]-A0[0],A0[0]=A[1],A0[7]=A[2],A0[8]=A[3],A0[4]=A[4],A0[6]=A[5]
8769 A0$(155,1)=A$(12,1),A0$(161,10)=A$(13,10)
8770 A0$(4,1)=A$(124,1),A0$(14,1)="N",A0$(18,1)=A$(145,1),A0$(120,4)=A0$(124),A0$(133,1)="N",A0[2]=A0[5]
8772 A0$(156,5)=A$(125,5)
8774 REM "Set stuff from FSM (B$)
8775 A0$(136,1)=A$(123,1),A0$(128,5)=A$(118,5)
8779 REM "Set product from inventory item
8780 A0$(29,3)=A$(140,3)
8785 IF A$(91,1)<>"9" THEN GOSUB 8500
8790 IF A0$(3,1)<>"Y" THEN A0$(3,1)="N"
8792 A0[12]=A[9],A0[9]=A[8],A0[22]=A[10],A0[23]=A[11],A0[17]=A[13]; REM "Added [17], lot frt, SSP94420
8795 RETURN 
8800 REM "Load FS1 & PO3 record into FSM format
8801 REM "47,1 in FS1 record = to 'R' means this is a req, otherwise not one.
8810 K$=B0$(118,8)+S0$(1,5); FIND (Z[6],KEY=K$,DOM=8811)IOL=0390
8820 B$(1,8)=B0$(118,8),B$(9,6)=B0$(16,6),B$(15,6)=B0$(55,6),B$(21,10)=B0$(6,10),B$(298,10)=B0$(76,10),B$(308,1)=B0$(86,1)
8823 B$(31,15)=B0$(28,15),B$(81,2)=B0$(87,2),B$(83,5)=B0$(97,5),B$(88,20)=B0$(93,4)+B0$(102,16),B$(359,1)=B0$(47,1)
8825 B$(108,145)=I$(11,145),B$(263,35)=I$(175,35),B$(309,35)=I$(225,35),B$(344,15)=I$(210,15)
8830 FOR I=0 TO 4; B[I]=B0[I+1]; NEXT I
8835 B[5]=B0[9]
8845 RETURN 
8850 REM "No lot information found, add check later to not display if not lots for this item.
8851 REM "F3$ is a flag, so we don't keep displaying the message
8853 EOM0=A[0]; REM "SSP# 096315 cwj 5/7/98
8855 IF P3$(44,1)<>"Y" AND D$(112,1)<>"Y" THEN GOTO 8890
8856 IF F3$="*" THEN GOTO 8890
8860 CALL "ZZPROM",".4",X3$,Z,"There is no lot inventory entered for this location.","","",0
8890 F3$="*",A[3]=A[1]-A[2]; IF A[3]<0 THEN A[3]=0
8895 RETURN 
8905 DEF FNP$(Z9$)="("+Z9$(1,3)+") "+Z9$(4,3)+"-"+Z9$(7,4)+" Ext: "+Z9$(11,4)
8910 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
8915 DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
8920 DEF FNB$(Z9$)=X3$(214-6*NUM(Z9$),1)
8925 DEF FNS$(Z9$)=Z9$(1,POS("  "=Z9$+"  ")-1)
8930 DEF FNR$(Z9$)=Z9$(POS(" "<>Z9$))
8940 DEF FNQ$(Z,Z9$)=STR(Z:Z9$(1,POS(".00"=STR(Z:Z9$)+".00")-1))
8950 REM "Program flow logic
8960 U0$=X3$(1,6)+"PF"
8970 FIND (Z[13],KEY=U0$,DOM=8990)U0$,U1$
8975 IF U1$="" THEN RETURN 
8980 Q1=NUM(U1$(7,2)),Q1$=U1$(9,Q1),U1$=U1$(Q1+9)
8985 IF U1$(1,6)="AR2EAU" THEN I8$=U1$(9,8) ELSE I8$=""
8990 RETURN 
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9120 ON Y8 GOTO 9900,0990,9920
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9600 REM "OPTION FOR SUMMARY SCREEN
9605 OH=0; REM "WO100078
9607 IF P4$(275,1)="Y" THEN CALL "ZZPROM","X1FS2DAB",X3$,Z,"","","",0; ON Z GOTO 9610,9608,9609 ELSE GOTO 9610; REM "new prompt to go to header from lines, not if coming from A/R
9608 OH=1; GOTO 9700; REM "Chose to go to the order header from lines
9609 X$=A$(1,8); CALL "FM2NPA",X3$,X4$,"D1",X$; REM "Order notepad
9610 IF P4$(245,1)<>"Y" THEN GOTO 9700
9615 REM IF U1$(1,3)="AR2" THEN LINE_NO$="AR"; REM "Coming from invoicing or customer setup/inquiry, don't allow Order Header option from summary screen ! changed w/o 188203
9620 X$=A$(1,8); CALL "FM2ODT",X3$,X4$,LINE_NO$,X$
9623 IF LINE_NO$>"" THEN IF LINE_NO$(1,2)="GB" THEN B0$(199,2)=LINE_NO$(3,2),B0$(201,2)=LINE_NO$(5,2); GOTO 9631; REM "GB-set production department, number of addt'l copies of packing list
9625 IF LINE_NO$="OH" THEN OH=1; GOTO 9631; REM "WO100078, go back to order header
9630 IF LINE_NO$>"" THEN A$(9,3)=LINE_NO$,C0=0; GOSUB 6400; GOTO 1262
9700 REM "PROG FLOW
9701 IF P3$(50,1)="Y" AND B$(359,1)<>"R" AND I8$="" THEN CALL "FM2OA5",X3$,B0$,M6[1]
9702 DIM G3$(255),G3[4]; FIND (Z[8],KEY="D"+B$(21,10),DOM=9704)IOL=0374; REM " SSP 161760
9703 IF G3[4]<>0 THEN CALL "FM2OC5",X3$,B0$,M6[1],"YES"; REM " SSP# 161760
9704 IF I8$="" AND OH<>1 THEN CALL "FM2ODH",X3$,1,B0$,B0{ALL} ! SSP223087 jdf
9705 IF MID(B$,359,1)="R" THEN GOTO 9710 ELSE FIND (Z[3],KEY=B0$(6,10),DOM=9710)IOL=0330
9706 IF C[5]<>0 AND C[6]+C[13]-B0[6]<=C[5] AND C[6]+C[13]>C[5] THEN X$="This order puts customer over credit limit of "+STR(C[5]); CALL "ZZPROM",".4",X3$,0,X$,"","",0
9708 FF$=FID(Z[13]); IF FF$(4,6)<>"ZZPARM" THEN CLOSE (Z[13]); OPEN (Z[13])"ZZPARM"
9710 IF U1$="" THEN REMOVE (Z[13],KEY=U0$,DOM=9900); GOTO 9900
9717 IF MID(U1$,1,6)="AR2MAA" AND OH=1 THEN U1$="FS2DAA08"+A$(1,8)+U1$ ! 188203
9720 WRITE (Z[13],KEY=U0$)U0$,U1$
9725 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9727 IF U1$(1,6)="AR2EAA" THEN L0=0
9730 RUN U1$(1,6)
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9905 Y8=2
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 SETERR 9940; Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
10000 GET_PRICE:
10005 SP0_COST=A[6],COST_UM=1,PRICE_UM=1
10010 CALL "UPDSP0;GET_PRICE",ERR=*RETURN,Z[16],B0$(6,10),D$(1,20),A[4],SP0_COST,SP0_PRICE,SP0_PRICE_TYPE$,COST_UM,PRICE_UM; IF SP0_PRICE_TYPE$<>"" THEN A[4]=SP0_PRICE,A0$(235,3)=SP0_PRICE_TYPE$,PRICE=SP0_PRICE; PRINT @(55,9),PRICE:M6$ ELSE A0$(235,3)=DIM(3) ! 188067
10020 IF SP0_PRICE_TYPE$<>"" THEN {
10030 A[4]=SP0_PRICE,A0$(235,3)=SP0_PRICE_TYPE$
10035 IF D9=0 THEN D9=1
10037 IF D8=0 THEN D8=1
10040 A[5]=A[1]/D9*A[4]/D8
10060 PRINT @(55,9),A[4]:M6$,@(67),A[5]:M2$
10070  } ELSE {
10075 A0$(235,3)=DIM(3)
10080  }
10090 RETURN 
38000 MULTI_COMM_KEY:! SSP 225300
38005 ORDER$=A$(1,8),CUST_DIV$=B0$(6,2),CUST_CODE$=B0$(8,8)
38010 SC_TYPE$="O",SC_KEY1$=ORDER$,SC_KEY2$=CUST_DIV$+CUST_CODE$,SC_LINE$=A$(9,3) ! SSP 225300
38011 SC_KEY$=SC_TYPE$+SC_KEY1$+SC_KEY2$+SC_LINE$ ! SSP 225300
38012 RETURN ! RETURN
56000 REM "188067-New Pricing changes. Standard GP Percentage for a           
56002 REM "188203-When you go thru in A/R, S1 to enter a req, the F6          
56003 REM "194208-Special charges malfunctioning                              
56004 REM "190538-Item price class pricing by bin identifier.                 
56005 REM "201823-Provide the ability to set the taxable flag  by Item   
56006 REM "199045-Workorder to restrict Finder's Fees to items assigned to 
56008 REM "216184-Does not clear display of CIC code correctly 
56009 REM "213585-Packing slip showing a negative quantity
56011 REM "223087-When using Repeat order feature to enter releases.  The     
56012 REM "234111-Modify Custom Item Notes feature to allow for a blank cust  
56013 REM "269662-Account 011073 Cadence Health - update pack quantity on each
56014 REM "277026-Vendor in FS6 is wrong, due to Vendor in FS2 is wrong if no 
56015 REM "277242-In billing, getting billing problem detected message        
56016 REM "278012-Full BO line, get inventory, modify line, lots commit but   
56017 REM "276772-Multiple Finder's Fees per Customer/Item/Order Line.        
56018 REM "280226-In O/P-D1 the carton label calculation has changed. It      
56020 REM "276772-Multiple Finder's Fees per Customer/Item/Order Line.        
56021 REM "286885-Workorder quote:  Would like the warehouse restriction in   
56022 REM "289303-When entering an order, this adds 10% overrun on the reqs   
56023 REM "292036-Two orders (02-500070 and 02-500011) with items that can't  
56024 REM "307292-DBSPT-94483 Bypass operator security by divison for warehous
56025 REM "307330-DBSPT-110365 Unhook warehouse code from security by operator
56026 REM "307430-DBD-333;Add 101 to some of 288's company specfic code       
56027 REM "307462-Security by operator division restriction also restricts the
56028 REM "307463-Allow access to all warehouses even if security by operator division restriction. 
