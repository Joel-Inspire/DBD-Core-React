0010 REM "Phone number look up module <FS2DAD>
0035 REM "3.5 - 07/16/91 - 11.73
0040 REM "Copyright 1991 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 REM BEGIN ; DIM A$(200); LET A$(13,20)="0000100000INVOICE   ",A=5000; GOTO 00111
0100 SETERR 9000; SETESC 9300
0110 ENTER X3$,A$,A
0170 DEF FNS$(Z9$)=Z9$(1,POS("       "=Z9$+"       ")-1)
0210 M$="###,###,##0-"
0320 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14],B[15],B[16],B[17],B[18],B[19],B[20],B[21],B[22],B[23],B[24],B[25],B[26],B[27],B[28],B[29],B[30],B[31]
0330 IOLIST C$,C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15],C[16],C[17],C[18],C[19],C[20]
0500 REM "FILES
0505 Z=NUM(X3$(60,3)); DIM Z[Z]
0510 Z$="02O FM1...  03O IC1...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 0521,9900
0900 DIM B[31],C[20]
0910 T=-A
1000 READ (Z[2],KEY=A$(13,20),DOM=9900)IOL=0320
1020 READ (Z[3],KEY=A$(13,20),DOM=1021)
1040 READ (Z[3],END=1100)IOL=0330
1050 IF B$(1,20)<>C$(1,20) THEN GOTO 1100
1060 T=T+C[3]+C[4]-C[5]+C[6]-C[7]
1080 GOTO 1040
1100 REM 
1200 T1=B[23]; IF T1>0 AND T<T1 THEN GOTO 2000
1220 T1=INT(B[24]*12*B[22]/365); IF B[24]>0 AND B[22]>0 AND T<T1 THEN GOTO 2000
1240 GOTO 9900
2000 REM "Under Reorder Point T1
2020 CALL "ZZPROM",".4",X3$,0,"|REORDER! "+" Qty Available: "+STR(T:M$)+"  Reorder Pt: "+STR(T1:M$),"","",0
2040 GOTO 9900
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,1
9045 REM 
9050 ON Y7 GOTO 9060,9100,9190,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 BEGIN ; SETESC 9350
9950 RUN "ZMENU"
9999 END 
