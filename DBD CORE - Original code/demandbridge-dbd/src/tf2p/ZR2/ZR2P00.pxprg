0035 REM "5.2 - 12/09/03 - 11.253611 - kmc - SSP# 166626
0040 REM "Copyright 2003 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 BEGIN 
0110 BASE_PRINT_DIR$="/tmp/"
0112 BASE_ARCHIVE_DIR$="/tmp/archive/"
0114 PC_TEMP_DIR$="C:\TEMP\"
0116 READER_LOCATION$="C:\Program Files\Adobe\Acrobat 6.0\Reader\acrord32.exe"
0118 PRINTER_NAME$="\\tf2000\hp4050"
0120 DRIVER_NAME$="HP LaserJet 4050 Series PS"
0122 %WDX$="[wdx]"
0190 CMD$="< find "+BASE_PRINT_DIR$+%C$+" -name "+QUO+"*.pdf"+QUO+" -print"
0200 ! Monitor directory
0205 PRINT "Scanning: ",BASE_PRINT_DIR$+%C$
0210 OPEN (1)CMD$
0215 READ (1,END=0290)A$
0220 PRINT "Printing: ",A$
0225 GOSUB 0300
0285 GOTO 0215
0290 CLOSE (1)
0295 WAIT 2; GOTO 0200
0299 ! 
0300 ! Copy A$ and print
0305 CLOSE (2); OPEN INPUT (2,ISZ=8000)A$
0310 M=MSK(A$,"/[^/]*$"); IF M=0 THEN PDF_NAME$=A$ ELSE PDF_NAME$=MID(A$,M+1)
0315 M=MSK(A$,".*(PL)|(IN)|(PO)"); IF M<>1 THEN PDF_BASE$="" ELSE PDF_BASE$=MID(A$,1,MSL)
0320 IF FCOUNT<>0 THEN F$=PC_TEMP_DIR$+"TOPFORM"+STR(FCOUNT)+".PDF" ELSE F$=PC_TEMP_DIR$+"TOPFORM.PDF" ! use same temp file each time
0325 B=POS(BASE_PRINT_DIR$=PDF_BASE$); IF B=1 THEN ARCHIVE_PATH$=BASE_ARCHIVE_DIR$+MID(PDF_BASE$,LEN(BASE_PRINT_DIR$)+1)+DLM+PDF_NAME$ ELSE ARCHIVE_PATH$=BASE_ARCHIVE_DIR$+PDF_NAME$ ! use PDF_BASE which has group code removed and create ARCHIVE_PATH$
0330 ! Remove user name from archive path
0335 SERIAL %WDX$+F$,ERR=*PROCEED
0336 OPEN PURGE (3,ISZ=1,ERR=*NEXT)%WDX$+F$; GOTO 0338
0337 FCOUNT+=1; PRINT "Now using ",STR(FCOUNT); GOTO 0310
0340 SERIAL ARCHIVE_PATH$,ERR=*PROCEED; OPEN PURGE (4,ISZ=1)ARCHIVE_PATH$
0345 READ RECORD (2,END=*NEXT)J$; WRITE RECORD (4,SIZ=LEN(J$))J$; WRITE RECORD (3,SIZ=LEN(J$))J$; GOTO *SAME
0350 CLOSE (3); CLOSE (4)
0355 WCMD$=QUO+READER_LOCATION$+QUO+" /h /t "+F$+" "+QUO+PRINTER_NAME$+QUO+" "+QUO+DRIVER_NAME$+QUO
0360 INVOKE %WDX$+WCMD$
0365 CLOSE (2); ERASE A$,ERR=*NEXT
0395 RETURN 
9999 END 
