0035 REM "5.7 - 02/11/10 - 10.414166 - tma - SSP# 236273
0037 REM "236273-BERT report: 6932.046:   Error writing temp sort key        
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0840 GOSUB 6900
1120 A0=NUM(U9$(U+1))
1150 READ (Z[1],IND=A0)IOL=0310
6700 REM "CHECK EXIST SORT
6710 Q=0; CALL "ZZINFO",0,Q,X3$,R4,0,0,0,0,0,0,Q$+""; IF Q<0 THEN GOTO 6790 ELSE Q=-1
6720 READ (Z[13],KEY=V1$,DOM=6790)S9$,Z$,R2
6722 IF S9$<>S8$ THEN GOTO 6790 ELSE X$=""; IF R0<>R4 THEN X$="Source file has "+STR(R0)+" records, old sort has "+STR(R4)+" records."
6740 DIM Z9$(22); CALL "ZZDISP","DXS",Z$(1,6),"",X3$,Z9$,"",1,0,X4$
6750 CALL "ZZDISP","TXS",Z$(7,4),"",X3$,Z9$,"",13,0,X4$
6755 Z9$="+("+Z9$+")"
6779 PRINT @(0,21),X$,
6780 CALL "ZZPROM","S3",X3$,A,Z9$,"","",0; IF A>1 THEN GOTO 9900 ELSE Q=A-1
6795 RETURN 
6800 REM "WRITE SORT CONTROLRECORD
6870 Z$=X3$(21,6)+STR(TIM*100:"0000")
6880 WRITE (Z[13],KEY=V1$)S8$,Z$,R0
6890 RETURN 
6900 REM "Write Temp Sort
6905 Z9=10^12/2; GOSUB 6950; IF Q=0 THEN GOTO 6945 ELSE READ (Z[1],KEY="",DOM=6906)
6910 Q$=STR(U1:"00"); CALL "ZZINIT",Q$
6915 U$=KEY(Z[1],END=6945),I0=IND(Z[1]); READ (Z[1])IOL=0310
6920 GOSUB 8000; GOSUB 7500
6932 WRITE (U1,KEY=U$)
6935 R1=R1-1; IF POS("G"=FID(0))<>1 THEN IF MOD(R1,50)=0 THEN PRINT @(S9,22),R1:"##,##0",
6940 GOTO 6915
6945 GOSUB 6800; RETURN 
6950 REM "Create Temporary Sort Filt TMP
6951 Q$="TMP"+FID(0)
6955 FIND (Z[13],KEY=X3$(9,3)+"ZB2")P9$; D0=NUM(P9$(8,4))
6960 CALL "ZZINFO",Z[1],0,X3$,R0,R3,0,0,0,0,0,""; R1=R0; GOSUB 6700; ON Q+1 GOTO 6961,6975
6962 IF R1>1000 THEN Z$="+("+STR(R1)+")"; CALL "ZZPROM","S4",X3$,A,Z$,"","",0; ON A GOTO 6963,9900
6965 ERASE Q$,ERR=6966; GOTO 6965
6970 SORT Q$,U+10,R3,D0,0 ! SSP#236273
6972 CALL "ZZPROM","S2",X3$,0,S9$,"","R",0; S9=2+LEN(S9$); IF POS("G"=FID(0))<>1 THEN PRINT @(0,22),'CL',@(0),S9$,
6975 Z$="02O "+Q$+" "
6980 GOSUB 9750; ON Z0 GOTO 6981,9900
6985 U1=Z[2]
6995 RETURN 
9999 END 
