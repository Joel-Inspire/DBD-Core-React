0010 REM "Determine Data Elements for Database <ZA2BU9>
0030 REM "(C) 1985-1988 Basic Ideas, Inc; Atlanta, GA. USA
0035 REM "This software contains trade secrets and proprietary information"
0110 X0$="ZA2BU9"
1010 REM "F0$ IS DATABASE, F0 IS FILE DEVICE FOR DATA DICTIONARY
1012 REM "I0$ IS IOLIST, I1$ IS RE-GROUPING
1014 REM "I0 IS STRING OFFSET (ADDITIONAL CHARS), I1 IS ARRAY OFFSET
1020 ENTER X3$,F0$,F0,I0$,I1$
1200 REM "CHECK FILES
1205 DIM Z[NUM(X3$(60,3))]
1210 Z$="01O ZA1... 02O ZA4... "; GOSUB 9750
1400 REM "
1800 REM "
2000 REM "
2005 I0=1,I1=0,I2=0,I3=0,I9=0,N1=-1,C0$=CHR(ASC("A")+F0-1),I0$="IOLIST"
2010 READ (Z[2],KEY=F0$,DOM=2011)
2020 F$=KEY(Z[2],END=2900); IF F$(1,20)<>F0$(1,20) THEN GOTO 2900 ELSE READ (Z[2])
2030 READ (Z[1],KEY=F$(1,20)+F$(27,20))G$
2031 IF POS(G$(81,1)=" *")>0 OR POS("F"=G$(82,5))>0 THEN GOTO 2020
2032 N0=N1,N1=POS(G$(81,1)="N")
2035 I8=NUM(G$(87,3)); IF I9<>I8 THEN GOSUB 4000
2050 ON N1 GOTO 2100,2200
2100 REM "STRING
2110 WRITE (Z[2],KEY=F$)F$,I0+I3
2120 Q=NUM(G$(90,3))+NUM(G$(93,3)); IF Q>I0 THEN I0=Q
2190 GOTO 2290
2210 I1=I1+1
2220 WRITE (Z[2],KEY=F$)F$,I1+I3
2290 GOTO 2020
2900 REM 
2910 I0$=I0$(1,LEN(I0$)-1)
2990 GOTO 9900
4000 REM "NEXT FIELD NUMBER NOT SAME AS CURRENT $
4005 IF N0>=0 THEN I2=I0; IF N0=0 THEN I0=NUM(G$(90,3))
4010 I9=I9+1; IF I9<>I8 THEN I0$=I0$+"X$,"; GOTO 4010
4020 I0$=I0$+C0$; IF N1=0 THEN I0$=I0$+"$"
4025 I0$=I0$+"("; IF N1=0 THEN I0$=I0$+STR(I0+I2)+")," ELSE I0$=I0$+STR(I1+I3)+"),"
4190 RETURN 
9120 ON Y8 GOTO 9900,0990,9920
9180 GOTO 0990
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9905 Y8=2
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9940 EXIT 
9999 END 
