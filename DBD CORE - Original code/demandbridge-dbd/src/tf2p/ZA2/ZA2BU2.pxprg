0010 REM "Return Data Element for Field Name <ZA2BU2>
0030 REM "(C) 1985-1988 Basic Ideas, Inc; Atlanta, GA. USA
0035 REM "3.5 - 03/18/92 - 15.25
0040 REM "Copyright 1992 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1010 REM "F0$ IS PATH, F1$ IS FIELD NAME, F2$=FILE ENVIRONMENT * 20
1012 REM "I0$ RETURNS DATA ELEMENT
1015 REM "IF FIELD IS A FORMULA, THE FORMULA IS RETURNED IN I1$
1020 ENTER X3$,M0$,M0,M1,F9$,F1$,F2$,I0$,I1$,A9$,E0$,E1$,E2$
1080 I0$="",I1$=""
1200 REM "CHECK FILES
1205 DIM Z[NUM(X3$(60,3))],S$(40)
1210 Z$="01O ZA1... 02O ZA4... 03O ZA5... 13O ZZPARM "; GOSUB 9750
1280 IF POS("_"=F1$)=1 THEN R0=1,F1$=F1$(2) ELSE R0=0
1400 REM 
1410 F0$=F9$; GOSUB 2000
1420 FOR X=1 TO LEN(F2$) STEP 20
1430 F0$=F2$(X,20); GOSUB 2000
1440 NEXT X
1470 GOTO 4000
1800 REM 
2000 REM "DETERMINE VARIABLE
2005 IF F0$="" THEN GOTO 4000
2010 F$=F0$(LEN(F0$)-19,20)
2015 Q$="+("+FNS$(F$)+")"
2020 F0=POS(F$=F2$,20); IF F0=0 THEN CALL "ZZPROM","X0ZA2BU2",X3$,0,Q$,"","",0; GOTO 9800
2030 F0=INT(F0/20),I0$=CHR(ASC("A")+F0)
2200 REM 
2210 IF LEN(F1$)<20 THEN F1$=F1$+S$(1,20-LEN(F1$))
2220 READ (Z[1],KEY=F$+F1$,DOM=2290)G$; GOTO 2225
2225 IF POS("F"=G$(82,5))>0 OR (G$(96,3)<>"   " AND R0=0) THEN Q$="C" ELSE Q$=" "
2230 READ (Z[2],KEY=G$(1,20)+Q$+G$(87,6)+G$(21,20))*,G
2245 IF R0=0 THEN IF G$(96,3)<>"   " THEN FIND (Z[3],KEY=G$(96,3))J$; G$(93,3)=J$(66,3),G$(81,6)=J$(60,6); G$(106,130)="@"+FNS$(J$(34,26))+"(_"+FNS$(F1$)+")"
2247 N0=POS(G$(81,1)="N"); IF N0=0 THEN I0$=I0$+"$"
2250 I0$=I0$+"("+STR(G); IF N0>0 THEN I0$=I0$+")" ELSE I0$=I0$+","+G$(93,3)+")"
2260 IF POS("F"=G$(82,5))>0 OR G$(96,3)<>"   " THEN I1$=FNS$(G$(106,130)) ELSE I1$=""
2262 IF POS("F"=G$(82,5))>0 THEN IF POS(G$(21,20)=E0$,20)=0 THEN E0$=E0$+G$(21,20)
2265 IF R0=1 THEN I1$=""
2280 EXITTO 9900
2290 RETURN 
3000 REM "CHECK OTHER PATHS
4000 REM "WORK VARIABLE
4040 CALL "ZA2BU5",ERR=4070,X3$,F1$,M0$,M0,M1,I0$,I9$,E0$,E1$,E2$
4050 GOTO 9900
4070 IF ERR<>98 THEN EXIT ERR ELSE IF M1=-1 THEN EXIT 11
4080 Z$="+("+FNS$(F$)+"^"+FNS$(F1$)+")"; CALL "ZZPROM","X0ZA2BU2",X3$,A,Z$,"","",0; ON A GOTO 9900
4090 GOTO 9900
8910 DEF FNS$(Z9$)=Z9$(1,POS(S$=Z9$+S$)-1)
9120 ON Y8 GOTO 9900,0990,9920
9180 GOTO 0990
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9905 Y8=2
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9940 EXIT 
9999 END 
