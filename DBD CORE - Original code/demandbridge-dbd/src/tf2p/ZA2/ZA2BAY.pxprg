0010 REM "Run-Time Selection Criteria Entry <ZA2BAY>
0035 REM "3.5 - 03/18/92 - 16.85
0040 REM "Copyright 1992 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1020 ENTER X3$,X4$,A1$,V8$,V8,V9,V0$,A$,A{ALL},A0,D1$,D0,D1,E0$,E1$,E2$
1025 L9=7
1040 DIM S$(40)
1090 IF POS("|"=V0$)=0 THEN GOTO 9900
1100 REM "
1190 D1$="",D0=1,D1=0
1195 P9=1
1200 REM "PROCESS SOURCE TO GET DATA
1205 IF POS(" "<>MID(V0$,P9))=0 THEN GOTO 1400
1210 P=POS("|"=V0$(P9+1)); IF P=0 THEN P=LEN(V0$(P9))-1
1220 Q$=V0$(P9+2,P-1),P9=P9+P
1230 P=POS("["=Q$); IF P=0 THEN GOTO 1200
1240 Q0$=Q$(1,P-1),Q$=Q$(P+1),P=POS(":"=Q$)
1250 DIM D0$(40)
1255 D0$(1,20)=Q$(1,P-1),Q$=Q$(P+1)
1260 X$=Q$(1,1),X=2; REM "X$ IS DATA TYPE
1270 IF POS(MID(Q$,X,1)="0123456789")>0 THEN X=X-1 ELSE X=X+1; GOTO 1270
1275 D0$(21,5)=Q$(1,X),Q$=Q$(X+1),X=1
1280 IF POS(MID(Q$,X,1)="0123456789")>0 THEN X=X+1; GOTO 1280 ELSE X=X-1
1285 D0$(26,3)=STR(NUM(Q$(1,X)):"000")
1290 Q$=Q$(X+1)
1295 IF MID(Q$,1,1)=":" THEN D0$(29)=Q$
1296 IF MID(D0$,21,1)="N" THEN D0$(31,3)=STR(D1:"000") ELSE D0$(31,3)=STR(D0:"000")
1300 D1$=D1$+D0$
1310 IF MID(D0$,21,1)="N" THEN D1=D1+1 ELSE D0=D0+NUM(D0$(26,3))
1390 GOTO 1200
1400 REM "ALL SYSTEMS GO!
1420 IF A0=0 THEN GOTO 1800
1500 REM "SETUP CONVERSION STUFF
1520 FOR X=1 TO LEN(D1$) STEP 40
1530 D0$=D1$(X,40),Q$=FNS$(D0$(1,20))
1535 X$="V"; IF MID(D0$,21,1)="N" THEN X$=X$+"("+D0$(31,3)+")" ELSE X$=X$+"$("+D0$(31,3)+","+D0$(26,3)+")"
1550 CALL "ZA2BU2",X3$,V8$,V8,V9,"",Q$,"",I9$,I$,"",E0$,E1$,E2$
1570 A1$=A1$+","+I9$+"="+X$
1580 NEXT X
1585 IF A1$>"" THEN A1$=A1$(2)
1600 REM 
1690 GOTO 9900
1900 REM "RE-DIMENTION VARIABLES?
1905 SETERR 1906; Q=A[D1]; GOTO 1910
1906 SETERR 9000; A$=""
1910 IF LEN(A$)<D0 THEN DIM A$(D0),A[10]
1930 GOSUB 6000; GOSUB 6200
1990 GOTO 2400
2000 REM "ENTER THE FIELDS
2005 X0=40,X9=1,X8=LEN(D1$)/40+1
2100 REM 
2110 X1=L9+X9-1,D0$=D1$((X9-1)*40+1,40)
2200 REM "
2210 Q$=D0$(21,5),P0=NUM(D0$(31,3)),P1=NUM(D0$(26,3)); IF MID(D0$,21,1)<>"N" THEN Q$=Q$+"^"
2215 M0$=""; IF MID(Q$,1,1)="N" THEN CALL "ZZMASK",D0$(26,3),M0$
2220 CALL "ZZENTR",Q$,A{ALL},A$,X4$,X3$,X0,X1,P0,P1,C0,M0$,"","","","","",""
2300 REM 
2310 IF ABS(C0)<>2 THEN X9=X9+1 ELSE X9=X9-1
2320 IF X9>0 AND X9<X8 THEN GOTO 2100
2400 REM 
2410 CALL "ZZPROM","0",X3$,S3,"","","",0
2415 ON S3 GOTO 2420,9800,2000
2460 GOTO 9900
6000 REM "DISPLAY BKGD
6005 L0=L9,P0=1
6006 PRINT @(0,L0),'CE',
6010 IF POS(" "<>MID(V0$,P0))=0 THEN GOTO 6090 ELSE IF MID(V0$,P0,1)<>"|" THEN P0=P0+75; GOTO 6010 ELSE P=POS("|"=V0$(P0+1))
6012 IF P=0 THEN P=LEN(V0$(P0))-1
6015 Q$=V0$(P0+1,P),P0=P0+P
6020 P=POS("["=Q$); Q$=Q$(1,P-1)
6060 PRINT @(0,L0),Q$,
6080 L0=L0+1; GOTO 6010
6095 RETURN 
6200 REM "PRINT DATA FIELDS
6210 X0=40,X9=1
6215 FOR X=1 TO LEN(D1$) STEP 40; X9=1+INT(X/40)
6220 X1=L9+X9-1,D0$=D1$((X9-1)*40+1,40)
6225 Q$=D0$(21,5)+"^",P0=NUM(D0$(31,3)),P1=NUM(D0$(26,3))
6230 X$=D0$(29,3)
6232 M0$=""; IF MID(Q$,1,1)="N" THEN CALL "ZZMASK",D0$(26,3),M0$
6235 IF MID(Q$,1,1)<>"N" THEN Z$=A$(P0,P1) ELSE Z$=STR(A[P0]:M0$)
6240 CALL "ZZDISP",Q$,Z$,X$,X3$,"","",X0,X1,X4$
6260 NEXT X
6295 RETURN 
8800 REM "ADD CODE TO REPORT
8805 W$=FNI$(W$),A0$=A0$+W$; IF MID(W$,6,1)=$F3$ THEN GOSUB 8850
8806 RETURN 
8810 REM IF LEN(W$)<80 THEN WRITE (F0) W$; RETURN  ELSE WRITE (F0) W$(1,79);LET W$=W$(1,4)+": "+W$(80); GOTO 8810
8845 RETURN 
8855 Q$="C"+STR(DEC(W$(4,2)):"0000"); READ (Z[8],KEY=Q$,DOM=8860)H$; GOTO 8865
8860 READ (Z[8])H$
8865 H$="+("+Q$(2)+", "+FNS$(H$(9))+")"
8870 CALL "ZZPROM","ERZA2BUA",X3$,A,H$,"","",0
8888 CALL "ZA2BU2",X3$,V8$,V8,V9,A1$,Q$,"",I9$,I$,"",E0$,E1$,E2$
8890 RETURN 
8895 RETURN 
8910 DEF FNS$(Z$)=Z$(1,POS(S$=Z$+S$)-1)
8915 DEF FNI$(Z$)=BIN(LEN(CPL(Z$)),3)+CPL(Z$)
9020 EXIT ERR
9940 EXIT 
9999 END 
