0010 REM "Convert ZZF Records to ZA2 Records <ZA2DZA>
0030 REM "(C) 1985-1988 Basic Ideas, Inc; Atlanta, GA. USA
0035 REM "4.4 - 05/24/00 - 14.78 - dmm - SSP# 126592
0040 REM "Copyright 2000 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 BEGIN 
0105 SETERR 9000
0110 DIM S$(20)
0115 OPEN (13)"ZZPARM"; READ (13,KEY=FID(0)+"      ")X3$
0120 PRINT 'CS'
0130 O0$=$22$+"+-/*@:.()",O1$="~_~~___~~~"
0180 INPUT "DO YOU WISH TO ENTER SELECTED FILES (S) OR ALL (A): ",X$
0185 IF X$="A" THEN R0=1 ELSE IF X$="END" OR CTL=4 THEN GOTO 9900
0200 OPEN (1)"ZZF"
0212 OPEN (2)"ZA1"
0213 OPEN (3)"ZA2"
0214 OPEN (4)"ZA0"
0215 OPEN (5)"ZZE"
0216 OPEN (6)"ZA4"
0217 OPEN (7)"ZAA"
0218 OPEN (8)"ZAB"
0220 IF R0=1 THEN READ (5,END=9900)F0$; Q$=F0$(1,6) ELSE INPUT 'LF',"ENTER THE DISK FILE NAME: ",Q$; IF Q$="" THEN GOTO 9900 ELSE Q$=Q$+"      ",Q$=Q$(1,6)
0225 READ (5,KEY=Q$,DOM=0220)F0$; PRINT 'LF',F0$(1,6)," ",F0$(7,40)
0230 INPUT "ENTER THE DATABASE NAME TO USE: ",Q1$; IF LEN(Q1$)>20 THEN GOTO 0230 ELSE IF Q1$="" THEN GOTO 0220
0240 PRINT 'LF','LF',"DISK FILE ",Q$," IS TO BE UPDATED AS: ",Q1$,
0250 INPUT 'LF','LF',"IS THIS CORRECT? (YES/NO): ",X$
0255 IF X$="NO" THEN GOTO 0200 ELSE IF X$<>"YES" THEN GOTO 0230
0400 GOSUB 4000
0500 REM 
0900 REM 
0950 GOSUB 5000
1000 READ (1,KEY=Q$,DOM=1001)
1010 READ (1,END=2000)A$
1020 IF A$(1,LEN(Q$))<>Q$ THEN GOTO 2000
1055 GOSUB 6000
1100 REM 
1120 DIM B$(328); B$(1,20)=Q1$
1130 B$(21,20)=N$
1140 B$(41,40)=A$(13,40),B$(81,6)=A$(53,3),B$(87,3)="001",B$(90,3)=A$(10,3),B$(93,3)=A$(56,3),B$(99,3)=A$(59,9),B$(236,2)=A$(57,2)
1141 L0=NUM(A$(57,2)); IF L0<6 THEN L0=6
1142 IF A$(53,1)="D" THEN L0=10 ELSE IF A$(53,1)="T" THEN L0=9 ELSE IF A$(53,1)="P" THEN L0=24
1143 IF A$(53,1)="A" THEN L0=L0+2
1145 IF A$(53,1)="N" THEN CALL "ZZMASK",A$(56,3),X$; L0=LEN(X$); B$(93,3)="",B$(102,4)="0"+A$(56,3),B$(87,3)=STR(2+NUM(A$(10,3)):"000"),B$(90,3)=""
1150 IF K0>0 THEN IF K1<K0 THEN K0$=K0$+"+"+N$,K1=K1+NUM(A$(56,3))
1155 PRINT B$(21,20)
1160 GOSUB 7000
1165 B$(236,2)=STR(L0:"00")
1170 WRITE (2,KEY=B$(1,40))B$
1180 X$=B$(1,20)+" "+B$(87,6)+B$(21,20)
1185 WRITE (6,KEY=X$)X$
1190 WRITE (7,KEY=B$(21,20)+B$(1,20))
1200 REM "ABSTRACT
1220 C$=B$(21,20)+B$(41,40)+B$(81,6)+B$(96,3)+B$(93,3)+B$(102,4)+B$(99,3)
1240 WRITE (3,KEY=C$(1,20))C$
1400 GOTO 1010
2000 REM "END OF FILE
2020 IF K0$>"" THEN GOSUB 5100
2090 IF R0=1 THEN GOTO 0220 ELSE GOTO 0220
4000 REM 
4010 READ (2,KEY=Q1$,DOM=4011)
4020 K$=KEY(2,END=4040); IF K$(1,LEN(Q1$))=Q1$ THEN REMOVE (2,KEY=K$); GOTO 4020
4090 RETURN 
5000 REM 
5010 K0$="",K0=NUM(F0$(48,2)),K1=0
5020 DIM D$(167),D[1]; D$(1,20)=Q1$
5030 D$(21,40)=F0$(7,40),D$(61,20)=F0$(1,6)
5035 IF F0$(4,3)="   " THEN D$(64,3)="..."
5040 IF F0$(47,1)="D" THEN D$(81,1)="2" ELSE IF F0$(47,1)="I" THEN D$(81,1)="0" ELSE IF F0$(47,1)="S" THEN D$(81,1)="3"
5050 D$(82,2)=F0$(48,2),D[0]=NUM(F0$(50,4),ERR=5051)
5055 GOSUB 5150
5060 RETURN 
5120 D$(92)=K0$(2)
5180 WRITE (4,KEY=D$(1,20))D$,D[0]
5185 WRITE (8,KEY=D$(61,20)+D$(1,20))
5190 RETURN 
6000 REM "STRIP OUT BAD CHARACTERS
6005 IF POS(" "<>A$(76,16))>0 THEN N$=A$(76,16); GOTO 6095; REM "SSP126592
6010 CALL "YUCASE",X3$,A$(13,30),N$; N$=FNS$(N$)
6020 FOR X=1 TO LEN(N$)
6025 Q=POS(N$(X,1)=O0$); IF Q>0 THEN N$(X,1)=O1$(Q,1)
6030 NEXT X
6040 P=POS("~"=N$); IF P>0 THEN N$=N$(1,P-1)+N$(P+1); GOTO 6040
6060 P=POS(" "=N$); IF P>0 THEN N$(P,1)="_"; GOTO 6060
6095 RETURN 
7000 REM "GET HEADINGS SETUP
7020 X$=FNS$(A$(13,40)),X=LEN(X$); IF X<L0 THEN B$(238,30)=FNC$(X$); GOTO 7180 ELSE W0=0,P0=1,W1=0
7025 IF P0>LEN(X$) THEN GOTO 7035 ELSE IF X$(P0)="" THEN GOTO 7035 ELSE P=POS(" "=X$(P0)+" "); IF P=0 THEN GOTO 7035 ELSE IF W0<3 THEN B$(238+W0*30,30)=FNC$(X$(P0,P-1))
7026 P0=P0+P,W0=W0+1; IF P>W1 THEN W1=P
7030 IF P0<LEN(X$) THEN P=POS(" "<>X$(P0)+"*"); IF P>0 THEN P0=P0+P-1; GOTO 7025 ELSE GOTO 7025
7050 W1=W1-1; IF W1>L0 THEN L0=W1
7060 REM IF W0>3 THEN ESCAPE 
7195 RETURN 
8910 DEF FNS$(X$)=X$(1,POS(S$=X$+S$)-1)
8920 DEF FNC$(X9$)=CHR(ASC(X9$)-32*SGN(INT(ASC(X9$)/97)))+X9$(2)
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9120 ON Y8 GOTO 9900,0990,9920
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9905 Y8=2
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 SETERR 9940; Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
