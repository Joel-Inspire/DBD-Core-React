0010 REM "Return Access Path based on File Environment <ZA2BU3>
0030 REM "(C) 1985-1988 Basic Ideas, Inc; Atlanta, GA. USA
0035 REM "3.6 - 04/03/92 - 10.98
0036 REM "MOD 1/11/91
0040 REM "Copyright 1992 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0220 DIM S$(75)
0330 IOLIST C$
1011 REM "F0$ IS PATH TERMINATING WITH DESIRED DATABASE, F1$ IS ENVIRONMENT
1020 ENTER X3$,M0$,M0,M1,F0$,F1$,I0$,L0,L1,E0$,E1$,E2$
1030 F2$=""; IF F1$>"" THEN FOR X=1 TO LEN(F1$) STEP 20; IF F1$(X,20)<>F0$ THEN F2$=F2$+F1$(X,20); NEXT X ELSE NEXT X
1040 IF POS("!"=I0$)=1 THEN K9$=I0$(2)
1200 REM 
1205 DIM Z[NUM(X3$(60,3))]
1210 Z$="01O ZA0... 02O ZA1... 03O ZA2... "; GOSUB 9750
2000 REM "
2010 I0$="",L1=0
2020 F$=F0$(1,20); READ (Z[1],KEY=F$)F$
2040 IF F$(92,2)="==" THEN READ (Z[1],KEY=F$(94,20))F$
2100 REM 
2110 K$=FNS$(F$(92))+" "
2120 IF K9$>"" THEN K$=K9$
2200 REM "
2210 IF K$=" " THEN GOTO 2900
2220 CALL "ZA2UAB",K$,Q9$,Q9
2225 Q9$=PAD(Q9$,20)
2230 IF Q9<4 THEN I0$=I0$+Q9$; GOTO 2200
2235 IF L0<0 THEN GOTO 2260
2240 FOR X=1 TO LEN(F1$) STEP 20; X$=F1$(X,20)
2250 CALL "ZA2BU2",ERR=2251,X3$,M0$,M0,M1,X$,Q9$,F2$,Q$,"","",E0$,E1$,E2$; EXITTO 2260
2255 NEXT X; EXIT 11
2260 I0$=I0$+Q$
2265 READ (Z[3],KEY=Q9$,DOM=*NEXT)IOL=0330; K=K+NUM(C$(70,3)),L1=L1+1
2290 GOTO 2200
2900 REM 
2920 GOTO 9900
8910 DEF FNS$(X$)=X$(1,POS(S$=X$+S$)-1)
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9900 REM "END PROGRAM
9905 Y8=2,L0=K
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9940 EXIT 
9999 END 
