0010 REM "BERT/B-Link General Information <ZA2BAA>
0035 REM "3.8 - 10/10/94 - 18.86 - jsc
0040 REM "Copyright 1994 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0110 SETERR 9000
0300 REM "IOLISTS
0310 IOLIST A$(1),D0$(1),R0$,D2$,T0$
0320 IOLIST B$,B[0],B[1]
0330 IOLIST C$,C[0],C[1]
0340 IOLIST D1$
1740 PRINT @(0,6),'CE',
1750 GOSUB 6400
1780 IF A$(60,20)=S$(1,20) THEN GOTO 2000
1800 REM "
1820 CALL "ZZPROM","6A",X3$,Z,"","","",0; ON Z GOTO 7000,2000
2000 REM "DATA SEQ
2010 C0=0,X0=0,X1=1,C9=1,A$(132,1)="1"
2020 SETERR 9000; X$="",Q$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF INT(C0)=3 THEN GOSUB 7300 ELSE IF C0>3 OR X0<0 THEN GOTO 1800
2035 IF V9<>-2 THEN IF 6*(X0+K1)+5<LEN(V9$) THEN IF V9$((X0+K1)*6+5,1)="3" THEN GOTO 2020 ELSE IF V9$((X0+K1)*6+5,1)="2" AND C0<>2 THEN GOTO 2020
2038 IF X0<LEN(V7$) THEN V7$(X0+1,1)=""
2040 ON X0 GOTO 2100,2150,2200,2250,2300,2350,2400,2450,2500,2550,3000,2600,2650,2800,2850,2900,1800
2100 REM "Report type
2102 IF X0$="ZA2BBZ" THEN A$(24,1)="T",C0=0; PRINT @(71,4),A$(24,1),; GOTO 2020
2105 X$="!04ZA2BAZ"
2110 CALL "ZZENTR","SUX",A{ALL},A$,X4$,X3$,71,4,24,1,C0,"","{3"+X$,"","ZA2BAZ04","","",""
2112 B9$=""; IF A$(24,1)="T" THEN CALL "ZB2VER",ERR=2110,"",B9$,""; IF B9$<>"BL" THEN GOTO 2110
2115 IF C0>0 THEN R0$=""; IF A$(24,1)="T" THEN R9$="ZZRPTF" ELSE R9$="ZZRPTO"
2140 GOTO 2020
2150 REM "Description
2160 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,27,6,25,35,C0,"","{3"+X$,"","ZA2BAZ06","","ZA2BAZ",""; IF C0=6 THEN GOSUB 6400; C0=1
2190 GOTO 2020
2200 REM "Primary database
2210 CALL "ZZENTR","SUXN",A{ALL},A$,X4$,X3$,27,7,60,20,C0,"","{3"+X$,"","ZA2BAZ08","ZA0","ZA2DAA","  H"; IF C0=6 THEN GOSUB 6400; C0=1
2220 IF V9<>-2 THEN FIND (Z[3],KEY=A$(60,20),DOM=2210)IOL=0330; IF C0>0 THEN GOSUB 7900; IF P<0 THEN A$(60,20)=""; GOTO 2210
2225 PRINT @(27,8),C$(21,40),
2230 IF C0>0 THEN GOSUB 7600
2240 GOTO 2020
2250 REM "Print detail?
2255 X$="!10ZA2BAZ"
2260 CALL "ZZENTR","B",A{ALL},A$,X4$,X3$,71,7,80,1,C0,"","{3"+X$,"","ZA2BAZ10","","",""
2290 GOTO 2020
2300 REM "Detail
2305 IF A$(24,1)<>"D" THEN GOTO 2020
2310 CALL "ZZENTR","SUN",A{ALL},A$,X4$,X3$,27,9,81,20,C0,"","{3"+X$,"","ZA2BAZ12","ZA0","ZA2DAA",""; IF C0=6 THEN GOSUB 6400; C0=1
2320 IF A$(81,20)<>S$(1,20) THEN FIND (Z[3],KEY=A$(81,20),DOM=2310)
2340 GOTO 2020
2350 REM "Print detail?
2355 IF POS(" "<>A$(81,20))=0 THEN GOTO 2020
2360 CALL "ZZENTR","B",A{ALL},A$,X4$,X3$,71,9,101,1,C0,"","{3"+X$,"","ZA2BAZ14","","",""
2390 GOTO 2020
2400 REM "Alternate Sort
2405 X$="!16ZA2BAZ"
2410 CALL "ZZENTR","SUXR",A{ALL},A$,X4$,X3$,27,11,102,1,C0,"","{3"+X$,"T PS","ZA2BAZ16","","",""
2420 IF C0>0 THEN IF A$(102,1)="T" THEN A$(103,20)=""; PRINT @(46,11),A$(103,20),
2440 GOTO 2020
2450 REM "Sort name
2455 IF POS(A$(102,1)="PS")=0 THEN GOTO 2020 ELSE D0=0
2460 CALL "ZZENTR","SUXN",A{ALL},A$,X4$,X3$,46,11,103,20,C0,"","{3"+X$,"","ZA2BAZ18","ZA0","",""; IF C0=6 THEN GOSUB 6400; C0=1
2462 IF A$(103,20)=S$(1,20) THEN IF A$(102,1)="P" THEN C0=2; GOTO 2490 ELSE GOTO 2470
2465 IF C0>0 THEN GOSUB 7600; ON D0 GOTO 2466,2460 ELSE IF D0=1 THEN GOTO 2460
2490 GOTO 2020
2500 REM "Label type
2505 IF POS(A$(24,1)="LFP")=0 THEN GOTO 2020
2510 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,13,13,123,1,C0,"","{3"+X$,"","ZA2BAZ20","","",""
2540 GOTO 2020
2550 REM "Width
2555 IF A$(24,1)="F" THEN GOTO 2020
2560 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,13,14,124,3,C0,"","{3"+X$,"","ZA2BAZ22","","",""
2590 GOTO 2020
2600 REM "Password
2605 X$="Leave this field BLANK for no password"
2610 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,71,13,330,6,C0,"","{3"+X$,"","ZA2BAZ38","","",""
2640 GOTO 2020
2650 REM "Access Level
2655 X$="Leave this field BLANK for no access restriction"
2660 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,71,14,336,2,C0,"","{3"+X$,"","ZA2BAZ40","","",""
2690 GOTO 2020
2800 REM "Title line 1
2805 IF A$(24,1)="F" THEN GOTO 2020
2810 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,13,16,135,65,C0,"","{3"+X$,"","ZA2BAZ32","","",""
2840 GOTO 2020
2850 REM "Title line 2
2855 IF A$(24,1)="F" THEN GOTO 2020
2860 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,13,17,200,65,C0,"","{3"+X$,"","ZA2BAZ34","","",""
2890 GOTO 2020
2900 REM "Title line 3
2905 IF A$(24,1)="F" THEN GOTO 2020
2910 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,13,18,265,65,C0,"","{3"+X$,"","ZA2BAZ36","","",""
2940 GOTO 2020
3000 REM "Options
3005 X$="U=Underline hdgs, H=Omit column hdgs, Bx =x blank lines, E=Omit Elapsd Time"
3010 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,28,14,338,15,C0,"","{3"+X$,"","ZA2BAZ22","","",""
3040 GOTO 2020
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6055 CALL "ZZDISP","-","05101215","",X3$,"","",X0,0,X4$
6060 CALL "ZZVDTP",X3$,"ZA2BAZ",X1$,"",0
6090 PRINT 'SF',
6095 RETURN 
6120 CALL "ZZVDTP",X3$,"ZA2BAA",X1$,"",0
6130 CALL "ZZDISP","-","05","",X3$,"","",X0,L0,X4$
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6220 PRINT @(71,4),A$(24,1),@(27,6),A$(25,35),@(27,7),A$(60,20),@(27,8),C$(21,40),
6224 CALL "ZZDISP","B   ",A$(80,1),"",X3$,"","",71,7,X4$
6228 PRINT @(27,9),A$(81,20),
6232 CALL "ZZDISP","B   ",A$(101,1),"",X3$,"","",71,9,X4$
6236 PRINT @(27,11),A$(102,1),@(46,11),A$(103,20),@(13,13),A$(123,1),@(71,13),A$(330,6),@(13,14),A$(124,3),@(28,14),A$(338,15),@(71,14),A$(336,2),@(13,16),A$(135,65),@(13,17),A$(200,65),@(13,18),A$(265,65),
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,1,X1,0
6420 GOSUB 6000
6430 GOSUB 6200
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6460 PRINT @(15,3),A$(1,3),@(19,3),B$(4,40),@(15,4),A$(4,20),
6465 PRINT @(71,3),A$(127,5),@(71,4),A$(24,1),
6490 RETURN 
7000 REM "DONE
7100 REM "CHECK FOR FIELDS
7105 GOTO 9900
7120 READ (Z[5],KEY=A1$,DOM=7121)
7125 K$=KEY(Z[5],END=7200); IF K$(1,LEN(A1$))<>A1$ THEN GOTO 7200
7190 GOTO 9900
7200 REM 
7220 WRITE (Z[13],KEY=FID(0)+"BERT")A1$; RUN "ZA2BAB"
7600 REM "CHANGE IN MASTERFILE OR SORT
7610 D0=1,Q$=A$(60,20); IF A$(102,1)="P" THEN Q$=A$(103,20) ELSE IF A$(102,1)="S" THEN Q$=FNS$(A$(103,20)); IF Q$="" THEN Q$="S"+A$(127,5)
7615 Q$=Q$+S$(1,20-LEN(Q$))
7620 CALL "ZA2BAF",ERR=7621,X3$,Q$,D0$; D0=0,D2$=""
7695 RETURN 
7900 REM "ACCESS LEVEL
7905 P=-1
7910 W$=C$(90,2); CALL "ZZPASW",X3$,"",C$(84,6),W$,0,0,P; IF P>=0 THEN GOTO 7995
7980 CALL "ZZPROM","S0ZA2",X3$,0,"","","",0
7995 RETURN 
8905 DEF FNS$(Z9$)=Z9$(1,POS(S$=Z9$+S$)-1)
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,"ZA2BAA",Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9120 ON Y8 GOTO 9900,0990,9920
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 GOTO 2040
9610 CALL "ZZPROM","X1ZA2BAZ",X3$,S3,"","","",0; ON S3 GOTO 9620,9800
9620 CALL "ZA2PAA",X3$,X4$,Q0$,Q1$
9630 RUN X0$
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9940 L0=1; RUN X0$
9999 END 
