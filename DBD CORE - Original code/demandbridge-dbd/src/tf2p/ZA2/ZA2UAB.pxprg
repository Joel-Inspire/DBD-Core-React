0010 REM "Parse Code String Returning Next Element <ZA2UAB>
0030 REM "(C) 1985-1988 Basic Ideas, Inc; Atlanta, GA. USA
0035 REM "4.0 - 06/25/96 - 17.02 - tma
0040 REM "Copyright 1996 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1020 ENTER Q0$,Q9$,P0
2000 REM 
3000 REM "GET NEXT ELEMENT
3002 O0$="-+*/()=><,;\",O1$="0123456789-.",O2$=O0$+" ",O4$=""
3003 O3$="~FOR~NEXT~TO~STEP~OR~AND~ELSE~IF~THEN~NUM~STR~POS~LEN~CHR~MOD~ASC~ABS~SGN~INT~EPT~DIM~DEC~BIN~"
3004 O3$=O3$+"KEY~OPEN~CLOSE~READ~WRITE~REPEAT~UNTIL~WHILE~DO~BREAK~"
3006 O3$=O3$+"CALL"+$7E$
3008 REM "P0 VALUE 1=OPERATOR, 2=STRING CONSTANT, 3=NUMERIC CONSTANT, 4=VARIABLE DATA-NAME
3009 REM "P2=VARIABLE CHECK
3010 P0=0,P=0,Q9$=""
3011 IF POS(" "=Q0$)=1 THEN Q0$=Q0$(2); GOTO 3011
3012 Q8$=Q0$
3015 IF POS("{"=Q0$)=1 THEN P=POS("}"=Q0$),P0=2; GOTO 3090
3016 IF POS($22$=Q0$)=1 THEN P=POS($22$=Q0$(2))+1,P0=2; GOTO 3090
3020 P=P+1; IF Q0$(P)="" THEN GOTO 3090 ELSE Q$=Q0$(P,1)
3022 ON P0 GOTO 3025,3090,3034,3040,3044
3025 IF P0=0 THEN IF Q$=" " THEN Q9$=Q9$(2); GOTO 3020 ELSE IF POS(Q$=$22$+"{$'")>0 THEN P0=2,O4$=Q$ ELSE IF POS(Q$=O1$)>0 THEN P0=3 ELSE IF POS(Q$=O0$)>0 THEN P0=1; GOTO 3090 ELSE IF Q$=":" THEN P0=2; GOTO 3090 ELSE P0=4
3026 GOTO 3020
3030 REM "IN PROCESS
3034 REM "STRING CONSTANT
3036 IF POS(Q$="$'"+$22$)>0 THEN GOTO 3090 ELSE GOTO 3020
3040 REM "NUMERIC CONSTANT
3042 IF POS(Q$=O1$)=0 THEN P=P-1; GOTO 3090 ELSE GOTO 3020
3044 REM "VARIABLE DATA-NAME
3046 IF POS(Q$=O2$+" ")>0 THEN P=P-1; GOTO 3090 ELSE GOTO 3020
3080 Q9$=Q9$+Q$,P=P+1
3090 Q9$=Q0$(1,P),Q0$=Q0$(P+1)
3095 IF P0=1 THEN IF Q$="\" THEN P0=5
3096 IF P0=2 THEN IF POS("{"=Q9$)=1 THEN Q9$=Q9$(2,LEN(Q9$)-2)
3100 REM 
3110 IF P0=4 THEN IF POS("~"+Q9$+"~"=O3$)>0 THEN P0=1,Q9$=" "+Q9$+" "
9900 REM 
9940 EXIT 
9999 END 
