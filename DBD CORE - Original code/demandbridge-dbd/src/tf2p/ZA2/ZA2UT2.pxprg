0010 REM "Copy/Merge Data Dictionary Files <ZA2UT2>
0020 SETESC 9300; SETERR 9000
0035 REM "5.5 - 03/05/07 - 11.746388 - mhe - SSP# 205703
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="ZA2UT2",X1$="Update Database Files"
0120 DIM Z0$(80,"-")
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0310 IOLIST A$,A[0],A[1],A[2]
0320 IOLIST B$,B[0],B[1]
0470 REM 
0475 REM "S0=0 MEANS FILES ARE ALREADY DEFINED, S0=1 MEANS THEY ARE NOT
0480 S0=0; CLOSE (14); OPEN (14,ERR=0481)"ZA0"; S0=1; CLOSE (14)
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0580 F0$="ZA0 ZA1 ZA2 ZA3mZA4 ZA5 ZAA ZAB ZAE ZAFm",F1$="ZB0mZB1mZB2mZB3m"
0600 REM 
0610 IF S0=1 THEN GOTO 0650
0615 REM "FILES NOT DEFINED
0620 CALL "ZZPROM",".Y",X3$,Z,"Do you wish to create the data dictionary & report files?","","",0; ON Z GOTO 0621,9900
0630 F9$=F0$+F1$
0640 GOTO 0700
0650 REM "FILES ALREADY DEFINED
0655 F9$=F0$
0660 CALL "ZZPROM",".X0ZA2UT2",X3$,S1,"","","",0; ON S1 GOTO 0661,0661,9900
0665 REM "S1=0 MEANS OVERWRITE FILES
0670 IF S1=0 THEN S0=0
0675 S2=0; GOTO 0685
0680 CALL "ZZPROM","YE",X3$,S2,"Should reports and libraries be updated too?","","",0; IF S2=2 THEN GOTO 9900
0685 IF S2=0 THEN F9$=F9$+F1$
0700 REM 
1000 REM "DO THE DEED
1010 PRINT @(20,5),"Processing the files..."
1020 FOR X=1 TO LEN(F9$) STEP 4
1025 PRINT @(20,7),"File: ",F9$(X,3),"  ",'CE',
1040 CLOSE (1); CLOSE (2)
1050 OPEN (1,ERR=1055)F9$(X,3)+"000"; GOTO 1100
1055 IF ERR=12 THEN CALL "ZZPROM","5",X3$,Q,"File "+F9$(X,3)+"000 is missing!","","",0; IF Q=1 THEN GOTO 9900
1060 GOTO 9000
1100 REM 
1120 IF S0=1 THEN GOTO 1200
1125 IF F9$(X+3,1)="m" THEN OPEN (2,ERR=1126)F9$(X,3); PRINT "Merged...",; GOTO 1200
1140 ERASE F9$(X,3),ERR=1141; GOTO 1140
1150 Q$=FN%FID$(1); Q$(4,6)=F9$(X,3) ! [205703]-changed FID() to FN%FID$()
1155 FILE Q$
1160 PRINT "Copied",
1200 REM "Copy/Merge FILES / UPDATE
1220 CLOSE (2); OPEN (2,ERR=1055)F9$(X,3)
1225 IF S0=1 THEN PRINT "Merged...",
1300 REM "copy file
1310 K$=KEY(1,END=1400); READ RECORD (1)A$
1315 PRINT @(20,9),"Key: ",K$,
1320 WRITE RECORD (2,KEY=K$)A$
1340 GOTO 1310
1400 REM "
1490 NEXT X
1900 REM 
1950 GOTO 5000
5000 REM 
5050 CALL "ZZPROM","4",X3$,0,"Process completed!","","",0; GOTO 9900
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 9900
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9720 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 0521,9900
9740 RETURN 
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
56000 REM + Modification History
56002 REM "205703-Oracle - FID and FIB calls, replace with FN%FID$ and FN%FIB$
