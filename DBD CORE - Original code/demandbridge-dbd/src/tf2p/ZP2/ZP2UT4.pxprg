0010 REM "Process DOS text file into T/M entries <ZP2UT4>
0035 REM "3.7 - 01/26/94 - 18.56 - kmc
0040 REM "Copyright 1994 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 BEGIN 
0105 DIM C[1],S$(20)
0150 REM 
0200 REM 
0330 IOLIST C$,C[0],C[1]
0405 C0$="002",V0$="PACS"
0410 OPEN (1)"DATAFORM"
0420 OPEN (2)"ZP4"+C0$
0430 OPEN (3)"ZP0"+C0$
0890 GOSUB 5000
0990 L0=-1
0995 DIM L0$(7*30)
1000 REM 
1020 IF A$(1,1)=$1A$ THEN GOTO 9900
1021 IF A$(1,1)=$00$ THEN GOTO 9900
1025 P=POS($0A$=A$); IF P=1 THEN A$=$0D$+A$
1035 P=POS($0D0A$=A$); IF P=0 THEN READ RECORD (1)X$; A$=A$+X$,X$=""; GOTO 1035
1040 Q$=A$(1,P-1),A$=A$(P+2),L0=4
1045 L0$(31,30)=Q$(205,20)
1050 L0$(91,30)=Q$(56,30)
1055 L0$(121,30)=Q$(87,30)
1060 L0$(61,30)=Q$(10,30)
1065 X$=FNS$(Q$(117,30)); IF X$>"" THEN GOSUB 7600
1066 X$=FNS$(Q$(149,30)); IF X$>"" THEN GOSUB 7600
1075 PRINT Q$(1,40)
1080 GOSUB 2000
1090 GOTO 1000
2000 REM "ADD TELEMARKETING CODE
2010 J0$=Q$
2020 DIM B$(374)
2030 B$(1,4)=V0$
2035 EXTRACT (3,KEY=B$(1,4))IOL=0330
2040 C[0]=C[0]+1
2045 WRITE (3)IOL=0330
2050 B$(5,6)=STR(C[0]:"000000"); FIND (2,KEY=B$(1,10),DOM=2051); GOTO 2035
2060 REM IF Q$="" THEN GOSUB 02000
2065 B$(160,20)=L0$(1,30),Q$=L0$(1,30),Q$=Q$(1,POS(S$=Q$+S$)-1)
2066 IF LEN(Q$)<=20 THEN GOTO 2080
2067 IF Q$(1,4)="Mr. " THEN Q$=Q$(5); GOTO 2079
2068 IF Q$(1,4)="Ms. " THEN Q$=Q$(5); GOTO 2079
2079 B$(160,20)=Q$
2080 B$(180,20)=L0$(31,30),B$(11,40)=L0$(61,30)
2100 REM "GET ADDRESS LINE W/ZIP
2105 B$(51,30)=L0$(91,30); IF L0>4 THEN B$(81,30)=L0$(121,30)
2160 Q$=FNS$(L0$((L0-0)*30+1,30)); IF Q$>"" THEN GOSUB 4000 ELSE L0=L0-1; GOTO 2160
2170 CALL "YUCASE","",B$(11,40),Q$
2175 B$(419,20)=Q$
2180 GOSUB 7500
2285 WRITE (2,KEY=B$(1,10))B$
2290 P=POS($0D0A$=A$); IF P=1 THEN A$=A$(3); GOTO 2290
2292 L0=-1
2295 RETURN 
4000 REM "GET CITY / STATE / ZIP FROM Q$
4005 Z$=""
4010 FOR X=LEN(Q$) TO 1 STEP -1
4015 IF Q$(X,1)=" " THEN IF Z$>"" THEN EXITTO 4081 ELSE GOTO 4080
4020 Z$=Q$(X,1)+Z$
4080 NEXT X
4081 IF LEN(Z$)>5 THEN IF Z$(6,1)="-" THEN Z$=Z$(1,5)+Z$(7)
4085 B$(129,9)=Z$,Z$=""
4100 REM "CITY
4105 P=POS(","=Q$)
4110 IF P=0 THEN GOTO 4190
4115 B$(111,16)=Q$(1,P-1),Q$=Q$(P+1)
4150 REM "STATE
4155 IF Q$(1,1)=" " THEN Q$=Q$(2); GOTO 4155
4160 B$(127,2)=Q$(1,2)
4190 RETURN 
5000 REM "GET RID OF OLD ONES
5005 INPUT 'RB',"REMOVE EXISTING ENTRIES IN LIST CODE? (YES-NO): ",Q$,; IF Q$="NO" THEN GOTO 5090 ELSE IF Q$<>"YES" THEN GOTO 5005
5010 READ (2,KEY=V0$,DOM=5011)
5020 K$=KEY(2,END=5050); READ (2); IF K$(1,4)=V0$ THEN REMOVE (2,KEY=K$); GOTO 5020
5090 PRINT 'LF','LF',
5095 RETURN 
7500 REM "PHONE NUMBER
7510 Q$=FNS$(J0$(192,13)); IF Q$="" THEN RETURN 
7520 IF POS(" "<>Q$)=0 THEN RETURN 
7535 P=POS(" "=Q$); IF P>0 THEN Q$=Q$(1,P-1)+Q$(P+1); GOTO 7535
7540 B$(200,14)=Q$
7545 RETURN 
7550 REM "DATE FIELD
7555 Q$=FNS$(J0$(226,8)); IF Q$="" THEN RETURN ELSE Q$=Q$(1,2)+Q$(4,2)+Q$(8,2)
7560 Q$=Q$(5,2)+Q$(1,4)
7565 IF Q$(1,1)="8" THEN Q$(1,1)="I" ELSE IF Q$(1,1)="9" THEN Q$(1,1)="J" ELSE ESCAPE 
7595 RETURN 
7609 P=POS("U.S.A."=X$); IF P>0 THEN X$(P,6)=""
7610 P=POS("USA"=X$); IF P>0 THEN X$(P,3)="",X$=FNS$(X$); IF X$="" THEN RETURN 
7615 IF X$(1,1)=" " THEN X$=X$(2); GOTO 7615
7616 IF X$="" THEN RETURN 
7620 Z=NUM(X$,ERR=7630)
7625 IF POS("="=X$)>0 THEN ESCAPE 
7626 IF Z<99999 THEN GOTO 7650
7629 ESCAPE 
7631 IF POS("-"=X$)>0 AND LEN(X$)=10 THEN GOTO 7650
7640 L0=L0+1; L0$(151,30)=X$
7645 RETURN 
7650 REM "ADD ZIP CODE TO LAST ADDR LINE
7655 W$=FNS$(L0$(L0*30+1,30))
7660 W$=W$+"  "+X$
7665 L0$(L0*30+1,30)=W$
7690 RETURN 
8915 DEF FNS$(Z9$)=Z9$(1,POS(S$=Z9$+S$)-1)
9920 RUN "ZMENU"
9999 END 
