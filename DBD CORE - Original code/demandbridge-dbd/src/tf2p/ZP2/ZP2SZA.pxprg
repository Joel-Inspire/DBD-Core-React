0010 REM "CONTACT SELECTION MODULE <ZP2SZA>
0035 REM "3.8 - 06/22/94 - 10.84 - kmc
0040 REM "Copyright 1994 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0590 SETESC 9300
0600 ENTER X3$,A$,A{ALL},V$,V{ALL},S0$,S1$,X9
0620 DIM S$(20)
0690 GOTO 1200
1000 REM 
1020 X9=0
1090 GOTO 9900
1200 REM "Reporting criteria
1202 REM "CATEGORY_CODE
1203 IF V$(102,3)="???" THEN IF A$(223,2)="DI" AND A$(225,1)>"0" THEN GOTO 1205; REM "CSI internal use
1204 IF POS(" "<>V$(102,3))>0 THEN IF V$(102,3)=A$(223,3) THEN GOTO 1205 ELSE P=POS("*"=V$(102,3)); IF P<2 THEN GOTO 1000 ELSE IF V$(102,P-1)=A$(223,P-1) THEN GOTO 1205 ELSE GOTO 1000
1206 REM "BAROMETER
1208 IF POS(" "<>V$(105,1))>0 THEN IF A$(358,1)>=V$(105,1) AND A$(358,1)<=V$(257,1) THEN GOTO 1209 ELSE GOTO 1000
1210 REM "FOLLOW_UP_DATE
1212 IF POS(" "<>V$(72,6))>0 THEN IF POS(" "<>A$(311,6))>0 AND A$(311,6)<=V$(72,6) THEN GOTO 1213 ELSE GOTO 1000
1214 REM "FOLLOW_UP_CODES
1216 IF POS(" "<>V$(78,16))>0 THEN IF POS(A$(317,1)=FNS$(V$(78,16)))>0 THEN GOTO 1217 ELSE GOTO 1000
1218 IF A[0]>=V[0] THEN GOTO 1219 ELSE GOTO 1000
1220 REM "SIC_CODE
1222 IF POS(" "<>V$(94,5))>0 THEN IF V$(94,5)=A$(226,5) THEN GOTO 1223 ELSE GOTO 1000
1224 REM "SOURCE_CODE
1226 IF POS(" "<>V$(99,3))>0 THEN IF V$(99,3)=A$(220,3) THEN GOTO 1227 ELSE GOTO 1000
1230 REM "SALESPERSON"
1232 IF POS(" "<>MID(V$,219,4))>0 THEN IF MID(V$,219,4)=A$(359,4) THEN GOTO 1233 ELSE GOTO 1000
1240 REM "INCLUDE - Default is 'AND' logic
1245 IF POS(" "<>V$(106,36))=0 THEN GOTO 1256 ELSE IF V$(106,3)="%OR" THEN GOTO 1500
1250 FOR X=0 TO 11; IF V$(106+X*3,3)<>"   " AND POS(V$(106+X*3,3)=A$(231,33),3)=0 THEN GOTO 1000
1255 NEXT X
1260 REM "EXCLUDE - Default is 'OR' logic
1262 IF POS(" "<>V$(142,33))=0 THEN GOTO 1266 ELSE IF V$(142,3)="%AN" THEN GOTO 1600
1265 FOR X=0 TO 11; IF V$(142+X*3,3)<>"   " AND POS(V$(142+X*3,3)=A$(231,33),3)>0 THEN EXITTO 1000 ELSE NEXT X
1270 REM "ZIP_CODE
1272 IF POS(" "<>MID(V$,223,5))>0 THEN IF MID(A$,129,5)>=V$(223,5) AND MID(A$,129,5)<=V$(228,5) THEN GOTO 1273 ELSE GOTO 1000
1275 REM "SET_UP_DATE"
1277 IF POS(" "<>MID(V$,233,6))>0 THEN IF MID(A$,214,6)>=V$(233,6) AND MID(A$,214,6)<=V$(239,6) THEN GOTO 1278 ELSE GOTO 1000
1280 REM "LAST_CONTACT_DATE"
1282 IF POS(" "<>MID(V$,245,6))>0 THEN IF MID(A$,264,6)>=V$(245,6) AND MID(A$,264,6)<=V$(251,6) THEN GOTO 1283 ELSE GOTO 1000
1300 REM "Test T/M Category set (S0$) and State set (S1$)
1309 REM "T/M Category
1310 IF S0$="" THEN GOTO 1320
1312 REM "Only those on the list
1313 IF S0$(35,1)="Y" THEN IF POS(" "<>A$(223,3))<>0 AND POS(A$(223,3)=S0$(36),9)<>0 THEN GOTO 1320 ELSE GOTO 1000
1315 REM "All but those on the list
1316 IF S0$(35,1)<>"Y" THEN IF POS(A$(223,3)=S0$(36),9)=0 THEN GOTO 1320 ELSE GOTO 1000
1319 REM "State set
1320 IF S1$="" THEN GOTO 1330
1322 REM "Only those on the list
1323 IF S1$(35,1)="Y" THEN IF POS(" "<>A$(127,2))<>0 AND POS(A$(127,2)=S1$(36),9)<>0 THEN GOTO 1330 ELSE GOTO 1000
1325 REM "All but those on the list
1326 IF S1$(35,1)<>"Y" THEN IF POS(A$(127,2)=S1$(36),9)=0 THEN GOTO 1330 ELSE GOTO 1000
1400 REM "MADE ITR THROUGH THE GAUNTLET
1420 X9=1
1450 GOTO 9900
1500 REM "OR Testing option on include"
1510 FOR X=1 TO 11
1520 IF V$(106+X*3,3)<>"   " THEN IF POS(V$(106+X*3,3)=A$(231,33),3)>0 THEN EXITTO 1260
1530 NEXT X
1540 GOTO 1000
1600 REM "AND Testing option on exclude
1620 FOR X=1 TO 11; IF V$(142+X*3,3)<>"   " AND POS(V$(142+X*3,3)=A$(231,33),3)=0 THEN EXITTO 1270 ELSE NEXT X
1640 GOTO 1000
8910 DEF FNS$(X$)=X$(1,POS(S$=X$+S$)-1)
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 1000
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 X9=-1; GOTO 9900
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 IF Y5=68 THEN RETRY ELSE ON C9 GOTO 1140,2040
9900 REM "End program
9940 EXIT 
9999 END 
