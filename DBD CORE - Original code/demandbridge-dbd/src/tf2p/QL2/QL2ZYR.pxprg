0010 REM "Initial upload of ZYR after QED conversion <QL2ZYR>
0035 REM "5.7 - 11/15/22 - 8.398808 - jvv - SSP# 307387
0037 REM "307387-EQLink DBD Bridge to Qnet                                   
0040 REM "Copyright 2022 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 BEGIN 
0100 OPEN (1)"AR1"+%C$
0110 OPEN (2)"FM1"+%C$
0120 OPEN (3)"ZYR"+%C$
0130 OPEN (4)"FM0"+%C$
0150 EXTS$="EQLINK",EXTS$=PAD(EXTS$,10),ZSTAT$="Y"
1000 NEXT_AR1:
1010 K$=KEY(1,END=9999); READ RECORD (1)AR1$
1020 IF AR1$(563,1)="Y" THEN GOTO *NEXT ELSE GOTO NEXT_AR1
1030 ETYPE$="AR1",ZYKEY$=K$,ZYDATA$=AR1$(564,6)
1040 GOSUB WRITE_ZYR
1045 GOSUB UPD_FM0
1048 GOSUB UPD_FM1
1050 GOTO NEXT_AR1
1090 ! 
1100 NEXT_FM1_EQ:
1110 K$=KEY(2,END=EXIT_UPD); READ RECORD (2)FM1$
1120 IF FM1$(198,1)="Y" THEN GOTO *NEXT ELSE GOTO NEXT_FM1_EQ
1130 ETYPE$="FM1",ZYKEY$=K$,ZYDATA$=FM1$(350,20)
1140 GOSUB WRITE_ZYR
1150 GOTO NEXT_FM1_EQ
1200 EXIT_UPD:
1250 END 
1299 ! 
1300 UPD_FM1:
1310 KFM1$=K$
1320 READ (2,KEY=KFM1$+"",DOM=*NEXT)
1325 NEXT_FM1:
1330 KF1$=KEY(2,END=EXIT_FM1); READ (2,KEY=KF1$)FM1$
1340 IF KF1$(1,LEN(KFM1$))<>KFM1$ THEN GOTO EXIT_FM1
1350 ETYPE$="FM1",ZYKEY$=K$,ZYDATA$=FM1$(350,20)
1360 GOSUB WRITE_ZYR
1370 GOTO NEXT_FM1
1380 EXIT_FM1:
1390 RETURN 
1399 ! 
1400 UPD_FM0:
1410 KFM$=K$
1420 READ (4,KEY=KFM$+"",DOM=*NEXT)
1425 NEXT_FM0:
1430 KF$=KEY(4,END=EXIT_FM0); READ (4,KEY=KF$)FM0$
1440 IF KF$(1,LEN(KFM$))<>KFM$ THEN GOTO EXIT_FM0
1450 ETYPE$="FM0",ZYKEY$=KF$,ZYDATA$=MID(FM0$,382,20)
1460 GOSUB WRITE_ZYR
1470 GOTO NEXT_FM0
1480 EXIT_FM0:
1490 RETURN 
1499 ! 
1500 WRITE_ZYR:
1520 ZYR_KEY$=ETYPE$+EXTS$+ZYKEY$
1530 WRITE (3,KEY=ZYR_KEY$)ETYPE$,EXTS$,ZYKEY$,ZYDATA$,ZSTAT$
1550 RETURN 
9999 END 
56000 REM "307387-EQLink DBD Bridge to Qnet                                   
