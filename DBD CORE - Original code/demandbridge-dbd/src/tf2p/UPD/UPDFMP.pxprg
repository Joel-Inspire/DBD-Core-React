0010 ! UPDFMP - File FMP Maintenance
0035 REM "5.5 - 02/05/07 - 10.6725 - mhe - SSP# 204600
0037 REM "204600-The numberic array used for file XPX should only have 3     
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 ! FILENO - CHANNEL OF OPEN FILE
0051 ! KEYNO  - KEY NUMBER
0052 ! SEG1-SEG5$ : KEY SEGMENTS . CAN BE NULL
0053 ! A$ - RECORD A$
0054 ! FOUND - IF RECORD FOUND, THEN 1 ELSE 0
0055 ! BUSY - IF RECORD BUSY THEN 1 ELSE 0
0056 ! OK - IF RECORD ADDED OK=1 ELSE 0
0310 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12]
0315 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5]
0320 IOLIST A$
0325 IOLIST A$,A[0],A[1],A[2],A[3] ! per FMPDR2.txt - SSP# 168612
0500 INIT:
0505 DIM Z[255]; OPENED=0
0507 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
0510 IF POS("FMP"=PTH(FILENO))=0 THEN Z$="01O FMP...  13O ZZPARM  "; CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; FILENO=Z[1],OPENED=1
0590 RETURN 
0598 ! 
0599 ! 
0600 WRAPUP:
0610 IF OPENED THEN CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0690 RETURN 
0698 ! 
0699 ! 
1700 DELETE:
1710 ENTER FILENO,A$,A{ALL},PRIMEKEY$,FOUND,BUSY
1715 FOUND=0,BUSY=1
1720 GOSUB INIT
1750 REMOVE (FILENO,KEY=PRIMEKEY$,DOM=DELETE_END,ERR=*NEXT); BUSY=0
1785 DELETE_END:
1787 GOSUB WRAPUP
1790 EXIT 
1798 ! 
1799 ! 
2000 CLEAR_LOCK:
2010 ENTER FILENO
2020 GOSUB INIT
2050 READ (FILENO,KNO=0,KEY="",ERR=*NEXT)
2080 GOSUB WRAPUP
2090 EXIT 
2098 ! 
2099 ! 
2100 READBYKEY:
2110 ENTER FILENO,KEYNO,SEG1$,SEG2$,SEG3$,SEG4$,SEG5$,A$,A{ALL},FOUND
2115 FOUND=0
2120 GOSUB INIT
2149 XP=PRM('XI'); SET_PARAM 'XI'
2200 SWITCH SEG1$
2205 CASE "D"
2210 DIM A[5]
2215 READ (FILENO,KNO=KEYNO,KEY=SEG1$+SEG2$+SEG3$+SEG4$+SEG5$,DOM=*NEXT)IOL=0315; FOUND=1
2219 BREAK
2220 CASE "S" ! ship via
2222 DIM A[1]
2225 READ (FILENO,KNO=KEYNO,KEY=SEG1$+SEG2$+SEG3$+SEG4$+SEG5$,DOM=*NEXT)IOL=0320; FOUND=1
2229 BREAK
2230 ! 
2340 CASE "X" ! Order Entry Specials - lines 2230, 2340-2350 - SSP# 168612
2342 DIM A[3]
2345 READ (FILENO,KNO=KEYNO,KEY=SEG1$+SEG2$+SEG3$+SEG4$+SEG5$,DOM=*NEXT)IOL=0325; FOUND=1
2349 BREAK
2350 ! 
2390 DEFAULT 
2392 DIM A[12]
2395 READ (FILENO,KNO=KEYNO,KEY=SEG1$+SEG2$+SEG3$+SEG4$+SEG5$,DOM=*NEXT)IOL=0310; FOUND=1
2398 BREAK
2400 END SWITCH 
2451 SET_PARAM 'XI'=XP
2480 GOSUB WRAPUP
2490 EXIT 
2498 ! 
2499 ! 
9999 END 
10000 DUPLICATE_XPR:
10001 ! FMP TABLE = FMPR_CustReqchrg
10002 ! FMP RECORD = R
10003 ! NEW FILE = XPR
10004 ! MAINT PGM = FM2SHC
10005 DIM A[4]
10010 ENTER FILENO,A$,A{ALL},TYPE$
10012 IOLIST A$,A[0],A[1],A[2],A[3],A[4]
10020 SWITCH TYPE$
10025 CASE "D"
10030 REMOVE (FILENO,KEY=A$(1,21),ERR=*NEXT)
10035 BREAK
10040 DEFAULT 
10050 WRITE (FILENO,KEY=A$(1,21))IOL=10012
10080 END SWITCH 
10090 EXIT 
10098 ! 
10099 ! 
10100 DUPLICATE_XPD:
10101 ! FMP TABLE = FMP1_CustDef
10102 ! FMP RECORD = D
10103 ! NEW FILE = XPD
10104 ! MAINT PGM = FM2SHA
10105 DIM A[6]
10110 ENTER FILENO,A$,A{ALL},TYPE$
10112 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5]
10120 SWITCH TYPE$
10125 CASE "D"
10130 REMOVE (FILENO,KEY=A$(1,11),ERR=*NEXT)
10135 BREAK
10140 DEFAULT 
10150 WRITE (FILENO,KEY=A$(1,11))IOL=10112
10160 END SWITCH 
10190 EXIT 
10198 ! 
10199 ! 
10200 DUPLICATE_XPT:
10201 ! FMP TABLE = FMP2_ProdCode
10202 ! FMP RECORD = T
10203 ! NEW FILE = XPT
10204 ! MAINT PGM = FM2SAA
10205 DIM A[2]
10210 ENTER FILENO,A$,A{ALL},TYPE$
10212 IOLIST A$,A[0],A[1]
10220 SWITCH TYPE$
10225 CASE "D"
10230 REMOVE (FILENO,KEY=A$(1,4),ERR=*NEXT)
10235 BREAK
10240 DEFAULT 
10250 WRITE (FILENO,KEY=A$(1,4))IOL=10212
10260 END SWITCH 
10290 EXIT 
10298 ! 
10299 ! 
10300 DUPLICATE_XPX:
10301 ! FMP TABLE = FMP3_OrdEntSpec
10302 ! FMP RECORD = X
10303 ! NEW FILE = XPX
10304 ! MAINT PGM = FM2MCA
10305 DIM A[3] ! [204600]
10310 ENTER FILENO,A$,A{ALL},TYPE$
10312 IOLIST A$,A[0],A[1],A[2]
10320 SWITCH TYPE$
10325 CASE "D"
10330 REMOVE (FILENO,KEY=A$(1,11),ERR=*NEXT)
10335 BREAK
10340 DEFAULT 
10350 WRITE (FILENO,KEY=A$(1,11))IOL=10312
10360 END SWITCH 
10390 EXIT 
10398 ! 
10399 ! 
10400 DUPLICATE_XPV:
10401 ! FMP TABLE = FMP4_VendStd
10402 ! FMP RECORD = V
10403 ! NEW FILE = XPT
10404 ! MAINT PGM = FM2SFA
10405 DIM A[1]
10410 ENTER FILENO,A$,A{ALL},TYPE$
10412 IOLIST A$
10420 SWITCH TYPE$
10425 CASE "D"
10430 REMOVE (FILENO,KEY=A$(1,11),ERR=*NEXT)
10435 BREAK
10440 DEFAULT 
10450 WRITE (FILENO,KEY=A$(1,11))IOL=10412
10460 END SWITCH 
10490 EXIT 
10498 ! 
10499 ! 
10500 DUPLICATE_XPQ:
10501 ! FMP TABLE = FMP5_PromoCodes
10502 ! FMP RECORD = Q
10503 ! NEW FILE = XPQ
10504 ! MAINT PGM = FM2MDA
10505 DIM A[1]
10510 ENTER FILENO,A$,A{ALL},TYPE$
10512 IOLIST A$
10520 SWITCH TYPE$
10525 CASE "D"
10530 REMOVE (FILENO,KEY=A$(1,3),ERR=*NEXT)
10535 BREAK
10540 DEFAULT 
10550 WRITE (FILENO,KEY=A$(1,3))IOL=10512
10560 END SWITCH 
10590 EXIT 
10598 ! 
10599 ! 
10600 DUPLICATE_XPA:
10601 ! FMP TABLE = FMP6_CustCont
10602 ! FMP RECORD = a
10603 ! NEW FILE = XPA
10604 ! MAINT PGM = FM2MPI
10605 DIM A[1]
10610 ENTER FILENO,A$,A{ALL},TYPE$
10612 IOLIST A$
10620 SWITCH TYPE$
10625 CASE "D"
10630 REMOVE (FILENO,KEY=A$(1,14),ERR=*NEXT)
10635 BREAK
10640 DEFAULT 
10650 WRITE (FILENO,KEY=A$(1,14))IOL=10612
10660 END SWITCH 
10690 EXIT 
10698 ! 
10699 ! 
10700 DUPLICATE_XP7:
10701 ! FMP TABLE = FMP7_CountStops
10702 ! FMP RECORD = d
10703 ! NEW FILE = XP7
10704 ! MAINT PGM = AR2MAQ
10705 DIM A[1]
10710 ENTER FILENO,A$,A{ALL},TYPE$
10712 IOLIST A$
10720 SWITCH TYPE$
10725 CASE "D"
10730 REMOVE (FILENO,KEY=A$(1,18),ERR=*NEXT)
10735 BREAK
10740 DEFAULT 
10750 WRITE (FILENO,KEY=A$(1,18))IOL=10712
10760 END SWITCH 
10790 EXIT 
10798 ! 
10799 ! 
10800 DUPLICATE_XP8:
10801 ! FMP TABLE = FMP8_ReordGroup
10802 ! FMP RECORD = G
10803 ! NEW FILE = XP8
10804 ! MAINT PGM = FM2MPG
10805 DIM A[1]
10810 ENTER FILENO,A$,A{ALL},TYPE$
10812 IOLIST A$
10820 SWITCH TYPE$
10825 CASE "D"
10830 REMOVE (FILENO,KEY=A$(1,4),ERR=*NEXT)
10835 BREAK
10840 DEFAULT 
10850 WRITE (FILENO,KEY=A$(1,4))IOL=10812
10860 END SWITCH 
10890 EXIT 
10898 ! 
10899 ! 
10900 DUPLICATE_XP9:
10901 ! FMP TABLE = FMP9_CustCostCenters
10902 ! FMP RECORD = c
10903 ! NEW FILE = XP9
10904 ! MAINT PGM = AR2MAP
10905 DIM A[1]
10910 ENTER FILENO,A$,A{ALL},TYPE$
10912 IOLIST A$
10920 SWITCH TYPE$
10925 CASE "D"
10930 REMOVE (FILENO,KEY=A$(1,20),ERR=*NEXT)
10935 BREAK
10940 DEFAULT 
10950 WRITE (FILENO,KEY=A$(1,20))IOL=10912
10960 END SWITCH 
10990 EXIT 
10998 ! 
10999 ! 
11000 DUPLICATE_XPE:
11001 ! FMP TABLE = FMPA_CustFiscYr
11002 ! FMP RECORD = E
11003 ! NEW FILE = XPE
11004 ! MAINT PGM = FM2PUE
11005 DIM A[1]
11010 ENTER FILENO,A$,A{ALL},TYPE$
11012 IOLIST A$
11020 SWITCH TYPE$
11025 CASE "D"
11030 REMOVE (FILENO,KEY=A$(1,15),ERR=*NEXT)
11035 BREAK
11040 DEFAULT 
11050 WRITE (FILENO,KEY=A$(1,15))IOL=11012
11060 END SWITCH 
11090 EXIT 
11098 ! 
11099 ! 
11100 DUPLICATE_XP4:
11101 ! FMP TABLE = FMPB_CustCategorySet
11102 ! FMP RECORD = e
11103 ! NEW FILE = XP4
11104 ! MAINT PGM = AR2FAA
11105 DIM A[1]
11110 ENTER FILENO,A$,A{ALL},TYPE$
11112 IOLIST A$
11120 SWITCH TYPE$
11125 CASE "D"
11130 REMOVE (FILENO,KEY=A$(1,4),ERR=*NEXT)
11135 BREAK
11140 DEFAULT 
11150 WRITE (FILENO,KEY=A$(1,4))IOL=11112
11160 END SWITCH 
11190 EXIT 
11198 ! 
11199 ! 
11200 DUPLICATE_XPB:
11201 ! FMP TABLE = FMPb_ArtStatFlag
11202 ! FMP RECORD = b
11203 ! NEW FILE = XPB
11204 ! MAINT PGM = FM2MPJ
11205 DIM A[1]
11210 ENTER FILENO,A$,A{ALL},TYPE$
11212 IOLIST A$
11220 SWITCH TYPE$
11225 CASE "D"
11230 REMOVE (FILENO,KEY=A$(1,2),ERR=*NEXT)
11235 BREAK
11240 DEFAULT 
11250 WRITE (FILENO,KEY=A$(1,2))IOL=11212
11260 END SWITCH 
11290 EXIT 
11298 ! 
11299 ! 
11300 DUPLICATE_XPC:
11301 ! FMP TABLE = FMPC_CustPrcCat
11302 ! FMP RECORD = C
11303 ! NEW FILE = XPC
11304 ! MAINT PGM = AR2MJA
11305 DIM A[1]
11310 ENTER FILENO,A$,A{ALL},TYPE$
11312 IOLIST A$
11320 SWITCH TYPE$
11325 CASE "D"
11330 REMOVE (FILENO,KEY=A$(1,4),ERR=*NEXT)
11335 BREAK
11340 DEFAULT 
11350 WRITE (FILENO,KEY=A$(1,4))IOL=11312
11360 END SWITCH 
11390 EXIT 
11398 ! 
11399 ! 
11400 DUPLICATE_XPF:
11401 ! FMP TABLE = FMPF_FOBCode
11402 ! FMP RECORD = F
11403 ! NEW FILE = XPF
11404 ! MAINT PGM = FM2SBA
11405 DIM A[1]
11410 ENTER FILENO,A$,A{ALL},TYPE$
11412 IOLIST A$
11420 SWITCH TYPE$
11425 CASE "D"
11430 REMOVE (FILENO,KEY=A$(1,2),ERR=*NEXT)
11435 BREAK
11440 DEFAULT 
11450 WRITE (FILENO,KEY=A$(1,2))IOL=11412
11460 END SWITCH 
11490 EXIT 
11498 ! 
11499 ! 
11500 DUPLICATE_XP2:
11501 ! FMP TABLE = FMPf_CustDept
11502 ! FMP RECORD = f
11503 ! NEW FILE = XP2
11504 ! MAINT PGM = FM2MPM
11505 DIM A[1]
11510 ENTER FILENO,A$,A{ALL},TYPE$
11512 IOLIST A$
11520 SWITCH TYPE$
11525 CASE "D"
11530 REMOVE (FILENO,KEY=A$(1,20),ERR=*NEXT)
11535 BREAK
11540 DEFAULT 
11550 WRITE (FILENO,KEY=A$(1,20))IOL=11512
11560 END SWITCH 
11590 EXIT 
11598 ! 
11599 ! 
11600 DUPLICATE_XPG:
11601 ! FMP TABLE = FMPG_CustGroup
11602 ! FMP RECORD = g
11603 ! NEW FILE = XPG
11604 ! MAINT PGM = FM2GAA
11605 DIM A[1]
11610 ENTER FILENO,A$,A{ALL},TYPE$
11612 IOLIST A$
11620 SWITCH TYPE$
11625 CASE "D"
11630 REMOVE (FILENO,KEY=A$(1,4),ERR=*NEXT)
11635 BREAK
11640 DEFAULT 
11650 WRITE (FILENO,KEY=A$(1,4))IOL=11612
11660 END SWITCH 
11690 EXIT 
11698 ! 
11699 ! 
11700 DUPLICATE_XPH:
11701 ! FMP TABLE = FMPH_HowShipCodes
11702 ! FMP RECORD = H
11703 ! NEW FILE = XPH
11704 ! MAINT PGM = FM2SDA
11705 DIM A[1]
11710 ENTER FILENO,A$,A{ALL},TYPE$
11712 IOLIST A$
11720 SWITCH TYPE$
11725 CASE "D"
11730 REMOVE (FILENO,KEY=A$(1,2),ERR=*NEXT)
11735 BREAK
11740 DEFAULT 
11750 WRITE (FILENO,KEY=A$(1,2))IOL=11712
11760 END SWITCH 
11790 EXIT 
11798 ! 
11799 ! 
11800 DUPLICATE_XP3:
11801 ! FMP TABLE = FMPh_RQFVendGroup
11802 ! FMP RECORD = h
11803 ! NEW FILE = XP3
11804 ! MAINT PGM = QS2MPG
11805 DIM A[1]
11810 ENTER FILENO,A$,A{ALL},TYPE$
11812 IOLIST A$
11820 SWITCH TYPE$
11825 CASE "D"
11830 REMOVE (FILENO,KEY=A$(1,9),ERR=*NEXT)
11835 BREAK
11840 DEFAULT 
11850 WRITE (FILENO,KEY=A$(1,9))IOL=11812
11860 END SWITCH 
11890 EXIT 
11898 ! 
11899 ! 
11900 DUPLICATE_XPI:
11901 ! FMP TABLE = FMPI_ItemPriceClass
11902 ! FMP RECORD = I
11903 ! NEW FILE = XPI
11904 ! MAINT PGM = IC2MEA
11905 DIM A[1]
11910 ENTER FILENO,A$,A{ALL},TYPE$
11912 IOLIST A$
11920 SWITCH TYPE$
11925 CASE "D"
11930 REMOVE (FILENO,KEY=A$(1,4),ERR=*NEXT)
11935 BREAK
11940 DEFAULT 
11950 WRITE (FILENO,KEY=A$(1,4))IOL=11912
11960 END SWITCH 
11990 EXIT 
11998 ! 
11999 ! 
12000 DUPLICATE_XPM:
12001 ! FMP TABLE = FMPM_FreightMarkup
12002 ! FMP RECORD = M
12003 ! NEW FILE = XPM
12004 ! MAINT PGM = FM2MPH
12005 DIM A[12]
12010 ENTER FILENO,A$,A{ALL},TYPE$
12012 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11]
12020 SWITCH TYPE$
12025 CASE "D"
12030 REMOVE (FILENO,KEY=A$(1,3),ERR=*NEXT)
12035 BREAK
12040 DEFAULT 
12050 WRITE (FILENO,KEY=A$(1,3))IOL=12012
12060 END SWITCH 
12090 EXIT 
12098 ! 
12099 ! 
12100 DUPLICATE_XPP:
12101 ! FMP TABLE = FMPP_PricingTables
12102 ! FMP RECORD = P
12103 ! NEW FILE = XPP
12104 ! MAINT PGM = IC2MGA
12105 DIM A[25]
12110 ENTER FILENO,A$,A{ALL},TYPE$
12112 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13],A[14],A[15],A[16],A[17],A[18],A[19],A[20],A[21],A[22],A[23],A[24]
12120 SWITCH TYPE$
12125 CASE "D"
12130 REMOVE (FILENO,KEY=A$(1,7),ERR=*NEXT)
12135 BREAK
12140 DEFAULT 
12150 WRITE (FILENO,KEY=A$(1,7))IOL=12112
12160 END SWITCH 
12190 EXIT 
12198 ! 
12199 ! 
12200 DUPLICATE_XPS:
12201 ! FMP TABLE = FMPS_ShipViaCodes
12202 ! FMP RECORD = S
12203 ! NEW FILE = XPS
12204 ! MAINT PGM = FM2SCA
12205 DIM A[5]
12210 ENTER FILENO,A$,A{ALL},TYPE$
12212 IOLIST A$
12213 REM + IOLIST A$,A[1],a[2],a[3],a[4]
12220 SWITCH TYPE$
12225 CASE "D"
12230 REMOVE (FILENO,KEY=A$(1,2),ERR=*NEXT)
12235 BREAK
12240 DEFAULT 
12250 WRITE (FILENO,KEY=A$(1,2))IOL=12212
12260 END SWITCH 
12290 EXIT 
12298 ! 
12299 ! 
12300 DUPLICATE_XPW:
12301 ! FMP TABLE = FMPW_VendProdCodes
12302 ! FMP RECORD = W
12303 ! NEW FILE = XPW
12304 ! MAINT PGM = FM2SEA
12305 DIM A[1]
12310 ENTER FILENO,A$,A{ALL},TYPE$
12312 IOLIST A$,A[0]
12320 SWITCH TYPE$
12325 CASE "D"
12330 REMOVE (FILENO,KEY=A$(1,14),ERR=*NEXT)
12335 BREAK
12340 DEFAULT 
12350 WRITE (FILENO,KEY=A$(1,14))IOL=12312
12360 END SWITCH 
12390 EXIT 
12398 ! 
12399 ! 
12400 DUPLICATE_XPZ:
12401 ! FMP TABLE = FMPZ_CustReqChrg
12402 ! FMP RECORD = Z
12403 ! NEW FILE = XPZ
12404 ! MAINT PGM = FM2SHG
12405 DIM A[4]
12410 ENTER FILENO,A$,A{ALL},TYPE$
12412 IOLIST A$,A[0],A[1],A[2],A[3]
12420 SWITCH TYPE$
12425 CASE "D"
12430 REMOVE (FILENO,KEY=A$(1,11),ERR=*NEXT)
12435 BREAK
12440 DEFAULT 
12450 WRITE (FILENO,KEY=A$(1,11))IOL=12412
12460 END SWITCH 
12490 EXIT 
12498 ! 
12499 ! 
56000 REM "5.4 - 01/16/06 - 15.53 - jme - SSP# 188067
56001 REM "188067-New Pricing changes. Standard GP Percentage for a           
56002 REM "5.5 - 07/19/06 - 9.290833 - bam - SSP# 168612
56003 REM "168612-Need to add Bill as shipped orders to update the ASJ file   
56004 REM "5.5 - 10/26/06 - 12.865555 - jme - SSP# 198724
56005 REM "198724-Create Separate file XPR for FMP type R
56006 REM "5.5 - 10/31/06 - 14.102777 - mhe - SSP# 201452
56007 REM "201452-Create separate file XPD for FMP1
56008 REM "      -Added lines 10100-12499
56010 REM "5.5 - 12/05/06 - 13.734722 - mhe - SSP# 202703
56012 REM "202703-Modify UPDFMP for changes to FMP updates                    
56014 REM "5.5 - 02/05/07 - 10.6725 - mhe - SSP# 204600
56016 REM "204600-The numberic array used for file XPX should only have 3     
