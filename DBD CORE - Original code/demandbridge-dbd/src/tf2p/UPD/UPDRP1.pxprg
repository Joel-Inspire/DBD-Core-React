0010 ! UPDRP1 - File RP1 Maintenance
0035 REM "5.7 - 08/24/14 - 11.695833 - jvv - SSP# 270121
0037 REM "270121-CIG Plus; Additional to WO260723, Batch Enable SM7.         
0040 REM "Copyright 2014 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
10000 ADD_RP1:
10005 ! add to RP1 Text file for each program type
10010 ENTER X3$,X4$,RPREC$,RPROG$
10020 FDTE$=DTE(0:"%Y%Mz%Dz"),FSEQ=0
10040 CREATE_RP1:
10060 FSEQ=FSEQ+1; FSEQ$=STR(FSEQ:"000")
10065 IF FSEQ>1000 THEN GOTO EXIT_RP1_ERR
10070 RF$="_"+RPROG$+"_"+FDTE$+"_"+FSEQ$
10080 RF1$="RP1",RFILE$=RF1$+RF$
10100 CHECK_RP2:
10110 RF2$="RP2",RFILE2$=RF2$+RF$
10120 CHL2=UNT; OPEN (CHL2,ERR=*NEXT)RFILE2$; CLOSE (CHL2); GOTO CREATE_RP1
10130 SERIAL RFILE$,0,0,ERR=*NEXT
10150 LOCK_FILE:
10160 CHL=UNT; OPEN LOCK (CHL,OPT="TEXT",ERR=*NEXT)RFILE$; GOTO UPD_FILE
10170 CLOSE (CHL); GOTO CREATE_RP1
10200 UPD_FILE:
10210 PRINT (CHL)RPREC$
10215 EXIT_RP1:
10220 CLOSE (CHL,ERR=*NEXT)
10230 CLOSE (CHL2,ERR=*NEXT)
10290 EXIT 
10299 ! 
10300 EXIT_RP1_ERR:
10310 EXIT 12
10399 ! 
56000 REM "270121-CIG Plus; Additional to WO260723, Batch Enable SM7.         
