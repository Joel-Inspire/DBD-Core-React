0010 ! UPDDTO - File DTO Maintenance
0035 REM "5.5 - 09/25/07 - 21.921666 - jme - SSP# 212097
0037 REM "212097-TOD Purchase Order Printing
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 ! FILENO - CHANNEL OF OPEN FILE
0051 ! KEYNO  - KEY NUMBER
0052 ! SEG1-SEG5$ : KEY SEGMENTS . CAN BE NULL
0053 ! A$ - RECORD A$
0054 ! FOUND - IF RECORD FOUND, THEN 1 ELSE 0
0055 ! BUSY - IF RECORD BUSY THEN 1 ELSE 0
0056 ! OK - IF RECORD ADDED OK=1 ELSE 0
0310 IOLIST A$
0500 INIT:
0505 DIM Z[255]; OPENED=0
0507 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
0510 IF FILENO=0 THEN Z$="01S DTO...  "; CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; FILENO=Z[1],OPENED=1 ELSE IF POS("DTO"=PTH(FILENO))=0 THEN Z$="01S DTO...  "; CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; FILENO=Z[1],OPENED=1
0590 RETURN 
0598 ! 
0599 ! 
0600 WRAPUP:
0610 IF OPENED THEN CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
0690 RETURN 
0698 ! 
0699 ! 
1000 READBYKEY:
1010 ENTER FILENO,KEYNO,SEG1$,SEG2$,SEG3$,SEG4$,SEG5$,A$,A{ALL},FOUND
1015 FOUND=0
1020 GOSUB INIT
1025 CALL "UPDDTO;CLEAR_FIELDS",A$,A{ALL}
1049 XP=PRM('XI'); SET_PARAM 'XI'
1050 READ (FILENO,KNO=KEYNO,KEY=SEG1$+SEG2$+SEG3$+SEG4$+SEG5$,DOM=*NEXT)IOL=0310; FOUND=1
1051 SET_PARAM 'XI'=XP
1080 GOSUB WRAPUP
1090 EXIT 
1098 ! 
1099 ! 
1100 READNEXT:
1110 ENTER FILENO,A$,A{ALL},FOUND
1115 FOUND=0
1120 GOSUB INIT
1125 CALL "UPDDTO;CLEAR_FIELDS",A$,A{ALL}
1149 XP=PRM('XI'); SET_PARAM 'XI'
1150 READ (FILENO,END=*NEXT)IOL=0310; FOUND=1
1151 SET_PARAM 'XI'=XP
1180 GOSUB WRAPUP
1190 EXIT 
1198 ! 
1199 ! 
1200 READPREV:
1210 ENTER FILENO,A$,A{ALL},FOUND
1215 FOUND=0
1220 GOSUB INIT
1225 CALL "UPDDTO;CLEAR_FIELDS",A$,A{ALL}
1249 XP=PRM('XI'); SET_PARAM 'XI'
1250 PKEY$=KEP(FILENO,ERR=*NEXT); READ (FILENO,KEY=PKEY$)IOL=0310; FOUND=1
1251 SET_PARAM 'XI'=XP
1280 GOSUB WRAPUP
1290 EXIT 
1298 ! 
1299 ! 
1300 READFIRST:
1310 ENTER FILENO,A$,A{ALL},FOUND
1315 FOUND=0
1320 GOSUB INIT
1325 CALL "UPDDTO;CLEAR_FIELDS",A$,A{ALL}
1349 XP=PRM('XI'); SET_PARAM 'XI'
1350 PKEY$=KEF(FILENO,KNO=0,ERR=*NEXT); READ (FILENO,KEY=PKEY$)IOL=0310; FOUND=1
1351 SET_PARAM 'XI'=XP
1380 GOSUB WRAPUP
1390 EXIT 
1398 ! 
1399 ! 
1400 READLAST:
1410 ENTER FILENO,A$,A{ALL},FOUND
1415 FOUND=0
1420 GOSUB INIT
1425 CALL "UPDDTO;CLEAR_FIELDS",A$,A{ALL}
1449 XP=PRM('XI'); SET_PARAM 'XI'
1450 PKEY$=KEL(FILENO,ERR=*NEXT); READ (FILENO,KEY=PKEY$)IOL=0310; FOUND=1
1451 SET_PARAM 'XI'=XP
1480 GOSUB WRAPUP
1490 EXIT 
1498 ! 
1499 ! 
1500 EXTRACTBYKEY:
1510 ENTER FILENO,KEYNO,SEG1$,SEG2$,SEG3$,SEG4$,SEG5$,A$,A{ALL},FOUND,BUSY
1515 FOUND=0,BUSY=0
1525 CALL "UPDDTO;CLEAR_FIELDS",A$,A{ALL}
1549 XP=PRM('XI'); SET_PARAM 'XI'
1550 IF POS("DTO"=PTH(FILENO))=0 THEN BUSY=1 ELSE READ (FILENO,KNO=KEYNO,KEY=SEG1$+SEG2$+SEG3$+SEG4$+SEG5$,DOM=*NEXT)IOL=0310; FOUND=1,BUSY=1,PRIMEKEY$=KEC(FILENO,KNO=0); EXTRACT (FILENO,KEY=PRIMEKEY$,KNO=0,ERR=*NEXT); BUSY=0
1551 SET_PARAM 'XI'=XP
1590 EXIT 
1598 ! 
1599 ! 
1600 INSERT:
1610 ENTER FILENO,A$,A{ALL},OK
1615 OK=0,PRIMEKEY$=A$(1,35)
1620 GOSUB INIT
1650 WRITE (FILENO,KEY=PRIMEKEY$,ERR=*NEXT)IOL=0310; OK=1
1680 GOSUB WRAPUP
1690 EXIT 
1698 ! 
1699 ! 
1700 DELETE:
1710 ENTER FILENO,A$,A{ALL},FOUND,BUSY
1715 FOUND=0,BUSY=1,PRIMEKEY$=A$(1,35)
1720 GOSUB INIT
1750 REMOVE (FILENO,KEY=PRIMEKEY$,DOM=DELETE_END,ERR=*NEXT); BUSY=0; FOUND=1
1785 DELETE_END:
1787 GOSUB WRAPUP
1790 EXIT 
1798 ! 
1799 ! 
1800 CLEAR_FIELDS:
1810 ENTER A$,A{ALL}
1820 DIM A$(4178),A[13]
1890 EXIT 
1898 ! 
1899 ! 
1900 UPDATE:
1910 ENTER FILENO,A$,A{ALL},BUSY
1915 BUSY=1,PRIMEKEY$=A$(1,35)
1920 GOSUB INIT
1950 WRITE (FILENO,KEY=PRIMEKEY$,ERR=*NEXT)IOL=0310; BUSY=0
1980 GOSUB WRAPUP
1990 EXIT 
1998 ! 
1999 ! 
2000 CLEAR_LOCK:
2010 ENTER FILENO
2020 GOSUB INIT
2050 READ (FILENO,KNO=0,KEY="",ERR=*NEXT)
2080 GOSUB WRAPUP
2090 EXIT 
2098 ! 
2099 ! 
2500 VALIDATE:
2510 ENTER A$,A{ALL},MSG$
2520 A$=PAD(A$,4178),MSG$=""
2990 EXIT 
2998 ! 
2999 ! 
9999 END 
10000 GET_EF_TRANS_NUM:
10010 ENTER PO1$,OOP,MEM_FL,ZZPARM,X3$,TOD_TRANS$,GEN_SHIP_SHIPTO$,TOD_SEQ,TOD_OK
10012 IF TCB(29)<7100000 THEN GOTO EXIT_ROUTINE
10015 DIVISION$=PO1$(297,2),VENDOR$=PO1$(7,10),CUSTOMER$=PO1$(179,10),PLANT$=PO1$(17,4),SHIPTO$=GEN_SHIP_SHIPTO$
10025 CHECK$=PAD(DIVISION$,2)+PAD(VENDOR$,10)+PAD(CUSTOMER$,10)+PAD(PLANT$,5)+PAD(SHIPTO$,5)+DIM(5)
10030 TOD_OK=OOP'CHECK(CHECK$)
10040 IF TOD_OK THEN {! 
10045 MEM_KEY$=PO1$(297,9),TOD_TRANS$="",TOD_SEQ=0; READ (MEM_FL,KEY=MEM_KEY$,DOM=*NEXT)MEM_K$,TOD_TRANS$,TOD_SEQ
10050 IF TOD_TRANS$="" THEN CALL "UPDDT0;GET_NEXT_TRANS_NUM",ZZPARM,X3$,TOD_TRANS$
10055 TOD_SEQ=TOD_SEQ+1
10070 WRITE (MEM_FL,KEY=MEM_KEY$)MEM_KEY$,TOD_TRANS$,TOD_SEQ
10080  }
10090 EXIT_ROUTINE:EXIT 
10098 ! 
10099 ! 
11000 UPDATE_LINE:
11010 ENTER FILENO,TOD_OUTPUT_TYPE$,TOD_TRANS$,TOD_SEQ,F5,SUB_F5,F5$,TOD_OK
11015 IOLIST DTO$
11017 OUTPUT_TYPE$=TOD_OUTPUT_TYPE$
11020 IF TOD_OK AND F5>0 THEN {! 19980
11030 CALL "UPDDTO;CLEAR_FIELDS",DTO$,DTO{ALL}
11040 CALL "UPDDTO;READBYKEY",FILENO,0,OUTPUT_TYPE$,TOD_TRANS$,STR(TOD_SEQ:"00000"),SEG4$,SEG5$,DTO$,DTO{ALL},FOUNDDTO
11060 READ DATA FROM REC(IOL=11015) TO IOL=IOL(FILENO)
11110 IF F5=1 AND SUB_F5=1 THEN SOLD_TO_ADDR_01_1$=F5$
11112 IF F5=1 AND SUB_F5=0 THEN SOLD_TO_NAME$=F5$
11115 IF F5=1 AND SUB_F5=2 THEN SOLD_TO_ADDR_01_2$=F5$
11120 IF F5=1 AND SUB_F5=3 THEN SOLD_TO_ADDR_01_3$=F5$
11125 IF F5=1 AND SUB_F5=4 THEN SOLD_TO_ADDR_01_4$=F5$
11130 IF F5=1 AND SUB_F5=5 THEN SOLD_TO_CITY_01$=F5$
11135 IF F5=1 AND SUB_F5=6 THEN SOLD_TO_STATE_01$=F5$
11140 IF F5=1 AND SUB_F5=7 THEN SOLD_TO_ZIP_01$=F5$
11150 IF F5=2 AND SUB_F5=0 THEN VENDOR_NAME$=F5$
11152 IF F5=2 AND SUB_F5=1 THEN VENDOR_ADDR_01_1$=F5$
11154 IF F5=2 AND SUB_F5=2 THEN VENDOR_ADDR_01_2$=F5$
11155 IF F5=2 AND SUB_F5=3 THEN VENDOR_ADDR_01_3$=F5$
11160 IF F5=2 AND SUB_F5=4 THEN VENDOR_ADDR_01_4$=F5$
11165 IF F5=2 AND SUB_F5=5 THEN VENDOR_CITY_01$=F5$
11170 IF F5=2 AND SUB_F5=6 THEN VENDOR_STATE_01$=F5$
11175 IF F5=2 AND SUB_F5=7 THEN VENDOR_ZIP_01$=F5$
11180 IF F5=3 AND SUB_F5=0 THEN SHIP_TO_NAME$=F5$
11182 IF F5=3 AND SUB_F5=1 THEN SHIP_TO_ADDR_01_1$=F5$
11185 IF F5=3 AND SUB_F5=2 THEN SHIP_TO_ADDR_01_2$=F5$
11190 IF F5=3 AND SUB_F5=3 THEN SHIP_TO_ADDR_01_3$=F5$
11195 IF F5=3 AND SUB_F5=4 THEN SHIP_TO_ADDR_01_4$=F5$
11200 IF F5=3 AND SUB_F5=5 THEN SHIP_TO_CITY_01$=F5$
11205 IF F5=3 AND SUB_F5=6 THEN SHIP_TO_STATE_01$=F5$
11210 IF F5=3 AND SUB_F5=7 THEN SHIP_TO_ZIP_01$=F5$
11215 IF F5=4 THEN CUSTOMER_PO$=F5$
11220 IF F5=5 THEN F5$=PAD(F5$,9); PO_DIV$=F5$(1,2),PO_NUM$=F5$(3)
11222 IF F5=149 THEN FORMATTED_PO_NUM$=PAD(F5$,11) ! formatted p.o. number for display
11225 IF F5=6 THEN DATE_REQUESTED$=F5$
11230 IF F5=7 THEN ORDER_DATE$=F5$
11235 IF F5=8 THEN PLANT_QUOTE_NUM$=F5$
11240 IF F5=9 THEN PLANT_QUOTE_NUM_DATE$=F5$
11245 IF F5=10 THEN PREV_JOB_NUM$=F5$
11250 IF F5=11 THEN VEND_CODE$=F5$(3,6),VEND_DIV$=F5$(1,2)
11255 IF F5=12 THEN FOB_CODE$=F5$
11260 IF F5=13 THEN HOW_TO_SHIP$=F5$
11265 IF F5=14 THEN INSIDE_DELIVERY$=F5$
11270 IF F5=15 THEN SHIP_VIA_DESCRIPTION$=F5$
11275 IF F5=16 THEN SHIP_WITH$=F5$
11280 IF F5=17 THEN PO_QUANTITY$=F5$
11285 IF F5=18 THEN ITEM_DESCRIPTION$=F5$
11290 IF F5=19 THEN SIZE_INFORMATION$=F5$
11295 IF F5=20 THEN ITEM_REVISION$=F5$
11300 IF F5=21 THEN ITEM_NUMBER$=F5$
11305 IF F5=22 THEN UNIT_COST$=F5$
11310 IF F5=23 AND SUB_F5=1 THEN UNIT_OF_MEASURE$=F5$
11312 IF F5=23 AND SUB_F5=2 THEN IF NUM(F5$)<>0 THEN UNIT_QTY$="/"+F5$ ELSE UNIT_QTY$=""
11315 IF F5=24 THEN TOTAL_ORDER_COST$=F5$
11320 IF F5=25 THEN CUSTOMER_CODE$=F5$
11325 IF F5=26 THEN ORDER_TYPE$=F5$
11330 IF F5=27 THEN CUST_SR_NAME$=F5$
11335 IF F5=28 THEN CUST_SERV_REP$=F5$
11340 IF F5=29 THEN SALESPERSON_NAME$=F5$
11345 IF F5=30 THEN SALESPERSON_CODE$=F5$
11460 IF F5=93 AND SUB_F5=1 THEN COMMENT_1_1$=F5$
11462 IF F5=93 AND SUB_F5=2 THEN COMMENT_1_2$=F5$
11463 IF F5=93 AND SUB_F5=3 THEN COMMENT_1_3$=F5$
11464 IF F5=93 AND SUB_F5=4 THEN COMMENT_1_4$=F5$
11465 IF F5=93 AND SUB_F5=5 THEN COMMENT_1_5$=F5$
11466 IF F5=93 AND SUB_F5=6 THEN COMMENT_1_6$=F5$
11467 IF F5=93 AND SUB_F5=7 THEN COMMENT_1_7$=F5$
11468 IF F5=93 AND SUB_F5=8 THEN COMMENT_1_8$=F5$
11480 IF F5=96 THEN UNIT_PRICE$=F5$
11485 IF F5=97 THEN TOTAL_SELL_PRICE$=F5$
11490 IF F5=98 THEN COMMISSION_CODE_LINE_ITEM$=F5$
11495 IF F5=99 THEN TOTAL_ORDER_COMMISSION$=F5$
11500 IF F5=100 THEN PROD_LINE_DESC$=F5$
11501 IF F5=101 AND SUB_5=1 THEN COMMENT_2_1$=F5$
11502 IF F5=101 AND SUB_5=2 THEN COMMENT_2_2$=F5$
11503 IF F5=101 AND SUB_5=3 THEN COMMENT_2_3$=F5$
11504 IF F5=101 AND SUB_5=4 THEN COMMENT_2_4$=F5$
11505 IF F5=101 AND SUB_5=5 THEN COMMENT_2_5$=F5$
11506 IF F5=101 AND SUB_5=6 THEN COMMENT_2_6$=F5$
11507 IF F5=101 AND SUB_5=7 THEN COMMENT_2_7$=F5$
11508 IF F5=101 AND SUB_5=8 THEN COMMENT_2_8$=F5$
11510 IF F5=102 THEN COMBO_QTY$=F5$
11515 IF F5=103 THEN MARK_FOR$=F5$
11520 IF F5=104 AND SUB_F5=0 THEN SEND_ACK_TO$=F5$
11522 IF F5=104 AND SUB_F5=1 THEN SEND_ACK_TO_1$=F5$
11524 IF F5=104 AND SUB_F5=2 THEN SEND_ACK_TO_2$=F5$
11525 IF F5=106 THEN YOUR_ITEM_NUMBER$=F5$
11530 IF F5=107 THEN LEFT_RIGHT$=F5$
11535 IF F5=108 THEN TOP_BOTTOM$=F5$
11540 IF F5=109 THEN PLYS$=F5$
11545 IF F5=110 THEN PREV_JOB_NUMBER_DATE$=F5$
11580 IF F5=115 THEN DATE_REQUIRED$=F5$
11585 IF F5=117 THEN RUSH_SERVICE_PER$=F5$
11590 IF F5=118 THEN RUSH_SERVICE_WORK_DAYS$=F5$
11620 IF F5=122 THEN ORDERED_BY$=F5$
11625 IF F5=123 THEN LINE_GP_DOLLARS$=F5$
11630 IF F5=124 THEN LINE_BP_PERCENT$=F5$
11635 IF F5=125 THEN TOTAL_ORDER_GROSS_PROFIT$=F5$
11640 IF F5=126 THEN TOTAL_ORDER_GROSS_PROFIT_PCT$=F5$
11645 IF F5=127 THEN TOTAL_NP_DOLLARS$=F5$
11650 IF F5=128 THEN TOTAL_NP_PERCENT$=F5$
11655 IF F5=129 THEN LINE_EXT_OF_COST$=F5$
11660 IF F5=130 THEN LINE_EXT_SELL_PRICE$=F5$
11665 IF F5=131 THEN SDL_UNUSED$=F5$
11670 IF F5=132 THEN TOTAL_QTY$=F5$
11690 IF F5=135 THEN CUSTOMER_PHONE$=F5$
11695 IF F5=136 THEN CUSTOMER_FAX$=F5$
11700 IF F5=137 THEN BILL_ADD_FOR_SOLD_ADD$=F5$
11705 IF F5=138 THEN VENDOR_PHONE$=F5$
11710 IF F5=139 THEN VENDOR_FAX$=F5$
11715 IF F5=140 THEN STND_INV_COMMENT$=F5$
11720 IF F5=141 THEN ART_DISK_FILE$=F5$
11725 IF F5=142 THEN RO_DATE$=F5$
11730 IF F5=143 THEN TERMS_DESC$=F5$
11735 IF F5=144 THEN COMPANY_NAME$=F5$
11750 IF F5=146 THEN BIN_LOCATION_01$=F5$
11755 IF F5=147 THEN REPRINT_MSG$=F5$
11760 IF F5=148 THEN NEW_ORDER_TYPE$=F5$
11765 IF F5=150 THEN ITEM_SPEC_CODE$=F5$
11770 IF F5=151 THEN SPER_PHONE$=F5$
11775 IF F5=152 THEN SPER_FAX$=F5$
11790 IF F5=154 THEN PROOF_STATUS_DESC$=F5$
11800 IF F5=155 THEN PROOF_STATUS_DATE$=F5$
11805 IF F5=156 THEN PROD_CODE$=F5$
11810 IF F5=157 THEN GBIC_UNUSED$=F5$
11815 IF F5=158 AND SUB_F5=1 THEN SEND_INVOICES_TO_LINE_1$=F5$
11820 IF F5=158 AND SUB_F5=2 THEN SEND_INVOICES_TO_LINE_2$=F5$
11825 IF F5=158 AND SUB_F5=3 THEN SEND_INVOICES_TO_LINE_3$=F5$
11830 IF F5=158 AND SUB_F5=4 THEN SEND_INVOICES_TO_LINE_4$=F5$
11840 IF F5=159 THEN CUST_ITEM_CODE$=F5$
11850 IF F5=160 THEN VAR_PRINT1$=F5$
11855 IF F5=161 THEN VAR_PRINT2$=F5$
11860 IF F5=162 THEN VAR_PRINT_ID$=F5$
11865 IF F5=163 THEN VAR_PRINT_PROOF_URL$=F5$
11870 IF F5=164 THEN VAR_PRINT_VEND_URL$=F5$
11875 IF F5=165 THEN VAR_PRINT_PFILE_URL$=F5$
11895 IF F5=167 THEN DEPOSIT_CHECK_DATE$=F5$
11900 IF F5=168 THEN DEPOSIT_CHECK_AMOUNT$=F5$
11910 IF F5=169 THEN NOTEPAD_LINE_1$=F5$
11915 IF F5=170 THEN NOTEPAD_LINE_2$=F5$
11920 IF F5=171 THEN NOTEPAD_LINE_3$=F5$
11925 IF F5=172 THEN NOTEPAD_LINE_4$=F5$
11930 IF F5=173 THEN NOTEPAD_LINE_5$=F5$
11935 IF F5=174 THEN NOTEPAD_LINE_6$=F5$
11940 IF F5=175 THEN NOTEPAD_LINE_7$=F5$
11945 IF F5=176 THEN NOTEPAD_LINE_8$=F5$
11950 IF F5=177 THEN NOTEPAD_LINE_9$=F5$
11955 IF F5=178 THEN NOTEPAD_LINE_10$=F5$
11960 IF F5=179 THEN VENDOR_QUOTE_TITLE$=F5$
11970 IF F5=181 THEN QTY_IN_EACHES$=F5$
11975 IF F5=182 THEN VAR_PRINT$=F5$
11980 IF F5=10000 THEN PLANT_CODE$=F5$
11985 IF F5=10001 THEN GEN_SHIP_TO_CODE$=F5$
11987 IF F5=10002 THEN UNFMTD_CUST_DIV$=F5$(1,2),UNFMTD_CUST_CODE$=F5$(3,8)
19890 READ DATA FROM REC(IOL(FILENO)) TO IOL=11015
19895 DTO$(1,20)=TOD_OUTPUT_TYPE$,DTO$(21,10)=TOD_TRANS$,DTO$(31,5)=STR(TOD_SEQ:"00000")
19900 CALL "UPDDTO;UPDATE",FILENO,DTO$,DTO{ALL},BUSY
19990 EXIT 
19998 ! 
19999 ! 
21000 UPDATE_HDR_INFO:
21010 ENTER FILENO,OUTPUT_TYPE$,TOD_TRANS$,MEM_FL
21020 READ (MEM_FL,KEY="",ERR=*NEXT)
21100 READ (MEM_FL,END=21990)MEM_KEY$,TRANS$,TOD_SEQ
21150 CALL "UPDDTO;READBYKEY",FILENO,0,OUTPUT_TYPE$,TRANS$,"00000",SEG4$,SEG5$,DTOHDR$,DTOHDR{ALL},FOUNDDTOHDR; IF FOUNDDTOHDR THEN CALL "UPDDTO;DELETE",FILENO,DTOHDR$,DTOHDR{ALL},FOUND,BUSY
21190 CALL "UPDDTO;READNEXT",FILENO,DTO$,DTO{ALL},FOUNDDTO; IF FOUNDDTO THEN IF DTO$(1,30)<>DTOHDR$(1,30) THEN FOUNDDTO=0
21200 WHILE FOUNDDTO
21210 FOR J=37 TO LEN(DTOHDR$)
21220 IF DTOHDR$(J,1)<>" " THEN DTO$(J,1)=DTOHDR$(J,1)
21240 NEXT J
21250 CALL "UPDDTO;UPDATE",FILENO,DTO$,DTO{ALL},BUSY
21280 CALL "UPDDTO;READNEXT",FILENO,DTO$,DTO{ALL},FOUNDDTO; IF FOUNDDTO THEN IF DTO$(1,30)<>DTOHDR$(1,30) THEN FOUNDDTO=0
21290 WEND 
21500 GOTO 21100
21990 EXIT 
21998 ! 
21999 ! 
31000 UPDATE_LINES:
31010 ENTER FILENO,TOD_OUTPUT_TYPE$,TOD_TRANS$,TOD_SEQ,%DTS_IOL$,TOD_OK
31015 IOLIST DTO$
31017 OUTPUT_TYPE$=TOD_OUTPUT_TYPE$
31090 READ DATA FROM REC(IOL(FILENO)) TO IOL=31015
31095 IF UID="jvv" THEN ESCAPE 
31100 DTO$(1,20)=TOD_OUTPUT_TYPE$,DTO$(21,10)=TOD_TRANS$,DTO$(31,5)=STR(TOD_SEQ:"00000")
31200 CALL "UPDDTO;UPDATE",FILENO,DTO$,DTO{ALL},BUSY
32200 EXIT 
56000 REM "198612-TopForm Output director
56002 REM "212091-TOD Purchase Order - Output Director control maintenance
