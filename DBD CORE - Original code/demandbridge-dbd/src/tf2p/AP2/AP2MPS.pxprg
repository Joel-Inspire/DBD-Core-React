0010 REM "A/P Invoice Entry Options Setup <AP2MPS>
0020 SETESC 9300; SETERR 9000
0040 REM "Copyright 1986 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="AP2MPS",X1$="A/P Invoice Entry Options Setup"
0120 DIM Z0$(80,"-")
0135 C9=-1,V9=-2
0140 M0$="-###,###.00"
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0280 IF X3$(9,3)="   " THEN CALL "ZZPROM","4",X3$,X,"You have not selected acompany. Press <Return> to continue: ","","",0; GOTO 9900
0290 K9$=X3$(9,3)+"AP2A",K9=LEN(K9$)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1,LEN(A$)),A[0],A[1],A[2],A[3],A[4]
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X ZZPARM  06O ZZPARM  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 0521,9900
0580 READ (Z[1],KEY=X3$(9,3)+"A/P",DOM=9800)F0$
0585 IF F0$(68,1)<>"Y" THEN GOTO 8000
0600 REM "
0620 GOSUB 6000
1000 REM "
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1035 DIM A$(81+K9),A[4]
1045 A$(1,0+K9)=K9$+A1$
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1500
1200 REM "
1215 IF C0<0 THEN GOTO 9900
1500 REM "
1505 Z9=-1
1510 A1$=K9$
1520 READ (Z[1],KEY=A1$,DOM=1600)IOL=0310
1525 Z9=0
1530 GOSUB 6600
1590 GOTO 1700
1600 REM "
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630,6975
1630 GOTO 9800
1660 IF V9>=0 THEN GOSUB 6200
1690 GOTO 2000
1700 REM "
1710 GOSUB 6200
1800 REM "
1820 CALL "ZZPROM","1",X3$,Z,"","","V",X0; ON Z+1 GOTO 1850,6700,2000
1830 GOTO 2000
1850 REM "MODIFY
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE IF Z9=0 THEN Z9=1
1860 EXTRACT (Z[1],KEY=A1$,DOM=1870)IOL=0310
1865 C9=1
1870 GOSUB 6200
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF C0>3 OR X0<0 THEN GOTO 1800
2035 IF X0*6+11<LEN(V9$) THEN IF V9$(X0*6+11,1)="2" THEN GOTO 2020
2040 ON X0 GOTO 2100,2150,2200,2250,2300,2350,2400,2450,2500,2550,2600,2650,2700,2750,2800,2850,2900,2950,3000,3050,1800
2100 REM "Other Inv Amount 1 Descr
2110 CALL "ZZENTR","RX",A{ALL},A$,X4$,X3$,3,6,1+K9,16,C0,"","{3"+X$,K9$,"AP2MPB00","ZZPA","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2110,2111
2130 IF POS(" "<>A$(1+K9,16))=0 THEN A$(17+K9,2)="",A[0]=0; PRINT @(3,6),'CL',
2140 GOTO 2020
2150 REM "Othr Inv Amt 1 Post G/l
2155 IF POS(" "<>A$(1+K9,16))=0 THEN GOTO 2020
2160 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,23,6,17+K9,1,C0,"","{3"+X$,"","AP2MPB02","","",""
2190 GOTO 2020
2200 REM "Othr Inv Amt 1 Take Discount
2205 IF POS(" "<>A$(1+K9,16))=0 THEN GOTO 2020
2210 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,30,6,18+K9,1,C0,"","{3"+X$,"","AP2MPB04","","",""
2240 GOTO 2020
2250 REM "Other Inv AMt 1 Type
2252 GOTO 2020
2255 IF POS(" "<>A$(1+K9,16))=0 THEN GOTO 2020
2257 B$="F=fixed, P=percentage ::: Additionally, enter an 'X' if included in Invoice amt",X$=B$
2260 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,38,6,19+K9,2,C0,"","{3"+X$,"","AP2MPB06","","",""
2290 GOTO 2020
2300 REM "Other Inv Amt 1 Rate / Amount
2302 GOTO 2020
2305 IF POS(" "<>A$(21+K9,16))=0 THEN GOTO 2020
2310 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,46,6,0,621,C0,M0$,"{3"+X$,"","AP2MPB08","","",""
2340 GOTO 2020
2350 REM "Othr Inv Amt 2 Descr
2360 CALL "ZZENTR","R",A{ALL},A$,X4$,X3$,3,7,21+K9,16,C0,"","{3"+X$,"","AP2MPB10","","",""
2370 IF POS(" "<>A$(21+K9,16))=0 THEN A$(37+K9,2)="",A[1]=0; PRINT @(3,7),'CL',
2390 GOTO 2020
2400 REM "Othr Inv Amt 2 Post G/L
2405 IF POS(" "<>A$(21+K9,16))=0 THEN GOTO 2020
2410 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,23,7,37+K9,1,C0,"","{3"+X$,"","AP2MPB12","","",""
2440 GOTO 2020
2450 REM "Othr Inv Amt 2 Allow Disc
2455 IF POS(" "<>A$(21+K9,16))=0 THEN GOTO 2020
2460 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,30,7,38+K9,1,C0,"","{3"+X$,"","AP2MPB14","","",""
2490 GOTO 2020
2500 REM "Othr Inv Amt 2 Type
2502 GOTO 2020
2505 IF POS(" "<>A$(21+K9,16))=0 THEN GOTO 2020
2510 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,38,7,39+K9,2,C0,"","{3"+X$,"","AP2MPB16","","",""
2540 GOTO 2020
2550 REM "Othr Inv amt 2 Rate/Amount
2552 GOTO 2020
2555 IF POS(" "<>A$(21+K9,16))=0 THEN GOTO 2020
2560 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,46,7,1,621,C0,M0$,"{3"+X$,"","AP2MPB18","","",""
2590 GOTO 2020
2600 REM "Othr Inv Amt 3 Description
2610 CALL "ZZENTR","R",A{ALL},A$,X4$,X3$,3,8,41+K9,16,C0,"","{3"+X$,"","AP2MPB20","","",""
2630 IF POS(" "<>A$(41+K9,16))=0 THEN A$(57+K9,2)="",A[2]=0; PRINT @(3,8),'CL',
2640 GOTO 2020
2650 REM "Othr Inv Amt 3 Post G/L
2655 IF POS(" "<>A$(41+K9,16))=0 THEN GOTO 2020
2660 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,23,8,57+K9,1,C0,"","{3"+X$,"","AP2MPB22","","",""
2690 GOTO 2020
2700 REM "Othr Inv Amt 3 Take Disc
2705 IF POS(" "<>A$(41+K9,16))=0 THEN GOTO 2020
2710 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,30,8,58+K9,1,C0,"","{3"+X$,"","AP2MPB24","","",""
2740 GOTO 2020
2750 REM "Other Inv Amt 3 Type
2752 GOTO 2020
2755 IF POS(" "<>A$(41+K9,16))=0 THEN GOTO 2020
2760 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,38,8,59+K9,2,C0,"","{3"+X$,"","AP2MPB26","","",""
2790 GOTO 2020
2800 REM "Othr Inv Amt 3 Rate / Amount
2802 GOTO 2020
2805 IF POS(" "<>A$(41+K9,16))=0 THEN GOTO 2020
2810 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,46,8,2,621,C0,M0$,"{3"+X$,"","AP2MPB28","","",""
2840 GOTO 2020
2850 REM "Othr Inv Amt 4 Dexcription
2860 CALL "ZZENTR","R",A{ALL},A$,X4$,X3$,3,9,61+K9,16,C0,"","{3"+X$,"","AP2MPB30","","",""
2870 IF POS(" "<>A$(61+K9,16))=0 THEN A$(77+K9,2)="",A[3]=0; PRINT @(3,9),'CL',
2890 GOTO 2020
2900 REM "Othr Inv Amt 4 Post G/L
2905 IF POS(" "<>A$(61+K9,16))=0 THEN GOTO 2020
2910 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,23,9,77+K9,1,C0,"","{3"+X$,"","AP2MPB32","","",""
2940 GOTO 2020
2950 REM "Othr Inv Amt 4 Allow Disc
2955 IF POS(" "<>A$(61+K9,16))=0 THEN GOTO 2020
2960 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,30,9,78+K9,1,C0,"","{3"+X$,"","AP2MPB34","","",""
2990 GOTO 2020
3000 REM "Othr Inv Amt 4 Type
3002 GOTO 2020
3005 IF POS(" "<>A$(61+K9,16))=0 THEN GOTO 2020
3010 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,38,9,79+K9,2,C0,"","{3"+X$,"","AP2MPB36","","",""
3040 GOTO 2020
3050 REM "Othr Inv Amt 4 Rate/Amount
3052 GOTO 2020
3055 IF POS(" "<>A$(61+K9,16))=0 THEN GOTO 2020
3060 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,46,9,3,621,C0,M0$,"{3"+X$,"","AP2MPB38","","",""
3090 GOTO 2020
5000 REM "Write Print Data
5010 IF R0$="" THEN CALL "ZZRPTO",X3$,X4$,Y0$,R0$,R{ALL},4,C0,X0
5020 T1$=L0$((T0-1)*6+1,6),K$=X3$(1,8)
5025 IF R0$(1,1)<>"Q" THEN GOTO 5040 ELSE Z$="07C         07O ZZQ     ",K9$="",K$=DAY,K$=K$(7,2)+K$(1,2)+K$(4,2),K$=R0$(2,6)+X3$(162,1)+R0$(17,1)+K$+STR(TIM*100:"0000")+" "+A$(1,6)+X3$(9,3)+X3$(40,3); IF R0$(2,1)="U" THEN K$(1,2)=X3$(172,2)
5030 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 5031,9900
5035 ON POS(R0$(1,1)="IQS") GOTO 5090,5040,5065,5080
5040 IF R0$(8,1)="G" THEN GOSUB 5100
5045 WRITE (Z[7],KEY=K$)X3$,X4$,T1$,R0$,W$,IOL=0310; GOTO 5080
5070 WRITE (Z[7],KEY=K$(1,19),DOM=5075)K$,X3$,X4$,T1$,R0$,W$,IOL=0310; GOTO 5090
5075 K$(19,1)=CHR(ASC(K$(19,1))+1); GOTO 5070
5080 IF R0$(8,1)="G" THEN GOSUB 5150
5090 GOTO 9900
5100 REM "GHOST TASK
5110 CALL "ZZGHST",X3$,"?","",G0$,X0
5120 IF X0<>0 THEN CALL "ZZPROM","G1",X3$,S3,"","","",0; ON S3 GOTO 5110,1800
5130 K$(1,LEN(G0$))=G0$; WRITE (Z[13],KEY=K$(1,8))K$+X3$(LEN(K$)+1),X4$
5140 RETURN 
5150 REM "START GHOST
5160 START 30,ERR=5170,K9$,G0$
5165 K9$=""; RETURN 
5170 Q$="+ ( !"+STR(ERR)+")"; CALL "ZZPROM","G2",X3$,S3,Q$,"","",0
5180 EXITTO 1800
5190 RETURN 
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6060 PRINT @(22,4),"Post",@(28,4),"Allow",@(3,5),"Description",@(22,5),"G/L?",@(28,5),"Disc?",@(0,6),"1.",@(0,7),"2.",@(0,8),"3.",@(0,9),"4.",@(0,11),Z0$,
6070 REM "PRINT @(36,4),"AMOUNT",@(37,5),"TYPE",@(45),"RATE/AMOUNT",
6180 PRINT 'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6219 DIM M0$(LEN(M0$),"#")
6220 PRINT @(3,6),A$(1+K9,16),@(23,6),A$(17+K9,1),@(30,6),A$(18+K9,1),@(38,6),A$(19+K9,2),@(46,6),A[0]:M0$,@(3,7),A$(21+K9,16),@(23,7),A$(37+K9,1),@(30,7),A$(38+K9,1),@(38,7),A$(39+K9,2),@(46,7),A[1]:M0$,@(3,8),A$(41+K9,16),@(23,8),A$(57+K9,1),@(30,8),A$(58+K9,1),@(38,8),A$(59+K9,2),@(46,8),A[2]:M0$,@(3,9),A$(61+K9,16),@(23,9),A$(77+K9,1),@(30,9),A$(78+K9,1),@(38,9),A$(79+K9,2),@(46,9),A[3]:M0$,
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6410 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6490 RETURN 
6500 REM "DELETE
6510 REMOVE (Z[1],KEY=A1$,DOM=6511)
6590 GOTO 1630
6600 REM "ALT KEY DATA READS
6690 RETURN 
6700 REM "ADD ENTRY
6710 WRITE (Z[1],KEY=A1$)IOL=0310
6790 GOTO 1630
6800 REM "NEXT ENTRY IN FILE
6810 A1$=KEY(Z[1],END=1140)
6815 IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 1140
6820 A$(1,LEN(A1$))=A1$
6830 GOSUB 6450
6890 Z9=0; GOTO 1515
7000 REM "UPDATE
7010 S3=0; IF Z9=1 THEN CALL "ZZPROM","R1",X3$,S3,"","","",0 ELSE IF Z9<0 THEN CALL "ZZPROM","R2",X3$,S3,"","","",0
7080 IF S3=0 THEN GOSUB 6700
7090 RETURN 
7100 REM "OPTIONS
7110 PRINT @(0,3),'CE',
7120 CALL "ZZRPTO",X3$,X4$,Y0$,R0$,R{ALL},4,C0,X0
7125 PRINT @(0,3),'CE',
7130 GOSUB 6400
7140 Z9=1
7190 GOTO 1800
7500 REM "CUSTOM PROGRAMMING ROUTINES
7525 REM "Modified stmts:
7550 REM "Added stmts:
7575 REM "Deleted stmts:
8010 CALL "ZZPROM","4",X3$,A,"A/P parameters indicate that this option is not available. Press |Return","","",0; GOTO 9800
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9800 REM 
9900 REM "END PROGRAM
9905 IF T0$<>"" THEN DROP T0$,ERR=9906; GOTO 9905
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 REM "IF K9$>"" THEN RUN K9$
9925 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 BEGIN ; SETESC 9350
9950 RUN "ZMENU"
9999 END 
