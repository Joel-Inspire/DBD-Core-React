0010 REM "Vendor Constant Data <AP2MAB>
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 09/21/10 - 14.655277 - tma - SSP# 241185
0036 REM "LINE 1052 MOD TO SET PAST DUE DISC FIELD TO 'N'
0037 REM "241185-Program AP2MAA in vendor setup, if your AP parameter is set 
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR EXCEPT TEMP$; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="AP2MAB",X1$="Vendor Constant Data",K9$="",K9=0
0120 DIM Z0$(80,"-")
0130 K0=10,K1=1
0135 C9=-1,V9=-2
0140 M0$="-####,###.00",M1$="-#0"
0145 Y0=0,Y1=5,Y2=46,Y3=163
0149 IF LEN(X3$)>146 AND X3$(146,6)="PO2MAM" THEN Q1$="*"
0150 IF Q1$="*" THEN Q1$="" ELSE IF Q1$="" THEN GOSUB 8950
0160 DEF FNS$(Z9$)=Z9$(1,POS("  "=Z9$+"  ")-1)
0200 REM "
0230 IF Q2$<>"" THEN X2=-1; PRINT @(0,5),'CE',
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1,LEN(A$)),A[0],A[1],A[2]
0320 IOLIST B$
0330 IOLIST C$,C[0],C[1]
0340 IOLIST D$,D[0],D[1]
0350 IOLIST E$
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X AP4...  02O GL1...  03O ZYB...  04O AP2...  05O AP3...  06O AP1...  06O ZZPARM  07O AP6...  08O AP7...  09O AP1...  10O AP0...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0530 DIM SEC$(255); FIND (Z[6],KEY="osec"+X3$(40,3),DOM=0531)SEC$
0580 FIND (Z[6],KEY=X3$(9,3)+"A/P")F0$
0583 READ (Z[6],DOM=0584,KEY=X3$(9,3)+"AP2A")F1$
0585 W9$=""; CALL "RT2PRM",ERR=0586,X3$,X4$,W9$
0590 GOSUB 7500; GOSUB 7800
0600 REM "
0620 GOSUB 6000
1000 REM "
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1015 Z9=-1
1030 DIM B$(52),C$(105),C[1],D$(53),D[1]
1035 DIM A$(426+K9),A[2]
1045 A$(1,0+K9)=K9$+A1$
1050 A$(283,3)=F0$(17,3),A$(291,1)="N",A$(246,1)="A"
1051 IF TEMP$="*" THEN A$(246,1)="T",A$(145+K9,10)="|TEMPORARY"; REM "Temporary Vendor - remove at M/E if invoices are paid
1052 A$(288,3)="00G"
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1200,1500
1200 REM "Vendor Code
1205 IF Q1$>"" THEN A$(1+K9,10)=Q1$; GOSUB 6450; GOTO 1220
1209 X$="Enter Vendor Code and press F5 to setup TEMP Vendor"
1210 CALL "ZZENTR","AXUF",A{ALL},A$,X4$,X3$,18,3+V0,1+K9,10,C0,"A/P","{1"+X$,"","AP2MAB00","AP4","",""; IF ABS(C0)=14 THEN TEMP$="*" ELSE TEMP$=""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1210,1211 ! SSP#241185
1212 IF TEMP$="*" THEN A$(246,1)="T",A$(145+K9,10)="|TEMPORARY"; REM "Temporary Vendor - remove at M/E if invoices are paid
1215 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1210,6800,9800,1210
1220 IF A$(1,2)<>"00" THEN READ (Z[10],KEY=A$(1,2),DOM=1225); GOTO 1230 ELSE GOTO 1230
1225 CALL "ZZPROM","4",X3$,S3,"Division "+A$(1,2)+" is not on file. Press |<Return>","","",0; GOTO 1200
1240 GOTO 1120
1500 REM "
1505 Z9=-1
1510 A1$=K9$+A$(LEN(K9$)+1,10),A$(1,LEN(K9$))=K9$
1512 A2$="",A3$="",A4$=""
1515 A9$=A$(Y2+K9,Y3)
1520 READ (Z[1],KEY=A1$,DOM=1600)IOL=0310
1522 A2$=A$(145,10)+A$(1,10),A3$=A$(247,9)+A$(1,10),A4$=A$(195,10)+A$(1,10); IF POS(X3$(9,3)="060338363364365366476",3)<>0 THEN A4$=A$(195,12)+A$(1,10)
1525 A9$=A$(Y2+K9,Y3)
1530 FIND (Z[2],KEY=A$(271+K9,12),DOM=1531)IOL=0320
1535 FIND (Z[3],KEY=A$(283+K9,3),DOM=1536)IOL=0330
1540 FIND (Z[4],KEY=A$(286+K9,2),DOM=1541)IOL=0340
1590 GOTO 1700
1600 REM "
1605 IF SEC$(46,1)="Y" THEN CALL "ZZPROM",".4",X3$,0,"Access denied! You may not set up a new vendor","","",0; GOTO 1000
1610 IF Q1$>"" THEN GOTO 1660
1615 IF X3$(330,1)="1" THEN IF POS(A$(1,2)="0001")>0 THEN CALL "ZZPROM",".4",X3$,0,"You may not setup vendors in division 00 or 01","","",0; GOTO 1000
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630,6975
1630 IF Q1$>"" THEN CALL "AP2UDH",X3$,X4$,A1$,""; GOSUB 6400; GOTO 9700 ELSE CALL "AP2UDH",X3$,X4$,A1$,""; GOSUB 6400; GOTO 1000; REM "WO129459, user defined fields
1650 Z9=1
1660 GOSUB 6200
1690 GOTO 2000
1700 REM "
1790 GOSUB 6200
1800 REM "
1809 IF %HAS_IMAGE_LIB THEN %IL_IMAGE_TYPE$="VENDOR_NOTE",%IL_IMAGE_KEY$=A1$
1810 IF POS(A$(1,2)="00",2)>0 THEN IF X3$(330,1)="1" THEN CALL "ZZPROM","4",X3$,0,"Inquiry only","","",0; %IL_IMAGE_TYPE$="",%IL_IMAGE_KEY$=""; GOTO 1630
1820 CALL "ZZPROM",CHR(ASC("A")+C9),X3$,Z,"","","V",X0; %IL_IMAGE_TYPE$="",%IL_IMAGE_KEY$=""; ON Z GOTO 1850,1630,6700,6970
1830 GOTO 2000
1850 REM "MODIFY
1852 IF SEC$(47,1)="Y" THEN CALL "ZZPROM",".4",X3$,0,"Access denied! You may not modify this data","","",0; GOTO 1800
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE Z9=1
1860 EXTRACT (Z[1],KEY=A1$,DOM=1870)IOL=0310
1865 C9=1
1870 GOSUB 6200
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF INT(C0)=3 THEN GOSUB 7300 ELSE IF C0>3 OR X0<0 THEN GOTO 1800
2035 IF X0*6+11<LEN(V9$) THEN IF V9$(X0*6+11,1)="2" THEN GOTO 2020
2040 ON X0 GOTO 2100,2150,2200,2250,2300,2350,2400,2450,3450,2500,2550,3650,2600,2650,3150,3250,3292,3300,3400,3350,2700,2750,2800,3600,2850,3200,3550,3500,1800; REM SSP 198988 SSP 217566           
2100 REM "Vendor Name
2110 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,36,3+V0,11+K9,35,C0,"","{3"+X$,"","AP2MAB02","","",""
2140 GOTO 2020
2150 REM "Address module
2155 A9$=A$(Y2+K9,Y3)
2160 CALL "ZY2AAA",X3$,X4$,Y0,Y1+V0,"A","Contact",2,A9$,A$(11+K9,35),0,C0,C1
2165 A$(Y2+K9,Y3)=A9$; IF C0>4 THEN GOSUB 6400; GOTO 2160
2190 GOTO 2020
2200 REM "Vendor status
2203 GOTO 2240
2205 X$="A=Active vendor, I=Inactive Vendor (to be purged at period end)"
2210 CALL "ZZENTR","SURU",A{ALL},A$,X4$,X3$,18,10+V0,246+K9,1,C0,"","{3"+X$,"IAT","AP2MAB06","IA","",""
2240 GOTO 2020
2250 REM "Vendor category
2260 CALL "ZZENTR","AU",A{ALL},A$,X4$,X3$,18,11+V0,247+K9,9,C0,"AP2","{3"+X$,"","AP2MAB08","AP3","AP2MPF",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2260,2261
2265 FIND (Z[5],KEY=A$(247+K9,9),DOM=2260)IOL=0350
2290 GOTO 2020
2300 REM "Standard comment
2310 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,18,12+V0,256+K9,15,C0,"","{3"+X$,"","AP2MAB10","","",""
2340 GOTO 2020
2350 REM "Std G/L account
2360 CALL "ZZENTR","AX",A{ALL},A$,X4$,X3$,18,13+V0,271+K9,12,C0,"G/L","{3"+X$,"","AP2MAB12","GL1","GL2MAA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2360,2361
2370 IF POS(" "<>A$(271+K9,12))>0 THEN FIND (Z[2],KEY=A$(271+K9,12),DOM=2360)IOL=0320; PRINT @(18+L9,13+V0),B$(13,35),
2390 GOTO 2020
2400 REM "Standard payment
2410 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,18,14+V0,0,721,C0,M0$,"{3"+X$,"","AP2MAB14","","",""
2440 GOTO 2020
2450 REM "Std bank acct
2455 IF F0$(16,1)<>"Y" THEN GOTO 2020
2460 CALL "ZZENTR","SUZ",A{ALL},A$,X4$,X3$,18,15+V0,283+K9,3,C0,"","{3"+X$,"","AP2MAB16","ZYB","ZY2BAA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2460,2461
2470 FIND (Z[3],KEY=A$(283+K9,3),DOM=2460)IOL=0330
2490 GOTO 2020
2500 REM "Std terms code
2510 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,18,16+V0,286+K9,2,C0,"","{3"+X$,"","AP2MAB18","AP2","AP2MPE",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2510,2511
2520 FIND (Z[4],KEY=A$(286+K9,2),DOM=2510)IOL=0340
2525 PRINT @(22,16),D$(3,30),
2540 GOTO 2020
2550 REM "Payment selection code
2555 X$="Used to select bills in automatic payment selection"
2560 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,65,10+V0,288+K9,2,C0,"","{3"+X$,"","AP2MAB20","","",""
2590 GOTO 2020
2600 REM "Payment priority
2605 X$="A=Lowest, Z=Highest: Used for priority payment selection of invoices"
2610 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,65,11+V0,290+K9,1,C0,"","{3"+X$,"","AP2MAB22","","",""
2640 GOTO 2020
2650 REM "Vendor on payment hold?
2655 X$="Invoices for Vendors on hold must be manually selected for payment"
2660 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,65,12+V0,291+K9,1,C0,"","{3"+X$,"","AP2MAB24","","",""
2690 GOTO 2020
2700 REM "Is vendor a subcontractor?
2705 GOTO 2020
2710 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,65,14+V0,292+K9,1,C0,"","{3"+X$,"","AP2MAB26","","",""
2740 GOTO 2020
2750 REM "Always take past due disc
2755 IF F0$(66,1)<>"Y" THEN GOTO 2020
2760 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,65,18+V0,293+K9,1,C0,"","{3"+X$,"","AP2MAB28","","",""
2790 GOTO 2020
2800 REM "Exclude from discount
2805 IF F1$="" THEN GOTO 2020
2810 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,65,19+V0,294+K9,X9,C0,"","{3"+X$,"","AP2MAB30","","",""
2815 IF A$(294+K9,1)=" " THEN GOTO 2020
2820 FOR X=0 TO X9-1; IF POS(A$(294+K9+X,1)=X9$)=0 THEN EXITTO 2810
2840 GOTO 2020
2850 REM "Extra days allowed
2855 IF F0$(66,1)<>"Y" THEN GOTO 2020
2860 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,75,20+V0,1,200,C0,M1$,"{3"+X$,"","AP2MAB32","","",""
2890 GOTO 2020
3150 REM "Mailing label types
3160 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,65,14+V0,300+K9,3,C0,"","{3"+X$,"","AR2MAB34","","","02H1"
3190 GOTO 2020
3200 REM "Intercompany G/L Account - ssp#089851
3201 ! GOTO 3210
3205 IF F0$(78,1)<>"Y" OR SEC$(62,1)<>"Y" THEN GOTO 2020
3210 CALL "ZZENTR","AX",A{ALL},A$,X4$,X3$,18,21+V0,209+K9,12,C0,"G/L","{3"+X$,"","AP2MAB34","GL1","GL2MAA",""; IF ABS(C0)>4 THEN GOSUB 6400
3220 IF POS(" "<>A$(209+K9,12))>0 THEN FIND (Z[2],KEY=A$(209+K9,12),DOM=3210)IOL=0320; PRINT @(18+L9,22+V0),B$(13,30),
3245 GOTO 2020
3250 REM "File output format, WO126561
3252 REM "Company 538's format is 01, only valid one at this time
3253 IF POS(X3$(9,3)="500538118130",3)=0 THEN GOTO 2020 ! Added 118, SSP160670
3255 X$="Creates text record during PO printing, see documentation for valid formats"
3260 CALL "ZZENTR","SRUX",A{ALL},A$,X4$,X3$,55,15+V0,221,2,C0,"","{3"+X$,"  010203","AP2MAB36","","","" ! SSP 217566 214091
3290 GOTO 2020
3292 REM "Commission Substitution code ssp 217566
3293 IF MID(SEC$,100,1)="Y" THEN GOTO 3297 ! SSP 222237
3294 X$="Commission Substitution Code" ! ssp 217566
3295 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,75,15+V0,235,1,C0,"","{3"+X$,"","AP2MAB38","","","" ! SSP 217566
3298 GOTO 2020 ! SSP 217566
3300 REM "Our account number with vendor, WO125052
3305 X$="Our account number with the vendor"
3310 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,62,16+V0,309,15,C0,"","{3"+X$,"","AP2MAB38","","",""
3340 GOTO 2020
3350 REM "Web address, WO125052
3360 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,39,17+V0,324,40,C0,"","{3"+X$,"","AP2MAB40","","",""
3390 GOTO 2020
3400 REM "SPC - SSP# 149128
3410 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,18,17+V0,223,8,C0,"","{3"+X$,"","AP2MAB42","","",""
3445 GOTO 2020
3450 REM " Print PO? - ssp# 149128
3460 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,31,15+V0,231+K9,1,C0,"","{3"+X$,"","AP2MAB44","","",""
3490 GOTO 2020
3500 REM "Number of Days from Order date to PO Ship date SSP 184913
3510 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,75,21,364,3,C0,"","{3"+X$,"","","","",""
3540 GOTO 2020
3550 REM "E/F jOB CARD override
3560 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,43,21,367,15,C0,"","{3"+X$,"","AP2MAB46","","",""
3570 GOTO 2020
3600 REM Options for SPC, SSP189102
3605 X$="189102 Options for program in SPC field"
3610 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,7,20+V0,382,20,C0,"","{3"+X$,"","AP2MAB48","","",""
3640 GOTO 2020
3650 REM "Cust Supplied PO SSP198988
3651 IF MID(SEC$,101,1)="Y" THEN GOTO 3689 ! SSP 223946
3655 X$="198988 Enter Y for Customer Supplied PO Vendor"
3660 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,42,11+V0,402+K9,1,C0,"","{3"+X$,"","AP2MAB26","","",""
3690 GOTO 2020
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6060 PRINT @(5,3+V0),"Vendor Code:",@(30,3+V0),"Name:",@(0,4+V0),Z0$,
6065 CALL "ZY2AAA",X3$,X4$,Y0,Y1+V0,"A","Contact",0,A9$,"",0,0,0
6070 PRINT @(0,9+V0),Z0$,
6080 PRINT @(3,10+V0),"Vendor status:",@(41,10+V0),"Payment selection code:",@(1,11+V0),"Vendor category:",@(47,11+V0),"Payment priority:",@(0,12+V0),"Standard comment:",@(44,14),"Mailing Label Types:",@(41,12+V0),"Vendor on payment hold?",@(1,13+V0),"Std G/L account:",@(0,14+V0),"Standard payment:",@(2,16+V0),"Std terms code:",
6081 PRINT @(28,11),"Cust Supp PO: ",; REM SSP 198988
6082 IF POS(X3$(9,3)="500538118130",3)>0 THEN PRINT @(35,15+V0),"File output format:",; REM "WO126561 WO 217566        
6083 PRINT @(53,16+V0),"Acct no:",; REM "WO125052
6085 IF F0$(16,1)="Y" THEN PRINT @(3,15+V0),"Std Bank acct:",
6086 PRINT @(21,15+V0),"Print PO?",; REM " SSP# 149128
6090 PRINT @(13,17+V0),"SPC:",; REM " SSP# 149128
6095 PRINT @(29,17+V0),"Web addr:",; REM "WO125052
6098 PRINT @(2,20+V0),"Opt:",
6110 PRINT @(60,15+V0),"Comm Sub Code:", ! ssp 217566
6140 IF F0$(66,1)="Y" THEN PRINT @(6,18+V0),"Should past due discounts always be taken for this vendor?",@(5,19+V0),"Special invoice items to include for discount calculations:",@(28,20+V0),"Number of extra days you can string 'em along:",
6145 IF F0$(78,1)="Y" THEN PRINT @(1,21+V0),"Intcmpy GL Acct:"
6146 PRINT @(59,21+V0),"# days-Ship Dt:",; REM SSP184913
6147 PRINT @(29,21),"E/F Job Card:"
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6220 PRINT @(36,3+V0),A$(11+K9,35),
6222 CALL "ZY2AAA",X3$,X4$,Y0,Y1+V0,"A","Contact",1,A9$,"",0,0,0
6223 IF A$(246+K9,1)="I" THEN A8$="Inactive" ELSE IF A$(246+K9,1)="T" THEN A8$="Temporary" ELSE A8$="Active"
6224 PRINT @(18,10+V0),A8$,; CALL "ZZDISP","A",A$(247+K9,9),"AP2",X3$,"","",18,11+V0,X4$
6228 PRINT @(18,12+V0),A$(256+K9,15),
6230 B$=""; FIND (Z[2],KEY=A$(271+K9,12),ERR=6231)B$
6232 CALL "ZZDISP","A",A$(271+K9,12),"G/L",X3$,"","",18,13+V0,X4$; IF B$>"" THEN PRINT @(18+L9,13+V0),B$(13,35),
6240 PRINT @(18,14+V0),A[0]:M0$,
6241 PRINT @(31,15+V0),A$(231,1); REM " SSP# 149128
6242 PRINT @(42,11+V0),A$(402+K9,1); REM SSP 198988
6245 IF F0$(16,1)="Y" THEN PRINT @(18,15+V0),A$(283+K9,3),
6247 PRINT @(62,16+V0),A$(309,15),@(39,17+V0),A$(324,40),; REM "WO125052
6260 PRINT @(18,16+V0),A$(286+K9,2),@(22,16),D$(3,30),@(65,10+V0),A$(288+K9,2),@(65,11+V0),A$(290+K9,1),@(65,12+V0),A$(291+K9,1),@(65,14+V0),A$(300,3),@(69,14+V0),A$(303,3),@(73,14+V0),A$(306,3),
6265 IF POS(X3$(9,3)="500538118130",3)>0 THEN PRINT @(55,15+V0),A$(221,2),; REM "WO126561 SSP 217566
6270 IF F0$(66,1)="Y" THEN PRINT @(65,18+V0),A$(293+K9,1),@(65,19+V0),A$(294+K9,6),@(75,20+V0),A[1]:M1$,
6273 PRINT @(7,20+V0),A$(382,20),
6275 IF F0$(78,1)<>"Y" THEN GOTO 6291
6280 B$=""; FIND (Z[2],KEY=A$(209+K9,12),DOM=6281)B$; PRINT @(18,21+V0)
6285 CALL "ZZDISP","A",A$(209+K9,12),"G/L",X3$,"","",18,21+V0,X4$
6290 ! IF B$>"" THEN PRINT @(18+L9,21+V0),B$(13,30),
6292 PRINT @(43,21),A$(367,15), ! SSP 186670
6294 PRINT @(18,17+V0),A$(223,8),; REM " SSP# 149128
6295 PRINT @(75,21),A$(364,3),; REM "SSP 184913
6298 PRINT @(75,15+V0),A$(235,1), ! SSP 217566
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6460 CALL "ZZDISP","A",A$(1+K9,10),"A/P",X3$,"","",18,3+V0,X4$
6490 RETURN 
6500 REM "DELETE
6510 REMOVE (Z[1],KEY=A1$,DOM=6511)
6515 IF W9$>"" THEN IF W9$(7,1)="H" THEN CALL "RT2WOR",ERR=6516,X3$,X4$,"","AP4...","D",A1$,A$,2,A{ALL}; REM "Record remote T/M change if this is the host
6590 GOTO 1630
6600 REM "ALT KEY DATA READS
6690 RETURN 
6700 REM "ADD ENTRY
6702 FIND (Z[5],KEY=A$(247+K9,9),DOM=6703)IOL=0350; GOTO 6710
6703 CALL "ZZPROM",".4",X3$,S3,"A valid Vendor Category Code is required","","",0; X0=3; GOTO 2250
6705 REM IFZ9=0GOTO6790
6710 WRITE (Z[1],KEY=A1$)IOL=0310
6715 IF W9$>"" THEN IF W9$(7,1)="H" THEN CALL "RT2WOR",ERR=6716,X3$,X4$,"","AP4...","U",A1$,A$,2,A{ALL}; REM "Record remote T/M change if this is the host
6720 IF A2$=A$(145,10)+A$(1,10) THEN GOTO 6730
6722 WRITE (Z[7],KEY=A$(145,10)+A$(1,10))
6723 IF W9$>"" THEN IF W9$(7,1)="H" THEN CALL "RT2WOR",ERR=6724,X3$,X4$,"","AP6...","U",A$(145,10)+A$(1,10),"",0,A{ALL}; REM "Record remote T/M change if this is the host
6724 REMOVE (Z[7],KEY=A2$,DOM=6725)
6725 IF W9$>"" THEN IF W9$(7,1)="H" THEN CALL "RT2WOR",ERR=6726,X3$,X4$,"","AP6...","D",A2$,"",0,A{ALL}; REM "Record remote T/M change if this is the host
6730 IF A3$=A$(247,9)+A$(1,10) THEN GOTO 6740
6732 WRITE (Z[8],KEY=A$(247,9)+A$(1,10))
6733 IF W9$>"" THEN IF W9$(7,1)="H" THEN CALL "RT2WOR",ERR=6734,X3$,X4$,"","AP7...","U",A$(247,9)+A$(1,10),"",0,A{ALL}; REM "Record remote T/M change if this is the host
6734 REMOVE (Z[8],KEY=A3$,DOM=6735)
6735 IF W9$>"" THEN IF W9$(7,1)="H" THEN CALL "RT2WOR",ERR=6736,X3$,X4$,"","AP7...","D",A3$,"",0,A{ALL}; REM "Record remote T/M change if this is the host
6740 IF POS(X3$(9,3)="060338363364365366476",3)<>0 THEN IF A4$=A$(195,12)+A$(1,10) THEN GOTO 6750 ELSE IF A4$=A$(195,10)+A$(1,10) THEN GOTO 6750
6742 IF POS(X3$(9,3)="060338363364365366476",3)<>0 THEN J$=A$(195,12)+A$(1,10); WRITE (Z[9],KEY=A$(195,12)+A$(1,10)) ELSE J$=A$(195,10)+A$(1,10); WRITE (Z[9],KEY=A$(195,10)+A$(1,10))
6743 IF W9$>"" THEN IF W9$(7,1)="H" THEN CALL "RT2WOR",ERR=6744,X3$,X4$,"","AP1...","U",J$,"",0,A{ALL}; REM "Record remote T/M change if this is the host
6744 REMOVE (Z[9],KEY=A4$,DOM=6750)
6745 IF W9$>"" THEN IF W9$(7,1)="H" THEN CALL "RT2WOR",ERR=6746,X3$,X4$,"","AP1...","D",A4$,"",0,A{ALL}; REM "Record remote T/M change if this is the host
6775 IF POS(X3$(30,1)="M")>0 THEN IF POS(A1$(1,2)="0001",2)>0 THEN CALL "CM2AAA",X3$,Z[1],1,A1$,"",X9
6790 GOTO 1630
6800 REM "NEXT ENTRY IN FILE
6805 ON 10*FPT(C0)+2 GOTO 6850,6806
6810 A1$=KEY(Z[1],END=1140)
6820 A$(1,LEN(A1$))=A1$
6825 IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 1140
6830 GOSUB 6600
6835 GOSUB 6450
6840 GOTO 1515
6850 REM PRIOR ENTRY
6855 CALL "ZZKEYP",ERR=6856,Z[1],A1$; GOTO 6820
6860 CALL "ZZKEYL",ERR=6861,Z[1],A1$; GOTO 6820
6870 GOTO 6895
6890 GOTO 1515
7300 REM 
7310 ON FPT(C0)*10 GOTO 7390,7325,7330,7390
7325 IF V8$="" THEN X0=X0+4; GOTO 7390 ELSE X0=NUM(V8$(POS(STR(X0:"00")<=V8$,2),2)); GOTO 7390
7330 IF V8$="" THEN X0=X0-6; GOTO 7335 ELSE X0=POS(STR(X0-1:"00")<=V8$,2)-2; IF X0<0 THEN X0=0; GOTO 7390 ELSE X0=NUM(V8$(X0,2)); GOTO 7390
7335 IF X0<0 THEN X0=0; GOTO 7390
7390 C0=3; RETURN 
7500 REM "SPECIAL AMOUNTS
7502 IF F1$="" THEN GOTO 7590
7505 X$="",X9=0,X9$="",X9$=" "
7510 FOR X=0 TO 3
7515 IF F1$(23+X*20,1)<>" " THEN X$=X$+STR(X+1)+"= "+FNS$(F1$(8+X*20,16))+", ",X9=X9+1,X9$=X9$+STR(X+1)
7520 NEXT X
7525 IF X$>"" THEN X$=X$(1,LEN(X$)-2)
7590 RETURN 
7600 REM "GET SORT KEY FROM NAME
7605 Q$=A$(11+K9,35)
7610 FOR X=1 TO LEN(Q$)
7615 IF Q$(X,1)>="a" AND Q$(X,1)<="z" THEN Q$(X,1)=CHR(ASC(Q$(X,1))-32)
7620 NEXT X
7625 IF Q$(1,2)="A " THEN Q$=Q$(3)
7630 IF Q$(1,4)="THE " THEN Q$=Q$(5)
7680 A$(128+K9,10)=Q$; PRINT @(63,5),A$(128+K9,10),
7690 RETURN 
7810 CALL "ZZDISP","AX","000000000000","G/L",X3$,W2$,"",0,0,X4$; L9=2+LEN(W2$); RETURN 
8950 REM "Program flow logic
8960 DIM U0$(6); U0$(1)=FID(0); U0$=U0$+"PF"
8970 CLOSE (14); OPEN (14)"ZZPARM"; FIND (14,KEY=U0$,DOM=8990)U0$,U1$
8980 Q1=NUM(U1$(7,2)),Q1$=U1$(9,Q1),U1$=U1$(Q1+9)
8981 IF LEN(U1$)>5 AND U1$(1,6)="AP2MAA" THEN Q2$="*"
8990 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9700 REM "PROG FLOW
9710 IF U1$="" THEN REMOVE (Z[13],KEY=U0$,DOM=9900); GOTO 9900
9720 WRITE (Z[13],KEY=U0$)U0$,U1$
9725 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9730 RUN U1$(1,6)
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
56000 REM "186670-Add ability to output purchase orders by a Vendor Set       
56010 REM "189102-Solion / Printegra XML Interface
56015 REM "193087 - With 189102 changes - many display issues
56016 REM 198988-Manage Customer Supplied Inventory. Item Setup, Purch ord 
56017 REM "214091-Email from Brenda requesting ability to have another  
56018 REM "241185-Program AP2MAA in vendor setup, if your AP parameter is set 
