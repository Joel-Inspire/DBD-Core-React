0010 REM "Manual Check Entry <AP2CMA>
0020 SETESC 9300; SETERR 9000
0035 REM "4.1 - 08/18/98 - 9.07 - cwj - SSP# 102080
0040 REM "Copyright 1997 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0085 IF S0<>0 THEN GOTO 7000
0090 V0=0; ON L0 GOTO 0100,3600,3700,7100
0100 CLEAR ; SETERR 9000
0110 X0$="AP2CMA",X1$="Manual Check Entry",K9$="",K9=0
0115 DIM T[4],S$(35),Y[4],D$(76)
0120 DIM Z0$(80,"-")
0126 F2$="*"
0130 K0=20,K1=5
0140 M0$="-###,###,###.00"
0165 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0290 IOLIST Y[0],Y[1],Y[2],Y[3],Y[4]
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0310 IOLIST A$(1,LEN(A$)),A[0],A[1],A[2]
0320 IOLIST B$
0330 IOLIST C$,C[0],C[1],C[2]
0340 IOLIST D$(1),D[0],D[1],D[2],D[3],D[4]
0350 IOLIST E$,E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10],E[11],E[12],E[13],E[14]
0410 IOLIST F$,F0,F1,F2
0420 IOLIST G$,G[0],G[1],G[2],G[3],G[4],G[5],G[6],G[7]
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X APR...  02ORZYB...  03ORAP4...  04X APT...  05ORAPI...  07ORAPQ...  08X APU...  09ORGL1...  10ORAPY...  11ORAPM...  12ORAPN...  06X ZZPARM  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0560 READ (Z[6],KEY=X3$(9,3)+"A/P",DOM=9800)F0$
0565 DIM F1$(110); READ (Z[6],KEY=X3$(9,3)+"AP2A",DOM=0566)F1$
0580 FIND (Z[6],KEY=X3$(9,3)+"G/LYE"+F0$(7,4),DOM=0581)P1$
0585 DIM SEC$(255); FIND (Z[6],KEY="osec"+X3$(40,3),DOM=0586)SEC$; REM "ADD CWJ 7/6/98, SSP089851
0604 GOSUB 7300
0605 GOSUB 7400
0610 GOSUB 7800
0620 GOSUB 6000
1005 A0=0
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1030 DIM B$(200),C$(227),C[2],D[4]
1035 DIM A$(37+K9),A[2]
1040 A1$=F0$(7,6)+F0$(17,3)+"H"
1045 A$(1,LEN(A1$)+K9)=K9$+A1$
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1200,1250,1300,1350,1400,1500
1205 IF LEN(A1$)>0 THEN A$(1,4)=A1$(1,4); GOTO 1212
1207 Q$=X3$(9,3)+"G/LYE"
1210 CALL "ZZENTR","ZXUX",A{ALL},A$,X4$,X3$,14,3+V0,1+K9,4,C0,"","{1"+X$,Q$,"AP2CMA00","GLYE","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1210,1211
1215 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1216,6800,9800,6970
1220 FIND (Z[6],KEY=X3$(9,3)+"G/LYE"+A$(1,4),DOM=1210)P1$
1223 IF POS(P1$(99,1)="CR")<>0 THEN CALL "ZZPROM",".4",X3$,Z,"Closed Years must be reopened by System Administrator prior to posting.","","",0; GOTO 1210
1240 GOTO 1120
1254 IF ABS(C0)=2 THEN A1$=""; GOTO 1120
1255 IF LEN(A1$)>4 THEN A$(5,2)=A1$(5,2); GOTO 1262
1260 CALL "ZZENTR","ZUX",A{ALL},A$,X4$,X3$,43,3+V0,5+K9,2,C0,"","{2"+X$,"","AP2CMA02","","",""
1262 IF ABS(C0)=2 AND LEN(A1$)>0 THEN A1$=A1$(1,0)
1265 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1266,6800,9800,6970
1267 IF A$(5+K9,2)<"01" OR A$(5+K9,2)>P1$(13,2) THEN GOTO 1260
1270 GOSUB 7700
1271 FLAG$=""
1273 IF C0<>0 THEN CALL "AR2DTE",X3$,X4$,A$(1+K9,6),FLAG$
1274 IF FLAG$="*" THEN GOTO 1260
1290 GOTO 1120
1304 IF F2$="*" THEN F2$="",A1$="",X0=0; GOTO 1140
1305 IF LEN(A1$)>6 THEN A$(7,3)=A1$(7,3); GOTO 1312 ELSE IF F0$(16,1)<>"Y" THEN A$(7,3)=F0$(17,3); GOTO 1312
1310 CALL "ZZENTR","SZUX",A{ALL},A$,X4$,X3$,14,4+V0,7+K9,3,C0,"",X$,"","AP2CMA04","ZYB","ZY2BAA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1310,1311
1312 IF ABS(C0)=2 AND LEN(A1$)>4 THEN A1$=A1$(1,4)
1320 FIND (Z[2],KEY=A$(7+K9,3),DOM=1310)IOL=0320
1325 IF F0$(16,1)="Y" THEN PRINT @(43,4+V0),B$(4,30),
1340 GOTO 1120
1352 X$="R=Reversal, H=Handwritten, V=Void, P=Print check"
1355 IF LEN(A1$)>9 THEN A$(10,1)=A1$(10,1); GOTO 1362
1360 CALL "ZZENTR","SRUX",A{ALL},A$,X4$,X3$,14,5+V0,10+K9,1,C0,"","{2"+X$,"RVPH","AP2CMA06","RVM","",""
1362 IF ABS(C0)=2 AND LEN(A1$)>6 THEN A1$=A1$(1,6)
1365 IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1366,6800,9800,6970
1390 GOTO 1120
1405 IF A$(10+K9,1)="P" THEN GOTO 1450 ELSE Q$=A$(1,10)
1410 CALL "ZZENTR","ZUX",A{ALL},A$,X4$,X3$,43,5+V0,11+K9,6,C0,"","{2"+X$,Q$,"AP2CMA08","APR","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1410,1411
1412 IF ABS(C0)=2 AND LEN(A1$)>9 THEN A1$=A1$(1,9)
1415 IF C0=-1 THEN GOTO 1410 ELSE IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1416,6800,9800,6970
1440 GOTO 1120
1460 CALL "ZZENTR","AUX",A{ALL},A$,X4$,X3$,14,6+V0,11+K9,10,C0,"A/P","{2"+X$,"","AP2CMA10","AP4","X",""; IF ABS(C0)=102 THEN Q1$="",Z8$="AP2MAB",S0=2; RUN "ZZ2STP" ELSE IF C0<>-7 THEN IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1460,1461
1461 REM "CALL "ZZENTR","AX",A(ALL),A$,X4$,X3$,14,6+V0,11+K9,10,C0,"A/P","{2"+X$,"","AP2CMA10","AP4","AP2MAA",""; IF ABS(C0)>4 THEN GOSUB 06400; ON C0 GOTO 01460,01461
1462 IF ABS(C0)=2 AND LEN(A1$)>9 THEN A1$=A1$(1,9)
1465 IF C0=-1 THEN GOTO 1460 ELSE IF C0<0 THEN ON INT(ABS(C0)-2) GOTO 1466,6800,9800,6970
1466 IF C0=-2 THEN IF POS(" "<>A$(21+K9,10))=0 THEN GOTO 1120
1467 A$(21+K9,10)=A$(11+K9,10)
1470 FIND (Z[3],KEY=A$(21+K9,10),DOM=1460)IOL=0330
1475 PRINT @(14,7+V0),C$(11,35),
1490 GOTO 1120
1505 Z9=-1
1510 A1$=A$(1,20+K9),A$(1,LEN(K9$))=K9$,F0$(7,6)=A1$(1,6),F0$(17,3)=A1$(7,3)
1520 EXTRACT (Z[1],KEY=A1$,DOM=1600)IOL=0310
1525 Z9=0
1530 FIND (Z[3],KEY=A$(21+K9,10),DOM=1531)IOL=0330
1590 GOTO 1700
1610 GOSUB 5300
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630,6975
1630 GOTO 1000
1660 I9=-1
1690 GOTO 2000
1720 GOSUB 6200
1820 CALL "ZZPROM","X0AP2CMA",X3$,Z,"","","",0
1822 IF A$(10,1)="V" THEN I9=0; IF Z=1 THEN Z=3
1825 ON Z+1 GOTO 2010,2000,3000,6500,6700
1830 GOTO 2000
2010 C0=0,X0=-1,X1=1
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF C0>3 OR X0<0 THEN GOTO 1800
2035 IF X0*6+11<LEN(V9$) THEN IF V9$(X0*6+11,1)="2" THEN GOTO 2020
2040 ON X0 GOTO 2100,2150,2200,2250,1800
2105 IF POS(A$(10,1)="PV")>0 THEN GOTO 2020
2108 X$="Press F10 to retreive by Phone Number"
2110 CALL "ZZENTR","AUX",A{ALL},A$,X4$,X3$,14,6+V0,21+K9,10,C0,"A/P","{3"+X$,"","AP2CMA10","AP4","X",""; IF ABS(C0)=102 THEN Q1$="",Z8$="AP2MAB",S0=1; RUN "ZZ2STP" ELSE IF C0<>-7 THEN IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2110,2111
2115 IF C0=-7 THEN X$="AP",C0=1; CALL "ZZ2PLU",X3$,A$,21,X$; IF X$="" THEN GOTO 2108 ELSE CALL "ZZDISP","A",A$(21,10),"A/P",X3$,"","",14,6+V0,X4$
2118 IF X3$(330,1)="1" THEN IF A$(21+K9,2)="00" THEN CALL "ZZPROM",".4",X3$,0,"You may not pay this vendor (RL)","","",0; GOTO 2110
2120 FIND (Z[3],KEY=A$(21+K9,10),DOM=2108)IOL=0330
2122 IF C$(209,12)<>"            " THEN X$="You can not do manual checks on this account!",X0=-3; CALL "ZZPROM",".4",X3$,Z,X$,"","",0; GOTO 2110; REM "cwj 7/7/98 ssp#089851
2125 PRINT @(14,7+V0),C$(11,35),
2140 GOTO 2020
2155 IF A$(10,1)="V" THEN GOTO 2020
2160 CALL "ZZENTR","D",A{ALL},A$,X4$,X3$,69,5+V0,31+K9,6,C0,"","{3"+X$,"","AP2CMA12","","",""
2190 GOTO 2020
2202 IF A$(10,1)="V" THEN GOTO 2020
2205 T=A[0]
2210 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,64,6+V0,0,922,C0,M0$,"{3"+X$,"","AP2CMA14","","",""
2220 IF T<>A[0] THEN A[1]=A[1]-T+A[0]; GOSUB 7610
2240 GOTO 2020
2255 IF A$(10,1)="V" THEN GOTO 2020
2260 CALL "ZZENTR","NS",A{ALL},A$,X4$,X3$,64,7+V0,1,922,C0,M0$,X$,"","AP2CMA16","","",""
2290 GOTO 2020
3005 PRINT 'SB'; GOSUB 6200; PRINT 'SF',
3010 DIM D$(76),D[4]
3012 V=6,I9=0
3015 D$(1,LEN(A1$))=A1$
3025 PRINT 'CF',
3026 G9$=A$(21,10),A0=0
3028 X$="Enter invoice number, Return or F4 to end"
3030 CALL "ZZENTR","SXU",D{ALL},D$,X4$,X3$,16,3+V,21,10,C0,"",X$,G9$,"AP2CMC00","API","",""; IF ABS(C0)>4 THEN GOSUB 6400; PRINT @(16,3+V),D$(21,10),; ON C0 GOTO 3030,3031
3035 IF C0<0 THEN GOTO 1800
3105 D9=-1,D8=0
3110 READ (Z[4],KEY=D$(1,30+K9),DOM=3120)IOL=0340; D9=0,D8=D[1]-D[2],A0=D[0]
3115 GOTO 3180
3120 GOSUB 8000; IF D[0]=0 THEN GOSUB 8100 ELSE GOSUB 8150; IF A$(7,3)<>E$(66,3) THEN CALL "ZZPROM",".4",X3$,Q,"Warning: Invoice is setup for bank code "+E$(66,3),"","",0
3125 IF D[0]=-1 THEN CALL "ZZPROM",".Y",X3$,Z,X$,"","",0; X$=""; ON Z GOTO 3140,3010
3130 CALL "ZZPROM","2",X3$,Z,X$,"","",0; X$=""; ON Z GOTO 3140,3010
3180 T[0]=D[4]-D[2]*POS("L"=F0$(15,1)),A0=D[0]
3185 IF D9<0 THEN C=3 ELSE C=2
3190 CALL "AP2CMC",X3$,X4$,D$,D{ALL},1,A1$
3220 CALL "AP2CMC",X3$,X4$,D$,D{ALL},C,A1$
3225 IF C=2 THEN WRITE (Z[4],KEY=D$(1,30))IOL=0340
3230 IF C=1 THEN GOTO 3700 ELSE IF C=2 THEN GOTO 3400
3290 GOTO 3010
3405 IF D[0]<0 THEN GOTO 3600
3410 V9=1; PRINT @(0,10),'SB',Z0$,'CE',
3420 L0=1,F=Z[8],A0=D[0]
3430 V3=Z[9],V4=-1,V5=-1,A9$=""
3440 T[0]=T[0]-(D[4]-D[2]*POS("L"=F0$(15,1)))
3470 IF D[0]=0 AND C$(271,1)<>" " THEN T9$=C$(271,12),T[1]=-T[0],T[0]=T[1] ELSE T9$=""
3480 RUN "GL2XAA"
3605 IF D[0]>=0 THEN D[0]=A0
3610 WRITE (Z[4],KEY=D$(1,30))IOL=0340
3620 A[1]=A[1]+D8-(D[1]-D[2]); GOSUB 7600
3690 IF D[0]>=0 THEN GOSUB 7900; GOTO 3010
3695 GOTO 3010
3710 IF A0>0 THEN GOSUB 5900
3730 REMOVE (Z[4],KEY=D$(1,30),DOM=3731)
3740 A[1]=A[1]+D8; GOSUB 7600
3790 GOTO 3690
5010 PRINT @(0,20),'CE',@(20,20),"Reversing check number: ",A$(11,6),
5020 DIM F$(76); F3$=""
5025 READ (Z[11],KEY=A9$(10,6)+A9$(1,3)+A$(11,6),DOM=5026)
5026 READ (Z[11],END=5035)IOL=0410
5027 IF F$(7,9)<>A$(7,3)+A$(11,6) THEN GOTO 5035
5030 F3$=F3$+F$(16,2),A$(21+K9,10)=F$(25,10),A$(31+K9,6)=F$(19,6),A[0]=A[0]-F2
5034 GOTO 5026
5035 FIND (Z[3],KEY=A$(21+K9,10),DOM=5036)IOL=0330
5040 GOSUB 6200
5080 GOSUB 5100
5085 CALL "ZZPROM",".4",X3$,Z,"","","",0
5090 PRINT @(0,20),'CE',
5095 RETURN 
5104 IF F3$="" THEN GOTO 5190
5105 F4$=A9$(10,6)+A9$(1,3)+A$(11,6)
5110 FOR I9=1 TO LEN(F3$) STEP 2
5115 READ (Z[12],KEY=F4$+F3$(I9,2),DOM=5116)
5119 DIM G$(43),G[7]
5120 READ (Z[12],END=5150)IOL=0420
5125 IF G$(1,17)<>F4$+F3$(I9,2) THEN GOTO 5150
5130 DIM D$(76),D[4]; D$(1)=A1$+G$(18,10)
5131 PRINT @(54,20),'CL',D$(21,10),
5134 READ (Z[4],KEY=D$(1,30+K9),DOM=5135)IOL=0340; GOTO 5140
5135 GOSUB 8000; IF D[0]=0 THEN GOSUB 8100 ELSE I8=1; GOSUB 8150; I8=0
5140 D[1]=D[1]-G[1],D[2]=D[2]-G[2],D[3]=D[3]-G[7],D[4]=E[13]
5145 WRITE (Z[4],KEY=D$(1,30+K9))IOL=0340
5149 GOTO 5119
5150 NEXT I9
5190 RETURN 
5310 IF A$(10,1)="R" THEN GOTO 5400
5320 READ (Z[10],KEY=A$(7,3)+A$(11,6),DOM=5321)
5325 A9$=KEY(Z[10],END=5390)
5330 IF A9$(1,9)<>A$(7,3)+A$(11,6) THEN GOTO 5390
5340 CALL "ZZPROM",".Y",X3$,Z,"This check is on file. Is this a check reversal?","","",0
5345 ON Z GOTO 5360,5350
5355 EXTRACT (Z[1],KEY=A1$,DOM=5356)IOL=0310; EXITTO 1521
5356 RETURN 
5365 A$(10,1)="R",A1$(10,1)="R"; PRINT @(14,5+V0),"R",; EXTRACT (Z[1],KEY=A1$,DOM=5366)IOL=0310; EXITTO 1521
5370 GOSUB 5000; GOSUB 6700; EXITTO 1630
5390 RETURN 
5410 READ (Z[10],KEY=A$(7,3)+A$(11,6),DOM=5411)
5415 A9$=KEY(Z[10],END=5430)
5420 IF A9$(1,9)=A$(7,3)+A$(11,6) THEN GOSUB 5000; GOSUB 6700; EXITTO 1630
5435 CALL "ZZPROM",".5",X3$,Z,"The check information for this reversal is not on file.","","",0
5440 ON Z GOTO 5490,5450
5455 EXITTO 1630
5490 RETURN 
5905 F=Z[8]
5910 IF A0<=0 THEN GOTO 5990
5920 EXTRACT (F,IND=0,ERR=5960)IOL=0290
5925 IF Y[4]=-2 THEN READ (F,IND=0); WAIT 0; GOTO 5920 ELSE Y[4]=-2; WRITE (F,IND=0)IOL=0290
5930 A1=Y[1],Y[1]=A0,Y[0]=Y[0]-1
5935 READ (F,IND=A0)A; IF A>0 THEN Y[0]=Y[0]-1,A0=A; GOTO 5935
5940 WRITE (F,IND=A0)A1
5950 Y[4]=-1; WRITE (F,IND=0)IOL=0290
5955 GOTO 5990
5960 IF ERR=0 THEN RETRY ELSE GOTO 9000
5990 RETURN 
6005 PRINT (0,ERR=6016)'SB',
6060 PRINT @(1,3+V0),"Fiscal year:",@(24,3+V0),"Accounting period:",@(51,3+V0),"Period ends:",; IF F0$(16,1)="Y" THEN PRINT @(0,4+V0),"Account code:",@(23,4+V0),"Bank account descr:", ELSE PRINT @(0,4+V0),Z0$,
6070 PRINT @(2,5+V0),"Check type:",@(29,5+V0),"Check number:",@(58,5+V0),"Date:",@(1,6+V0),"Vendor Code:",@(52,6+V0),"Net amount:",@(7,7+V0),"Payee:",@(55,7+V0),"Balance:",@(0,8+V0),Z0$,
6090 GOSUB 7900
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6202 IF X0=4 THEN PRINT 'SB',
6215 GOSUB 6450
6220 CALL "ZZDISP","A",A$(21+K9,10),"A/P",X3$,"","",14,6+V0,X4$
6224 PRINT @(14,7+V0),C$(11,35),
6228 CALL "ZZDISP","D",A$(31+K9,6),"",X3$,"","",69,5+V0,X4$
6232 PRINT @(64,6+V0),A[0]:M0$,@(64,7+V0),A[1]:M0$,
6380 PRINT 'SF',
6390 RETURN 
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6455 IF C9<0 THEN GOTO 6445
6460 PRINT @(14,3+V0),A$(1+K9,4),@(43,3+V0),A$(5+K9,2),; IF F0$(16,1)="Y" THEN PRINT @(14,4+V0),A$(7+K9,3),@(43,4+V0),B$(4,30),
6465 PRINT @(14,5+V0),A$(10+K9,1),
6470 IF A$(10,1)<>"P" THEN PRINT @(43,5+V0),A$(11+K9,6), ELSE PRINT @(43,5+V0),"None",
6490 RETURN 
6505 READ (Z[4],KEY=A1$(1,16),DOM=6506)
6510 W$=KEY(Z[4],END=6580); READ (Z[4])IOL=0340; IF W$(1,16)=A1$(1,16) THEN REMOVE (Z[4],KEY=W$) ELSE GOTO 6580
6520 A0=D[0]; GOSUB 5900; GOTO 6510
6580 REMOVE (Z[1],KEY=A1$,DOM=6581)
6585 PRINT (0,ERR=6586)'SF',; GOSUB 6220
6590 GOTO 1630
6605 FIND (Z[1],KEY=A$(1+K9,4),DOM=6606)IOL=0310
6610 FIND (Z[2],KEY=A$(7+K9,3),DOM=6611)IOL=0320
6690 RETURN 
6705 IF I9<0 THEN GOTO 3000 ELSE IF A[1]<>0 THEN CALL "ZZPROM","4",X3$,Q,"This check is not in balance.","","",0; GOTO 1800
6710 WRITE (Z[1],KEY=A1$)IOL=0310
6720 GOSUB 8900
6790 GOTO 1630
6805 ON 10*FPT(C0)+2 GOTO 6850,6806
6810 A1$=KEY(Z[1],END=6895)
6820 IF A1$="" THEN GOTO 6800 ELSE IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 6895
6825 A$(1,LEN(A1$))=A1$
6830 GOSUB 6600
6835 GOSUB 6450
6840 GOTO 1515
6855 CALL "ZZKEYP",ERR=6856,Z[1],A1$; GOTO 6820
6860 CALL "ZZKEYL",ERR=6861,Z[1],A1$; GOTO 6820
6870 GOTO 6895
6890 GOTO 1515
6895 PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=1140); GOTO 1140
6970 GOTO 3000
7005 S1=S0,S0=0
7010 ON S1 GOTO 7090,7015,7020
7015 IF Q1$<>"" THEN A$(21+K9,10)=Q1$,C0=1; GOSUB 6400; GOTO 2111 ELSE C0=0; GOSUB 6400; GOTO 2110
7020 IF Q1$<>"" THEN A$(21+K9,10)=Q1$,A$(11+K9,10)=Q1$,C0=1; GOSUB 6400; GOTO 1461 ELSE C0=0; GOSUB 6400; GOTO 1460
7090 GOTO 0090
7105 V0=0,M0$="-###,###,###.00"
7110 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,0,0,0
7120 GOSUB 6000
7140 GOSUB 6450
7145 X0=4; GOSUB 6200; X0=1
7150 CALL "AP2CMC",X3$,X4$,D$,D{ALL},10,A1$
7185 V9=1; PRINT @(0,10),'SB',Z0$,'CE',
7190 GOTO 3480
7305 FIND (Z[6],KEY=X3$(9,3)+"APC"+X3$(174,4),DOM=7340)
7320 CALL "ZZPROM",".4",X3$,0,"Check printing has been started and must be completed..","","",0; GOTO 9900
7340 RETURN 
7410 FIND (Z[1],KEY="",DOM=7490)V0$,K0$
7420 IF K0$>"" THEN CALL "ZZPROM",".4",X3$,S3,"The update has already been initiated. Press |Return>","","",0; GOTO 9900
7430 EXTRACT (Z[1],KEY="",ERR=9800)
7440 Q$="Audit report "+V0$(22,4)+"."+V0$(26,2)+" has already been printed for this data entry."
7445 CALL "ZZPROM","1",X3$,S3,Q$,"","",0; ON S3 GOTO 9800,7446
7450 REMOVE (Z[1],KEY="")
7490 RETURN 
7605 PRINT 'SB',
7610 PRINT @(64,7+V0),A[1]:M0$
7615 PRINT 'SF',
7640 RETURN 
7720 IF P1$>"" THEN PRINT @(64,3+V0),FND$(P1$(NUM(A$(5+K9,2))*6+15,6)),
7749 RETURN 
7750 PRINT @(55,11+V0),"Ending ",FND$(P9$(NUM(A$(19+K9,2))*6+15,6)),
7799 RETURN 
7810 CALL "ZZDISP","AX","000000000000","G/L",X3$,W2$,"",0,0,X4$
7815 M2=0; FOR X=1 TO LEN(W2$); M2=M2+POS("0"=W2$(X,1)); NEXT X
7820 CALL "ZZDISP","AX","000000000000","J/C",X3$,W3$,"",0,0,X4$
7825 M3=0; FOR X=1 TO LEN(W3$); M3=M3+POS("0"=W3$(X,1)); NEXT X
7830 CALL "ZZDISP","AX","000000000000","JCC",X3$,W4$,"",0,0,X4$
7835 M4=0; FOR X=1 TO LEN(W4$); M4=M4+POS("0"=W4$(X,1)); NEXT X
7840 RETURN 
7920 CALL "AP2CMC",X3$,X4$,D$,D{ALL},0,K9$
7940 RETURN 
7960 CALL "ZZPROM","4",X3$,S3,"Unable to do Manual Check Entry at this time.","","",0; GOTO 9900
8005 DIM E$(260),E[14]; X$=""
8010 FIND (Z[5],KEY=C$(1,10)+D$(21,10),DOM=8011)IOL=0350; GOTO 8020
8015 FIND (Z[7],KEY=C$(1,10)+D$(21,10),DOM=8090)IOL=0350; GOTO 8020
8025 D[0]=-1,X$="This invoice is already on file. Do you wish to pay it now?"
8090 RETURN 
8110 D$(31,6)=A$(31,6)
8120 D$(37,2)=C$(286,2),D$(39,9)=C$(247,9)
8125 D$(48,15)=C$(256,15)
8140 RETURN 
8160 D$(31,6)=E$(21,6)
8170 D$(37,2)=E$(27,2),D$(39,9)=E$(69,9)
8175 D$(48,25)=E$(41,25)
8178 IF I8=1 THEN GOTO 8190
8180 D[1]=E[13],D[2]=E[7]-E[11]
8181 IF E$(35,6)<A$(31,6) THEN D[2]=0
8182 D[3]=D[1]-D[2]
8183 D[4]=D[1]
8190 RETURN 
8905 DIM S$(35)
8910 PRINT @(14,6+V0),S$(1,11),@(14,7+V0),S$(1,35),@(69,5+V0),S$(1,10),@(64,6+V0),S$(1,LEN(M0$)),@(64,7+V0),S$(1,LEN(M0$))
8920 RETURN 
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9905 CALL "ZZDAPP",X3$,"!DAP2CMC"
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
