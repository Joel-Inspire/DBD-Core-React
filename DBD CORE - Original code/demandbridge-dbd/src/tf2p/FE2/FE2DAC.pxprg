0010 REM "Quotation Detail Entry - Estimate <FE2DAC>
0020 SETESC 9300; SETERR 9000
0030 REM "Copyright (C) 1986 Computer Software Inc., Norcross, Georgia
0035 REM "This software contains trade secrets and proprietary information"
0040 REM "and may not be reproduced in any form.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="FE2DAC",X1$="Quotation Detail - Estimate",K9$="",K9=0
0120 DIM Z0$(80,"-")
0130 K0=8,K1=2
0135 C9=-1
0140 M0$="##,##0-",M1$="###.00-",M2$="###,##0-",M3$="##,###.00-"
0200 REM "
0210 X0=-1
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1,LEN(A$)),A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13],A[14],A[15],A[16],A[17]
0320 IOLIST B$
0330 IOLIST C$
0340 IOLIST D$,D[0],D[1],D[2]
0350 IOLIST E9$,Y$,A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13]
0360 IOLIST F$
0370 IOLIST G$
0400 IOLIST J$,Y9$
0410 IOLIST I$
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X FE6...  02O FE5...  03O FMP...  04O AP4...  05O FE7...  06O FE1...  07O FE0...  08O FE1...  09OSFE1...  10O FE2...  11O AR3...  13O ZZPARM  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0590 READ (Z[1],KEY=K9$,DOM=0591)
0600 REM "
0800 REM "
0810 U0$=X3$(1,6)+"PF"
0820 FIND (Z[13],KEY=U0$,DOM=0900)U0$,U1$
0830 IF U1$>"" THEN Q1=NUM(U1$(7,2)),Q1$=U1$(9,Q1),U1$=U1$(Q1+9) ELSE REMOVE (Z[13],KEY=U0$)
0840 A1$=Q1$
1000 REM "
1005 C5=0
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1030 DIM B$(390),C$(100),D$(227),D[2],E$(200),I$(50),G$(80)
1035 DIM A$(111+K9),A[17]
1060 PRINT (0,ERR=1070)'CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1500 REM "
1505 Z9=-1
1510 IF LEN(Q1$)>8 THEN A$(150,8)=Q1$,A$(6,3)=Q1$(9) ELSE A$(150,8)=Q1$
1515 GOSUB 6600
1520 READ (Z[1],KEY=A1$,DOM=1600)IOL=0310
1525 Z9=0
1530 FIND (Z[3],KEY=A$(20+K9,3),DOM=1531)IOL=0330
1535 FIND (Z[4],KEY=A$(81+K9,10),DOM=1536)IOL=0340
1540 Y$=""; FIND (Z[5],KEY=A$(150,8)+A$(6,3),DOM=1541)IOL=0350
1550 FIND (Z[7],KEY=E9$,DOM=1551)IOL=0370
1580 GOSUB 7800
1590 GOTO 1700
1600 REM "
1610 GOSUB 6000
1615 GOTO 2000
1630 GOTO 4000
1690 GOTO 2000
1700 REM "
1705 GOSUB 6600
1710 GOSUB 6450
1715 IF Y$="" THEN Q0=1; GOTO 4100
1720 GOTO 4000
1800 REM "
1820 CALL "ZZPROM","1",X3$,Z,"","","V",X0; ON Z+1 GOTO 1890,4000,2000
1830 GOTO 2000
1850 REM "MODIFY
1855 Z9=1
1865 C9=1
1870 GOSUB 6200
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1,C9=1
2020 X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF C0>3 OR X0<0 THEN GOTO 1800
2040 ON X0 GOTO 2100,2150,2200,2250,2300,2350,2400,2450,2500,2550,2600,2650,2700,2750,2800,1800
2100 REM "Item type
2105 IF A$(9+K9,1)<>" " THEN GOTO 2020 ELSE GOSUB 6080; A$(9,1)="E"; GOSUB 6450; PRINT @(35,6),A$(9,1),; GOTO 2020
2110 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,35,6,9+K9,1,C0,"","{3"+X$,"","FE2DAB04","","",""
2140 GOTO 2020
2150 REM "Item number
2160 CALL "ZZENTR","SX",A{ALL},A$,X4$,X3$,0,9,10+K9,10,C0,"","{3"+X$,"","FE2DAB06","FE2","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2160,2161
2170 IF C0>0 THEN GOSUB 7500
2190 GOTO 2020
2200 REM "Product code
2210 CALL "ZZENTR","SZX",A{ALL},A$,X4$,X3$,11,9,20+K9,3,C0,"","{3"+X$,"P","FE2DAB08","FMPP","FM2SAA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2210,2211
2215 IF C0<0 THEN GOTO 2020
2220 FIND (Z[3],KEY="P"+A$(20+K9,3),DOM=2210)IOL=0330
2240 GOTO 2020
2250 REM "Left-right
2260 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,15,9,23+K9,8,C0,"","{3"+X$,"","FE2DAB10","","",""
2290 GOTO 2020
2300 REM "Top-Bottom
2310 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,25,9,31+K9,8,C0,"","{3"+X$,"","FE2DAB12","","",""
2340 GOTO 2020
2350 REM "Number of plys
2360 CALL "ZZENTR","Z",A{ALL},A$,X4$,X3$,35,9,39+K9,2,C0,"","{3"+X$,"","FE2DAB14","","",""
2390 GOTO 2020
2400 REM "Item description
2410 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,39,9,41+K9,40,C0,"","{3"+X$,"","FE2DAB16","","",""
2440 GOTO 2020
2450 REM "Vendor
2460 CALL "ZZENTR","A",A{ALL},A$,X4$,X3$,8,10,81+K9,10,C0,"A/P","{3"+X$,"","FE2DAB18","AP4","AP2MAB",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2460,2461
2470 FIND (Z[4],KEY=A$(81+K9,10),DOM=2460)IOL=0340
2475 PRINT @(27,10+V0+L0),D$(11,35),
2490 GOTO 2020
2500 REM "Plant
2510 CALL "ZZENTR","SZ",A{ALL},A$,X4$,X3$,71,10,91+K9,4,C0,"","{3"+X$,"","FE2DAB20","","",""
2540 GOTO 2020
2550 REM "Selling U/M
2560 CALL "ZZENTR","SU",A{ALL},A$,X4$,X3$,14,12,95+K9,4,C0,"","{3"+X$,"","FE2DAB22","","",""
2590 GOTO 2020
2600 REM "Packing
2610 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,29,12,0,501,C0,M0$,"{3"+X$,"","FE2DAB24","","",""
2640 GOTO 2020
2650 REM "New/Repeat?
2660 CALL "ZZENTR","SRU",A{ALL},A$,X4$,X3$,14,13,99+K9,1,C0,"","{3"+X$,"NR","FE2DAB26","NR","",""
2690 GOTO 2020
2700 REM "Calc selling price from GP%?
2710 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,71,12,100+K9,1,C0,"","{3"+X$,"","FE2DAB28","","",""
2740 GOTO 2020
2750 REM "Desired GP%
2760 CALL "ZZENTR","N.",A{ALL},A$,X4$,X3$,71,13,1,320,C0,M1$,"{3"+X$,"","FE2DAB30","","",""
2790 GOTO 2020
2800 REM "Estimation code
2810 CALL "ZZENTR","SXU",A{ALL},A$,X4$,X3$,14,14,102,10,C0,"","{3"+X$,"","FE2DAB28","","",""
2815 IF C0>0 THEN GOSUB 7500
2820 REM FIND (Z(7),KEY=A$(81,10)+A$(102,10),DOM=2821) IOL=0370
2840 GOTO 2020
4000 REM "
4040 PRINT @(0,8),'CE',
4060 PRINT @(15,8),"1. Quotation information",@(15,10),"2. Special terms and conditions",@(15,12),"3. Estimate selection detail",@(15,14),"4. Estimate totals",@(15,16),"5. Delete this detail line",@(15,18),"6. Done with this line"
4075 CALL "ZZPROM","M0",X3$,Z,"","","",20
4080 DIM Q$(2); CALL "ZZENTR","ZX",A{ALL},Q$,X4$,X3$,59,20,1,2,C0,"",X$,"","AR2MAA10","","",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2125,2126
4085 IF C0<0 THEN Q0=6 ELSE Q0=NUM(Q$,ERR=4080)
4090 PRINT @(0,20),'CE',
4100 REM "
4110 IF Q0=1 THEN GOSUB 6078; GOSUB 6200; ON LEN(Y$) GOTO 2000,1800
4115 IF Q0=2 THEN GOSUB 6300; GOTO 4000
4120 IF Q0=3 THEN GOTO 8000
4130 IF Q0=4 THEN GOSUB 7600; GOTO 4000
4135 IF Q0=5 THEN GOTO 6500
4170 IF Q0=6 THEN GOSUB 6700; GOTO 9700
4190 GOTO 4080
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6006)'SB',
6060 PRINT @(0,3+V0),"Quotation number:",@(28,3+V0),"Salesperson:",@(9,4+V0),"Company:",@(0,5+V0),Z0$,
6062 PRINT @(0,8),'CE','SB',@(5,6+V0),"Line number:",@(24,6+V0),"Item type:",@(38,6+V0),"(Stock, Customer Job file, Estimate)",@(0,7+V0),Z0$,
6080 PRINT @(0,8),'CE','SB',@(0,8+V0),"Item code",@(11,8+V0),"P/C Lft-Rght",@(25,8+V0),"Top-Botm",@(35,8+V0),"Ply Item description",@(0,10+V0),"Vendor:",@(21,10+V0),"Name:",@(64,10+V0),"Plant:",@(0,11+V0),Z0$,
6090 PRINT @(1,12+V0),"Selling U/M:",@(20,12+V0),"Packing:",@(42,12+V0),"Calc selling price from GP%?",@(2,13+V0),"New/Repeat?",@(58,13+V0),"Desired GP%",@(4,14+V0),"Est code:",@(0,15+V0),Z0$,
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6220 PRINT @(35,6),A$(9+K9,1),@(0,9),A$(10+K9,10),@(11,9),A$(20+K9,3),@(15,9),A$(23+K9,8),@(25,9),A$(31+K9,8),@(35,9),A$(39+K9,2),@(39,9),A$(41+K9,40),
6224 CALL "ZZDISP","A",A$(81+K9,10),"A/P",X3$,"","",8,10,X4$
6228 PRINT @(27,10+V0+L0),D$(11,35),@(71,10),A$(91+K9,4),@(14,12),A$(95+K9,4),@(29,12),A[0]:M0$,@(14,13),A$(99+K9,1),@(71,12),A$(100+K9,1),@(71,13),A[1]:M1$,
6235 PRINT @(14,14),A$(102,10),
6290 RETURN 
6300 REM "TERMS & CONDITIONS
6305 IF G$="" THEN GOTO 6390 ELSE PRINT @(0,8),'CE',
6310 FOR X=0 TO 6; PRINT @(5,10+X),G$(140+X*60,60); NEXT X
6380 CALL "ZZPROM","4",X3$,0,"","","",0
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6460 CALL "ZZDISP","A",A$(150,8),"O/P",X3$,"","",18,3,X4$
6461 PRINT @(41,3),I$(5,30),@(18,4+V0+L0),B$(20,35),@(18,6),A$(6+K9,3),
6465 PRINT @(35,6),A$(9+K9,1),
6490 RETURN 
6500 REM "DELETE
6505 CALL "ZZPROM","Y",X3$,A,"Verify: You wish to delete this detail line","","",0; ON A GOTO 6506,4080
6510 REMOVE (Z[1],KEY=A1$,DOM=6511)
6520 REMOVE (Z[5],KEY=A1$,DOM=6521)
6590 GOTO 9700
6600 REM "ALT KEY DATA READS
6605 FIND (Z[2],KEY=Q1$(1,8),DOM=6606)IOL=0320
6610 FIND (Z[11],KEY=B$(6,4),DOM=6611)IOL=0410
6690 RETURN 
6700 REM "ADD ENTRY
6710 WRITE (Z[1],KEY=A1$)IOL=0310
6720 WRITE (Z[5],KEY=A1$)IOL=0350
6790 RETURN 
6800 REM "NEXT ENTRY IN FILE
6810 A1$=KEY(Z[1],END=6895)
6815 GOSUB 6600
6820 IF A1$(1,LEN(K9$))<>Q1$ THEN GOTO 6895
6825 A$(1,LEN(A1$))=A1$
6830 GOSUB 6600
6835 GOSUB 6450
6890 GOTO 1515
6895 PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=1140); GOTO 1140
7500 REM "GET NEW MODEL
7520 FIND (Z[10],KEY=A$(10+K9,10),DOM=7560)IOL=0400
7525 IF Y$="" THEN Y$=Y9$
7550 A$(81+K9,10)=J$(11,10),A$(102,10)=J$(21,10)
7555 FIND (Z[4],KEY=A$(81+K9,10),DOM=7556)IOL=0340
7560 GOSUB 7800
7562 A$(95,4)=G$(64,4),A$(20,3)=G$(61,3),A$(41,40)=G$(21,40)
7580 GOSUB 6200
7590 RETURN 
7600 REM "SUMMARY
7612 DIM E[1,11],Q[30]
7620 FOR X=0 TO 12; Q[X+12]=A[X+1]; NEXT X
7640 IF Y$>"" THEN CALL "FE2DAX",X3$,E9$,Y$,E{ALL},F0,M0,X0
7660 CALL "FE2DAT",X3$,G$,A$,Q{ALL},E{ALL}
7670 FOR X=0 TO 12; A[X+1]=Q[X+12]; NEXT X
7690 RETURN 
7800 REM "GET ALL LINES
7805 Q$=A$(81,10)+A$(102,10),L0$=""
7810 E9$=Q$; READ (Z[6],KEY=Q$,DOM=7811)
7815 FIND (Z[7],KEY=E9$,DOM=7890)IOL=0370
7820 READ (Z[6],END=7840)IOL=0360; IF F$(1,20)<>Q$ THEN GOTO 7840
7825 L0$=L0$+F$(21,3)
7830 GOTO 7820
7890 RETURN 
7900 REM "Detail header
7910 PRINT @(0,8),'CE','SB',
7940 PRINT @(0,9+V0),"Feature",@(9,9+V0),"Description",@(50,9+V0),"Selected?",
7950 PRINT @(0,11),Z0$
7985 PRINT 'SF',
7990 RETURN 
8000 REM "Select features
8002 IF L0$="" THEN GOTO 4000 ELSE Q$=E9$
8005 X9=-1,C0=0; GOSUB 7900; GOSUB 8400
8010 C0=ABS(C0); IF C0=4 THEN GOTO 4000
8015 IF C0<>2 THEN X9=X9+1 ELSE X9=X9-1
8020 IF X9<0 THEN X9=LEN(L0$)/3-1 ELSE IF X9*3>=LEN(L0$) THEN X9=0
8035 Q$=E9$+L0$(X9*3+1,3)
8040 READ (Z[8],KEY=Q$,END=8095)IOL=0360
8050 GOSUB 8100
8060 GOTO 8010
8095 GOTO 1820
8100 REM "DISPLAY ENTRY
8120 PRINT @(2,10),F$(21,3),@(9,10),F$(24,30),
8175 Q$=F$(21,3)+"N"; IF POS(Q$(1,3)=Y$,3)>0 THEN Q$(4,1)="Y"
8180 CALL "ZZENTR","SUX",A{ALL},Q$,X4$,X3$,53,10,4,1,C0,"","","","","","",""
8185 IF C0<0 THEN GOTO 8010
8200 REM "SELECT OR DESELECT
8210 IF Q$(4,1)="Y" THEN IF POS(Q$(1,3)=Y$,3)=0 THEN Y$=Y$+Q$(1,3); GOTO 8280 ELSE GOTO 8290
8220 P=POS(Q$(1,3)=Y$,3); IF P=0 THEN GOTO 8290 ELSE Y$=Y$(1,P-1)+Y$(P+3); GOTO 8280
8280 REM "REDISP
8285 GOSUB 8300
8290 RETURN 
8300 REM "Display
8310 IF Q$(4,1)="N" THEN GOSUB 8400; GOTO 8380
8320 Q=LEN(Y$)/3,Q$=""; GOSUB 8465
8390 RETURN 
8400 REM "
8405 Q$=Y$,Q=0
8410 REM "DISPLAY PAGE OF OPTIONS
8430 PRINT @(0,12),'CE',
8450 IF Q$="" THEN GOTO 8490
8455 Z$=Q$(1,3),Q$=Q$(4)
8460 READ (Z[8],KEY=E9$+Z$,DOM=8461)IOL=0360
8462 Q=Q+1
8465 IF Q<11 THEN X=2,Y=Q ELSE X=42,Y=MOD(Q,10)
8470 PRINT @(X,Y+11),F$(21,3)," ",F$(24,30),
8480 IF Q$>"" THEN GOTO 8455
8490 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 GOSUB 6400
9520 ON C9 GOTO 1140,2040
9600 REM "RUN ESTIMATE PROGRAM
9700 REM "PROG FLOW
9710 IF U1$="" THEN REMOVE (Z[13],KEY=U0$,DOM=9900); GOTO 9900
9720 WRITE (Z[13],KEY=U0$)U0$,U1$
9725 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9730 RUN U1$(1,6)
9800 REM "EXIT PROGRAM
9810 IF U0$>"" THEN GOTO 9700
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 SETERR 9940; Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
