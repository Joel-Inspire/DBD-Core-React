0010 REM "Work Order Printing <FW2RBB>
0035 REM "5.7 - 08/16/10 - 11.928888 - tma - SSP# 240435
0037 REM "240435-Compare of programs/panels from DEV to Release              
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 9000
0095 PRECISION 14; T2=TIM; PRECISION 2
0100 SETERR 9000; SETESC 9300
0110 X0$="FW2RBB",X1$="Work Order Printing"
0120 DIM A$(477),A[15],I[6],S$(30)
0140 Z0$="-###,###.00",Z1$="##,##0",Z2$="###,###,##0-"
0170 DEF FND$(Z9$)=STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
0175 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
0180 DEF FNR$(Z9$)=Z9$(POS(" "<>Z9$))
0210 T=1,T0=1,T1=1
0220 W3=79
0225 W=999
0230 DIM T1$(W3,"-"),T2$(W3,"="),T3$(W3,"*"),Y5$(W3),Y6$(W3),W[4]
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,"",-1,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0260 CALL "ZZRPTP",X3$,X0$,X1$,V9$,V0,Q0$,Q1$,Q2$,Q3$,Q4$,Q5$,Q6$
0300 REM "I/O lists
0305 REM "IOLIST FOR AR1 - Customer Masterfile
0310 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13],A[14],A[15]
0320 IOLIST I$,I[0],I[1],I[2],I[3],I[4],I[5],I[6]
0330 IOLIST C$,C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7]
0340 IOLIST D$
0350 IOLIST E$(1)
0360 IOLIST F$,F[0],F[1]
0380 IOLIST C1$,C[0],C[1]
0390 IOLIST R$
0410 IOLIST I0$
0420 IOLIST X3$,X4$,V1$,V3$,V2$,V0$
0500 REM "Files
0505 DIM Z[NUM(X3$(60,3))]; GOSUB 7400
0510 Y$="01O PO6...  02O FS1...  03O FW0...  04O FW1...  05O AR1...  06O FM0...  07O FMP...  08O FS2...  09O IC0...  10O AR3...  11O PO3...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Y$,Z{ALL},Z0,Z1
0530 DIM G0$(200); READ (Z[6],KEY="D"+S$(1,10)+"0001",DOM=0531)G0$
0535 REM "C9$ can be read from ZZPARM if available,else just hard code it
0536 REM "C9$ format: 5 char code followed by a 10 char description
0537 READ (Z[6],KEY="WOCOLOR"+X3$(9,3),DOM=0540)C9$; C9$=C9$(11); GOTO 0546
0540 C9$="BLU  Blue      BLUL Light BlueBLUD Dark Blue "
0545 C9$=C9$+"GRN  Green     RED  Rose      BRN  Brown     YEL  Yellow    BLK  Gray      GRY  Gray      ORG  Orange    PRS  Prestige  "
0700 REM "Open Printer
0719 REM "Don't open printer until we are sure we have one to print
0720 REM CALL "ZZPRIN",X0$,X3$,Y0$,V3$,Z(ALL),W0$,W1$,W0,W9,W2,W3,W4; ON W4 GOTO 00721,09920
0750 GOSUB 8100
0800 REM "Alternate Sort Info & total dim"
0805 DIM U0$(4)
0810 ON V0 GOTO 0820,0820,0830,0840
0820 DIM U[1]; U=8,U0=1,U[0]=0,U[1]=8,T0=0,U0$="    ",T5$="                "; GOTO 0850
0850 DIM T[T0,T1]
0860 V5=V1+1,V6=V5+V2,V7=V6+V3
0900 REM " Position read"
0905 REM "set key file to read from"
0910 CALL "ZZFLES",X3$,Y1$,Y0$,"00O "+V1$+"  ",Z{ALL},Z0,0; IF Z0>0 THEN GOTO 9900 ELSE U1=Z[0]
0930 IF LEN(V2$)>=U*2 THEN GOTO 0965
0934 REM "create default 'all' range key
0935 DIM V2$(U*2),V4$(U,"~"); U3=1
0940 FOR U9=1 TO U0; U3=U3+U[U9-1]+U[U9-1]
0950 V2$(U3+U[U9],U[U9])=V4$(1,U[U9])
0955 NEXT U9
0964 REM "Get starting key from range key
0965 DIM V4$(U); U3=1,U4=1
0970 FOR U9=1 TO U0; U3=U3+U[U9-1]+U[U9-1],U4=U4+U[U9-1]
0975 V4$(U4,U[U9])=V2$(U3,U[U9])
0980 NEXT U9
0985 V4$(U,1)=CHR(ASC(V4$(U,1))-1)
0990 READ (U1,KEY="W"+V4$,DOM=0991)
0995 GOSUB 6000
1000 REM "Read next record
1005 U$=KEY(U1,END=5000); READ (U1)
1010 IF U$(1,1)<>"W" THEN GOTO 5000
1013 IF U$(2,8)<V2$(1,8) THEN GOTO 1000
1015 IF U$(2,8)>V2$(9,8) THEN GOTO 5000
1110 U9$=U$
1300 REM "Read other data
1310 DIM C$(128),C[7]; READ (Z[2],KEY=U9$(2,8),DOM=1000)IOL=0330
1320 READ (Z[5],KEY=C$(6,10),DOM=1321)IOL=0310
1330 DIM E$(259); FIND (Z[11],DOM=1331,KEY=C$(118,8)+"     ")IOL=0350
1350 GOSUB 8200
1375 IF C=0 THEN GOTO 1000
1377 IF W9=0 THEN CALL "ZZPRIN",X0$,X3$,Y0$,V3$,Z{ALL},W0$,W1$,W0,W9,W2,W3,W4; ON W4 GOTO 1378,9920
1380 REM "Write print flag
1381 REMOVE (Z[1],KEY=U$)
1382 DIM U$(10); U$(1)=U9$,U$(10)="P"
1385 WRITE (Z[1],KEY=U$,DOM=1000)
1500 REM "Print Data
1504 REM "C0 is # w/o now printing, P0 is page on that w/o, L0 is current line number printing"
1505 C0=0,P0=1,L0=1
1510 READ (Z[8],KEY=C$(118,8),DOM=1511)
1515 READ (Z[8],END=1900)IOL=0320
1517 IF L0=1 THEN I0$=I$
1520 IF I$(147,8)<>C$(118,8) THEN GOTO 1900
1525 IF POS(I$(155,1)="INC")>0 THEN GOSUB 1600 ELSE GOSUB 1700
1590 GOTO 1515
1600 REM "Print I,N,C type lines
1610 GOSUB 7500
1615 C0=C0+1
1620 IF C0=1 THEN GOSUB 2000 ELSE GOSUB 2500; GOSUB 2000
1625 P0=1
1660 D9=1; GOSUB 7800
1680 L0=L0+1
1690 RETURN 
1700 REM "Print non - (I,N,C) type lines
1710 IF L0>5 THEN F0$=F$,D0$=D$; GOSUB 2500; GOSUB 2000; D9=1
1720 GOSUB 7800
1780 L0=L0+1
1790 RETURN 
1900 REM "Accumulate Totals"
1909 REM "Finish up the last page printed.
1910 F0$=F$,D0$=D$
1915 GOSUB 2500
1995 GOTO 1000
2000 REM "Print 'header' section
2005 W=0; GOSUB 7300; CALL "ZZDISP","DSX",C$(55,6),"",X3$,Y5$,"",1,0,X4$; GOSUB 7300
2007 IF C$(48,1)="Y" THEN Y5$(30)="*BACK ORDER*"
2010 CALL "ZZDISP","AX",C$(118,8),"O/P",X3$,X$,"",0,0,X4$
2015 IF C<2 THEN Y5$(61)=X$ ELSE Y5$(61)=X$+" ("+STR(C0:"0")+" of "+STR(C:"0")+")"
2020 GOSUB 7600
2030 IF C$(46,1)=" " THEN GOSUB 7300 ELSE Y5$(61)="Revision "+C$(46,1); GOSUB 7300
2035 CALL "ZZDISP","DXS",C$(16,6),"",X3$,Y5$,"",61,0,X4$
2040 GOSUB 7300; GOSUB 7300
2050 GOSUB 2100
2060 GOSUB 2200
2070 GOSUB 2300
2080 L0=1
2090 RETURN 
2100 REM "Print phone #'s, From address and rush message
2105 IF POS(C$(8,1)="8")<>0 THEN Y5$(45)=A$(11,35) ELSE Y5$(28)="(800) 241-2319",Y5$(45)=G0$(16,35)
2110 GOSUB 7600
2115 IF I$(18,1)="Y" THEN Y5$(1)="*Split Shipment*"
2120 IF C$(8,1)<>"8" THEN Y5$(28)="(770) 271-7573"
2122 Y5$(45)=G0$(51,30)
2125 GOSUB 7300
2130 A5$=G0$(111,27); GOSUB 8400
2135 IF POS(" "<>G0$(81,30))=0 THEN A3$=A6$,A4$="" ELSE A3$=G0$(81,30),A4$=A6$
2140 Y5$(45)=A3$
2145 GOSUB 7300
2147 CALL "ZZDATE",X3$,"",C$(16,6),C$(55,6),D0,1,0,0,0,0,0,"","",""
2150 IF D0<14 OR I$(134,1)="Y" THEN Y5$(1)="** RUSH ** RUSH ** RUSH **"
2155 Y5$(45)=A4$
2160 GOSUB 7300; GOSUB 7300
2190 RETURN 
2200 REM "Print Sold to and Shipto Addresses
2204 REM "Setup soldto
2205 DIM L0$(141)
2210 IF POS(C$(8,1)="8")<>0 THEN GOTO 2240
2220 L0$(1,35)=A$(11,35),L0$(36,35)=A$(56,30)
2225 A5$=A$(116,27); GOSUB 8400
2230 IF POS(" "<>A$(86,30))=0 THEN L0$(71,35)=A6$ ELSE L0$(71,35)=A$(86,30),L0$(106,35)=A6$
2240 REM "Setup Ship to
2245 DIM L1$(175); L1=0
2250 L1$(L1*35+1,35)=E$(225,35),L1=L1+1
2255 IF POS(" "<>E$(16,30))<>0 THEN L1$(L1*35+1,35)="Attn: "+E$(16,30),L1=L1+1
2260 L1$(L1*35+1,35)=E$(46,30),L1=L1+1
2265 IF POS(" "<>E$(76,30))<>0 THEN L1$(L1*35+1,35)=E$(76,30),L1=L1+1
2270 A5$=E$(106,27); GOSUB 8400; L1$(L1*35+1,35)=A6$
2275 FOR L0=0 TO 3
2280 Y5$(1)=L0$(L0*35+1,35),Y5$(45)=L1$(L0*35+1,35); GOSUB 7300
2281 NEXT L0
2285 Y5$(45)=L1$(141,35); GOSUB 7300
2287 CALL "ZZDISP","AXS",C$(6,10),"A/R",X3$,Y5$,"",11,0,X4$
2288 X$=C$(28,15); IF C$(8,1)<>"8" THEN Y5$(54)=X$ ELSE I=POS("/"=X$); IF I>0 THEN Y5$(54)=X$(I+1)
2290 GOSUB 7300
2292 GOSUB 7300; GOSUB 7300
2295 RETURN 
2300 REM "Print Ribbon Line
2310 IF POS(C$(8,1)="8")<>0 THEN Y5$(5)=C$(93,4); GOTO 2320
2315 DIM R$(170); FIND (Z[10],KEY=C$(93,4),DOM=2316)IOL=0390
2317 IF A1<>0 THEN Y5$(1)="XXXXXXXXXX" ELSE Y5$(1)=R$(149,10)
2320 REM 
2325 DIM X$(30); FIND (Z[7],KEY="S"+E$(150,1),DOM=2326)X$
2330 IF A1<>0 THEN Y5$(28)="XXXXXXXXXXXXXX" ELSE Y5$(28)=X$(3,15)
2335 DIM X$(30); FIND (Z[7],KEY="H"+E$(134,1),DOM=2336)X$
2340 IF A1<>0 THEN Y5$(46)="XXXXXXXXXXXXXX" ELSE Y5$(46)=X$(3,15)
2345 CALL "ZZDISP","DXS",C$(55,6),"",X3$,Y5$,"",66,0,X4$
2385 GOSUB 7300; GOSUB 7300
2390 RETURN 
2500 REM "Finish up the bottom half
2504 REM "If P0 =1 (on the first page) then print spec part, else just go to top of the next page
2505 IF P0>1 THEN W=W+1; GOTO 2550
2510 IF W<32 THEN GOSUB 7300; GOTO 2510
2515 GOSUB 2600
2520 GOSUB 2700
2525 GOSUB 2800
2530 GOSUB 2900
2532 GOSUB 3000
2535 IF L0>5 THEN Y5$(32)="*** Continued ***"; GOSUB 7300
2560 IF W<51 THEN GOSUB 7300; GOTO 2560
2580 P0=P0+1
2590 RETURN 
2600 REM "Do 1st spec part
2610 GOSUB 8500
2615 A8$=F0$(99,1); GOSUB 8550; Y5$(10)=A9$
2620 IF F0$(100,1)="Y" THEN Y5$(14)="Continuous" ELSE IF F0$(101,1)="Y" THEN Y5$(18)="Flat" ELSE Y5$(17)="Other"
2625 Y5$(26)=I0$(32,8),Y5$(35)=I0$(40,8),Y5$(44)=I0$(48,2)
2630 Y5$(49)=F0$(103,6),Y5$(56)=F0$(109,6),Y5$(63)=F0$(115,6),Y5$(70)=F0$(121,6)
2640 GOSUB 7300
2645 GOSUB 7300
2690 RETURN 
2700 REM "Do Numbering
2704 REM "Print line and skip individual fields
2705 Y5$(1)=F0$(397,40); GOTO 2740
2710 A8$=F0$(130,1); GOSUB 8550; Y5$(14)=A9$
2715 A8$=F0$(131,1); GOSUB 8550; Y5$(30)=A9$
2720 A8$=F0$(132,1); GOSUB 8550; Y5$(56)=A9$
2725 A8$=F0$(133,1); GOSUB 8550; Y5$(65)=A9$
2730 A8$=F0$(134,1); GOSUB 8550; Y5$(75)=A9$
2740 GOSUB 7300
2745 GOSUB 7300
2790 RETURN 
2800 REM "Do Sig line
2804 REM "Print sig line and skip individual fields
2805 Y5$(1)=F0$(437,40); GOTO 2840
2810 A8$=F0$(144,1); GOSUB 8550; Y5$(15)=A9$
2815 A8$=F0$(145,1); GOSUB 8550; Y5$(45)=A9$
2820 A8$=F0$(146,1); GOSUB 8550; Y5$(72)=A9$
2840 GOSUB 7300
2845 GOSUB 7300
2890 RETURN 
2900 REM "Do last spec part
2910 Y5$(9)=F0$(135,9),Y5$(32)=F0$(128,2),Y5$(38)=F0$(147,40)
2915 GOSUB 7300
2920 A8$=F0$(127,1); GOSUB 8550; Y5$(32)=A9$
2925 Y5$(38)=F0$(187,40)
2930 GOSUB 7300
2935 REM "See line 535-540 for Setup of C9$
2936 REM "P6$ is item without trailing blanks
2937 REM "P5$ is current code, without trailing blanks
2938 REM "Take each code from C9$, strip the trailing blanks, leaving P5$, match P5$ to the last (LEN(P5$)) characters in the trailing blank stripped item code (P6$), if they match use that desc, else find the next code and try it.
2939 REM "P5 is the length of the code in C9$, P6 is the length of the description from C9$, and P7 is the length of the code, desc. pair in C9$
2940 P5=5,P6=10,P7=15; P6$=FNS$(F0$(21,10))
2944 GOTO 2961
2945 FOR I=1 TO LEN(C9$)-P7 STEP P7
2950 P5$=FNS$(C9$(I,P5))
2954 IF LEN(P5$)+1>LEN(P6$) THEN GOTO 2960
2955 IF P6$(LEN(P6$)-LEN(P5$)+1)=P5$ THEN P7$=FNS$(C9$(I+P5,P6))+" Stock"; Y5$(37-LEN(P7$))=P7$; EXITTO 2961
2960 NEXT I
2980 Y5$(38)=F0$(227,40)
2983 GOSUB 7300
2984 Y5$(38)=F0$(277,40)
2985 GOSUB 7300
2990 RETURN 
3000 REM "Print Bill of Materials"
3010 GOSUB 7300
3015 FOR I=317 TO 377 STEP 20
3020 IF POS(" "<>F0$(I,20))=0 THEN GOTO 3050
3025 READ (Z[9],KEY=F0$(I,20),DOM=3030)IOL=0410; GOTO 3040
3029 REM "Not on file- Print the field only
3030 Y5$(6)=F0$(I,20)
3035 GOTO 3050
3039 REM "On file
3040 CALL "ZZDISP","AXS",I0$(11,10),"ICE",X3$,Y5$,"",6,0,X4$
3045 Y5$(17)=I0$(21,40)
3050 GOSUB 7300
3060 NEXT I
3095 RETURN 
3100 REM "Subtotal logic goes here, see -ZREPS
3180 RETURN 
5000 REM "End of Print
5010 GOTO 9900
5020 IF V8$="A" THEN GOTO 5040
5025 CALL "ZZPROM","Y",X3$,S3,"Did all of the Work Orders print correctly?","","",0
5030 ON S3 GOTO 5040,9916
5200 GOSUB 5300
5290 GOTO 9916
5300 REM "Remove
5310 READ (Z[1],KEY="W",DOM=5311)
5320 U$=KEY(Z[1],END=5390); READ (Z[1])
5323 IF U$(2,8)<V2$(1,8) THEN GOTO 5320
5324 IF U$(2,8)>V2$(9,8) THEN GOTO 5390
5325 READ (Z[1],KEY=U$)
5330 IF U$(1,1)<>"W" THEN GOTO 5390
5340 IF LEN(U$)<>10 THEN GOTO 5370
5350 IF U$(10,1)="P" THEN GOSUB 5400; REMOVE (Z[1],KEY=U$)
5370 GOTO 5320
5390 RETURN 
5400 REM "Set print flag in header
5410 DIM C$(128),C[7]; EXTRACT (Z[2],KEY=U$(2,8),DOM=5440)IOL=0330
5415 C$(45,1)="Y"
5420 IF C$(46,1)=" " THEN C$(46,1)="1" ELSE IF C$(46,1)<"9" THEN C$(46,1)=STR(NUM(C$(46,1))+1:"0")
5430 WRITE (Z[2],KEY=U$(2,8))IOL=0330
5440 RETURN 
6000 REM "Print alignment pattern?
6004 REM "A1 <> 0 means doing an alignment pattern
6005 A1=0
6006 IF V8$="A" THEN GOTO 6090
6010 IF V3$(2,2)="A " THEN PRINT 'EA',
6015 CALL "ZZPROM","R4",X3$,Z,"","","",X0
6017 IF Z<2 AND V3$(2,2)="A " THEN PRINT 'BA',
6020 ON Z GOTO 6080,6021,9920
6025 IF W9=0 AND V3$(2,2)<>"A " THEN CALL "ZZPRIN",X0$,X3$,Y0$,V3$,Z{ALL},W0$,W1$,W0,W9,W2,W3,W4; ON W4 GOTO 6026,9920
6030 GOSUB 6100
6040 GOSUB 6200
6050 GOTO 6010
6080 A1=0
6090 RETURN 
6100 REM "Setup test data"
6104 A1=1
6105 C=9,C0=1
6108 DIM X$(40,"X")
6110 DIM C$(169); C$(118,8)="99999999",C$(16,6)="J90101",C$(28,15)="999999999999999",C$(6,10)="9999999999",C$(93,4)="9999",C$(55,6)="U90101"
6115 DIM A$(397); A$(11,35)=X$,A$(56,30)=X$,A$(86,30)=X$,A$(116,18)=X$,A$(134,9)="999999999"
6120 DIM F0$(477); F0$(21,10)="9999999999",F0$(31,8)="99999999",F0$(50,40)=X$,F0$(90,6)="U90101",F0$(99,4)="YYYY",F0$(103,24)=X$,F0$(127,1)="Y",F0$(130,5)="YYYYY",F0$(135,9)="999999999",F0$(144,3)="YYY",F0$(147,120)=X$+X$+X$,F0$(397,80)=X$+X$
6125 DIM I$(205); I$(50,40)=X$,I[0]=999999999
6127 I0$=I$
6130 DIM E$(260); E$(16,90)=X$+X$+X$,E$(106,18)=X$,E$(124,9)="999999999",E$(210,15)=X$,E$(225,35)=X$
6135 DIM D0$(186); D0$(29,2)="99"
6190 RETURN 
6200 REM " Print align. pattern
6210 GOSUB 2000
6230 D9=1; GOSUB 7867
6235 GOSUB 7867
6240 P0=1,L0=1; GOSUB 2500
6290 RETURN 
7300 REM "Output line Y5$ to output device
7310 W=W+1
7330 IF Y5$=Y6$ THEN PRINT (W9)"" ELSE PRINT (W9)Y5$; DIM Y5$(W3)
7395 RETURN 
7400 REM "Read report selection parameters"
7410 Z$="12O ZZP     "
7420 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 7421,9900
7430 Y3$=X3$(1,6),Y4$=X3$(178,7)
7450 READ (Z[12],KEY=X3$(1,8),DOM=7451)IOL=0420
7480 X3$(178,7)=Y4$,V0=NUM(V0$(71,1)),W3$=V0$(19,POS("   "=V0$(19,40)+"  ")-1)
7482 IF V1$(1,3)="???" THEN V8$="A",V7$=V1$(4,2); IF V0$(71,1)="1" THEN V1$="PO6   "
7485 FOR U1=1 TO LEN(V1$); IF V1$(U1,1)=" " THEN V1$(U1,1)="."; NEXT U1 ELSE NEXT U1
7490 RETURN 
7500 REM "Read in w/o (E$) and order tracking record (D$)
7501 REM "Save prev. F$ and D$ into F0$ and D0$ for use by 2500's
7520 IF I$(155,1)="C" THEN K0$=C$(6,10)+I$(161,10)+I$(19,10)+I$(147,8) ELSE K0$=C$(6,10)+S$(1,10)+I$(19,10)+I$(147,8)
7525 F0$=F$
7530 DIM F$(477),F[3]; READ (Z[3],KEY=K0$,DOM=7531)IOL=0360
7550 IF I$(155,1)="C" THEN K1$=I$(147,8)+I$(161,10)+I$(19,10) ELSE K1$=I$(147,8)+S$(1,10)+I$(19,10)
7555 D0$=D$
7560 DIM D$(187); READ (Z[4],KEY=K1$,DOM=7561)IOL=0340
7590 RETURN 
7600 REM "Print one line double high, in place of calling 7300
7610 IF D2$="" THEN GOSUB 7300; W=W-1 ELSE GOSUB 8350
7620 GOSUB 7300
7630 GOSUB 8300
7635 W=W+1; REM "Increment W one more, because we are double height
7690 RETURN 
7800 REM "Order detail
7810 IF D9=1 THEN GOSUB 7300
7830 CALL "ZZDISP","AXS",I$(19,10),"ICE",X3$,Y5$,"",1,0,X4$
7851 DIM C1$(21),C[1]
7852 FIND (Z[13],KEY="U/M"+I$(124,4),DOM=7853)IOL=0380
7855 IF C1$(20,1)<>"Y" THEN I0=I[5] ELSE I0=C[1]
7857 IF I0<>0 THEN I[0]=I[0]/I0
7863 IF I[4]=0 AND I[6]<>0 THEN I[4]=I[6]
7865 REM IF I$(155,1)="S" THEN LET I(4)=I(6)
7867 IF I[0]<>0 THEN Y5$(12)=FNQ$(I[0],Z2$)
7868 Y5$(39)=I$(50,40)
7870 IF D9=1 THEN D9=0; GOSUB 7600 ELSE GOSUB 7300
7890 RETURN 
8100 REM "Set D1$=normal, D2$=double high printing FOR 8300 AND 8350 ROUTINES, GOSUB HERE ONLY ONCE
8101 REM "GOSUB 8350 to turn double high on, GOSUB 8300 to return to normal
8105 REM "Assumes special mode 5 is double & special mode six is un-double
8110 REM "This program assumes that double high is on until turned off, changes will be needed if double high goes off auto. at end of a line
8115 D1$="",D2$=""
8120 CLOSE (14); OPEN (14)"ZZPARM"
8125 READ (14,KEY="PRINTERS",DOM=8155)D1$,D2$
8130 P=POS(FID(W9)=D2$,2); IF P=0 THEN D1$="",D2$=""; GOTO 8155
8135 READ (14,KEY="ptr"+D1$(INT(P/2)*8+9,8),DOM=8140)D3$; GOTO 8145
8140 D1$="",D2$=""; GOTO 8155
8145 D1$=D3$(282,16),D2$=D3$(266,16)
8150 D1$=FNS$(D1$),D2$=FNS$(D2$)
8155 RETURN 
8200 REM "Calculate the number of w/o (C)  on this s/o
8205 C=0
8210 READ (Z[8],KEY=C$(118,8),DOM=8211)
8215 READ (Z[8],END=8290)IOL=0320
8220 IF I$(147,8)<>C$(118,8) THEN GOTO 8290
8225 IF POS(I$(155,1)="INC")=0 THEN GOTO 8215
8230 IF I$(155,1)="C" THEN K1$=C$(118,8)+I$(161,10)+I$(19,10) ELSE K1$=C$(118,8)+S$(1,10)+I$(19,10)
8234 REM "Skip looking for Order Tracking record or checking date in it.
8235 REM READ (Z(4),KEY=K1$,DOM=08215) IOL=00340
8240 REM IF D$(34,6)=S$(1,6) THEN LET C=0; GOTO 08290
8270 C=C+1
8275 GOTO 8215
8290 RETURN 
8300 REM "Return to normal
8305 IF D1$="" THEN GOTO *RETURN
8310 PRINT (W9)'BO',D1$,'EO',
8325 RETURN 
8350 REM "Goto double high
8355 IF D2$="" THEN GOTO *RETURN
8360 PRINT (W9)'BO',D2$,'EO',
8375 RETURN 
8400 REM "Take city,st,zip in A5$ in std format, and format into A6$
8410 IF POS(" "<>A5$(1,16))=0 THEN DIM A6$(30); GOTO 8440
8415 A6$=FNS$(A5$(1,16))+", "+A5$(17,2)+" "
8420 CALL "ZZDISP","AX",A5$(19,9),"ZIP",X3$,X$,"",0,0,X4$
8425 A6$=A6$+X$
8445 RETURN 
8500 REM "Setup repeat number, see if number and display accordingly
8505 GOTO 8530
8510 X=NUM(F0$(40,10),ERR=8530)
8520 CALL "ZZDISP","AXS",F0$(40,10),"O/P",X3$,Y5$,"",2,0,X4$
8525 GOTO 8540
8530 Y5$(1)=F0$(40,10)
8540 RETURN 
8550 REM "Based on A8$ return A9$ as '   ','No ','Yes'
8555 ON POS(A8$="NY") GOTO 8560,8565,8570,8560
8560 A9$="   "; GOTO 8590
8565 A9$="No "; GOTO 8590
8570 A9$="Yes"; GOTO 8590
8590 RETURN 
8950 DEF FNQ$(Z9,Z9$)=STR(Z9:Z9$)
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 1000
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9900 REM "End program
9909 IF V8$="A" THEN V3$(2,6)="AUTO"+V7$
9910 CALL "ZZERPT",X3$,X4$,X0$,Y3$,Y4$,W9,W2,W5,W,W0,W8,T3,V3$
9915 IF Y4$<>X0$ AND V3$(2,1)<>"T" THEN GOTO 5020
9920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 IF Y4$<>"" THEN RUN Y4$,ERR=9931
9940 RUN "ZMENU"
9999 END 
