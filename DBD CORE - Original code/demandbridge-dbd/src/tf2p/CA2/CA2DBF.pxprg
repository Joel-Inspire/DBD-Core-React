0010 REM "READ A DBF FILE <CA2DBF>
0035 REM "5.2 - 08/20/03 - 11.29 - dmm - SSP# 163697
0040 REM "Copyright 2003 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 BEGIN 
0170 OPEN (7)FID(0)
0210 PRINT 'CS'
0320 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14],B[15]
0350 DIM BLANKS$(10)
0409 REM "ARCOM BATCH BATCHER MICRO SERIES1 CUSTOMER
0410 CLOSE (1); INPUT 'LF',"Enter the DBF File Name -or- TopForm file reference ",F0$
0420 IF CTL=4 THEN GOTO 9900
0430 CLOSE (1); OPEN (1,ISZ=512,ERR=0440)F0$; GOTO 0500
0440 REM 'CK FOR TF FILE REFERENCE
0442 IF TF$="Y" THEN TF$="N"; GOTO 0410
0444 IF LEN(F0$)<4 THEN F0$=F0$+BLANKS$(1,4-LEN(F0$))
0450 CLOSE (1); OPEN (1)"CA0"; READ (1,KEY=F0$(1,4),DOM=0410)CA0$; CLOSE (1); F0$=STP(CA0$(5,20),1); TF$="Y"; GOTO 0430
0900 REM 
0920 GOSUB 4000
1000 REM 
1010 IF LEN(A$)<R0 THEN READ RECORD (1,END=5000)X$; A$=A$+X$; GOTO 1010
1020 R$=A$(1,R0),A$=A$(R0),R1=R1+1
1040 GOSUB 4400
1050 GOSUB 2000
1055 GOSUB 4500
1090 GOTO 1000
2000 REM 
2005 PRINT 'CS',
2008 PRINT (7)"FILE: '",F0$,"' Size: ",R0-1,"    Record number: ",R1:"###,##0",'LF','LF',
2010 P0=1,P1=0,N9=1
2020 FOR X=1 TO D0
2025 Q$=FNS$(D0$((X-1)*L0+1,16))
2040 D=NUM(D0$((X-1)*L0+20,3))
2045 X$=R$(P0,D),X9$=X$
2050 P0=P0+D; IF D>0 THEN P1=P1+1
2051 IF D=0 THEN GOTO 2080
2055 IF X/20=INT(X/20) THEN INPUT 'LF',"PAUSE... or press F1 for next record or F4 to End: ",*; IF CTL=1 THEN EXITTO 2095 ELSE PRINT @(0,2),'CE',; IF CTL=4 THEN GOTO 0010
2056 IF LEN(X$)>30 THEN X$=X$(1,30)
2060 PRINT (7)P1:"##0. ",D0$((X-1)*L0+1,16),"(",N9:"000,",D0$((X-1)*L0+20,3),")",": ",X$
2070 N9=N9+NUM(D0$((X-1)*L0+20,3))
2080 NEXT X
2090 INPUT 'LF',"PRESS RETURN: ",*; IF CTL>3 THEN GOTO 0010
2095 RETURN 
2195 RETURN 
2200 REM "SET B$
2205 IF POS(Q$+"*"="COMPANY*")=0 THEN GOTO 2300
2206 X$=X9$; IF LEN(X9$)>0 THEN CALL "ZZCASE",X9$,X$
2210 B$(11,35)=X$
2215 GOTO 3000
2305 IF POS(Q$+"*"="ADDRESS*")=0 THEN GOTO 2400
2310 CALL "ZZCASE",X9$,X$
2320 B$(56,30)=X$
2340 GOTO 3000
2405 IF POS(Q$+"*"="CITY_STE*")=0 THEN GOTO 2450
2410 P=POS(","=X$)
2415 Z9$=X$(P+1),X$=X$(1,P-1)
2416 IF Z9$(1,1)=" " THEN Z9$=Z9$(2); GOTO 2416
2418 X9$=X$; CALL "ZZCASE",X9$,X$
2420 B$(116,16)=X$,B$(132,2)=Z9$(1,2)
2440 GOTO 3000
2450 REM "
2455 IF POS(Q$+"*"="CITY*")=0 THEN GOTO 2500
2460 CALL "ZZCASE",X9$,X$
2465 B$(116,16)=X$
2480 GOTO 3000
2505 IF POS(Q$="ZIP_CODE*")=0 THEN GOTO 2550
2520 B$(134,9)=X$
2540 GOTO 3000
2550 REM 
2555 IF POS(Q$+"*"="STATE*")=0 THEN GOTO 2600
2560 B$(132,2)=X$
2580 GOTO 3000
2605 IF POS(Q$+"*"="PHONE*")=0 THEN GOTO 2700
2610 P=POS("-"=X$); IF P>0 THEN X$=X$(1,P-1)+X$(P+1); GOTO 2610
2620 IF LEN(X$)=10 THEN B$(205,14)=X$; GOTO 3000
2621 IF X$="" THEN GOTO 3000
2622 IF POS(" "<>X$)=0 THEN GOTO 3000
2623 ESCAPE 
2705 IF POS(Q$+"*"="CONTACT_1*")=0 THEN GOTO 2800
2708 CALL "ZZCASE",X9$,X$
2710 B$(165,20)=X$
2730 GOTO 3000
2805 IF POS(Q$+"*"="CONTACT_2*CUSTOMER*AMS*OWNER*OPERATOR*FAX*CALLED*SELECTED*SALESMAN*")>0 THEN GOTO 3000
2806 GOTO 3000
2999 ESCAPE 
3000 REM 
3090 RETURN 
4000 REM "DECIPHER FRONT END BLOCK
4002 T0$="",T1$=""
4003 REM "3,1 = NUMBER OF FIELDS???
4005 READ RECORD (1,SIZ=512)T0$
4006 T1$=T0$(33),T0$=T0$(1,32)
4010 READ RECORD (1,SIZ=512)X$; T1$=T1$+X$
4015 P=POS($0D$=T1$,32); IF P=0 THEN GOTO 4010 ELSE A$=T1$(P+1),T1$=T1$(1,P-1)
4100 REM "GET FIELDS
4105 L0=60
4120 FOR X=1 TO LEN(T1$) STEP 32
4130 T2$=T1$(X,32)
4135 DIM Q$(L0)
4140 Q$(1,16)=T2$(1,POS($00$=T2$(1,11)+$00$)-1)
4145 Q$(20,3)=STR(ASC(T2$(17,1)):"000")
4185 D0$=D0$+Q$,D0=D0+1
4186 R0=R0+ASC(T2$(17,1))
4190 NEXT X
4285 R0=R0+2
4286 IF A$(1,1)=$00$ THEN A$=A$(2)
4287 IF A$(1,1)=" " THEN A$=A$(2)
4295 RETURN 
4400 REM "DEFAULT RECORD
4410 DIM B$(400),B[15]
4420 B$(1)=STR(R1:"0000000000")
4425 B$(219,1)="A",B$(220,9)="050000000",B$(229,6)="J01017"
4430 B$(235,10)="XC",B$(267,2)="YY"
4435 B$(245,1)="Y"
4440 B$(275,3)="NEW"
4445 B[0]=100
4450 B$(278,4)="0070",B$(359,2)="01"
4495 RETURN 
4500 REM "AFTER THE FACT
4520 Z9$=B$(11,30)
4525 CALL "DB3PP0",Z9$,X$
4540 B$(155,10)=X$
4600 REM "
4690 RETURN 
5000 REM 
5020 IF POS($00$<>A$+$00$)=0 THEN GOTO 5100
5040 INPUT 'RB','LF',"END OF FILE.",*; GOTO 0010
5180 GOTO 9900
8905 DEF FNS$(Z9$)=Z9$(1,POS("  "=Z9$+"  ")-1)
9940 RUN "ZMENU"
9999 END 
