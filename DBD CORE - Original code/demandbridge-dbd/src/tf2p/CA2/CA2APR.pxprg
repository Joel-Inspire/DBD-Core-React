0010 BEGIN 
0200 PRINT 'CS'
0510 OPEN (1,OPT="TEXT")"mike.txt"
0530 OPEN (3)"APR0729"; LOCK (3); PURGE (3)
0540 OPEN (4)"APT0729"; LOCK (4); PURGE (4)
0600 SP$=$09$
0900 LC$=""
1000 READ RECORD (1,END=2000)A$
1010 CNT=CNT+1; IF FPT(CNT/500)=0 THEN PRINT @(0,20),CNT,
1110 GOSUB 5000
1150 CK$=STP(F$[1],2); CK$=PAD(CK$,6)
1300 DIM APT$(76),APT[4]
1410 X=POS("/"=F$[5]); MTH$=F$[5](1,X-1); F$[5]=F$[5](X+1)
1415 X=POS("/"=F$[5]); DY$=F$[5](1,X-1); F$[5]=F$[5](X+1)
1420 YR$=F$[5]
1425 YY$=YR$+STR(NUM(MTH$):"00")+STR(NUM(DY$):"00")
1430 Q$=CHR(NUM(YY$(1,3))-125)+YY$(4,1)+YY$(5,2)+YY$(7,2)
1435 INVDT$=Q$
1470 APT$(1,4)=YY$(1,4)
1480 APT$(5,2)=STR(NUM(F$[12]):"00")
1485 APT$(7,1)="A"
1490 APT$(10,1)="H"
1500 APT$(11,6)=CK$
1510 APT$(21,10)=PAD(STP(F$[6],2),10)
1515 APT$(48)="Data Conversion"
1520 X=POS("/"=F$[7]); MTH$=F$[7](1,X-1); F$[7]=F$[7](X+1)
1525 X=POS("/"=F$[7]); DY$=F$[7](1,X-1); F$[7]=F$[7](X+1)
1530 YR$=F$[7]
1540 Q$=CHR(NUM(YY$(1,3),ERR=8016)-125,ERR=8016)+YY$(4,1)+YY$(5,2)+YY$(7,2)
1560 APT$(31,6)=Q$
1565 APT$(37,2)="99"
1570 APT$(39,2)="99"
1580 APT[0]=-1
1585 VEND$=STP(F$[3],2); VEND$=PAD(VEND$,10)
1586 IF STP(VEND$,2)="" THEN GOSUB 7000
1600 APT[1]=NUM(F$[9])+NUM(F$[10])
1605 APT[2]=NUM(F$[10])
1606 APT[3]=APT[1]-APT[2]
1607 APT[4]=NUM(F$[8])
1700 DIM TPT[4]
1710 READ (4,KEY=APT$(1,30),DOM=1800)TPT$,TPT[0],TPT[1],TPT[2],TPT[3],TPT[4]
1715 PRINT 'CS'
1720 PRINT APT$; PRINT APT{ALL}; PRINT VEND$; PRINT APT$(21,10)
1730 INPUT NV$; NV$=PAD(NV$,10); APT$(21,10)=NV$
1800 WRITE (4,KEY=APT$(1,30))APT$,APT[0],APT[1],APT[2],APT[3],APT[4]; GOTO 1810
1815 TOT1=APT[1]+TOT1,TOT2=TOT2+APT[2],TOT3=TOT3+APT[3],TOT4=TOT4+APT[4]
1850 GOSUB 6000
1900 GOTO 1000
2005 PRINT TOT1; PRINT TOT2; PRINT TOT3; PRINT TOT4
2010 END 
5000 REM get fields
5005 O$=A$
5010 DIM F$[40]
5020 F=1
5030 P1=POS(SP$=A$)
5035 IF P1=0 THEN F$[F]=A$; RETURN 
5040 F$[F]=STP(A$(1,P1-1),2,QUO)
5050 F=F+1; A$=A$(P1+1)
5060 GOTO 5030
5090 RETURN 
6000 REM hdr
6010 DIM APR$(36),APR[1]
6020 APR$(1,4)=APT$(1,4)
6025 APR$(5,2)=APT$(5,2)
6030 APR$(7,1)="A"
6035 APR$(10,1)="H"
6040 APR$(11,6)=CK$
6050 APR$(21,10)=VEND$
6080 APR$(31,6)=INVDT$
6085 READ (3,KEY=APR$(1,20),DOM=6086)APR$,APR[0],APR[1]; GOTO 6087
6087 APR[0]=APR[0]+APT[3]
6090 WRITE (3,KEY=APR$(1,20))APR$,APR[0],APR[1]
6091 TOT=TOT+APT[3]
6092 APRCNT=APRCNT+1
6095 RETURN 
7005 IF POS("SCANS, ETC"=F$[4])<>0 THEN VEND$="00SCANSETC"; RETURN 
7010 IF POS("READY 4 BY"=F$[4])<>0 THEN VEND$=PAD("00READY4",10); RETURN 
7012 IF POS("IDEA GROUP"=F$[4])<>0 THEN VEND$=PAD("00IDEAGROU",10); RETURN 
7014 IF POS("CARLTON BATE"=F$[4])<>0 THEN VEND$=PAD("00CARLTONB",10); RETURN 
7015 IF POS("OTES INC"=F$[4])<>0 THEN VEND$=PAD("00NOTESINC",10); RETURN 
7016 IF POS("CORPORATE MANAGEMENT"=F$[4])<>0 THEN VEND$=PAD("00CORPMGT",10); RETURN 
7018 IF POS("DIVERSIFIED PRINTING"=F$[4])<>0 THEN VEND$=PAD("00DIVERSPR",10); RETURN 
7019 IF POS("GRAPHIC RESOURCES"=F$[4])<>0 THEN VEND$=PAD("00GRAPHICR",10); RETURN 
7020 IF POS("& C GRAPHICS"=F$[4])<>0 THEN VEND$=PAD("00C&CGRAPH",10); RETURN 
7021 IF POS("CUSTOM SCREENPRINT"=F$[4])<>0 THEN VEND$=PAD("00EXTREMCU",10); RETURN 
7022 IF POS("DB'S TEES"=F$[4])<>0 THEN VEND$=PAD("00DBSTEES",10); RETURN 
7023 IF POS("UTAI INC"=F$[4])<>0 THEN VEND$=PAD("00FUTAIINC",10); RETURN 
7024 IF POS("OST IMPRESSION"=F$[4])<>0 THEN VEND$=PAD("00SURESHOT",10); RETURN 
7025 IF POS("NATIONWIDE ENVELOPES"=F$[4])<>0 THEN VEND$=PAD("00NATIONLE",10); RETURN 
7027 IF POS("SAM MURRAY"=F$[4])<>0 THEN VEND$=PAD("00SAMMURRA",10); RETURN 
7035 IF POS("SURE SHOT PRE"=F$[4])<>0 THEN VEND$=PAD("00SURESHOT",10); RETURN 
7037 IF POS("ATA ENTERPRISE"=F$[4])<>0 THEN VEND$=PAD("00TONATA",10); RETURN 
7038 IF POS("START 2 PROM"=F$[4])<>0 THEN VEND$=PAD("00START2PR",10); RETURN 
7040 IF POS("DENTAL EXCEL"=F$[4])<>0 THEN VEND$=PAD("00DENTALEX",10); RETURN 
7042 IF POS("ELLIOT BAR"=F$[4])<>0 THEN VEND$=PAD("00ELLIOTBA",10); RETURN 
7044 IF POS("EMERALD PR"=F$[4])<>0 THEN VEND$=PAD("00EMERALDP",10); RETURN 
7046 IF POS("HOMETOWN SPORTS OF HICKORY"=F$[4])<>0 THEN VEND$=PAD("00HOMETOWN",10); RETURN 
7048 IF POS("LINKS UNLIMITED"=F$[4])<>0 THEN VEND$=PAD("00LINKSUNL",10); RETURN 
7050 IF POS("QUILL"=F$[4])<>0 THEN VEND$=PAD("00QUILL",10); RETURN 
7052 IF POS("THERA SQUEE"=F$[4])<>0 THEN VEND$=PAD("00THERASQU",10); RETURN 
7080 LIST 7040,7080; PRINT F$[4]; ESCAPE 
7090 RETURN 
