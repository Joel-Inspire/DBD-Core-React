0010 REM "Update Topform Bank Recon from ADD+ON P/R <BR2PAA>
0020 REM "Called from PRU.CB
0035 REM "4.4 - 08/01/00 - 13.8 - dmm - SSP# 119419
0040 REM "Copyright 2000 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0310 IOLIST A$,A[0],A[1],A[2]
1010 SETERR 9000
1011 REM "A1$ is the Topform Company Code, A2$ is check data from ADD+ON
1020 ENTER X3$,A0$,A1$,A2$,A0
1025 DIM S$(40)
1050 DIM Z[14]
1200 REM "Open Topform File
1210 X0$="BR2PAA"
1218 REM "We are counting on the correct X3$ from PRU.CB, for multi
1219 REM "company payrolls
1220 REM " CLOSE (14) ; OPEN (14) "ZZPARM"; READ RECORD (14,KEY=FID(0)+"      ") X3$; LET X3$(9,3)=A1$
2000 REM "Update Topform BR0
2005 IF A2$(10,1)="R" THEN A0=A0 ELSE IF A2$(10,1)="V" THEN A0=0
2010 DIM A$(127),A[2],Z$(10,"0")
2020 A$(1,3)=A0$,A$(4,1)="1",A[0]=A0
2025 A$(5,9)=STR(NUM(A2$(3,7)):Z$(1,9))
2030 A$(14,35)="* Employee Not Found *"
2040 IF A2$(10,1)="M" THEN A$(106,1)="Y"
2080 DIM B$(100); READ (8,KEY=A2$(1,2)+A2$(14,9),DOM=2081)*,B$
2085 A$(14,35)=FNS$(B$(1,16))+", "+B$(17,14)
2100 REM "Check date
2110 Q$=STR(ASC(A2$(23))-1:"00")+STR(ASC(A2$(24))-1:"00")+STR(ASC(A2$(25))-1:"00")
2115 IF Q$(1,1)="9" THEN Q$(1,1)="J" ELSE Q$(1,1)="K"
2120 A$(79,1)="N",A$(49,6)=Q$
2200 REM "Get FY/AP
2220 CALL "ZZ2FYP",X3$,Q$,P0$
2230 A$(100,6)=P0$,A$(121,1)=A2$(10,1)
2600 REM "WRITE RECORD
2610 Z$="01O BR0... "; GOSUB 9750
2660 WRITE (Z[1],KEY=A$(1,13)+A$(119,2),DOM=2661)IOL=0310; GOTO 2670
2665 IF A$(119,2)<"99" THEN A$(119,2)=STR(NUM(A$(119,2))+1:"00"); GOTO 2660 ELSE INPUT @(0,22),'CL',"Trying to update the 100th occurance of this check number - should never happen -CR to skip ",*
2670 Z$="01C BR0... "; GOSUB 9750
2990 GOTO 9900
8910 DEF FNS$(Z9$)=Z9$(1,POS(S$=Z9$+S$)-1)
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9900 REM 
9940 EXIT 
9999 END 
