0010 REM "Change A/R Customer Codes <AR2CHG>
0035 REM "4.1 - 02/10/97 - 14.63 - kmc
0040 REM "Copyright 1997 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 REM "Only processed masterfile records!!! 2/5/90 JSC
1020 ENTER X3$,X4$,A2$,A1$; SETERR 9000
1040 DIM S$(10); A1$=S$
1050 RT_PARM$=""; CALL "RT2PRM",ERR=1051,X3$,X4$,RT_PARM$
1100 DIM Z[NUM(X3$(60,3))]
1120 Z$="01O AR1...  02O AR0...  03O ARE... 04O ARU... "; GOSUB 9750
2010 PRINT @(8,4),"New code:",
2020 CALL "ZZENTR","AXU",A{ALL},A1$,X4$,X3$,18,4,1,10,C0,"A/R","","","","","",""
2030 FIND (Z[1],KEY=A1$,DOM=2031); CALL "ZZPROM",".4",X3$,0,"This customer code already exists!","","",0; GOTO 2020
2040 IF C0<>1 THEN GOTO 9900 ELSE CALL "ZZPROM",".Y",X3$,S3,"Do you really want to change this customer code?","","",0; ON S3 GOTO 2041,9900
2400 REM "MASTERFILE RECORDS
2420 READ RECORD (Z[1],KEY=A2$,DOM=9900)A$
2440 A$(1,10)=A1$
2450 WRITE RECORD (Z[1],KEY=A1$)A$
2451 IF RT_PARM$<>"" THEN CUST$=A1$; CALL "RT2WOC",ERR=2452,X3$,X4$,CUST$,"AR1...","U",A1$
2460 READ RECORD (Z[2],KEY=A2$,DOM=2480)A$
2465 A$(1,10)=A1$
2470 WRITE RECORD (Z[2],KEY=A1$)A$
2480 REMOVE (Z[1],KEY=A2$)
2481 IF RT_PARM$<>"" THEN CUST$=A2$; CALL "RT2WOC",ERR=2482,X3$,X4$,CUST$,"AR1...","D",A2$
2485 REMOVE (Z[2],KEY=A2$,DOM=2486)
2500 REM "SORT BY LOOKUP
2520 READ (Z[1],KEY=A1$)A$
2530 REMOVE (Z[3],KEY=A$(155,10)+A2$,DOM=2531)
2540 WRITE (Z[3],KEY=A$(155,10)+A1$)
2550 REM "SORT BY PRIMARY SLSPN
2560 REMOVE (Z[4],KEY=A$(278,4)+A2$,DOM=2561)
2570 WRITE (Z[4],KEY=A$(278,4)+A1$)
2990 GOTO 9900
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
