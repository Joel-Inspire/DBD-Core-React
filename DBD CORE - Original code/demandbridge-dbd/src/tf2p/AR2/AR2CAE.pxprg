0010 REM "Open invoice display <AR2CAE>
0020 SETESC 9300; SETERR 9000
0035 REM "5.4 - 01/11/06 - 15.99 - kmc - SSP# 185579
0037 REM "185579-Job Tracking - Phase 1                                      
0040 REM "Copyright 2006 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="AR2CAE",X1$="Open invoice Inquiry",K9$="",K9=0
0120 DIM Z0$(80,"-"),B$(46)
0130 K0=18,K1=2
0135 C9=-1,V9=-2
0140 M0$="-####0",M1$="-#,###,###.00",M2$="-###,###.00"
0145 IF Q1$="" THEN GOSUB 8950; Q0$=Q1$,Q1$="DISPLAY"
0200 REM "
0230 IF Q1$="DISPLAY" THEN X2=-1; PRINT @(0,3),'CE',
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1,LEN(A$)),A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13],A[14]
0320 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14],B[15]
0330 IOLIST C$,C[0],C[1],C[2],C[3]
0340 IOLIST D$
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X AR6...  02O AR1...  03O AR2...  04O ARG...  05O AR5...  06O ZZPARM  07O ARN...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0530 DIM SEC$(255); FIND (Z[6],KEY="osec"+X3$(40,3),DOM=0531)SEC$
0540 DIM PP$(256); FIND (Z[6],KEY=X3$(9,3)+"A/R",DOM=0541)PP$
0550 IF PP$(118,1)<>"Y" THEN GOTO 0570
0555 Z$="08O ASO...  "
0560 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0561,9900
0600 REM "
0800 REM "handle display case"
0815 DIM A$(159),A[16],B[16]
0820 READ (Z[1],KEY=Q0$,DOM=0890)IOL=0310
0825 FIND (Z[2],KEY=A$(1+K9,10),DOM=0826)IOL=0320
0830 GOSUB 6000; GOSUB 6460
0832 CUR1=1
0833 DIM CUR$(36)
0835 GOSUB 6200
0836 IF %HAS_IMAGE_LIB THEN %IL_IMAGE_TYPE$="AR_INVOICE",%IL_IMAGE_KEY$=Q0$
0837 IF PP$(118,1)="Y" THEN NAME$="X1AR2CAE" ELSE NAME$="X0AR2CAE"
0840 CALL "ZZPROM",NAME$,X3$,Z,"","","",0
0850 IF Z=2 THEN GOTO 3000
0855 IF Z=3 THEN GOTO 0832
0857 IF Z=4 THEN GOTO 3700
0860 IF Z>0 AND Z<>2 AND Z<>3 THEN GOTO 3300
0890 GOTO 9700
3000 REM "Foreign Currency
3005 DIM CUR$(36)
3010 IF PP$(118,1)<>"Y" THEN GOTO 3090
3020 READ (Z[8],KEY=A$(127,6)+A$(11+K9,8),DOM=3090)CUR$,CUR1
3030 GOTO 0835
3090 GOTO 0832
3300 REM "Run order program
3305 %IL_IMAGE_TYPE$="",%IL_IMAGE_KEY$=""
3310 U0$=X3$(1,6)+"PF",Q$=STR(LEN(Q0$):"00")+Q0$
3320 U1$="AR2MAF18"+A$(1,10)+A$(66,8)+X0$+Q$+U1$
3325 IF POS(" "<>A$(66,8))=0 THEN U1$(21,4)="NONE"
3330 WRITE (Z[6],KEY=U0$)U0$,U1$
3350 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
3390 RUN "AR2MAF"
3700 REM "Job Notes SSP 185579
3705 I_NO$=A$(11,8)
3710 CALL "ZZGMBA",X3$,X4$,"I",I_NO$
3795 GOTO 0840
3799 ! ******************************************************
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6060 CALL "ZZVDTP",X3$,"AR2CAE","","",0
6080 IF POS(" "<>A$(139,21))>0 THEN PRINT @(47,15),"Shpd:",
6165 PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6210 PRINT @(16,3),A$(127,4),@(44,3),A$(131,2),@(67,3),A$(102,4),".",A$(106,2),
6215 CALL "ZZDISP","A",A$(11+K9,8),"AR6",X3$,"","",16,4+V0,X4$
6220 CALL "ZZDISP","A",A$(1+K9,10),"A/R",X3$,"","",44,4+V0,X4$
6225 CALL "ZZDISP","A",A$(66+K9,8),"O/P",X3$,"","",67,4,X4$
6230 PRINT @(10,6),B$(11,35),@(67,6),A$(51,2),
6235 PRINT @(10,7),A$(36,15),
6240 CALL "ZZDISP","A",A$(108+K9,9),"ARG",X3$,"","",36,7+V0,X4$
6245 CALL "ZZDISP","D",A$(20+K9,6),"",X3$,"","",67,7+V0,X4$
6250 CALL "ZZDISP","A",A$(117,10),"AR5",X3$,"","",19,8,X4$
6255 CALL "ZZDISP","D",A$(54+K9,6),"",X3$,"","",67,8,X4$
6260 PRINT @(19,9),A$(74,4)," ",A$(78,4)," ",A$(82,4)," ",A$(86,4)," ",A$(90,4),
6265 CALL "ZZDISP","D",A$(60+K9,6),"",X3$,"","",67,9,X4$
6268 IF SEC$(40,1)<>"Y" THEN PRINT @(19,10),A[11]*CUR1:M2$,
6270 PRINT @(66,10),A[4]*CUR1:M2$,
6272 IF SEC$(63,1)<>"Y" THEN IF A[14]<>0 THEN PRINT @(20+LEN(M2$),10),"GPA:",A[14]*CUR1:M2$,
6275 CALL "ZZDISP","A",A$(94+K9,8),"AR6",X3$,"","",22,12,X4$
6280 PRINT @(45,12),A$(53,1),; IF SEC$(63,1)<>"Y" THEN PRINT @(64,12),(A[9]-A[10])*CUR1:M1$,
6285 CALL "ZZDISP","A",A$(26+K9,10),"A/R",X3$,"","",22,13,X4$
6290 IF SEC$(63,1)<>"Y" THEN PRINT @(64,13),A[10]*CUR1:M1$,
6300 PRINT @(32,14),A$(133,4),@(42,14),A$(137,2),
6305 IF SEC$(63,1)<>"Y" THEN IF A[9]<>0 THEN PRINT @(64,14),A[10]*100/A[9]:M1$,"%",
6310 PRINT @(21,15),A[12]*CUR1:M1$,
6315 PRINT @(21,17),A[9]*CUR1:M1$,@(58,17),A[6]*CUR1:M1$,
6320 PRINT @(21,18),A[8]*CUR1:M1$,@(58,18),A[3]*CUR1:M1$,
6325 PRINT @(21,19),A[7]*CUR1:M1$,@(58,19),A[5]*CUR1:M1$,
6335 PRINT @(21,20),A[2]*CUR1:M1$,@(58,20),(A[3]-A[5])*CUR1:M1$,
6338 IF POS(" "<>A$(139,21))=0 THEN GOTO 6351
6340 CALL "ZZDISP","D",A$(139,6),"",X3$,"","",53,15,X4$
6350 PRINT @(64,15),A$(145,15),
6355 PRECISION 7
6360 IF PP$(118,1)="Y" AND CUR1<>1 THEN PRINT @(10,21),"Foreign Currency: ",CUR$(18,3),@(40),"Rate: ",CUR1 ELSE PRINT @(0,21),'CL'
6370 PRECISION 2
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6490 RETURN 
7500 REM "CUSTOM PROGRAMMING ROUTINES
8950 REM "Program flow logic
8960 DIM U0$(6); U0$(1)=FID(0); U0$=U0$+"PF"
8970 CLOSE (14); OPEN (14)"ZZPARM"; FIND (14,KEY=U0$,DOM=8990)U0$,U1$
8980 Q1=NUM(U1$(7,2)),Q1$=U1$(9,Q1),U1$=U1$(Q1+9)
8990 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9700 REM "PROG FLOW
9705 %IL_IMAGE_TYPE$="",%IL_IMAGE_KEY$=""
9710 IF U1$="" THEN REMOVE (Z[6],KEY=U0$,DOM=9900); GOTO 9900
9720 WRITE (Z[6],KEY=U0$)U0$,U1$
9725 PRINT @(0,3),'CE',
9730 RUN U1$(1,6)
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9905 %IL_IMAGE_TYPE$="",%IL_IMAGE_KEY$=""
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
