0010 REM "Sales Tax Masterfile - With Sales Tax Service<AR2MEB>
0020 SETESC 9300; SETERR 9000
0025 REM "(C) Copyright 1986 - All Rights Reserved
0035 REM "5.7 - 12/29/11 - 9.85 - crg - SSP# 249775
0037 REM "249775-Changes to sales tax parameters and tax calculations to     
0040 REM "Copyright 2011 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0044 ! ********************************************************************    
0045 ! THIS PROGRAM WILL NO LONGER BE MODIFIED. THE GUI PANEL WILL BE PROCESSED FROM HERE. ALL FUTURE CHANGES NEED TO BE MADE IN ARGMEB PANEL AND PROGRAM. (RE WO 249775)
0046 ! ********************************************************************
0050 IF TCB(13)=1 THEN BEGIN 
0052 IF NUL(%WDX$) THEN MSGBOX "You must be using Windx to access this feature!"; GOTO 0075
0055 IF NOT(%GUI) THEN CHUI_MODE=1; %GUI=1; PRINT 'SHOW'(0)
0060 PROCESS "ARGMEB","../ARG/AR.EN"
0065 IF CHUI_MODE THEN %GUI=0; PRINT 'SHOW'(1); RUN "ZMENU"
0075 IF TCB(13)=1 THEN RUN "ZMENU" ELSE EXIT 
0085 ! 
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,Q0$,Q1$
0100 SETERR 9000
0110 X0$="AR2MEB",X1$="Sales Tax Setup-Sales Tax Service  ",K9$="",K9=0
0120 DIM Z0$(80,"-")
0130 K0=10,K1=1
0135 C9=-1,V9=-2
0140 M0$="-###.000",M1$="-#,###.00",M2$="-##.000" ! 233585
0175 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"3" THEN PRECISION NUM(X3$(66,1),ERR=0246) ELSE PRECISION 3
0295 DIM Z0$(80,X3$(235,1)); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$(1,LEN(A$)),A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7]
0320 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7]
0330 IOLIST C$,C[0],C[1],C[2],C[3]
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01X AR5...  02O GL1...  03O AX3...  04O AX4...  06O ZZPARM  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0585 W9$=""; CALL "RT2PRM",ERR=0586,X3$,X4$,W9$
0590 READ (Z[6],KEY=X3$(9,3)+"A/R")D$
0591 IF D$(119,1)="Y" THEN GOSUB 7900; REM "WO91564
0600 REM "
0620 GOSUB 6000
1000 REM "
1005 READ (Z[1],KEY=A1$,DOM=1006)
1010 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,X2
1034 REM "A$ positions 37,6, 43,6, & 49,6 are used by the vertex tax program
1035 DIM A$(190+K9),A[7],B[7],C[7]
1036 GL1P$="",GL1A$=""
1040 IF V9<>-1 THEN GOSUB 6900
1045 A$(1,0+K9)=K9$+A1$
1050 PRINT @(9,8),'CL',@(9,9),'CL',@(9,10),'CL',
1060 PRINT (0,ERR=1070)@(0,11+V0),; GOSUB 6450; GOTO 1100
1061 REM "PRINT (0,ERR=1070)@(0,11+V0),'CE','CF',; GOSUB 6450; GOTO 1100
1070 GOSUB 6000; GOSUB 6450
1100 REM "KEY SEQ
1110 X0=-1,C0=0,X1=0,C9=0,Z9=0
1120 C0=ABS(C0),X$=""; IF C0=2 AND X0>0 THEN X0=X0-1 ELSE IF C0<>2 THEN X0=X0+1; IF C0=4 THEN GOTO 9900
1140 ON X0 GOTO 1200,1500
1200 REM "Sales tax code
1205 IF D$(116,1)="Y" THEN X$="F9 for ZipCode Lookup" ELSE X$=""
1210 CALL "ZZENTR","AXUXF",A{ALL},A$,X4$,X3$,16,3+V0,1+K9,10,C0,"AR5","{1"+X$,"","AR2MEA00","AR5","",""; X$=""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1210,1220
1215 REM "CALL "ZZENTR","AXUXF",A{ALL},A$,X4$,X3$,16,3+V0,1+K9,10,C0,"AR5","{1"+X$,"","AR2MEA00","AX3","",""; X$=""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1215,1216
1220 IF C0=13 THEN C0=6; CALL "AR2ZIP",X3$,X4$,A$,1,X$; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 1215,1221
1223 REM "LET A1$=A$
1230 REM "GOSUB 7800
1240 GOTO 1120
1500 REM "
1505 Z9=-1
1510 A1$=K9$+A$(LEN(K9$)+1,10),A$(1,LEN(K9$))=K9$
1517 V2=POS(" "=A$(1+K9,10))
1518 V1=2
1519 REM "IF V2>7 OR V2=0 THEN V1=2 ELSE IF V2>3 THEN V1=1 ELSE V1=0
1520 READ (Z[1],KEY=A1$,DOM=1600)IOL=0310
1521 IF A$(182,1)=DIM(1) THEN A$(182,1)="N"
1525 Z9=0
1530 GOSUB 6600
1590 GOTO 1700
1600 REM "
1610 REM "GOSUB 6300; IF D$(119,1)="Y" AND V1=0 THEN GOSUB 6200
1620 CALL "ZZPROM","2",X3$,Z,"","","",0; ON Z GOTO 1650,1630,6975
1630 GOTO 1000
1660 REM "IF V9>=0 THEN GOSUB 6200
1690 GOTO 2000
1700 REM "
1780 REM "GOSUB 6300
1790 GOSUB 6200
1800 REM "
1820 CALL "ZZPROM",STR(6+C9),X3$,Z,"","","V",X0; ON Z GOTO 1850,6500,1630,6700,6800
1830 GOTO 2000
1850 REM "MODIFY
1855 X0=X0-1; IF Z9=1 THEN GOTO 1880 ELSE IF Z9=0 THEN Z9=1
1858 REM "GOSUB 6300
1860 EXTRACT (Z[1],KEY=A1$,DOM=1870)IOL=0310
1865 C9=1
1870 REM "GOSUB 6200; GOSUB 7600
1890 IF Z<0 THEN GOTO 2035 ELSE GOTO 2000
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1
2020 C9=1,X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF C0>3 OR X0<0 THEN GOTO 1800
2035 IF X0*6+11<LEN(V9$) THEN IF V9$(X0*6+11,1)="2" THEN GOTO 2020
2040 ON X0 GOTO 2100,2400,2450,2500,2600,2650,2700,2750,2800,2850,2900,2950,3000,3050,3100,3150,2300,2350,3200,1800
2100 REM "Description
2110 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,43,1+V0+V1,11+K9,25,C0,"","{3"+X$,"","AR2MEA02","","",""
2120 PRINT @(43,3+V0),A$(11+K9,25),
2140 GOTO 2020
2150 REM "Tax freight?
2160 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,28,7+V0+V1,36+K9,1,C0,"","{3"+X$,"","AR2MEA04","","",""
2190 GOTO 2020
2200 REM "Tax rate
2210 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,45,7+V0+V1,0,330,C0,M0$,"{3"+X$,"","AR2MEA06","","",""
2230 GOSUB 7600
2240 GOTO 2020
2250 REM "Maximum tax
2260 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,62,7+V0+V1,1,421,C0,M1$,"{3"+X$,"","AR2MEA08","","",""
2290 GOTO 2020
2300 REM "Sales tax payable G/L account number, WO91564
2303 IF D$(119,1)<>"Y" THEN GOTO 2020
2304 REM "IF V1<>0 THEN GOTO 2020; REM "Only for state record
2310 CALL "ZZENTR","AX",A{ALL},A$,X4$,X3$,20,14+V0+V1,55,12,C0,"G/L","{3"+X$,"","AR2MEA10","GL1","GL2MAA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2310,2311
2320 IF POS(" "<>A$(55,12))>0 THEN FIND (Z[2],KEY=A$(55,12),DOM=2320)GL1P$; PRINT @(30,14+V0+V1),GL1P$(13,35),
2340 GOTO 2020
2350 REM "Accrued sales tax G/L account number, WO91564
2353 IF D$(119,1)<>"Y" THEN GOTO 2020
2354 REM "IF V1<>0 THEN GOTO 2020; REM "Only for state record
2360 CALL "ZZENTR","AX",A{ALL},A$,X4$,X3$,20,15+V0+V1,67,14,C0,"G/L","{3"+X$,"","AR2MEA12","GL1","GL2MAA",""; IF ABS(C0)>4 THEN GOSUB 6400; ON C0 GOTO 2360,2361
2370 IF POS(" "<>A$(67,12))>0 THEN FIND (Z[2],KEY=A$(67,12),DOM=2360)GL1A$; PRINT @(30,15+V0+V1),GL1A$(13,35),
2390 GOTO 2020
2400 REM " State Code
2410 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,9,8,119+K9,2,C0,"","{3"+X$,"","AR2MEA02","","",""
2440 GOTO 2020
2450 REM "State Description
2460 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,15,8,157+K9,25,C0,"","{3"+X$,"","AR2MEA02","","",""
2490 GOTO 2020
2500 REM " Tax Freight - State
2510 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,48,8,154+K9,1,C0,"","{3"+X$,"","AR2MEA04","","",""
2540 GOTO 2020
2600 REM "Tax rate - STATE
2610 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,58,8,3,330,C0,M0$,"{3"+X$,"","AR2MEA06","","","" ! 233585
2640 GOTO 2020
2650 REM "Maximum Tax - STATE
2660 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,70,8,4,421,C0,M1$,"{3"+X$,"","AR2MEA06","","",""
2690 GOTO 2020
2700 REM "County Code
2710 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,9,9,151+K9,3,C0,"","{3"+X$,"","AR2MEA02","","",""
2740 GOTO 2020
2750 REM "County Description
2760 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,15,9,121+K9,25,C0,"","{3"+X$,"","AR2MEA02","","",""
2790 GOTO 2020
2800 REM "Tax Freight - County
2810 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,48,9,155,1,C0,"","{3"+X$,"","AR2MEA04","","",""
2840 GOTO 2020
2850 REM "Tax Rate - County
2860 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,58,9,2,330,C0,M0$,"{3"+X$,"","AR2MEA06","","",""
2890 GOTO 2020
2900 REM "Maximum Tax - County
2910 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,70,9,5,421,C0,M1$,"{3"+X$,"","AR2MEA06","","",""
2940 GOTO 2020
2950 REM "Other Description
2960 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,15,10,79+K9,25,C0,"","{3"+X$,"","AR2MEA02","","",""
2990 GOTO 2020
3000 REM "Tax Freight - Other
3010 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,48,10,156+K9,1,C0,"","{3"+X$,"","AR2MEA04","","",""
3040 GOTO 2020
3050 REM "Tax Rate - Other
3060 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,58,10,0,330,C0,M0$,"{3"+X$,"","AR2MEA06","","",""
3090 GOTO 2020
3100 REM "Maximum Tax - Other
3110 CALL "ZZENTR","N",A{ALL},A$,X4$,X3$,70,10,6,421,C0,M1$,"{3"+X$,"","AR2MEA06","","",""
3120 PRINT @(58,11),Z0$(1,LEN(M1$)+3)+MNM('GE'),@(20,12),"Total Tax Rate",@(58,12),(A[0]+A[2]+A[3]):M0$,
3121 A$(183,7)=STR((A[0]+A[2]+A[3]):M2$) ! 233585
3140 GOTO 2020
3150 REM "Zip code
3160 CALL "ZZENTR","AXU",A{ALL},A$,X4$,X3$,20,13+V0+V1,109,9,C0,"ZIP","{3"+X$,"","ZY2AAA08","ZY1","ZY2MBA",""
3190 GOTO 2020
3200 REM "Disallow Overriding of Sales Tax Code by System (vertax)
3210 CALL "ZZENTR","Y",A{ALL},A$,X4$,X3$,42,16+V0+V1,182+K9,1,C0,"","{3"+X$,"","AR2MEA04","","",""
3240 GOTO 2020
3250 REM Location Code Downloaded from Veratax - SSP 219276
3251 REM Add to 2040 after 3250 and before 1800 if they want to be able to modify
3260 CALL "ZZENTR","S",A{ALL},A$,X4$,X3$,65,16+V0+V1,146+K9,4,C0,"","{3"+X$,"","AR2MEA02","","",""
3290 GOTO 2020
6000 REM "BACKGROUND
6005 PRINT (0,ERR=6016)'SB',
6047 IF D$(119,1)="Y" THEN PRINT @(1,16),"Sales tax payable:",@(1,17),"Accrued sales tax:",
6048 PRINT @(1,18),"Disallow System Overriding the Tax Code:",
6049 PRINT @(50,18),"Location Code: "; REM SSP 210276
6060 PRINT @(0,3+V0),"Sales tax code:",@(30,3+V0),"Description:",@(0,4+V0),Z0$,
6070 PRINT @(47,5+V0),"Tax",@(62,5+V0),"Tax",@(72,5+V0),"Maximum",@(45,6+V0),"freight?",@(62,6+V0),"rate",@(74,6+V0),"tax",
6075 PRINT @(18,6),"Description",
6078 PRINT @(0,7+V0),Z0$(1,80)+MNM('GE'),
6080 PRINT @(2,8+V0),"State:",@(1,9+V0),"County:",@(2,10+V0),"Other:",
6128 PRINT @(10,15),"Zip Code:",
6165 REM "PRINT (0,ERR=6166)'SF',
6190 RETURN 
6200 REM "DISPLAY DATA
6215 GOSUB 6450
6217 PRINT @(43,3),A$(11,25),
6220 PRINT @(9,8),A$(119,2),@(15,8),A$(157,25),@(48,8),A$(36+K9,1),@(58,8),A[3]:M0$,@(70,8),A[4]:M1$,
6221 PRINT @(58,9),A[2]:M0$,@(70,9),A[5]:M1$,@(58,10),A[0]:M0$,@(70,10),A[6]:M1$,
6222 PRINT @(15,10+V0),A$(79,25),
6223 CALL "ZZDISP","A",A$(109,9),"ZIP",X3$,"","",20,15,X4$
6225 PRINT @(9,9),A$(151,3),@(15,9),A$(121,25),
6226 PRINT @(48,9),A$(155,1),@(48,8),A$(154,1),@(48,10),A$(156,1),
6227 PRINT @(58,11),Z0$(1,LEN(M1$)+3)+MNM('GE'),@(20,12),"Total Tax Rate",@(58,12),(A[0]+A[2]+A[3]):M0$,
6228 REM "PRINT @(10,15),"Zip Code:",
6229 PRINT @(65,16+V0+V1),A$(146+K9,4); REM SSP 219276
6230 REM "PRINT @(0,16),'CE',
6243 REM "CALL "ZZDISP","A",A$(109,9),"ZIP",X3$,"","",20,13+V0+V1,X4$
6245 IF D$(119,1)<>"Y" THEN GOTO 6260; REM "G/L account numbers, WO91564
6247 REM "PRINT @(1,14+V0+V1),"Sales tax payable:",@(1,15+V0+V1),"Accrued sales tax:",
6250 CALL "ZZDISP","A",A$(55,15),"G/L",X3$,"","",20,16,X4$; IF GL1P$>"" THEN PRINT @(30,16),GL1P$(13,35),
6255 CALL "ZZDISP","A",A$(67,12),"G/L",X3$,"","",20,17,X4$; IF GL1A$>"" THEN PRINT @(30,17),GL1A$(13,35),
6260 IF POS(" "<>A$(37,6))=0 THEN GOTO 6270
6261 PRINT @(1,17+V0+V1),"Last update on:",@(4,18+V0+V1),"Update code:",@(0,19+V0+V1),"Effective after: ",
6263 CALL "ZZDISP","D",A$(37,6),"",X3$,"","",17,17+V0+V1,X4$
6265 PRINT @(17,18+V0+V1),A$(43,6),
6267 CALL "ZZDISP","D",A$(49,6),"",X3$,"","",17,19+V0+V1,X4$
6268 PRINT @(42,18),A$(182,1),
6270 PRINT @(42,18),A$(182,1),
6290 RETURN 
6300 REM "Print previous tax codes"
6305 PRINT (0,ERR=6306)'SB',
6310 ON V1 GOTO 6340,6330,6320
6320 REM "DIM B$(190+K9),B[3]; FIND (Z[1],KEY=A$(1+K9,6)+"    ",DOM=6321)IOL=0320
6325 REM "PRINT @(1,8+V0),B$(11+K9,25),@(33,8+V0),B$(36+K9,1),@(45,8+V0),B[0]:M0$,@(62,8+V0),B[1]:M1$,
6330 REM "DIM C$(190+K9),C[3]; FIND (Z[1],KEY=A$(1+K9,2)+"        ",DOM=6331)IOL=0330
6335 REM "PRINT @(1,7+V0),C$(11+K9,25),@(33,7+V0),C$(36+K9,1),@(45,7+V0),C[0]:M0$,@(62,7+V0),C[1]:M1$,
6340 PRINT (0,ERR=6341)'SF',
6350 GOSUB 7600
6390 RETURN 
6400 REM "WHOLE SCREEN
6405 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,X5$,X0,X1,0
6420 GOSUB 6000
6430 IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6431 REM "IF C9>=0 THEN GOSUB 6200 ELSE GOSUB 6450
6435 REM "GOSUB 6300; REM "WO91564
6440 IF ABS(C0)>4 THEN C0=ABS(C0)-5
6445 RETURN 
6450 REM "DISPLAY KEYS
6455 IF C9<0 THEN GOTO 6445
6460 CALL "ZZDISP","A",A$(1+K9,10),"AR5",X3$,"","",16,3+V0,X4$
6490 RETURN 
6500 REM "DELETE
6510 REMOVE (Z[1],KEY=A1$,DOM=6511)
6512 REMOVE (Z[3],KEY=A$(109,10)+A1$(8,3)+A$(1,10),DOM=6513); REM " REMOVE FROM ZIP CODE SORT
6513 REMOVE (Z[4],KEY=A$(119,2)+A$(121,25)+A$(79,25)+A$(1,10),DOM=6514); REM " REMOVE FROM ZIP CODE SORT
6515 IF W9$>"" THEN IF W9$(7,1)="H" THEN CALL "RT2WOR",ERR=6516,X3$,X4$,"","AR5...","D",A1$,A$,3,A{ALL}; REM "Record remote T/M change if this is the host
6590 GOTO 1630
6600 REM "ALT KEY DATA READS
6605 IF D$(119,1)<>"Y" THEN RETURN 
6610 FIND (Z[2],KEY=A$(55,12),DOM=6611)GL1P$
6620 FIND (Z[2],KEY=A$(67,12),DOM=6621)GL1A$
6690 RETURN 
6700 REM "ADD ENTRY
6705 REM "IF Z9=0 THEN GOTO 6790
6707 A[7]=A[0]+A[2]+A[3]
6710 WRITE (Z[1],KEY=A1$)IOL=0310
6712 WRITE (Z[3],KEY=A$(109,10)+A$(8,3)+A$(1,10)); REM "WRITE NEW SORT FILE BY ZIP
6713 WRITE (Z[4],KEY=A$(119,2)+A$(121,25)+A$(79,25)+A$(1,10)); REM "WRITE NEW SORT FILE BY STATE/COUNTY/CITY
6715 REM "IF W9$>"" THEN IF W9$(7,1)="H" THEN CALL "RT2WOR",ERR=6716,X3$,X4$,"","AR5...","U",A1$,A$,3,A{ALL}; REM "Record remote T/M change if this is the host
6720 REM "IF V1=2 THEN GOTO 6790
6730 REM "GOSUB 7700
6790 GOTO 1630
6800 REM "NEXT ENTRY IN FILE
6805 ON 10*FPT(C0)+2 GOTO 6850,6806
6810 A1$=KEY(Z[1],END=6895)
6820 A$(1,LEN(A1$))=A1$
6825 IF A1$(1,LEN(K9$))<>K9$ THEN GOTO 1140
6830 GOSUB 6600
6835 GOSUB 6450
6840 GOTO 1515
6850 REM PRIOR ENTRY
6855 CALL "ZZKEYP",ERR=6856,Z[1],A1$; GOTO 6820
6860 CALL "ZZKEYL",ERR=6861,Z[1],A1$; GOTO 6820
6870 GOTO 6895
6890 GOTO 1515
6895 PRINT 'RB',; READ (Z[1],KEY=K9$,DOM=1140); GOTO 1140
6900 REM "GET DEFAULTS
6902 V9$="1603  4303  3307  4507  6207  "
6910 IF V9>=0 THEN READ (Z[6],IND=V9)V9$,IOL=0310; GOTO 6930 ELSE V9=-1
6920 EXTRACT (Z[6],KEY=X0$+"DFLT",DOM=6921)V9$,IOL=0310; V9=IND(Z[6]); READ (Z[6])
6930 RETURN 
6950 REM "WRITE DEFAULT
6955 WRITE (Z[6],KEY=X0$+"DFLT")V9$,IOL=0310
6960 GOSUB 6920; GOTO 1630
6970 REM "ENTRY DEFAULTS
6975 PRINT 'CF'; V9=-2,Q$=""
6980 FOR X=1 TO LEN(V9$) STEP 6
6982 PRINT @(NUM(V9$(X,2)),NUM(V9$(X+2,2))),; IF V9=-2 THEN PRINT V9$(X+4,1), ELSE READ RECORD (0,SIZ=1)Q$; IF POS(Q$="1234Z")=0 THEN PRINT 'RB'; GOTO 6982
6990 IF Q$="Z" THEN EXITTO 6950 ELSE V9$(X+4,LEN(Q$))=Q$; NEXT X
6995 V9=0; GOTO 6980
7500 REM "CUSTOM PROGRAMMING ROUTINES
7525 REM "Modified stmts: 
7550 REM "Added stmts: 
7575 REM "Deleted stmts: 
7600 REM "Calculate & print total"
7610 REM "A[2]=B[0],A[3]=C[0]
7620 REM "PRINT @(45,8+V0+V1),Z0$(1,LEN(M0$)+3)+MNM('GE'),@(45,9+V0+V1),A[0]+B[0]+C[0]:M0$,
7650 RETURN 
7700 REM "Update cumulative totals"
7701 REM "V2 is set @ 1518 C(0) is set in 6300's
7710 X5$="Now updating other tax rates that are based on "+FNS$(A$(11+K9,25))
7720 PRINT @(40-INT(LEN(X5$)/2),20),X5$,
7725 K$=KEY(Z[1],END=7780)
7726 DIM C[3]
7730 IF K$(1+K9,V2-1)<>A$(1+K9,V2-1) THEN GOTO 7780
7731 IF V1=1 THEN FIND (Z[1],KEY=K$(1,2)+"        ",DOM=7733)IOL=0330; GOTO 7733
7732 IF POS(" "<>K$(7,4))<>0 THEN FIND (Z[1],KEY=K$(1,6)+"    ",DOM=7733)IOL=0330
7735 EXTRACT (Z[1],KEY=K$,END=7780)IOL=0320
7736 CALL "ZZDISP","A",B$(1+K9,10),"AR5",X3$,"","",33,21,X4$
7745 REM "IF V=1 THEN B[2]=A[0],B[3]=C[0] ELSE B[2]=C[0],B[3]=A[0]
7750 WRITE (Z[1],KEY=K$)IOL=0320
7753 IF W9$>"" THEN IF W9$(7,1)="H" THEN CALL "RT2WOR",ERR=7754,X3$,X4$,"","AR5...","U",K$,B$,3,B{ALL}; REM "Record remote T/M change if this is the host
7755 GOTO 7725
7780 PRINT @(0,20),'CE',
7790 RETURN 
7800 REM "Check to see prior sections are there
7810 IF POS(" "<>A$(3,8))=0 THEN GOTO 7890 ELSE IF POS(" "<>A$(7,4))=0 THEN GOTO 7850
7815 REM "Check out for third section
7830 FIND (Z[1],KEY=A$(1,6)+"    ",DOM=7831); GOTO 7890
7840 J$="Tax code "+A$(1,2)+"-"+FNS$(A$(3,4))+" must be set up before "+A$(1,2)+"-"+FNS$(A$(3,4))+"-"+FNS$(A$(7,4))
7845 GOTO 7880
7850 REM "Check out for second section
7860 FIND (Z[1],KEY=A$(1,2)+"        ",DOM=7861); GOTO 7890
7865 J$="Tax code "+A$(1,2)+" must be set up before "+A$(1,2)+"-"+FNS$(A$(3,4))
7880 CALL "ZZPROM","4",X3$,Z,J$,"","",0
7885 EXITTO 1210
7890 RETURN 
7910 CALL "ZZDISP","AX","000000000000","G/L",X3$,W2$,"",0,0,X4$; L9=2+LEN(W2$); RETURN ; REM "WO91564
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9900 REM "END PROGRAM
9905 PRECISION 2
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
56000 REM "219276-Veratax enhancements related to new taxing requirements
56002 REM "233585-Sales tax issue with override ship to-Order was invoiced at 
56004 REM "249775-Changes to sales tax parameters and tax calculations to     
