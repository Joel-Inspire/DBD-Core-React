0010 REM "Display for invoice lines <AR2EAJ>
0020 SETESC 9300; SETERR 9000
0035 REM "4.4 - 01/26/99 - 11.61 - jel - SSP# 100164
0040 REM "Copyright 1999 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 SETERR 9000
0110 ENTER X3$,X4$,B$,B{ALL},D7,H$,J0,G$,C9,W$,M5$
0139 REM "This should be dup of line 140 in AR2EAL
0140 M0$="##,###,###.00-",M1$="###,###.00-",M2$="##,###.00-",M3$="##,###"
0145 IF LEN(M5$)<>11 THEN INPUT @(0,22),'CL',"M5$ NOT SET IN AR2EAJ!! ",'RB',*
0180 CLOSE (14); OPEN (14)"ZZPARM"
0190 DIM SEC$(255); FIND (14,KEY="osec"+X3$(40,3),DOM=0191)SEC$; REM "jel 100164 GoldBond
0200 REM 
0205 ON C9 GOTO 0210,0220,0230,0240
0210 GOSUB 6200; GOTO 9900
0220 GOSUB 6295; GOTO 9900
0230 GOSUB 8200; GOTO 9900
0240 GOSUB 1000; GOTO 9900
1000 REM "Changed type - set up new line
1020 GOSUB 6300
1040 RETURN 
6200 REM "PRINT ONE ENTRY
6205 IF B$(1,1)="M" THEN GOSUB 6300; PRINT @(39,8),B$(7,40),@(12,11),B$(6,1),; RETURN ELSE PRINT @(0,8),'CL',; PRINT @(50,6),'CL',
6210 ON POS(B$(1,1)="NFICS") GOTO 6220,6212,6212,6215,6214,6212
6212 PRINT @(0,8),B$(65,10),; GOTO 6220
6214 PRINT @(19,6),'SB',"Cust #:",'SF',; CALL "ZZDISP","A",B$(55,10),"A/R",X3$,"","",27,6,X4$
6215 CALL "ZZDISP","A",B$(65,10),"ICE",X3$,"","",0,8,X4$; GOSUB 8200
6220 PRINT @(16,6),B$(1,1),@(39,8),B$(7,40),@(11,8),B$(3,3),@(16),B$(93,8),@(25),B$(101,8),@(35),B$(109,2),
6225 GOSUB 6295
6226 PRINT @(12,11),B$(6,1),
6228 GPADJ=B[8]; IF SEC$(63,1)<>"Y" THEN GOTO 6229 ELSE GPADJ=0
6230 PRINT @(17,13),B$(84,5),@(23),H$(6,19),@(50),GPADJ:M1$,@(68),B[7]:M1$,
6235 CALL "ZZDISP","A",B$(75,9),"ARV",X3$,"","",17,14,X4$
6237 CALL "ZZDISP","A",B$(125,10),"AR5",X3$,"","",59,14,X4$
6240 PRINT @(J0-6,14),G$(10,18),@(51,14),B$(111,1),@(77,14),B$(54,1),
6280 REM 
6290 RETURN 
6295 COST=B[3]; IF SEC$(63,1)<>"Y" THEN GOTO 6296 ELSE COST=0
6296 PRINT @(0,10),B$(50,4),@(5),B[6]:M3$,@(12),B[0]/D7:M0$,@(27),B[1]/D7:M0$,@(42),B[2]:M5$,@(42,11),COST:M5$,; GOSUB 7635
6297 RETURN 
6300 REM "CLEAR 1 ENTRY"
6310 PRINT @(50,6),'CL',@(0,8),'CL',@(0,10),'CL',@(12,11),'CL',@(17,13),'CL',@(17,14),'CL','SB',@(36,11),"Cost:",@(43,13),"GP Adj:",@(62),"Comm:",@(41,14),"Ord type:",@(54),"STC:",@(72),"Tax?",'SF',
6320 RETURN 
7634 REM "This routine is duplicated in AR2EAL,AR2EAM & AR2EAI for speed, so change there also
7635 PRINT @(54,10),B[4]:M0$,@(54,11),B[5]:M0$,@(69,10),'CL',@(69,11),'CL',
7636 B=B[4]-B[5]; PRINT @(69,10),B:M1$,; IF B[4]<>0 THEN PRINT @(72,11),B*100/ABS(B[4]):"-###.00%",
7640 RETURN 
8200 REM "Print location info
8202 IF POS(B$(1,1)="IC")=0 THEN PRINT @(50,6),'CL',; RETURN 
8204 IF B$(89,4)="DS  " THEN W0$="Direct shipment"; GOTO 8230
8205 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
8210 DIM W0$(19)
8215 IF POS(" "<>W$(111,16))<>0 THEN W0$(1)=FNS$(W$(111,16))+","+W$(127,2)
8230 PRINT @(50,6),B$(89,4)," ",W0$,
8240 RETURN 
9000 REM "ERROR PROCESSING
9005 EXIT ERR
9900 REM "END PROGRAM
9910 EXIT 
9999 END 
