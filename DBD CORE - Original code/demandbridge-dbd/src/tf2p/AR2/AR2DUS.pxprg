0010 REM "A/R Invoice Update Statistics Overlay <AR2DUS>
0020 SETESC 9300; SETERR 9000
0035 REM "2.2.1
0040 REM "Copyright 1987 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 SETERR 9000
3200 REM "Update Customer Statistics
3201 REM "Update stats to invoice customer not bill-to customer
3205 Q1$=A$(15,10)+A$(1,4),Q1=NUM(A$(5,2)),S9$=S7$,K9=Z[2]
3210 FOR I=21 TO POS(" "=P0$(21,10)+" ")+19
3240 Q0$=P0$(I,1)
3250 ON POS(Q0$="SPN") GOTO 3300,3260,3265,3280
3260 Q0=A[1]; GOTO 3300
3265 Q0=A[1]-A[11]; GOTO 3300
3280 Q0=1; GOTO 3300
3300 GOSUB 8500
3480 NEXT I
3500 REM "Update Salesperson Statistics
3505 T0=POS("    "=A$(133,20)+"    "); IF T0=1 THEN T0=0 ELSE T0=INT(T0/5)
3507 K9=Z[8],S9$=S8$
3508 IF T0>NUM(P1$(8,1)) THEN T0=NUM(P1$(8,1))
3510 DIM H$(9),H[14],T[100]
3515 DIM S[5]; FOR I0=1 TO 5; S[I0]=A[I0+11]; NEXT I0
3520 CALL "AR2XAA",X3$,A{ALL},1,20,T{ALL},S{ALL},1,5
3525 FOR I=9 TO POS(" "=P1$(9,10)+" ")+7
3550 FOR J=0 TO T0
3600 J0=J*20,Q1$=A$(133+J*4,4)+A$(1,4),Q1=NUM(A$(5,2)),Q0$=P1$(I,1)
3610 ON POS(Q0$="SPCN") GOTO 3701,3630,3640,3650,3680
3630 Q0=T[J0]; GOTO 3700
3640 Q0=T[J0]-T[J0+10]; GOTO 3700
3650 Q0=T[J0+17]; GOTO 3700
3680 Q0=1; GOTO 3700
3700 GOSUB 8500
3775 NEXT J
3780 NEXT I
3785 DIM T[0]
3790 RETURN 
3800 RETURN 
3810 L0=2
3890 RUN "AR2DUA"
8500 REM "Update stats q0$ in period q1 with data q0
8501 REM "Assumes that K9 has been set
8510 IF Q0=0 THEN GOTO 8560
8520 DIM K[14]; P9$=Q1$+Q0$
8530 GOSUB 8570
8540 K[Q1]=K[Q1]+Q0
8550 GOSUB 8610
8560 RETURN 
8570 REM "Read stats (Packed/Unpacked)
8580 Q=POS(Q0$=S9$(49),17); IF Q=0 THEN EXITTO 8560 ELSE M0$=S9$(Q+48,17)
8590 CALL "ZZPACK",X3$,"E",M0$(3,2),"",0,0,K{ALL},K9,Q0$,Q1$,S9$
8600 GOTO 8630
8610 REM "Write stats
8620 CALL "ZZPACK",X3$,"W",M0$(3,2),"",0,0,K{ALL},K9,Q0$,Q1$,S9$
8630 RETURN 
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,1
9050 ON Y7 GOTO 9060,9100,9190,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9190 GOSUB 6600; GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9900 REM "END PROGRAM
9905 CALL "ZZDAPP",X3$,"!DGL2XUA"
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 IF Y4$>"" THEN RUN Y4$
9950 RUN "ZMENU"
9999 END 
