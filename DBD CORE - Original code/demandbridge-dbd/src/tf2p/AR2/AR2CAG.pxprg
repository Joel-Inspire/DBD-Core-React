0010 REM "Deposit Check header lookup <AR2CAG>"
0035 REM "5.2 - 05/21/03 - 12.463888 - tma - SSP# 149972
0040 REM "Copyright 2003 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0165 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
0335 DEF FNS$(Z0$)=Z0$(1,POS("  "=Z0$+"  ")-1)
0510 IOLIST A$,N[0],N[1],N[2],N[3]
0800 SETESC 5100; SETERR 9000
1000 REM "
1020 ENTER X3$,X4$,L1$,Y9$,Y2$,Q0$,X0,X2,Y8,X5$,X2$,X3,X7$
1080 IF LEN(X5$)>0 THEN IF X5$(1,1)="N" THEN X4=1; IF X3=0 THEN X3=2
1090 IF L1$="" THEN GOTO 9800
1100 REM "
1105 DIM S$(10),F[20],N[20],Z9$(12,$00$)
1110 L1$=L1$+S$,Y9=LEN(Y9$)
1120 Y0=12,Y0=NUM(L1$(1,2),ERR=1121),L1$=L1$(3)
1200 REM "
1220 CALL "ZZFLES",X3$,Y3$,Y0$,"02O ARP...  ",F{ALL},Z0,0; X0=0; ON Z0 GOTO 1221,9900
1510 L$="ARP1Cash Receipts Check Entry     ARP                080                                                                                heck Reference   Check date                             Check No  Check date    Check amount   Customer name                                                                            0005Z021006   0014D027006   0027N001822   0043S033035   0000 000000   0000 000000   0000 000000                                              
1520 T8=80; DIM D0$(T8,"-"),S0$(T8),P1$(T8+T8)
1530 IF L$(41,6)<>S$(1,6) THEN F0=1,S0=NUM(L$(47,3))
1905 IF X4=1 THEN Y1$=Y9$,Y8=1; GOTO 1960
1908 IF F0=1 THEN Y7=Y8,Y8=S0-1,S1=S0
1910 DIM Y1$(Y8)
1960 IF F0=1 THEN Y8=Y7; READ (F[3],KEY=Y1$,END=1990,DOM=1990) ELSE READ (F[2],KEY=Y1$,DOM=1990,END=1990,ERR=1990)IOL=0510
1980 REM "
1990 IF X3<>1 THEN H9=0,H0=21,H3=T8 ELSE CALL "ZZPRIN","ZZLIST",X3$,Y0$,"",F{ALL},"H","",H0,H9,H2,H3,H4; N0$=X3$(86,40),L0=99,N0$=N0$(1,POS(S$=N0$+S$)-1); IF H4>0 THEN X0=0; GOTO 9900
2000 REM "Analyse the display parms"
2001 REM "In the A array , for X, 0=line#, 1=xpos, 2=pos/ind, 3=len/mask"
2010 DIM A[3,16]; L=0,L9=1,M$="",M1$=""
2015 FOR X=1 TO 10
2020 L2$=L$(307+X*14,14); IF L2$(5,1)=" " THEN EXITTO 2041
2025 A[0,X]=NUM(L2$(1,1)),A[1,X]=NUM(L2$(2,3))+1,A[2,X]=NUM(L2$(6,3)),A[3,X]=NUM(L2$(9,3)),T$=T$+L2$(5,1),L=L+1,C$=C$+L2$(12,3)
2030 IF A[0,X]+1>L9 THEN L9=A[0,X]+1
2035 IF L2$(5,1)="N" THEN CALL "ZZMASK",L2$(9,3),M0$; A[3,X]=LEN(M$)+LEN(M0$)/100,M$=M$+M0$
2040 NEXT X
2045 DIM P1$(132*L9)
2050 REM "Background"
2055 GOSUB 7100
2060 X6$=L$(5,POS("  "=L$(5,30)+"  ")-1)
2065 Y1=Y0,X0=1
2070 IF X3=1 THEN PRINT @(23-INT(LEN(X6$)/2),21),"Now printing the ",X6$," Listing",; GOTO 2100
2071 IF T8>80 THEN PRINT (0,ERR=7200)'T2',@(0,Y0),'CE',; FOR I=0 TO Y0-1; PRINT @(80,I),'CL',; NEXT I ELSE PRINT @(0,Y0),'CE',
2072 GOSUB 7030
2073 PRINT (0,ERR=2074)'SB',
2075 IF POS(" "<>L$(57,T8))<>0 THEN PRINT @(0,Y1),L$(57,T8),; Y1=Y1+1
2080 IF POS(" "<>L$(189,T8))<>0 THEN PRINT @(0,Y1),L$(189,T8),; Y1=Y1+1
2085 IF X3=0 THEN PRINT @(0,Y1),D0$; Y1=Y1+1
2086 PRINT (0,ERR=2087)'SF',@(0,Y1),
2090 L0=Y1,L8=0,L9$=""
2100 REM "Lookup & Report section"
2120 IF F0=1 THEN K$=KEY(F[3],END=2600); READ (F[3]); Y1$=K$(S1),K$=Y1$; READ (F[2],KEY=Y1$,DOM=2120,END=2600,ERR=2150)IOL=0510; GOTO 2160
2140 K$=KEY(F[2],END=2600); READ (F[2],ERR=2141)IOL=0510
2150 IF LEN(K$)<>26 THEN GOTO 2100
2160 IF Y9$>"" THEN IF A$(1,LEN(Y9$))<>Y9$ THEN GOTO 2600
2190 IF L0+L9>H0 THEN IF X3<>1 THEN GOTO 5000 ELSE GOSUB 3600
2200 REM "
2220 L8=L8+1,L9$=L9$+K$
2260 IF X3=0 THEN P1$(1,3)=STR(L8:"#0.")
2300 REM "
2310 FOR X=1 TO L
2340 IF T$(X,1)<>"N" THEN Q$=A$(A[2,X],A[3,X])
2345 ON POS(T$(X,1)="DPNA") GOTO 2390,2350,2355,2360,2365
2350 Q$=FND$(Q$); GOTO 2390
2355 Q$="("+Q$(1,3)+") "+Q$(4,3)+"-"+Q$(7,4)+" Ext: "+Q$(11,4); GOTO 2390
2360 Q$=STR(N[A[2,X]]:M$(INT(A[3,X])+1,100*FPT(A[3,X])))
2361 GOTO 2390
2365 CALL "ZZDISP","AX",A$(A[2,X],A[3,X]),C$(X*3-2,3),X3$,Q$,"",0,0,X4$
2391 REM IF A(0,X)=0 THEN LET P1$(A(1,X),LEN(Q$))=Q$ ELSE LET P1$(T8+A(1,X),LEN(Q$))=Q$
2393 P1$(A[0,X]*T8+A[1,X],LEN(Q$))=Q$
2399 NEXT X
2400 REM "
2420 FOR X=0 TO L9-1
2430 IF X=0 OR POS(" "<>P1$(X*T8+1,T8-1))>0 THEN PRINT (H9)P1$(X*T8+1,T8-1); L0=L0+1
2440 NEXT X
2450 DIM P1$(132*L9)
2590 GOTO 2110
2600 REM "goto proper ending routine"
2610 IF X3=1 THEN GOTO 3500 ELSE GOTO 5100
3500 REM "End to Report option printing"
3520 PRINT (H9)'LF',"Number of items printed: ",L8
3530 PRINT (H9)'FF',
3540 PRINT @(0,22),'CL',
3550 GOTO 9900
3600 REM "Headup routine for Report option"
3610 CALL "ZZHEAD","ZZLIST",X6$+" Report",N0$,X3$,"","","","",T8,L0,H9,H1,H4,H5,H6,"",""
3620 IF L$(57,T0)<>S0$ THEN PRINT (H9)L$(57,T8); L0=L0+1
3630 IF L$(185,T8)<>S0$ THEN PRINT (H9)L$(185,T8); L0=L0+1
3640 PRINT (H9)""; L0=L0+1
3690 RETURN 
5000 REM "
5020 IF X3=2 THEN CALL "ZZPROM","X1ZZLIST",X3$,A,"","","",0; ON A GOTO 5040,1900,9900 ELSE CALL "ZZPROM","X2ZZLIST",X3$,A,"","","V",N; ON A+1 GOTO 5080,5040,6600,1900,9900
5050 GOSUB 7000
5060 ! GOTO 2200
5080 IF N>0 AND N<=L8 THEN GOTO 5300 ELSE GOTO 5020
5100 REM "
5120 IF X3=2 THEN CALL "ZZPROM","X3ZZLIST",X3$,A,"","","",0; ON A GOTO 9900,1900 ELSE CALL "ZZPROM","X0AR2LST",X3$,A,"","","V",N; ON A GOTO 6600,1900,9900
5140 IF N>0 AND N<=L8 THEN GOSUB 5300 ELSE GOTO 5120
5150 GOTO 5120
5300 REM "SELECTION OF ITEM
5310 N=N-1,X2=N
5320 Q0=26-Y9; Q0$=L9$(N*26+Y9+1,Q0)
5340 GOTO 9900
6500 REM "HGLIGHT SELTN
6515 IF Q=0 THEN GOTO 6560 ELSE L0=Y1+Q*L9-L9
6520 PRINT @(0,L0),; IF X3$(238,1)="1" THEN PRINT $08$,
6525 PRINT 'BR',STR(Q:"#0."),'ER',
6530 GOTO 6560
6535 IF Q=0 THEN GOTO 6560 ELSE PRINT @(0,L0),; IF X3$(238,1)="1" THEN PRINT $08$,
6540 IF X3$(238,1)="1" THEN PRINT @(0,L0),$08$," ",@(3,L0)," ", ELSE PRINT 'SF',STR(Q:"#0."),'SF',
6560 RETURN 
6600 REM "
6605 D2$=ATH(X3$(240,24),ERR=6606)
6610 REM "CALL "ZZPROM","S1ZZLIST",X3$,0,"","","",0
6620 Q$=STR(N); GOSUB 8200; REM "READ RECORD (14,SIZ=1)Q$; GOSUB 8200
6622 IF C0<0 THEN GOTO 5080
6625 IF C0<0 THEN IF POS(Q$="1234567890")=0 THEN PRINT 'RB',; GOTO 6620
6630 GOSUB 6535; IF C0>=0 THEN GOTO 6700
6635 Q4=NUM(Q4$+Q$); IF Q4>L8 OR Q4=0 THEN PRINT 'RB',; Q=NUM(Q4$); GOSUB 6515; GOTO 6620 ELSE Q4$=Q4$+Q$
6640 Q=Q4; GOSUB 6515
6650 GOTO 6620
6700 Q$=""
6702 IF C0=4 THEN GOTO 9900
6705 IF C0=0 THEN PRINT @(0,22),'CE',; IF Q4$="" THEN GOTO 5000 ELSE N=NUM(Q4$); GOTO 5080
6710 IF C0=2 THEN IF LEN(Q4$)>1 THEN Q4$=Q4$(1,1) ELSE Q4$=""
6715 Q$=""; GOTO 6635
7000 REM "PAGE CLEAR
7020 PRINT @(0,Y1),'CE',
7030 L0=Y1,L8=0,L9$=""
7090 RETURN 
7100 REM "Check to print numeric value"
7110 I0=POS("\"=L$)
7120 IF I0<57 OR I0+LEN(X7$)>321 THEN RETURN 
7140 IF POS("#"=X7$)<>0 THEN L$(I0,LEN(X7$))=STR(0:X7$) ELSE L$(I0,LEN(X7$))=X7$
7150 RETURN 
7200 REM "Handle error on 'T2' mneumonic
7210 T8=80; GOTO 2071
8000 REM "INPOUT
8200 REM "GET CTRL VALUE
8205 IF Q$=$0D$ THEN C0=1; GOTO 8240 ELSE IF Q$=$08$ THEN C0=3; GOTO 8240
8220 Q9$=Q$,C0=-1,P=POS(Q9$=D2$,6); IF P=0 THEN RETURN ELSE GOTO 8235
8230 READ RECORD (D0,SIZ=1,ERR=8235)Q$; Q9$=Q9$+Q$; IF LEN(Q9$)>6 THEN GOTO 8235 ELSE P=POS(Q9$+Z9$(1,6-LEN(Q9$))=D2$,6); IF P=0 THEN GOTO 8230 ! Removed tim=0 <plh> 144105
8235 IF LEN(Q9$)>6 THEN PRINT 'RB',; RETURN ELSE P=POS(Q9$+Z9$(1,6-LEN(Q9$))=D2$,6); IF P=0 THEN GOTO 8230 ELSE C0=INT(P/6)+1,X3=C0
8240 C0=C0-1; RETURN 
9000 REM "ERROR PROCESSING
9002 PRINT @(0,22),"ERROR: ",ERR," LINE: ",TCB(5),; INPUT *
9005 IF ERR=39 THEN GOTO 5100
9010 E0=ERR,E1=TCB(5)
9040 CALL "ZZERRM",E0$,"AR2CAG",E1$,X3$,E0,E1,E2,E3,0
9100 REM " TRANSFER CONTROL
9190 GOTO 9900
9800 REM "Handle feature not avail.
9805 ON X3 GOTO 9810,9820,9830
9810 CALL "ZZPROM","4",X3$,A,"Lookup feature not available for this input. Press |RETURN","","",0; GOTO 9900
9820 CALL "ZZPROM","4",X3$,A,"Report feature not available for this input. Press |RETURN","","",0; GOTO 9900
9830 CALL "ZZPROM","4",X3$,A,"Zoom feature not available for this input. Press |RETURN","","",0; GOTO 9900
9900 REM "END PROGRAM
9905 IF T8<=80 THEN GOTO 9910
9906 IF X0>0 THEN PRINT 'CS',
9907 PRINT 'T1',
9910 CALL "ZZFLES",X3$,Y3$,Y0$,"END",Z{ALL},0,0
9920 EXIT 
9999 END 
