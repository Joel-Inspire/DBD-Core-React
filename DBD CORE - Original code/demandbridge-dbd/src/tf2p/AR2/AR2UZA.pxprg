0010 REM "Retrieve F/R Data <FR2UZA>
0035 REM "2.2.3
0040 REM "Copyright 1988 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1000 ENTER X3$,G0,A$,Y$,P0$,R0,R0$,R1$,M0$,M1$,X9$,Y{ALL},J0$,I{ALL}
1010 IF G0=0 THEN G0=12
1100 REM 
2000 REM "GET DATA
2020 Y9$=Y$,Y8$=P0$; IF A$(49,1)<>"1" THEN Y9$=STR(NUM(Y9$)+NUM(A$(50,3)):"0000"),Y8$=STR(NUM(Y8$)+NUM(A$(53,3)):"00") ELSE P0$=STR(NUM(A$(53,3)):"00")
2100 REM "GET FIRST RECORD
2105 S0$=A$(1,3)+A$(43,1),Y$=Y9$,P0=NUM(P0$)
2110 IF P0>G0 THEN P0=P0-G0,Y9$=STR(NUM(Y9$)+1:"0000"); GOTO 2110 ELSE IF P0<0 THEN P0=P0+G0,Y9$=STR(NUM(Y9$)-1:"0000"); GOTO 2110
2120 GOSUB 7800
2160 IF A$(56,1)="O" THEN R0=I[0]; GOTO 3000
2200 REM "RANGE OF PERIODS
2210 P8=P0,P9=P0; IF A$(56,1)="B" THEN P9=P0-1,P8=0 ELSE IF POS(A$(56,1)="EY")>0 THEN P8=1-POS("E"=A$(56,1))
2220 IF A$(49,1)="1" THEN IF A$(56,1)>"01" THEN P9=P9+NUM(A$(57,2))-1
2300 REM "CALC
2305 R0=0
2310 FOR X=P8 TO P9
2320 R0=R0+I[X]
2350 NEXT X
2900 REM 
3000 REM 
3090 GOTO 9900
7810 IF S0$+R0$+Y$=J0$ THEN GOTO 7890 ELSE J0$=S0$+R0$+Y$
7815 DIM I[13]
7820 CALL "ZZ2MDZ",X3$,S0$,"",I{ALL},R0$,R1$,Y$,M0$,M1$,X9$,Y{ALL}
7890 RETURN 
9940 EXIT 
9999 END 
