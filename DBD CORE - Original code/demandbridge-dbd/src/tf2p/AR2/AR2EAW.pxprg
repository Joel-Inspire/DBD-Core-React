0010 REM "AR2EAM overlay - <AR2EAW>
0035 REM "4.4 - 01/26/99 - 11.63 - jel - SSP# 100164
0040 REM "Copyright 1999 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 SETERR 9000
0100 GOTO 2040
0400 IOLIST W$
0410 IOLIST J$,J[0],J[1],J[2]
0530 CLOSE (14); OPEN (14)"ZZPARM"
0540 DIM SEC$(255); FIND (14,KEY="osec"+X3$(40,3),DOM=0541)SEC$; REM "jel 100164 GoldBond
1900 REM "Return to AR2EAM
1910 J7=1; RUN "AR2EAM"
2020 X$="",C0=ABS(C0); IF C0=2 AND X0=0 THEN X0=999; GOTO 2040 ELSE IF C0=2 THEN X0=X0-1 ELSE X0=X0+1; IF C0=2 AND X0=0 THEN X[0]=X[0]-1; GOTO 1100
2025 REM "IF INT(C0)=3 THEN GOSUB 8300 ELSE IF C0>3 OR X0<0 THEN LET X0=999
2026 IF C0>3 OR X0<0 THEN X0=999
2037 IF X0>1 AND X0<999 THEN U=1
2040 IF X0<4 OR X0>8 THEN GOTO 1900 ELSE ON X0-4 GOTO 2850,2900,2950,2150,2800,1900
2150 REM "Description
2159 IF D5$="*" THEN D5$=""; ON C0 GOTO 2160,2161
2160 IF POS(B$(1,1)="IC")=0 THEN CALL "ZZENTR","S",B{ALL},B$,X4$,X3$,39,8,7,40,C0,"","{3"+X$,"","AR2EAM04","","",""; IF ABS(C0)>4 THEN GOSUB 6500
2190 GOTO 2020
2800 REM "Inventory location
2802 IF POS(B$(1,1)="IC")=0 THEN GOTO 2020
2804 IF POS(" "<>B$(89,4))=0 AND X3$(9,3)="020" THEN B$(89,4)="00"+A$(15,2); GOSUB 8400
2805 DIM J3$(11); J3$(1,1)="D",J4$=B$(89,4)
2809 IF D5$="*" THEN D5$=""; ON C0 GOTO 2810,2811
2810 CALL "ZZENTR","SZUX",B{ALL},B$,X4$,X3$,50,6,89,4,C0,"","{3"+X$,J3$,"AR2EAM37","FM0D","X",""; IF ABS(C0)=102 THEN J7=6; RUN "AR2EAN" ELSE IF ABS(C0)>4 THEN GOSUB 6500
2815 IF B$(89,4)="DS  " THEN GOTO 2825
2820 FIND (Z[7],KEY=J3$+B$(89,4),DOM=2810)IOL=0400
2825 IF B$(89,1)="9" THEN B[2]=0,B[3]=0,B[4]=0,B[5]=0,O0=0 ELSE O0=2; IF J4$<>B$(89,4) THEN GOSUB 8400
2830 CALL "AR2EAJ",X3$,X4$,B$,B{ALL},D7,H$,J0,G$,O0,W$,M5$
2835 IF ABS(C0)<2 THEN X0=X0+2
2840 GOTO 2020
2850 REM "Left-right
2855 IF POS(B$(1,1)="MS")<>0 THEN GOTO 2020
2859 IF D5$="*" THEN D5$=""; ON C0 GOTO 2860,2861
2860 IF POS(B$(1,1)="IC")=0 THEN CALL "ZZENTR","S",B{ALL},B$,X4$,X3$,16,8,93,8,C0,"","{3"+X$,"","AR2EAM05","","",""; IF ABS(C0)>4 THEN GOSUB 6500
2890 GOTO 2020
2900 REM "Top-bottom
2905 IF POS(B$(1,1)="MS")<>0 THEN GOTO 2020
2909 IF D5$="*" THEN D5$=""; ON C0 GOTO 2910,2911
2910 IF POS(B$(1,1)="IC")=0 THEN CALL "ZZENTR","S",B{ALL},B$,X4$,X3$,25,8,101,8,C0,"","{3"+X$,"","AR2EAM07","","",""; IF ABS(C0)>4 THEN GOSUB 6500
2940 GOTO 2020
2950 REM "# of plys
2955 IF POS(B$(1,1)="MS")<>0 THEN GOTO 2020
2959 IF D5$="*" THEN D5$=""; ON C0 GOTO 2960,2961
2960 IF POS(B$(1,1)="IC")=0 THEN CALL "ZZENTR","Z",B{ALL},B$,X4$,X3$,35,8,109,2,C0,"","{3"+X$,"","AR2EAM09","","",""; IF ABS(C0)>4 THEN GOSUB 6500
2970 IF B$(109,2)="00" THEN B$(109,2)=""; PRINT @(35,8),B$(109,2),
2990 GOTO 2020
6500 REM "Re-do screen
6505 D5$="*"; RUN "AR2EAL"
8300 REM 
8310 ON FPT(C0)*10 GOTO 8350,8320,8330,8350
8320 IF V8$="" THEN X0=X0+4; GOTO 8350 ELSE X0=NUM(V8$(POS(STR(X0:"00")<=V8$,2),2)); GOTO 8350
8330 IF V8$="" THEN X0=X0-6; GOTO 8340 ELSE X0=POS(STR(X0-1:"00")<=V8$,2)-2; IF X0<0 THEN X0=0; GOTO 8350 ELSE X0=NUM(V8$(X0,2)); GOTO 8350
8340 IF X0<0 THEN X0=0; GOTO 8350
8350 C0=3; RETURN 
8400 REM "Get price based on location
8401 REM "Assumes E() holds main inv record.
8405 IF POS(B$(1,1)="IC")=0 THEN RETURN 
8410 DIM J[3]
8415 FIND (Z[11],KEY=B$(55,20)+B$(89,4),DOM=8440)IOL=0410
8420 IF J[2]<>0 THEN PRECISION M5[1]; B[3]=J[2]*E[14]/E[15]; PRECISION 2
8422 COST=B[3]; IF SEC$(63,1)<>"Y" THEN GOTO 8425 ELSE COST=0
8425 PRINT @(42,11),COST:M5$,
8440 RETURN 
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6500
9520 ON C9 GOTO 1140,2040
9900 GOTO 1900
9955 REM 
9999 END 
