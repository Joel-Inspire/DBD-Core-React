0010 REM "A/R Invoice Update <AR2DUC>
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 12/05/24 - 14.050558 - crg - SSP# 307483
0036 REM "LINES 2435, 4733 FOR NUMBERING TO FMZ FILE
0037 REM "307483-DBD-457:Support for IMS price in purchase order line        
0040 REM "Copyright 2024 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 REM "Summary Billing & Detail Shipment Reporting
0051 REM "STMT 3352 is enabled for Docutec???
0090 IF %GUI THEN CLEAR ELSE BEGIN 
0100 SETERR 9000
0110 X0$="AR2DUC",X1$="Invoice Update - Phase III"
0185 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
0190 DEF FNC$(C)=CHR(32+INT(C/95))+CHR(32+MOD(C,95))
0195 DEF FND(Z9$)=(ASC(Z9$(1,1))-32)*95+ASC(Z9$(2,1))-32
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0260 DEF FND$(Z9$)=STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
0295 DIM Z0$(80,X3$(235,1)),S$(20); Z0$=MNM('GS')+Z0$+MNM('GE')
0300 REM "IOLISTS
0310 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13],A[14],A[15],A[16],A[17],A[18],A[19],A[20],A[21],A[22],A[23],A[24],A[25],A[26],A[27],A[28],A[29],A[30]
0320 IOLIST B0,B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14],B[15],B[16],B[17],B[18],B[19],B[20],B[21],B[22],B[23],B[24],B[25],B[26],B[27],B[28],B[29],B[30],B[31],B[32],B[33],B[34],B[35],B[36],B[37],B[38],B[39],B[40],B[41],B[42],B[43],B[44],B[45],B[46],B[47],B[48] ! SSP 249775
0330 IOLIST C$
0340 IOLIST D$,D{ALL}
0350 IOLIST E$,E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10],E[11],E[12],E[13],E[14],E[15]
0352 IOLIST E0$,E0[0],E0[1],E0[2],E0[3],E0[4],E0[5],E0[6],E0[7],E0[8],E0[9],E0[10],E0[11],E0[12],E0[13],E0[14],E0[15]
0360 IOLIST F$,F[0],F[1],F[2],F[3]
0370 IOLIST G$
0380 IOLIST H$,H[0],H[1],H[2],H[3],H[4],H[5],H[6],H[7],H[8],H[9],H[10],H[11],H[12],H[13],H[14],H[15],H[16],H[17],H[18],H[19],H[20],H[21],H[22],H[23],H[24],H[25],H[26],H[27],H[28],H[29],H[30]
0390 IOLIST I$,I[0],I[1],I[2],I[3],I[4],I[5]
0400 IOLIST J$,J[0],J[1],J[2],J[3],J[4],J[5],J[6],J[7],J[8],J[9],J[10],J[11],J[12],J[13],J[14],J[15],J[16],J[17]
0402 IOLIST J0$,J0[0],J0[1],J0[2],J0[3],J0[4],J0[5],J0[6],J0[7],J0[8],J0[9],J0[10],J0[11],J0[12]
0410 IOLIST ICF$,ICF[0],ICF[1],ICF[2],ICF[3],ICF[4],ICF[5],ICF[6],ICF[7],ICF[8],ICF[9],ICF[10],ICF[11],ICF[12]; REM SSP 198988
0420 IOLIST L$,L[0],L[1],L[2],L[3],L[4],L[5],L[6],L[7],L[8],L[9],L[10],L[11],L[12],L[13],L[14],L[15],L[16],L[17],L[18],L[19],L[20],L[21],L[22],L[23],L[24],L[25],L[26],L[27],L[28],L[29],L[30],L[31]
0430 IOLIST FM1$,FM1[0],FM1[1],FM1[2],FM1[3],FM1[4],FM1[5],FM1[6],FM1[7],FM1[8],FM1[9],FM1[10],FM1[11],FM1[12],FM1[13],FM1[14],FM1[15],FM1[16],FM1[17],FM1[18],FM1[19],FM1[20],FM1[21],FM1[22],FM1[23],FM1[24],FM1[25],FM1[26],FM1[27],FM1[28],FM1[29],FM1[30],FM1[31]
0435 IOLIST AR1$,AR1{ALL}
0440 IOLIST IC0$,IC0{ALL}
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0509 REM "Slot 11 will be used for temp file!!!!!
0510 Z$="01L ARB...  02O ART...  03O FMP...  04O FS2...  05O FMY...  06O PO3...  07O FS1...  08O IC0...  09L FS3...  10O FMZ...  12O FM1...  14O FM0...  15O ZY1...  20O FTP...  25O ICN...  26O ICF...  27O EDW...  28O AR1...  29O FM3...  30O FSW...  31O FTW...  32O AR2...  "
0515 Z$=Z$+"13O ZZPARM  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 0521,8810
0540 FIND (Z[13],KEY=X3$(9,3)+"I/C")P$
0545 DIM P5$(245); FIND (Z[13],KEY=X3$(9,3)+"FMS")P5$
0550 DIM OPS_PARMS$(512); FIND (Z[13],KEY=X3$(9,3)+"F/M")OPS_PARMS$
0555 FIND (Z[13],KEY="STAT"+"F/M")F9$ ! 242686
0560 FIND (Z[13],KEY="STAT"+"FM0")F10$ ! 242686
0695 PRINT @(29,9),"Invoice      Order    Line"
0700 REM "Create Sort file
0705 K9$="[768]Monthly Shipment Detail Processing" ! SSP#229924
0710 CALL "ZZ2SRT",X3$,X4$,Z[13],Z[2],22,K9$,0,"NN"
0714 IF LEN(K9$)<8 THEN K9$=K9$+" "; GOTO 0714
0715 Z$="11O "+K9$
0720 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 0721,8820
0800 REM "Get audit control number N8$
0805 DIM V0$(30)
0810 EXTRACT (Z[1],KEY="",DOM=0811)V0$
0820 N8$=V0$(22,6)
0830 IF POS(" "<>N8$)=0 THEN N8$=X3$(178,6)
0900 DIM A[30],B[48],D[29],E[15],F[3],H[30],I[5],C$(171) ! 242686  SSP 249775
0999 REM "Update to temporary file (file name returned in K9$) then move to FMY or FMZ in transfer phase
1000 REM "READ NEXT RECORD
1020 READ (Z[1],KEY="",DOM=1021)
1100 K0$=KEY(Z[1],END=5000); READ (Z[1],END=5000)IOL=0310; B0=A[20]
1120 PRINT @(29,10),A$(7,8),"   ",A$(92,8),'CL',
1140 IF X3$(330,1)="1" THEN CALL "CM2AAA",X3$,Z[1],0,K0$,"",0
1220 GOSUB 3000
1300 IF B0>0 THEN READ (Z[2],IND=B0)IOL=0320 ELSE GOTO 1600
1400 GOSUB 2000
1450 IF POS(B$(1,1)="FIC")>0 THEN GOSUB 8100
1500 GOTO 1300
1600 GOSUB 4000
1990 GOTO 1100
2000 REM "Update invoice line to temp File
2005 DIM AR1$(500),AR1[15]; FIND (Z[28],KEY=E$(1,10),DOM=*NEXT)IOL=0435 ! 242686
2010 FIND (Z[3],KEY="D"+E$(1,10),DOM=2011)IOL=0330; REM " SSP# 151339
2012 IF B$(2,1)="Y" THEN RETURN 
2015 IF B$(1,1)="S" THEN T[4,0]=T[4,0]+B[4]
2019 REM "Costed Freight?
2021 IF B$(138,1)="X" THEN GOTO 2026; REM 
2024 IF C$(103,1)="Y" THEN GOTO 2026; REM " SSP# 151339
2025 IF B$(6,1)="N" AND B[1]>=0 AND B[4]=0 THEN RETURN ; REM "Added B[1]>=0 on ssp111609
2030 E$(171,12)=A$(180,6)+A$(1,6); DIM E[15] ! 242686
2035 E$(213,1)=B$(1,1)
2040 E$(73,1)=B$(1,1),E$(74,20)=B$(55,20),E$(94,40)=B$(7,40),E$(134,4)=B$(89,4),E$(138,4)=B$(50,4),E$(142,1)=B$(2,1),E$(143,1)=B$(54,1),E$(144,3)=B$(47,3)
2045 E$(31,1)=B$(136,1); REM " SSP# 151339 - FLAG TO SAY BACK ORDER LINE WAS CREATED TO SYSTEM. USED TO DETERMINE IF LINE SHOULD UPDATE TO FMY
2046 E$(32,1)=B$(138,1); REM SSP 151339 - USED TO DETERMINE IF AUTO REC CHARGE LINES SHOULD UPDATE TO FMY
2049 REM "Check E3 to see if odd pennies left from prorating invoice line to special shipping lines
2050 E$(147,5)="C"+A$(187,4),E[0]=B[6],E[1]=B[1],E[2]=B[2],E[3]=B[4],E3=E[3],E$(22,1)=""; REM "cwj 7/1/98 ssp#100011
2059 REM "Order lines?
2060 IF E$(144,3)<>"   " THEN FIND (Z[4],KEY=E$(49,8)+E$(144,3),DOM=2061)IOL=0340; GOTO 2080
2065 IF LEN(I$)<>0 THEN IF B$(1,1)<>"M" THEN FIND (Z[6],DOM=*NEXT,KEY=I$(9,8)+DIM(5))IOL=0360; E$(147,5)=F$(11,5),E$(204,9)=F$(260,9),E$(335,30)=MID(F$,16,30); REM "SSP# 200418
2070 GOSUB 3600; GOSUB 2400; GOTO 2200 ! SSP 252696
2080 K1$=E$(11,8)+E$(49,8)+E$(144,3)
2085 E$(189,14)=D$(94,10)+D$(90,4)
2089 IF POS(E$(73,1)="ICF")=0 THEN GOTO 2095 ! 242686 - Skip tracking freight if not item line
2090 IF MID(AR1$,494,1)="Y" AND POS(MID(AR1$,497,1)="YW") THEN E$(387,1)=MID(AR1$,497,1); IF E$(387,1)="W" THEN GOTO *NEXT ELSE GOTO 2095 END_IF ELSE E$(387,1)="N"; GOTO 2095 ! 242686 - Track freight for budgets
2091 DIM FM1[31]; FIND (Z[12],DOM=*NEXT,KEY=E$(74,20))IOL=0430; E[14]=FM1[18]; GOTO 2093 ! Unit weight from FM1 rec
2092 DIM IC0[40]; FIND (Z[8],DOM=2094,KEY=E$(74,10))IOL=0440; E[14]=IC0[16]; GOTO 2093 ! if here, no FM1 rec, try unit weight from IC0 rec
2093 IF E[14]<>0 THEN E[15]=E[14]*(E[1]/MAX(E[0],1)); GOTO 2095 ! Weight extension
2094 E$(387,1)="Y" ! If here then track freight enabled, but no weight for item, set flag to default tracking freight by dollar total
2100 REM "Look at FS3 - No reason to go thru Special Ship records since specific ship point stored in ART 3/3/95 AND each special ship line is NOW an invoice line in ART!;!SSP#204517
2110 I$=""; READ (Z[9],KEY=K1$+B$(135,1),DOM=2200)IOL=0390; GOTO 2159
2111 ESCAPE ; REM "Left in for safety check should always be in FS3
2159 REM "Get ship to from PO3
2160 E$(147,5)="C"+A$(187,4); FIND (Z[6],DOM=2161,KEY=I$(9,8)+" "+I$(17,4))IOL=0360; E$(147,5)=F$(11,5),E$(204,9)=F$(260,9),E$(335,30)=MID(F$,16,30); GOTO 2165
2162 FIND (Z[6],DOM=2163,KEY=I$(9,8)+"     ")IOL=0360; E$(147,5)=F$(11,5),E$(204,9)=F$(260,9),E$(335,30)=MID(F$,16,30); REM "ssp#100011 cwj - add to get info for non special ship;!SSP# 200418 
2170 E[1]=I[0],E[2]=I[1],E[3]=I[2],E$(22,1)=I$(20,1)
2175 GOSUB 3600 ! SSP 249775 Get tax from ART
2180 GOSUB 2400
2200 REM "Check for leftover pennies
2210 IF E3<>0 THEN GOSUB 3300
2290 RETURN 
2400 REM "Update TEMP file
2410 IF E$(134,1)="9" AND E$(73,1)="C" THEN GOSUB 3500
2420 T[0,0]=T[0,0]+1
2430 E$(19,3)=STR(T[0,0]:"000")
2435 IF D$>"" THEN E$(153,18)=D$(104,9)+D$(189,9)
2436 IF E$(213,1)="S" THEN IF E$(204,9)=S$(1,9) THEN E$(204,9)=B$(116,9); GOTO 2440
2438 IF D$>"" THEN IF LEN(D$)>205 THEN IF D$(205,9)<>S$(1,9) THEN E$(204,9)=D$(205,9)
2442 WRITE (Z[11],DOM=2420,KEY=E$(1,22))IOL=0350
2450 E3=E3-E[3]
2460 PRINT @(52,10),E$(19,3)," ",E$(22,1),
2490 RETURN 
2740 ICF_K$=J$(1,10)+J$(16,10); IF J[1]<0 THEN GOSUB 8400 ELSE GOSUB 8500; REM " SSP# 157344, 163922 198988 - do gosub whether OPS_PARMS$(306,1)=Y OR NOT
2742 IF ICF_PRICE<>0 THEN J[0]=E0[0],J[1]=E0[1],J[2]=ICF_PRICE; GOTO 2746
2745 J[0]=E0[0],J[1]=E0[1],J[2]=L[29]
2746 ICF_PRICE=0
3000 REM "Fill in Header Info
3019 REM "Carefull - look at 2030
3020 DIM E$(512),E[15],T[8,1],E2$(0),E3$(0); I$="" ! SSP#204517, 242686
3038 REM " T(0,0)=Seq#; T(1,0)=Net Sale+CUST OWNED VALUE; T(2,0)=Freight; T(3,0)=Sales Tax, T(4,0)=Special chgs billed, T(5,0)=Billed total, T(6,0)=State Tax, T(7,0)=County Tax, T(8,0)=Local Tax
3039 REM " T(0,1)=n/a ; T(1,1)=Tax Sale; T(2,1)=ProFrt;  T(3,1)=Pro Tax, T(6,1)=Pro State Tax, T(7,1)=Pro County Tax, T(8,1)=Pro Local Tax
3040 T[1,0]=A[1]-A[17],T[2,0]=A[2]+A[17],T[3,0]=A[4]+A[6]+A[8],T[1,1]=A[3],T[6,0]=A[4],T[7,0]=A[6],T[8,0]=A[8]; IF T[1,1]=0 THEN T[1,1]=A[5]; IF T[1,1]=0 THEN T[1,1]=A[7] ! 190474
3050 T[5,0]=T[5,0]+A[1]-A[17]
3060 K$=A$(15,10)+A$(7,8),E$(1,18)=K$
3080 E$(171,6)=A$(180,6),E$(34,15)=A$(100,15),E$(49,8)=A$(92,8),E$(57,15)=A$(162,15),E$(23,6)=A$(86,6),E$(147,5)="C"+A$(187,4),E$(177,6)=A$(1,6),E$(29,2)=A$(344,2)
3090 FIND (Z[7],KEY=A$(92,8),DOM=3091)IOL=0370; E$(72,1)=G$(47,1),E$(183,6)=G$(16,6); REM "Save order date for use later
3190 RETURN 
3200 REM "Prorate Freight/Tax
3230 PRECISION 6
3240 IF T0<>0 THEN IF E$(213,1)<>"S" THEN E[5]=T[2,0]*(E[3]+E[4])/T0; IF E[5]<>0 THEN E2$=E$(19,4)
3245 IF TRACK_FREIGHT$="W" AND W0<>0 THEN IF E$(213,1)<>"S" THEN E[5]=T[2,0]*(E[15]/W0); IF E[5]<>0 THEN E2$=E$(19,4) ! 242686 
3250 IF T0<>0 THEN IF E$(213,1)<>"S" THEN E[7]=T[4,0]*(E[3]+E[4])/T0
3252 IF T[5,0]<>0 AND POS(E$(143,1)="YC",1)<>0 THEN IF E[6]<>0 THEN E3$=E$(19,4) ! SSP 249775
3260 ! F T[5,0]<>0 AND POS(E$(143,1)="YC",1)<>0 THEN E[6]=T[3,0]*E[3]/T[5,0]; IF E[6]<>0 THEN E3$=E$(19,4) ! SSP#225601
3261 ! F T[5,0]<>0 AND POS(E$(143,1)="YC",1)<>0 THEN E[11]=T[6,0]*E[3]/T[5,0] ! SSP#225601
3262 ! if T[5,0]<>0 AND POS(E$(143,1)="YC",1)<>0 THEN E[12]=T[7,0]*E[3]/T[5,0] ! SSP#225601
3263 ! F T[5,0]<>0 AND POS(E$(143,1)="YC",1)<>0 THEN E[13]=T[8,0]*E[3]/T[5,0] ! SSP#225601
3270 PRECISION 2; E[5]=E[5]+0,E[6]=E[6]+0,E[11]=E[11]+0,E[12]=E[12]+0,E[13]=E[13]+0,E[12]=E[6]-E[11]-E[13] ! use county tax to make tax subtotals always balance to total tax
3280 T[2,1]=T[2,1]+E[5],T[3,1]=T[3,1]+E[6],T[4,1]=T[4,1]+E[7],T[6,1]+=E[11],T[7,1]+=E[12],T[8,1]+=E[13]
3290 RETURN 
3300 REM "Apply pennies to special shipping line
3310 EXTRACT (Z[11],KEY=E$(1,22))IOL=0350
3320 E[3]=E[3]+E3,E$(152,1)="Y"
3330 WRITE (Z[11])IOL=0350
3340 RETURN 
3350 REM "Apply leftover freight
3352 REM IF E2$="" THEN IF E$>"" THEN LET E2$=E$(19,4)
3355 IF T[2,0]=T[2,1] THEN RETURN ELSE IF T[0,0]=0 OR E2$="" THEN GOSUB 3450; E2$=E$(19,4)
3360 EXTRACT (Z[11],KEY=K$+E2$)IOL=0350
3370 E[5]=E[5]+T[2,0]-T[2,1]
3380 WRITE (Z[11])IOL=0350
3390 RETURN 
3400 REM "Apply leftover tax
3405 IF T[3,0]=T[3,1] AND T[6,0]=T[6,1] AND T[7,0]=T[7,1] AND T[8,0]=T[8,1] THEN RETURN ELSE IF T[0,0]=0 OR (E3$="" AND E2$="") THEN GOSUB 3450; E3$=E$(19,4) ELSE IF E3$="" THEN E3$=E2$
3410 EXTRACT (Z[11],KEY=K$+E3$)IOL=0350
3420 E[6]=E[6]+T[3,0]-T[3,1]
3425 E[11]+=T[6,0]-T[6,1],E[12]+=T[7,0]-T[7,1],E[13]+=T[8,0]-T[8,1],E[12]=E[6]-E[11]-E[13] ! always use county tax to make tax subtotals always balance to total tax
3430 WRITE (Z[11])IOL=0350
3440 RETURN 
3450 REM "No invoice lines
3452 SAVE_FRT=T[2,1],SAVE_TAX=T[3,1],SAVE_STAX=T[6,1],SAVE_CTAX=T[7,1],SAVE_LTAX=T[8,1]
3455 GOSUB 3000
3457 T[2,1]=SAVE_FRT,T[3,1]=SAVE_TAX,T[6,1]=SAVE_STAX,T[7,1]=SAVE_CTAX,T[8,1]=SAVE_LTAX
3460 E$(94,40)="*Summary line*"
3470 GOSUB 2400
3490 RETURN 
3500 REM "Get Release Value for customer owned goods
3510 DIM L[31]
3520 FIND (Z[12],DOM=3590,KEY=E$(74,20))IOL=0420
3539 REM "Use item master sell to get value for proration
3540 E[3]=0,E[2]=L[3]
3559 REM "Convert Sell unit price to line U/M
3560 IF L[4]<>0 AND E[0]<>0 THEN E[2]=E[2]*E[0]/L[4]
3570 CALL "FM2EXT",Z[13],0,E$(138,4),E[0],E[1],E[2],E4,0; E[4]=E4
3579 REM "Add to release value for proration
3580 T[1,0]=T[1,0]+E[4]
3590 RETURN 
3600 ! Tax from ART used to update TEMP file (was from 3200 routine)
3620 IF E$(213,1)<>"S" THEN E[7]=B[4] ! Special Charge
3630 IF POS(E$(143,1)="YC",1)<>0 THEN E[6]=B[30] ! Total Tax 
3640 IF POS(E$(143,1)="YC",1)<>0 THEN E[11]=B[25] ! State Tax
3650 IF POS(E$(143,1)="YC",1)<>0 THEN E[12]=B[27] ! County Tax 
3660 IF POS(E$(143,1)="YC",1)<>0 THEN E[13]=B[29] ! Local Tax
3690 RETURN 
3699 ! 
4000 REM "Prorate to Frt/Tax totals to Lines
4005 T0=T[1,0]-T[4,0]
4007 GOSUB 8000 ! 242686 - Determine if freight needs to be tracked, and method of proration to use - N=No tracking, Y=Track by item line dollar value, W=Track by item line weight
4010 READ (Z[11],KEY=K$,DOM=4011)
4020 READ (Z[11],END=4090)IOL=0350
4025 IF K$<>E$(1,LEN(K$)) THEN GOTO 4090
4030 IF E$(142,1)="Y" THEN GOTO 4020
4040 EXTRACT (Z[11],KEY=E$(1,22))IOL=0350
4045 IF E$(73,1)="M" THEN GOTO 4060
4050 GOSUB 3200
4060 E$(142,1)="Y"
4070 WRITE (Z[11])IOL=0350
4080 GOTO 4020
4090 REM "Now apply any leftovers
4100 GOSUB 3350
4120 GOSUB 3400
4140 RETURN 
4500 REM "Transfer records to FMY and FMZ
4502 PRINT @(29,12),"Part 2 of Phase III",
4505 READ (Z[11],KEY="",DOM=4506)
4510 DIM E0$(512),E0[15]; READ (Z[11],END=4595)IOL=0352 ! 242686
4515 PRINT @(29,10),E0$(11,8),"   ",E0$(49,8),@(52,10),E0$(19,3)," ",E0$(22,1),
4520 IF C$(2,10)=E0$(1,10) THEN GOTO 4525 ELSE DIM C$(171); C$(2,10)=E0$(1,10); FIND (Z[3],KEY="D"+E0$(1,10),DOM=4521)IOL=0330
4525 IF C$(49,1)="Y" THEN GOSUB 4600
4528 IF P$(35,1)<>"Y" AND C$(24,1)<>"Y" AND C$(49,1)<>"Y" THEN GOTO 4550
4530 IF MID(E0$,73,1)<>"M" OR POS(X3$(9,3)="099002112",3)>0 THEN GOSUB 4700
4550 GOTO 4510
4595 RETURN 
4600 REM "Transfer to FMY
4605 DIM E$(512),E[15]; REM SSP 182472, 242686
4610 E$(1,191)=E0$; BILL_DEPT$="",REC_DEPT$=""; REM "172722
4612 READ (Z[4],KEY=E0$(49,8)+E0$(144,3),DOM=*NEXT)IOL=0340; E$(386,1)=D$(250,1) ! WO212145, contract price? (DDMS)
4615 E$(183,9)=E0$(204,9)
4616 IF C$(102,1)="Y" AND E$(32,1)="X" THEN GOTO 4620; REM " UPDATE AUTO REC LINES TO FMY
4617 IF C$(102,1)="Y" AND E$(72,1)="W" AND E$(134,1)="9" THEN GOTO 4680; REM " SSP# 151339
4618 IF C$(102,1)="Y" AND E$(31,1)="Y" THEN GOTO 4680; REM " SSP# 151339
4620 FOR I=0 TO 13; E[I]=E0[I]; NEXT I
4624 IF OPS_PARMS$(250,1)<>"Y" THEN GOTO 4636
4625 FM0_KEY$=E$(147,1)+E$(1,10)+E$(148,4),FM4_KEY$=E$(1,10)+E$(84,10)+E$(148,4); IF E$(147,1)="D" THEN COMMAND$="1" ELSE COMMAND$="3"
4630 CALL "FM2DPA",X3$,X4$,COMMAND$,FM0_KEY$,FM4_KEY$,REC_DEPT$,BILL_DEPT$
4631 IF POS(X3$(9,3)="500598101288475497499500522524568589500029",3)>0 OR (MID(OPS_PARMS$,333,1)="Y") THEN IF STP(BILL_DEPT$,3," ")="" THEN DIM FM1$(200),FM1[31]; READ (Z[12],KEY=E$(74,20),DOM=4632)IOL=0430; IF POS(" "<>FM1$(173,12))>0 THEN BILL_DEPT$=FM1$(173,12) ELSE IF POS(X3$(9,3)="101288",3)>0 AND POS(" "<>REC_DEPT$)>0 THEN BILL_DEPT$=REC_DEPT$ ELSE BILL_DEPT$=E$(148,4); REM "SSP102342 & 103092, SSP110785, use rec dept if not blank SSP#202439 SSP 211619!SSP#240316 ! WO247674 jdf SSP307430-DBD-333-DBSPT-149880
4632 IF POS(X3$(9,3)="500598101288475497499500522524568589500029",3)>0 OR (MID(OPS_PARMS$,333,1)="Y") THEN IF STP(BILL_DEPT$,3," ")="" THEN IF POS(X3$(9,3)="101288",3)>0 AND POS(" "<>REC_DEPT$)>0 THEN BILL_DEPT$=REC_DEPT$ ELSE BILL_DEPT$=E$(148,4); REM "SSP104533, if it's a special charge, SSP110785, use rec dept if not blank SSP#202439 SSP 211619!SSP#240316 ! WO247674 jdf SSP307430-DBD-333-DBSPT-149880
4635 E$(226,20)=REC_DEPT$,E$(246,20)=BILL_DEPT$
4637 REM IF MID(OPS_PARMS$,306,1)<>"Y" THEN GOTO 4648
4638 IF OPS_PARMS$(341,1)="Y" AND E$(72,1)=DIM(1) AND E$(134,4)<>DIM(4) AND E$(134,4)<>"DS  " THEN IF POS(OPS_PARMS$(342,1)="RW")>0 AND E$(134,1)="9" THEN E$(72,1)=OPS_PARMS$(342,1) ELSE IF POS(OPS_PARMS$(343,1)="RW")>0 AND E$(134,1)<"9" THEN E$(72,1)=OPS_PARMS$(343,1) ! WO291586, if activated and blank order type (sales order) and ship from is not blank or direct ship then if customer owned and R or W set then change ord type else if distributor owned and R or W set then change order type
4640 ICF_K$=A$(15,10)+E$(84,10); IF E[1]<0 THEN GOSUB 8400 ELSE GOSUB 8500; REM " SSP# 157344, 163922 198988 - DO GOSUB WHETHER OPS_PARMS$(306,1)= Y OR NOT
4645 IF ICF_PRICE<>0 THEN E[8]=ICF_PRICE ELSE IF D[27]<>0 THEN E[8]=D[27] ELSE E[8]=FM1[29]; REM " SSP 163922; 307483
4646 E$(385,1)=CUST_PO_TP$; CUST_PO_TP$="" REM SSP 198988
4647 IF E[8]=0 THEN E[9]=0 ELSE CALL "FM2EXT",Z[13],0,E0$(138,4),E0[0],E0[1],E[8],E9,0; E[9]=E9; REM " SSP 163922
4648 GOSUB 4800; REM "SSP 182472
4649 IF POS(X3$(9,3)="566",3)<>0 AND E$(29,1)="N" THEN GOTO 4680
4650 WRITE (Z[5],KEY=E$(1,22),DOM=4655)IOL=0350; GOTO 4680
4655 IF E$(19,3)="999" THEN ESCAPE ELSE E$(19,3)=STR(NUM(E$(19,3))+1:"000")
4660 GOTO 4650
4661 ICF_PRICE=0; CUST_PO_TP$=""; REM SSP 198988
4695 RETURN 
4700 REM "Transfer to FMZ
4702 FIND (Z[7],KEY=E0$(49,8),DOM=*NEXT)FS1$; REM "Save order date for use later
4705 DIM J$(625),J[17]
4710 DIM L$(300),L[31]; L[4]=1; FIND (Z[12],KEY=MID(E0$,1,10)+MID(E0$,84,10),DOM=4711)IOL=0420
4714 REM "Key part
4715 J$(1)=E0$(1,10)+E0$(147,1)+E0$(148,4)+E0$(84,10)+E0$(171,6)+"001"
4720 IF E0$(134,4)="DS  " OR POS(" "<>E0$(134,4))=0 THEN J$(35,1)="D" ELSE J$(35,1)="I"
4723 J$(36,10)=E0$(74,10)
4725 J$(46)=E0$(94,40)+L$(167,6)
4726 IF E0$(134,4)="DS  " OR POS(" "<>E0$(134,4))=0 THEN J$(92,5)="" ELSE J$(92,5)="D"+E0$(134,4)
4727 J$(97,15)=E0$(57,15),J$(335,9)=E0$(204,9)
4728 IF MID(FS1$,89,4)<>DIM(4) THEN J$(405,4)=MID(FS1$,89,4); REM " CSR SSP 158518.  Corrected on SSP170886, was using G$ instead of FS1$
4729 IF MID(FS1$,250,15)<>DIM(15) THEN J$(409,15)=MID(FS1$,250,15); REM " BUYER SSP.  Corrected on SSP170886, was using G$ instead of FS1$
4730 J$(112,39)=E0$(72,1)+E0$(49,8)+" "+E0$(34,15)+"SJ"+N8$+E0$(183,6)
4731 J$(425,20)=MID(FS1$,129,20); REM E0$(314,20); REM SSP# 189628 - Ordered By from FS1
4732 REM LET J$(166)=E0$(189,14)
4733 J$(198,18)=E0$(153,18)
4734 REM "Bytes 180-215
4735 J$(180,36)=E0$(138,4)+E0$(152,1)+E0$(11,7)+E0$(23,6)+E0$(153,18)
4736 IF POS(X3$(9,3)="027",3)>0 THEN GOSUB 7500
4737 IF OPS_PARMS$(341,1)="Y" THEN IF J$(112,1)=DIM(1) THEN IF J$(92,1)="D" THEN IF POS(OPS_PARMS$(342,1)="RW")>0 AND J$(93,1)="9" THEN J$(112,1)=OPS_PARMS$(342,1) ELSE IF POS(OPS_PARMS$(343,1)="RW")>0 AND J$(93,1)<"9" THEN J$(112,1)=OPS_PARMS$(343,1) ! WO291586, if activated and order type is blank (sales order) and this record has a D from location and for customer owned (9) and that parm set to R or W change order type, or distributor owned (<9) and that parm set to R or W change order type
4740 REM "fill in order line#, read line to get Lot? info
4741 J$(151,3)=E0$(144,3)
4742 READ (Z[4],KEY=E0$(49,8)+E0$(144,3),DOM=4743)IOL=0340; J$(154,1)=D$(2,1),J$(446,1)=D$(250,1) ! WO212145, contract price? (DDMS)
4743 REM "J(0)=QTY PER UNIT, J(1)=QTY SHIPPED (EACHES)
4744 REM "J(2)=FMS UNIT PRICE, 3=FMS VALUE, 4=UNIT PRICE  5=EXT VALUE, 6=AMT BILLED
4745 REM "IF MID(OPS_PARMS$,306,1)="Y" THEN ICF_K$=J$(1,10)+J$(16,10); GOSUB 8400; REM " SSP# 163922
4746 IF ICF_PRICE<>0 THEN J[2]=ICF_PRICE ELSE IF D[27]<>0 THEN J[2]=D[27] ELSE J[2]=L[29] ! 307483
4747 J[0]=E0[0],J[1]=E0[1],J[4]=E0[2]; REM "J[2]=L[29]
4748 IF L[4]<>0 THEN IF L[4]<>E[0] THEN J[2]=J[2]*E[0]/L[4]
4749 REM "If the item qty/unit differs from line qty per unit, re-do FMS unit price
4750 REM "Calculate FMS value for line
4751 IF J[2]=0 THEN J[3]=0 ELSE CALL "FM2EXT",Z[13],0,E0$(138,4),E0[0],E0[1],J[2],E9,0; J[3]=E9
4754 REM "Calculate extended value for line
4755 IF J[4]=0 THEN J[5]=0 ELSE CALL "FM2EXT",Z[13],0,E0$(138,4),E0[0],E0[1],J[4],E9,0; J[5]=E9
4756 IF P5$(27,1)="Y" AND E0$(73,1)="S" THEN J[2]=E0[2],J[3]=E0[3]; REM WO# 136784 FMS PRICE TO EQUAL SELL VALUE ON SPECIAL CHARGES
4759 REM "Set pro-rated fields to line totals
4760 J[6]=E0[3],J[7]=E0[5],J[8]=E0[6],J[10]=E0[2],J[15]=E0[11],J[16]=E0[12],J[17]=E0[13]
4765 J[9]=E0[7]
4769 IF OPS_PARMS$(250,1)<>"Y" THEN GOTO 4775
4770 FM0_KEY$=J$(11,1)+J$(1,10)+J$(12,4),FM4_KEY$=J$(1,10)+J$(16,10)+J$(12,4),BILL_DEPT$="",REC_DEPT$=""; IF J$(11,1)="D" THEN COMMAND$="1" ELSE COMMAND$="3"; REM "172722
4771 CALL "FM2DPA",X3$,X4$,COMMAND$,FM0_KEY$,FM4_KEY$,REC_DEPT$,BILL_DEPT$
4772 IF POS(X3$(9,3)="500598101288475497499500522524568589500029",3)>0 OR (MID(OPS_PARMS$,333,1)="Y") THEN IF STP(BILL_DEPT$,3," ")="" THEN DIM FM1$(200),FM1[31]; READ (Z[12],KEY=J$(36,10)+J$(16,10),DOM=4773)IOL=0430; IF POS(" "<>FM1$(173,12))>0 THEN BILL_DEPT$=FM1$(173,12) ELSE IF POS(X3$(9,3)="101288",3)>0 AND POS(" "<>REC_DEPT$)>0 THEN BILL_DEPT$=REC_DEPT$ ELSE BILL_DEPT$=J$(12,4); REM "SSP102342 &103092, SSP110785, use rec dept if not blank SSP#202439 SSP 211619!SSP#240316 ! SSP247674 jdf SSP307430-DBD-333-DBSPT-149880
4773 IF POS(X3$(9,3)="500598101288475497499500522524568500029",3)>0 OR (MID(OPS_PARMS$,333,1)="Y") THEN IF STP(BILL_DEPT$,3," ")="" THEN IF POS(X3$(9,3)="101288",3)>0 AND POS(" "<>REC_DEPT$)>0 THEN BILL_DEPT$=REC_DEPT$ ELSE BILL_DEPT$=J$(12,4); REM "SSP104533, if line is a special charge SSP 211619 !SSP#240316 ! WO247674 jdf SSP307430-DBD-333-DBSPT-149880
4774 J$(365,20)=REC_DEPT$,J$(385,20)=BILL_DEPT$; IF OPS_PARMS$(284,1)="Y" AND FM0_KEY$(1,1)="C" THEN GOSUB 7600
4775 F0$="ICF"; IF J[1]<0 THEN F0$="ICN"
4778 IF J[1]<0 THEN J0=-1 ELSE J0=1
4779 IF POS(E0$(73,1)="IFC")=0 THEN J$(35,1)="S",J[5]=J[6]; GOTO 4785
4780 Q$=E0$(49,8)+E0$(144,3); IF J$(154,1)="Y" THEN CALL "IC2LUA",X3$,X4$,0,F0$+"",0,0,J$,C$,P5$,"",J{ALL},Q$,J0; GOTO 4790
4785 WRITE (Z[10],KEY=J$(1,34),DOM=4786)IOL=0400; GOTO 4790
4786 IF NUM(J$(32,3))<999 THEN J$(32,3)=STR(NUM(J$(32,3))+1:"000"); GOTO 4785 ELSE ESCAPE ; GOTO 4785
4790 WRITE (Z[20],KEY=J$(1,10)+J$(16,10)+J$(11,5)+J$(26,9),DOM=4791); REM SSP# 142993
4792 GOSUB 7900 ! Record freight for budget purposes
4795 RETURN 
4800 REM " Populate additional fields for FMY file ssp 182472,#ssp 189099 reworked 4800-4899 moved lines added logic
4810 FIND (Z[7],KEY=E$(49,8),DOM=*NEXT)FS1$; REM "ssp# 189099
4815 DIM ARB$(689); FIND (Z(1),KEY=E$(177,6)+E$(11,8),DOM=*NEXT)ARB$
4850 E$(296,16)=MID(ARB$,251,16); REM CITY 
4855 E$(312,2)=MID(ARB$,267,2); REM " STATE
4860 E$(335,30)=MID(E0$,335,30); REM ATTN FROM PO3
4865 E$(314,20)=MID(FS1$,129,20); REM ORDERED BY FROM FS1
4870 EDW$=""; READ (Z[27],KEY=E$(49,8)+E$(144,3),DOM=*NEXT)EDW$; GOTO 4880
4875 E$(365,20)="DIDN'T FIND RC"; GOTO 4899
4880 E$(365,20)=MID(EDW$,12,20); REM " RC #
4899 RETURN 
5000 REM "EOF
5010 GOSUB 4500
5020 GOTO 9900
7500 REM "GET ATTN FOR COMMENT
7520 READ (Z[6],KEY=E0$(49,8)+"     ",DOM=7580)IOL=0360
7525 IF POS(" "<>J$(276,40))=0 THEN J$(276,40)=F$(16,30)
7590 RETURN 
7600 REM "Get Billing Dept from Zip Code file based upon Ship-To
7610 READ (Z[14],KEY=FM0_KEY$,DOM=7690)FM0_DATA$
7620 READ (Z[15],KEY=FM0_DATA$(129,9),DOM=7690)ZY1_DATA$
7630 BILL_DEPT$=ZY1_DATA$(28,12),J$(385,20)=BILL_DEPT$
7690 RETURN 
7900 REM "242686 - Update the prorated freight to FM3 and FTW for budget purposes
7910 DIM AR1$(500),AR1[15]; FIND (Z[28],KEY=E0$(1,10),DOM=*RETURN)IOL=0435 ! 242686
7915 IF MID(AR1$,494,1)="Y" AND POS(MID(AR1$,497,1)="YW") THEN GOTO *NEXT ELSE GOTO *RETURN
7916 IF MID(AR1$,503,1)="Y" THEN DIM ARB$(689); FIND (Z[1],KEY=E0$(177,6)+E0$(11,8))ARB$; DIM AR2$(100); FIND (Z[32],KEY=ARB$(65,2),DOM=*NEXT)AR2$; IF AR2$(57,1)<>"Y" THEN GOTO *NEXT ELSE GOTO *RETURN ! 253245 - If Budget-Ignore CC Terms parameter enabled, and current invoice terms is credit card terms, then skip update
7920 IF POS(E0$(73,1)="ICF")=0 OR E0$(147,1)<>"C" THEN GOTO *RETURN
7925 U1=E0[5]
7930 Z9$=E0$(1,10)+E0$(84,10)+E0$(148,4)
7940 Z10$=E0$(1,10)+E0$(148,4)
7950 IF NOT(NUL(E0$(171,6))) THEN Z7$=E0$(171,6),Z8$=E0$(171,6) ELSE Z7$=E0$(23,6),Z8$=E0$(23,6) ! Use ship date if not nul, otherwise invoice date, for updating freight stats
7960 CALL "FM2UFT",X3$,F10$,Z[3],"E"+E0$(1,10),Z[31],Z10$,Z7$,Z8$,"F",U1,0,0,0
7970 CALL "FM2UBB",X3$,F9$,Z[3],"E"+E0$(1,10),Z[29],Z[30],Z9$,Z7$,Z8$,"F",U1,0,0,1 ! Record item value to FM3 and FSW files, no proration for remianing period
7995 RETURN 
7999 ! 
8000 REM "Freight tracking for budgets - prorate Frt by Lines value or weight?
8005 TRACK_FREIGHT$="",W0=0
8010 READ (Z[11],KEY=K$,DOM=*NEXT)
8020 READ (Z[11],END=8090)IOL=0350
8025 IF K$<>E$(1,LEN(K$)) THEN GOTO 8090
8030 IF POS(E$(73,1)="ICF")=0 THEN GOTO 8020
8035 W0+=E[15] ! Add up weight extensions for all lines
8037 IF NUL(TRACK_FREIGHT$) THEN TRACK_FREIGHT$=E$(387,1)
8040 IF E$(387,1)="N" THEN TRACK_FREIGHT$="N"; GOTO 8090 ! If at least one line is "N" then no tracking!
8050 IF E$(387,1)="Y" AND TRACK_FREIGHT$<>"Y" THEN TRACK_FREIGHT$="Y"; GOTO 8020 ! If at least one line is a "Y" then always track by dollar value
8060 IF E$(387,1)="W" AND TRACK_FREIGHT$<>"W" THEN TRACK_FREIGHT$="Y" ELSE TRACK_FREIGHT$="W" END_IF ; GOTO 8020 ! To track by line weight, all lines must have weights available
8080 GOTO 8020
8095 RETURN 
8099 ! 
8100 REM "Move O/E Lotted Returns from ICN to ICF
8110 Z$="07C FS1...  08C IC0...  07OSICN...  08OSICF...  "
8115 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 8116,8810
8116 GOSUB SET_READONLY ! SSP#301715
8117 READ (Z[7],KEY="",DOM=*NEXT) ! SSP#301715
8120 K5$=KEY(Z[7],END=8180); DIM J0[12]; READ (Z[7],KEY=K5$)IOL=0402; REM "Changed to read instead of read record 4/29/98 cwj - SSP# 097975 !SSP#301715
8122 IF A$(92,8)+B$(47,3)=J0$(110,11) THEN GOTO 8123 ELSE GOTO 8120; REM "ssp102668 changed to match with ARB & ART 10/7/98 cwj
8123 FIND (Z[14],KEY="D"+DIM(10)+J0$(21,4),DOM=8124)WAREHOUSE$
8124 IF STP(MID(WAREHOUSE$,596,5),3," ")<>"" AND STP(MID(J0$,245,5),3," ")="" THEN J0$(245,5)=WAREHOUSE$(596,5)
8125 J0$(31,2)="00",J0$(110,11)=""
8135 WRITE (Z[8],KEY=J0$(1,32),DOM=8136)IOL=0402; GOTO 8140
8136 KEY$=J0$(1,32); CALL "IC2LCC",X3$,X4$,Z[8],31,2,LAST_ONE$,KEY$; J0$(1,32)=KEY$; GOTO 8135
8137 J0$(31,2)=FNC$(FND(J0$(31,2))+1); GOTO 8135
8145 GOTO 8120
8180 GOSUB CLEAR_READONLY ! SSP#301715
8190 Z$="07C ICN...  08C ICF...  07O FS1...  08O IC0...  "
8191 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 8192,8810
8195 RETURN 
8400 REM " SEARCH FOR PRICE IN LOT RECORD - ICN
8402 ICF_PRICE=0
8403 DIM FM1[31]; FIND (Z[12],DOM=*NEXT,KEY=E$(74,20))IOL=0430
8405 DIM ICF$(269),ICF[12]; REM SSP 198988
8407 REM "ICF_K$=J$(1,10)+J$(16,10);REM " SSP 163922
8409 GOSUB SET_READONLY ! SSP#301715
8410 READ (Z[25],KEY=ICF_K$,DOM=8411)
8411 ICF_KEY$=KEY(Z[25],END=8480) ! SSP#301715
8412 IF ICF_KEY$(1,20)<>ICF_K$(1,20) THEN GOTO 8480 ! SSP#301715
8415 DIM ICF$(269),ICF[12]; READ (Z[25],END=8435)IOL=0410; REM SSP 198988
8420 REM IF ICF$(1,LEN(ICF_K$))<>ICF_K$ THEN GOTO 8480 !SSP#301715
8421 IF ICF$(110,11)<>E$(49,8)+E0$(19,3) THEN GOTO 8411; REM " SSP 163922
8425 IF MID(OPS_PARMS$,306,1)="Y" AND ICF[9]=0 THEN GOTO 8411
8450 IF MID(OPS_PARMS$,306,1)="Y" THEN ICF_PRICE=ICF[9] ELSE ICF_PRICE=0; REM SSP 198988
8460 REM "ICF_PRICE=FM1[29]
8470 IF ICF[10]=1 THEN CUST_PO_TP$="Y" ELSE CUST_PO_TP$="N"; REM SSP 198988
8480 GOSUB CLEAR_READONLY ! SSP#301715
8499 RETURN 
8500 REM " SEARCH FOR PRICE IN LOT RECORD   - ICF                            
8502 ICF_PRICE=0
8503 DIM FM1[31]; FIND (Z[12],DOM=*NEXT,KEY=E$(74,20))IOL=0430
8505 DIM ICF$(269),ICF[12]
8507 REM "ICF_K$=J$(1,10)+J$(16,10);REM " SSP 163922                         
8510 READ (Z[26],KEY=ICF_K$,DOM=8511)
8511 ICF_KEY$=KEY(Z[26],END=8599)
8512 IF ICF_KEY$(1,20)<>ICF_K$(1,20) THEN GOTO 8599
8515 DIM ICF$(269),ICF[12]; READ (Z[26],KEY=ICF_KEY$,END=8535)IOL=0410; REM SSP 198988
8520 REM IF ICF$(1,LEN(ICF_K$))<>ICF_K$ THEN GOTO 8599
8521 IF ICF$(110,11)<>E$(49,8)+E0$(19,3) THEN GOTO 8511; REM " SSP 163922    
8525 IF MID(OPS_PARMS$,306,1)="Y" AND ICF[9]=0 THEN GOTO 8511
8550 IF MID(OPS_PARMS$,306,1)="Y" THEN ICF_PRICE=ICF[9] ELSE ICF_PRICE=0; REM SSP 198988
8560 REM "ICF_PRICE=FM1[29]                                                  
8570 IF ICF[10]=1 THEN CUST_PO_TP$="Y" ELSE CUST_PO_TP$="N"; REM SSP 198988
8599 RETURN 
8800 REM "Problem in ZZFILES
8810 GOSUB 8850; GOTO 0520
8820 GOSUB 8850; GOTO 0720
8850 REM 
8860 X$="Update "+PGN+" in progress, you may not exit. Contact SW Support for assistance"
8870 CALL "ZZPROM",".4",X3$,0,X$,"","",0
8890 RETURN 
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,1
9050 ON Y7 GOTO 9060,9100,9190,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9190 GOSUB 6600; GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9800 REM 
9830 Y4$="ZMENU"
9900 REM "END PROGRAM
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 0000
9950 IF NOT(NUL(Y4$)) THEN IF %GUI THEN IF Y4$<>"ZMENU" THEN CALL Y4$ ELSE EXIT ELSE RUN Y4$
9960 RUN "AR2DUD"
9999 END 
10000 ! SSP#301715 set read only
10010 SET_READONLY:
10020 SET_PARAM 'XI'
10030 SET_READONLY_END:RETURN 
10035 ! SSP#301715 Clear read only     
10040 CLEAR_READONLY:
10050 SET_PARAM -'XI'
10060 CLEAR_READONLY_END:RETURN 
56000 ! Changes since 03/01/2006
56005 REM "190474-Additional Services - Enhance TF to provide for tax codes   
56006 REM 198988-Manage Customer Supplied Inventory. Item Setup, Purch ord
56007 REM "202439-They need to have the same custom change for the function   
56008 REM "204517-Correct ship to is not getting pulled when item hits the    
56009 REM "211619-Needs documentation on using the function field as billing  
56010 REM "212145-Modify DDMS interface programs to recognize contract number
56011 REM "229924-PE 001 in AR2DUC writing to the temp file, expand bytes     
56012 REM "240316-Needs a field to store a "cost center" at the item level,   
56013 REM "247674-Need to use program logic to make function field write to   
56014 REM "242686-Custom project using the EC Budget module.                  
56015 REM "249775-Changes to sales tax parameters and tax calculations to     
56016 REM "253245-EC Budgets : Ability to ignore credit card terms in budget  
56017 REM "252696-When creating direct entry AR invoice.  System is not       
56018 REM "291586-OP System Parms; Change order type for release lines in SJ  
56019 REM "301715-SJ update - file in use message caused when another operator is in ICN
56020 REM "307430-DBD-333;Add 101 to some of 288's company specfic code       
56021 REM "307483-DBD-457:Support for IMS price in purchase order line        
