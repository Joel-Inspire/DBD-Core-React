0010 REM "Print Summary Bill Invoice <AR2REY> Bank/Biz
0035 REM "3.6 - 10/27/92 - 19.38
0040 REM "Copyright 1992 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
1010 REM "C0$ IS Company Name/Address string, C$ =Customer Name/Address
1011 REM "C2$=Invoice No.
1012 REM "C0=Freight, C1=Sales tax, C2=Net Amount (extension)
1020 ENTER X3$,X4$,W9$,W,W9,W0,W2,C0$,C$,C2$,C3$,C4$,C5$,C0,C1,C2,A$,A4{ALL}
1200 REM 
1210 W3=132
1220 DIM Y5$(W3),S$(20),T1$(W3,"-")
1230 W4=INT(W3/2)
1240 M0$="###,###.00-"
1250 T0=C0+C1+C2
1280 W8=.1
1900 REM "
2000 REM "Distributor Header
2010 X1$=FNS$(C0$(7,40))
2012 W0$=FNS$(C0$(47,40)),W1$=FNS$(C0$(87,40))
2014 W2$=FNS$(C0$(127,40))
2015 IF W2$>"" THEN W0$=W0$+"; "+W1$,W1$=""
2040 GOSUB 6000
2060 FOR X=0 TO 2; GOSUB 7300
2470 Y5$(80)="I N V O I C E"
2480 GOSUB 7300
2500 REM "CUSTOMER / INVOICE HEADING
2540 GOSUB 7300
2550 REM "
2560 Y5$(1)=C$(11,35)
2565 Y5$(76)="Invoice no:     "+C2$
2580 GOSUB 7300
2600 REM 
2620 Y5$(1)=C$(86,30)
2640 GOSUB 7300
2650 REM 
2660 Y5$(1)=C$(56,30)
2665 Y5$(74)="Invoice date:  "+FND$(X3$(21,6))
2670 GOSUB 7300
2700 REM 
2705 X$=FNS$(C$(116,16))+", "+C$(132,2)+"   "+C$(134,5); IF C$(139,4)<>"    " THEN X$=X$+"-"+C$(139,4)
2710 Y5$(1)=X$
2765 IF A$<>"*" THEN Y5$(50)="Total amount: $"+STR(T0:M0$)
2770 GOSUB 7300
2775 Y5$(75)="P/O Number: "+C4$; GOSUB 7300; GOSUB 7300
2800 REM 
2810 Y5$(1)="Rep: "+C5$
2840 Y5$(75)="Customer no: "+C$(1,2)+"-"+C$(3,8)
2850 GOSUB 7300
3000 REM "DETAIL
3010 FOR X=0 TO 1; GOSUB 7300
3020 Y5$(1)=T1$; GOSUB 7300; GOSUB 7300
3025 IF A$="*" THEN GOTO 3100
3030 FOR X=0 TO 2
3035 Y5$(1)=C3$(82+X*70,70); GOSUB 7300
3040 NEXT X
3500 REM "DETAIL TOTALS?
3590 GOTO 5000
4500 REM "Region Subtotal
4502 GOSUB 7300; Y5$(1)=T1$; GOSUB 7300
4503 GOSUB 6100
4505 GOSUB 7300; Y5$(80)="** Region Summary **"; GOSUB 7300
4510 GOSUB 7300; Y5$(45)="Region"; GOSUB 7300
4530 FOR X=0 TO 9
4535 A4[X,3]=A4[X,0]+A4[X,1]+A4[X,2]
4540 IF A4[X,3]=0 THEN GOTO 4570
4542 Y5$(48)=STR(X:"0")
4545 Y5$(92)=STR(A4[X,0]:Z3$),Y5$(104)=STR(A4[X,1]:Z4$),Y5$(113)=STR(A4[X,2]:Z4$),Y5$(123)=STR(A4[X,3]:Z4$)
4550 GOSUB 7300
4570 NEXT X
4575 Y5$(123)=STR(T0:Z4$); GOSUB 7300
4590 RETURN 
5000 REM "END
5020 IF A$<>"*" THEN W=999
5090 GOTO 9900
6000 REM "Page header
6030 W8$="S"
6040 CALL "ZZHEAD",X0$,X1$,X2$,X3$,W0$,W1$,W2$,W9$,W3,W,W9,W8,W0,W5,W2,W8$,W5$; IF T0$="END" THEN GOTO 6060 ELSE ON W5 GOTO 6041,9910
6045 ON W5 GOTO 6046,9900
6070 GOSUB 7300
6090 RETURN 
6100 REM "
6102 Y5$(81)="Unit",Y5$(106)="Freight",Y5$(116)="Sales"; GOSUB 7300
6105 Y5$(3)="TLR#",Y5$(13)="Quantity",Y5$(25)="Item No.",Y5$(36)="Description",Y5$(81)="Price",Y5$(96)="Amount",Y5$(117)="Tax",Y5$(125)="Total"
6190 RETURN 
7300 REM "Output line Y5$ to output device
7310 IF POS("V"=W8$)>0 THEN CALL "ZZVIEW",X3$,0,0,W3,W9,W,W9$,Y5$; GOTO 7390
7320 W=W+1; IF POS(" "<>Y5$)=0 THEN PRINT (W9)"" ELSE PRINT (W9)Y5$; Y5$(1)=""
7330 REM 
7390 IF W>=W0 THEN GOSUB 6000
7395 RETURN 
8910 DEF FNP(Z$)=INT(W3/2-LEN(Z$)/2)
8915 DEF FNS$(X$)=X$(1,POS(S$=X$+S$)-1)
8940 DEF FND$(Z9$)=Z9$(3,2)+"/"+Z9$(5,2)+"/"+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
9000 REM "ERROR PROCESSING
9040 EXIT ERR
9940 EXIT 
9999 END 
