0010 REM "FIX O/E LINES AFTER VENDOR/PLANT CHANGE ON A P/O <PO2MAO>
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 08/07/09 - 14.871388 - jvv - SSP# 225300
0037 REM "225300-Orders with more than one salesrep, calculate commssions for
0040 REM "Copyright 2009 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 SETERR 9000
0120 DIM L[29],O[7]
0200 REM "
0310 IOLIST L$,L[0],L[1],L[2],L[3],L[4],L[5],L[6],L[7],L[8],L[9],L[10],L[11],L[12],L[13],L[14],L[15],L[16],L[17],L[18],L[19],L[20],L[21],L[22],L[23],L[24],L[25],L[26],L[27],L[28],L[29]
0311 IOLIST L$,L[0],STR(L[1]),L[2],L[3],STR(L[4]),L[5],L[6],L[7],L[8],L[9],L[10],L[11],L[12],L[13],L[14],STR(L[15]),L[16],L[17],STR(L[18]),L[19],L[20],L[21],STR(L[22]),L[23],L[24],L[25],L[26],L[27],L[28],L[29]
0320 IOLIST O$,O[0],O[1],O[2],O[3],O[4],O[5],O[6],O[7]
0700 REM "Get order 
0710 READ (Z[11],KEY=Q3$(1,8),DOM=2000)IOL=0320
0900 REM "Q3$(1,8) is the order number to search for lines on
0902 REM "Q3$(9,1) is the p/o code each line must match
0904 REM "Q3$(10,10) is the new vendor number to go on the line
0906 REM "Q3$(20,4) is the new plant code to go on the line
1000 REM "Search for lines that match Q3$ P/O
1005 PRINT @(0,21),'CL',@(24,21),"Updating order line information",
1010 READ (Z[10],KEY=Q3$(1,8),DOM=1011)
1020 K$=KEY(Z[10],END=2000); READ (Z[10])
1025 IF K$(1,8)<>Q3$(1,8) THEN GOTO 2000
1030 EXTRACT (Z[10],KEY=K$,DOM=1020)IOL=0310
1035 IF L$(9,1)<>Q3$(9,1) THEN READ (Z[10]); GOTO 1020
1050 L$(94,10)=Q3$(10,10),L$(90,4)=Q3$(20,4)
1052 IF STP(AR1_PARMS$(75,1),2)="" OR AR1_PARMS$(76,1)="Y" THEN GOTO 1060 ! SSP 217566, SSP 222237
1055 CC3$=""; CALL "AR2COM","VENDCOM",CC3$,A{ALL},0,0,0,L$; COMM_CODE$=CC3$ ! SSP 217566 SSP 225300
1056 IF %MSLC THEN CC3$="",CMKEY$="O"+F$(147,8)+A$(179,10)+F$(6,3); CALL "AR2MCM","VENDCOM",CC3$,A{ALL},0,0,0,CMKEY$,0,L$ ! SSP 217566 SSP 225300
1058 L$(128,5)=COMM_CODE$ ! ssp 217566
1060 WRITE (Z[10],KEY=K$)IOL=0311
1080 GOTO 1020
2000 REM "END
2005 PRINT @(0,21),'CL'
2010 GOTO 9900
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,"PO2MAO",Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9900 REM "END PROGRAM
9910 L0=1
9920 RUN "PO2MAA"
9999 END 
56002 REM "217566-Commission substitution by vendor to allow house charges
56003 REM "222237-Modification to charge house charges by vendor.             
