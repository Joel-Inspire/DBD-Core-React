0010 REM "Format Driven Purchase Order Printing <PO2PAR>
0035 REM "5.5 - 09/25/07 - 21.200277 - jme - SSP# 212097
0037 REM "212097-TOD Purchase Order Printing
0040 REM "Copyright 2007 TopForm Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0045 IF UID="jvv" THEN ESCAPE 
0050 SETERR 0060; ENTER Q0$; CALLED$="Y"; GOTO 0091; REM "Called from PO2PAY, WO131248
0080 REM 
0085 IF J9=-99 THEN J9=0; SETERR 9000; GOTO 0650
0087 IF %GUI THEN GOTO 0091
0090 BEGIN 
0091 SETERR 9000
0095 PRECISION 14; T2=TIM; PRECISION 2
0105 SETERR 9000; SETESC 9300
0110 X0$="PO2PAR",X1$="TOD Purchase Order Printing"
0120 DIM A$(0),B$(82),B[27],C$(350),L$(21),L[1],H$(315),H0$(315),D6$(402),B0$(204),B0[21],Z8$(20),B1$(356),B1[29]
0140 M0$="######.00-",M1$="#####,###.00-",M2$="##,###,##0-",M3$="###,##0-",M4$="-00000000.00",M4=LEN(M4$),M6$="###.0-",M5$=M0$(1,LEN(M0$)-1)+"#"
0165 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
0180 DEF FNS$(Z9$)=Z9$(1,POS(Z8$=Z9$+Z8$)-1)
0185 DEF FNR$(Z9$)=Z9$(POS(" "<>Z9$))
0190 DEF FNT$(Z9$)=Z9$(1,POS(Z8$=Z9$+Z8$))
0210 T=1,T0=1,T1=1
0220 W3=120
0230 DIM T3$(50,"*"),Y5$(131),Y6$(131),W[4],E[3]
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,"",-1,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0260 ! CALL "ZZRPTP",X3$,X0$,X1$,V9$,V0,Q0$,Q1$,Q2$,Q3$,Q4$,Q5$,Q6$
0300 REM "I/O lists
0305 REM "IOLIST FOR PO1 - Purchase order header
0310 IOLIST A$(1)
0315 REM "IOLIST FOR PO2 - Purchase order lines
0320 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14],B[15],B[16],B[17],B[18],B[19],B[20],B[21],B[22],B[23],B[24],B[25],B[26],B[27]
0325 REM "IOLIST FOR FS1 - Sales order Header
0330 IOLIST C$(1),DEP_AMT
0335 REM "IOLIST FOR AR1 - Customer Masterfile
0340 IOLIST D$
0345 REM "IOLIST FOR FM0 - Location Masterfile
0350 IOLIST E$,E[0],E[1]
0360 IOLIST F$,F[0],F[1],F[2],F[3],F[4],F[5],F[6],F[7],F[8],F[9],F[10],F[11],F[12],F[13],F[14],F[15],F[16],F[17]
0365 REM "IOLISTS FOR FMP - Codes - G2$=Vendor master
0370 IOLIST G$
0371 IOLIST G0$
0372 IOLIST G1$
0373 IOLIST G2$
0375 REM "IOLISTS FOR AR3 - Salesperson
0380 IOLIST H$
0382 IOLIST H0$
0383 IOLIST H1$
0385 REM "IOLIST FOR FMS - Item Specification II
0390 IOLIST I$
0395 REM "IOLIST FOR FMU - Ply ( line detail )
0400 IOLIST J$(1)
0405 REM "IOLIST FOR FMV - Item spec comments
0410 IOLIST K$
0420 IOLIST L$,L[0],L[1]
0425 REM "IOLIST FOR FSH - O/P Division Information
0430 IOLIST D6$
0440 IOLIST I6$
0445 REM "IOLIST FOR FS2
0450 IOLIST B0$,B0[0],B0[1],B0[2],B0[3],B0[4],B0[5],B0[6],B0[7],B0[8],B0[9],B0[10],B0[11],B0[12],B0[13],B0[14],B0[15],B0[16],B0[17],B0[18],B0[19],B0[20],B0[21]
0451 REM "Second IOLIST for FS2, ssp91762
0452 IOLIST B1$(1),B1[0],B1[1],B1[2],B1[3],B1[4],B1[5],B1[6],B1[7],B1[8],B1[9],B1[10],B1[11],B1[12],B1[13],B1[14],B1[15],B1[16],B1[17],B1[18],B1[19],B1[20],B1[21],B1[22],B1[23],B1[24],B1[25],B1[26],B1[27],B1[28],B1[29]; REM "Use for extract
0453 IOLIST B1$(1),B1[0],STR(B1[1]),B1[2],B1[3],STR(B1[4]),B1[5],B1[6],B1[7],B1[8],B1[9],B1[10],B1[11],B1[12],B1[13],B1[14],STR(B1[15]),B1[16],B1[17],STR(B1[18]),B1[19],B1[20],B1[21],STR(B1[22]),B1[23],B1[24],B1[25],B1[26],B1[27],B1[28],B1[29]; REM "Use for write
0455 REM "IOLIST FOR AR4
0460 IOLIST C0$,C0[0],C0[1],C0[2],C0[3],C0[4],C0[5],C0[6],C0[7],C0[8],C0[9],C0[10],C0[11],C0[12],C0[13],C0[14],C0[15]
0490 IOLIST X3$,X4$,V1$,V3$,V2$,V0$
0495 IOLIST X$(1),X[0],X[1],X[2],X[3],X[4],X[5],X[6],X[7],X[8],X[9],X[10],X[11],X[12],X[13],X[14],X[15],X[16],X[17],X[18],X[19],X[20],X[21],X[22],X[23],X[24],X[25],X[26],X[27],X[28],X[29],X[30],X[31],X[32],X[33],X[34],X[35],X[36],X[37],X[38],X[39],X[40]
0500 REM "Files
0502 IF TCB(29)<7100000 THEN GOTO 9926 ! don't run if not version 7.1+
0505 DIM Z[NUM(X3$(60,3))]; GOSUB 7400
0510 Y$="01X PO6...  02O PO1...  03O PO2...  04O IC2...  05O IC0...  06O PO3...  07O FM0...  08O FMP...  09O AR4...  10O FS2...  11O POE...  13O ZZPARM  14O FM0...  15O AR3...  16O AP4...  17O PO4...  18O FM1...  19O FS1... 20O EC6... 21O EC8... 22O FMN...  23O AR4...  24O DTO...  25O DTY...  26O DTF...  27O DTS...  28O DT6...  29O DT0...  30S PO3...  31O DTC...  32O FMS...  33O FMU...  34O FMV...  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Y$,Z{ALL},Z0,Z1
0521 DT0=Z[29],DTO=Z[24],ZZPARM=Z[13],DT6=Z[28],DTY=Z[25],DTF=Z[26],DTS=Z[27],PO3_B=Z[30],DTC=Z[31],FMS=Z[32],FMU=Z[33],FMV=Z[34],POE=Z[11]
0522 MEM_FL=HFN; TOD_OUTPUT_TYPE$=PAD("PURCHASE_ORDER",20); OPEN (MEM_FL)"*MEMORY*"
0540 OOP=NEW("DTGDTO")
0550 FIND (Z[13],KEY=X3$(9,3)+"F/M")P9$
0560 FIND (Z[13],KEY=X3$(9,3)+"A/R")P8$
0570 FIND (Z[13],KEY=X3$(9,3)+"AR1")P4$
0575 FIND (Z[13],KEY="CMP"+X3$(9,3))N1$
0585 RT_PARM$=""
0600 REM "READ IN FORMATTING, SET W3 ETC.
0605 M0=182; REM "Number of fields on flexible format ! ssp#148606,166626
0610 DIM X9[M0],Y9[M0],X9$(M0),Y8[3],Y8$(35)
0655 W3=Y8[1]
0660 DIM Y5$(W3),Y6$(W3)
0700 REM "Open Printer
0730 CALL "ZZDAPP",X3$,"DZZFLESZZENTRZZCOMP"
0735 ! CALL "ZZPRIN",X0$,X3$,Y0$,V3$,Z{ALL},W0$,W1$,W0,W9,W2,W3,W4; ON W4 GOTO 0736,9920
0740 W0=60
0745 JETFORM_MODE=1 ! use this format
0750 D1$="",D2$=""
0800 REM "Alternate Sort Info & total dim"
0805 DIM U0$(4)
0810 ON V0 GOTO 0820,0820,0830,0840
0820 DIM U[2]; U=10,U0=2,U[0]=0,U[1]=1,U[2]=9,T0=0,U0$="    ",T5$="                "; GOTO 0850
0830 DIM U[3]; U=23,U0=3,U[0]=0,U[1]=10,U[2]=4,U[3]=9,T0=0,U0$="    ",T5$="                "; GOTO 0850; REM "WO118969
0850 DIM T[T0,T1]
0860 V5=V1+1,V6=V5+V2,V7=V6+V3
0900 REM " Position read"
0905 REM "set key file to read from"
0910 U1=Z[1]; IF V0=2 THEN U1=Z[17]
0920 IF V0=1 THEN V2$=V2$(1,20)
0930 IF LEN(V2$)>=U*2 THEN GOTO 0965
0934 REM "create default 'all' range key
0935 DIM V2$(U*2),V4$(U,"~"); U3=1
0940 FOR U9=1 TO U0; U3=U3+U[U9-1]+U[U9-1]
0950 V2$(U3+U[U9],U[U9])=V4$(1,U[U9])
0955 NEXT U9
0964 REM "Get starting key from range key
0965 DIM V4$(U); U3=1,U4=1
0970 FOR U9=1 TO U0; U3=U3+U[U9-1]+U[U9-1],U4=U4+U[U9-1]
0975 V4$(U4,U[U9])=V2$(U3,U[U9])
0980 NEXT U9
0985 V4$(U,1)=CHR(ASC(V4$(U,1))-1)
0990 READ (U1,KEY=V4$,DOM=0991)
1000 REM "Read next record
1005 U$=KEY(U1,END=5000); READ (U1)
1006 IF V0=1 AND U$(1,1)<>"P" THEN GOTO 5000
1008 REM "check key against range info"
1009 U3=1,U2=1
1010 FOR U9=1 TO U0; U2=U2+U[U9-1],U3=U3+U[U9-1]+U[U9-1]
1020 IF U$(U2,U[U9])<V2$(U3,U[U9]) THEN EXITTO 1000
1030 IF U$(U2,U[U9])>V2$(U3+U[U9],U[U9]) THEN IF U=1 THEN EXITTO 5000 ELSE EXITTO 1000
1040 NEXT U9
1100 REM "Get record"
1110 U9$=U$
1120 ON V0 GOTO 1150,1150,1130,1140
1130 READ (Z[1],KEY="P"+U$(15,9),DOM=1000); U$="P"+U$(15,9),U9$=U$; REM "V0=2, print by vendor, WO118969
1150 DIM A$(383); READ (Z[2],KEY=U$(2,9),ERR=1000,DOM=1000)IOL=0310; CALL "UPDPO3;ORD_HAS_SPEC_SHIP",PO3,A$(297,2),A$(299,7),ORD_HAS_SPEC_SHIP
1154 REM "Selecitve printing by P/O code?
1155 IF P9$(185,1)="Y" AND POS(" "<>V0$(72,10))>0 THEN IF A$(305,1)=" " AND POS("!"=V0$(72,10))=0 THEN GOTO 1000 ELSE IF POS(A$(305,1)=V0$(72,10)+" ")=0 THEN GOTO 1000
1157 GEN_SHIP_SHIPTO$=DIM(4); READ (Z[30],KEY=A$(297,8)+DIM(5),DOM=*NEXT)PO3$; GEN_SHIP_SHIPTO$=PO3$(12,4)
1159 IF WHO="jme" THEN ESCAPE 
1160 CALL "UPDDTO;GET_EF_TRANS_NUM",ERR=*NEXT,A$,OOP,MEM_FL,ZZPARM,X3$,TOD_TRANS$,GEN_SHIP_SHIPTO$,TOD_SEQ,TOD_OK
1180 IF V0$(82,2)="  " THEN GOTO SKIP_HOME_DIV ELSE DIM AR3$(236); IF POS(" "<>A$(343,4))>0 THEN FIND (Z[15],KEY=A$(343,4),DOM=1161)AR3$ ELSE FIND (Z[15],DOM=1181,KEY=A$(347,4))AR3$
1182 IF POS(X3$(9,3)="500139",3)<>0 THEN IF V0$(82,2)<>DIM(2) AND AR3$(235,2)=DIM(2) THEN FIND (Z[15],DOM=1181,KEY=A$(347,4))AR3$; REM "ssp# 200531
1185 IF V0$(82,2)<>AR3$(235,2) THEN GOTO 1000
1190 SKIP_HOME_DIV:IF NOT(TOD_OK) THEN GOTO 1000 ELSE REMOVE (Z[1],KEY=U$,DOM=1000); GOSUB 7550
1300 REM "Read other data
1305 P0=1,FIRST_PASS=1,TEXT_MODE=0
1310 Y$="05C IC0...  06C PO3...  07C FM0...  10C FS2...  11C POE...  05O AR1...  06O AP2...  10O FSH...  11O FSV...  "
1315 CALL "ZZFLES",X3$,Y1$,Y0$,Y$,Z{ALL},Z0,Z1
1317 XP=PRM('XI'); SET_PARAM 'XI'
1320 DIM C$(350); FIND (Z[19],KEY=A$(306,8),DOM=1323)IOL=0330
1321 SET_PARAM 'XI'=XP
1323 IF D6$(1,2)<>A$(297,2) THEN DIM D6$(402); FIND (Z[10],KEY=A$(297,2),DOM=1324)IOL=0430
1335 DIM D$(225); FIND (Z[5],KEY=A$(179,10),DOM=1336)IOL=0340; IF X9[137]>0 AND POS(" "<>D$(46,10))>0 THEN FIND (Z[5],KEY=D$(46,10),DOM=1336)IOL=0340
1338 IF P4$(64,1)<>"Y" OR P8$(109,1)<>"Y" THEN GOTO 1340 ELSE FIND (Z[11],KEY=A$(306,8),DOM=1339)X$; D$(56,87)=X$(54,87)
1340 IF A$(173,1)="S" THEN C$(89,8)=A$(347,4)+A$(343,4),C$(28,15)=A$(328,15)
1350 DIM H$(315); FIND (Z[15],KEY=C$(89,4),DOM=1351)IOL=0380
1355 DIM H0$(315); FIND (Z[15],KEY=C$(93,4),DOM=1356)IOL=0382
1360 DIM G2$(426); FIND (Z[16],KEY=A$(7,10),DOM=1361)IOL=0373
1365 DIM H1$(52); FIND (Z[6],KEY=A$(210,2),DOM=1366)IOL=0383
1370 Y$="05C AR1...  06C AP2...  10C FSH...  11C FSV...  05O IC0...  06O PO3...  07O FM0...  10O FS2...  11O POE...  "
1375 CALL "ZZFLES",X3$,Y1$,Y0$,Y$,Z{ALL},Z0,Z1
1380 POE=Z[11]
1500 REM "Print Data
1540 GOSUB 5500
1560 GOSUB 2000
1570 A$(189,1)="P"
1575 WRITE (Z[2],KEY=U$(2,9))IOL=0310
1900 REM "Accumulate Totals"
1990 T[T0,0]=T[T0,0]+1
1995 GOTO 1000
2000 REM "Print a P/O
2005 S0$="",S2$=""; IF TEXT_MODE THEN DIM HEADER$[M0]; NUM_LINES=LEN(P3$)/3,ON_LINE=0; IF NUM_LINES=0 THEN NUM_LINES=1 END_IF ; DIM LINE$[NUM_LINES,M0]
2010 GOSUB 2100
2020 GOSUB 2150
2030 GOSUB 2200 ! shiptto, soldto, vend addr
2035 GOSUB 3000 ! notepad
2040 GOSUB 2350
2050 GOSUB 2400 ! line info
2055 IF P7$<>"" THEN F5=24,F5$=STR(B7:M0$); GOSUB 8350; F5=97,F5$=STR(B5:M0$); GOSUB 8350; F5=99,F5$=STR(B6:M0$); GOSUB 8350; F5=132,F5$=STR(B8:"###"+M2$); GOSUB 8350
2060 IF A$(173,1)<>"S" AND P7$<>"" THEN F5=125,F5$=STR(B5-B7:M0$(2)); GOSUB 8350; F5=127,F5$=STR(B5-B7-B6:M0$(2)); GOSUB 8350; IF B5<>0 THEN F5=126,F5$=STR((B5-B7)*100/B5:M6$); GOSUB 8350; F5=128,F5$=STR((B5-B7-B6)*100/B5:M6$); GOSUB 8350
2090 RETURN 
2100 REM "Print very top
2105 IF JETFORM_MODE THEN P$="" ELSE DIM P$(Y8[0]*W3)
2117 SUB_F5=0,F5=104,F5$=D6$(11,35); GOSUB 8300; Z5$=D6$(46,35); GOSUB 8200; Z5$=D6$(81,35); GOSUB 8200
2119 ! IF X9[104]<>0 THEN IF JETFORM_MODE THEN F5=104,F5$=D6$(46,35); GOSUB JETFORM_PRINT; F5$=D6$(81,35); GOSUB JETFORM_PRINT ELSE P$((Y9[104]+1)*W3+X9[104],35)=D6$(46,35),P$((Y9[104]+2)*W3+X9[104],35)=D6$(81,35)
2120 CALL "ZZDISP","AX",A$(297,9),"P/O",X3$,X$,"",0,0,X4$; P5$=X$
2122 F5=5,F5$=A$(297,9); GOSUB 8300; F5=149,F5$=X$; GOSUB 8300; REM "WO108533, 2nd printing of order number
2123 OP$=MID(C$,172,3); IF STP(OP$)="" THEN OP$=A$(358,3) END_IF ; IF STP(OP$)="" THEN OP$=X3$(40,3) ! SSP 191685
2124 F5=180,F5$=STP("PDFFILE:"+X3$(9,3)+DLM+"PO"+DLM+OP$+DLM+P5$+"+"+STR(P2),3," "); GOSUB 8300 ! 166626 !SSP 191685
2125 IF POS(" "<>C$(55,6))<>0 THEN F5=6,F5$=FND$(C$(55,6)); GOSUB 8300
2127 F5=166,F5$=C$(64,6); GOSUB 8300; REM " SSP# 152507 CUSTOMER CHECK NUMBER
2128 F5=167,F5$=FND$(C$(70,6)); GOSUB 8300; REM " SSP# 152507 CUSTOMER CHECK DATE
2129 F5=168,F5$=STR(DEP_AMT:"###,###.00-"); GOSUB 8300; REM " SSP# 152507 CUSTOMER CHECK AMOUNT
2130 F5=122,F5$=C$(129,20); GOSUB 8300
2131 F5=179,F5$="VENDOR QUOTE #: "; GOSUB 8300; REM " SSP# 152507
2135 F5=157,F5$=MID(C$,203,20); GOSUB 8300; REM "WO124448
2137 ! F5=158,F5$=D6$(198,35),SUB_F5=1; GOSUB 8300; REM "WO120604
2138 F5=158,F5$=D6$(198,35),SUB_F5=1; GOSUB 8300; Z5$=D6$(233,35); GOSUB 8200; Z5$=D6$(268,35); GOSUB 8200; Z5$=D6$(303,35); GOSUB 8200
2139 ! F X9[158]>0 THEN IF JETFORM_MODE THEN F5=158,F5$=D6$(233,35),SUB_F5=2; GOSUB JETFORM_PRINT; SUB_F5=3,F5$=D6$(268,35); GOSUB JETFORM_PRINT; SUB_F5=4,F5$=D6$(303,35); GOSUB JETFORM_PRINT ELSE P$((Y9[158]+1)*W3+X9[158],35)=D6$(233,35),P$((Y9[158]+2)*W3+X9[158],35)=D6$(268,35),P$((Y9[158]+3)*W3+X9[158],35)=D6$(303,35); REM "WO120604
2140 RETURN 
2150 REM "Order header info
2154 GOSUB 7600
2155 IF POS(" "<>A$(192,6))<>0 THEN F5=7,F5$=FND$(A$(192,6)); GOSUB 8300
2156 F5=143,F5$=FNS$(H1$(3,30)); GOSUB 8300
2157 F5=8,F5$=A$(212,12); GOSUB 8300; F5=117,F5$=A$(314,12); GOSUB 8300; F5=118,F5$=STR(NUM(A$(326,2)):"##"); GOSUB 8300
2158 IF POS(" "<>A$(224,6))<>0 THEN F5=9,F5$=FND$(A$(224,6)); GOSUB 8300
2159 CALL "ZZDISP","AX",A$(7,10),"A/P",X3$,X$,"",0,0,X4$
2160 F5=10,F5$=A$(230,12); GOSUB 8300
2161 F5=114,F5$="Vendor Code"; GOSUB 8300; F5=11,F5$=A$(7,10); GOSUB 8300
2162 IF POS(" "<>G$(3,15))>0 THEN F5=111,F5$="F.O.B.:"; GOSUB 8300; F5=12,F5$=G$(3,15); GOSUB 8300
2165 F5=13,F5$=G0$(3,15); GOSUB 8300
2166 IF POS(" "<>E$(135,15))>0 THEN F5=112,F5$="INSIDE DELIVERY:"; GOSUB 8300; F5=14,F5$=E$(135,15); GOSUB 8300
2167 F5=110,X$=FND$(A$(242,6)); IF POS(" "<>A$(244,2)+X$(9,2))>0 THEN F5$=A$(244,2)+X3$(59,1)+X$(9,2); GOSUB 8300
2170 F5=15,F5$=G1$(3,15); GOSUB 8300
2171 F5=16,F5$=E$(151,15); GOSUB 8300
2175 F5=115,F5$=FND$(A$(204,6)); GOSUB 8300
2179 IF POS(X3$(9,3)="447",3)>0 THEN IF E$(175,3)="CCA" THEN F5=103,F5$="CRITICAL SHIP DATE REQ'D"; GOSUB 8300; GOTO 2181 ELSE IF E$(175,3)="CPA" THEN F5=103,F5$="CRITICAL PROOF DATE REQUIRED"; GOSUB 8300; GOTO 2181 ELSE IF E$(175,3)="PPA" THEN F5=103,F5$="DATE PROOF REQUIRED"; GOSUB 8300; GOTO 2181 ELSE IF E$(175,3)="FPA" THEN F5=103,F5$="DATE FAX PROOF REQ'D"; GOSUB 8300; GOTO 2181 ELSE IF E$(175,3)="CFA" THEN F5=103,F5$="CRITICAL FAX PROOF DATE REQ'D"; GOSUB 8300; GOTO 2181 ELSE IF STP(E$(175,35),3," ")="" THEN F5=103,F5$="DATE REQUIRED"; GOSUB 8300; GOTO 2181 ELSE IF E$(175,3)="D  " THEN F5=103,F5$="DATE REQUIRED"; GOSUB 8300; GOTO 2181; REM "added D per tkl on 100444, took out company 500, was only for testing
2180 F5=103,F5$=E$(175,35); GOSUB 8300
2182 F5=153,F5$="Proof status:"; GOSUB 8300; REM "WO118420
2183 F5=154; IF A$(284,1)="W" THEN F5$="Waiting"; GOSUB 8300 ELSE IF A$(284,1)="R" THEN F5$="Returned proof"; GOSUB 8300 ELSE IF A$(284,1)="C" THEN F5$="Customer app reqd"; GOSUB 8300 ELSE IF A$(284,1)="H" THEN F5$="Hot"; GOSUB 8300; REM "WO118420
2184 IF J8<>1 AND POS(" "<>A$(285,6))<>0 THEN F5=155,F5$=FND$(A$(285,6)); GOSUB 8300; REM "WO118420
2185 IF A$(1,1)<>" " THEN F5=147,F5$="*REPRINT* ("+A$(1,1)+")"; GOSUB 8300
2186 IF A$(351,1)<>" " THEN F5=148,F5$=A$(351,1); GOSUB 8300; REM "ssp93537
2187 F5=10001,F5$=PAD(GEN_SHIP_SHIPTO$,4); GOSUB 8300
2190 RETURN 
2200 REM "Shipto, Soldto, Vender addresses
2205 GOSUB 7750
2211 IF LEN(E$)<259 THEN GOSUB 5600 ELSE E0$=E$(225,35)
2212 IF LEN(E$)<299 THEN E$=E$+DIM(299-LEN(E$)); REM "109598, PO3 writing short somewhere, have not been able to find it
2213 IF E$(3,4)<>"    " THEN DIM WHSE$(400); FIND (Z[7],KEY="D"+DIM(10)+E$(3,4),DOM=2214)WHSE$; IF X9[3]<>0 THEN I0=Y9[3]*W3+X9[3],X7$=WHSE$(16,35)+WHSE$(160,20)+DIM(10)+WHSE$(51,87),PRT_WHSE$="Y"; GOTO 2220; REM "WO94734, print whse address as ship to rather than customer's ship to address
2214 IF E$(3,4)="    " AND E$(295,4)<>"    " THEN DIM PLANT$(400); FIND (Z[7],KEY="P"+E$(285,14),DOM=2215)PLANT$; IF X9[3]<>0 THEN I0=Y9[3]*W3+X9[3],X7$=PLANT$(16,35)+PLANT$(160,20)+DIM(10)+PLANT$(51,87),PRT_PLANT$="Y"; GOTO 2220; REM "WO100863, print Plant address as ship to rather than customer's ship to address
2215 IF E$(3,4)="    " AND E$(295,4)="    " AND E$(285,10)<>"          " THEN DIM VEND$(400); FIND (Z[16],KEY=E$(285,10),DOM=2216)VEND$; IF X9[3]<>0 THEN I0=Y9[3]*W3+X9[3],X7$=VEND$(11,35)+DIM(30)+VEND$(46,87),PRT_VEND$="Y"; GOTO 2220; REM "WO100863, print VENDOR address as ship to rather than customer's ship to address
2219 X7$=E0$(1,35)+E$(16,117)
2220 GOSUB 5650; F5=3; GOSUB 7700
2230 F5=4,F5$=C$(28,15); GOSUB 8300
2235 IF POS(" "<>MID(D$,205,12))>0 THEN CALL "ZZDISP","PX",D$(205,14),"",X3$,F5$,"",0,0,X4$; F5=135; GOSUB 8300
2240 IF POS(" "<>D$(143,12))>0 THEN CALL "ZZDISP","POX",D$(143,12),"",X3$,F5$,"",0,0,X4$; F5=136; GOSUB 8300
2250 X7$=D$(11,35)+DIM(30)+D$(56,87)
2260 F5=1; GOSUB 7700
2270 X7$=A$(21,152)
2280 F5=2; GOSUB 7700
2282 X7$=""; IF POS(" "<>A$(17,4))>0 THEN FIND (Z[7],KEY="P"+A$(17,4),DOM=2283)X7$
2283 IF A$(17,4)<>DIM(4) THEN F5=10000,F5$=A$(17,4); GOSUB 8300 ! plant code
2284 IF X7$>"" THEN F5$=X7$(200,14) ELSE F5$=G2$(195,14)
2285 IF POS(" "<>F5$)>0 THEN X$=F5$; CALL "ZZDISP","POX",X$,"",X3$,F5$,"",0,0,X4$; F5=138; GOSUB 8300
2286 IF X7$>"" THEN F5$=X7$(138,12) ELSE F5$=G2$(133,12)
2287 IF POS(" "<>F5$)>0 THEN X$=F5$; CALL "ZZDISP","POX",X$,"",X3$,F5$,"",0,0,X4$; F5=139; GOSUB 8300
2288 F5=140,F5$=G2$(256,15); GOSUB 8300
2290 RETURN 
2350 REM "Print bottom line
2355 CALL "ZZDISP","AX",A$(179,10),"A/R",X3$,X$,"",0,0,X4$
2360 F5=113,F5$="Customer Code"; GOSUB 8300; F5=25,F5$=X$; GOSUB 8300; F5=10002,F5$=A$(179,10)
2363 X$=" "
2364 ON POS(A$(190,1)="NECSB") GOTO 2380,2365,2366,2367,2368,2369
2365 X$="New"; GOTO 2380
2366 X$="Exact repeat"; GOTO 2380
2367 X$="Copy change"; GOTO 2380
2368 X$="Spec change"; GOTO 2380
2369 X$="Copy+Spec change"; GOTO 2380
2380 F5=26,F5$=X$; GOSUB 8300
2381 F5=27,F5$=FNT$(H$(149,20)+" "); GOSUB 8300 ! SSP#152175
2382 F5=28,F5$=C$(89,4); GOSUB 8300
2383 F5=29,F5$=FNT$(H0$(149,20)+" "); GOSUB 8300
2384 F5=30,F5$=C$(93,4); GOSUB 8300
2385 IF A$(191,1)="Y" THEN F5=105,F5$="*Confirming*"; GOSUB 8300
2386 IF MID(X9$,151,1)="E" THEN TYPE$="POX",DATA$=H$(189,10) ELSE TYPE$="PX",DATA$=H$(189,14)
2387 IF POS(" "<>DATA$)>0 THEN CALL "ZZDISP",TYPE$,DATA$,"",X3$,F5$,"",0,0,X4$; F5=151; GOSUB 8300; REM "WO115716,Salesperson phone number
2388 IF POS(" "<>H$(127,12))>0 THEN CALL "ZZDISP","POX",H$(127,12),"",X3$,F5$,"",0,0,X4$; F5=152; GOSUB 8300; REM "WO115716,Salesperson fax number
2390 RETURN 
2400 REM "Print line information
2405 I0=(Y8[2]-1)*W3,I1=0,S0$="",B1=0,B7=0,P7$="",B5=0,B6=0,B8=0,PO_LINE=0
2406 IF C1>2 THEN GOTO 2450 ELSE IF C1=1 AND LEN(P2$)=13 THEN GOTO 2450
2410 READ (Z[3],KEY=A$(297,9),DOM=2411)
2420 READ (Z[3],END=2490)IOL=0320
2425 IF B$(82,9)<>A$(297,9) THEN GOTO 2490
2427 PO_LINE$=B$(7,3)
2428 ! IF PO_LINE$="002" OR PO_LINE$="004" AND UID="jvv" THEN ESCAPE 
2430 IF C1<>2 THEN B1=0
2431 PO_LINE=PO_LINE+1,ON_LINE=ON_LINE+1
2432 GOSUB 7850
2434 REM "S2$ is flag to print comments only
2435 IF POS(B$(10,1)="CXI")<>0 THEN IF B$(81,1)="Y" THEN S0$=B$(91,20)+"001",S8$=A$(297,8)+B$(7,3),S2$=""; GOSUB 8950 ELSE IF B$(81,1)="C" THEN S0$=B$(91,20),S2$="*"; GOSUB 8950 ELSE IF B$(81,1)="N" THEN S0$=""
2438 IF B$(10,1)="M" THEN S0$=""
2439 P7$=B$(25,3) ! product code
2440 GOSUB 2500
2441 IF S0$="" THEN GOTO 2443
2442 GOSUB 4000 ! specs
2443 IF TOD_OK AND B$(10,1)<>"M" THEN GOSUB 7500 ! special shipping
2445 GOTO 2420
2450 REM "Print lines from P2$ for spec instr."
2460 READ (Z[6],KEY=P2$(1,13),DOM=2461)IOL=0350
2465 READ (Z[3],KEY=E$(166,9)+E$(7,3),DOM=2466)IOL=0320
2466 READ (Z[3],KEY=A$(297,9)+E$(7,3),DOM=2475)IOL=0320
2470 B1=E[0]; GOSUB 8900; IF L$(20,1)="Y" THEN B1=B1/L[1] ELSE B1=B1/B[2]
2471 GOSUB 2500
2475 P2$=P2$(14)
2490 PO_LINE=0
2495 RETURN 
2500 REM "Print one line from B$, I0 is assumed to be set
2503 F4=0,P3=0
2505 IF B$(10,1)="M" THEN F5=18,F5$=B$(28,40); GOSUB 8350; IF B[0]<>0 THEN F5=24,F5$=STR(B[0]:M1$); GOSUB 8350; GOTO 2535 ELSE GOTO 2535
2506 IF B[2]=0 THEN B[2]=1
2507 F5=31,F5$=B$(7,3); GOSUB 8350
2508 GOSUB 8500; GOSUB 8900
2509 IF L$(21,1)="Y" OR (B$(10,1)="S" AND I$(61,1)="Y") THEN IF C1<2 THEN P3=B[4]; IF X9[129]=0 OR L$(21,1)="Y" THEN B[0]=B[4]
2510 REM "
2511 UM$=B$(77,4),UM0=B[2]; IF C1<2 THEN F5=22,F5$=STR(B[0]:M5$); GOSUB 5900; IF B$(10,1)="M" THEN F5$=DIM(5); GOSUB 8350 ELSE GOSUB 8350; REM "SSP# 208237
2512 ! F5=23,F5$=UM$; IF MID(X9$,F5,1)="Q" THEN F5$=FNS$(F5$)+"/"+FNR$(STR(UM0:M3$)); GOSUB 8350 ELSE GOSUB 8350
2513 F5=23,SUB_F5=1,F5$=UM$; GOSUB 8350; SUB_F5=2,F5$=STR(UM0); GOSUB 8350
2514 IF B1=0 THEN IF L$(20,1)="Y" THEN B1=B[11]/L[1] ELSE B1=B[11]/B[2]
2515 IF B1<>0 THEN IF FPT(B1)=0 THEN F5=17,F5$=STR(B1:M2$); GOSUB 8350 ELSE F5=17,F5$=STR(B1:M0$); GOSUB 8350
2516 B2=E[0]; IF B2=0 THEN B2=B[11] END_IF ; IF B2<>0 THEN F5=181,F5$=STR(B2:M2$); GOSUB 8350 ! WO168289
2517 IF C1>=2 THEN F5=96,F5$="Shipping instructions"; GOSUB 6300; GOTO 2533 ELSE IF B$(10,1)="S" AND I$(61,1)="Y" THEN GOTO 2530
2520 IF L$(21,1)="Y" OR B[1]=0 THEN P3=B[0] ELSE IF L$(20,1)="Y" AND L[0]<>0 THEN P3=B[0]*B1/L[0] ELSE P3=B[0]*B1
2530 B7=B7+P3,B8=B8+B1; F5=129,F5$=STR(P3:M0$); GOSUB 8350
2533 H8$=B$; GOSUB 8000; F5=19,F5$=H9$; GOSUB 8350; F5=21,F5$=FNS$(B$(101,10)); GOSUB 8350; H9$=" "
2534 IF X9$(106,1)="B" AND B$(10,1)<>"I" THEN F6=106,F5$=""; GOSUB 8350
2535 DIM FORM$(448); XPR=PRM('XI'); SET_PARAM 'XI'; READ (Z[18],KEY=B$(91,20),DOM=2536)FORM$
2536 SET_PARAM 'XI'=XPR; IF MID(X9$,159,1)="F" AND STP(MID(FORM$,350,20),3," ")="" THEN F5$=B$(101,10),F5=159; GOSUB 8350 ELSE F5$=MID(FORM$,350,20),F5=159; GOSUB 8350
2540 IF X9$(106,1)<>"C" AND B$(10,1)<>"I" THEN GOTO 2550
2542 FIND (Z[4],KEY=B$(91,20)+A$(7,14),DOM=2550)IOL=0440
2544 IF X9$(106,1)<>"B" AND POS(" "<>I6$(35,20))=0 THEN GOTO 2550
2546 F5=106; IF X9$(106,1)="N" THEN F5$=I6$(35,20); GOSUB 8350 ELSE F5$="Your item no: "+I6$(35,20); GOSUB 8350
2550 IF C1<2 THEN GOSUB 8700; REM "Only do if NOT shipping inst.
2560 IF C1<2 AND POS(" "<>B$(68,9))>0 THEN F5=58,F5$=B$(68,9); GOSUB 8300; REM "assume only one line has a starting #"
2562 IF E$(11,1)="D" THEN E2$=E$(12,4) ELSE E2$=""; GOTO 2570
2565 IF X9[146]<>0 THEN DIM J5[20]; CALL "IC2UTK",ERR=2566,X3$,X4$,B$(91,20)+E2$,J5$,J5{ALL}; F5=146,F5$=J5$(35,10); GOSUB 8350
2570 GOSUB OUTPUT_VP_INFO ! ssp#148606
2590 I0=I0+F4*W3
2595 RETURN 
3000 REM " READ ORDER NOTEPAD AND SET INFORMATION TO BE PRINTED SSP# 151507
3010 READ (Z[22],KEY=C$(118,8),DOM=3099)ORDER_NOTE$
3015 F5=169; F5$=ORDER_NOTE$(9,50); GOSUB 8300; REM " SSP# 151507 - LINE 1
3020 F5=170; F5$=ORDER_NOTE$(59,50); GOSUB 8300; REM " SSP# 151507 - LINE 2
3025 F5=171; F5$=ORDER_NOTE$(109,50); GOSUB 8300; REM " SSP# 151507 - LINE 3
3030 F5=172; F5$=ORDER_NOTE$(159,50); GOSUB 8300; REM " SSP# 151507 - LINE 4
3035 F5=173; F5$=ORDER_NOTE$(209,50); GOSUB 8300; REM " SSP# 151507 - LINE 5
3040 F5=174; F5$=ORDER_NOTE$(259,50); GOSUB 8300; REM " SSP# 151507 - LINE 6
3045 F5=175; F5$=ORDER_NOTE$(309,50); GOSUB 8300; REM " SSP# 151507 - LINE 7
3050 F5=176; F5$=ORDER_NOTE$(359,50); GOSUB 8300; REM " SSP# 151507 - LINE 8
3055 F5=177; F5$=ORDER_NOTE$(409,50); GOSUB 8300; REM " SSP# 151507 - LINE 9
3060 F5=178; F5$=ORDER_NOTE$(459,50); GOSUB 8300; REM " SSP# 151507 - LINE 10
3099 RETURN 
4000 REM "Print bottom half of P/O
4002 HAS_SPECS=0
4003 IF S0$="" THEN S0$=B$(91,20)
4006 DIM F$(448),F[17]; F[0]=X[19]; READ (Z[18],KEY=S0$(1,20),DOM=4007)IOL=0360
4015 GOSUB 4100
4020 GOSUB 4300; IF HAS_SPECS OR DTF_COMP$="Y" THEN GOSUB 4400 ! print 8 lines of comments if std specs exist
4025 DTF_COMP$="",DTF_SPEC$=""
4040 GOSUB 4700 ! poe comments only
4050 GOSUB 8600
4090 RETURN 
4100 REM "Print ply information
4102 L2=10,L1=1
4105 DIM J$(134); READ (FMU,KEY=S0$,DOM=4145)IOL=0400
4110 IF J$(1,20)<>S0$(1,20) THEN GOTO 4145
4125 ! F POS(" "<>J$(102,8))>0 THEN F5=43; F5$=J$(102,8); GOSUB 8350
4128 ! IF UID="jvv" THEN ESCAPE 
4130 GOSUB 4150
4132 S0$=S0$(1,20)+STR(NUM(J$(21,3))+1:"000")
4134 L1=L1+1; IF L1=L2 THEN GOTO 4145
4135 GOTO 4105
4145 PLY_SEQUENCE$=""
4146 RETURN 
4150 REM "Print a ply
4151 HAS_SPECS=1
4152 F5=32,F5$=STR(NUM(J$(21,3)):"##"),PLY_SEQUENCE$=STR(NUM(J$(21,3)):"00"); GOSUB 8350
4153 F5=18,F5$=B$(28,40); GOSUB 8350
4154 F5=5,F5$=B$(82,9); GOSUB 8350; F5=6,F5$=A$(204,6); GOSUB 8350
4156 F5=21,F5$=FNS$(B$(101,10)); GOSUB 8350
4157 F5=33,F5$=J$(24,3); GOSUB 8350
4158 F5=34,F5$=J$(27,3); GOSUB 8350
4159 F5=35,F5$=J$(30,6); GOSUB 8350
4160 F5=36,F5$=J$(36,8); GOSUB 8350
4161 F5=37,F5$=J$(44,8); GOSUB 8350
4163 F5=38,SUB_F5=1,F5$=J$(52,6)+" "+J$(131,1); GOSUB 8350; SUB_F5=2,F5$=J$(58,6)+" "+J$(132,1); GOSUB 8350; SUB_F5=3,F5$=J$(64,6)+" "+J$(133,1); GOSUB 8350; SUB_F5=4,F5$=J$(70,6)+" "+J$(134,1); GOSUB 8350
4164 ! IF POS(X3$(9,3)="101302",3)<>0 THEN F5=38,F5$=J$(52,6)+" "+J$(131,1)+F5$+J$(58,6)+" "+J$(132,1)+F5$+J$(64,6)+" "+J$(133,1)+F5$+J$(70,6)+" "+J$(134,1); GOSUB 8300; GOTO 4166
4170 F5=39,F5$=J$(76,10); GOSUB 8350
4171 F5=116,F5$=J$(86,1); GOSUB 8350
4172 F5=40,F5$=J$(87,2); GOSUB 8350
4173 F5=41,F5$=J$(89,1),SUB_F5=1; GOSUB 8350; F5$=J$(90,1),SUB_F5=2; GOSUB 8350
4174 F5=94,F5$=J$(91,8); GOSUB 8350
4175 F5=95,F5$=J$(99,3); GOSUB 8350
4176 F5=42,F5$=J$(110,20); IF X3$(9,3)="084" THEN F5$=STR(NUM(J$(21,3)):"##")+" "+F5$; GOSUB 8350 ELSE IF POS(X3$(9,3)="110",3)>0 THEN F5$=F5$(1,16); GOSUB 8350 ELSE GOSUB 8350
4177 IF POS(" "<>J$(102,8))>0 THEN F5=43; F5$=J$(102,8); GOSUB 8350
4178 F5=119,F5$=J$(130,1); GOSUB 8350
4190 RETURN 
4300 REM "Print comp section
4301 DTF_COMP$="",DTF_SPEC$=""
4302 FIND (Z[8],KEY="T"+P7$,DOM=*NEXT)X$; IF LEN(X$)>34 THEN IF X$(33,3)<>"   " THEN PO_LINE$=B$(7,3); CALL "PO2PAU",X3$,X4$,P$,S0$,X$,W3,"",V3$,DTF,TOD_OUTPUT_TYPE$,TOD_TRANS$,PO_LINE$,B$(101,10),B$(28,40); IF X$(21,1)="Y" THEN GOTO *RETURN ELSE DTF_SPEC$=X$(33,3),DTF_COMP$="Y" ! user defined specs, only do comp section if pc set to "n"
4310 READ (FMS,KEY=S0$(1,20),DOM=4370)IOL=0390
4312 IF LEN(I$)<158 THEN I$=PAD(I$,158) ! f5=92 needs 144,15
4314 HAS_SPECS=1
4315 PLY_SEQUENCE$="98"
4317 IF I$(21,1)="Y" THEN F5$="Plant" ELSE F5$=I$(21,1)
4318 F5=44; GOSUB 8350
4321 F5=45,F5$=I$(22,1); GOSUB 8350; F5=46,F5$=I$(23,1); GOSUB 8350
4322 F5=47,F5$=I$(25,1); GOSUB 8350; F5=48,F5$=I$(26,1); GOSUB 8350
4323 F5=49,F5$=I$(27,1); GOSUB 8350; F5=50,F5$=I$(28,1); GOSUB 8350
4324 F5=51,F5$=I$(29,1); GOSUB 8350; F5=52,F5$=I$(30,1); GOSUB 8350
4325 F5=53,F5$=I$(31,1); GOSUB 8350; F5=54,F5$=I$(32,1); GOSUB 8350
4326 F5=55,F5$=I$(33,1); GOSUB 8350; F5=56,F5$=I$(34,1); GOSUB 8350
4327 F5=57,F5$=I$(35,3); GOSUB 8350
4330 F5=59,F5$=I$(48,5); GOSUB 8350; F5=60,F5$=I$(53,2); GOSUB 8350; F5=61,F5$=I$(55,3); GOSUB 8350
4331 F5=62,F5$=I$(58,1); GOSUB 8350; F5=63,F5$=I$(59,1); GOSUB 8350
4332 F5=64,F5$=I$(60,1); GOSUB 8350; F5=65,F5$=I$(61,1); GOSUB 8350
4333 F5=66,F5$=I$(62,1); GOSUB 8350; F5=67,F5$=I$(64,1); GOSUB 8350
4334 F5=68,F5$=I$(65,1); GOSUB 8350; F5=69,F5$=I$(66,1); GOSUB 8350
4335 F5=70,F5$=I$(67,1); GOSUB 8350; F5=145,F5$=I$(63,1); GOSUB 8350
4336 IF F[0]=0 THEN F5$="Std." ELSE F5$=FNR$(STR(F[0]:M3$))
4337 F5=71; GOSUB 8350
4341 F5=72,F5$=I$(68,1); GOSUB 8350; F5=73,F5$=I$(69,1); GOSUB 8350
4342 F5=74,F5$=I$(70,1); GOSUB 8350; F5=75,F5$=I$(71,1); GOSUB 8350
4343 F5=76,F5$=I$(72,1); GOSUB 8350; F5=77,F5$=I$(73,6); GOSUB 8350
4344 F5=78,F5$=I$(79,8); GOSUB 8350; F5=79,F5$=I$(87,1); GOSUB 8350
4345 F5=80,F5$=I$(88,5); GOSUB 8350; F5=81,F5$=I$(93,8); GOSUB 8350
4351 F5=82,F5$=I$(101,1); GOSUB 8350; F5=83,F5$=I$(102,1); GOSUB 8350
4352 F5=84,F5$=STR(NUM(I$(103,4)):"##"); GOSUB 8350; F5=85,F5$=I$(107,1); GOSUB 8350
4353 F5=86,F5$=I$(108,1); GOSUB 8350; F5=87,F5$=I$(109,1); GOSUB 8350
4354 F5=88,F5$=I$(110,3); GOSUB 8350; F5=89,F5$=I$(113,1); GOSUB 8350
4355 F5=90,F5$=I$(114,15); GOSUB 8350; F5=91,F5$=I$(129,15); GOSUB 8350
4356 F5=92,F5$=I$(144,15); GOSUB 8350
4358 F5=120,F5$=I$(38,4); GOSUB 8350; F5=121,F5$=STR(NUM(I$(42,5)):"#####"); GOSUB 8350
4385 PLY_SEQUENCE$=""
4390 RETURN 
4400 REM "Print comments
4402 PLY_SEQUENCE$="99"
4405 READ (FMV,KEY=S0$(1,20),DOM=4406)
4406 F2=0
4407 I0=Y9[93]*W3,I9=1
4410 READ (FMV,END=4435)IOL=0410; IF K$(1,20)<>S0$(1,20) THEN GOTO 4435
4420 IF K$(24,1)<>"N" THEN GOSUB 4450
4430 IF F2<9 THEN GOTO 4410
4435 PLY_SEQUENCE$=""
4440 RETURN 
4450 REM "Print a comment
4455 F2=F2+1
4460 F5=101,SUB_F5=F2,F5$=K$(25,60); GOSUB 8350
4490 RETURN 
4700 REM "Print P/O comments
4702 RETURN 
4705 READ (POE,KEY=A$(297,9)+PO_LINE$,DOM=4706)
4710 READ (POE,END=4740)IOL=0410
4715 IF K$(1,9)<>A$(297,9) THEN GOTO 4740
4717 IF K$(10,3)<>PO_LINE$ THEN GOTO 4740
4720 IF K$(13,1)<>"Y" THEN GOTO 4710
4730 GOTO 4710
4740 END_OF_CMT:
4749 RETURN 
4790 RETURN 
4800 JETFORM_PRINT:REM "For jetform mode add field nominated value with F5 as the field name and F5$ as the value; P_LINE[ F5 ] is the last po line that the field F5 was printed on (init'ed to 0). IF the current po line is more than 1 > that po line then we need to output blank fields until it is 1 less than the current po line. Ofcourse for the non line (header & total) sections the current po  line is 0. The current po line is in PO_LINE
4810 IF F5<>58 THEN IF PO_LINE>P_LINE[F5]+1 THEN P$=P$+"^field "+STP(P6$(146,3),1)+STR(F5:"000")+'LF'; P_LINE[F5]=P_LINE[F5]+1; GOTO 4810; REM "fld 58 only prints once should only be on line 1
4815 P$=P$+"^field "+STP(P6$(146,3),1)+STR(F5:"000")+'LF'+F5$+'LF'; P_LINE[F5]=P_LINE[F5]+1
4845 JETFORM_PRINT_END:RETURN 
4900 OUTPUT_VP_INFO:! Generate Variable Print information fields B$=line ssp#148606
4905 DIM EC8$(200); FIND (Z[21],KEY=B$(82,8)+B$(11,3),DOM=4940)EC8$
4910 DIM EC6$(900); FIND (Z[20],KEY=MID(EC8$,12,10),DOM=*NEXT)EC6$
4920 F5=160,F5$=STP(MID(EC8$,22,20)); GOSUB 8350 ! 160, VP_info_1
4922 F5=161,F5$=STP(MID(EC8$,42,20)); GOSUB 8350 ! 161, VP_info_2
4924 F5=162,F5$=STP(MID(EC6$,1,10)); GOSUB 8350 ! 162 VP_id
4926 F5=163,F5$=STP(MID(EC6$,141,60)); GOSUB 8350 ! 163 VP Proof URL
4928 F5=164,F5$=STP(MID(EC6$,201,60)); GOSUB 8350 ! 164 VP Vendor URL
4930 F5=165,F5$=STP(MID(EC6$,141,60))+"/"+STP(MID(EC8$,42,20)); GOSUB 8350 ! 165 VP Proof URL/Proof file (vp_info_2)
4932 F5=182,F5$=STP(MID(EC8$,62,50)); GOSUB 8350 ! 182, VP_info_3
4949 RETURN 
5000 REM "End of Print
5001 CALL "UPDDTC;UPDATE_HDR_INFO",DTC,DTO,TOD_OUTPUT_TYPE$,TOD_TRANS$,MEM_FL
5002 CALL "UPDDTS;UPDATE_HDR_INFO",DTS,DTO,TOD_OUTPUT_TYPE$,TOD_TRANS$,MEM_FL
5004 CALL "UPDDTY;UPDATE_HDR_INFO",DTY,DTO,TOD_OUTPUT_TYPE$,TOD_TRANS$,MEM_FL
5006 CALL "UPDDTF;UPDATE_HDR_INFO",DTF,DTO,TOD_OUTPUT_TYPE$,TOD_TRANS$,MEM_FL
5007 CALL "UPDDTO;UPDATE_HDR_INFO",DTO,TOD_OUTPUT_TYPE$,TOD_TRANS$,MEM_FL
5008 CALL "UPDDT6;ADD_TO_QUEUE",DT6,MEM_FL,TOD_OUTPUT_TYPE$
5010 GOTO 9920
5500 REM "Get proper address, C1=1 taken care of in 2300's
5505 DIM E$(260)
5510 ON C1 GOTO 5515,5590,5520,5550
5515 IF LEN(P2$)=13 THEN GOTO 5550; REM "Only one P/O, but it is special ship
5520 READ (Z[6],KEY=A$(297,9)+"    ",DOM=5530)IOL=0350; GOTO 5590
5530 READ (Z[6],KEY=A$(297,8)+"     ",DOM=5540)IOL=0350; GOTO 5590
5535 REM "If no general inst., use customer address
5540 E$(16,30)=D$(165,20),E$(46,87)=D$(56,87); GOTO 5590
5550 REM "Read in special shipping record
5560 READ (Z[6],KEY=P2$(1,13),DOM=5580)IOL=0350
5570 GOTO 5590
5580 REM "Error"
5585 EXITTO 1580
5590 RETURN 
5600 REM "Get name to print on shipto
5610 E0$=D$(11,35)
5615 ON POS(E$(11,1)="CPD") GOTO 5645,5620,5625,5630
5620 FIND (Z[7],KEY=E$(11,1)+D$(1,10)+E$(12,4),DOM=5645)E1$; GOTO 5635
5625 FIND (Z[7],KEY=E$(11,1)+A$(7,10)+E$(12,4),DOM=5645)E1$; GOTO 5635
5630 FIND (Z[7],KEY=E$(11,1)+Y6$(1,10)+E$(12,4),DOM=5645)E1$; GOTO 5635
5635 E0$=E1$(16,35)
5645 RETURN 
5650 REM "GET EXTENDED SHIPPING ADDRESS
5655 DIM SHIP_TO$(0); IF P9$(244,1)<>"Y" THEN GOTO 5690 ELSE IF J8=1 THEN DIM SHIP_TO$(120,"X"); GOTO 5690
5657 IF PRT_WHSE$="Y" THEN PRT_WHSE$="N"; GOTO 5690; REM "WO94734
5658 IF PRT_PLANT$="Y" THEN PRT_PLANT$="N"; GOTO 5690; REM "WO100863
5659 IF PRT_VEND$="Y" THEN PRT_VEND$="N"; GOTO 5690; REM "WO100863
5660 READ (Z[7],KEY="C"+D$(1,10)+E$(12,4),DOM=5661)SHIP_TO$ ! ssp 200446
5690 RETURN 
5800 REM "Print extended shipping lines
5810 FOR I=0 TO 3
5820 IF POS(" "<>MID(SHIP_TO$,402+I*30,30))>0 THEN F5$=SHIP_TO$(402+I*30,30),SUB_F5=I+1; GOSUB 8350
5830 NEXT I
5835 SHIP_TO$=""
5840 RETURN 
5900 REM "Calculate T unit of measure
5920 IF (X9$(F5,1)<>"D" AND X9$(F5,1)<>"d") OR UM$<>"T   " OR UM0<>1000 THEN GOTO 5990
5940 PRECISION 5; F5$=STR(NUM(F5$)*.001:"#.00000"),UM$="EACH",UM0=1; PRECISION 2
5990 RETURN 
6100 REM "Setup test data"
6105 X$="X",X5$="I6XXXX"
6110 DIM A$(383,X$),B$(118,X$),B[27],C$(350,X$),D$(200,X$),E$(225,X$),F$(386,X$),F[17],G$(20,X$),G0$(20,X$),G1$(20,X$),H$(315,X$),H0$(315,X$),I$(159,X$),J$(134,X$),K$(90,X$),G2$(300,X$),H1$(40,X$)
6120 A$(204,6)=X5$,A$(192,6)=X5$,C$(16,6)=X5$,A$(224,6)=X5$,J$(21,3)="000",A$(242,6)=X5$,A$(291,6)=X5$,C$(55,6)=X5$,I$(103,4)="0999",A$(326,2)="99",I$(42,5)="99999",A$(190,1)="E",C$(70,6)=X5$
6125 I$(68,5)="YYYYY"
6130 DIM H1$(40,"X")
6190 RETURN 
6300 REM 
6310 IF MID(X9$,F5,1)="X" THEN GOTO 6340
6320 GOSUB 8350
6340 RETURN 
7300 REM "Output line Y5$ to output device
7310 W=W+1
7330 PRINT (W9)STP(Y5$,1); DIM Y5$(W3)
7395 RETURN 
7400 REM "Read report selection parameters"
7405 CLOSE (14); OPEN (14)"ZZP"
7430 Y3$=X3$(1,6),Y4$=X3$(178,7)
7450 READ (14,KEY=X3$(1,8),DOM=7451)IOL=0490
7480 X3$(178,7)=Y4$,V0=NUM(V0$(71,1)),W3$=V0$(19,POS("   "=V0$(19,40)+"   ")-1)
7482 IF V1$(1,3)="???" THEN V8$="A",V7$=V1$(4,2); IF V0$(71,1)="1" THEN V1$="PO6   "
7485 FOR U1=1 TO LEN(V1$); IF V1$(U1,1)=" " THEN V1$(U1,1)="."; NEXT U1 ELSE NEXT U1
7486 CLOSE (14)
7488 IF POS(">"=V0$(59,12))=0 THEN W6$="" ELSE W6$=V0$(59,12),W6$=W6$(POS(">"=W6$)+1,2),DO_2=1
7490 RETURN 
7500 SPECIAL_SHIP:
7504 DIM E[3]
7505 P0=0,P2$="",P3$="",P10$=""; IF A$(173,1)="C" THEN P0$=A$(306,8)+" " ELSE P0$=A$(297,9) ! SSP#188207
7507 DIM GEN_SHIP$(428); READ (Z[6],KEY=P0$+DIM(4),DOM=*NEXT)GEN_SHIP$
7510 READ (Z[6],KEY=P0$+PO_LINE$,DOM=7511)
7511 YES_SPEC_SHIP=0
7520 K$=KEY(Z[6],END=7540); IF K$(1,12)<>P0$+PO_LINE$ THEN GOTO 7540
7522 IF K$(10,4)="    " THEN READ (Z[6]); GOTO 7520; REM "Skip general instructions
7525 READ (Z[6])IOL=0350
7526 PO3_ITEM_NUMBER$=B$(101,10),PO3_ITEM_DESC$=B$(28,40),PO3_UOM$=B$(77,4),DTS_DATE_REQUIRED$=FND$(A$(204,6)),PO3_PO$=B$(82,9); GOSUB 7600
7527 CALL "UPDDTS;UPDATE_LINE",DTS,TOD_OUTPUT_TYPE$,TOD_TRANS$,E$,E{ALL},PO3_ITEM_NUMBER$,PO3_ITEM_DESC$,PO3_UOM$,DTS_DATE_REQUIRED$,PO3_PO$,FOB_DESC$,HTS_DESC$,STR(B[2])
7530 YES_SPEC_SHIP=1,FOB_DESC$="",HTS_DESC$=""
7535 GOTO 7520
7545 DIM E[3]; IF ORD_HAS_SPEC_SHIP AND NOT(YES_SPEC_SHIP) THEN E$=GEN_SHIP$; E$(7,3)=PO_LINE$,E[0]=B[1],PO3_ITEM_NUMBER$=B$(101,10),PO3_ITEM_DESC$=B$(28,40),PO3_UOM$=B$(77,4),DTS_DATE_REQUIRED$=FND$(A$(204,6)),PO3_PO$=B$(82,9); GOSUB 7600; CALL "UPDDTS;UPDATE_LINE",DTS,TOD_OUTPUT_TYPE$,TOD_TRANS$,E$,E{ALL},PO3_ITEM_NUMBER$,PO3_ITEM_DESC$,PO3_UOM$,DTS_DATE_REQUIRED$,PO3_PO$,FOB_DESC$,HTS_DESC$,STR(B[2])
7548 FOB_DESC$="",HTS_DESC$=""
7549 RETURN 
7550 REM "increment reprint flag
7560 EXTRACT (Z[2],KEY=U$(2,9))IOL=0310
7570 A$(1,1)=STR(NUM(A$(1,1))+1:"0")
7580 WRITE (Z[2])IOL=0310
7590 RETURN 
7600 REM "Set shipping stuff based on shipping record
7610 DIM G$(20); READ (Z[8],KEY="F"+E$(133,1),DOM=7611)IOL=0370
7620 DIM G0$(20); READ (Z[8],KEY="H"+E$(134,1),DOM=7621)IOL=0371
7630 REM DIM G1$(20); READ (Z(8),KEY="S"+E$(150,1),DOM=7631) IOL=0372
7635 DIM G1$(20); G1$(3,15)=E$(210,15)
7638 FOB_DESC$=G$(3,15),HTS_DESC$=G0$(3,15)
7645 RETURN 
7650 REM "Fix city, state, zip in Z5$ into X6$
7655 REM IF X5$(17,2)="  " THEN GOTO 07690
7660 X6$=FNS$(Z5$(1,16))+", "+Z5$(17,2)+"  "
7665 ! F UID="jvv" THEN ESCAPE 
7670 CALL "ZZDISP","AX",Z5$(19,9),"ZIP",X3$,X$,"",0,0,X4$
7680 X6$=X6$+X$; Z5$=X6$
7690 RETURN 
7700 REM "Take name(35),attn(30),address(87) in X7$ & put into P$ at I0
7715 IF SHIP_TO$>"" THEN {
7720 SUB_F5=0,F5$=SHIP_TO$(16,35); GOSUB 8300; Z5$=SHIP_TO$(51,30); GOSUB 8200; Z5$=SHIP_TO$(81,30); GOSUB 8200; Z5$=SHIP_TO$(111,16)+SHIP_TO$(127,2)+SHIP_TO$(129,9); GOSUB 7650; GOSUB 8200
7722 ! UB_F5=0,F5$=SHIP_TO$(16,35); GOSUB 8300; SUB_F5=1,F5$=SHIP_TO$(51,30); GOSUB 8300; SUB_F5=2,F5$=SHIP_TO$(81,30); GOSUB 8300; SUB_F5=5,F5$=SHIP_TO$(111,16); GOSUB 8300; SUB_F5=6,F5$=SHIP_TO$(127,2); GOSUB 8300; SUB_F5=7,F5$=SHIP_TO$(129,9); GOSUB 8300
7725 SHIP_TO$=""
7730  } ELSE {
7735 SUB_F5=0,F5$=X7$(1,35); GOSUB 8300; Z5$=X7$(36,30); GOSUB 8200; Z5$=X7$(66,30); GOSUB 8200; Z5$=X7$(96,30); GOSUB 8200; Z5$=X7$(126,16)+X7$(142,2)+X7$(144,9); GOSUB 7650; GOSUB 8200
7736 ! UB_F5=0,F5$=X7$(1,35); GOSUB 8300; SUB_F5=1,F5$=X7$(36,30); GOSUB 8300; SUB_F5=2,F5$=X7$(66,30); GOSUB 8300; SUB_F5=3,F5$=X7$(96,30); GOSUB 8300; SUB_F5=5; F5$=X7$(126,16); GOSUB 8300; SUB_F5=6,F5$=X7$(142,2); GOSUB 8300; SUB_F5=7,F5$=X7$(144,9); GOSUB 8300
7739  }
7740 RETURN 
7750 REM "Company Name & optional address
7760 F5=144,O0=0,F5$=FNS$(N1$(7,38)); GOSUB 8300
7765 IF MID(X9$,144,1)<>"A" THEN GOTO 7790
7770 FOR X=0 TO 2; F5$=FNS$(N1$(47+X*40,40)); IF F5$>"" THEN F5=144,O0=O0+1; GOSUB 8320
7775 NEXT X
7780 IF POS(" "<>N1$(167,14))>0 THEN CALL "ZZDISP","PX",N1$(167,14),"",X3$,F5$,"",0,0,X4$; F5=144,O0=O0+1; GOSUB 8320
7790 RETURN 
7800 REM "Put valid p/o lines in P3$
7805 READ (Z[3],KEY=A$(297,9),DOM=7806)
7810 READ (Z[3],END=7825)IOL=0320
7811 IF B$(10,1)="M" THEN GOTO 7810
7815 IF B$(82,9)<>A$(297,9) THEN GOTO 7825
7820 P3$=P3$+B$(7,3); GOTO 7810
7825 REM "If B/S type see if all lines have same s/s ship-to
7830 IF POS(A$(351,1)="BS")=0 OR LEN(P3$)<3 THEN GOTO 7845 ELSE INDEX=1; READ (Z[6],KEY=A$(306,8)+" "+P3$(1,3),DOM=7835)
7834 REM "get list of shipto locations (type + code) from ORDER special ship instructions by line. MAKE SURE that the lines we look at are on THIS P/O (possible for lines from more than 1 P/O  on an order). P3$ is list of lines on THIS P/O, so start with first one on that list, and check ONLY lines that are in P3$
7835 K$=KEY(Z[6],END=7845); READ (Z[6])IOL=0350; IF K$(1,8)<>A$(306,8) THEN GOTO 7841 ELSE IF POS(E$(7,3)=P3$,3)<>0 THEN IF POS(E$(11,5)=P10$,5)=0 THEN P10$=P10$+E$(11,5); REM " this logic doesnt work if there is 1 line with more than one special ship to:  K$(1,12)<>A$(306,8)+" "+P3$(INDEX,3) THEN GOTO 07845 ELSE LET INDEX=INDEX+3; IF POS(E$(11,5)=P10$,5)=0 THEN LET P10$=P10$+E$(11,5)
7840 GOTO 7835
7845 RETURN 
7850 REM "Check if ext only
7854 DIM I$(61)
7855 IF B$(10,1)<>"S" THEN GOTO 7890
7860 READ (Z[8],KEY="X"+B$(101,10),DOM=7890)I$
7890 RETURN 
7900 REM "Change Art Status
7902 IF CALLED$="Y" THEN GOTO 7945; REM "WO131248
7905 IF P9$(189,1)<>"Y" THEN RETURN 
7910 READ (Z[3],KEY=U$(2),DOM=7911)
7913 DIM C$(350); READ (Z[3],END=7990)IOL=0330
7914 IF C$(82,9)<>U$(2,9) THEN GOTO 7990
7915 READ (Z[9],KEY=C$(91,20),DOM=7980)Q$; IF POS("Y"=Q$(28,3))=0 THEN GOTO 7980
7920 EXTRACT RECORD (Z[11],KEY=C$(91,20),DOM=7980)Q$
7925 Q$(231,1)="P",Q$(232,6)=X3$(21,6)
7930 WRITE RECORD (Z[11],KEY=C$(91,20))Q$; IF RT_PARM$<>"" THEN CUST$=C$(91,20); CALL "RT2WOC",ERR=7931,X3$,X4$,CUST$,"FM1...","U",C$(91,20)
7945 RETURN 
7990 RETURN 
8000 REM "Build desc from H8$
8010 H9$=FNT$(H8$(17,8)+" "); IF H9$<>"" AND H9$<>" " THEN H9$=H9$+QUO; IF POS(" "<>H8$(111,8))<>0 THEN H9$=H9$+"x"
8020 H9$=H9$+FNS$(H8$(111,8)); IF H9$<>"" THEN IF POS(" "<>H8$(111,8))<>0 THEN H9$=H9$+QUO+" " ELSE H9$=H9$+" "
8030 IF NUM(H8$(15,2),ERR=8031)<>0 THEN H9$=H9$+H8$(15,2)+" Ply "
8050 RETURN 
8060 REM "Setup Fax String
8065 DIM X$(6*51),EM$(6*21); REM "ssp#134376
8069 CALL "ZZDISP","AX",A$(179,10),"A/R",X3$,T$,"",0,0,X4$
8070 X$(1)="C"+D$(143,12),X$(27)="C:"+T$,EM$(1)="C"+A$(179,10); REM "Customer - ssp#134376
8074 CALL "ZZDISP","AX",A$(7,10),"A/P",X3$,T$,"",0,0,X4$
8075 X$(52)="V"+G2$(133,12),X$(78)="V:"+T$,EM$(22,21)="V"+A$(7,10); REM "Vendor ssp#134376
8077 IF LEN(X7$)<150 THEN DIM J0$(200); J0$(1)="P"+A$(7,10),J0$(138,12)=G2$(133,12) ELSE J0$=X7$; IF STP(J0$(138,12),3," ")="" THEN J0$(138,12)=G2$(133,12)
8078 CALL "ZZDISP","AX",J0$(2,10),"A/P",X3$,T$,"",0,0,X4$
8079 X$(103)="P"+J0$(138,12); IF POS(" "<>J0$(12,4))=0 THEN X$(129)="P:"+T$,EM$(43,21)="P"+J0$(2,10) ELSE X$(129)="P:"+T$+"-"+J0$(12,4),EM$(43,21)="P"+A$(7,10)+J0$(12,4); REM "Plant - ssp#134376
8080 IF LEN(E1$)<150 THEN DIM J0$(200); J0$(1)="C"+A$(179,10),J0$(138,12)=D$(143,12) ELSE J0$=E1$
8081 IF J0$(1,1)="D" THEN X$="Whse" ELSE IF J0$(1,1)="C" THEN CALL "ZZDISP","AX",J0$(2,10),"A/R",X3$,T$,"",0,0,X4$ ELSE CALL "ZZDISP","AX",J0$(2,10),"A/P",X3$,T$,"",0,0,X4$
8082 AA$=E1$; DIM E1$(200); GOSUB 5600; X$(154)="T"+E1$(138,12),E1$=AA$; IF POS(" "<>J0$(12,4))=0 THEN X$(180)="T:"+T$ ELSE X$(180)="T:"+T$+"-"+J0$(12,4),EM$(64,21)="T"+J0$(2,14); REM "Ship to - ssp#134376
8083 X$(205)="S"+H0$(127,12); X$(231,25)="S:"+A$(343,4)+"-"+H0$(5,30),EM$(85,21)="S"+A$(343,4); REM "Salesperson
8085 IF E$(11,1)="D" THEN AA$=E1$; DIM E1$(200); GOSUB 5600; X$(256)="W"+E1$(138,12),X$(282,25)="W:"+E$(12,4)+"-"+E1$(16,35),EM$(106,21)="W"+E$(12,4),E1$=AA$ ! WO153316, Warehouse
8090 IF J8=1 THEN FOR J7=0 TO 4; X$(2+J7*51,25)=P6$(150,12),EM$(2+J7*21,20)="ALIGNMENTPATTERN"; NEXT J7; REM "If alignment pattern, replace with align pat from parameters
8093 CALL "ZZDISP","AX",A$(297,9),"P/O",X3$,T$,"",0,0,X4$; T$="850:"+T$; REM "Tag 1 for fax
8095 RETURN 
8114 CLOSE (14); OPEN (14)"ZZPARM"
8115 READ (14,KEY="PRINTERS",DOM=8145)D1$,D2$
8120 P=POS(FID(W9)=D2$,2); IF P=0 THEN GOTO 8145
8125 READ (14,KEY="ptr"+D1$(INT(P/2)*8+9,8),DOM=8130)D3$; GOTO 8135
8130 D1$="",D2$=""; GOTO 8145
8135 D1$=D3$(282,16),D2$=D3$(266,16)
8140 D1$=FNS$(D1$),D2$=FNS$(D2$)
8145 RETURN 
8200 REM "CORRECT ADDRESS PLACING
8210 IF STP(Z5$,2)<>"" THEN F5$=Z5$,SUB_F5=SUB_F5+1; GOSUB 8300
8215 Z5$=""
8250 RETURN 
8300 REM "Place in page, F5 = field #, F5$=field info
8301 TOD_SEQ=0
8305 IF TOD_OK THEN CALL "UPDDTO;UPDATE_LINE",DTO,TOD_OUTPUT_TYPE$,TOD_TRANS$,TOD_SEQ,F5,SUB_F5,F5$,TOD_OK
8315 RETURN 
8320 REM specialshipping
8325 IF X9[F5]=0 THEN GOTO 8345 ELSE IF JETFORM_MODE THEN GOSUB JETFORM_PRINT; GOTO 8345
8330 P$(X9[F5]+(Y9[F5]+O0)*W3,LEN(F5$))=F5$
8345 RETURN 
8350 REM "F5=field#, F5$=field info. line number is used to index off of I0 set to first line in lines section - 1. line 1  on a line = first line.
8352 TOD_SEQ=NUM(B$(7,3)) ! LINE NUM
8354 IF TOD_OK AND DTF_COMP$="Y" THEN CALL "UPDDTF;UPDATE_COMP_LINE",DTF,TOD_OUTPUT_TYPE$,TOD_TRANS$,TOD_SEQ,F5,SUB_F5,F5$,DTF_SPEC$,PO_LINE$,B$(101,10),B$(28,40),TOD_OK; RETURN ! specs   
8356 IF PLY_SEQUENCE$="" THEN IF TOD_OK THEN CALL "UPDDTO;UPDATE_LINE",DTO,TOD_OUTPUT_TYPE$,TOD_TRANS$,TOD_SEQ,F5,SUB_F5,F5$,TOD_OK
8358 IF TOD_OK AND PLY_SEQUENCE$<>"" THEN CALL "UPDDTY;UPDATE_LINE",DTY,TOD_OUTPUT_TYPE$,TOD_TRANS$,TOD_SEQ,F5,SUB_F5,F5$,PLY_SEQUENCE$,TOD_OK,B$(101,10),B$(28,40) ! std specs
8395 RETURN 
8500 REM "SDL= Second Description Line & Line item product codes
8504 DIM X$(187),X[40]; FIND (Z[5],KEY=B$(91,20),DOM=8505)IOL=0495
8505 DESC$=B$(28,40); IF V3$(2,1)="N" THEN DESC1=POS($A3$=DESC$); IF DESC1<>0 THEN DESC$(DESC1,1)=$9C$
8508 IF X9[131]=0 OR POS(B$(10,1)="IC")=0 THEN F5=18,F5$=DESC$; GOSUB 8350; GOTO 8525
8510 FIND (Z[5],KEY=B$(91,20),DOM=8525)X$
8515 F5=18,F5$=X$(21,40); GOSUB 8350; F5=131,F5$=X$(128,40); GOSUB 8350
8525 REM "Diversified Label?
8530 IF POS(X3$(9,3)="021500",3)=0 THEN GOTO 8545
8535 FIND (Z[8],KEY="T"+B$(25,3),DOM=8545)X$
8540 IF X$(5,1)="*" THEN F4=8
8545 RETURN 
8550 REM "GET & PRINT PRODUCT CODE DESCRIPTION
8555 FIND (Z[8],KEY="T"+P7$,DOM=8595)X$
8560 F5=100; IF MID(X9$,F5,1)="C" THEN F5$=P7$; GOSUB 8350 ELSE F5$=X$(5,15); GOSUB 8350
8562 F5=156,F5$=P7$; GOSUB 8350; REM "WO100065
8595 RETURN 
8600 REM "Print item stuff
8605 F5=107,F5$=F$(24,8); GOSUB 8350
8610 F5=108,F5$=F$(32,8); GOSUB 8350
8615 F5=109,F5$=F$(40,2); GOSUB 8350
8620 IF POS(" "<>F$(167,6))>0 THEN F5=20,F5$=F$(167,6); GOSUB 8350
8622 IF F[17]<>0 THEN F5=102,F5$=STR(F[17]:"###,###,###"); IF FPT(F[17])=0 THEN GOSUB 8350 ELSE F5$=F5$+" /"+STR(100*FPT(F[17]):"#0"); GOSUB 8350
8625 IF P7$<>"" AND POS(" "<>P7$)<>0 THEN GOSUB 8550
8630 F5=141,F5$=F$(215,16); GOSUB 8350
8635 IF X9[150]>0 THEN F5=150,F5$=F$(370,10); GOSUB 8350; REM "WO111032, Item Specification Code
8645 RETURN 
8700 REM "Do FS2 stuff
8702 FS2_FOUND$="N"; READ (Z[10],KEY=A$(297,8)+B$(7,3),DOM=8703)IOL=0450; FS2_FOUND$="Y"; GOTO 8709
8704 IF B[20]=0 OR B[21]=0 THEN GOTO 8795 ELSE B0[4]=B[21]*B[2]/B[20]; CALL "FM2EXT",Z[13],0,B$(77,4),B[2],B[1],B0[4],X,2; B0[6]=X; GOTO 8715
8709 REM "If selling u/m <> to po line cost u/m adjusting selling.
8710 IF B0$(124,4)<>B$(77,4) THEN X=B0[4]; CALL "FM2EXT",Z[13],1,B$(77,4),B[2],B0[0],X,B0[6],2; B0[4]=X
8712 IF X9[130]=0 AND B0[4]=0 THEN B0[4]=B0[6]
8715 UM$=B$(77,4),UM0=B(2),F5=96,F5$=STR(B0[4]:M5$); GOSUB 5900; IF B$(10,1)="M" THEN F5$=DIM(5); GOSUB 8350 ELSE GOSUB 8350; REM "SSP#208237
8720 B5=B5+B0[6]; F5=130,F5$=STR(B0[6]:M0$); GOSUB 8350
8725 DIM C0$(32),C0[15]; FIND (Z[9],KEY=B0$(128,5),DOM=8726)IOL=0460
8729 REM "Figure commission x, P3 is set in 2500's to total cost this line
8730 Y$="23O AR4...  "; CALL "ZZFLES",X3$,Y1$,Y0$,Y$,Z{ALL},Z0,Z1; REM "169855
8731 CALL "AR2COM","",C0$,C0{ALL},X,B0[6],P3
8732 Y$="23C AR4...  09O AR4...  "; CALL "ZZFLES",X3$,Y1$,Y0$,Y$,Z{ALL},Z0,Z1
8735 F5=98,F5$=B0$(128,5); GOSUB 8350
8740 B6=B6+X
8742 IF FS2_FOUND$="Y" THEN EXTRACT (Z[10],KEY=A$(297,8)+B$(7,3),DOM=8743)IOL=0452; B1[25]=X; WRITE (Z[10],KEY=A$(297,8)+B$(7,3))IOL=0453; REM "ssp91762,est comm on line calculated on line 8730
8745 IF A$(173,1)="S" THEN GOTO 8795
8750 IF B0[6]<>0 THEN F5=(B0[6]-P3)*100/B0[6],F5$=STR(F5:M6$),F5=124; GOSUB 8350
8760 F5=123,F5$=STR(B0[6]-P3:M0$(2)); IF B$(10,1)="M" THEN F5$=DIM(5); GOSUB 8350 ELSE GOSUB 8350; REM "SSP#208237
8765 F5=142,F5$=FND$(B0$(113,6)); GOSUB 8350
8795 RETURN 
8900 REM "U/M
8910 IF B$(77,4)<>L$(4,4) THEN CLOSE (14); OPEN (14)"ZZPARM"; DIM L$(21),L[1]; READ (14,KEY="U/M"+B$(77,4),DOM=8911)IOL=0420
8920 IF L[1]=0 THEN L[1]=1
8940 RETURN 
8950 ! SSP181654, check FS2 record, may have a from customer, set it
8955 IF LEN(S0$)<20 THEN GOTO *RETURN
8960 READ (Z[10],KEY=A$(297,8)+B$(7,3),DOM=*RETURN)FS2$
8965 IF STP(FS2$(161,10),3)>"" AND S0$(1,10)<>DIM(10) AND FS2$(161,10)<>S0$(1,10) THEN S0$(1,10)=FS2$(161,10)
8995 RETURN 
8999 ! 
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 1000
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9900 REM "End program
9909 ! IF V8$="A" THEN V3$(2,6)="AUTO"+V7$
9910 CALL "ZZERPT",X3$,X4$,X0$,Y3$,Y4$,W9,W2,W5,W,W0,W8,T3,V3$
9920 DROP OBJECT OOP
9922 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9925 CALL "ZZDAPP",X3$,"AALL"
9926 SETERR 9927; EXIT ; REM "WO131248
9927 IF %GUI THEN EXIT 
9930 IF Y4$<>"" THEN RUN Y4$,ERR=9931
9940 RUN "ZMENU"
9999 END 
56000 REM "212097-TOD Purchase Order Printing
