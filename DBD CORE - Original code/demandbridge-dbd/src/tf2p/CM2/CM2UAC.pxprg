0010 REM "Create Net Proceeds record <CM2UAC>
0035 REM "3.8 - 05/09/95 - 15.44
0040 REM "Copyright 1995 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0320 IOLIST B$,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14],B[15],B[16],B[17],B[18],B[19],B[20],B[21],B[22],B[23],B[24],B[25],B[26],B[27],B[28],B[29],B[30],B[31],B[32],B[33],B[34],B[35],B[36],B[37],B[38],B[39],B[40]
1010 REM "A$, A(all) = Source data
1011 REM "S0$=Source (B=Billing
1012 REM "C$ = RL Parameters
1013 REM "X0$=AR6 data (if applicable)
1020 ENTER X3$,S0$,A$,A{ALL},X0$,X1$,F0
1025 DIM Z[14]
1030 SETERR 9000
1100 REM 
1110 DIM B$(187),B[40]
1120 J0=1
1210 IF S0$="B" THEN GOTO 2000
1215 IF S0$="A" THEN GOTO 2500
1220 IF S0$="C" THEN GOTO 3000
1225 IF S0$="D" THEN GOTO 3500
1299 EXIT 99
2000 REM "Create record from Billing Update
2002 IF X3$(30,1)="M" THEN IF POS(A$(338,3)="144244",3)>0 THEN GOTO 9900
2005 CLOSE (14); OPEN (14)"ZZPARM"; READ (14,KEY="R/L"+A$(338,3))C$,*,B[38],B[39]
2006 READ (14,KEY="ROYALTY"+C$(58,3))*,R0,*,*,*,*,*,*,*,*,R1
2007 B[36]=R0,B[37]=R1
2010 B$(1,3)=A$(338,3),B$(4,9)=A$(92,8),B$(22,15)=""
2015 B$(16,6)=X3$(21,6),B$(37,1)="1",B$(38,1)=" "
2020 B$(39,6)=A$(86,6),B$(51,10)=A$(15,10)
2025 B$(61,12)=A$(7,8)
2030 B$(73,40)="Sales Journal"
2035 B$(113,20)=C$(82,20)
2038 B$(137,40)=A$(354,40)
2040 B$(133,4)=A$(133,4),B$(187,1)=A$(343,1)
2045 B[0]=A[9],B[1]=A[2],B[2]=A[4]+A[6]+A[8]
2059 REM :GET TAX BREAKDOWN FOR GST & PST FOR CANADA
2060 B[23]=A[4],B[24]=A[6]
2090 J0=0; GOSUB 8000
2095 GOTO 9900
2500 REM "Create record for A/P Invoice
2502 CLOSE (14); OPEN (14)"ZZPARM"; READ (14,KEY="R/L"+A$(104,3))C$
2505 B$(1,3)=A$(104,3),B$(4,9)=A$(62,8),B$(16,6)=X3$(21,6)
2510 B$(37,1)="2",B$(39,6)=A$(27,6),B$(51,10)=A$(7,10)
2515 B$(61,12)=A$(17,10),B$(73,40)="A/P Invoice Update"
2520 B$(113,20)=C$(82,20)
2525 B[3]=A[1],B[4]=A[2]
2529 REM "Capture special amounts 2 & 3 for Canadian Taxes
2530 B[23]=A[3],B[24]=A[4]
2540 READ (14,KEY="ROYALTY"+C$(58,3))*,R0,*,*,*,*,*,*,*,*,R1
2542 REM "Put royalty on cost record as well
2545 B[36]=R0,B[37]=R1
2590 GOSUB 8000
2595 GOTO 9900
3000 REM "Update Cash Receipts Entry
3001 REM "X0$=JOB INFORMATION
3005 CLOSE (14); OPEN (14)"ARH"+X3$(9,3); READ (14,KEY=A$(11,2))D$
3010 CLOSE (14); OPEN (14)"ZZPARM"; READ (14,KEY="R/L"+D$(33,3))C$
3015 B$(1,3)=C$(4,3),B$(4,9)=X0$(66,8)
3020 B$(16,6)=X3$(21,6),B$(37,1)="4"
3025 B$(39,6)=X3$(21,6)
3030 B$(51,10)=A$(11,10),B$(61,12)="CK"+A$(21,6)
3035 B$(73,40)="Cash Rec, Inv: "+A$(27,8)
3050 B[6]=A[6],B[7]=A[2],B[8]=A[5]+A[4]+A[3]
3090 GOSUB 8000
3095 GOTO 9900
3500 REM "Update A/P Payment data
3520 B$(1,3)=X0$(118,3),B$(4,9)=X0$(56,8)
3525 B$(16,6)=X3$(21,6),B$(37,1)="3"
3530 B$(39,6)=X3$(21,6),B$(51,10)="",B$(61,12)=""
3535 B$(73,40)="A/P Check Run"
3540 B[9]=A[0]
3545 B$(61,12)="CK#"+A$(28,6),B$(51,10)=A$(7,10)
3570 GOSUB 8000
3595 GOTO 9900
8000 REM "Update Net Proceeds File
8005 Z$="01O CM4... "; GOSUB 9750
8010 B$(13,3)=STR(J0:"000"),J0=J0+1
8020 WRITE (Z[1],KEY=B$(1,15),DOM=8010)IOL=0320
8030 Z$="01C CM4... "; GOSUB 9750
8045 RETURN 
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9040 CALL "ZZERRM",Y8$,"CM2UAC",Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9120 ON Y8 GOTO 9900,0990,9920
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "EXIT PROGRAM
9940 EXIT 
9999 END 
