0010 REM "Restore CMY data to CM4 <CM2UTC>
0015 REM "Prog Type: IR-370032  
0020 SETESC 9300; SETERR 9000
0035 REM "3.8 - 01/27/95 - 12.64 - csi
0040 REM "Copyright 1994 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 BEGIN 
0110 X0$="CM2UTC",X1$="Restore CMY data to Net Proceeds Detail"
0120 DIM S$(20)
0150 M0$="###,##0"
0200 REM "
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,M9$,X0,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(65,1)>"2" THEN PRECISION NUM(X3$(65,1),ERR=0246)
0255 X2=2
0500 REM 
0510 OPEN (1)"CMY"+X3$(9,3)
0520 OPEN (2)"CM4"+X3$(9,3)
0620 GOSUB 6000
0630 GOSUB 8100
0640 CALL "ZZPROM",".Y",X3$,Z,"Proceed?","","",0; ON Z GOTO 0641,9900
1000 REM 
1010 K$=KEY(1,END=5000); READ RECORD (1,KEY=K$)A$
1015 C=C+1; IF MOD(C,T0)=0 THEN GOSUB 8150
1100 WRITE RECORD (2,KEY=K$,DOM=1101)A$; GOTO 1000; REM "If write ok then just goto 1000 for next one
1105 REM "duplicate found
1110 C0=C0+1,A$(13,3)=STR(NUM(A$(13,3))+1:"000"),K$(13,3)=A$(13,3); GOTO 1100
5000 REM 
5005 PRINT @(0,17),"Records in CMY: ",C," Records resequenced when moved: ",C0,
5010 C=T; GOSUB 8150
5020 CALL "ZZPROM",".4",X3$,Z,"Process complete!!","","",0
5090 GOTO 9900
6000 REM "
6010 PRINT @(0,0),'SB',
6020 PRINT @(0,4),"This utility restores records from CMY into CM4, the Net Proceeds Detail file. It will change the sequence numbers on the records read from CMY as necessary to fit them into CM4.",
6030 PRINT @(0,8),"The records will NOT be removed from CMY. CMY will need to be re-initialized after running this process."
6190 PRINT 'SF',
6195 RETURN 
8100 REM 
8110 CALL "ZZINFO",1,T9,X3$,T,T0,K,B,D,S0,S1,F$
8115 PRINT @(10,10),"There are "+FNR$(STR(T:M0$))+" records to process.",
8130 T0=INT(T*.02); IF T0<=1 THEN T0=2
8145 RETURN 
8155 CALL "ZZBARG",X3$,"HG",19,10,50,T1,T,C
8195 RETURN 
8910 DEF FNR$(Z9$)=Z9$(POS(" "<>Z9$))
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9120 ON Y8 GOTO 9900,0990,9920
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9740 RETURN 
9750 REM "FILES
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9800 REM "
9820 K9$="ZMENU"
9900 REM "END PROGRAM
9905 IF T0$<>"" THEN DROP T0$,ERR=9906; GOTO 9905
9910 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9920 SETERR 9925; IF K9$>"" THEN RUN K9$
9925 SETERR 9940
9930 Q1$=A1$; EXIT 
9940 BEGIN ; SETESC 9350
9950 RUN "ZMENU"
9999 END 
