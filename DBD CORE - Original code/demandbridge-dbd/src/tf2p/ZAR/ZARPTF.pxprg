0035 REM "4.1 - 12/24/96 - 11.62 - tma - SSP# 077787
0040 REM "Copyright 1996 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0920 GOSUB 4800
1510 REM "
1520 GOSUB 4000
4010 W=0; IF F9=W0 THEN GOSUB 6000
4210 F9=F9+1,W=0
4250 IF F9=W0 THEN GOSUB 6000
4290 RETURN 
4700 REM "CHANGE FORMAT
4720 CALL "ZZ2PDA",X3$,X4$,Q0$,Q1$
4725 IF Q1$="" THEN GOTO 4800 ELSE IF Q1$(1,5)<>"LABEL" THEN GOTO 4720
4730 READ (Z[13],KEY=Q1$,DOM=4700)F0$
4800 REM "TEST PATTERN
4802 F0=NUM(F0$(49,2))+NUM(F0$(54,1)); IF F0=0 THEN F0=W3
4805 W=0,W0=NUM(F0$(51,1)),F1=F0*W0,F2=NUM(F0$(52,2))+NUM(F0$(55,1)),F9=0,Q$="+("+FNS$(F0$(7,40))+")",F8=NUM(F0$(47,2)); DIM F9$(F1*F2),F9$(F1*F2); IF F0>20 THEN DIM S$(F0)
4810 CALL "ZZPROM","L1ZZPRIN",X3$,S3,Q$,"","",0; ON S3 GOTO 4990,4811,4700,9900
4820 DIM A$(LEN(A$),"*")
4840 FOR Z=1 TO NUM(F0$(51,1))
4850 GOSUB 4000
4860 NEXT Z
4895 GOTO 4810
4900 REM 
4995 RETURN 
5000 REM "End of Print
5020 REM 
5030 T0$="END"
5050 T=0; GOSUB 3100
5080 IF F9>0 THEN GOSUB 6000
5200 REM "
5295 GOTO 9900
6000 REM "PRINT LABELS
6040 FOR X=0 TO F2-1
6045 REM 
6050 PRINT (W9)F9$(X*F1+1,F1)
6060 NEXT X
6070 REM 
6085 F9=0,F9$(1)=""
6090 RETURN 
7001 REM 
7095 F9=F9+1,W=0
7200 REM "Elapsed time routine"
7201 RETURN 
7205 GOSUB 7300; Y5$(1)=Q1$+": "+STR(T[0,0]); GOSUB 7300
7210 PRECISION 14; T2=TIM-T2
7220 T4$=STR(INT(T2):"##0")
7230 T3=INT(FPT(T2)*3600)
7240 T3=T3/60
7250 T4$=T4$+":"+STR(T3:"00")
7260 Y5$(1)=Q3$+": "+T4$; GOSUB 7300
7280 PRECISION 2
7290 RETURN 
7300 REM "Output line Y5$ to output device
7305 IF W>=F2 THEN GOTO 7390
7310 F9$(F9*F0+W*F1+1,F0)=Y5$
7320 REM 
7360 REM "
7390 W=W+1,Y5$(1)=""
7395 RETURN 
7400 REM "Read report selection parameters"
7410 Z$="12O ZZP     13O ZZPARM  "
7420 GOSUB 9700; ON Z0 GOTO 7421,9900
7430 Y3$=X3$(1,6),Y4$=X3$(178,7)
7460 READ (Z[13],KEY="LABEL"+V3$(17,1),DOM=7461)F0$; GOTO 7465
7462 CALL "ZZPROM","2",X3$,S3,"The item/label information has not been setup ("+V3$(17,1)+")","","",0; IF S3=0 THEN CALL "ZZ2PDA"; GOTO 7460 ELSE GOTO 9900
7465 W0=NUM(F0$(51,1))
7485 FOR U1=1 TO LEN(V1$); IF V1$(U1,1)=" " THEN V1$(U1,1)="."; NEXT U1 ELSE NEXT U1
7490 RETURN 
7500 REM "CUSTOM PROGRAMMING ROUTINES
7525 REM "Modified stmts:
7550 REM "Added stmts:
7575 REM "Deleted stmts:
8000 REM "READ ALTERNATE RECORDS
8090 RETURN 
8992 DEF FNZ$(Z)=CHR(ASC("B")+SGN(Z))+BIN(INT(ABS(Z)),6)
8994 DEF FNS$(Z$)=Z$(1,POS("   "=Z$+"   ")-1)
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5); IF Y5=68 OR Y5=69 THEN GOTO 9500
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 1000
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)<>"1" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; SETESC 9300; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 IF Y5=68 THEN RETRY ELSE ON C9 GOTO 1140,2040
9750 REM "OPEN FILES ROUTINE
9760 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
9790 RETURN 
9900 REM "End program
9905 IF POS("V"=W8$)>0 THEN GOSUB 6000
9910 CALL "ZZERPT",X3$,X4$,X0$,Y3$,Y4$,W9,W2,W5,W,W0,W8,T3,V3$
9920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9930 IF Y4$<>"" THEN RUN Y4$,ERR=9931
9940 RUN "ZMENU"
9999 END 
