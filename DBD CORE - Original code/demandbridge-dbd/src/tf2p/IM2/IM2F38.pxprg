0010 REM "<IM2F38> Import Format Method - Get DB/d PO/Line Number
0020 SETESC 9300; SETERR 9000
0035 REM "5.7 - 02/06/18 - 16.028055 - dmm - SSP# 266284
0037 REM "266284-CIGPGEN2 I/M def; need formatter for P/O plus Line Number   
0040 REM "Copyright 2018 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0070 REM "ORIGINAL$ is string may contain a '-', if so strip, then use the vendor supplied PO# which is the order number plus the DBE line number, which should be the same as the DBD line number.  Copied from IM2F32, SSP266284.  Need to return the DBD PO Number (9) plus the PO Line Number (3).
0080 REM "OPTION$ -> IF ='?' THEN return WHO AM I ELSE Options if needed to"+" control operation
0081 REM "ORIGINAL$ -> Original string to be formatted
0082 REM "FORMATTED$ -> Return string formatted properly
0083 REM "RETURN_CODE -> 0=ok
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,OPTION$,ORIGINAL$,FORMATTED$,FORMAT_ARRAY${ALL},RETURN_CODE
0100 SETERR 9000
0110 X0$="IM2F38",X1$="Import Format Method - Get DB/d PO/Line Number"
0200 REM "Initialization
0205 RETURN_CODE=0
0300 REM "IOLISTS
0310 IOLIST A$
0320 IOLIST B$
0500 REM "FILES
0505 DIM Z[NUM(X3$(60,3))]
0510 Z$="01O FS2...  13O ZZPARM  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1; ON Z0 GOTO 0521,9900
0800 REM "Where to go
0805 IF OPTION$="?" THEN GOTO WHO_AM_I ELSE GOTO FORMAT_ORIGINAL
0900 WHO_AM_I:REM "Return in FORMATTED$ a description of this method
0910 FORMATTED$="Get DB/d PO Number plus Line Number"
0995 WHO_AM_I_END:GOTO 9900
1000 FORMAT_ORIGINAL:REM " Format ORIGINAL$ TO FORMATTED$
1005 FORMATTED$=ORIGINAL$
1010 FORMATTED$=STP(ORIGINAL$,3,"-") ! Strip hyphens
1020 IF LEN(FORMATTED$)<9 THEN FORMATTED$="00"+FORMATTED$ ! Need to prefix the 00 division
1025 IF LEN(FORMATTED$)<9 THEN GOTO FORMAT_ORIGINAL_END
1050 ORDER_NUM$=FORMATTED$(1,8),LINE_NUM$=STR(NUM(FORMATTED$(9),ERR=FORMAT_ORIGINAL_END):"000") ! If the data after the order number portion isn't numeric, leave, otherwise format the line number to use in lookup of FS2
1060 FIND (Z[1],KEY=ORDER_NUM$+LINE_NUM$,DOM=FORMAT_ORIGINAL_END)FS2$
1065 IF FS2$(9,1)=DIM(1) THEN GOTO FORMAT_ORIGINAL_END ELSE PO_CODE$=FS2$(9,1)
1070 FORMATTED$=ORDER_NUM$+PO_CODE$+LINE_NUM$
1095 FORMAT_ORIGINAL_END:GOTO 9900
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9900 REM "END PROGRAM
9910 REM CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z[ALL],0,0
9930 SETERR 9940; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
56000 ! 266384-Get DB/d PO Number plus Line Number using ord num plus DBE line
56002 ! 295436-using this now, never used for 266384
